var Ext=Ext||{};Ext._startTime=(new Date).getTime(),function(){var i,ExtApp,global=this,objectPrototype=Object.prototype,toString=objectPrototype.toString,enumerables=!0,enumerablesTest={toString:1},emptyFn=function(){},callOverrideParent=function(){var method=callOverrideParent.caller.caller;return method.$owner.prototype[method.$name].apply(this,arguments)},nonWhitespaceRe=/\S/,iterableRe=/\[object\s*(?:Array|Arguments|\w*Collection|\w*List|HTML\s+document\.all\s+class)\]/;Ext.global=global;for(i in enumerablesTest)enumerables=null;enumerables&&(enumerables=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),Ext.enumerables=enumerables,Ext.apply=function(object,config,defaults){if(defaults&&Ext.apply(object,defaults),object&&config&&"object"==typeof config){var i,j,k;for(i in config)object[i]=config[i];if(enumerables)for(j=enumerables.length;j--;)k=enumerables[j],config.hasOwnProperty(k)&&(object[k]=config[k])}return object},Ext.buildSettings=Ext.apply({baseCSSPrefix:"x-"},Ext.buildSettings||{}),Ext.apply(Ext,{name:Ext.sandboxName||"Ext",emptyFn:emptyFn,identityFn:function(o){return o},emptyString:new String,baseCSSPrefix:Ext.buildSettings.baseCSSPrefix,applyIf:function(object,config){var property;if(object)for(property in config)void 0===object[property]&&(object[property]=config[property]);return object},iterate:function(object,fn,scope){Ext.isEmpty(object)||(void 0===scope&&(scope=object),Ext.isIterable(object)?Ext.Array.each.call(Ext.Array,object,fn,scope):Ext.Object.each.call(Ext.Object,object,fn,scope))}}),Ext.apply(Ext,{extend:function(){var objectConstructor=objectPrototype.constructor,inlineOverrides=function(o){for(var m in o)o.hasOwnProperty(m)&&(this[m]=o[m])};return function(subclass,superclass,overrides){Ext.isObject(superclass)&&(overrides=superclass,superclass=subclass,subclass=overrides.constructor!==objectConstructor?overrides.constructor:function(){superclass.apply(this,arguments)});var subclassProto,F=function(){},superclassProto=superclass.prototype;return F.prototype=superclassProto,subclassProto=subclass.prototype=new F,subclassProto.constructor=subclass,subclass.superclass=superclassProto,superclassProto.constructor===objectConstructor&&(superclassProto.constructor=superclass),subclass.override=function(overrides){Ext.override(subclass,overrides)},subclassProto.override=inlineOverrides,subclassProto.proto=subclassProto,subclass.override(overrides),subclass.extend=function(o){return Ext.extend(subclass,o)},subclass}}(),override:function(target,overrides){if(target.$isClass)target.override(overrides);else if("function"==typeof target)Ext.apply(target.prototype,overrides);else{var name,value,owner=target.self;if(owner&&owner.$isClass)for(name in overrides)overrides.hasOwnProperty(name)&&(value=overrides[name],"function"==typeof value&&(value.$name=name,value.$owner=owner,value.$previous=target.hasOwnProperty(name)?target[name]:callOverrideParent),target[name]=value);else Ext.apply(target,overrides)}return target}}),Ext.apply(Ext,{valueFrom:function(value,defaultValue,allowBlank){return Ext.isEmpty(value,allowBlank)?defaultValue:value},typeOf:function(value){var type,typeToString;if(null===value)return"null";if(type=typeof value,"undefined"===type||"string"===type||"number"===type||"boolean"===type)return type;switch(typeToString=toString.call(value)){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}return"function"===type?"function":"object"===type?void 0!==value.nodeType?3===value.nodeType?nonWhitespaceRe.test(value.nodeValue)?"textnode":"whitespace":"element":"object":void 0},coerce:function(from,to){var fromType=Ext.typeOf(from),toType=Ext.typeOf(to),isString="string"==typeof from;if(fromType!==toType)switch(toType){case"string":return String(from);case"number":return Number(from);case"boolean":return!(isString&&(!from||"false"===from))&&Boolean(from);case"null":return!isString||from&&"null"!==from?from:null;case"undefined":return!isString||from&&"undefined"!==from?from:void 0;case"date":return isString&&isNaN(from)?Ext.Date.parse(from,Ext.Date.defaultFormat):Date(Number(from))}return from},isEmpty:function(value,allowEmptyString){return null===value||void 0===value||!allowEmptyString&&""===value||Ext.isArray(value)&&0===value.length},isArray:"isArray"in Array?Array.isArray:function(value){return"[object Array]"===toString.call(value)},isDate:function(value){return"[object Date]"===toString.call(value)},isObject:"[object Object]"===toString.call(null)?function(value){return null!==value&&void 0!==value&&"[object Object]"===toString.call(value)&&void 0===value.ownerDocument}:function(value){return"[object Object]"===toString.call(value)},isSimpleObject:function(value){return value instanceof Object&&value.constructor===Object},isPrimitive:function(value){var type=typeof value;return"string"===type||"number"===type||"boolean"===type},isFunction:"undefined"!=typeof document&&"function"==typeof document.getElementsByTagName("body")?function(value){return!!value&&"[object Function]"===toString.call(value)}:function(value){return!!value&&"function"==typeof value},isNumber:function(value){return"number"==typeof value&&isFinite(value)},isNumeric:function(value){return!isNaN(parseFloat(value))&&isFinite(value)},isString:function(value){return"string"==typeof value},isBoolean:function(value){return"boolean"==typeof value},isElement:function(value){return!!value&&1===value.nodeType},isTextNode:function(value){return!!value&&"#text"===value.nodeName},isDefined:function(value){return"undefined"!=typeof value},isIterable:function(value){return!(!value||"number"!=typeof value.length||"string"==typeof value||Ext.isFunction(value))&&(value.propertyIsEnumerable?!(!value.hasOwnProperty("length")||value.propertyIsEnumerable("length"))||iterableRe.test(toString.call(value)):!!value.item)}}),Ext.apply(Ext,{clone:function(item){var type,i,j,k,clone,key;if(null===item||void 0===item)return item;if(item.nodeType&&item.cloneNode)return item.cloneNode(!0);if(type=toString.call(item),"[object Date]"===type)return new Date(item.getTime());if("[object Array]"===type)for(i=item.length,clone=[];i--;)clone[i]=Ext.clone(item[i]);else if("[object Object]"===type&&item.constructor===Object){clone={};for(key in item)clone[key]=Ext.clone(item[key]);if(enumerables)for(j=enumerables.length;j--;)k=enumerables[j],item.hasOwnProperty(k)&&(clone[k]=item[k])}return clone||item},getUniqueGlobalNamespace:function(){var i,uniqueGlobalNamespace=this.uniqueGlobalNamespace;if(void 0===uniqueGlobalNamespace){i=0;do uniqueGlobalNamespace="ExtBox"+ ++i;while(void 0!==Ext.global[uniqueGlobalNamespace]);Ext.global[uniqueGlobalNamespace]=Ext,this.uniqueGlobalNamespace=uniqueGlobalNamespace}return uniqueGlobalNamespace},functionFactoryCache:{},cacheableFunctionFactory:function(){var idx,fn,ln,me=this,args=Array.prototype.slice.call(arguments),cache=me.functionFactoryCache;return Ext.isSandboxed&&(ln=args.length,ln>0&&(ln--,args[ln]="var Ext=window."+Ext.name+";"+args[ln])),idx=args.join(""),fn=cache[idx],fn||(fn=Function.prototype.constructor.apply(Function.prototype,args),cache[idx]=fn),fn},functionFactory:function(){var ln,args=Array.prototype.slice.call(arguments);return Ext.isSandboxed&&(ln=args.length,ln>0&&(ln--,args[ln]="var Ext=window."+Ext.name+";"+args[ln])),Function.prototype.constructor.apply(Function.prototype,args)},Logger:{verbose:emptyFn,log:emptyFn,info:emptyFn,warn:emptyFn,error:function(message){throw new Error(message)},deprecate:emptyFn}}),Ext.type=Ext.typeOf,ExtApp=Ext.app,ExtApp||(ExtApp=Ext.app={}),Ext.apply(ExtApp,{namespaces:{},collectNamespaces:function(paths){var path,namespaces=Ext.app.namespaces;for(path in paths)paths.hasOwnProperty(path)&&(namespaces[path]=!0)},addNamespaces:function(ns){var i,l,namespaces=Ext.app.namespaces;for(Ext.isArray(ns)||(ns=[ns]),i=0,l=ns.length;i<l;i++)namespaces[ns[i]]=!0},clearNamespaces:function(){Ext.app.namespaces={}},getNamespace:function(className){var prefix,namespaces=Ext.app.namespaces,deepestPrefix="";for(prefix in namespaces)namespaces.hasOwnProperty(prefix)&&prefix.length>deepestPrefix.length&&prefix+"."===className.substring(0,prefix.length+1)&&(deepestPrefix=prefix);return""===deepestPrefix?void 0:deepestPrefix}})}(),Ext.globalEval=Ext.global.execScript?function(code){execScript(code)}:function($$code){!function(){var Ext=this.Ext;eval($$code)}()},function(){var Version,version="4.2.2.1144",checkVerTemp=[""],endOfVersionRe=/([^\d\.])/,notDigitsRe=/[^\d]/g,plusMinusRe=/[\-+]/g,stripRe=/\s/g,underscoreRe=/_/g;Ext.Version=Version=Ext.extend(Object,{isVersion:!0,padModes:{"~":NaN,"^":1/0},release:"",constructor:function(version,defaultMode){var ch,i,pad,parts,release,releaseStartIndex,ver,me=this,padModes=me.padModes;if(version.isVersion)return version;me.version=ver=String(version).toLowerCase().replace(underscoreRe,".").replace(plusMinusRe,""),ch=ver.charAt(0),ch in padModes?(ver=ver.substring(1),pad=padModes[ch]):pad=defaultMode?padModes[defaultMode]:0,me.pad=pad,releaseStartIndex=ver.search(endOfVersionRe),me.shortVersion=ver,releaseStartIndex!==-1&&(me.release=release=ver.substr(releaseStartIndex,version.length),me.shortVersion=ver.substr(0,releaseStartIndex),release=Version.releaseValueMap[release]||release),me.releaseValue=release||pad,me.shortVersion=me.shortVersion.replace(notDigitsRe,""),me.parts=parts=ver.split(".");for(i=parts.length;i--;)parts[i]=parseInt(parts[i],10);return pad===1/0&&parts.push(pad),me.major=parts[0]||pad,me.minor=parts[1]||pad,me.patch=parts[2]||pad,me.build=parts[3]||pad,me},compareTo:function(other){var i,lhs,rhs,me=this,lhsPad=me.pad,lhsParts=me.parts,lhsLength=lhsParts.length,rhsVersion=other.isVersion?other:new Version(other),rhsPad=rhsVersion.pad,rhsParts=rhsVersion.parts,rhsLength=rhsParts.length,length=Math.max(lhsLength,rhsLength);for(i=0;i<length;i++){if(lhs=i<lhsLength?lhsParts[i]:lhsPad,rhs=i<rhsLength?rhsParts[i]:rhsPad,lhs<rhs)return-1;if(lhs>rhs)return 1}return lhs=me.releaseValue,rhs=rhsVersion.releaseValue,lhs<rhs?-1:lhs>rhs?1:0},toString:function(){return this.version},valueOf:function(){return this.version},getMajor:function(){return this.major},getMinor:function(){return this.minor},getPatch:function(){return this.patch},getBuild:function(){return this.build},getRelease:function(){return this.release},getReleaseValue:function(){return this.releaseValue},isGreaterThan:function(target){return this.compareTo(target)>0},isGreaterThanOrEqual:function(target){return this.compareTo(target)>=0},isLessThan:function(target){return this.compareTo(target)<0},isLessThanOrEqual:function(target){return this.compareTo(target)<=0},equals:function(target){return 0===this.compareTo(target)},match:function(target){return target=String(target),this.version.substr(0,target.length)===target},toArray:function(){var me=this;return[me.getMajor(),me.getMinor(),me.getPatch(),me.getBuild(),me.getRelease()]},getShortVersion:function(){return this.shortVersion},gt:function(target){return this.compareTo(target)>0},lt:function(target){return this.compareTo(target)<0},gtEq:function(target){return this.compareTo(target)>=0},ltEq:function(target){return this.compareTo(target)<=0}}),Ext.apply(Version,{releaseValueMap:{dev:-6,alpha:-5,a:-5,beta:-4,b:-4,rc:-3,"#":-2,p:-1,pl:-1},getComponentValue:function(value){return value?isNaN(value)?this.releaseValueMap[value]||value:parseInt(value,10):0},compare:function(current,target){var ver=current.isVersion?current:new Version(current);return ver.compareTo(target)}}),Ext.apply(Ext,{versions:{},lastRegisteredVersion:null,setVersion:function(packageName,version){return Ext.lastRegisteredVersion=Ext.versions[packageName]=new Version(version),this},getVersion:function(packageName){return void 0===packageName?Ext.lastRegisteredVersion:Ext.versions[packageName]},checkVersion:function(specs,matchAll){var i,index,matches,minVer,maxVer,spec,range,ver,isArray=Ext.isArray(specs),compat=isArray?specs:checkVerTemp,length=compat.length,versions=Ext.versions,frameworkVer=versions.ext||versions.touch;for(isArray||(checkVerTemp[0]=specs),i=0;i<length;++i){if(Ext.isString(spec=compat[i])){if(spec.indexOf(" ")>=0&&(spec=spec.replace(stripRe,"")),index=spec.indexOf("@"),index<0)range=spec,ver=frameworkVer;else{if(!(ver=versions[spec.substring(0,index)])){if(matchAll)return!1;continue}range=spec.substring(index+1)}index=range.indexOf("-"),index<0?"+"===range.charAt(index=range.length-1)?(minVer=range.substring(0,index),maxVer=null):minVer=maxVer=range:index>0?(minVer=range.substring(0,index),maxVer=range.substring(index+1)):(minVer=null,maxVer=range.substring(index+1)),matches=!0,minVer&&(minVer=new Version(minVer,"~"),matches=minVer.ltEq(ver)),matches&&maxVer&&(maxVer=new Version(maxVer,"~"),matches=maxVer.gtEq(ver))}else matches=Ext.checkVersion(spec.and||spec.or,!spec.or),spec.not&&(matches=!matches);if(matches){if(!matchAll)return!0}else if(matchAll)return!1}return!!matchAll},deprecate:function(packageName,since,closure,scope){Version.compare(Ext.getVersion(packageName),since)<1&&closure.call(scope)}}),Ext.setVersion("core",version)}(),Ext.String=function(){var charToEntity,entityToChar,charToEntityRegex,entityToCharRegex,trimRegex=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,escapeRe=/('|\\)/g,formatRe=/\{(\d+)\}/g,escapeRegexRe=/([-.*+?\^${}()|\[\]\/\\])/g,basicTrimRe=/^\s+|\s+$/g,whitespaceRe=/\s+/,varReplace=/(^[^a-z]*|[^\w])/gi,htmlEncodeReplaceFn=function(match,capture){return charToEntity[capture]},htmlDecodeReplaceFn=function(match,capture){return capture in entityToChar?entityToChar[capture]:String.fromCharCode(parseInt(capture.substr(2),10))},boundsCheck=function(s,other){return null!==s&&void 0!==s&&null!==other&&void 0!==other&&other.length<=s.length};return{insert:function(s,value,index){if(!s)return value;if(!value)return s;var len=s.length;return index||0===index||(index=len),index<0&&(index*=-1,index=index>=len?0:len-index),0===index?s=value+s:index>=s.length?s+=value:s=s.substr(0,index)+value+s.substr(index),s},startsWith:function(s,start,ignoreCase){var result=boundsCheck(s,start);return result&&(ignoreCase&&(s=s.toLowerCase(),start=start.toLowerCase()),result=0===s.lastIndexOf(start,0)),result},endsWith:function(s,end,ignoreCase){var result=boundsCheck(s,end);return result&&(ignoreCase&&(s=s.toLowerCase(),end=end.toLowerCase()),result=s.indexOf(end,s.length-end.length)!==-1),result},createVarName:function(s){return s.replace(varReplace,"")},htmlEncode:function(value){return value?String(value).replace(charToEntityRegex,htmlEncodeReplaceFn):value},htmlDecode:function(value){return value?String(value).replace(entityToCharRegex,htmlDecodeReplaceFn):value},hasHtmlCharacters:function(s){return charToEntityRegex.test(s)},addCharacterEntities:function(newEntities){var key,echar,charKeys=[],entityKeys=[];for(key in newEntities)echar=newEntities[key],entityToChar[key]=echar,charToEntity[echar]=key,charKeys.push(echar),entityKeys.push(key);charToEntityRegex=new RegExp("("+charKeys.join("|")+")","g"),entityToCharRegex=new RegExp("("+entityKeys.join("|")+"|&#[0-9]{1,5};)","g")},resetCharacterEntities:function(){charToEntity={},entityToChar={},this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},urlAppend:function(url,string){return Ext.isEmpty(string)?url:url+(url.indexOf("?")===-1?"?":"&")+string},trim:function(string){return string.replace(trimRegex,"")},capitalize:function(string){return string.charAt(0).toUpperCase()+string.substr(1)},uncapitalize:function(string){return string.charAt(0).toLowerCase()+string.substr(1)},ellipsis:function(value,len,word){if(value&&value.length>len){if(word){var vs=value.substr(0,len-2),index=Math.max(vs.lastIndexOf(" "),vs.lastIndexOf("."),vs.lastIndexOf("!"),vs.lastIndexOf("?"));if(index!==-1&&index>=len-15)return vs.substr(0,index)+"..."}return value.substr(0,len-3)+"..."}return value},escapeRegex:function(string){return string.replace(escapeRegexRe,"\\$1")},escape:function(string){return string.replace(escapeRe,"\\$1")},toggle:function(string,value,other){return string===value?other:value},leftPad:function(string,size,character){var result=String(string);for(character=character||" ";result.length<size;)result=character+result;return result},format:function(format){var args=Ext.Array.toArray(arguments,1);return format.replace(formatRe,function(m,i){return args[i]})},repeat:function(pattern,count,sep){count<1&&(count=0);for(var buf=[],i=count;i--;)buf.push(pattern);return buf.join(sep||"")},splitWords:function(words){return words&&"string"==typeof words?words.replace(basicTrimRe,"").split(whitespaceRe):words||[]}}}(),Ext.String.resetCharacterEntities(),Ext.htmlEncode=Ext.String.htmlEncode,Ext.htmlDecode=Ext.String.htmlDecode,Ext.urlAppend=Ext.String.urlAppend,Ext.Number=new function(){var me=this,isToFixedBroken="1"!==.9.toFixed(),math=Math;Ext.apply(this,{constrain:function(number,min,max){var x=parseFloat(number);return x<min?min:x>max?max:x},snap:function(value,increment,minValue,maxValue){var m;return void 0===value||value<minValue?minValue||0:(increment&&(m=value%increment,0!==m&&(value-=m,2*m>=increment?value+=increment:2*m<-increment&&(value-=increment))),me.constrain(value,minValue,maxValue))},snapInRange:function(value,increment,minValue,maxValue){var tween;return minValue=minValue||0,void 0===value||value<minValue?minValue:(increment&&(tween=(value-minValue)%increment)&&(value-=tween,tween*=2,tween>=increment&&(value+=increment)),void 0!==maxValue&&value>(maxValue=me.snapInRange(maxValue,increment,minValue))&&(value=maxValue),value)},toFixed:isToFixedBroken?function(value,precision){precision=precision||0;var pow=math.pow(10,precision);return(math.round(value*pow)/pow).toFixed(precision)}:function(value,precision){return value.toFixed(precision)},from:function(value,defaultValue){return isFinite(value)&&(value=parseFloat(value)),isNaN(value)?defaultValue:value},randomInt:function(from,to){return math.floor(math.random()*(to-from+1)+from)},correctFloat:function(n){return parseFloat(n.toPrecision(14))}}),Ext.num=function(){return me.from.apply(this,arguments)}},function(){function fixArrayIndex(array,index){return index<0?Math.max(0,array.length+index):Math.min(array.length,index)}function replaceSim(array,index,removeCount,insert){var remove,tailOldPos,tailNewPos,tailCount,lengthAfterRemove,i,add=insert?insert.length:0,length=array.length,pos=fixArrayIndex(array,index);if(pos===length)add&&array.push.apply(array,insert);else{if(remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove,tailNewPos<tailOldPos)for(i=0;i<tailCount;++i)array[tailNewPos+i]=array[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)array[tailNewPos+i]=array[tailOldPos+i];if(add&&pos===lengthAfterRemove)array.length=lengthAfterRemove,array.push.apply(array,insert);else for(array.length=lengthAfterRemove+add,i=0;i<add;++i)array[pos+i]=insert[i]}return array}function replaceNative(array,index,removeCount,insert){return insert&&insert.length?0!==index||removeCount?index<array.length?array.splice.apply(array,[index,removeCount].concat(insert)):array.push.apply(array,insert):array.unshift.apply(array,insert):array.splice(index,removeCount),array}function eraseSim(array,index,removeCount){return replaceSim(array,index,removeCount)}function eraseNative(array,index,removeCount){return array.splice(index,removeCount),array}function spliceSim(array,index,removeCount){var pos=fixArrayIndex(array,index),removed=array.slice(index,fixArrayIndex(array,pos+removeCount));return arguments.length<4?replaceSim(array,pos,removeCount):replaceSim(array,pos,removeCount,slice.call(arguments,3)),removed}function spliceNative(array){return array.splice.apply(array,slice.call(arguments,1))}var ExtArray,erase,replace,splice,arrayPrototype=Array.prototype,slice=arrayPrototype.slice,supportsSplice=function(){var lengthBefore,array=[],j=20;if(!array.splice)return!1;for(;j--;)array.push("A");return array.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F"),lengthBefore=array.length,array.splice(13,0,"XXX"),lengthBefore+1==array.length}(),supportsForEach="forEach"in arrayPrototype,supportsMap="map"in arrayPrototype,supportsIndexOf="indexOf"in arrayPrototype,supportsEvery="every"in arrayPrototype,supportsSome="some"in arrayPrototype,supportsFilter="filter"in arrayPrototype,supportsSort=function(){var a=[1,2,3,4,5].sort(function(){return 0});return 1===a[0]&&2===a[1]&&3===a[2]&&4===a[3]&&5===a[4]}(),supportsSliceOnNodeList=!0;try{"undefined"!=typeof document&&slice.call(document.getElementsByTagName("body"))}catch(e){supportsSliceOnNodeList=!1}erase=supportsSplice?eraseNative:eraseSim,replace=supportsSplice?replaceNative:replaceSim,splice=supportsSplice?spliceNative:spliceSim,ExtArray=Ext.Array={each:function(array,fn,scope,reverse){array=ExtArray.from(array);var i,ln=array.length;if(reverse!==!0){for(i=0;i<ln;i++)if(fn.call(scope||array[i],array[i],i,array)===!1)return i}else for(i=ln-1;i>-1;i--)if(fn.call(scope||array[i],array[i],i,array)===!1)return i;return!0},forEach:supportsForEach?function(array,fn,scope){array.forEach(fn,scope)}:function(array,fn,scope){for(var i=0,ln=array.length;i<ln;i++)fn.call(scope,array[i],i,array)},indexOf:supportsIndexOf?function(array,item,from){return arrayPrototype.indexOf.call(array,item,from)}:function(array,item,from){var i,length=array.length;for(i=from<0?Math.max(0,length+from):from||0;i<length;i++)if(array[i]===item)return i;return-1},contains:supportsIndexOf?function(array,item){return arrayPrototype.indexOf.call(array,item)!==-1}:function(array,item){var i,ln;for(i=0,ln=array.length;i<ln;i++)if(array[i]===item)return!0;return!1},toArray:function(iterable,start,end){if(!iterable||!iterable.length)return[];if("string"==typeof iterable&&(iterable=iterable.split("")),supportsSliceOnNodeList)return slice.call(iterable,start||0,end||iterable.length);var i,array=[];for(start=start||0,end=end?end<0?iterable.length+end:end:iterable.length,i=start;i<end;i++)array.push(iterable[i]);return array},pluck:function(array,propertyName){var i,ln,item,ret=[];for(i=0,ln=array.length;i<ln;i++)item=array[i],ret.push(item[propertyName]);return ret},map:supportsMap?function(array,fn,scope){return array.map(fn,scope)}:function(array,fn,scope){for(var results=[],i=0,len=array.length;i<len;i++)results[i]=fn.call(scope,array[i],i,array);return results},every:supportsEvery?function(array,fn,scope){return array.every(fn,scope)}:function(array,fn,scope){for(var i=0,ln=array.length;i<ln;++i)if(!fn.call(scope,array[i],i,array))return!1;return!0},some:supportsSome?function(array,fn,scope){return array.some(fn,scope)}:function(array,fn,scope){for(var i=0,ln=array.length;i<ln;++i)if(fn.call(scope,array[i],i,array))return!0;return!1},equals:function(array1,array2){var i,len1=array1.length,len2=array2.length;if(array1===array2)return!0;if(len1!==len2)return!1;for(i=0;i<len1;++i)if(array1[i]!==array2[i])return!1;return!0},clean:function(array){for(var item,results=[],i=0,ln=array.length;i<ln;i++)item=array[i],Ext.isEmpty(item)||results.push(item);return results},unique:function(array){for(var item,clone=[],i=0,ln=array.length;i<ln;i++)item=array[i],ExtArray.indexOf(clone,item)===-1&&clone.push(item);return clone},filter:supportsFilter?function(array,fn,scope){return array.filter(fn,scope)}:function(array,fn,scope){for(var results=[],i=0,ln=array.length;i<ln;i++)fn.call(scope,array[i],i,array)&&results.push(array[i]);return results},findBy:function(array,fn,scope){for(var i=0,len=array.length;i<len;i++)if(fn.call(scope||array,array[i],i))return array[i];return null},from:function(value,newReference){if(void 0===value||null===value)return[];if(Ext.isArray(value))return newReference?slice.call(value):value;var type=typeof value;return!value||void 0===value.length||"string"===type||"function"===type&&value.apply?[value]:ExtArray.toArray(value)},remove:function(array,item){var index=ExtArray.indexOf(array,item);return index!==-1&&erase(array,index,1),array},include:function(array,item){ExtArray.contains(array,item)||array.push(item)},clone:function(array){return slice.call(array)},merge:function(){var i,ln,args=slice.call(arguments),array=[];for(i=0,ln=args.length;i<ln;i++)array=array.concat(args[i]);return ExtArray.unique(array)},intersect:function(){var arraysLength,array,arrayLength,minArray,minArrayIndex,minArrayCandidate,minArrayLength,element,elementCandidate,elementCount,i,j,k,intersection=[],arrays=slice.call(arguments);if(!arrays.length)return intersection;for(arraysLength=arrays.length,i=minArrayIndex=0;i<arraysLength;i++)minArrayCandidate=arrays[i],(!minArray||minArrayCandidate.length<minArray.length)&&(minArray=minArrayCandidate,minArrayIndex=i);for(minArray=ExtArray.unique(minArray),erase(arrays,minArrayIndex,1),minArrayLength=minArray.length,arraysLength=arrays.length,i=0;i<minArrayLength;i++){for(element=minArray[i],elementCount=0,j=0;j<arraysLength;j++)for(array=arrays[j],arrayLength=array.length,k=0;k<arrayLength;k++)if(elementCandidate=array[k],element===elementCandidate){elementCount++;break}elementCount===arraysLength&&intersection.push(element)}return intersection},difference:function(arrayA,arrayB){var i,j,lnB,clone=slice.call(arrayA),ln=clone.length;for(i=0,lnB=arrayB.length;i<lnB;i++)for(j=0;j<ln;j++)clone[j]===arrayB[i]&&(erase(clone,j,1),j--,ln--);return clone},slice:[1,2].slice(1,void 0).length?function(array,begin,end){return slice.call(array,begin,end)}:function(array,begin,end){return"undefined"==typeof begin?slice.call(array):"undefined"==typeof end?slice.call(array,begin):slice.call(array,begin,end)},sort:supportsSort?function(array,sortFn){return sortFn?array.sort(sortFn):array.sort()}:function(array,sortFn){for(var comparison,j,min,tmp,length=array.length,i=0;i<length;i++){for(min=i,j=i+1;j<length;j++)sortFn?(comparison=sortFn(array[j],array[min]),comparison<0&&(min=j)):array[j]<array[min]&&(min=j);min!==i&&(tmp=array[i],array[i]=array[min],array[min]=tmp)}return array},flatten:function(array){function rFlatten(a){var i,ln,v;for(i=0,ln=a.length;i<ln;i++)v=a[i],Ext.isArray(v)?rFlatten(v):worker.push(v);return worker}var worker=[];return rFlatten(array)},min:function(array,comparisonFn){var i,ln,item,min=array[0];for(i=0,ln=array.length;i<ln;i++)item=array[i],comparisonFn?1===comparisonFn(min,item)&&(min=item):item<min&&(min=item);return min},max:function(array,comparisonFn){var i,ln,item,max=array[0];for(i=0,ln=array.length;i<ln;i++)item=array[i],comparisonFn?comparisonFn(max,item)===-1&&(max=item):item>max&&(max=item);return max},mean:function(array){return array.length>0?ExtArray.sum(array)/array.length:void 0},sum:function(array){var i,ln,item,sum=0;for(i=0,ln=array.length;i<ln;i++)item=array[i],sum+=item;return sum},toMap:function(array,getKey,scope){var map={},i=array.length;if(getKey)if("string"==typeof getKey)for(;i--;)map[array[i][getKey]]=i+1;else for(;i--;)map[getKey.call(scope,array[i])]=i+1;else for(;i--;)map[array[i]]=i+1;return map},toValueMap:function(array,getKey,scope){var map={},i=array.length;if(getKey)if("string"==typeof getKey)for(;i--;)map[array[i][getKey]]=array[i];else for(;i--;)map[getKey.call(scope,array[i])]=array[i];else for(;i--;)map[array[i]]=array[i];return map},erase:erase,insert:function(array,index,items){return replace(array,index,0,items)},replace:replace,splice:splice,push:function(array){var newItem,len=arguments.length,i=1;for(void 0===array?array=[]:Ext.isArray(array)||(array=[array]);i<len;i++)newItem=arguments[i],Array.prototype.push[Ext.isIterable(newItem)?"apply":"call"](array,newItem);return array}},Ext.each=ExtArray.each,ExtArray.union=ExtArray.merge,Ext.min=ExtArray.min,Ext.max=ExtArray.max,Ext.sum=ExtArray.sum,Ext.mean=ExtArray.mean,Ext.flatten=ExtArray.flatten,Ext.clean=ExtArray.clean,Ext.unique=ExtArray.unique,Ext.pluck=ExtArray.pluck,Ext.toArray=function(){return ExtArray.toArray.apply(ExtArray,arguments)}}(),Ext.Function={flexSetter:function(fn){return function(a,b){var k,i;if(null===a)return this;if("string"!=typeof a){for(k in a)a.hasOwnProperty(k)&&fn.call(this,k,a[k]);if(Ext.enumerables)for(i=Ext.enumerables.length;i--;)k=Ext.enumerables[i],a.hasOwnProperty(k)&&fn.call(this,k,a[k])}else fn.call(this,a,b);return this}},bind:function(fn,scope,args,appendArgs){if(2===arguments.length)return function(){return fn.apply(scope,arguments)};var method=fn,slice=Array.prototype.slice;return function(){var callArgs=args||arguments;return appendArgs===!0?(callArgs=slice.call(arguments,0),callArgs=callArgs.concat(args)):"number"==typeof appendArgs&&(callArgs=slice.call(arguments,0),Ext.Array.insert(callArgs,appendArgs,args)),method.apply(scope||Ext.global,callArgs)}},pass:function(fn,args,scope){return Ext.isArray(args)||(args=Ext.isIterable(args)?Ext.Array.clone(args):void 0!==args?[args]:[]),function(){var fnArgs=[].concat(args);return fnArgs.push.apply(fnArgs,arguments),fn.apply(scope||this,fnArgs)}},alias:function(object,methodName){return function(){return object[methodName].apply(object,arguments)}},clone:function(method){return function(){return method.apply(this,arguments)}},createInterceptor:function(origFn,newFn,scope,returnValue){return Ext.isFunction(newFn)?(returnValue=Ext.isDefined(returnValue)?returnValue:null,function(){var me=this,args=arguments;return newFn.target=me,newFn.method=origFn,newFn.apply(scope||me||Ext.global,args)!==!1?origFn.apply(me||Ext.global,args):returnValue}):origFn},createDelayed:function(fn,delay,scope,args,appendArgs){return(scope||args)&&(fn=Ext.Function.bind(fn,scope,args,appendArgs)),function(){var me=this,args=Array.prototype.slice.call(arguments);setTimeout(function(){fn.apply(me,args)},delay)}},defer:function(fn,millis,scope,args,appendArgs){return fn=Ext.Function.bind(fn,scope,args,appendArgs),millis>0?setTimeout(Ext.supports.TimeoutActualLateness?function(){fn()}:fn,millis):(fn(),0)},createSequence:function(originalFn,newFn,scope){return newFn?function(){var result=originalFn.apply(this,arguments);return newFn.apply(scope||this,arguments),result}:originalFn},createBuffered:function(fn,buffer,scope,args){var timerId;return function(){var callArgs=args||Array.prototype.slice.call(arguments,0),me=scope||this;timerId&&clearTimeout(timerId),timerId=setTimeout(function(){fn.apply(me,callArgs)},buffer)}},createThrottled:function(fn,interval,scope){var lastCallTime,elapsed,lastArgs,timer,execute=function(){fn.apply(scope||this,lastArgs),lastCallTime=Ext.Date.now()};return function(){elapsed=Ext.Date.now()-lastCallTime,lastArgs=arguments,clearTimeout(timer),!lastCallTime||elapsed>=interval?execute():timer=setTimeout(execute,interval-elapsed)}},interceptBefore:function(object,methodName,fn,scope){var method=object[methodName]||Ext.emptyFn;return object[methodName]=function(){var ret=fn.apply(scope||this,arguments);return method.apply(this,arguments),ret}},interceptAfter:function(object,methodName,fn,scope){var method=object[methodName]||Ext.emptyFn;return object[methodName]=function(){return method.apply(this,arguments),fn.apply(scope||this,arguments)}}},Ext.defer=Ext.Function.alias(Ext.Function,"defer"),Ext.pass=Ext.Function.alias(Ext.Function,"pass"),Ext.bind=Ext.Function.alias(Ext.Function,"bind"),function(){var TemplateClass=function(){},ExtObject=Ext.Object={chain:Object.create||function(object){TemplateClass.prototype=object;var result=new TemplateClass;return TemplateClass.prototype=null,result},clear:function(object){for(var keys=ExtObject.getKeys(object),n=keys.length;n--;)delete object[keys[n]];
return object},toQueryObjects:function(name,value,recursive){var i,ln,self=ExtObject.toQueryObjects,objects=[];if(Ext.isArray(value))for(i=0,ln=value.length;i<ln;i++)recursive?objects=objects.concat(self(name+"["+i+"]",value[i],!0)):objects.push({name:name,value:value[i]});else if(Ext.isObject(value))for(i in value)value.hasOwnProperty(i)&&(recursive?objects=objects.concat(self(name+"["+i+"]",value[i],!0)):objects.push({name:name,value:value[i]}));else objects.push({name:name,value:value});return objects},toQueryString:function(object,recursive){var i,j,ln,paramObject,value,paramObjects=[],params=[];for(i in object)object.hasOwnProperty(i)&&(paramObjects=paramObjects.concat(ExtObject.toQueryObjects(i,object[i],recursive)));for(j=0,ln=paramObjects.length;j<ln;j++)paramObject=paramObjects[j],value=paramObject.value,Ext.isEmpty(value)?value="":Ext.isDate(value)&&(value=Ext.Date.toString(value)),params.push(encodeURIComponent(paramObject.name)+"="+encodeURIComponent(String(value)));return params.join("&")},fromQueryString:function(queryString,recursive){var temp,components,name,value,i,ln,part,j,subLn,matchedKeys,matchedName,keys,key,nextKey,parts=queryString.replace(/^\?/,"").split("&"),object={};for(i=0,ln=parts.length;i<ln;i++)if(part=parts[i],part.length>0)if(components=part.split("="),name=decodeURIComponent(components[0]),value=void 0!==components[1]?decodeURIComponent(components[1]):"",recursive){if(matchedKeys=name.match(/(\[):?([^\]]*)\]/g),matchedName=name.match(/^([^\[]+)/),name=matchedName[0],keys=[],null===matchedKeys){object[name]=value;continue}for(j=0,subLn=matchedKeys.length;j<subLn;j++)key=matchedKeys[j],key=2===key.length?"":key.substring(1,key.length-1),keys.push(key);for(keys.unshift(name),temp=object,j=0,subLn=keys.length;j<subLn;j++)key=keys[j],j===subLn-1?Ext.isArray(temp)&&""===key?temp.push(value):temp[key]=value:(void 0!==temp[key]&&"string"!=typeof temp[key]||(nextKey=keys[j+1],temp[key]=Ext.isNumeric(nextKey)||""===nextKey?[]:{}),temp=temp[key])}else object.hasOwnProperty(name)?(Ext.isArray(object[name])||(object[name]=[object[name]]),object[name].push(value)):object[name]=value;return object},each:function(object,fn,scope){for(var property in object)if(object.hasOwnProperty(property)&&fn.call(scope||object,property,object[property],object)===!1)return},merge:function(destination){for(var object,key,value,sourceKey,i=1,ln=arguments.length,mergeFn=ExtObject.merge,cloneFn=Ext.clone;i<ln;i++){object=arguments[i];for(key in object)value=object[key],value&&value.constructor===Object?(sourceKey=destination[key],sourceKey&&sourceKey.constructor===Object?mergeFn(sourceKey,value):destination[key]=cloneFn(value)):destination[key]=value}return destination},mergeIf:function(destination){for(var object,key,value,i=1,ln=arguments.length,cloneFn=Ext.clone;i<ln;i++){object=arguments[i];for(key in object)key in destination||(value=object[key],value&&value.constructor===Object?destination[key]=cloneFn(value):destination[key]=value)}return destination},getKey:function(object,value){for(var property in object)if(object.hasOwnProperty(property)&&object[property]===value)return property;return null},getValues:function(object){var property,values=[];for(property in object)object.hasOwnProperty(property)&&values.push(object[property]);return values},getKeys:"function"==typeof Object.keys?function(object){return object?Object.keys(object):[]}:function(object){var property,keys=[];for(property in object)object.hasOwnProperty(property)&&keys.push(property);return keys},getSize:function(object){var property,size=0;for(property in object)object.hasOwnProperty(property)&&size++;return size},isEmpty:function(object){for(var key in object)if(object.hasOwnProperty(key))return!1;return!0},equals:function(){var check=function(o1,o2){var key;for(key in o1)if(o1.hasOwnProperty(key)&&o1[key]!==o2[key])return!1;return!0};return function(object1,object2){return object1===object2||(object1&&object2?check(object1,object2)&&check(object2,object1):!object1&&!object2&&object1===object2)}}(),classify:function(object){var key,value,prototype=object,objectProperties=[],propertyClassesMap={},objectClass=function(){for(var property,i=0,ln=objectProperties.length;i<ln;i++)property=objectProperties[i],this[property]=new propertyClassesMap[property]};for(key in object)object.hasOwnProperty(key)&&(value=object[key],value&&value.constructor===Object&&(objectProperties.push(key),propertyClassesMap[key]=ExtObject.classify(value)));return objectClass.prototype=prototype,objectClass}};Ext.merge=Ext.Object.merge,Ext.mergeIf=Ext.Object.mergeIf,Ext.urlEncode=function(){var args=Ext.Array.from(arguments),prefix="";return"string"==typeof args[1]&&(prefix=args[1]+"&",args[1]=!1),prefix+ExtObject.toQueryString.apply(ExtObject,args)},Ext.urlDecode=function(){return ExtObject.fromQueryString.apply(ExtObject,arguments)}}(),Ext.Date=new function(){function xf(format){var args=Array.prototype.slice.call(arguments,1);return format.replace(numberTokenRe,function(m,i){return args[i]})}var utilDate=this,stripEscapeRe=/(\\.)/g,hourInfoRe=/([gGhHisucUOPZ]|MS)/,dateInfoRe=/([djzmnYycU]|MS)/,slashRe=/\\/gi,numberTokenRe=/\{(\d+)\}/g,MSFormatRe=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),code=["var me = this, dt, y, m, d, h, i, s, ms, o, O, z, zz, u, v, W, year, jan4, week1monday, daysInMonth, dayMatched,","def = me.defaults,","from = Ext.Number.from,","results = String(input).match(me.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = me.clearTime(new Date);","y = from(y, from(def.y, dt.getFullYear()));","m = from(m, from(def.m - 1, dt.getMonth()));","dayMatched = d !== undefined;","d = from(d, from(def.d, dt.getDate()));","if (!dayMatched) {","dt.setDate(1);","dt.setMonth(m);","dt.setFullYear(y);","daysInMonth = me.getDaysInMonth(dt);","if (d > daysInMonth) {","d = daysInMonth;","}","}","h  = from(h, from(def.h, dt.getHours()));","i  = from(i, from(def.i, dt.getMinutes()));","s  = from(s, from(def.s, dt.getSeconds()));","ms = from(ms, from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = me.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (me.isLeapYear(v) && z <= 365))? me.add(v, me.DAY, z) : null);","}else if(strict === true && !me.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","if (W) {","year = y || (new Date()).getFullYear(),","jan4 = new Date(year, 0, 4, 0, 0, 0),","week1monday = new Date(jan4.getTime() - ((jan4.getDay() - 1) * 86400000));","v = Ext.Date.clearTime(new Date(week1monday.getTime() + ((W - 1) * 604800000)));","} else {","v = me.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), me.YEAR, y < 100 ? y - 100 : 0);","}","}","}","}","if(v){","if(zz != null){","v = me.add(v, me.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = me.add(v, me.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");Ext.apply(utilDate,{now:Date.now||function(){return+new Date},toString:function(date){var pad=Ext.String.leftPad;return date.getFullYear()+"-"+pad(date.getMonth()+1,2,"0")+"-"+pad(date.getDate(),2,"0")+"T"+pad(date.getHours(),2,"0")+":"+pad(date.getMinutes(),2,"0")+":"+pad(date.getSeconds(),2,"0")},getElapsed:function(dateA,dateB){return Math.abs(dateA-(dateB||utilDate.now()))},useStrict:!1,formatCodeToRegex:function(character,currentGroup){var p=utilDate.parseCodes[character];return p&&(p="function"==typeof p?p():p,utilDate.parseCodes[character]=p),p?Ext.applyIf({c:p.c?xf(p.c,currentGroup||"{0}"):p.c},p):{g:0,c:null,s:Ext.String.escapeRegex(character)}},parseFunctions:{MS:function(input,strict){var r=(input||"").match(MSFormatRe);return r?new Date(1*((r[1]||"")+r[2])):null},time:function(input,strict){var num=parseInt(input,10);return num||0===num?new Date(num):null},timestamp:function(input,strict){var num=parseInt(input,10);return num||0===num?new Date(1e3*num):null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"},time:function(){return this.getTime().toString()},timestamp:function(){return utilDate.format(this,"U")}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{January:0,Jan:0,February:1,Feb:1,March:2,Mar:2,April:3,Apr:3,May:4,June:5,Jun:5,July:6,Jul:6,August:7,Aug:7,September:8,Sep:8,October:9,Oct:9,November:10,Nov:10,December:11,Dec:11},defaultFormat:"m/d/Y",getShortMonthName:function(month){return Ext.Date.monthNames[month].substring(0,3)},getShortDayName:function(day){return Ext.Date.dayNames[day].substring(0,3)},getMonthNumber:function(name){return Ext.Date.monthNumbers[name.substring(0,1).toUpperCase()+name.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(format){return hourInfoRe.test(format.replace(stripEscapeRe,""))},formatContainsDateInfo:function(format){return dateInfoRe.test(format.replace(stripEscapeRe,""))},unescapeFormat:function(format){return format.replace(slashRe,"")},formatCodes:{d:"Ext.String.leftPad(this.getDate(), 2, '0')",D:"Ext.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Ext.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"Ext.Date.getSuffix(this)",w:"this.getDay()",z:"Ext.Date.getDayOfYear(this)",W:"Ext.String.leftPad(Ext.Date.getWeekOfYear(this), 2, '0')",F:"Ext.Date.monthNames[this.getMonth()]",m:"Ext.String.leftPad(this.getMonth() + 1, 2, '0')",M:"Ext.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"Ext.Date.getDaysInMonth(this)",L:"(Ext.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (Ext.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (Ext.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"Ext.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"Ext.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"Ext.String.leftPad(this.getHours(), 2, '0')",i:"Ext.String.leftPad(this.getMinutes(), 2, '0')",s:"Ext.String.leftPad(this.getSeconds(), 2, '0')",u:"Ext.String.leftPad(this.getMilliseconds(), 3, '0')",O:"Ext.Date.getGMTOffset(this)",P:"Ext.Date.getGMTOffset(this, true)",T:"Ext.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){var c,code,i,l,e;for(c="Y-m-dTH:i:sP",code=[],i=0,l=c.length;i<l;++i)e=c.charAt(i),code.push("T"==e?"'T'":utilDate.getFormatCode(e));return code.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(y,m,d,h,i,s,ms){h=h||0,i=i||0,s=s||0,ms=ms||0;var dt=utilDate.add(new Date(y<100?100:y,m-1,d,h,i,s,ms),utilDate.YEAR,y<100?y-100:0);return y==dt.getFullYear()&&m==dt.getMonth()+1&&d==dt.getDate()&&h==dt.getHours()&&i==dt.getMinutes()&&s==dt.getSeconds()&&ms==dt.getMilliseconds()},parse:function(input,format,strict){var p=utilDate.parseFunctions;return null==p[format]&&utilDate.createParser(format),p[format].call(utilDate,input,Ext.isDefined(strict)?strict:utilDate.useStrict)},parseDate:function(input,format,strict){return utilDate.parse(input,format,strict)},getFormatCode:function(character){var f=utilDate.formatCodes[character];return f&&(f="function"==typeof f?f():f,utilDate.formatCodes[character]=f),f||"'"+Ext.String.escape(character)+"'"},createFormat:function(format){var i,code=[],special=!1,ch="";for(i=0;i<format.length;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,code.push("'"+Ext.String.escape(ch)+"'")):code.push(utilDate.getFormatCode(ch)):special=!0;utilDate.formatFunctions[format]=Ext.functionFactory("return "+code.join("+"))},createParser:function(format){for(var obj,regexNum=utilDate.parseRegexes.length,currentGroup=1,calc=[],regex=[],special=!1,ch="",i=0,len=format.length,atEnd=[];i<len;++i)ch=format.charAt(i),special||"\\"!=ch?special?(special=!1,regex.push(Ext.String.escape(ch))):(obj=utilDate.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex.push(obj.s),obj.g&&obj.c&&(obj.calcAtEnd?atEnd.push(obj.c):calc.push(obj.c))):special=!0;calc=calc.concat(atEnd),utilDate.parseRegexes[regexNum]=new RegExp("^"+regex.join("")+"$","i"),utilDate.parseFunctions[format]=Ext.functionFactory("input","strict",xf(code,regexNum,calc.join("")))},parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|0[1-9])"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|[1-9])"},D:function(){for(var a=[],i=0;i<7;a.push(utilDate.getShortDayName(i)),++i);return{g:0,c:null,s:"(?:"+a.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+utilDate.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:1,c:"W = parseInt(results[{0}], 10);\n",s:"(\\d{2})"},F:function(){return{g:1,c:"m = parseInt(me.getMonthNumber(results[{0}]), 10);\n",s:"("+utilDate.monthNames.join("|")+")"}},M:function(){for(var a=[],i=0;i<12;a.push(utilDate.getShortMonthName(i)),++i);return Ext.applyIf({s:"("+a.join("|")+")"},utilDate.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|0[1-9])"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|[1-9])"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > me.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)",calcAtEnd:!0},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)",calcAtEnd:!0},g:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|[0-9])"},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|1[0-9]|[0-9])"},h:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|0[1-9])"},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|[0-1][0-9])"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,5}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var i,l,calc=[],arr=[utilDate.formatCodeToRegex("Y",1),utilDate.formatCodeToRegex("m",2),utilDate.formatCodeToRegex("d",3),utilDate.formatCodeToRegex("H",4),utilDate.formatCodeToRegex("i",5),utilDate.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",utilDate.formatCodeToRegex("P",8).c,"}else{",utilDate.formatCodeToRegex("O",8).c,"}","}"].join("\n")}];for(i=0,l=arr.length;i<l;++i)calc.push(arr[i].c);return{g:1,c:calc.join(""),s:[arr[0].s,"(?:","-",arr[1].s,"(?:","-",arr[2].s,"(?:","(?:T| )?",arr[3].s,":",arr[4].s,"(?::",arr[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(date,format){return utilDate.format(date,format)},isEqual:function(date1,date2){return date1&&date2?date1.getTime()===date2.getTime():!(date1||date2)},format:function(date,format){var formatFunctions=utilDate.formatFunctions;return Ext.isDate(date)?(null==formatFunctions[format]&&utilDate.createFormat(format),formatFunctions[format].call(date)+""):""},getTimezone:function(date){return date.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,5})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(date,colon){var offset=date.getTimezoneOffset();return(offset>0?"-":"+")+Ext.String.leftPad(Math.floor(Math.abs(offset)/60),2,"0")+(colon?":":"")+Ext.String.leftPad(Math.abs(offset%60),2,"0")},getDayOfYear:function(date){var i,num=0,d=Ext.Date.clone(date),m=date.getMonth();for(i=0,d.setDate(1),d.setMonth(0);i<m;d.setMonth(++i))num+=utilDate.getDaysInMonth(d);return num+date.getDate()-1},getWeekOfYear:function(){var ms1d=864e5,ms7d=7*ms1d;return function(date){var DC3=Date.UTC(date.getFullYear(),date.getMonth(),date.getDate()+3)/ms1d,AWN=Math.floor(DC3/7),Wyr=new Date(AWN*ms7d).getUTCFullYear();return AWN-Math.floor(Date.UTC(Wyr,0,7)/ms7d)+1}}(),isLeapYear:function(date){var year=date.getFullYear();return!(0!=(3&year)||!(year%100||year%400==0&&year))},getFirstDayOfMonth:function(date){var day=(date.getDay()-(date.getDate()-1))%7;return day<0?day+7:day},getLastDayOfMonth:function(date){return utilDate.getLastDateOfMonth(date).getDay()},getFirstDateOfMonth:function(date){return new Date(date.getFullYear(),date.getMonth(),1)},getLastDateOfMonth:function(date){return new Date(date.getFullYear(),date.getMonth(),utilDate.getDaysInMonth(date))},getDaysInMonth:function(){var daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31];return function(date){var m=date.getMonth();return 1==m&&utilDate.isLeapYear(date)?29:daysInMonth[m]}}(),getSuffix:function(date){switch(date.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(date){return new Date(date.getTime())},isDST:function(date){return new Date(date.getFullYear(),0,1).getTimezoneOffset()!=date.getTimezoneOffset()},clearTime:function(date,clone){if(clone)return Ext.Date.clearTime(Ext.Date.clone(date));var hr,c,d=date.getDate();if(date.setHours(0),date.setMinutes(0),date.setSeconds(0),date.setMilliseconds(0),date.getDate()!=d){for(hr=1,c=utilDate.add(date,Ext.Date.HOUR,hr);c.getDate()!=d;hr++,c=utilDate.add(date,Ext.Date.HOUR,hr));date.setDate(d),date.setHours(c.getHours())}return date},add:function(date,interval,value){var day,decimalValue,d=Ext.Date.clone(date),base=(Ext.Date,0);if(!interval||0===value)return d;if(decimalValue=value-parseInt(value,10),value=parseInt(value,10))switch(interval.toLowerCase()){case Ext.Date.MILLI:d.setTime(d.getTime()+value);break;case Ext.Date.SECOND:d.setTime(d.getTime()+1e3*value);break;case Ext.Date.MINUTE:d.setTime(d.getTime()+60*value*1e3);break;case Ext.Date.HOUR:d.setTime(d.getTime()+60*value*60*1e3);break;case Ext.Date.DAY:d.setDate(d.getDate()+value);break;case Ext.Date.MONTH:day=date.getDate(),day>28&&(day=Math.min(day,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(date),Ext.Date.MONTH,value)).getDate())),d.setDate(day),d.setMonth(date.getMonth()+value);break;case Ext.Date.YEAR:day=date.getDate(),day>28&&(day=Math.min(day,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(date),Ext.Date.YEAR,value)).getDate())),d.setDate(day),d.setFullYear(date.getFullYear()+value)}if(decimalValue){switch(interval.toLowerCase()){case Ext.Date.MILLI:base=1;break;case Ext.Date.SECOND:base=1e3;break;case Ext.Date.MINUTE:base=6e4;break;case Ext.Date.HOUR:base=36e5;break;case Ext.Date.DAY:base=864e5;break;case Ext.Date.MONTH:day=utilDate.getDaysInMonth(d),base=864e5*day;break;case Ext.Date.YEAR:day=utilDate.isLeapYear(d)?366:365,base=864e5*day}base&&d.setTime(d.getTime()+base*decimalValue)}return d},subtract:function(date,interval,value){return utilDate.add(date,interval,-value)},between:function(date,start,end){var t=date.getTime();return start.getTime()<=t&&t<=end.getTime()},compat:function(){var p,stat,prot,s,nativeDate=window.Date,statics=["useStrict","formatCodeToRegex","parseFunctions","parseRegexes","formatFunctions","y2kYear","MILLI","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","defaults","dayNames","monthNames","monthNumbers","getShortMonthName","getShortDayName","getMonthNumber","formatCodes","isValid","parseDate","getFormatCode","createFormat","createParser","parseCodes"],proto=["dateFormat","format","getTimezone","getGMTOffset","getDayOfYear","getWeekOfYear","isLeapYear","getFirstDayOfMonth","getLastDayOfMonth","getDaysInMonth","getSuffix","clone","isDST","clearTime","add","between"],sLen=statics.length,pLen=proto.length;for(s=0;s<sLen;s++)stat=statics[s],nativeDate[stat]=utilDate[stat];for(p=0;p<pLen;p++)prot=proto[p],nativeDate.prototype[prot]=function(){var args=Array.prototype.slice.call(arguments);return args.unshift(this),utilDate[prot].apply(utilDate,args)}}})},function(flexSetter){var noArgs=[],Base=function(){},hookFunctionFactory=function(hookFunction,underriddenFunction,methodName,owningClass){var result=function(){var result=this.callParent(arguments);return hookFunction.apply(this,arguments),result};return result.$name=methodName,result.$owner=owningClass,underriddenFunction&&(result.$previous=underriddenFunction.$previous,underriddenFunction.$previous=result),result};Ext.apply(Base,{$className:"Ext.Base",$isClass:!0,create:function(){return Ext.create.apply(Ext,[this].concat(Array.prototype.slice.call(arguments,0)))},extend:function(parent){var basePrototype,prototype,i,ln,name,statics,parentPrototype=parent.prototype;if(prototype=this.prototype=Ext.Object.chain(parentPrototype),prototype.self=this,this.superclass=prototype.superclass=parentPrototype,!parent.$isClass){basePrototype=Ext.Base.prototype;for(i in basePrototype)i in prototype&&(prototype[i]=basePrototype[i])}if(statics=parentPrototype.$inheritableStatics)for(i=0,ln=statics.length;i<ln;i++)name=statics[i],this.hasOwnProperty(name)||(this[name]=parent[name]);parent.$onExtended&&(this.$onExtended=parent.$onExtended.slice()),prototype.config=new prototype.configClass,prototype.initConfigList=prototype.initConfigList.slice(),prototype.initConfigMap=Ext.clone(prototype.initConfigMap),prototype.configMap=Ext.Object.chain(prototype.configMap)},$onExtended:[],triggerExtended:function(){var i,callback,callbacks=this.$onExtended,ln=callbacks.length;if(ln>0)for(i=0;i<ln;i++)callback=callbacks[i],callback.fn.apply(callback.scope||this,arguments)},onExtended:function(fn,scope){return this.$onExtended.push({fn:fn,scope:scope}),this},addConfig:function(config,fullMerge){var initializedName,name,value,prototype=this.prototype,configNameCache=Ext.Class.configNameCache,hasConfig=prototype.configMap,initConfigList=prototype.initConfigList,initConfigMap=prototype.initConfigMap,defaultConfig=prototype.config;for(name in config)config.hasOwnProperty(name)&&(hasConfig[name]||(hasConfig[name]=!0),value=config[name],initializedName=configNameCache[name].initialized,initConfigMap[name]||null===value||prototype[initializedName]||(initConfigMap[name]=!0,initConfigList.push(name)));fullMerge?Ext.merge(defaultConfig,config):Ext.mergeIf(defaultConfig,config),prototype.configClass=Ext.Object.classify(defaultConfig)},addStatics:function(members){var member,name;for(name in members)members.hasOwnProperty(name)&&(member=members[name],"function"!=typeof member||member.$isClass||member===Ext.emptyFn||member===Ext.identityFn||(member.$owner=this,member.$name=name),this[name]=member);return this},addInheritableStatics:function(members){var inheritableStatics,hasInheritableStatics,name,member,prototype=this.prototype;inheritableStatics=prototype.$inheritableStatics,hasInheritableStatics=prototype.$hasInheritableStatics,inheritableStatics||(inheritableStatics=prototype.$inheritableStatics=[],hasInheritableStatics=prototype.$hasInheritableStatics={});for(name in members)members.hasOwnProperty(name)&&(member=members[name],this[name]=member,hasInheritableStatics[name]||(hasInheritableStatics[name]=!0,inheritableStatics.push(name)));return this},addMembers:function(members){var i,ln,name,member,prototype=this.prototype,enumerables=Ext.enumerables,names=[];for(name in members)names.push(name);for(enumerables&&names.push.apply(names,enumerables),i=0,ln=names.length;i<ln;i++)name=names[i],members.hasOwnProperty(name)&&(member=members[name],"function"!=typeof member||member.$isClass||member===Ext.emptyFn||member===Ext.identityFn||(member.$owner=this,member.$name=name),prototype[name]=member);return this},addMember:function(name,member){return"function"!=typeof member||member.$isClass||member===Ext.emptyFn||member===Ext.identityFn||(member.$owner=this,member.$name=name),this.prototype[name]=member,this},implement:function(){this.addMembers.apply(this,arguments)},borrow:function(fromClass,members){var i,ln,name,fn,toBorrow,prototype=this.prototype,fromPrototype=fromClass.prototype;for(members=Ext.Array.from(members),i=0,ln=members.length;i<ln;i++)name=members[i],toBorrow=fromPrototype[name],"function"==typeof toBorrow?(fn=Ext.Function.clone(toBorrow),fn.$owner=this,fn.$name=name,prototype[name]=fn):prototype[name]=toBorrow;return this},override:function(members){var name,index,member,statics,names,previous,me=this,enumerables=Ext.enumerables,target=me.prototype,cloneFunction=Ext.Function.clone;2===arguments.length&&(name=members,members={},members[name]=arguments[1],enumerables=null);do{names=[],statics=null;for(name in members)"statics"==name?statics=members[name]:"inheritableStatics"==name?me.addInheritableStatics(members[name]):"config"==name?me.addConfig(members[name],!0):names.push(name);for(enumerables&&names.push.apply(names,enumerables),index=names.length;index--;)name=names[index],members.hasOwnProperty(name)&&(member=members[name],"function"!=typeof member||member.$className||member===Ext.emptyFn||member===Ext.identityFn||("undefined"!=typeof member.$owner&&(member=cloneFunction(member)),member.$owner=me,member.$name=name,previous=target.hasOwnProperty(name)&&target[name],previous&&(member.$previous=previous)),target[name]=member);target=me,members=statics}while(members);return this},callParent:function(args){var method;return(method=this.callParent.caller)&&(method.$previous||(method=method.$owner?method:method.caller)&&method.$owner.superclass.self[method.$name]).apply(this,args||noArgs)},callSuper:function(args){var method;return(method=this.callSuper.caller)&&((method=method.$owner?method:method.caller)&&method.$owner.superclass.self[method.$name]).apply(this,args||noArgs)},mixin:function(name,mixinClass){var key,statics,i,ln,staticName,mixinValue,hookKey,hookFunction,me=this,mixin=mixinClass.prototype,prototype=me.prototype;"undefined"!=typeof mixin.onClassMixedIn&&mixin.onClassMixedIn.call(mixinClass,me),prototype.hasOwnProperty("mixins")||("mixins"in prototype?prototype.mixins=Ext.Object.chain(prototype.mixins):prototype.mixins={});for(key in mixin)if(mixinValue=mixin[key],"mixins"===key)Ext.merge(prototype.mixins,mixinValue);else if("xhooks"===key)for(hookKey in mixinValue)hookFunction=mixinValue[hookKey],hookFunction.$previous=Ext.emptyFn,prototype.hasOwnProperty(hookKey)?hookFunctionFactory(hookFunction,prototype[hookKey],hookKey,me):prototype[hookKey]=hookFunctionFactory(hookFunction,null,hookKey,me);else"mixinId"!==key&&"config"!==key&&void 0===prototype[key]&&(prototype[key]=mixinValue);if(statics=mixin.$inheritableStatics)for(i=0,ln=statics.length;i<ln;i++)staticName=statics[i],me.hasOwnProperty(staticName)||(me[staticName]=mixinClass[staticName]);return"config"in mixin&&me.addConfig(mixin.config,!1),prototype.mixins[name]=mixin,me},getName:function(){return Ext.getClassName(this)},createAlias:flexSetter(function(alias,origin){this.override(alias,function(){return this[origin].apply(this,arguments)})}),addXtype:function(xtype){var prototype=this.prototype,xtypesMap=prototype.xtypesMap,xtypes=prototype.xtypes,xtypesChain=prototype.xtypesChain;return prototype.hasOwnProperty("xtypesMap")||(xtypesMap=prototype.xtypesMap=Ext.merge({},prototype.xtypesMap||{}),xtypes=prototype.xtypes=prototype.xtypes?[].concat(prototype.xtypes):[],xtypesChain=prototype.xtypesChain=prototype.xtypesChain?[].concat(prototype.xtypesChain):[],prototype.xtype=xtype),xtypesMap[xtype]||(xtypesMap[xtype]=!0,xtypes.push(xtype),xtypesChain.push(xtype),Ext.ClassManager.setAlias(this,"widget."+xtype)),this}}),Base.implement({isInstance:!0,$className:"Ext.Base",configClass:Ext.emptyFn,initConfigList:[],configMap:{},initConfigMap:{},statics:function(){var method=this.statics.caller,self=this.self;return method?method.$owner:self},callParent:function(args){var method,superMethod=(method=this.callParent.caller)&&(method.$previous||(method=method.$owner?method:method.caller)&&method.$owner.superclass[method.$name]);return superMethod.apply(this,args||noArgs)},callSuper:function(args){var method,superMethod=(method=this.callSuper.caller)&&(method=method.$owner?method:method.caller)&&method.$owner.superclass[method.$name];return superMethod.apply(this,args||noArgs)},self:Base,constructor:function(){return this},initConfig:function(config){var nameMap,i,ln,name,initializedName,instanceConfig=config,configNameCache=Ext.Class.configNameCache,defaultConfig=new this.configClass,defaultConfigList=this.initConfigList,hasConfig=this.configMap;if(this.initConfig=Ext.emptyFn,this.initialConfig=instanceConfig||{},this.config=config=instanceConfig?Ext.merge(defaultConfig,config):defaultConfig,instanceConfig){defaultConfigList=defaultConfigList.slice();for(name in instanceConfig)hasConfig[name]&&null!==instanceConfig[name]&&(defaultConfigList.push(name),this[configNameCache[name].initialized]=!1)}for(i=0,ln=defaultConfigList.length;i<ln;i++)name=defaultConfigList[i],nameMap=configNameCache[name],initializedName=nameMap.initialized,this[initializedName]||(this[initializedName]=!0,this[nameMap.set].call(this,config[name]));return this},hasConfig:function(name){return Boolean(this.configMap[name])},setConfig:function(config,applyIfNotSet){if(!config)return this;var name,value,configNameCache=Ext.Class.configNameCache,currentConfig=this.config,hasConfig=this.configMap,initialConfig=this.initialConfig;applyIfNotSet=Boolean(applyIfNotSet);for(name in config)applyIfNotSet&&initialConfig.hasOwnProperty(name)||(value=config[name],currentConfig[name]=value,hasConfig[name]&&this[configNameCache[name].set](value));return this},getConfig:function(name){var configNameCache=Ext.Class.configNameCache;return this[configNameCache[name].get]()},getInitialConfig:function(name){var config=this.config;return name?config[name]:config},onConfigUpdate:function(names,callback,scope){var i,ln,name,updaterName,updater,newUpdater,self=this.self;for(names=Ext.Array.from(names),scope=scope||this,i=0,ln=names.length;i<ln;i++)name=names[i],updaterName="update"+Ext.String.capitalize(name),updater=this[updaterName]||Ext.emptyFn,newUpdater=function(){updater.apply(this,arguments),scope[callback].apply(scope,arguments)},newUpdater.$name=updaterName,newUpdater.$owner=self,this[updaterName]=newUpdater},destroy:function(){this.destroy=Ext.emptyFn}}),Base.prototype.callOverridden=Base.prototype.callParent,Ext.Base=Base}(Ext.Function.flexSetter),function(){function makeCtor(className){function constructor(){return this.constructor.apply(this,arguments)||null}return constructor}var ExtClass,baseStaticMember,baseStaticMemberLength,Base=Ext.Base,baseStaticMembers=[];for(baseStaticMember in Base)Base.hasOwnProperty(baseStaticMember)&&baseStaticMembers.push(baseStaticMember);
baseStaticMemberLength=baseStaticMembers.length,Ext.Class=ExtClass=function(Class,data,onCreated){return"function"!=typeof Class&&(onCreated=data,data=Class,Class=null),data||(data={}),Class=ExtClass.create(Class,data),ExtClass.process(Class,data,onCreated),Class},Ext.apply(ExtClass,{onBeforeCreated:function(Class,data,hooks){Class.addMembers(data),hooks.onCreated.call(Class,Class)},create:function(Class,data){var name,i;for(Class||(Class=makeCtor()),i=0;i<baseStaticMemberLength;i++)name=baseStaticMembers[i],Class[name]=Base[name];return Class},process:function(Class,data,onCreated){var preprocessor,preprocessorsProperties,i,ln,j,subLn,preprocessorProperty,preprocessorStack=data.preprocessors||ExtClass.defaultPreprocessors,registeredPreprocessors=this.preprocessors,hooks={onBeforeCreated:this.onBeforeCreated},preprocessors=[];for(delete data.preprocessors,i=0,ln=preprocessorStack.length;i<ln;i++)if(preprocessor=preprocessorStack[i],"string"==typeof preprocessor){if(preprocessor=registeredPreprocessors[preprocessor],preprocessorsProperties=preprocessor.properties,preprocessorsProperties===!0)preprocessors.push(preprocessor.fn);else if(preprocessorsProperties)for(j=0,subLn=preprocessorsProperties.length;j<subLn;j++)if(preprocessorProperty=preprocessorsProperties[j],data.hasOwnProperty(preprocessorProperty)){preprocessors.push(preprocessor.fn);break}}else preprocessors.push(preprocessor);hooks.onCreated=onCreated?onCreated:Ext.emptyFn,hooks.preprocessors=preprocessors,this.doProcess(Class,data,hooks)},doProcess:function(Class,data,hooks){for(var me=this,preprocessors=hooks.preprocessors,preprocessor=preprocessors.shift(),doProcess=me.doProcess;preprocessor;preprocessor=preprocessors.shift())if(preprocessor.call(me,Class,data,hooks,doProcess)===!1)return;hooks.onBeforeCreated.apply(me,arguments)},preprocessors:{},registerPreprocessor:function(name,fn,properties,position,relativeTo){return position||(position="last"),properties||(properties=[name]),this.preprocessors[name]={name:name,properties:properties||!1,fn:fn},this.setDefaultPreprocessorPosition(name,position,relativeTo),this},getPreprocessor:function(name){return this.preprocessors[name]},getPreprocessors:function(){return this.preprocessors},defaultPreprocessors:[],getDefaultPreprocessors:function(){return this.defaultPreprocessors},setDefaultPreprocessors:function(preprocessors){return this.defaultPreprocessors=Ext.Array.from(preprocessors),this},setDefaultPreprocessorPosition:function(name,offset,relativeName){var index,defaultPreprocessors=this.defaultPreprocessors;if("string"==typeof offset){if("first"===offset)return defaultPreprocessors.unshift(name),this;if("last"===offset)return defaultPreprocessors.push(name),this;offset="after"===offset?1:-1}return index=Ext.Array.indexOf(defaultPreprocessors,relativeName),index!==-1&&Ext.Array.splice(defaultPreprocessors,Math.max(0,index+offset),0,name),this},configNameCache:{},getConfigNameMap:function(name){var capitalizedName,cache=this.configNameCache,map=cache[name];return map||(capitalizedName=name.charAt(0).toUpperCase()+name.substr(1),map=cache[name]={internal:name,initialized:"_is"+capitalizedName+"Initialized",apply:"apply"+capitalizedName,update:"update"+capitalizedName,set:"set"+capitalizedName,get:"get"+capitalizedName,doSet:"doSet"+capitalizedName,changeEvent:name.toLowerCase()+"change"}),map}}),ExtClass.registerPreprocessor("extend",function(Class,data,hooks){var Parent,parentPrototype,i,Base=Ext.Base,basePrototype=Base.prototype,extend=data.extend;if(delete data.extend,Parent=extend&&extend!==Object?extend:Base,parentPrototype=Parent.prototype,!Parent.$isClass)for(i in basePrototype)parentPrototype[i]||(parentPrototype[i]=basePrototype[i]);Class.extend(Parent),Class.triggerExtended.apply(Class,arguments),data.onClassExtended&&(Class.onExtended(data.onClassExtended,Class),delete data.onClassExtended)},!0),ExtClass.registerPreprocessor("statics",function(Class,data){Class.addStatics(data.statics),delete data.statics}),ExtClass.registerPreprocessor("inheritableStatics",function(Class,data){Class.addInheritableStatics(data.inheritableStatics),delete data.inheritableStatics}),ExtClass.registerPreprocessor("config",function(Class,data){var config=data.config,prototype=Class.prototype;delete data.config,Ext.Object.each(config,function(name,value){var optimizedGetter,customGetter,nameMap=ExtClass.getConfigNameMap(name),internalName=nameMap.internal,initializedName=nameMap.initialized,applyName=nameMap.apply,updateName=nameMap.update,setName=nameMap.set,getName=nameMap.get,hasOwnSetter=setName in prototype||data.hasOwnProperty(setName),hasOwnApplier=applyName in prototype||data.hasOwnProperty(applyName),hasOwnUpdater=updateName in prototype||data.hasOwnProperty(updateName);null!==value&&(hasOwnSetter||hasOwnApplier||hasOwnUpdater)?prototype[initializedName]=!1:(prototype[internalName]=value,prototype[initializedName]=!0),hasOwnSetter||(data[setName]=function(value){var oldValue=this[internalName],applier=this[applyName],updater=this[updateName];return this[initializedName]||(this[initializedName]=!0),applier&&(value=applier.call(this,value,oldValue)),"undefined"!=typeof value&&(this[internalName]=value,updater&&value!==oldValue&&updater.call(this,value,oldValue)),this}),getName in prototype&&!data.hasOwnProperty(getName)||(customGetter=data[getName]||!1,optimizedGetter=customGetter?function(){return customGetter.apply(this,arguments)}:function(){return this[internalName]},data[getName]=function(){var currentGetter;return this[initializedName]||(this[initializedName]=!0,this[setName](this.config[name])),currentGetter=this[getName],"$previous"in currentGetter?currentGetter.$previous=optimizedGetter:this[getName]=optimizedGetter,optimizedGetter.apply(this,arguments)})}),Class.addConfig(config,!0)}),ExtClass.registerPreprocessor("mixins",function(Class,data,hooks){var name,mixin,i,ln,mixins=data.mixins;delete data.mixins,Ext.Function.interceptBefore(hooks,"onCreated",function(){if(mixins instanceof Array)for(i=0,ln=mixins.length;i<ln;i++)mixin=mixins[i],name=mixin.prototype.mixinId||mixin.$className,Class.mixin(name,mixin);else for(var mixinName in mixins)mixins.hasOwnProperty(mixinName)&&Class.mixin(mixinName,mixins[mixinName])})}),Ext.extend=function(Class,Parent,members){2===arguments.length&&Ext.isObject(Parent)&&(members=Parent,Parent=Class,Class=null);var cls;if(!Parent)throw new Error("[Ext.extend] Attempting to extend from a class which has not been loaded on the page.");return members.extend=Parent,members.preprocessors=["extend","statics","inheritableStatics","mixins","config"],Class?(cls=new ExtClass(Class,members),cls.prototype.constructor=Class):cls=new ExtClass(members),cls.prototype.override=function(o){for(var m in o)o.hasOwnProperty(m)&&(this[m]=o[m])},cls}}(),function(Class,alias,arraySlice,arrayFrom,global){function makeCtor(){function constructor(){return this.constructor.apply(this,arguments)||null}return constructor}var Manager=Ext.ClassManager={classes:{},existCache:{},namespaceRewrites:[{from:"Ext.",to:Ext}],maps:{alternateToName:{},aliasToName:{},nameToAliases:{},nameToAlternates:{}},enableNamespaceParseCache:!0,namespaceParseCache:{},instantiators:[],isCreated:function(className){var i,ln,part,root,parts,existCache=this.existCache;if(this.classes[className]||existCache[className])return!0;for(root=global,parts=this.parseNamespace(className),i=0,ln=parts.length;i<ln;i++)if(part=parts[i],"string"!=typeof part)root=part;else{if(!root||!root[part])return!1;root=root[part]}return existCache[className]=!0,this.triggerCreated(className),!0},createdListeners:[],nameCreatedListeners:{},triggerCreated:function(className){var i,ln,j,subLn,listener,name,listeners=this.createdListeners,nameListeners=this.nameCreatedListeners,alternateNames=this.maps.nameToAlternates[className],names=[className];for(i=0,ln=listeners.length;i<ln;i++)listener=listeners[i],listener.fn.call(listener.scope,className);for(alternateNames&&names.push.apply(names,alternateNames),i=0,ln=names.length;i<ln;i++)if(name=names[i],listeners=nameListeners[name]){for(j=0,subLn=listeners.length;j<subLn;j++)listener=listeners[j],listener.fn.call(listener.scope,name);delete nameListeners[name]}},onCreated:function(fn,scope,className){var listeners=this.createdListeners,nameListeners=this.nameCreatedListeners,listener={fn:fn,scope:scope};if(className){if(this.isCreated(className))return void fn.call(scope,className);nameListeners[className]||(nameListeners[className]=[]),nameListeners[className].push(listener)}else listeners.push(listener)},parseNamespace:function(namespace){var parts,rewrites,root,name,rewrite,from,to,i,ln,cache=this.namespaceParseCache;if(this.enableNamespaceParseCache&&cache.hasOwnProperty(namespace))return cache[namespace];for(parts=[],rewrites=this.namespaceRewrites,root=global,name=namespace,i=0,ln=rewrites.length;i<ln;i++)if(rewrite=rewrites[i],from=rewrite.from,to=rewrite.to,name===from||name.substring(0,from.length)===from){name=name.substring(from.length),"string"!=typeof to?root=to:parts=parts.concat(to.split("."));break}return parts.push(root),parts=parts.concat(name.split(".")),this.enableNamespaceParseCache&&(cache[namespace]=parts),parts},setNamespace:function(name,value){var i,part,root=global,parts=this.parseNamespace(name),ln=parts.length-1,leaf=parts[ln];for(i=0;i<ln;i++)part=parts[i],"string"!=typeof part?root=part:(root[part]||(root[part]={}),root=root[part]);return root[leaf]=value,root[leaf]},createNamespaces:function(){var parts,part,i,j,ln,subLn,root=global;for(i=0,ln=arguments.length;i<ln;i++)for(parts=this.parseNamespace(arguments[i]),j=0,subLn=parts.length;j<subLn;j++)part=parts[j],"string"!=typeof part?root=part:(root[part]||(root[part]={}),root=root[part]);return root},set:function(name,value){var alternates,me=this,maps=me.maps,nameToAlternates=maps.nameToAlternates,targetName=me.getName(value);return me.classes[name]=me.setNamespace(name,value),targetName&&targetName!==name&&(maps.alternateToName[name]=targetName,alternates=nameToAlternates[targetName]||(nameToAlternates[targetName]=[]),alternates.push(name)),this},get:function(name){var root,parts,part,i,ln,classes=this.classes;if(classes[name])return classes[name];for(root=global,parts=this.parseNamespace(name),i=0,ln=parts.length;i<ln;i++)if(part=parts[i],"string"!=typeof part)root=part;else{if(!root||!root[part])return null;root=root[part]}return root},setAlias:function(cls,alias){var className,aliasToNameMap=this.maps.aliasToName,nameToAliasesMap=this.maps.nameToAliases;return className="string"==typeof cls?cls:this.getName(cls),alias&&aliasToNameMap[alias]!==className&&(aliasToNameMap[alias]=className),nameToAliasesMap[className]||(nameToAliasesMap[className]=[]),alias&&Ext.Array.include(nameToAliasesMap[className],alias),this},addNameAliasMappings:function(aliases){var className,aliasList,alias,i,aliasToNameMap=this.maps.aliasToName,nameToAliasesMap=this.maps.nameToAliases;for(className in aliases)for(aliasList=nameToAliasesMap[className]||(nameToAliasesMap[className]=[]),i=0;i<aliases[className].length;i++)alias=aliases[className][i],aliasToNameMap[alias]||(aliasToNameMap[alias]=className,aliasList.push(alias));return this},addNameAlternateMappings:function(alternates){var className,aliasList,alternate,i,alternateToName=this.maps.alternateToName,nameToAlternates=this.maps.nameToAlternates;for(className in alternates)for(aliasList=nameToAlternates[className]||(nameToAlternates[className]=[]),i=0;i<alternates[className].length;i++)alternate=alternates[className][i],alternateToName[alternate]||(alternateToName[alternate]=className,aliasList.push(alternate));return this},getByAlias:function(alias){return this.get(this.getNameByAlias(alias))},getNameByAlias:function(alias){return this.maps.aliasToName[alias]||""},getNameByAlternate:function(alternate){return this.maps.alternateToName[alternate]||""},getAliasesByName:function(name){return this.maps.nameToAliases[name]||[]},getName:function(object){return object&&object.$className||""},getClass:function(object){return object&&object.self||null},create:function(className,data,createdFn){var ctor=makeCtor();return"function"==typeof data&&(data=data(ctor)),data.$className=className,new Class(ctor,data,function(){var postprocessor,i,ln,j,subLn,postprocessorProperties,postprocessorProperty,postprocessorStack=data.postprocessors||Manager.defaultPostprocessors,registeredPostprocessors=Manager.postprocessors,postprocessors=[];for(delete data.postprocessors,i=0,ln=postprocessorStack.length;i<ln;i++)if(postprocessor=postprocessorStack[i],"string"==typeof postprocessor){if(postprocessor=registeredPostprocessors[postprocessor],postprocessorProperties=postprocessor.properties,postprocessorProperties===!0)postprocessors.push(postprocessor.fn);else if(postprocessorProperties)for(j=0,subLn=postprocessorProperties.length;j<subLn;j++)if(postprocessorProperty=postprocessorProperties[j],data.hasOwnProperty(postprocessorProperty)){postprocessors.push(postprocessor.fn);break}}else postprocessors.push(postprocessor);data.postprocessors=postprocessors,data.createdFn=createdFn,Manager.processCreate(className,this,data)})},processCreate:function(className,cls,clsData){var me=this,postprocessor=clsData.postprocessors.shift(),createdFn=clsData.createdFn;return postprocessor?void(postprocessor.call(me,className,cls,clsData,me.processCreate)!==!1&&me.processCreate(className,cls,clsData)):(className&&me.set(className,cls),createdFn&&createdFn.call(cls,cls),void(className&&me.triggerCreated(className)))},createOverride:function(className,data,createdFn){var me=this,overriddenClassName=data.override,requires=data.requires,uses=data.uses,compat=data.compatibility,classReady=function(){var cls,temp;requires?(temp=requires,requires=null,Ext.Loader.require(temp,classReady)):(cls=me.get(overriddenClassName),delete data.override,delete data.compatibility,delete data.requires,delete data.uses,Ext.override(cls,data),me.triggerCreated(className),uses&&Ext.Loader.addUsedClasses(uses),createdFn&&createdFn.call(cls))};return me.existCache[className]=!0,compat&&!Ext.checkVersion(compat)||me.onCreated(classReady,me,overriddenClassName),me},instantiateByAlias:function(){var alias=arguments[0],args=arraySlice.call(arguments),className=this.getNameByAlias(alias);return className||(className=this.maps.aliasToName[alias],Ext.syncRequire(className)),args[0]=className,this.instantiate.apply(this,args)},instantiate:function(){var possibleName,cls,name=arguments[0],nameType=typeof name,args=arraySlice.call(arguments,1);return"function"!=nameType?("string"!=nameType&&0===args.length&&(args=[name],name=name.xclass),cls=this.get(name)):cls=name,cls||(possibleName=this.getNameByAlias(name),possibleName&&(name=possibleName,cls=this.get(name))),cls||(possibleName=this.getNameByAlternate(name),possibleName&&(name=possibleName,cls=this.get(name))),cls||(Ext.syncRequire(name),cls=this.get(name)),this.getInstantiator(args.length)(cls,args)},dynInstantiate:function(name,args){return args=arrayFrom(args,!0),args.unshift(name),this.instantiate.apply(this,args)},getInstantiator:function(length){var instantiator,i,args,instantiators=this.instantiators;if(instantiator=instantiators[length],!instantiator){for(i=length,args=[],i=0;i<length;i++)args.push("a["+i+"]");instantiator=instantiators[length]=new Function("c","a","return new c("+args.join(",")+")")}return instantiator},postprocessors:{},defaultPostprocessors:[],registerPostprocessor:function(name,fn,properties,position,relativeTo){return position||(position="last"),properties||(properties=[name]),this.postprocessors[name]={name:name,properties:properties||!1,fn:fn},this.setDefaultPostprocessorPosition(name,position,relativeTo),this},setDefaultPostprocessors:function(postprocessors){return this.defaultPostprocessors=arrayFrom(postprocessors),this},setDefaultPostprocessorPosition:function(name,offset,relativeName){var index,defaultPostprocessors=this.defaultPostprocessors;if("string"==typeof offset){if("first"===offset)return defaultPostprocessors.unshift(name),this;if("last"===offset)return defaultPostprocessors.push(name),this;offset="after"===offset?1:-1}return index=Ext.Array.indexOf(defaultPostprocessors,relativeName),index!==-1&&Ext.Array.splice(defaultPostprocessors,Math.max(0,index+offset),0,name),this},getNamesByExpression:function(expression){var name,alias,aliases,possibleName,regex,i,ln,nameToAliasesMap=this.maps.nameToAliases,names=[];if(expression.indexOf("*")!==-1){expression=expression.replace(/\*/g,"(.*?)"),regex=new RegExp("^"+expression+"$");for(name in nameToAliasesMap)if(nameToAliasesMap.hasOwnProperty(name))if(aliases=nameToAliasesMap[name],name.search(regex)!==-1)names.push(name);else for(i=0,ln=aliases.length;i<ln;i++)if(alias=aliases[i],alias.search(regex)!==-1){names.push(name);break}}else possibleName=this.getNameByAlias(expression),possibleName?names.push(possibleName):(possibleName=this.getNameByAlternate(expression),possibleName?names.push(possibleName):names.push(expression));return names}};Manager.registerPostprocessor("alias",function(name,cls,data){var i,ln,aliases=data.alias;for(i=0,ln=aliases.length;i<ln;i++)alias=aliases[i],this.setAlias(cls,alias)},["xtype","alias"]),Manager.registerPostprocessor("singleton",function(name,cls,data,fn){return!data.singleton||(fn.call(this,name,new cls,data),!1)}),Manager.registerPostprocessor("alternateClassName",function(name,cls,data){var i,ln,alternate,alternates=data.alternateClassName;for(alternates instanceof Array||(alternates=[alternates]),i=0,ln=alternates.length;i<ln;i++)alternate=alternates[i],this.set(alternate,cls)}),Ext.apply(Ext,{create:alias(Manager,"instantiate"),widget:function(name,config){var alias,className,T,load,xtype=name;return"string"!=typeof xtype?(config=name,xtype=config.xtype):config=config||{},config.isComponent?config:(alias="widget."+xtype,className=Manager.getNameByAlias(alias),className||(load=!0),T=Manager.get(className),load||!T?Manager.instantiateByAlias(alias,config):new T(config))},createByAlias:alias(Manager,"instantiateByAlias"),define:function(className,data,createdFn){return data.override?Manager.createOverride.apply(Manager,arguments):Manager.create.apply(Manager,arguments)},undefine:function(className){var parts,partCount,namespace,i,classes=Manager.classes,maps=Manager.maps,aliasToName=maps.aliasToName,nameToAliases=maps.nameToAliases,alternateToName=maps.alternateToName,nameToAlternates=maps.nameToAlternates,aliases=nameToAliases[className],alternates=nameToAlternates[className];if(delete Manager.namespaceParseCache[className],delete nameToAliases[className],delete nameToAlternates[className],delete classes[className],aliases)for(i=aliases.length;i--;)delete aliasToName[aliases[i]];if(alternates)for(i=alternates.length;i--;)delete alternateToName[alternates[i]];for(parts=Manager.parseNamespace(className),partCount=parts.length-1,namespace=parts[0],i=1;i<partCount;i++)if(namespace=namespace[parts[i]],!namespace)return;try{delete namespace[parts[partCount]]}catch(e){namespace[parts[partCount]]=void 0}},getClassName:alias(Manager,"getName"),getDisplayName:function(object){if(object){if(object.displayName)return object.displayName;if(object.$name&&object.$class)return Ext.getClassName(object.$class)+"#"+object.$name;if(object.$className)return object.$className}return"Anonymous"},getClass:alias(Manager,"getClass"),namespace:alias(Manager,"createNamespaces")}),Ext.createWidget=Ext.widget,Ext.ns=Ext.namespace,Class.registerPreprocessor("className",function(cls,data){data.$className&&(cls.$className=data.$className)},!0,"first"),Class.registerPreprocessor("alias",function(cls,data){var i,ln,alias,xtype,prototype=cls.prototype,xtypes=arrayFrom(data.xtype),aliases=arrayFrom(data.alias),widgetPrefix="widget.",widgetPrefixLength=widgetPrefix.length,xtypesChain=Array.prototype.slice.call(prototype.xtypesChain||[]),xtypesMap=Ext.merge({},prototype.xtypesMap||{});for(i=0,ln=aliases.length;i<ln;i++)alias=aliases[i],alias.substring(0,widgetPrefixLength)===widgetPrefix&&(xtype=alias.substring(widgetPrefixLength),Ext.Array.include(xtypes,xtype));for(cls.xtype=data.xtype=xtypes[0],data.xtypes=xtypes,i=0,ln=xtypes.length;i<ln;i++)xtype=xtypes[i],xtypesMap[xtype]||(xtypesMap[xtype]=!0,xtypesChain.push(xtype));for(data.xtypesChain=xtypesChain,data.xtypesMap=xtypesMap,Ext.Function.interceptAfter(data,"onClassCreated",function(){var key,mixin,mixins=prototype.mixins;for(key in mixins)if(mixins.hasOwnProperty(key)&&(mixin=mixins[key],xtypes=mixin.xtypes))for(i=0,ln=xtypes.length;i<ln;i++)xtype=xtypes[i],xtypesMap[xtype]||(xtypesMap[xtype]=!0,xtypesChain.push(xtype))}),i=0,ln=xtypes.length;i<ln;i++)xtype=xtypes[i],Ext.Array.include(aliases,widgetPrefix+xtype);data.alias=aliases},["xtype","alias"])}(Ext.Class,Ext.Function.alias,Array.prototype.slice,Ext.Array.from,Ext.global),Ext._alternatesMetadata&&(Ext.ClassManager.addNameAlternateMappings(Ext._alternatesMetadata),Ext._alternatesMetadata=null),Ext._aliasMetadata&&(Ext.ClassManager.addNameAliasMappings(Ext._aliasMetadata),Ext._aliasMetadata=null),Ext.Loader=new function(){var Loader=this,Manager=Ext.ClassManager,Class=Ext.Class,flexSetter=Ext.Function.flexSetter,alias=Ext.Function.alias,pass=Ext.Function.pass,defer=Ext.Function.defer,arrayErase=Ext.Array.erase,dependencyProperties=["extend","mixins","requires"],isInHistory={},history=[],slashDotSlashRe=/\/\.\//g,dotRe=/\./g,setPathCount=0;Ext.apply(Loader,{isInHistory:isInHistory,history:history,config:{enabled:!1,scriptChainDelay:!1,disableCaching:!0,disableCachingParam:"_dc",garbageCollect:!1,paths:{Ext:"."},preserveScripts:!0,scriptCharset:void 0},setConfig:function(name,value){return Ext.isObject(name)&&1===arguments.length?(Ext.merge(Loader.config,name),"paths"in name&&Ext.app.collectNamespaces(name.paths)):(Loader.config[name]=Ext.isObject(value)?Ext.merge(Loader.config[name],value):value,"paths"===name&&Ext.app.collectNamespaces(value)),Loader},getConfig:function(name){return name?Loader.config[name]:Loader.config},setPath:flexSetter(function(name,path){return Loader.config.paths[name]=path,Ext.app.namespaces[name]=!0,setPathCount++,Loader}),addClassPathMappings:function(paths){var name;if(0==setPathCount)Loader.config.paths=paths;else for(name in paths)Loader.config.paths[name]=paths[name];return setPathCount++,Loader},getPath:function(className){var path="",paths=Loader.config.paths,prefix=Loader.getPrefix(className);if(prefix.length>0){if(prefix===className)return paths[prefix];path=paths[prefix],className=className.substring(prefix.length+1)}return path.length>0&&(path+="/"),path.replace(slashDotSlashRe,"/")+className.replace(dotRe,"/")+".js"},getPrefix:function(className){var prefix,paths=Loader.config.paths,deepestPrefix="";if(paths.hasOwnProperty(className))return className;for(prefix in paths)paths.hasOwnProperty(prefix)&&prefix+"."===className.substring(0,prefix.length+1)&&prefix.length>deepestPrefix.length&&(deepestPrefix=prefix);return deepestPrefix},isAClassNameWithAKnownPrefix:function(className){var prefix=Loader.getPrefix(className);return""!==prefix&&prefix!==className},require:function(expressions,fn,scope,excludes){fn&&fn.call(scope)},syncRequire:function(){},exclude:function(excludes){return{require:function(expressions,fn,scope){return Loader.require(expressions,fn,scope,excludes)},syncRequire:function(expressions,fn,scope){return Loader.syncRequire(expressions,fn,scope,excludes)}}},onReady:function(fn,scope,withDomReady,options){var oldFn;withDomReady!==!1&&Ext.onDocumentReady&&(oldFn=fn,fn=function(){Ext.onDocumentReady(oldFn,scope,options)}),fn.call(scope)}});var queue=[],isClassFileLoaded={},isFileLoaded={},classNameToFilePathMap={},scriptElements={},readyListeners=[],usedClasses=[],requiresMap={},comparePriority=function(listenerA,listenerB){return listenerB.priority-listenerA.priority};Ext.apply(Loader,{documentHead:"undefined"!=typeof document&&(document.head||document.getElementsByTagName("head")[0]),isLoading:!1,queue:queue,isClassFileLoaded:isClassFileLoaded,isFileLoaded:isFileLoaded,readyListeners:readyListeners,optionalRequires:usedClasses,requiresMap:requiresMap,numPendingFiles:0,numLoadedFiles:0,hasFileLoadError:!1,classNameToFilePathMap:classNameToFilePathMap,scriptsLoading:0,syncModeEnabled:!1,scriptElements:scriptElements,refreshQueue:function(){var i,item,j,requires,ln=queue.length;if(!ln&&!Loader.scriptsLoading)return Loader.triggerReady();for(i=0;i<ln;i++)if(item=queue[i]){if(requires=item.requires,requires.length>Loader.numLoadedFiles)continue;for(j=0;j<requires.length;)Manager.isCreated(requires[j])?arrayErase(requires,j,1):j++;if(0===item.requires.length){arrayErase(queue,i,1),item.callback.call(item.scope),Loader.refreshQueue();break}}return Loader},injectScriptElement:function(url,onLoad,onError,scope,charset){var script=document.createElement("script"),dispatched=!1,config=Loader.config,onLoadFn=function(){dispatched||(dispatched=!0,script.onload=script.onreadystatechange=script.onerror=null,"number"==typeof config.scriptChainDelay?defer(onLoad,config.scriptChainDelay,scope):onLoad.call(scope),Loader.cleanupScriptElement(script,config.preserveScripts===!1,config.garbageCollect))},onErrorFn=function(arg){defer(onError,1,scope),Loader.cleanupScriptElement(script,config.preserveScripts===!1,config.garbageCollect)};return script.type="text/javascript",script.onerror=onErrorFn,charset=charset||config.scriptCharset,charset&&(script.charset=charset),"addEventListener"in script?script.onload=onLoadFn:"readyState"in script?script.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||onLoadFn()}:script.onload=onLoadFn,script.src=url,(Loader.documentHead||document.getElementsByTagName("head")[0]).appendChild(script),script},removeScriptElement:function(url){return scriptElements[url]&&(Loader.cleanupScriptElement(scriptElements[url],!0,!!Loader.getConfig("garbageCollect")),delete scriptElements[url]),Loader},cleanupScriptElement:function(script,remove,collect){var prop;if(script.onload=script.onreadystatechange=script.onerror=null,remove&&(Ext.removeNode(script),collect))for(prop in script)try{"src"!=prop&&(script[prop]=null),delete script[prop]}catch(cleanEx){}return Loader},loadScript:function(options){var src,config=Loader.getConfig(),isString="string"==typeof options,url=isString?options:options.url,onError=!isString&&options.onError,onLoad=!isString&&options.onLoad,scope=!isString&&options.scope,onScriptError=function(){Loader.numPendingFiles--,Loader.scriptsLoading--,onError&&onError.call(scope,"Failed loading '"+url+"', please verify that the file exists"),Loader.numPendingFiles+Loader.scriptsLoading===0&&Loader.refreshQueue()},onScriptLoad=function(){Loader.numPendingFiles--,Loader.scriptsLoading--,onLoad&&onLoad.call(scope),Loader.numPendingFiles+Loader.scriptsLoading===0&&Loader.refreshQueue()};Loader.isLoading=!0,Loader.numPendingFiles++,Loader.scriptsLoading++,src=config.disableCaching?url+"?"+config.disableCachingParam+"="+Ext.Date.now():url,scriptElements[url]=Loader.injectScriptElement(src,onScriptLoad,onScriptError)},loadScriptFile:function(url,onLoad,onError,scope,synchronous){if(isFileLoaded[url])return Loader;var xhr,status,onScriptError,config=Loader.getConfig(),noCacheUrl=url+(config.disableCaching?"?"+config.disableCachingParam+"="+Ext.Date.now():""),isCrossOriginRestricted=!1,debugSourceURL="";if(scope=scope||Loader,Loader.isLoading=!0,synchronous){xhr="undefined"!=typeof XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");try{xhr.open("GET",noCacheUrl,!1),xhr.send(null)}catch(e){isCrossOriginRestricted=!0}status=1223===xhr.status?204:0!==xhr.status||"file:"!=(self.location||{}).protocol&&"ionp:"!=(self.location||{}).protocol?xhr.status:200,isCrossOriginRestricted=isCrossOriginRestricted||0===status,isCrossOriginRestricted||(status>=200&&status<300||304===status)&&(Ext.isIE||(debugSourceURL="\n//@ sourceURL="+url),Ext.globalEval(xhr.responseText+debugSourceURL),onLoad.call(scope)),xhr=null}else onScriptError=function(){},scriptElements[url]=Loader.injectScriptElement(noCacheUrl,onLoad,onScriptError,scope)},syncRequire:function(){var syncModeEnabled=Loader.syncModeEnabled;syncModeEnabled||(Loader.syncModeEnabled=!0),Loader.require.apply(Loader,arguments),syncModeEnabled||(Loader.syncModeEnabled=!1),Loader.refreshQueue()},require:function(expressions,fn,scope,excludes){var callback,syncModeEnabled,filePath,expression,exclude,className,possibleClassName,i,j,ln,subLn,excluded={},included={},excludedClassNames=[],possibleClassNames=[],classNames=[],references=[];if(excludes)for(excludes="string"==typeof excludes?[excludes]:excludes,i=0,ln=excludes.length;i<ln;i++)if(exclude=excludes[i],"string"==typeof exclude&&exclude.length>0)for(excludedClassNames=Manager.getNamesByExpression(exclude),j=0,subLn=excludedClassNames.length;j<subLn;j++)excluded[excludedClassNames[j]]=!0;for(expressions="string"==typeof expressions?[expressions]:expressions?expressions:[],callback=fn?fn.length>0?function(){var i,ln,classes=[];for(i=0,ln=references.length;i<ln;i++)classes.push(Manager.get(references[i]));return fn.apply(this,classes)}:fn:Ext.emptyFn,scope=scope||Ext.global,i=0,ln=expressions.length;i<ln;i++)if(expression=expressions[i],"string"==typeof expression&&expression.length>0)for(possibleClassNames=Manager.getNamesByExpression(expression),subLn=possibleClassNames.length,j=0;j<subLn;j++)possibleClassName=possibleClassNames[j],excluded[possibleClassName]!==!0&&(references.push(possibleClassName),Manager.isCreated(possibleClassName)||included[possibleClassName]||(included[possibleClassName]=!0,classNames.push(possibleClassName)));if(!(classNames.length>0))return callback.call(scope),Loader;if(!Loader.config.enabled)throw new Error("Ext.Loader is not enabled, so dependencies cannot be resolved dynamically. Missing required class"+(classNames.length>1?"es":"")+": "+classNames.join(", "));for(syncModeEnabled=Loader.syncModeEnabled,syncModeEnabled||queue.push({requires:classNames.slice(),callback:callback,scope:scope}),ln=classNames.length,i=0;i<ln;i++)className=classNames[i],filePath=Loader.getPath(className),syncModeEnabled&&isClassFileLoaded.hasOwnProperty(className)&&(isClassFileLoaded[className]||(Loader.numPendingFiles--,Loader.removeScriptElement(filePath),delete isClassFileLoaded[className])),isClassFileLoaded.hasOwnProperty(className)||(isClassFileLoaded[className]=!1,classNameToFilePathMap[className]=filePath,Loader.numPendingFiles++,Loader.loadScriptFile(filePath,pass(Loader.onFileLoaded,[className,filePath],Loader),pass(Loader.onFileLoadError,[className,filePath],Loader),Loader,syncModeEnabled));return syncModeEnabled&&(callback.call(scope),1===ln)?Manager.get(className):Loader},onFileLoaded:function(className,filePath){var loaded=isClassFileLoaded[className];Loader.numLoadedFiles++,isClassFileLoaded[className]=!0,isFileLoaded[filePath]=!0,loaded||Loader.numPendingFiles--,0===Loader.numPendingFiles&&Loader.refreshQueue()},onFileLoadError:function(className,filePath,errorMessage,isSynchronous){Loader.numPendingFiles--,Loader.hasFileLoadError=!0},addUsedClasses:function(classes){var cls,i,ln;if(classes)for(classes="string"==typeof classes?[classes]:classes,i=0,ln=classes.length;i<ln;i++)cls=classes[i],"string"!=typeof cls||Ext.Array.contains(usedClasses,cls)||usedClasses.push(cls);return Loader},triggerReady:function(){var listener,refClasses=usedClasses;if(Loader.isLoading&&(Loader.isLoading=!1,0!==refClasses.length))return refClasses=refClasses.slice(),usedClasses.length=0,Loader.require(refClasses,Loader.triggerReady,Loader),Loader;for(Ext.Array.sort(readyListeners,comparePriority);readyListeners.length&&!Loader.isLoading;)listener=readyListeners.shift(),listener.fn.call(listener.scope);return Loader},onReady:function(fn,scope,withDomReady,options){var oldFn;withDomReady!==!1&&Ext.onDocumentReady&&(oldFn=fn,fn=function(){Ext.onDocumentReady(oldFn,scope,options)}),Loader.isLoading?readyListeners.push({
fn:fn,scope:scope,priority:options&&options.priority||0}):fn.call(scope)},historyPush:function(className){return className&&isClassFileLoaded.hasOwnProperty(className)&&!isInHistory[className]&&(isInHistory[className]=!0,history.push(className)),Loader}}),Ext.disableCacheBuster=function(disable,path){var date=new Date;date.setTime(date.getTime()+24*(disable?3650:-1)*60*60*1e3),date=date.toGMTString(),document.cookie="ext-cache=1; expires="+date+"; path="+(path||"/")},Ext.require=alias(Loader,"require"),Ext.syncRequire=alias(Loader,"syncRequire"),Ext.exclude=alias(Loader,"exclude"),Ext.onReady=function(fn,scope,options){Loader.onReady(fn,scope,!0,options)},Class.registerPreprocessor("loader",function(cls,data,hooks,continueFn){var i,j,ln,subLn,value,propertyName,propertyValue,me=this,dependencies=[];Manager.getName(cls);for(i=0,ln=dependencyProperties.length;i<ln;i++)if(propertyName=dependencyProperties[i],data.hasOwnProperty(propertyName))if(propertyValue=data[propertyName],"string"==typeof propertyValue)dependencies.push(propertyValue);else if(propertyValue instanceof Array)for(j=0,subLn=propertyValue.length;j<subLn;j++)value=propertyValue[j],"string"==typeof value&&dependencies.push(value);else if("function"!=typeof propertyValue)for(j in propertyValue)propertyValue.hasOwnProperty(j)&&(value=propertyValue[j],"string"==typeof value&&dependencies.push(value));if(0!==dependencies.length)return Loader.require(dependencies,function(){for(i=0,ln=dependencyProperties.length;i<ln;i++)if(propertyName=dependencyProperties[i],data.hasOwnProperty(propertyName))if(propertyValue=data[propertyName],"string"==typeof propertyValue)data[propertyName]=Manager.get(propertyValue);else if(propertyValue instanceof Array)for(j=0,subLn=propertyValue.length;j<subLn;j++)value=propertyValue[j],"string"==typeof value&&(data[propertyName][j]=Manager.get(value));else if("function"!=typeof propertyValue)for(var k in propertyValue)propertyValue.hasOwnProperty(k)&&(value=propertyValue[k],"string"==typeof value&&(data[propertyName][k]=Manager.get(value)));continueFn.call(me,cls,data,hooks)}),!1},!0,"after","className"),Manager.registerPostprocessor("uses",function(name,cls,data){var uses=data.uses;uses&&Loader.addUsedClasses(uses)}),Manager.onCreated(Loader.historyPush)},Ext._classPathMetadata&&(Ext.Loader.addClassPathMappings(Ext._classPathMetadata),Ext._classPathMetadata=null),function(){var scripts=document.getElementsByTagName("script"),currentScript=scripts[scripts.length-1],src=currentScript.src,path=src.substring(0,src.lastIndexOf("/")+1),Loader=Ext.Loader;Loader.setConfig({enabled:!0,disableCaching:!0,paths:{Ext:path+"src"}})}(),Ext._endTime=(new Date).getTime(),Ext._beforereadyhandler&&Ext._beforereadyhandler(),Ext.Error=Ext.extend(Error,{statics:{ignore:!1,raise:function(err){err=err||{},Ext.isString(err)&&(err={msg:err});var msg,method=this.raise.caller;if(method&&(method.$name&&(err.sourceMethod=method.$name),method.$owner&&(err.sourceClass=method.$owner.$className)),Ext.Error.handle(err)!==!0)throw msg=Ext.Error.prototype.toString.call(err),Ext.log({msg:msg,level:"error",dump:err,stack:!0}),new Ext.Error(err)},handle:function(){return Ext.Error.ignore}},name:"Ext.Error",constructor:function(config){Ext.isString(config)&&(config={msg:config});var me=this;Ext.apply(me,config),me.message=me.message||me.msg},toString:function(){var me=this,className=me.sourceClass?me.sourceClass:"",methodName=me.sourceMethod?"."+me.sourceMethod+"(): ":"",msg=me.msg||"(No description provided)";return className+methodName+msg}}),Ext.deprecated=function(suggestion){return Ext.emptyFn},Ext.JSON=new function(){var me=this,encodingFunction,decodingFunction,useNative=null,useHasOwn=!!{}.hasOwnProperty,isNative=function(){return null===useNative&&(useNative=Ext.USE_NATIVE_JSON&&window.JSON&&"[object JSON]"==JSON.toString()),useNative},pad=function(n){return n<10?"0"+n:n},doDecode=function(json){return eval("("+json+")")},doEncode=function(o,newline){return null===o||void 0===o?"null":Ext.isDate(o)?Ext.JSON.encodeDate(o):Ext.isString(o)?Ext.JSON.encodeString(o):"number"==typeof o?isFinite(o)?String(o):"null":Ext.isBoolean(o)?String(o):o.toJSON?o.toJSON():Ext.isArray(o)?encodeArray(o,newline):Ext.isObject(o)?encodeObject(o,newline):"function"==typeof o?"null":"undefined"},m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","\v":"\\u000b"},charToReplace=/[\\\"\x00-\x1f\x7f-\uffff]/g,encodeString=function(s){return'"'+s.replace(charToReplace,function(a){var c=m[a];return"string"==typeof c?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArray=function(o,newline){var i,a=["[",""],len=o.length;for(i=0;i<len;i+=1)a.push(Ext.JSON.encodeValue(o[i]),",");return a[a.length-1]="]",a.join("")},encodeObject=function(o,newline){var i,val,a=["{",""];for(i in o)if(val=o[i],!useHasOwn||o.hasOwnProperty(i)){if("function"==typeof val||void 0===val)continue;a.push(Ext.JSON.encodeValue(i),":",Ext.JSON.encodeValue(val),",")}return a[a.length-1]="}",a.join("")};me.encodeString=encodeString,me.encodeValue=doEncode,me.encodeDate=function(o){return'"'+o.getFullYear()+"-"+pad(o.getMonth()+1)+"-"+pad(o.getDate())+"T"+pad(o.getHours())+":"+pad(o.getMinutes())+":"+pad(o.getSeconds())+'"'},me.encode=function(o){return encodingFunction||(encodingFunction=isNative()?JSON.stringify:me.encodeValue),encodingFunction(o)},me.decode=function(json,safe){decodingFunction||(decodingFunction=isNative()?JSON.parse:doDecode);try{return decodingFunction(json)}catch(e){if(safe===!0)return null;Ext.Error.raise({sourceClass:"Ext.JSON",sourceMethod:"decode",msg:"You're trying to decode an invalid JSON String: "+json})}}},Ext.encode=Ext.JSON.encode,Ext.decode=Ext.JSON.decode,Ext.apply(Ext,{userAgent:navigator.userAgent.toLowerCase(),cache:{},idSeed:1e3,windowId:"ext-window",documentId:"ext-document",isReady:!1,enableGarbageCollector:!0,enableListenerCollection:!0,rootHierarchyState:{},addCacheEntry:function(id,el,dom){dom=dom||el.dom;var cache=Ext.cache,key=id||el&&el.id||dom.id,entry=cache[key]||(cache[key]={data:{},events:{},dom:dom,skipGarbageCollection:!(!dom.getElementById&&!dom.navigator)});return el&&(el.$cache=entry,entry.el=el),entry},updateCacheEntry:function(cacheItem,dom){return cacheItem.dom=dom,cacheItem.el&&(cacheItem.el.dom=dom),cacheItem},id:function(el,prefix){var me=this,sandboxPrefix="";return el=Ext.getDom(el,!0)||{},el===document?el.id=me.documentId:el===window&&(el.id=me.windowId),el.id||(me.isSandboxed&&(sandboxPrefix=Ext.sandboxName.toLowerCase()+"-"),el.id=sandboxPrefix+(prefix||"ext-gen")+ ++Ext.idSeed),el.id},escapeId:function(){var validIdRe=/^[a-zA-Z_][a-zA-Z0-9_\-]*$/i,escapeRx=/([\W]{1})/g,leadingNumRx=/^(\d)/g,escapeFn=function(match,capture){return"\\"+capture},numEscapeFn=function(match,capture){return"\\00"+capture.charCodeAt(0).toString(16)+" "};return function(id){return validIdRe.test(id)?id:id.replace(escapeRx,escapeFn).replace(leadingNumRx,numEscapeFn)}}(),getBody:function(){var body;return function(){return body||(body=Ext.get(document.body))}}(),getHead:function(){var head;return function(){return head||(head=Ext.get(document.getElementsByTagName("head")[0]))}}(),getDoc:function(){var doc;return function(){return doc||(doc=Ext.get(document))}}(),getOrientation:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"},destroy:function(){var i,arg,ln=arguments.length;for(i=0;i<ln;i++)arg=arguments[i],arg&&(Ext.isArray(arg)?this.destroy.apply(this,arg):arg.isStore?arg.destroyStore():Ext.isFunction(arg.destroy)?arg.destroy():arg.dom&&arg.remove())},callback:function(callback,scope,args,delay){var fn,ret;return Ext.isFunction(callback)?fn=callback:scope&&Ext.isString(callback)&&(fn=scope[callback]),fn&&(args=args||[],scope=scope||window,delay?Ext.defer(fn,delay,scope,args):ret=fn.apply(scope,args)),ret},resolveMethod:function(fn,scope){return Ext.isFunction(fn)?fn:scope[fn]},htmlEncode:function(value){return Ext.String.htmlEncode(value)},htmlDecode:function(value){return Ext.String.htmlDecode(value)},urlAppend:function(url,s){return Ext.String.urlAppend(url,s)}}),Ext.ns=Ext.namespace,window.undefined=window.undefined,function(){var nullLog,check=function(regex){return regex.test(Ext.userAgent)},isStrict="CSS1Compat"==document.compatMode,version=function(is,regex){var m;return is&&(m=regex.exec(Ext.userAgent))?parseFloat(m[1]):0},docMode=document.documentMode,isOpera=check(/opera/),isOpera10_5=isOpera&&check(/version\/10\.5/),isChrome=check(/\bchrome\b/),isWebKit=check(/webkit/),isSafari=!isChrome&&check(/safari/),isSafari2=isSafari&&check(/applewebkit\/4/),isSafari3=isSafari&&check(/version\/3/),isSafari4=isSafari&&check(/version\/4/),isSafari5_0=isSafari&&check(/version\/5\.0/),isSafari5=isSafari&&check(/version\/5/),isIE=!isOpera&&(check(/msie/)||check(/trident/)),isIE7=isIE&&(check(/msie 7/)&&8!=docMode&&9!=docMode&&10!=docMode||7==docMode),isIE8=isIE&&(check(/msie 8/)&&7!=docMode&&9!=docMode&&10!=docMode||8==docMode),isIE9=isIE&&(check(/msie 9/)&&7!=docMode&&8!=docMode&&10!=docMode||9==docMode),isIE10=isIE&&(check(/msie 10/)&&7!=docMode&&8!=docMode&&9!=docMode||10==docMode),isIE11=isIE&&(check(/trident\/7\.0/)&&7!=docMode&&8!=docMode&&9!=docMode&&10!=docMode||11==docMode),isIE6=isIE&&check(/msie 6/),isGecko=!isWebKit&&!isIE&&check(/gecko/),isGecko3=isGecko&&check(/rv:1\.9/),isGecko4=isGecko&&check(/rv:2\.0/),isGecko5=isGecko&&check(/rv:5\./),isGecko10=isGecko&&check(/rv:10\./),isFF3_0=isGecko3&&check(/rv:1\.9\.0/),isFF3_5=isGecko3&&check(/rv:1\.9\.1/),isFF3_6=isGecko3&&check(/rv:1\.9\.2/),isWindows=check(/windows|win32/),isMac=check(/macintosh|mac os x/),isLinux=check(/linux/),scrollbarSize=null,chromeVersion=version(!0,/\bchrome\/(\d+\.\d+)/),firefoxVersion=version(!0,/\bfirefox\/(\d+\.\d+)/),ieVersion=version(isIE,/msie (\d+\.\d+)/),operaVersion=version(isOpera,/version\/(\d+\.\d+)/),safariVersion=version(isSafari,/version\/(\d+\.\d+)/),webKitVersion=version(isWebKit,/webkit\/(\d+\.\d+)/),isSecure=/^https/i.test(window.location.protocol);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}nullLog=function(){},nullLog.info=nullLog.warn=nullLog.error=Ext.emptyFn,Ext.setVersion("ext","4.2.2.1144"),Ext.setVersion("extjs","4.2.2.1144"),Ext.apply(Ext,{SSL_SECURE_URL:isSecure&&isIE?"javascript:''":"about:blank",plainTableCls:Ext.buildSettings.baseCSSPrefix+"table-plain",plainListCls:Ext.buildSettings.baseCSSPrefix+"list-plain",enableNestedListenerRemoval:!1,USE_NATIVE_JSON:!1,getDom:function(el,strict){if(!el||!document)return null;if(el.dom)return el.dom;if("string"==typeof el){var e=Ext.getElementById(el);return e&&isIE&&strict?el==e.getAttribute("id")?e:null:e}return el},removeNode:isIE6||isIE7||isIE8?function(){var d;return function(n){if(n&&"BODY"!=n.tagName.toUpperCase()){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(n):Ext.EventManager.removeAll(n);var cache=Ext.cache,id=n.id;cache[id]&&(delete cache[id].dom,delete cache[id]),isIE8&&n.parentNode&&n.parentNode.removeChild(n),d=d||document.createElement("div"),d.appendChild(n),d.innerHTML=""}}}():function(n){if(n&&n.parentNode&&"BODY"!=n.tagName.toUpperCase()){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(n):Ext.EventManager.removeAll(n);var cache=Ext.cache,id=n.id;cache[id]&&(delete cache[id].dom,delete cache[id]),n.parentNode.removeChild(n)}},isStrict:isStrict,isIEQuirks:isIE&&!isStrict&&(isIE6||isIE7||isIE8||isIE9),isOpera:isOpera,isOpera10_5:isOpera10_5,isWebKit:isWebKit,isChrome:isChrome,isSafari:isSafari,isSafari3:isSafari3,isSafari4:isSafari4,isSafari5:isSafari5,isSafari5_0:isSafari5_0,isSafari2:isSafari2,isIE:isIE,isIE6:isIE6,isIE7:isIE7,isIE7m:isIE6||isIE7,isIE7p:isIE&&!isIE6,isIE8:isIE8,isIE8m:isIE6||isIE7||isIE8,isIE8p:isIE&&!(isIE6||isIE7),isIE9:isIE9,isIE9m:isIE6||isIE7||isIE8||isIE9,isIE9p:isIE&&!(isIE6||isIE7||isIE8),isIE10:isIE10,isIE10m:isIE6||isIE7||isIE8||isIE9||isIE10,isIE10p:isIE&&!(isIE6||isIE7||isIE8||isIE9),isIE11:isIE11,isIE11m:isIE6||isIE7||isIE8||isIE9||isIE10||isIE11,isIE11p:isIE&&!(isIE6||isIE7||isIE8||isIE9||isIE10),isGecko:isGecko,isGecko3:isGecko3,isGecko4:isGecko4,isGecko5:isGecko5,isGecko10:isGecko10,isFF3_0:isFF3_0,isFF3_5:isFF3_5,isFF3_6:isFF3_6,isFF4:4<=firefoxVersion&&firefoxVersion<5,isFF5:5<=firefoxVersion&&firefoxVersion<6,isFF10:10<=firefoxVersion&&firefoxVersion<11,isLinux:isLinux,isWindows:isWindows,isMac:isMac,chromeVersion:chromeVersion,firefoxVersion:firefoxVersion,ieVersion:ieVersion,operaVersion:operaVersion,safariVersion:safariVersion,webKitVersion:webKitVersion,isSecure:isSecure,BLANK_IMAGE_URL:isIE6||isIE7?"//www.sencha.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",value:function(v,defaultValue,allowBlank){return Ext.isEmpty(v,allowBlank)?defaultValue:v},escapeRe:function(s){return s.replace(/([-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},addBehaviors:function(o){if(Ext.isReady){var parts,b,s,cache={};for(b in o)(parts=b.split("@"))[1]&&(s=parts[0],cache[s]||(cache[s]=Ext.select(s)),cache[s].on(parts[1],o[b]));cache=null}else Ext.onReady(function(){Ext.addBehaviors(o)})},getScrollbarSize:function(force){if(!Ext.isReady)return{};if(force||!scrollbarSize){var db=document.body,div=document.createElement("div");div.style.width=div.style.height="100px",div.style.overflow="scroll",div.style.position="absolute",db.appendChild(div),scrollbarSize={width:div.offsetWidth-div.clientWidth,height:div.offsetHeight-div.clientHeight},db.removeChild(div)}return scrollbarSize},getScrollBarWidth:function(force){var size=Ext.getScrollbarSize(force);return size.width+2},copyTo:function(dest,source,names,usePrototypeKeys){"string"==typeof names&&(names=names.split(/[,;\s]/));var n,name,nLen=names?names.length:0;for(n=0;n<nLen;n++)name=names[n],(usePrototypeKeys||source.hasOwnProperty(name))&&(dest[name]=source[name]);return dest},destroyMembers:function(o){for(var i=1,a=arguments,len=a.length;i<len;i++)Ext.destroy(o[a[i]]),delete o[a[i]]},log:nullLog,partition:function(arr,truth){var a,v,ret=[[],[]],aLen=arr.length;for(a=0;a<aLen;a++)v=arr[a],ret[truth&&truth(v,a,arr)||!truth&&v?0:1].push(v);return ret},invoke:function(arr,methodName){var a,v,ret=[],args=Array.prototype.slice.call(arguments,2),aLen=arr.length;for(a=0;a<aLen;a++)v=arr[a],v&&"function"==typeof v[methodName]?ret.push(v[methodName].apply(v,args)):ret.push(void 0);return ret},zip:function(){var i,j,aLen,parts=Ext.partition(arguments,function(val){return"function"!=typeof val}),arrs=parts[0],fn=parts[1][0],len=Ext.max(Ext.pluck(arrs,"length")),ret=[];for(i=0;i<len;i++)if(ret[i]=[],fn)ret[i]=fn.apply(fn,Ext.pluck(arrs,i));else for(j=0,aLen=arrs.length;j<aLen;j++)ret[i].push(arrs[j][i]);return ret},toSentence:function(items,connector){var head,tail,length=items.length;return length<=1?items[0]:(head=items.slice(0,length-1),tail=items[length-1],Ext.util.Format.format("{0} {1} {2}",head.join(", "),connector||"and",tail))},setGlyphFontFamily:function(fontFamily){Ext._glyphFontFamily=fontFamily},useShims:isIE6})}(),Ext.application=function(config){var App,paths,ns,createApp=function(){Ext.onReady(function(){Ext.app.Application.instance=new App})};if("string"==typeof config)Ext.require(config,function(){App=Ext.ClassManager.get(config),createApp()});else{if(Ext.Loader.setPath(config.name,config.appFolder||"app"),paths=config.paths)for(ns in paths)paths.hasOwnProperty(ns)&&Ext.Loader.setPath(ns,paths[ns]);config["paths processed"]=!0,Ext.define(config.name+".$application",Ext.apply({extend:"Ext.app.Application"},config),function(){App=this,createApp()})}},function(){Ext.ns("Ext.util");var I18NFormatCleanRe,UtilFormat=Ext.util.Format={},stripTagsRE=/<\/?[^>]+>/gi,stripScriptsRe=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,nl2brRe=/\r?\n/g,allHashes=/^#+$/,formatPattern=/[\d,\.#]+/,formatCleanRe=/[^\d\.#]/g,formatFns={};Ext.apply(UtilFormat,{thousandSeparator:",",decimalSeparator:".",currencyPrecision:2,currencySign:"$",currencyAtEnd:!1,undef:function(value){return void 0!==value?value:""},defaultValue:function(value,defaultValue){return void 0!==value&&""!==value?value:defaultValue},substr:"b"!="ab".substr(-1)?function(value,start,length){var str=String(value);return start<0?str.substr(Math.max(str.length+start,0),length):str.substr(start,length)}:function(value,start,length){return String(value).substr(start,length)},lowercase:function(value){return String(value).toLowerCase()},uppercase:function(value){return String(value).toUpperCase()},usMoney:function(v){return UtilFormat.currency(v,"$",2)},currency:function(v,currencySign,decimals,end){var negativeSign="",format=",0",i=0;for(v-=0,v<0&&(v=-v,negativeSign="-"),decimals=Ext.isDefined(decimals)?decimals:UtilFormat.currencyPrecision,format+=decimals>0?".":"";i<decimals;i++)format+="0";return v=UtilFormat.number(v,format),(end||UtilFormat.currencyAtEnd)===!0?Ext.String.format("{0}{1}{2}",negativeSign,v,currencySign||UtilFormat.currencySign):Ext.String.format("{0}{1}{2}",negativeSign,currencySign||UtilFormat.currencySign,v)},date:function(v,format){return v?(Ext.isDate(v)||(v=new Date(Date.parse(v))),Ext.Date.dateFormat(v,format||Ext.Date.defaultFormat)):""},dateRenderer:function(format){return function(v){return UtilFormat.date(v,format)}},stripTags:function(v){return v?String(v).replace(stripTagsRE,""):v},stripScripts:function(v){return v?String(v).replace(stripScriptsRe,""):v},fileSize:function(){var byteLimit=1024,kbLimit=1048576,mbLimit=1073741824;return function(size){var out;return out=size<byteLimit?1===size?"1 byte":size+" bytes":size<kbLimit?Math.round(10*size/byteLimit)/10+" KB":size<mbLimit?Math.round(10*size/kbLimit)/10+" MB":Math.round(10*size/mbLimit)/10+" GB"}}(),math:function(){var fns={};return function(v,a){return fns[a]||(fns[a]=Ext.functionFactory("v","return v "+a+";")),fns[a](v)}}(),round:function(value,precision){var result=Number(value);return"number"==typeof precision&&(precision=Math.pow(10,precision),result=Math.round(value*precision)/precision),result},number:function(v,formatString){if(!formatString)return v;var formatFn=formatFns[formatString];if(!formatFn){var hasComma,splitFormat,extraChars,trimTrailingZeroes,code,originalFormatString=formatString,comma=UtilFormat.thousandSeparator,decimalSeparator=UtilFormat.decimalSeparator,precision=0,trimPart="";"/i"==formatString.substr(formatString.length-2)?(I18NFormatCleanRe||(I18NFormatCleanRe=new RegExp("[^\\d\\"+UtilFormat.decimalSeparator+"]","g")),formatString=formatString.substr(0,formatString.length-2),hasComma=formatString.indexOf(comma)!=-1,splitFormat=formatString.replace(I18NFormatCleanRe,"").split(decimalSeparator)):(hasComma=formatString.indexOf(",")!=-1,splitFormat=formatString.replace(formatCleanRe,"").split(".")),extraChars=formatString.replace(formatPattern,""),splitFormat.length>2||2===splitFormat.length&&(precision=splitFormat[1].length,trimTrailingZeroes=allHashes.test(splitFormat[1]),trimTrailingZeroes&&(trimPart='trailingZeroes=new RegExp(Ext.String.escapeRegex(utilFormat.decimalSeparator) + "?0+$")')),code=["var utilFormat=Ext.util.Format,extNumber=Ext.Number,neg,absVal,fnum,parts"+(hasComma?",thousandSeparator,thousands=[],j,n,i":"")+(extraChars?',formatString="'+formatString+'",formatPattern=/[\\d,\\.#]+/':"")+',trailingZeroes;return function(v){if(typeof v!=="number"&&isNaN(v=extNumber.from(v,NaN)))return"";neg=v<0;',"absVal=Math.abs(v);","fnum=Ext.Number.toFixed(absVal, "+precision+");",trimPart,";"],hasComma?(precision&&(code[code.length]='parts=fnum.split(".");',code[code.length]="fnum=parts[0];"),code[code.length]="if(absVal>=1000) {",code[code.length]="thousandSeparator=utilFormat.thousandSeparator;thousands.length=0;j=fnum.length;n=fnum.length%3||3;for(i=0;i<j;i+=n){if(i!==0){n=3;}thousands[thousands.length]=fnum.substr(i,n);}fnum=thousands.join(thousandSeparator);}",precision&&(code[code.length]="fnum += utilFormat.decimalSeparator+parts[1];")):precision&&(code[code.length]='if(utilFormat.decimalSeparator!=="."){parts=fnum.split(".");fnum=parts[0]+utilFormat.decimalSeparator+parts[1];}'),trimTrailingZeroes&&(code[code.length]='fnum=fnum.replace(trailingZeroes,"");'),code[code.length]='if(neg&&fnum!=="'+(precision?"0."+Ext.String.repeat("0",precision):"0")+'")fnum="-"+fnum;',code[code.length]="return ",extraChars?code[code.length]="formatString.replace(formatPattern, fnum);":code[code.length]="fnum;",code[code.length]="};",formatFn=formatFns[originalFormatString]=Ext.functionFactory("Ext",code.join(""))(Ext)}return formatFn(v)},numberRenderer:function(format){return function(v){return UtilFormat.number(v,format)}},attributes:function(attributes){if("object"==typeof attributes){var name,result=[];for(name in attributes)result.push(name,'="',"style"===name?Ext.DomHelper.generateStyles(attributes[name],null,!0):Ext.htmlEncode(attributes[name]),'"');attributes=result.join("")}return attributes||""},plural:function(v,s,p){return v+" "+(1==v?s:p?p:s+"s")},nl2br:function(v){return Ext.isEmpty(v)?"":v.replace(nl2brRe,"<br/>")},capitalize:Ext.String.capitalize,ellipsis:Ext.String.ellipsis,format:Ext.String.format,htmlDecode:Ext.String.htmlDecode,htmlEncode:Ext.String.htmlEncode,leftPad:Ext.String.leftPad,trim:Ext.String.trim,parseBox:function(box){if(box=box||0,"number"==typeof box)return{top:box,right:box,bottom:box,left:box};var parts=box.split(" "),ln=parts.length;return 1==ln?parts[1]=parts[2]=parts[3]=parts[0]:2==ln?(parts[2]=parts[0],parts[3]=parts[1]):3==ln&&(parts[3]=parts[1]),{top:parseInt(parts[0],10)||0,right:parseInt(parts[1],10)||0,bottom:parseInt(parts[2],10)||0,left:parseInt(parts[3],10)||0}},escapeRegex:function(s){return s.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")}})}(),Ext.define("Ext.util.TaskRunner",{interval:10,timerId:null,constructor:function(interval){var me=this;"number"==typeof interval?me.interval=interval:interval&&Ext.apply(me,interval),me.tasks=[],me.timerFn=Ext.Function.bind(me.onTick,me)},newTask:function(config){var task=new Ext.util.TaskRunner.Task(config);return task.manager=this,task},start:function(task){var me=this,now=Ext.Date.now();return task.pending||(me.tasks.push(task),task.pending=!0),task.stopped=!1,task.taskStartTime=now,task.taskRunTime=task.fireOnStart!==!1?0:task.taskStartTime,task.taskRunCount=0,me.firing||(task.fireOnStart!==!1?me.startTimer(0,now):me.startTimer(task.interval,now)),task},stop:function(task){return task.stopped||(task.stopped=!0,task.onStop&&task.onStop.call(task.scope||task,task)),task},stopAll:function(){Ext.each(this.tasks,this.stop,this)},firing:!1,nextExpires:1e99,onTick:function(){var expires,newTasks,i,task,rt,remove,me=this,tasks=me.tasks,now=Ext.Date.now(),nextExpires=1e99,len=tasks.length;for(me.timerId=null,me.firing=!0,i=0;i<len||i<(len=tasks.length);++i){if(task=tasks[i],!(remove=task.stopped)){if(expires=task.taskRunTime+task.interval,expires<=now){rt=1;try{rt=task.run.apply(task.scope||task,task.args||[++task.taskRunCount])}catch(taskError){try{task.onError&&(rt=task.onError.call(task.scope||task,task,taskError))}catch(ignore){}}task.taskRunTime=now,rt===!1||task.taskRunCount===task.repeat?(me.stop(task),remove=!0):(remove=task.stopped,expires=now+task.interval)}!remove&&task.duration&&task.duration<=now-task.taskStartTime&&(me.stop(task),remove=!0)}remove?(task.pending=!1,newTasks||(newTasks=tasks.slice(0,i))):(newTasks&&newTasks.push(task),nextExpires>expires&&(nextExpires=expires))}newTasks&&(me.tasks=newTasks),me.firing=!1,me.tasks.length&&me.startTimer(nextExpires-now,Ext.Date.now()),me.fireIdleEvent!==!1&&Ext.EventManager.idleEvent.fire()},startTimer:function(timeout,now){var me=this,expires=now+timeout,timerId=me.timerId;timerId&&me.nextExpires-expires>me.interval&&(clearTimeout(timerId),timerId=null),timerId||(timeout<me.interval&&(timeout=me.interval),me.timerId=setTimeout(me.timerFn,timeout),me.nextExpires=expires)}},function(){var me=this,proto=me.prototype;proto.destroy=proto.stopAll,Ext.util.TaskManager=Ext.TaskManager=new me,me.Task=new Ext.Class({isTask:!0,stopped:!0,fireOnStart:!1,constructor:function(config){Ext.apply(this,config)},restart:function(interval){void 0!==interval&&(this.interval=interval),this.manager.start(this)},start:function(interval){this.stopped&&this.restart(interval)},stop:function(){this.manager.stop(this)}}),proto=me.Task.prototype,proto.destroy=proto.stop}),Ext.define("Ext.util.TaskManager",{extend:Ext.util.TaskRunner,alternateClassName:["Ext.TaskManager"],singleton:!0}),Ext.define("Ext.perf.Accumulator",function(){function adjustSet(set,time){set.sum+=time,set.min=Math.min(set.min,time),set.max=Math.max(set.max,time)}function leaveFrame(time){var totalTime=time?time:getTimestamp()-this.time,me=this,accum=me.accum;++accum.count,--accum.depth||adjustSet(accum.total,totalTime),adjustSet(accum.pure,totalTime-me.childTime),currentFrame=me.parent,currentFrame&&(++currentFrame.accum.childCount,currentFrame.childTime+=totalTime)}function makeSet(){return{min:Number.MAX_VALUE,max:0,sum:0}}function makeTap(me,fn){return function(){var frame=me.enter(),ret=fn.apply(this,arguments);return frame.leave(),ret}}function setToJSON(count,childCount,calibration,set){var data={avg:0,min:set.min,max:set.max,sum:0};return count&&(calibration=calibration||0,data.sum=set.sum-childCount*calibration,data.avg=data.sum/count),data}var formatTpl,currentFrame=null,khrome=Ext.global.chrome,getTimestamp=function(){getTimestamp=function(){return(new Date).getTime()};var interval,toolbox;if(Ext.isChrome&&khrome&&khrome.Interval)interval=new khrome.Interval,interval.start(),getTimestamp=function(){return interval.microseconds()/1e3};else if(window.ActiveXObject)try{toolbox=new ActiveXObject("SenchaToolbox.Toolbox"),Ext.senchaToolbox=toolbox,getTimestamp=function(){return toolbox.milliseconds}}catch(e){}else Date.now&&(getTimestamp=Date.now);return Ext.perf.getTimestamp=Ext.perf.Accumulator.getTimestamp=getTimestamp,getTimestamp()};return{constructor:function(name){var me=this;me.count=me.childCount=me.depth=me.maxDepth=0,me.pure=makeSet(),me.total=makeSet(),me.name=name},statics:{getTimestamp:getTimestamp},format:function(calibration){formatTpl||(formatTpl=new Ext.XTemplate(["{name} - {count} call(s)",'<tpl if="count">','<tpl if="childCount">'," ({childCount} children)","</tpl>",'<tpl if="depth - 1">'," ({depth} deep)","</tpl>",'<tpl for="times">',", {type}: {[this.time(values.sum)]} msec (","avg={[this.time(values.sum / parent.count)]}",")","</tpl>","</tpl>"].join(""),{time:function(t){return Math.round(100*t)/100}}));var data=this.getData(calibration);return data.name=this.name,data.pure.type="Pure",data.total.type="Total",data.times=[data.pure,data.total],formatTpl.apply(data)},getData:function(calibration){var me=this;return{count:me.count,childCount:me.childCount,depth:me.maxDepth,pure:setToJSON(me.count,me.childCount,calibration,me.pure),total:setToJSON(me.count,me.childCount,calibration,me.total)}},enter:function(){var me=this,frame={accum:me,leave:leaveFrame,childTime:0,parent:currentFrame};return++me.depth,me.maxDepth<me.depth&&(me.maxDepth=me.depth),currentFrame=frame,frame.time=getTimestamp(),frame},monitor:function(fn,scope,args){var frame=this.enter();args?fn.apply(scope,args):fn.call(scope),frame.leave()},report:function(){Ext.log(this.format())},tap:function(className,methodName){var klass,statik,i,parts,length,name,src,tapFunc,me=this,methods="string"==typeof methodName?[methodName]:methodName;return tapFunc=function(){if("string"==typeof className)for(klass=Ext.global,parts=className.split("."),i=0,length=parts.length;i<length;++i)klass=klass[parts[i]];else klass=className;for(i=0,length=methods.length;i<length;++i)name=methods[i],statik="!"==name.charAt(0),statik?name=name.substring(1):statik=!(name in klass.prototype),src=statik?klass:klass.prototype,src[name]=makeTap(me,src[name])},Ext.ClassManager.onCreated(tapFunc,me,className),me}}}(),function(){Ext.perf.getTimestamp=this.getTimestamp}),Ext.define("Ext.perf.Monitor",{singleton:!0,alternateClassName:"Ext.Perf",constructor:function(){this.accumulators=[],this.accumulatorsByName={}},calibrate:function(){var frame,endTime,startTime,accum=new Ext.perf.Accumulator("$"),total=accum.total,getTimestamp=Ext.perf.Accumulator.getTimestamp,count=0;startTime=getTimestamp();do frame=accum.enter(),frame.leave(),++count;while(total.sum<100);return endTime=getTimestamp(),(endTime-startTime)/count},get:function(name){var me=this,accum=me.accumulatorsByName[name];return accum||(me.accumulatorsByName[name]=accum=new Ext.perf.Accumulator(name),me.accumulators.push(accum)),accum},enter:function(name){return this.get(name).enter()},monitor:function(name,fn,scope){this.get(name).monitor(fn,scope)},report:function(){var me=this,accumulators=me.accumulators,calibration=me.calibrate();accumulators.sort(function(a,b){return a.name<b.name?-1:b.name<a.name?1:0}),me.updateGC(),Ext.log("Calibration: "+Math.round(100*calibration)/100+" msec/sample"),Ext.each(accumulators,function(accum){Ext.log(accum.format(calibration))})},getData:function(all){var ret={},accumulators=this.accumulators;return Ext.each(accumulators,function(accum){(all||accum.count)&&(ret[accum.name]=accum.getData())}),ret},reset:function(){Ext.each(this.accumulators,function(accum){var me=accum;me.count=me.childCount=me.depth=me.maxDepth=0,me.pure={min:Number.MAX_VALUE,max:0,sum:0},me.total={min:Number.MAX_VALUE,max:0,sum:0}})},updateGC:function(){var bucket,accumGC=this.accumulatorsByName.GC,toolbox=Ext.senchaToolbox;accumGC&&(accumGC.count=toolbox.garbageCollectionCounter||0,accumGC.count&&(bucket=accumGC.pure,accumGC.total.sum=bucket.sum=toolbox.garbageCollectionMilliseconds,bucket.min=bucket.max=bucket.sum/accumGC.count,bucket=accumGC.total,bucket.min=bucket.max=bucket.sum/accumGC.count))},watchGC:function(){Ext.perf.getTimestamp();var toolbox=Ext.senchaToolbox;toolbox&&(this.get("GC"),toolbox.watchGarbageCollector(!1))},setup:function(config){config||(config={render:{"Ext.AbstractComponent":"render"},layout:{"Ext.layout.Context":"run"}}),this.currentConfig=config;var key,prop,accum,className,methods;for(key in config)if(config.hasOwnProperty(key)){prop=config[key],accum=Ext.Perf.get(key);for(className in prop)prop.hasOwnProperty(className)&&(methods=prop[className],accum.tap(className,methods))}this.watchGC()}}),Ext.is={init:function(navigator){var i,platform,platforms=this.platforms,ln=platforms.length;for(navigator=navigator||window.navigator,i=0;i<ln;i++)platform=platforms[i],this[platform.identity]=platform.regex.test(navigator[platform.property]);this.Desktop=this.Mac||this.Windows||this.Linux&&!this.Android,this.Tablet=this.iPad,this.Phone=!this.Desktop&&!this.Tablet,this.iOS=this.iPhone||this.iPad||this.iPod,this.Standalone=!!window.navigator.standalone},platforms:[{property:"platform",regex:/iPhone/i,identity:"iPhone"},{property:"platform",regex:/iPod/i,identity:"iPod"},{property:"userAgent",regex:/iPad/i,identity:"iPad"},{property:"userAgent",regex:/Blackberry/i,identity:"Blackberry"},{property:"userAgent",regex:/Android/i,identity:"Android"},{property:"platform",regex:/Mac/i,identity:"Mac"},{property:"platform",regex:/Win/i,identity:"Windows"},{property:"platform",regex:/Linux/i,identity:"Linux"}]},Ext.is.init(),function(){function getBrowserKey(){var browser=Ext.isIE6?"IE6":Ext.isIE7?"IE7":Ext.isIE8?"IE8":Ext.isIE9?"IE9":Ext.isIE10?"IE10":"";return browser?browser+(Ext.isStrict?"-strict":"-quirks"):""}var getStyle=function(element,styleName){var view=element.ownerDocument.defaultView,style=(view?view.getComputedStyle(element,null):element.currentStyle)||element.style;return style[styleName]},supportsVectors={"IE6-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0],"IE6-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,1,1,0,0,1,0,1,0,0,0],"IE7-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0],"IE7-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,0,1,0,0,1,0,1,0,0,0],"IE8-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0],
"IE8-strict":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,1,0,0,1,0,1,0,0,1],"IE9-quirks":[0,1,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0],"IE9-strict":[0,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,0,0,0,1],"IE10-quirks":[1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,0,1],"IE10-strict":[1,1,0,0,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,0,0,0,1]};Ext.supports={init:function(){var test,vector,value,me=this,doc=document,toRun=me.toRun||me.tests,n=toRun.length,div=n&&Ext.isReady&&doc.createElement("div"),notRun=[],browserKey=getBrowserKey();for(div&&(div.innerHTML=['<div style="height:30px;width:50px;">','<div style="height:20px;width:20px;"></div>',"</div>",'<div style="width: 200px; height: 200px; position: relative; padding: 5px;">','<div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>',"</div>",'<div style="position: absolute; left: 10%; top: 10%;"></div>','<div style="float:left; background-color:transparent;"></div>'].join(""),doc.body.appendChild(div)),vector=supportsVectors[browserKey];n--;)test=toRun[n],value=vector&&vector[n],void 0!==value?me[test.identity]=value:div||test.early?me[test.identity]=test.fn.call(me,doc,div):notRun.push(test);div&&doc.body.removeChild(div),me.toRun=notRun},PointerEvents:"pointerEvents"in document.documentElement.style,LocalStorage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),CSS3BoxShadow:"boxShadow"in document.documentElement.style||"WebkitBoxShadow"in document.documentElement.style||"MozBoxShadow"in document.documentElement.style,ClassList:!!document.documentElement.classList,OrientationChange:"undefined"!=typeof window.orientation&&"onorientationchange"in window,DeviceMotion:"ondevicemotion"in window,Touch:"ontouchstart"in window&&!Ext.is.Desktop,TimeoutActualLateness:function(){setTimeout(function(){Ext.supports.TimeoutActualLateness=0!==arguments.length},0)}(),tests:[{identity:"Transitions",fn:function(doc,div){for(var prefix=["webkit","Moz","o","ms","khtml"],TE="TransitionEnd",transitionEndName=[prefix[0]+TE,"transitionend",prefix[2]+TE,prefix[3]+TE,prefix[4]+TE],ln=prefix.length,i=0,out=!1;i<ln;i++)if(getStyle(div,prefix[i]+"TransitionProperty")){Ext.supports.CSS3Prefix=prefix[i],Ext.supports.CSS3TransitionEnd=transitionEndName[i],out=!0;break}return out}},{identity:"RightMargin",fn:function(doc,div){var view=doc.defaultView;return!(view&&"0px"!=view.getComputedStyle(div.firstChild.firstChild,null).marginRight)}},{identity:"DisplayChangeInputSelectionBug",early:!0,fn:function(){var webKitVersion=Ext.webKitVersion;return 0<webKitVersion&&webKitVersion<533}},{identity:"DisplayChangeTextAreaSelectionBug",early:!0,fn:function(){var webKitVersion=Ext.webKitVersion;return 0<webKitVersion&&webKitVersion<534.24}},{identity:"TransparentColor",fn:function(doc,div,view){return view=doc.defaultView,!(view&&"transparent"!=view.getComputedStyle(div.lastChild,null).backgroundColor)}},{identity:"ComputedStyle",fn:function(doc,div,view){return view=doc.defaultView,view&&view.getComputedStyle}},{identity:"Svg",fn:function(doc){return!!doc.createElementNS&&!!doc.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}},{identity:"Canvas",fn:function(doc){return!!doc.createElement("canvas").getContext}},{identity:"Vml",fn:function(doc){var d=doc.createElement("div");return d.innerHTML="<!--[if vml]><br/><br/><![endif]-->",2==d.childNodes.length}},{identity:"Float",fn:function(doc,div){return!!div.lastChild.style.cssFloat}},{identity:"AudioTag",fn:function(doc){return!!doc.createElement("audio").canPlayType}},{identity:"History",fn:function(){var history=window.history;return!(!history||!history.pushState)}},{identity:"CSS3DTransform",fn:function(){return"undefined"!=typeof WebKitCSSMatrix&&(new WebKitCSSMatrix).hasOwnProperty("m41")}},{identity:"CSS3LinearGradient",fn:function(doc,div){var property="background-image:",webkit="-webkit-gradient(linear, left top, right bottom, from(black), to(white))",w3c="linear-gradient(left top, black, white)",moz="-moz-"+w3c,ms="-ms-"+w3c,opera="-o-"+w3c,options=[property+webkit,property+w3c,property+moz,property+ms,property+opera];return div.style.cssText=options.join(";"),(""+div.style.backgroundImage).indexOf("gradient")!==-1&&!Ext.isIE9}},{identity:"CSS3BorderRadius",fn:function(doc,div){var i,domPrefixes=["borderRadius","BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],pass=!1;for(i=0;i<domPrefixes.length;i++)if(void 0!==document.body.style[domPrefixes[i]])return!0;return pass}},{identity:"GeoLocation",fn:function(){return"undefined"!=typeof navigator&&"geolocation"in navigator||"undefined"!=typeof google&&"undefined"!=typeof google.gears}},{identity:"MouseEnterLeave",fn:function(doc,div){return"onmouseenter"in div&&"onmouseleave"in div}},{identity:"MouseWheel",fn:function(doc,div){return"onmousewheel"in div}},{identity:"Opacity",fn:function(doc,div){return!(Ext.isIE6||Ext.isIE7||Ext.isIE8)&&(div.firstChild.style.cssText="opacity:0.73","0.73"==div.firstChild.style.opacity)}},{identity:"Placeholder",fn:function(doc){return"placeholder"in doc.createElement("input")}},{identity:"Direct2DBug",fn:function(){return Ext.isString(document.body.style.msTransformOrigin)&&Ext.isIE10m}},{identity:"BoundingClientRect",fn:function(doc,div){return Ext.isFunction(div.getBoundingClientRect)}},{identity:"RotatedBoundingClientRect",fn:function(){var body=document.body,supports=!1,el=document.createElement("div"),style=el.style;return el.getBoundingClientRect&&(style.WebkitTransform=style.MozTransform=style.OTransform=style.transform="rotate(90deg)",style.width="100px",style.height="30px",body.appendChild(el),supports=100!==el.getBoundingClientRect().height,body.removeChild(el)),supports}},{identity:"IncludePaddingInWidthCalculation",fn:function(doc,div){return 210==div.childNodes[1].firstChild.offsetWidth}},{identity:"IncludePaddingInHeightCalculation",fn:function(doc,div){return 210==div.childNodes[1].firstChild.offsetHeight}},{identity:"ArraySort",fn:function(){var a=[1,2,3,4,5].sort(function(){return 0});return 1===a[0]&&2===a[1]&&3===a[2]&&4===a[3]&&5===a[4]}},{identity:"Range",fn:function(){return!!document.createRange}},{identity:"CreateContextualFragment",fn:function(){var range=!!Ext.supports.Range&&document.createRange();return range&&!!range.createContextualFragment}},{identity:"WindowOnError",fn:function(){return Ext.isIE||Ext.isGecko||Ext.webKitVersion>=534.16}},{identity:"TextAreaMaxLength",fn:function(){var el=document.createElement("textarea");return"maxlength"in el}},{identity:"GetPositionPercentage",fn:function(doc,div){return"10%"==getStyle(div.childNodes[2],"left")}},{identity:"PercentageHeightOverflowBug",fn:function(doc){var style,el,hasBug=!1;return Ext.getScrollbarSize().height&&(el=doc.createElement("div"),style=el.style,style.height="50px",style.width="50px",style.overflow="auto",style.position="absolute",el.innerHTML=['<div style="display:table;height:100%;">','<div style="width:51px;"></div>',"</div>"].join(""),doc.body.appendChild(el),50===el.firstChild.offsetHeight&&(hasBug=!0),doc.body.removeChild(el)),hasBug}},{identity:"xOriginBug",fn:function(doc,div){div.innerHTML='<div id="b1" style="height:100px;width:100px;direction:rtl;position:relative;overflow:scroll"><div id="b2" style="position:relative;width:100%;height:20px;"></div><div id="b3" style="position:absolute;width:20px;height:20px;top:0px;right:0px"></div></div>';var outerBox=document.getElementById("b1").getBoundingClientRect(),b2=document.getElementById("b2").getBoundingClientRect(),b3=document.getElementById("b3").getBoundingClientRect();return b2.left!==outerBox.left&&b3.right!==outerBox.right}},{identity:"ScrollWidthInlinePaddingBug",fn:function(doc){var style,el,hasBug=!1;return el=doc.createElement("div"),style=el.style,style.height="50px",style.width="50px",style.padding="10px",style.overflow="hidden",style.position="absolute",el.innerHTML='<span style="display:inline-block;zoom:1;height:60px;width:60px;"></span>',doc.body.appendChild(el),70===el.scrollWidth&&(hasBug=!0),doc.body.removeChild(el),hasBug}}]}}(),Ext.supports.init(),Ext.util.DelayedTask=function(fn,scope,args,cancelOnDelay){var delay,me=this,call=function(){clearInterval(me.id),me.id=null,fn.apply(scope,args||[]),Ext.EventManager.idleEvent.fire()};cancelOnDelay="boolean"!=typeof cancelOnDelay||cancelOnDelay,me.id=null,me.delay=function(newDelay,newFn,newScope,newArgs){cancelOnDelay&&me.cancel(),"number"==typeof newDelay&&(delay=newDelay),fn=newFn||fn,scope=newScope||scope,args=newArgs||args,me.id||(me.id=setInterval(call,delay))},me.cancel=function(){me.id&&(clearInterval(me.id),me.id=null)}},Ext.define("Ext.util.Event",function(){var arraySlice=Array.prototype.slice,arrayInsert=Ext.Array.insert,toArray=Ext.Array.toArray,DelayedTask=Ext.util.DelayedTask;return{isEvent:!0,suspended:0,noOptions:{},constructor:function(observable,name){this.name=name,this.observable=observable,this.listeners=[]},addListener:function(fn,scope,options){var listeners,listener,priority,isNegativePriority,highestNegativePriorityIndex,hasNegativePriorityIndex,length,index,i,listenerPriority,me=this;if(scope=scope||me.observable,!me.isListening(fn,scope)){if(listener=me.createListener(fn,scope,options),me.firing&&(me.listeners=me.listeners.slice(0)),listeners=me.listeners,index=length=listeners.length,priority=options&&options.priority,highestNegativePriorityIndex=me._highestNegativePriorityIndex,hasNegativePriorityIndex=void 0!==highestNegativePriorityIndex,priority)if(isNegativePriority=priority<0,!isNegativePriority||hasNegativePriorityIndex){for(i=isNegativePriority?highestNegativePriorityIndex:0;i<length;i++)if(listenerPriority=listeners[i].o?listeners[i].o.priority||0:0,listenerPriority<priority){index=i;break}}else me._highestNegativePriorityIndex=index;else hasNegativePriorityIndex&&(index=highestNegativePriorityIndex);!isNegativePriority&&index<=highestNegativePriorityIndex&&me._highestNegativePriorityIndex++,index===length?me.listeners[length]=listener:arrayInsert(me.listeners,index,[listener])}},createListener:function(fn,scope,o){scope=scope||this.observable;var me=this,listener={fn:fn,scope:scope,ev:me},handler=fn;return o&&(listener.o=o,o.single&&(handler=me.createSingle(handler,listener,o,scope)),o.target&&(handler=me.createTargeted(handler,listener,o,scope)),o.delay&&(handler=me.createDelayed(handler,listener,o,scope)),o.buffer&&(handler=me.createBuffered(handler,listener,o,scope))),listener.fireFn=handler,listener},findListener:function(fn,scope){for(var listener,s,listeners=this.listeners,i=listeners.length;i--;)if(listener=listeners[i],listener&&(s=listener.scope,listener.fn==fn&&s==(scope||this.observable)))return i;return-1},isListening:function(fn,scope){return this.findListener(fn,scope)!==-1},removeListener:function(fn,scope){var index,listener,highestNegativePriorityIndex,k,me=this;if(index=me.findListener(fn,scope),index!=-1){if(listener=me.listeners[index],highestNegativePriorityIndex=me._highestNegativePriorityIndex,me.firing&&(me.listeners=me.listeners.slice(0)),listener.task&&(listener.task.cancel(),delete listener.task),k=listener.tasks&&listener.tasks.length){for(;k--;)listener.tasks[k].cancel();delete listener.tasks}return me.listeners.splice(index,1),highestNegativePriorityIndex&&(index<highestNegativePriorityIndex?me._highestNegativePriorityIndex--:index===highestNegativePriorityIndex&&index===me.listeners.length&&delete me._highestNegativePriorityIndex),!0}return!1},clearListeners:function(){for(var listeners=this.listeners,i=listeners.length;i--;)this.removeListener(listeners[i].fn,listeners[i].scope)},suspend:function(){this.suspended+=1},resume:function(){this.suspended&&this.suspended--},fire:function(){var i,args,listener,len,me=this,listeners=me.listeners,count=listeners.length;if(!me.suspended&&count>0)for(me.firing=!0,args=arguments.length?arraySlice.call(arguments,0):[],len=args.length,i=0;i<count;i++)if(listener=listeners[i],listener.o&&(args[len]=listener.o),listener&&listener.fireFn.apply(listener.scope||me.observable,args)===!1)return me.firing=!1;return me.firing=!1,!0},createTargeted:function(handler,listener,o,scope){return function(){o.target===arguments[0]&&handler.apply(scope,arguments)}},createBuffered:function(handler,listener,o,scope){return listener.task=new DelayedTask,function(){listener.task.delay(o.buffer,handler,scope,toArray(arguments))}},createDelayed:function(handler,listener,o,scope){return function(){var task=new DelayedTask;listener.tasks||(listener.tasks=[]),listener.tasks.push(task),task.delay(o.delay||10,handler,scope,toArray(arguments))}},createSingle:function(handler,listener,o,scope){return function(){var event=listener.ev;return event.removeListener(listener.fn,scope)&&event.observable&&event.observable.hasListeners[event.name]--,handler.apply(scope,arguments)}}}}),Ext.EventManager=new function(){var readyEvent,EventManager=this,doc=document,win=window,escapeRx=/\\/g,prefix=Ext.baseCSSPrefix,supportsAddEventListener=!Ext.isIE9&&"addEventListener"in doc,initExtCss=function(){function add(c){cls.push(prefix+c)}var html,bd=doc.body||doc.getElementsByTagName("body")[0],cls=[],htmlCls=[],supportsLG=Ext.supports.CSS3LinearGradient,supportsBR=Ext.supports.CSS3BorderRadius;return Ext.scopeCss||cls.push(prefix+"body"),!!bd&&(html=bd.parentNode,Ext.isIE&&Ext.isIE9m&&(add("ie"),Ext.isIE6?add("ie6"):(add("ie7p"),Ext.isIE7?add("ie7"):(add("ie8p"),Ext.isIE8?add("ie8"):(add("ie9p"),Ext.isIE9&&add("ie9")))),Ext.isIE7m&&add("ie7m"),Ext.isIE8m&&add("ie8m"),Ext.isIE9m&&add("ie9m"),(Ext.isIE7||Ext.isIE8)&&add("ie78")),Ext.isIE10&&add("ie10"),Ext.isGecko&&(add("gecko"),Ext.isGecko3&&add("gecko3"),Ext.isGecko4&&add("gecko4"),Ext.isGecko5&&add("gecko5")),Ext.isOpera&&add("opera"),Ext.isWebKit&&add("webkit"),Ext.isSafari&&(add("safari"),Ext.isSafari2&&add("safari2"),Ext.isSafari3&&add("safari3"),Ext.isSafari4&&add("safari4"),Ext.isSafari5&&add("safari5"),Ext.isSafari5_0&&add("safari5_0")),Ext.isChrome&&add("chrome"),Ext.isMac&&add("mac"),Ext.isLinux&&add("linux"),supportsBR||add("nbr"),supportsLG||add("nlg"),html&&(Ext.isStrict&&(Ext.isIE6||Ext.isIE7)?Ext.isBorderBox=!1:Ext.isBorderBox=!0,Ext.isBorderBox||htmlCls.push(prefix+"content-box"),Ext.isStrict?htmlCls.push(prefix+"strict"):htmlCls.push(prefix+"quirks"),Ext.fly(html,"_internal").addCls(htmlCls)),Ext.fly(bd,"_internal").addCls(cls),!0)};Ext.apply(EventManager,{hasBoundOnReady:!1,hasFiredReady:!1,deferReadyEvent:1,onReadyChain:[],readyEvent:function(){return readyEvent=new Ext.util.Event,readyEvent.fire=function(){Ext._beforeReadyTime=Ext._beforeReadyTime||(new Date).getTime(),readyEvent.self.prototype.fire.apply(readyEvent,arguments),Ext._afterReadytime=(new Date).getTime()},readyEvent}(),idleEvent:new Ext.util.Event,isReadyPaused:function(){return/[?&]ext-pauseReadyFire\b/i.test(location.search)&&!Ext._continueFireReady},bindReadyEvent:function(){EventManager.hasBoundOnReady||("complete"==doc.readyState?EventManager.onReadyEvent({type:doc.readyState||"body"}):(doc.addEventListener("DOMContentLoaded",EventManager.onReadyEvent,!1),win.addEventListener("load",EventManager.onReadyEvent,!1),EventManager.hasBoundOnReady=!0))},onReadyEvent:function(e){e&&e.type&&EventManager.onReadyChain.push(e.type),EventManager.hasBoundOnReady&&(doc.removeEventListener("DOMContentLoaded",EventManager.onReadyEvent,!1),win.removeEventListener("load",EventManager.onReadyEvent,!1)),Ext.isReady||EventManager.fireDocReady()},fireDocReady:function(){Ext.isReady||(Ext._readyTime=(new Date).getTime(),Ext.isReady=!0,Ext.supports.init(),EventManager.onWindowUnload(),readyEvent.onReadyChain=EventManager.onReadyChain,Ext.isNumber(EventManager.deferReadyEvent)?(Ext.Function.defer(EventManager.fireReadyEvent,EventManager.deferReadyEvent),EventManager.hasDocReadyTimer=!0):EventManager.fireReadyEvent())},fireReadyEvent:function(){for(EventManager.hasDocReadyTimer=!1,EventManager.isFiring=!0;readyEvent.listeners.length&&!EventManager.isReadyPaused();)readyEvent.fire();EventManager.isFiring=!1,EventManager.hasFiredReady=!0,Ext.EventManager.idleEvent.fire()},onDocumentReady:function(fn,scope,options){options=options||{},options.single=!0,readyEvent.addListener(fn,scope,options),EventManager.isFiring||EventManager.hasDocReadyTimer||(Ext.isReady?EventManager.fireReadyEvent():EventManager.bindReadyEvent())},stoppedMouseDownEvent:new Ext.util.Event,propRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|freezeEvent)$/,getId:function(element){var id;return element=Ext.getDom(element),id=element===doc||element===win?element===doc?Ext.documentId:Ext.windowId:Ext.id(element),Ext.cache[id]||Ext.addCacheEntry(id,null,element),id},prepareListenerConfig:function(element,config,isRemove){var key,value,args,propRe=EventManager.propRe;for(key in config)config.hasOwnProperty(key)&&(propRe.test(key)||(value=config[key],args="function"==typeof value?[element,key,value,config.scope,config]:[element,key,value.fn,value.scope,value],isRemove?EventManager.removeListener.apply(EventManager,args):EventManager.addListener.apply(EventManager,args)))},mouseEnterLeaveRe:/mouseenter|mouseleave/,normalizeEvent:function(eventName,fn){return EventManager.mouseEnterLeaveRe.test(eventName)&&!Ext.supports.MouseEnterLeave?(fn&&(fn=Ext.Function.createInterceptor(fn,EventManager.contains)),eventName="mouseenter"==eventName?"mouseover":"mouseout"):"mousewheel"!=eventName||Ext.supports.MouseWheel||Ext.isOpera||(eventName="DOMMouseScroll"),{eventName:eventName,fn:fn}},contains:function(event){event=event.browserEvent||event;var parent=event.currentTarget,child=EventManager.getRelatedTarget(event);if(parent&&parent.firstChild)for(;child;){if(child===parent)return!1;child=child.parentNode,child&&1!=child.nodeType&&(child=null)}return!0},addListener:function(element,eventName,fn,scope,options){if("string"!=typeof eventName)return void EventManager.prepareListenerConfig(element,eventName);var hasAddEventListener,bind,wrap,cache,id,cacheItem,capture,dom=element.dom||Ext.getDom(element);"string"==typeof fn&&(fn=Ext.resolveMethod(fn,scope||element)),options=options||{},bind=EventManager.normalizeEvent(eventName,fn),wrap=EventManager.createListenerWrap(dom,eventName,bind.fn,scope,options),cache=EventManager.getEventListenerCache(element.dom?element:dom,eventName),eventName=bind.eventName,hasAddEventListener=supportsAddEventListener||Ext.isIE9&&!dom.attachEvent,hasAddEventListener||(id=EventManager.normalizeId(dom),id&&(cacheItem=Ext.cache[id][eventName],cacheItem&&cacheItem.firing&&(cache=EventManager.cloneEventListenerCache(dom,eventName)))),capture=!!options.capture,cache.push({fn:fn,wrap:wrap,scope:scope,capture:capture}),hasAddEventListener?dom.addEventListener(eventName,wrap,capture):1===cache.length&&(id=EventManager.normalizeId(dom,!0),fn=Ext.Function.bind(EventManager.handleSingleEvent,EventManager,[id,eventName],!0),Ext.cache[id][eventName]={firing:!1,fn:fn},dom.attachEvent("on"+eventName,fn)),dom==doc&&"mousedown"==eventName&&EventManager.stoppedMouseDownEvent.addListener(wrap)},normalizeId:function(dom,force){var id;return id=dom===document?Ext.documentId:dom===window?Ext.windowId:dom.id,!id&&force&&(id=EventManager.getId(dom)),id},handleSingleEvent:function(e,id,eventName){var len,i,listenerCache=EventManager.getEventListenerCache(id,eventName),attachItem=Ext.cache[id][eventName];if(!attachItem.firing){for(attachItem.firing=!0,i=0,len=listenerCache.length;i<len;++i)listenerCache[i].wrap(e);attachItem.firing=!1}},removeListener:function(element,eventName,fn,scope){if("string"!=typeof eventName)return void EventManager.prepareListenerConfig(element,eventName,!0);var id,j,cacheItem,hasRemoveEventListener,listener,wrap,dom=Ext.getDom(element),el=element.dom?element:Ext.get(dom),cache=EventManager.getEventListenerCache(el,eventName),bindName=EventManager.normalizeEvent(eventName).eventName,i=cache.length;if(dom)for(hasRemoveEventListener=supportsAddEventListener||Ext.isIE9&&!dom.detachEvent,"string"==typeof fn&&(fn=Ext.resolveMethod(fn,scope||element));i--;)if(listener=cache[i],listener&&(!fn||listener.fn==fn)&&(!scope||listener.scope===scope)){if(wrap=listener.wrap,wrap.task&&(clearTimeout(wrap.task),delete wrap.task),j=wrap.tasks&&wrap.tasks.length){for(;j--;)clearTimeout(wrap.tasks[j]);delete wrap.tasks}hasRemoveEventListener?dom.removeEventListener(bindName,wrap,listener.capture):(id=EventManager.normalizeId(dom,!0),cacheItem=Ext.cache[id][bindName],cacheItem&&cacheItem.firing&&(cache=EventManager.cloneEventListenerCache(dom,bindName)),1===cache.length&&(fn=cacheItem.fn,delete Ext.cache[id][bindName],dom.detachEvent("on"+bindName,fn))),wrap&&dom==doc&&"mousedown"==eventName&&EventManager.stoppedMouseDownEvent.removeListener(wrap),Ext.Array.erase(cache,i,1)}},removeAll:function(element){var cache,events,eventName,id="string"==typeof element?element:element.id;if(id&&(cache=Ext.cache[id])){events=cache.events;for(eventName in events)events.hasOwnProperty(eventName)&&EventManager.removeListener(element,eventName);cache.events={}}},purgeElement:function(element,eventName){var len,childNodes,dom=Ext.getDom(element),i=0;if(eventName?EventManager.removeListener(element,eventName):EventManager.removeAll(element),dom&&dom.childNodes)for(childNodes=dom.childNodes,len=childNodes.length;i<len;i++)EventManager.purgeElement(childNodes[i],eventName)},createListenerWrap:function(dom,ename,fn,scope,options){options=options||{};var gen,wrap=function(e,args){var f;return gen||(f=["if(!"+Ext.name+") {return;}"],options.buffer||options.delay||options.freezeEvent?(options.freezeEvent&&f.push("e = X.EventObject.setEvent(e);"),f.push("e = new X.EventObjectImpl(e, "+(options.freezeEvent?"true":"false")+");")):f.push("e = X.EventObject.setEvent(e);"),options.delegate?(f.push('var result, t = e.getTarget("'+(options.delegate+"").replace(escapeRx,"\\\\")+'", this);'),f.push("if(!t) {return;}")):f.push("var t = e.target, result;"),options.target&&f.push("if(e.target !== options.target) {return;}"),options.stopEvent?f.push("e.stopEvent();"):(options.preventDefault&&f.push("e.preventDefault();"),options.stopPropagation&&f.push("e.stopPropagation();")),options.normalized===!1&&f.push("e = e.browserEvent;"),options.buffer&&(f.push("(wrap.task && clearTimeout(wrap.task));"),f.push("wrap.task = setTimeout(function() {")),options.delay&&(f.push("wrap.tasks = wrap.tasks || [];"),f.push("wrap.tasks.push(setTimeout(function() {")),f.push("result = fn.call(scope || dom, e, t, options);"),options.single&&f.push("evtMgr.removeListener(dom, ename, fn, scope);"),"mousemove"!==ename&&"unload"!==ename&&(f.push("if (evtMgr.idleEvent.listeners.length) {"),f.push("evtMgr.idleEvent.fire();"),f.push("}")),options.delay&&f.push("}, "+options.delay+"));"),options.buffer&&f.push("}, "+options.buffer+");"),f.push("return result;"),gen=Ext.cacheableFunctionFactory("e","options","fn","scope","ename","dom","wrap","args","X","evtMgr",f.join("\n"))),gen.call(dom,e,options,fn,scope,ename,dom,wrap,args,Ext,EventManager)};return wrap},getEventCache:function(element){var elementCache,eventCache,id;return element?(element.$cache?elementCache=element.$cache:(id="string"==typeof element?element:EventManager.getId(element),elementCache=Ext.cache[id]),eventCache=elementCache.events||(elementCache.events={})):[]},getEventListenerCache:function(element,eventName){var eventCache=EventManager.getEventCache(element);return eventCache[eventName]||(eventCache[eventName]=[])},cloneEventListenerCache:function(element,eventName){var out,eventCache=EventManager.getEventCache(element);return out=eventCache[eventName]?eventCache[eventName].slice(0):[],eventCache[eventName]=out,out},mouseLeaveRe:/(mouseout|mouseleave)/,mouseEnterRe:/(mouseover|mouseenter)/,stopEvent:function(event){EventManager.stopPropagation(event),EventManager.preventDefault(event)},stopPropagation:function(event){event=event.browserEvent||event,event.stopPropagation?event.stopPropagation():event.cancelBubble=!0},preventDefault:function(event){if(event=event.browserEvent||event,event.preventDefault)event.preventDefault();else{event.returnValue=!1;try{(event.ctrlKey||event.keyCode>111&&event.keyCode<124)&&(event.keyCode=-1)}catch(e){}}},getRelatedTarget:function(event){event=event.browserEvent||event;var target=event.relatedTarget;return target||(EventManager.mouseLeaveRe.test(event.type)?target=event.toElement:EventManager.mouseEnterRe.test(event.type)&&(target=event.fromElement)),EventManager.resolveTextNode(target)},getPageX:function(event){return EventManager.getPageXY(event)[0]},getPageY:function(event){return EventManager.getPageXY(event)[1]},getPageXY:function(event){event=event.browserEvent||event;var x=event.pageX,y=event.pageY,docEl=doc.documentElement,body=doc.body;return x||0===x||(x=event.clientX+(docEl&&docEl.scrollLeft||body&&body.scrollLeft||0)-(docEl&&docEl.clientLeft||body&&body.clientLeft||0),y=event.clientY+(docEl&&docEl.scrollTop||body&&body.scrollTop||0)-(docEl&&docEl.clientTop||body&&body.clientTop||0)),[x,y]},getTarget:function(event){return event=event.browserEvent||event,EventManager.resolveTextNode(event.target||event.srcElement)},resolveTextNode:Ext.isGecko?function(node){if(node){var s=HTMLElement.prototype.toString.call(node);if("[xpconnect wrapped native prototype]"!==s&&"[object XULElement]"!==s)return 3==node.nodeType?node.parentNode:node}}:function(node){return node&&3==node.nodeType?node.parentNode:node},curWidth:0,curHeight:0,onWindowResize:function(fn,scope,options){var resize=EventManager.resizeEvent;resize||(EventManager.resizeEvent=resize=new Ext.util.Event,EventManager.on(win,"resize",EventManager.fireResize,null,{buffer:100})),resize.addListener(fn,scope,options)},fireResize:function(){var w=Ext.Element.getViewWidth(),h=Ext.Element.getViewHeight();EventManager.curHeight==h&&EventManager.curWidth==w||(EventManager.curHeight=h,EventManager.curWidth=w,EventManager.resizeEvent.fire(w,h))},removeResizeListener:function(fn,scope){var resize=EventManager.resizeEvent;resize&&resize.removeListener(fn,scope)},onWindowUnload:function(fn,scope,options){var unload=EventManager.unloadEvent;unload||(EventManager.unloadEvent=unload=new Ext.util.Event,EventManager.addListener(win,"unload",EventManager.fireUnload)),fn&&unload.addListener(fn,scope,options)},fireUnload:function(){try{doc=win=void 0;var gridviews,i,ln,el,cache;if(EventManager.unloadEvent.fire(),Ext.isGecko3)for(gridviews=Ext.ComponentQuery.query("gridview"),i=0,ln=gridviews.length;i<ln;i++)gridviews[i].scrollToTop();cache=Ext.cache;for(el in cache)cache.hasOwnProperty(el)&&EventManager.removeAll(el)}catch(e){}},removeUnloadListener:function(fn,scope){var unload=EventManager.unloadEvent;unload&&unload.removeListener(fn,scope)},useKeyDown:Ext.isWebKit?parseInt(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1],10)>=525:!(Ext.isGecko&&!Ext.isWindows||Ext.isOpera&&Ext.operaVersion<12),getKeyEvent:function(){return EventManager.useKeyDown?"keydown":"keypress"}}),!supportsAddEventListener&&document.attachEvent&&Ext.apply(EventManager,{pollScroll:function(){var scrollable=!0;try{document.documentElement.doScroll("left")}catch(e){scrollable=!1}return scrollable&&document.body?EventManager.onReadyEvent({type:"doScroll"}):EventManager.scrollTimeout=setTimeout(EventManager.pollScroll,20),scrollable},scrollTimeout:null,readyStatesRe:/complete/i,checkReadyState:function(){var state=document.readyState;EventManager.readyStatesRe.test(state)&&EventManager.onReadyEvent({type:state})},bindReadyEvent:function(){var topContext=!0;if(!EventManager.hasBoundOnReady){try{topContext=void 0===window.frameElement}catch(e){topContext=!1}topContext&&doc.documentElement.doScroll||(EventManager.pollScroll=Ext.emptyFn),EventManager.pollScroll()!==!0&&("complete"==doc.readyState?EventManager.onReadyEvent({type:"already "+(doc.readyState||"body")}):(doc.attachEvent("onreadystatechange",EventManager.checkReadyState),window.attachEvent("onload",EventManager.onReadyEvent),EventManager.hasBoundOnReady=!0))}},onReadyEvent:function(e){e&&e.type&&EventManager.onReadyChain.push(e.type),EventManager.hasBoundOnReady&&(document.detachEvent("onreadystatechange",EventManager.checkReadyState),window.detachEvent("onload",EventManager.onReadyEvent)),Ext.isNumber(EventManager.scrollTimeout)&&(clearTimeout(EventManager.scrollTimeout),delete EventManager.scrollTimeout),Ext.isReady||EventManager.fireDocReady()},onReadyChain:[]}),Ext.onReady=function(fn,scope,options){Ext.Loader.onReady(fn,scope,!0,options)},Ext.onDocumentReady=EventManager.onDocumentReady,EventManager.on=EventManager.addListener,EventManager.un=EventManager.removeListener,Ext.onReady(initExtCss)},Ext.define("Ext.util.Observable",function(Observable){var emptyFn=Ext.emptyFn,emptyArray=[],arrayProto=Array.prototype,arraySlice=arrayProto.slice,ExtEvent=Ext.util.Event,ListenerRemover=function(observable){return observable instanceof ListenerRemover?observable:(this.observable=observable,arguments[1].isObservable&&(this.managedListeners=!0),void(this.args=arraySlice.call(arguments,1)))};return ListenerRemover.prototype.destroy=function(){this.observable[this.managedListeners?"mun":"un"].apply(this.observable,this.args)},{statics:{releaseCapture:function(o){o.fireEventArgs=this.prototype.fireEventArgs},capture:function(o,fn,scope){var newFn=function(eventName,args){return fn.apply(scope,[eventName].concat(args))};this.captureArgs(o,newFn,scope)},captureArgs:function(o,fn,scope){o.fireEventArgs=Ext.Function.createInterceptor(o.fireEventArgs,fn,scope)},observe:function(cls,listeners){return cls&&(cls.isObservable||(Ext.applyIf(cls,new this),this.captureArgs(cls.prototype,cls.fireEventArgs,cls)),Ext.isObject(listeners)&&cls.on(listeners)),cls},prepareClass:function(T,mixin){if(!T.HasListeners){var HasListeners=function(){},SuperHL=T.superclass.HasListeners||mixin&&mixin.HasListeners||Observable.HasListeners;T.prototype.HasListeners=T.HasListeners=HasListeners,HasListeners.prototype=T.hasListeners=new SuperHL}}},isObservable:!0,eventsSuspended:0,constructor:function(config){var me=this;Ext.apply(me,config),me.hasListeners||(me.hasListeners=new me.HasListeners),me.events=me.events||{},me.listeners&&(me.on(me.listeners),me.listeners=null),me.bubbleEvents&&me.enableBubble(me.bubbleEvents)},onClassExtended:function(T){T.HasListeners||Observable.prepareClass(T)},eventOptionsRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|element|destroyable|vertical|horizontal|freezeEvent|priority)$/,addManagedListener:function(item,ename,fn,scope,options,noDestroy){var config,passedOptions,me=this,managedListeners=me.managedListeners=me.managedListeners||[];if("string"!=typeof ename){passedOptions=arguments.length>4?options:ename,options=ename;for(ename in options)options.hasOwnProperty(ename)&&(config=options[ename],me.eventOptionsRe.test(ename)||me.addManagedListener(item,ename,config.fn||config,config.scope||options.scope||scope,config.fn?config:passedOptions,!0));if(options&&options.destroyable)return new ListenerRemover(me,item,options)}else if("string"==typeof fn&&(scope=scope||me,fn=Ext.resolveMethod(fn,scope)),fn!==emptyFn&&(managedListeners.push({item:item,ename:ename,fn:fn,scope:scope,options:options}),item.on(ename,fn,scope,options),!noDestroy&&options&&options.destroyable))return new ListenerRemover(me,item,ename,fn,scope)},removeManagedListener:function(item,ename,fn,scope){var options,config,managedListeners,length,i,me=this;if("string"!=typeof ename){options=ename;for(ename in options)options.hasOwnProperty(ename)&&(config=options[ename],me.eventOptionsRe.test(ename)||me.removeManagedListener(item,ename,config.fn||config,config.scope||options.scope||scope))}else for(managedListeners=me.managedListeners?me.managedListeners.slice():[],"string"==typeof fn&&(scope=scope||me,fn=Ext.resolveMethod(fn,scope)),i=0,
length=managedListeners.length;i<length;i++)me.removeManagedListenerItem(!1,managedListeners[i],item,ename,fn,scope)},fireEvent:function(eventName){return this.fireEventArgs(eventName,arraySlice.call(arguments,1))},fireEventArgs:function(eventName,args){eventName=eventName.toLowerCase();var me=this,events=me.events,event=events&&events[eventName],ret=!0;return event&&me.hasListeners[eventName]&&(ret=me.continueFireEvent(eventName,args||emptyArray,event.bubble)),ret},continueFireEvent:function(eventName,args,bubbles){var queue,event,target=this,ret=!0;do{if(target.eventsSuspended)return(queue=target.eventQueue)&&queue.push([eventName,args,bubbles]),ret;if(event=target.events[eventName],event&&event!==!0&&(ret=event.fire.apply(event,args))===!1)break}while(bubbles&&(target=target.getBubbleParent()));return ret},getBubbleParent:function(){var me=this,parent=me.getBubbleTarget&&me.getBubbleTarget();return parent&&parent.isObservable?parent:null},addListener:function(ename,fn,scope,options){var config,event,me=this,prevListenerCount=0;if("string"!=typeof ename){options=ename;for(ename in options)options.hasOwnProperty(ename)&&(config=options[ename],me.eventOptionsRe.test(ename)||me.addListener(ename,config.fn||config,config.scope||options.scope,config.fn?config:options));if(options&&options.destroyable)return new ListenerRemover(me,options)}else if(ename=ename.toLowerCase(),event=me.events[ename],event&&event.isEvent?prevListenerCount=event.listeners.length:me.events[ename]=event=new ExtEvent(me,ename),"string"==typeof fn&&(scope=scope||me,fn=Ext.resolveMethod(fn,scope)),fn!==emptyFn&&(event.addListener(fn,scope,options),event.listeners.length!==prevListenerCount&&me.hasListeners._incr_(ename),options&&options.destroyable))return new ListenerRemover(me,ename,fn,scope,options)},removeListener:function(ename,fn,scope){var config,event,options,me=this;if("string"!=typeof ename){options=ename;for(ename in options)options.hasOwnProperty(ename)&&(config=options[ename],me.eventOptionsRe.test(ename)||me.removeListener(ename,config.fn||config,config.scope||options.scope))}else ename=ename.toLowerCase(),event=me.events[ename],event&&event.isEvent&&("string"==typeof fn&&(scope=scope||me,fn=Ext.resolveMethod(fn,scope)),event.removeListener(fn,scope)&&me.hasListeners._decr_(ename))},clearListeners:function(){var event,key,events=this.events,hasListeners=this.hasListeners;for(key in events)events.hasOwnProperty(key)&&(event=events[key],event.isEvent&&(delete hasListeners[key],event.clearListeners()));this.clearManagedListeners()},clearManagedListeners:function(){for(var managedListeners=this.managedListeners||[],i=0,len=managedListeners.length;i<len;i++)this.removeManagedListenerItem(!0,managedListeners[i]);this.managedListeners=[]},removeManagedListenerItem:function(isClear,managedListener,item,ename,fn,scope){!isClear&&(managedListener.item!==item||managedListener.ename!==ename||fn&&managedListener.fn!==fn||scope&&managedListener.scope!==scope)||(managedListener.item.un(managedListener.ename,managedListener.fn,managedListener.scope),isClear||Ext.Array.remove(this.managedListeners,managedListener))},addEvents:function(o){var arg,args,i,me=this,events=me.events||(me.events={});if("string"==typeof o)for(args=arguments,i=args.length;i--;)arg=args[i],events[arg]||(events[arg]=!0);else Ext.applyIf(me.events,o)},hasListener:function(ename){return!!this.hasListeners[ename.toLowerCase()]},suspendEvents:function(queueSuspended){this.eventsSuspended+=1,queueSuspended&&!this.eventQueue&&(this.eventQueue=[])},suspendEvent:function(eventName){var i,event,len=arguments.length;for(i=0;i<len;i++)event=this.events[arguments[i]],event&&event.suspend&&event.suspend()},resumeEvent:function(){var i,event,len=arguments.length;for(i=0;i<len;i++)event=this.events[arguments[i]],event&&event.resume&&event.resume()},resumeEvents:function(){var qLen,q,me=this,queued=me.eventQueue;if(me.eventsSuspended&&!--me.eventsSuspended&&(delete me.eventQueue,queued))for(qLen=queued.length,q=0;q<qLen;q++)me.continueFireEvent.apply(me,queued[q])},relayEvents:function(origin,events,prefix){for(var oldName,me=this,len=events.length,i=0,relayers={};i<len;i++)oldName=events[i],relayers[oldName]=me.createRelayer(prefix?prefix+oldName:oldName);return me.mon(origin,relayers,null,null,void 0),new ListenerRemover(me,origin,relayers)},createRelayer:function(newName,beginEnd){var me=this;return function(){return me.fireEventArgs.call(me,newName,beginEnd?arraySlice.apply(arguments,beginEnd):arguments)}},enableBubble:function(eventNames){if(eventNames){var ename,event,i,me=this,names="string"==typeof eventNames?arguments:eventNames,length=names.length,events=me.events;for(i=0;i<length;++i)ename=names[i].toLowerCase(),event=events[ename],event&&"boolean"!=typeof event||(events[ename]=event=new ExtEvent(me,ename)),me.hasListeners._incr_(ename),event.bubble=!0}}}},function(){function getMethodEvent(method){var returnValue,v,cancel,makeCall,e=(this.methodEvents=this.methodEvents||{})[method],obj=this;return e||(this.methodEvents[method]=e={},e.originalFn=this[method],e.methodName=method,e.before=[],e.after=[],makeCall=function(fn,scope,args){void 0!==(v=fn.apply(scope||obj,args))&&("object"==typeof v?(returnValue=void 0!==v.returnValue?v.returnValue:v,cancel=!!v.cancel):v===!1?cancel=!0:returnValue=v)},this[method]=function(){var b,i,len,args=Array.prototype.slice.call(arguments,0);for(returnValue=v=void 0,cancel=!1,i=0,len=e.before.length;i<len;i++)if(b=e.before[i],makeCall(b.fn,b.scope,args),cancel)return returnValue;for(void 0!==(v=e.originalFn.apply(obj,args))&&(returnValue=v),i=0,len=e.after.length;i<len;i++)if(b=e.after[i],makeCall(b.fn,b.scope,args),cancel)return returnValue;return returnValue}),e}var globalEvents,Observable=this,proto=Observable.prototype,HasListeners=function(){},prepareMixin=function(T){if(!T.HasListeners){var proto=T.prototype;Observable.prepareClass(T,this),T.onExtended(function(U){Observable.prepareClass(U)}),proto.onClassMixedIn?Ext.override(T,{onClassMixedIn:function(U){prepareMixin.call(this,U),this.callParent(arguments)}}):proto.onClassMixedIn=function(U){prepareMixin.call(this,U)}}};HasListeners.prototype={_decr_:function(ev){--this[ev]||delete this[ev]},_incr_:function(ev){this.hasOwnProperty(ev)?++this[ev]:this[ev]=1}},proto.HasListeners=Observable.HasListeners=HasListeners,Observable.createAlias({on:"addListener",un:"removeListener",mon:"addManagedListener",mun:"removeManagedListener"}),Observable.observeClass=Observable.observe,Ext.globalEvents=globalEvents=new Observable({events:{idle:Ext.EventManager.idleEvent,ready:Ext.EventManager.readyEvent}}),Ext.on=function(){return globalEvents.addListener.apply(globalEvents,arguments)},Ext.un=function(){return globalEvents.removeListener.apply(globalEvents,arguments)},Ext.apply(proto,{onClassMixedIn:prepareMixin,beforeMethod:function(method,fn,scope){getMethodEvent.call(this,method).before.push({fn:fn,scope:scope})},afterMethod:function(method,fn,scope){getMethodEvent.call(this,method).after.push({fn:fn,scope:scope})},removeMethodListener:function(method,fn,scope){var i,len,e=this.getMethodEvent(method);for(i=0,len=e.before.length;i<len;i++)if(e.before[i].fn==fn&&e.before[i].scope==scope)return void Ext.Array.erase(e.before,i,1);for(i=0,len=e.after.length;i<len;i++)if(e.after[i].fn==fn&&e.after[i].scope==scope)return void Ext.Array.erase(e.after,i,1)},toggleEventLogging:function(toggle){Ext.util.Observable[toggle?"capture":"releaseCapture"](this,function(en){Ext.isDefined(Ext.global.console)&&Ext.global.console.log(en,arguments)})}})}),Ext.define("Ext.EventObjectImpl",{BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WHEEL_SCALE:function(){var scale;return Ext.isGecko?scale=3:Ext.isMac?(scale=Ext.isSafari&&Ext.webKitVersion>=532?120:12,scale*=3):scale=120,scale}(),clickRe:/(dbl)?click/,safariKeys:{3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},btnMap:Ext.isIE?{1:0,4:1,2:2}:{0:0,1:1,2:2},constructor:function(event,freezeEvent){event&&this.setEvent(event.browserEvent||event,freezeEvent)},setEvent:function(event,freezeEvent){var button,me=this;return event===me||event&&event.browserEvent?event:(me.browserEvent=event,event?(button=event.button?me.btnMap[event.button]:event.which?event.which-1:-1,me.clickRe.test(event.type)&&button==-1&&(button=0),me.type=event.type,me.button=button,me.shiftKey=event.shiftKey,me.ctrlKey=event.ctrlKey||event.metaKey||!1,me.altKey=event.altKey,me.keyCode=event.keyCode,me.charCode=event.charCode,me.target=Ext.EventManager.getTarget(event),me.relatedTarget=Ext.EventManager.getRelatedTarget(event),me.currentTarget=event.currentTarget,me.xy=freezeEvent?me.getXY():null):(me.button=-1,me.shiftKey=!1,me.ctrlKey=!1,me.altKey=!1,me.keyCode=0,me.charCode=0,me.target=null,me.xy=[0,0]),me)},clone:function(){return new this.self(this.browserEvent,this)},stopEvent:function(){this.stopPropagation(),this.preventDefault()},preventDefault:function(){this.browserEvent&&Ext.EventManager.preventDefault(this.browserEvent)},stopPropagation:function(){var browserEvent=this.browserEvent;browserEvent&&("mousedown"==browserEvent.type&&Ext.EventManager.stoppedMouseDownEvent.fire(this),Ext.EventManager.stopPropagation(browserEvent))},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(key){return Ext.isWebKit?this.safariKeys[key]||key:key},getPageX:function(){return this.getX()},getPageY:function(){return this.getY()},getX:function(){return this.getXY()[0]},getY:function(){return this.getXY()[1]},getXY:function(){return this.xy||(this.xy=Ext.EventManager.getPageXY(this.browserEvent)),this.xy},getTarget:function(selector,maxDepth,returnEl){return selector?Ext.fly(this.target).findParent(selector,maxDepth,returnEl):returnEl?Ext.get(this.target):this.target},getRelatedTarget:function(selector,maxDepth,returnEl){return selector&&this.relatedTarget?Ext.fly(this.relatedTarget).findParent(selector,maxDepth,returnEl):returnEl?Ext.get(this.relatedTarget):this.relatedTarget},correctWheelDelta:function(delta){var scale=this.WHEEL_SCALE,ret=Math.round(delta/scale);return!ret&&delta&&(ret=delta<0?-1:1),ret},getWheelDeltas:function(){var me=this,event=me.browserEvent,dx=0,dy=0;return Ext.isDefined(event.wheelDeltaX)?(dx=event.wheelDeltaX,dy=event.wheelDeltaY):event.wheelDelta?dy=event.wheelDelta:event.detail&&(dy=-event.detail,dy>100?dy=3:dy<-100&&(dy=-3),Ext.isDefined(event.axis)&&event.axis===event.HORIZONTAL_AXIS&&(dx=dy,dy=0)),{x:me.correctWheelDelta(dx),y:me.correctWheelDelta(dy)}},getWheelDelta:function(){var deltas=this.getWheelDeltas();return deltas.y},within:function(el,related,allowEl){if(el){var result,t=related?this.getRelatedTarget():this.getTarget();if(t)return result=Ext.fly(el,"_internal").contains(t),!result&&allowEl&&(result=t==Ext.getDom(el)),result}return!1},isNavKeyPress:function(){var me=this,k=this.normalizeKey(me.keyCode);return k>=33&&k<=40||k==me.RETURN||k==me.TAB||k==me.ESC},isSpecialKey:function(){var k=this.normalizeKey(this.keyCode);return"keypress"==this.type&&this.ctrlKey||this.isNavKeyPress()||k==this.BACKSPACE||k>=16&&k<=20||k>=44&&k<=46},getPoint:function(){var xy=this.getXY();return new Ext.util.Point(xy[0],xy[1])},hasModifier:function(){return this.ctrlKey||this.altKey||this.shiftKey||this.metaKey},injectEvent:function(){function createMouseEventDispatcher(type,detail){var cancelable="mousemove"!=type;return function(targetEl,srcEvent){var xy=srcEvent.getXY(),e=API.createMouseEvent(targetEl.ownerDocument,type,!0,cancelable,detail,xy[0],xy[1],srcEvent.ctrlKey,srcEvent.altKey,srcEvent.shiftKey,srcEvent.metaKey,srcEvent.button,srcEvent.relatedTarget);API.fireEvent(targetEl,type,e)}}function cannotInject(target,srcEvent){}var API,crazyIEButtons,dispatchers={};return!Ext.isIE9m&&document.createEvent?API={createHtmlEvent:function(doc,type,bubbles,cancelable){var event=doc.createEvent("HTMLEvents");return event.initEvent(type,bubbles,cancelable),event},createMouseEvent:function(doc,type,bubbles,cancelable,detail,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget){var event=doc.createEvent("MouseEvents"),view=doc.defaultView||window;return event.initMouseEvent?event.initMouseEvent(type,bubbles,cancelable,view,detail,clientX,clientY,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget):(event=doc.createEvent("UIEvents"),event.initEvent(type,bubbles,cancelable),event.view=view,event.detail=detail,event.screenX=clientX,event.screenY=clientY,event.clientX=clientX,event.clientY=clientY,event.ctrlKey=ctrlKey,event.altKey=altKey,event.metaKey=metaKey,event.shiftKey=shiftKey,event.button=button,event.relatedTarget=relatedTarget),event},createUIEvent:function(doc,type,bubbles,cancelable,detail){var event=doc.createEvent("UIEvents"),view=doc.defaultView||window;return event.initUIEvent(type,bubbles,cancelable,view,detail),event},fireEvent:function(target,type,event){target.dispatchEvent(event)},fixTarget:function(target){return target!=window||target.dispatchEvent?target:document}}:document.createEventObject&&(crazyIEButtons={0:1,1:4,2:2},API={createHtmlEvent:function(doc,type,bubbles,cancelable){var event=doc.createEventObject();return event.bubbles=bubbles,event.cancelable=cancelable,event},createMouseEvent:function(doc,type,bubbles,cancelable,detail,clientX,clientY,ctrlKey,altKey,shiftKey,metaKey,button,relatedTarget){var event=doc.createEventObject();return event.bubbles=bubbles,event.cancelable=cancelable,event.detail=detail,event.screenX=clientX,event.screenY=clientY,event.clientX=clientX,event.clientY=clientY,event.ctrlKey=ctrlKey,event.altKey=altKey,event.shiftKey=shiftKey,event.metaKey=metaKey,event.button=crazyIEButtons[button]||button,event.relatedTarget=relatedTarget,event},createUIEvent:function(doc,type,bubbles,cancelable,detail){var event=doc.createEventObject();return event.bubbles=bubbles,event.cancelable=cancelable,event},fireEvent:function(target,type,event){target.fireEvent("on"+type,event)},fixTarget:function(target){return target==document?document.documentElement:target}}),Ext.Object.each({load:[!1,!1],unload:[!1,!1],select:[!0,!1],change:[!0,!1],submit:[!0,!0],reset:[!0,!1],resize:[!0,!1],scroll:[!0,!1]},function(name,value){var bubbles=value[0],cancelable=value[1];dispatchers[name]=function(targetEl,srcEvent){var e=API.createHtmlEvent(name,bubbles,cancelable);API.fireEvent(targetEl,name,e)}}),Ext.each(["click","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout"],function(eventName){dispatchers[eventName]=createMouseEventDispatcher(eventName,1)}),Ext.Object.each({focusin:[!0,!1],focusout:[!0,!1],activate:[!0,!0],focus:[!1,!1],blur:[!1,!1]},function(name,value){var bubbles=value[0],cancelable=value[1];dispatchers[name]=function(targetEl,srcEvent){var e=API.createUIEvent(targetEl.ownerDocument,name,bubbles,cancelable,1);API.fireEvent(targetEl,name,e)}}),API||(dispatchers={},API={fixTarget:Ext.identityFn}),function(target){var me=this,dispatcher=dispatchers[me.type]||cannotInject,t=target?target.dom||target:me.getTarget();t=API.fixTarget(t),dispatcher(t,me)}}()},function(){Ext.EventObject=new Ext.EventObjectImpl}),Ext.define("Ext.dom.AbstractQuery",{select:function(q,root){var nodes,i,j,qlen,nlen,results=[];for(root=root||document,"string"==typeof root&&(root=document.getElementById(root)),q=q.split(","),i=0,qlen=q.length;i<qlen;i++)if("string"==typeof q[i])if("@"==typeof q[i][0])nodes=root.getAttributeNode(q[i].substring(1)),results.push(nodes);else for(nodes=root.querySelectorAll(q[i]),j=0,nlen=nodes.length;j<nlen;j++)results.push(nodes[j]);return results},selectNode:function(q,root){return this.select(q,root)[0]},is:function(el,q){return"string"==typeof el&&(el=document.getElementById(el)),this.select(q).indexOf(el)!==-1}}),Ext.define("Ext.dom.AbstractHelper",{emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/^(?:tag|children|cn|html|tpl|tplData)$/i,endRe:/end/i,styleSepRe:/\s*(?::|;)\s*/,attributeTransform:{cls:"class",htmlFor:"for"},closeTags:{},decamelizeName:function(){function decamel(match,p1,p2){return p1+"-"+p2.toLowerCase()}var camelCaseRe=/([a-z])([A-Z])/g,cache={};return function(s){return cache[s]||(cache[s]=s.replace(camelCaseRe,decamel))}}(),generateMarkup:function(spec,buffer){var attr,val,tag,i,closeTags,me=this,specType=typeof spec;if("string"==specType||"number"==specType)buffer.push(spec);else if(Ext.isArray(spec))for(i=0;i<spec.length;i++)spec[i]&&me.generateMarkup(spec[i],buffer);else{tag=spec.tag||"div",buffer.push("<",tag);for(attr in spec)spec.hasOwnProperty(attr)&&(val=spec[attr],me.confRe.test(attr)||("object"==typeof val?(buffer.push(" ",attr,'="'),me.generateStyles(val,buffer,!0).push('"')):buffer.push(" ",me.attributeTransform[attr]||attr,'="',val,'"')));me.emptyTags.test(tag)?buffer.push("/>"):(buffer.push(">"),(val=spec.tpl)&&val.applyOut(spec.tplData,buffer),(val=spec.html)&&buffer.push(val),(val=spec.cn||spec.children)&&me.generateMarkup(val,buffer),closeTags=me.closeTags,buffer.push(closeTags[tag]||(closeTags[tag]="</"+tag+">")))}return buffer},generateStyles:function(styles,buffer,encode){var name,val,a=buffer||[];for(name in styles)styles.hasOwnProperty(name)&&(val=styles[name],name=this.decamelizeName(name),encode&&Ext.String.hasHtmlCharacters(val)&&(val=Ext.String.htmlEncode(val)),a.push(name,":",val,";"));return buffer||a.join("")},markup:function(spec){if("string"==typeof spec)return spec;var buf=this.generateMarkup(spec,[]);return buf.join("")},applyStyles:function(el,styles){if(styles){var len,i=0;if(el=Ext.fly(el,"_applyStyles"),"function"==typeof styles&&(styles=styles.call()),"string"==typeof styles)for(styles=Ext.util.Format.trim(styles).split(this.styleSepRe),len=styles.length;i<len;)el.setStyle(styles[i++],styles[i++]);else Ext.isObject(styles)&&el.setStyle(styles)}},insertHtml:function(where,el,html){var setStart,range,frag,rangeEl,hash={};return where=where.toLowerCase(),hash.beforebegin=["BeforeBegin","previousSibling"],hash.afterend=["AfterEnd","nextSibling"],range=el.ownerDocument.createRange(),setStart="setStart"+(this.endRe.test(where)?"After":"Before"),hash[where]?(range[setStart](el),frag=range.createContextualFragment(html),el.parentNode.insertBefore(frag,"beforebegin"==where?el:el.nextSibling),el[("beforebegin"==where?"previous":"next")+"Sibling"]):(rangeEl=("afterbegin"==where?"first":"last")+"Child",el.firstChild?(range[setStart](el[rangeEl]),frag=range.createContextualFragment(html),"afterbegin"==where?el.insertBefore(frag,el.firstChild):el.appendChild(frag)):el.innerHTML=html,el[rangeEl])},insertBefore:function(el,o,returnElement){return this.doInsert(el,o,returnElement,"beforebegin")},insertAfter:function(el,o,returnElement){return this.doInsert(el,o,returnElement,"afterend","nextSibling")},insertFirst:function(el,o,returnElement){return this.doInsert(el,o,returnElement,"afterbegin","firstChild")},append:function(el,o,returnElement){return this.doInsert(el,o,returnElement,"beforeend","",!0)},overwrite:function(el,o,returnElement){return el=Ext.getDom(el),el.innerHTML=this.markup(o),returnElement?Ext.get(el.firstChild):el.firstChild},doInsert:function(el,o,returnElement,pos,sibling,append){var newNode=this.insertHtml(pos,Ext.getDom(el),this.markup(o));return returnElement?Ext.get(newNode,!0):newNode}}),Ext.define("Ext.dom.AbstractElement_static",{override:"Ext.dom.AbstractElement",inheritableStatics:{unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,camelRe:/(-[a-z])/gi,msRe:/^-ms-/,cssRe:/([a-z0-9\-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*)?;?/gi,opacityRe:/alpha\(opacity=(.*)\)/i,propertyCache:{},defaultUnit:"px",borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},addUnits:function(size,units){return"number"==typeof size?size+(units||this.defaultUnit||"px"):""===size||"auto"==size||void 0===size||null===size?size||"":this.unitRe.test(size)?size:size||""},isAncestor:function(p,c){var ret=!1;if(p=Ext.getDom(p),c=Ext.getDom(c),p&&c){if(p.contains)return p.contains(c);if(p.compareDocumentPosition)return!!(16&p.compareDocumentPosition(c));for(;c=c.parentNode;)ret=c==p||ret}return ret},parseBox:function(box){box=box||0;var parts,ln,type=typeof box;return"number"===type?{top:box,right:box,bottom:box,left:box}:"string"!==type?box:(parts=box.split(" "),ln=parts.length,1==ln?parts[1]=parts[2]=parts[3]=parts[0]:2==ln?(parts[2]=parts[0],parts[3]=parts[1]):3==ln&&(parts[3]=parts[1]),{top:parseFloat(parts[0])||0,right:parseFloat(parts[1])||0,bottom:parseFloat(parts[2])||0,left:parseFloat(parts[3])||0})},unitizeBox:function(box,units){var a=this.addUnits,b=this.parseBox(box);return a(b.top,units)+" "+a(b.right,units)+" "+a(b.bottom,units)+" "+a(b.left,units)},camelReplaceFn:function(m,a){return a.charAt(1).toUpperCase()},normalize:function(prop){return"float"==prop&&(prop=Ext.supports.Float?"cssFloat":"styleFloat"),this.propertyCache[prop]||(this.propertyCache[prop]=prop.replace(this.msRe,"ms-").replace(this.camelRe,this.camelReplaceFn))},getDocumentHeight:function(){return Math.max(Ext.isStrict?document.documentElement.scrollHeight:document.body.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return Math.max(Ext.isStrict?document.documentElement.scrollWidth:document.body.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return window.innerHeight},getViewportWidth:function(){return window.innerWidth},getViewSize:function(){return{width:window.innerWidth,height:window.innerHeight}},getOrientation:function(){return Ext.supports.OrientationChange?0==window.orientation?"portrait":"landscape":window.innerHeight>window.innerWidth?"portrait":"landscape"},fromPoint:function(x,y){return Ext.get(document.elementFromPoint(x,y))},parseStyles:function(styles){var matches,out={},cssRe=this.cssRe;if(styles)for(cssRe.lastIndex=0;matches=cssRe.exec(styles);)out[matches[1]]=matches[2]||"";return out}}},function(){function makeSelectionRestoreFn(activeEl,start,end){return function(){activeEl.selectionStart=start,activeEl.selectionEnd=end}}var doc=document,activeElement=null,isCSS1="CSS1Compat"==doc.compatMode;"activeElement"in doc||!doc.addEventListener||doc.addEventListener("focus",function(ev){ev&&ev.target&&(activeElement=ev.target==doc?null:ev.target)},!0),this.addInheritableStatics({getActiveElement:function(){var active;try{active=doc.activeElement}catch(e){}return active=active||activeElement,active||(active=activeElement=document.body),active},getRightMarginFixCleaner:function(target){var activeEl,tag,start,end,supports=Ext.supports,hasInputBug=supports.DisplayChangeInputSelectionBug,hasTextAreaBug=supports.DisplayChangeTextAreaSelectionBug;return(hasInputBug||hasTextAreaBug)&&(activeEl=doc.activeElement||activeElement,tag=activeEl&&activeEl.tagName,(hasTextAreaBug&&"TEXTAREA"==tag||hasInputBug&&"INPUT"==tag&&"text"==activeEl.type)&&Ext.dom.Element.isAncestor(target,activeEl)&&(start=activeEl.selectionStart,end=activeEl.selectionEnd,Ext.isNumber(start)&&Ext.isNumber(end)))?makeSelectionRestoreFn(activeEl,start,end):Ext.emptyFn},getViewWidth:function(full){return full?Ext.dom.Element.getDocumentWidth():Ext.dom.Element.getViewportWidth()},getViewHeight:function(full){return full?Ext.dom.Element.getDocumentHeight():Ext.dom.Element.getViewportHeight()},getDocumentHeight:function(){return Math.max(isCSS1?doc.documentElement.scrollHeight:doc.body.scrollHeight,Ext.dom.Element.getViewportHeight())},getDocumentWidth:function(){return Math.max(isCSS1?doc.documentElement.scrollWidth:doc.body.scrollWidth,Ext.dom.Element.getViewportWidth())},getViewportHeight:function(){return Ext.isIE9m?Ext.isStrict?doc.documentElement.clientHeight:doc.body.clientHeight:self.innerHeight},getViewportWidth:function(){return Ext.isStrict||Ext.isOpera?Ext.isIE9m?doc.documentElement.clientWidth:self.innerWidth:doc.body.clientWidth},serializeForm:function(form){var element,name,type,options,hasValue,e,o,oLen,opt,fElements=form.elements||(document.forms[form]||Ext.getDom(form)).elements,hasSubmit=!1,encoder=encodeURIComponent,data="",eLen=fElements.length;for(e=0;e<eLen;e++)if(element=fElements[e],name=element.name,type=element.type,options=element.options,!element.disabled&&name)if(/select-(one|multiple)/i.test(type))for(oLen=options.length,o=0;o<oLen;o++)opt=options[o],opt.selected&&(hasValue=opt.hasAttribute?opt.hasAttribute("value"):opt.getAttributeNode("value").specified,data+=Ext.String.format("{0}={1}&",encoder(name),encoder(hasValue?opt.value:opt.text)));else/file|undefined|reset|button/i.test(type)||/radio|checkbox/i.test(type)&&!element.checked||"submit"==type&&hasSubmit||(data+=encoder(name)+"="+encoder(element.value)+"&",hasSubmit=/submit/i.test(type));return data.substr(0,data.length-1)}})}),Ext.define("Ext.dom.AbstractElement_insertion",{override:"Ext.dom.AbstractElement",appendChild:function(el,returnDom){var insertEl,eLen,e,oldUseDom,me=this;if(el.nodeType||el.dom||"string"==typeof el)return el=Ext.getDom(el),me.dom.appendChild(el),returnDom?el:Ext.get(el);if(el.length){for(insertEl=Ext.fly(document.createDocumentFragment(),"_internal"),eLen=el.length,Ext.DomHelper.useDom=!0,e=0;e<eLen;e++)insertEl.appendChild(el[e],returnDom);return Ext.DomHelper.useDom=oldUseDom,me.dom.appendChild(insertEl.dom),returnDom?insertEl.dom:insertEl}return me.createChild(el,null,returnDom)},appendTo:function(el){return Ext.getDom(el).appendChild(this.dom),this},insertBefore:function(el){return el=Ext.getDom(el),el.parentNode.insertBefore(this.dom,el),this},insertAfter:function(el){return el=Ext.getDom(el),el.parentNode.insertBefore(this.dom,el.nextSibling),this},insertFirst:function(el,returnDom){return el=el||{},el.nodeType||el.dom||"string"==typeof el?(el=Ext.getDom(el),this.dom.insertBefore(el,this.dom.firstChild),returnDom?el:Ext.get(el)):this.createChild(el,this.dom.firstChild,returnDom)},insertSibling:function(el,where,returnDom){var rt,insertEl,eLen,e,me=this,DomHelper=Ext.core.DomHelper,oldUseDom=DomHelper.useDom,isAfter="after"==(where||"before").toLowerCase();if(Ext.isArray(el)){for(insertEl=Ext.fly(document.createDocumentFragment(),"_internal"),eLen=el.length,DomHelper.useDom=!0,e=0;e<eLen;e++)rt=insertEl.appendChild(el[e],returnDom);return DomHelper.useDom=oldUseDom,me.dom.parentNode.insertBefore(insertEl.dom,isAfter?me.dom.nextSibling:me.dom),rt}return el=el||{},el.nodeType||el.dom?(rt=me.dom.parentNode.insertBefore(Ext.getDom(el),isAfter?me.dom.nextSibling:me.dom),returnDom||(rt=Ext.get(rt))):rt=isAfter&&!me.dom.nextSibling?DomHelper.append(me.dom.parentNode,el,!returnDom):DomHelper[isAfter?"insertAfter":"insertBefore"](me.dom,el,!returnDom),rt},replace:function(el){return el=Ext.get(el),this.insertBefore(el),el.remove(),this},replaceWith:function(el){var me=this;return el.nodeType||el.dom||"string"==typeof el?(el=Ext.get(el),me.dom.parentNode.insertBefore(el.dom,me.dom)):el=Ext.core.DomHelper.insertBefore(me.dom,el),delete Ext.cache[me.id],Ext.removeNode(me.dom),me.id=Ext.id(me.dom=el),Ext.dom.AbstractElement.addToCache(me.isFlyweight?new Ext.dom.AbstractElement(me.dom):me),me},createChild:function(config,insertBefore,returnDom){return config=config||{tag:"div"},insertBefore?Ext.core.DomHelper.insertBefore(insertBefore,config,returnDom!==!0):Ext.core.DomHelper.append(this.dom,config,returnDom!==!0)},wrap:function(config,returnDom,selector){var newEl=Ext.core.DomHelper.insertBefore(this.dom,config||{tag:"div"},!0),target=newEl;return selector&&(target=Ext.DomQuery.selectNode(selector,newEl.dom)),target.appendChild(this.dom),returnDom?newEl.dom:newEl},insertHtml:function(where,html,returnEl){var el=Ext.core.DomHelper.insertHtml(where,this.dom,html);return returnEl?Ext.get(el):el}}),Ext.define("Ext.dom.AbstractElement_style",{override:"Ext.dom.AbstractElement"},function(){var Element=this,wordsRe=/\w/g,spacesRe=/\s+/,transparentRe=/^(?:transparent|(?:rgba[(](?:\s*\d+\s*[,]){3}\s*0\s*[)]))$/i,hasClassList=Ext.supports.ClassList,PADDING="padding",MARGIN="margin",BORDER="border",LEFT_SUFFIX="-left",RIGHT_SUFFIX="-right",TOP_SUFFIX="-top",BOTTOM_SUFFIX="-bottom",WIDTH="-width",borders={l:BORDER+LEFT_SUFFIX+WIDTH,r:BORDER+RIGHT_SUFFIX+WIDTH,t:BORDER+TOP_SUFFIX+WIDTH,b:BORDER+BOTTOM_SUFFIX+WIDTH},paddings={l:PADDING+LEFT_SUFFIX,r:PADDING+RIGHT_SUFFIX,t:PADDING+TOP_SUFFIX,b:PADDING+BOTTOM_SUFFIX},margins={l:MARGIN+LEFT_SUFFIX,r:MARGIN+RIGHT_SUFFIX,t:MARGIN+TOP_SUFFIX,b:MARGIN+BOTTOM_SUFFIX},internalFly=new Element.Fly;Ext.override(Element,{styleHooks:{},addStyles:function(sides,styles){var i,side,totalSize=0,sidesArr=(sides||"").match(wordsRe),len=sidesArr.length,styleSides=[];if(1==len)totalSize=Math.abs(parseFloat(this.getStyle(styles[sidesArr[0]]))||0);else if(len){for(i=0;i<len;i++)side=sidesArr[i],styleSides.push(styles[side]);for(styleSides=this.getStyle(styleSides),i=0;i<len;i++)side=sidesArr[i],totalSize+=Math.abs(parseFloat(styleSides[styles[side]])||0)}return totalSize},addCls:function(){var addWithClassList=function(className){var classList,newCls,i,len,cls,me=this,dom=me.dom,trimRe=me.trimRe,origClassName=className;if("string"==typeof className&&(className=className.replace(trimRe,"").split(spacesRe)),dom&&className&&(len=className.length))if(dom.className)if(classList=dom.classList){for(i=0;i<len;++i)cls=className[i],cls&&(classList.contains(cls)||(newCls?newCls.push(cls):(newCls=dom.className.replace(trimRe,""),newCls=newCls?[newCls,cls]:[cls])));newCls&&(dom.className=newCls.join(" "))}else addWithoutClassList(origClassName);else dom.className=className.join(" ");return me},addWithoutClassList=function(className){var elClasses,me=this,dom=me.dom;return dom&&className&&className.length&&(elClasses=Ext.Element.mergeClsList(dom.className,className),elClasses.changed&&(dom.className=elClasses.join(" "))),me};return hasClassList?addWithClassList:addWithoutClassList}(),removeCls:function(className){var classList,len,elClasses,me=this,dom=me.dom;return"string"==typeof className&&(className=className.replace(me.trimRe,"").split(spacesRe)),dom&&dom.className&&className&&(len=className.length)&&(classList=dom.classList,1===len&&classList?className[0]&&classList.remove(className[0]):(elClasses=Ext.Element.removeCls(dom.className,className),elClasses.changed&&(dom.className=elClasses.join(" ")))),me},radioCls:function(className){var v,i,len,cn=this.dom.parentNode.childNodes;for(className=Ext.isArray(className)?className:[className],i=0,len=cn.length;i<len;i++)v=cn[i],v&&1==v.nodeType&&internalFly.attach(v).removeCls(className);return this.addCls(className)},toggleCls:function(){var toggleWithClassList=function(className){var classList,me=this,dom=me.dom;return dom&&(className=className.replace(me.trimRe,""),className&&(classList=dom.classList,classList?classList.toggle(className):toggleWithoutClassList(className))),me},toggleWithoutClassList=function(className){return this.hasCls(className)?this.removeCls(className):this.addCls(className)};return hasClassList?toggleWithClassList:toggleWithoutClassList}(),hasCls:function(){var hasClsWithClassList=function(className){var classList,dom=this.dom,out=!1;return dom&&className&&(classList=dom.classList,
out=classList?classList.contains(className):hasClsWithoutClassList(className)),out},hasClsWithoutClassList=function(className){var dom=this.dom;return!!dom&&(className&&(" "+dom.className+" ").indexOf(" "+className+" ")!==-1)};return hasClassList?hasClsWithClassList:hasClsWithoutClassList}(),replaceCls:function(oldClassName,newClassName){return this.removeCls(oldClassName).addCls(newClassName)},isStyle:function(style,val){return this.getStyle(style)==val},getStyle:function(property,inline){var domStyle,camel,values,hook,out,style,i,me=this,dom=me.dom,multiple="string"!=typeof property,hooks=me.styleHooks,prop=property,props=prop,len=1;if(multiple&&(values={},prop=props[0],i=0,!(len=props.length)))return values;if(!dom||dom.documentElement)return values||"";domStyle=dom.style,inline?style=domStyle:(style=dom.ownerDocument.defaultView.getComputedStyle(dom,null),style||(inline=!0,style=domStyle));do{if(hook=hooks[prop],hook||(hooks[prop]=hook={name:Element.normalize(prop)}),hook.get?out=hook.get(dom,me,inline,style):(camel=hook.name,out=style[camel]),!multiple)return out;values[prop]=out,prop=props[++i]}while(i<len);return values},getStyles:function(){var inline,props=Ext.Array.slice(arguments),len=props.length;return len&&"boolean"==typeof props[len-1]&&(inline=props.pop()),this.getStyle(props,inline)},isTransparent:function(prop){var value=this.getStyle(prop);return!!value&&transparentRe.test(value)},setStyle:function(prop,value){var hook,me=this,dom=me.dom,hooks=me.styleHooks,style=dom.style,name=prop;if("string"==typeof name)hook=hooks[name],hook||(hooks[name]=hook={name:Element.normalize(name)}),value=null==value?"":value,hook.set?hook.set(dom,value,me):style[hook.name]=value,hook.afterSet&&hook.afterSet(dom,value,me);else for(name in prop)prop.hasOwnProperty(name)&&(hook=hooks[name],hook||(hooks[name]=hook={name:Element.normalize(name)}),value=prop[name],value=null==value?"":value,hook.set?hook.set(dom,value,me):style[hook.name]=value,hook.afterSet&&hook.afterSet(dom,value,me));return me},getHeight:function(contentHeight){var dom=this.dom,height=contentHeight?dom.clientHeight-this.getPadding("tb"):dom.offsetHeight;return height>0?height:0},getWidth:function(contentWidth){var dom=this.dom,width=contentWidth?dom.clientWidth-this.getPadding("lr"):dom.offsetWidth;return width>0?width:0},setWidth:function(width){var me=this;return me.dom.style.width=Element.addUnits(width),me},setHeight:function(height){var me=this;return me.dom.style.height=Element.addUnits(height),me},getBorderWidth:function(side){return this.addStyles(side,borders)},getPadding:function(side){return this.addStyles(side,paddings)},margins:margins,applyStyles:function(styles){if(styles){var i,len,dom=this.dom;if("function"==typeof styles&&(styles=styles.call()),"string"==typeof styles)for(styles=Ext.util.Format.trim(styles).split(/\s*(?::|;)\s*/),i=0,len=styles.length;i<len;)dom.style[Element.normalize(styles[i++])]=styles[i++];else"object"==typeof styles&&this.setStyle(styles)}},setSize:function(width,height){var me=this,style=me.dom.style;return Ext.isObject(width)&&(height=width.height,width=width.width),style.width=Element.addUnits(width),style.height=Element.addUnits(height),me},getViewSize:function(){var doc=document,dom=this.dom;return dom==doc||dom==doc.body?{width:Element.getViewportWidth(),height:Element.getViewportHeight()}:{width:dom.clientWidth,height:dom.clientHeight}},getSize:function(contentSize){var dom=this.dom;return{width:Math.max(0,contentSize?dom.clientWidth-this.getPadding("lr"):dom.offsetWidth),height:Math.max(0,contentSize?dom.clientHeight-this.getPadding("tb"):dom.offsetHeight)}},repaint:function(){var dom=this.dom;return this.addCls(Ext.baseCSSPrefix+"repaint"),setTimeout(function(){internalFly.attach(dom).removeCls(Ext.baseCSSPrefix+"repaint")},1),this},getMargin:function(side){var key,o,margins,me=this,hash={t:"top",l:"left",r:"right",b:"bottom"};if(side)return me.addStyles(side,me.margins);margins=[];for(key in me.margins)me.margins.hasOwnProperty(key)&&margins.push(me.margins[key]);if(o=me.getStyle(margins),o&&"object"==typeof o)for(key in me.margins)me.margins.hasOwnProperty(key)&&(o[hash[key]]=parseFloat(o[me.margins[key]])||0);return o},mask:function(msg,msgCls,transparent){var mask,size,me=this,dom=me.dom,data=(me.$cache||me.getCache()).data,el=data.mask,cls="",prefix=Ext.baseCSSPrefix;me.addCls(prefix+"masked"),"static"==me.getStyle("position")&&me.addCls(prefix+"masked-relative"),el&&el.remove(),cls=msgCls&&"string"==typeof msgCls?" "+msgCls:" "+prefix+"mask-gray",mask=me.createChild({role:"presentation",cls:prefix+"mask"+(transparent!==!1?"":" "+prefix+"mask-gray"),html:msg?'<div class="'+(msgCls||prefix+"mask-message")+'" role="presentation">'+msg+"</div>":""}),size=me.getSize(),data.mask=mask,dom===document.body&&(size.height=window.innerHeight,me.orientationHandler&&Ext.EventManager.unOrientationChange(me.orientationHandler,me),me.orientationHandler=function(){size=me.getSize(),size.height=window.innerHeight,mask.setSize(size)},Ext.EventManager.onOrientationChange(me.orientationHandler,me)),mask.setSize(size),Ext.is.iPad&&Ext.repaint()},unmask:function(){var me=this,data=(me.$cache||me.getCache()).data,mask=data.mask,prefix=Ext.baseCSSPrefix;mask&&(mask.remove(),delete data.mask),me.removeCls([prefix+"masked",prefix+"masked-relative"]),me.dom===document.body&&(Ext.EventManager.unOrientationChange(me.orientationHandler,me),delete me.orientationHandler)}}),Ext.onReady(function(){function fixTransparent(dom,el,inline,style){var value=style[this.name]||"";return transparentRe.test(value)?"transparent":value}function fixRightMargin(dom,el,inline,style){var domStyle,display,result=style.marginRight;return"0px"!=result&&(domStyle=dom.style,display=domStyle.display,domStyle.display="inline-block",result=(inline?style:dom.ownerDocument.defaultView.getComputedStyle(dom,null)).marginRight,domStyle.display=display),result}function fixRightMarginAndInputFocus(dom,el,inline,style){var domStyle,cleaner,display,result=style.marginRight;return"0px"!=result&&(domStyle=dom.style,cleaner=Element.getRightMarginFixCleaner(dom),display=domStyle.display,domStyle.display="inline-block",result=(inline?style:dom.ownerDocument.defaultView.getComputedStyle(dom,"")).marginRight,domStyle.display=display,cleaner()),result}var styleHooks,colorStyles,i,name,camel,supports=Ext.supports;if(styleHooks=Element.prototype.styleHooks,supports.init&&supports.init(),supports.RightMargin||(styleHooks.marginRight=styleHooks["margin-right"]={name:"marginRight",get:supports.DisplayChangeInputSelectionBug||supports.DisplayChangeTextAreaSelectionBug?fixRightMarginAndInputFocus:fixRightMargin}),!supports.TransparentColor)for(colorStyles=["background-color","border-color","color","outline-color"],i=colorStyles.length;i--;)name=colorStyles[i],camel=Element.normalize(name),styleHooks[name]=styleHooks[camel]={name:camel,get:fixTransparent}})}),Ext.define("Ext.dom.AbstractElement_traversal",{override:"Ext.dom.AbstractElement",findParent:function(simpleSelector,limit,returnEl){var stopEl,target=this.dom,topmost=document.documentElement,depth=0;for(limit=limit||50,isNaN(limit)&&(stopEl=Ext.getDom(limit),limit=Number.MAX_VALUE);target&&1==target.nodeType&&depth<limit&&target!=topmost&&target!=stopEl;){if(Ext.DomQuery.is(target,simpleSelector))return returnEl?Ext.get(target):target;depth++,target=target.parentNode}return null},findParentNode:function(simpleSelector,limit,returnEl){var p=Ext.fly(this.dom.parentNode,"_internal");return p?p.findParent(simpleSelector,limit,returnEl):null},up:function(simpleSelector,limit,returnDom){return this.findParentNode(simpleSelector,limit,!returnDom)},select:function(selector,composite){return Ext.dom.Element.select(selector,this.dom,composite)},query:function(selector){return Ext.DomQuery.select(selector,this.dom)},down:function(selector,returnDom){var n=Ext.DomQuery.selectNode(selector,this.dom);return returnDom?n:Ext.get(n)},child:function(selector,returnDom){var node,id,me=this;return id=Ext.id(me.dom),id=Ext.escapeId(id),node=Ext.DomQuery.selectNode("#"+id+" > "+selector,me.dom),returnDom?node:Ext.get(node)},parent:function(selector,returnDom){return this.matchNode("parentNode","parentNode",selector,returnDom)},next:function(selector,returnDom){return this.matchNode("nextSibling","nextSibling",selector,returnDom)},prev:function(selector,returnDom){return this.matchNode("previousSibling","previousSibling",selector,returnDom)},first:function(selector,returnDom){return this.matchNode("nextSibling","firstChild",selector,returnDom)},last:function(selector,returnDom){return this.matchNode("previousSibling","lastChild",selector,returnDom)},matchNode:function(dir,start,selector,returnDom){if(!this.dom)return null;for(var n=this.dom[start];n;){if(1==n.nodeType&&(!selector||Ext.DomQuery.is(n,selector)))return returnDom?n:Ext.get(n);n=n[dir]}return null},isAncestor:function(element){return this.self.isAncestor.call(this.self,this.dom,element)}}),Ext.define("Ext.dom.AbstractElement",{trimRe:/^\s+|\s+$/g,whitespaceRe:/\s/,inheritableStatics:{trimRe:/^\s+|\s+$/g,whitespaceRe:/\s/,get:function(el){var cacheItem,docEl,extEl,dom,id,me=this,document=window.document,El=Ext.dom.Element;return el?(el.isFly&&(el=el.dom),"string"==typeof el?el==Ext.windowId?El.get(window):el==Ext.documentId?El.get(document):(cacheItem=Ext.cache[el],cacheItem&&cacheItem.skipGarbageCollection?extEl=cacheItem.el:(dom=document.getElementById(el))?extEl=cacheItem&&cacheItem.el?Ext.updateCacheEntry(cacheItem,dom).el:new El(dom,(!!cacheItem)):null):el.tagName?((id=el.id)||(id=Ext.id(el)),cacheItem=Ext.cache[id],extEl=cacheItem&&cacheItem.el?Ext.updateCacheEntry(cacheItem,el).el:new El(el,(!!cacheItem))):el instanceof me?(el!=me.docEl&&el!=me.winEl&&(id=el.id,cacheItem=Ext.cache[id],cacheItem&&Ext.updateCacheEntry(cacheItem,document.getElementById(id)||el.dom)),el):el.isComposite?el:Ext.isArray(el)?me.select(el):el===document?(me.docEl||(docEl=me.docEl=Ext.Object.chain(El.prototype),docEl.dom=document,docEl.el=docEl,docEl.id=Ext.id(document),me.addToCache(docEl)),me.docEl):el===window?(me.winEl||(me.winEl=Ext.Object.chain(El.prototype),me.winEl.dom=window,me.winEl.id=Ext.id(window),me.addToCache(me.winEl)),me.winEl):null):null},addToCache:function(el,id){return el&&Ext.addCacheEntry(id,el),el},addMethods:function(){this.override.apply(this,arguments)},mergeClsList:function(){var clsList,i,length,j,listLength,clsName,clsHash={},result=[],changed=!1,trimRe=this.trimRe,whitespaceRe=this.whitespaceRe;for(i=0,length=arguments.length;i<length;i++)if(clsList=arguments[i],Ext.isString(clsList)&&(clsList=clsList.replace(trimRe,"").split(whitespaceRe)),clsList)for(j=0,listLength=clsList.length;j<listLength;j++)clsName=clsList[j],clsHash[clsName]||(i&&(changed=!0),clsHash[clsName]=!0);for(clsName in clsHash)result.push(clsName);return result.changed=changed,result},removeCls:function(existingClsList,removeClsList){var i,length,clsName,clsHash={},result=[],changed=!1,whitespaceRe=this.whitespaceRe;if(existingClsList)for(Ext.isString(existingClsList)&&(existingClsList=existingClsList.replace(this.trimRe,"").split(whitespaceRe)),i=0,length=existingClsList.length;i<length;i++)clsHash[existingClsList[i]]=!0;if(removeClsList)for(Ext.isString(removeClsList)&&(removeClsList=removeClsList.split(whitespaceRe)),i=0,length=removeClsList.length;i<length;i++)clsName=removeClsList[i],clsHash[clsName]&&(changed=!0,delete clsHash[clsName]);for(clsName in clsHash)result.push(clsName);return result.changed=changed,result},VISIBILITY:1,DISPLAY:2,OFFSETS:3,ASCLASS:4},constructor:function(element,forceNew){var id,me=this,dom="string"==typeof element?document.getElementById(element):element;return me.el=me,dom?(id=dom.id,!forceNew&&id&&Ext.cache[id]?Ext.cache[id].el:(me.dom=dom,me.id=id||Ext.id(dom),void me.self.addToCache(me))):null},set:function(o,useSet){var attr,value,el=this.dom;for(attr in o)o.hasOwnProperty(attr)&&(value=o[attr],"style"==attr?this.applyStyles(value):"cls"==attr?el.className=value:useSet!==!1?void 0===value?el.removeAttribute(attr):el.setAttribute(attr,value):el[attr]=value);return this},defaultUnit:"px",is:function(simpleSelector){return Ext.DomQuery.is(this.dom,simpleSelector)},getValue:function(asNumber){var val=this.dom.value;return asNumber?parseInt(val,10):val},remove:function(){var me=this,dom=me.dom;me.isAnimate&&me.stopAnimation(),dom&&(Ext.removeNode(dom),delete me.dom)},contains:function(){var isXpc=function(el){var s;try{el=el.dom||el}catch(e){return!0}return s=HTMLElement.prototype.toString.call(el),"[xpconnect wrapped native prototype]"===s||"[object XULElement]"===s};return function(el){if(!el||Ext.isGecko3&&isXpc(el))return!1;var me=this,dom=el.dom||el;return dom===me.dom||Ext.dom.AbstractElement.isAncestor(me.dom,dom)}}(),getAttribute:function(name,ns){var dom=this.dom;return dom.getAttributeNS(ns,name)||dom.getAttribute(ns+":"+name)||dom.getAttribute(name)||dom[name]},update:function(html){return this.dom&&(this.dom.innerHTML=html),this},setHTML:function(html){return this.dom&&(this.dom.innerHTML=html),this},getHTML:function(){return this.dom?this.dom.innerHTML:""},hide:function(){return this.setVisible(!1),this},show:function(){return this.setVisible(!0),this},setVisible:function(visible,animate){var me=this,statics=me.self,mode=me.getVisibilityMode(),prefix=Ext.baseCSSPrefix;switch(mode){case statics.VISIBILITY:me.removeCls([prefix+"hidden-display",prefix+"hidden-offsets"]),me[visible?"removeCls":"addCls"](prefix+"hidden-visibility");break;case statics.DISPLAY:me.removeCls([prefix+"hidden-visibility",prefix+"hidden-offsets"]),me[visible?"removeCls":"addCls"](prefix+"hidden-display");break;case statics.OFFSETS:me.removeCls([prefix+"hidden-visibility",prefix+"hidden-display"]),me[visible?"removeCls":"addCls"](prefix+"hidden-offsets")}return me},getVisibilityMode:function(){var data=(this.$cache||this.getCache()).data,visMode=data.visibilityMode;return void 0===visMode&&(data.visibilityMode=visMode=this.self.DISPLAY),visMode},setVisibilityMode:function(mode){return(this.$cache||this.getCache()).data.visibilityMode=mode,this},getCache:function(){var me=this,id=me.dom.id||Ext.id(me.dom);return me.$cache=Ext.cache[id]||Ext.addCacheEntry(id,null,me.dom),me.$cache}},function(){var AbstractElement=this;Ext.getDetachedBody=function(){var detachedEl=AbstractElement.detachedBodyEl;return detachedEl||(detachedEl=document.createElement("div"),AbstractElement.detachedBodyEl=detachedEl=new AbstractElement.Fly(detachedEl),detachedEl.isDetachedBody=!0),detachedEl},Ext.getElementById=function(id){var detachedBodyEl,el=document.getElementById(id);return!el&&(detachedBodyEl=AbstractElement.detachedBodyEl)&&(el=detachedBodyEl.dom.querySelector("#"+Ext.escapeId(id))),el},Ext.get=function(el){return Ext.dom.Element.get(el)},this.addStatics({Fly:new Ext.Class({extend:AbstractElement,isFly:!0,constructor:function(dom){this.dom=dom,this.el=this},attach:function(dom){return this.dom=dom,this.$cache=dom&&dom.id?Ext.cache[dom.id]:null,this}}),_flyweights:{},fly:function(dom,named){var fly=null,_flyweights=AbstractElement._flyweights;return named=named||"_global",dom=Ext.getDom(dom),dom&&(fly=_flyweights[named]||(_flyweights[named]=new AbstractElement.Fly),fly.dom=dom,fly.$cache=dom.id?Ext.cache[dom.id]:null),fly}}),Ext.fly=function(){return AbstractElement.fly.apply(AbstractElement,arguments)},function(proto){proto.destroy=proto.remove,document.querySelector?proto.getById=function(id,asDom){var dom=document.getElementById(id)||this.dom.querySelector("#"+Ext.escapeId(id));return asDom?dom:dom?Ext.get(dom):null}:proto.getById=function(id,asDom){var dom=document.getElementById(id);return asDom?dom:dom?Ext.get(dom):null}}(this.prototype)}),Ext.define("Ext.dom.Helper",function(){var afterbegin="afterbegin",afterend="afterend",beforebegin="beforebegin",beforeend="beforeend",ts="<table>",te="</table>",tbs=ts+"<tbody>",tbe="</tbody>"+te,trs=tbs+"<tr>",tre="</tr>"+tbe,detachedDiv=document.createElement("div"),bbValues=["BeforeBegin","previousSibling"],aeValues=["AfterEnd","nextSibling"],bb_ae_PositionHash={beforebegin:bbValues,afterend:aeValues},fullPositionHash={beforebegin:bbValues,afterend:aeValues,afterbegin:["AfterBegin","firstChild"],beforeend:["BeforeEnd","lastChild"]};return{extend:Ext.dom.AbstractHelper,tableRe:/^(?:table|thead|tbody|tr|td)$/i,tableElRe:/td|tr|tbody|thead/i,useDom:!1,createDom:function(o,parentNode){var el,useSet,attr,val,cn,i,l,doc=document;if(Ext.isArray(o))for(el=doc.createDocumentFragment(),i=0,l=o.length;i<l;i++)this.createDom(o[i],el);else if("string"==typeof o)el=doc.createTextNode(o);else{el=doc.createElement(o.tag||"div"),useSet=!!el.setAttribute;for(attr in o)this.confRe.test(attr)||(val=o[attr],"cls"==attr?el.className=val:useSet?el.setAttribute(attr,val):el[attr]=val);Ext.DomHelper.applyStyles(el,o.style),(cn=o.children||o.cn)?this.createDom(cn,el):o.html&&(el.innerHTML=o.html)}return parentNode&&parentNode.appendChild(el),el},ieTable:function(depth,openingTags,htmlContent,closingTags){detachedDiv.innerHTML=[openingTags,htmlContent,closingTags].join("");for(var ns,i=-1,el=detachedDiv;++i<depth;)el=el.firstChild;if(ns=el.nextSibling)for(ns=el,el=document.createDocumentFragment();ns;)nx=ns.nextSibling,el.appendChild(ns),ns=nx;return el},insertIntoTable:function(tag,where,destinationEl,html){var node,before,bb=where==beforebegin,ab=where==afterbegin,be=where==beforeend,ae=where==afterend;return"td"==tag&&(ab||be)||!this.tableElRe.test(tag)&&(bb||ae)?null:(before=bb?destinationEl:ae?destinationEl.nextSibling:ab?destinationEl.firstChild:null,(bb||ae)&&(destinationEl=destinationEl.parentNode),node="td"==tag||"tr"==tag&&(be||ab)?this.ieTable(4,trs,html,tre):("tbody"==tag||"thead"==tag)&&(be||ab)||"tr"==tag&&(bb||ae)?this.ieTable(3,tbs,html,tbe):this.ieTable(2,ts,html,te),destinationEl.insertBefore(node,before),node)},createContextualFragment:function(html){var length,childNodes,fragment=document.createDocumentFragment();for(detachedDiv.innerHTML=html,childNodes=detachedDiv.childNodes,length=childNodes.length;length--;)fragment.appendChild(childNodes[0]);return fragment},applyStyles:function(el,styles){styles&&("function"==typeof styles&&(styles=styles.call()),"string"==typeof styles&&(styles=Ext.dom.Element.parseStyles(styles)),"object"==typeof styles&&Ext.fly(el,"_applyStyles").setStyle(styles))},createHtml:function(spec){return this.markup(spec)},doInsert:function(el,o,returnElement,pos,sibling,append){el=el.dom||Ext.getDom(el);var newNode;return this.useDom?(newNode=this.createDom(o,null),append?el.appendChild(newNode):("firstChild"==sibling?el:el.parentNode).insertBefore(newNode,el[sibling]||el)):newNode=this.insertHtml(pos,el,this.markup(o)),returnElement?Ext.get(newNode,!0):newNode},overwrite:function(el,html,returnElement){var newNode;if(el=Ext.getDom(el),html=this.markup(html),Ext.isIE&&this.tableRe.test(el.tagName)){for(;el.firstChild;)el.removeChild(el.firstChild);return html?(newNode=this.insertHtml("afterbegin",el,html),returnElement?Ext.get(newNode):newNode):null}return el.innerHTML=html,returnElement?Ext.get(el.firstChild):el.firstChild},insertHtml:function(where,el,html){var hashVal,range,rangeEl,setStart,frag;return where=where.toLowerCase(),el.insertAdjacentHTML?Ext.isIE&&this.tableRe.test(el.tagName)&&(frag=this.insertIntoTable(el.tagName.toLowerCase(),where,el,html))?frag:(hashVal=fullPositionHash[where])?(Ext.global.MSApp&&Ext.global.MSApp.execUnsafeLocalFunction?MSApp.execUnsafeLocalFunction(function(){el.insertAdjacentHTML(hashVal[0],html)}):el.insertAdjacentHTML(hashVal[0],html),el[hashVal[1]]):void 0:(3===el.nodeType&&(where="afterbegin"===where?"beforebegin":where,where="beforeend"===where?"afterend":where),range=Ext.supports.CreateContextualFragment?el.ownerDocument.createRange():void 0,setStart="setStart"+(this.endRe.test(where)?"After":"Before"),bb_ae_PositionHash[where]?(range?(range[setStart](el),frag=range.createContextualFragment(html)):frag=this.createContextualFragment(html),el.parentNode.insertBefore(frag,where==beforebegin?el:el.nextSibling),el[(where==beforebegin?"previous":"next")+"Sibling"]):(rangeEl=(where==afterbegin?"first":"last")+"Child",el.firstChild?(range?(range[setStart](el[rangeEl]),frag=range.createContextualFragment(html)):frag=this.createContextualFragment(html),where==afterbegin?el.insertBefore(frag,el.firstChild):el.appendChild(frag)):el.innerHTML=html,el[rangeEl]))},createTemplate:function(o){var html=this.markup(o);return new Ext.Template(html)}}}(),function(){Ext.ns("Ext.core"),Ext.DomHelper=Ext.core.DomHelper=new this}),Ext.define("Ext.Template",{inheritableStatics:{from:function(el,config){return el=Ext.getDom(el),new this(el.value||el.innerHTML,config||"")}},constructor:function(html){var value,me=this,args=arguments,buffer=[],i=0,length=args.length;if(me.initialConfig={},1===length&&Ext.isArray(html)&&(args=html,length=args.length),length>1)for(;i<length;i++)value=args[i],"object"==typeof value?(Ext.apply(me.initialConfig,value),Ext.apply(me,value)):buffer.push(value);else buffer.push(html);me.html=buffer.join(""),me.compiled&&me.compile()},isTemplate:!0,disableFormats:!1,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,apply:function(values){function fn(m,name,format,args){return format&&useFormat?(args=args?[values[name]].concat(Ext.functionFactory("return ["+args+"];")()):[values[name]],"this."==format.substr(0,5)?tpl[format.substr(5)].apply(tpl,args):fm[format].apply(fm,args)):void 0!==values[name]?values[name]:""}var ret,me=this,useFormat=me.disableFormats!==!0,fm=Ext.util.Format,tpl=me;return me.compiled?me.compiled(values).join(""):ret=me.html.replace(me.re,fn)},applyOut:function(values,out){var me=this;return me.compiled?out.push.apply(out,me.compiled(values)):out.push(me.apply(values)),out},applyTemplate:function(){return this.apply.apply(this,arguments)},set:function(html,compile){var me=this;return me.html=html,me.compiled=null,compile?me.compile():me},compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:function(){function fn(m,name,format,args){return format&&useFormat?(args=args?","+args:"",format="this."!=format.substr(0,5)?"fm."+format+"(":"this."+format.substr(5)+"("):(args="",format="(values['"+name+"'] == undefined ? '' : "),"',"+format+"values['"+name+"']"+args+") ,'"}var me=this,fm=Ext.util.Format,useFormat=me.disableFormats!==!0,body,bodyReturn;return bodyReturn=me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn),body="this.compiled = function(values){ return ['"+bodyReturn+"'];};",eval(body),me},insertFirst:function(el,values,returnElement){return this.doInsert("afterBegin",el,values,returnElement)},insertBefore:function(el,values,returnElement){return this.doInsert("beforeBegin",el,values,returnElement)},insertAfter:function(el,values,returnElement){return this.doInsert("afterEnd",el,values,returnElement)},append:function(el,values,returnElement){return this.doInsert("beforeEnd",el,values,returnElement)},doInsert:function(where,el,values,returnElement){var newNode=Ext.DomHelper.insertHtml(where,Ext.getDom(el),this.apply(values));return returnElement?Ext.get(newNode):newNode},overwrite:function(el,values,returnElement){var newNode=Ext.DomHelper.overwrite(Ext.getDom(el),this.apply(values));return returnElement?Ext.get(newNode):newNode}}),Ext.define("Ext.XTemplateParser",{constructor:function(config){Ext.apply(this,config)},doTpl:Ext.emptyFn,parse:function(str){var index,stack,s,m,t,prev,frame,subMatch,begin,end,actions,prop,me=this,len=str.length,aliases={elseif:"elif"},topRe=me.topRe,actionsRe=me.actionsRe;for(me.level=0,me.stack=stack=[],index=0;index<len;index=end){if(topRe.lastIndex=index,m=topRe.exec(str),!m){me.doText(str.substring(index,len));break}if(begin=m.index,end=topRe.lastIndex,index<begin&&me.doText(str.substring(index,begin)),m[1])end=str.indexOf("%}",begin+2),me.doEval(str.substring(begin+2,end)),end+=2;else if(m[2])end=str.indexOf("]}",begin+2),me.doExpr(str.substring(begin+2,end)),end+=2;else if(m[3])me.doTag(m[3]);else if(m[4]){for(actions=null;null!==(subMatch=actionsRe.exec(m[4]));)s=subMatch[2]||subMatch[3],s&&(s=Ext.String.htmlDecode(s),t=subMatch[1],t=aliases[t]||t,actions=actions||{},prev=actions[t],"string"==typeof prev?actions[t]=[prev,s]:prev?actions[t].push(s):actions[t]=s);actions?actions.if?(me.doIf(actions.if,actions),stack.push({type:"if"})):actions.switch?(me.doSwitch(actions.switch,actions),stack.push({type:"switch"})):actions.case?me.doCase(actions.case,actions):actions.elif?me.doElseIf(actions.elif,actions):actions.for?(++me.level,(prop=me.propRe.exec(m[4]))&&(actions.propName=prop[1]||prop[2]),me.doFor(actions.for,actions),stack.push({type:"for",actions:actions})):actions.foreach?(++me.level,(prop=me.propRe.exec(m[4]))&&(actions.propName=prop[1]||prop[2]),me.doForEach(actions.foreach,actions),stack.push({type:"foreach",actions:actions})):actions.exec&&(me.doExec(actions.exec,actions),stack.push({type:"exec",actions:actions})):me.elseRe.test(m[4])?me.doElse():me.defaultRe.test(m[4])?me.doDefault():(me.doTpl(),stack.push({type:"tpl"}))}else 5===m[0].length?stack.push({type:"tpl"}):(frame=stack.pop(),me.doEnd(frame.type,frame.actions),"for"!=frame.type&&"foreach"!=frame.type||--me.level)}},topRe:/(?:(\{\%)|(\{\[)|\{([^{}]+)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|foreach|exec|switch|case|eval|between)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/}),Ext.define("Ext.XTemplateCompiler",{extend:Ext.XTemplateParser,useEval:Ext.isGecko,useIndex:Ext.isIE8m,useFormat:!0,propNameRe:/^[\w\d\$]*$/,compile:function(tpl){var me=this,code=me.generate(tpl);return me.useEval?me.evalTpl(code):new Function("Ext",code)(Ext)},generate:function(tpl){var code,me=this,definitions="var fm=Ext.util.Format,ts=Object.prototype.toString;";return me.maxLevel=0,me.body=["var c0=values, a0="+me.createArrayTest(0)+", p0=parent, n0=xcount, i0=xindex, k0, v;\n"],me.definitions?"string"==typeof me.definitions?me.definitions=[me.definitions,definitions]:me.definitions.push(definitions):me.definitions=[definitions],me.switches=[],me.parse(tpl),me.definitions.push((me.useEval?"$=":"return")+" function ("+me.fnArgs+") {",me.body.join(""),"}"),code=me.definitions.join("\n"),me.definitions.length=me.body.length=me.switches.length=0,delete me.definitions,delete me.body,delete me.switches,code},doText:function(text){var me=this,out=me.body;text=text.replace(me.aposRe,"\\'").replace(me.newLineRe,"\\n"),me.useIndex?out.push("out[out.length]='",text,"'\n"):out.push("out.push('",text,"')\n")},doExpr:function(expr){var out=this.body;out.push("if ((v="+expr+") != null) out"),this.useIndex?out.push("[out.length]=v+''\n"):out.push(".push(v+'')\n")},doTag:function(tag){var expr=this.parseTag(tag);expr?this.doExpr(expr):this.doText("{"+tag+"}")},doElse:function(){this.body.push("} else {\n")},doEval:function(text){this.body.push(text,"\n")},doIf:function(action,actions){var me=this;"."===action?me.body.push("if (values) {\n"):me.propNameRe.test(action)?me.body.push("if (",me.parseTag(action),") {\n"):me.body.push("if (",me.addFn(action),me.callFn,") {\n"),actions.exec&&me.doExec(actions.exec)},doElseIf:function(action,actions){var me=this;"."===action?me.body.push("else if (values) {\n"):me.propNameRe.test(action)?me.body.push("} else if (",me.parseTag(action),") {\n"):me.body.push("} else if (",me.addFn(action),me.callFn,") {\n"),actions.exec&&me.doExec(actions.exec)},doSwitch:function(action){var me=this;"."===action?me.body.push("switch (values) {\n"):me.propNameRe.test(action)?me.body.push("switch (",me.parseTag(action),") {\n"):me.body.push("switch (",me.addFn(action),me.callFn,") {\n"),me.switches.push(0)},doCase:function(action){var match,i,me=this,cases=Ext.isArray(action)?action:[action],n=me.switches.length-1;for(me.switches[n]?me.body.push("break;\n"):me.switches[n]++,i=0,n=cases.length;i<n;++i)match=me.intRe.exec(cases[i]),cases[i]=match?match[1]:"'"+cases[i].replace(me.aposRe,"\\'")+"'";me.body.push("case ",cases.join(": case "),":\n")},doDefault:function(){var me=this,n=me.switches.length-1;me.switches[n]?me.body.push("break;\n"):me.switches[n]++,me.body.push("default:\n")},doEnd:function(type,actions){var me=this,L=me.level-1;"for"==type||"foreach"==type?(actions.exec&&me.doExec(actions.exec),me.body.push("}\n"),me.body.push("parent=p",L,";values=r",L+1,";xcount=n"+L+";xindex=i",L,"+1;xkey=k",L,";\n")):"if"!=type&&"switch"!=type||me.body.push("}\n")},doFor:function(action,actions){var s,parentAssignment,me=this,L=me.level,up=L-1;s="."===action?"values":me.propNameRe.test(action)?me.parseTag(action):me.addFn(action)+me.callFn,me.maxLevel<L&&(me.maxLevel=L,me.body.push("var ")),parentAssignment="."==action?"c"+L:"a"+up+"?c"+up+"[i"+up+"]:c"+up,me.body.push("i",L,"=0,n",L,"=0,c",L,"=",s,",a",L,"=",me.createArrayTest(L),",r",L,"=values,p",L,",k",L,";\n","p",L,"=parent=",parentAssignment,"\n","if (c",L,"){if(a",L,"){n",L,"=c",L,".length;}else if (c",L,".isMixedCollection){c",L,"=c",L,".items;n",L,"=c",L,".length;}else if(c",L,".isStore){c",L,"=c",L,".data.items;n",L,"=c",L,".length;}else{c",L,"=[c",L,"];n",L,"=1;}}\n","for (xcount=n",L,";i",L,"<n"+L+";++i",L,"){\n","values=c",L,"[i",L,"]"),actions.propName&&me.body.push(".",actions.propName),me.body.push("\n","xindex=i",L,"+1\n"),actions.between&&me.body.push('if(xindex>1){ out.push("',actions.between,'"); } \n')},doForEach:function(action,actions){var s,parentAssignment,me=this,L=me.level,up=L-1;s="."===action?"values":me.propNameRe.test(action)?me.parseTag(action):me.addFn(action)+me.callFn,me.maxLevel<L&&(me.maxLevel=L,me.body.push("var ")),parentAssignment="."==action?"c"+L:"a"+up+"?c"+up+"[i"+up+"]:c"+up,me.body.push("i",L,"=-1,n",L,"=0,c",L,"=",s,",a",L,"=",me.createArrayTest(L),",r",L,"=values,p",L,",k",L,";\n","p",L,"=parent=",parentAssignment,"\n","for(k",L," in c",L,"){\n","xindex=++i",L,"+1;\n","xkey=k",L,";\n","values=c",L,"[k",L,"];"),actions.propName&&me.body.push(".",actions.propName),actions.between&&me.body.push('if(xindex>1){ out.push("',actions.between,'"); } \n')},createArrayTest:"isArray"in Array?function(L){return"Array.isArray(c"+L+")"}:function(L){return"ts.call(c"+L+')==="[object Array]"'},doExec:function(action,actions){var me=this,name="f"+me.definitions.length;me.definitions.push("function "+name+"("+me.fnArgs+") {"," try { with(values) {","  "+action," }} catch(e) {","}","}"),me.body.push(name+me.callFn+"\n")},addFn:function(body){var me=this,name="f"+me.definitions.length;return"."===body?me.definitions.push("function "+name+"("+me.fnArgs+") {"," return values","}"):".."===body?me.definitions.push("function "+name+"("+me.fnArgs+") {"," return parent","}"):me.definitions.push("function "+name+"("+me.fnArgs+") {"," try { with(values) {","  return("+body+")"," }} catch(e) {","}","}"),name},parseTag:function(tag){var name,format,args,math,v,me=this,m=me.tagRe.exec(tag);return m?(name=m[1],format=m[2],args=m[3],math=m[4],"."==name?(me.validTypes||(me.definitions.push("var validTypes={string:1,number:1,boolean:1};"),me.validTypes=!0),v='validTypes[typeof values] || ts.call(values) === "[object Date]" ? values : ""'):v="#"==name?"xindex":"$"==name?"xkey":"parent."==name.substr(0,7)?name:isNaN(name)&&name.indexOf("-")==-1&&name.indexOf(".")!=-1?"values."+name:"values['"+name+"']",math&&(v="("+v+math+")"),format&&me.useFormat?(args=args?","+args:"","this."!=format.substr(0,5)?format="fm."+format+"(":format+="(",format+v+args+")"):v):null},evalTpl:function($){return eval($),$},newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/^([\w-\.\#\$]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?$/},function(){var proto=this.prototype;proto.fnArgs="out,values,parent,xindex,xcount,xkey",proto.callFn=".call(this,"+proto.fnArgs+")"}),Ext.define("Ext.XTemplate",{extend:Ext.Template,
emptyObj:{},apply:function(values,parent){return this.applyOut(values,[],parent).join("")},applyOut:function(values,out,parent){var compiler,me=this;me.fn||(compiler=new Ext.XTemplateCompiler({useFormat:me.disableFormats!==!0,definitions:me.definitions}),me.fn=compiler.compile(me.html));try{me.fn(out,values,parent||me.emptyObj,1,1)}catch(e){}return out},compile:function(){return this},statics:{getTpl:function(instance,name){var owner,tpl=instance[name];if(tpl&&!tpl.isTemplate){if(tpl=Ext.ClassManager.dynInstantiate("Ext.XTemplate",tpl),instance.hasOwnProperty(name))owner=instance;else for(owner=instance.self.prototype;owner&&!owner.hasOwnProperty(name);owner=owner.superclass);owner[name]=tpl,tpl.owner=owner}return tpl||null}}}),Ext.ns("Ext.core"),Ext.dom.Query=Ext.core.DomQuery=Ext.DomQuery=function(){function children(parent){for(var nextNode,n=parent.firstChild,nodeIndex=-1;n;)nextNode=n.nextSibling,3!=n.nodeType||nonSpace.test(n.nodeValue)?n.nodeIndex=++nodeIndex:parent.removeChild(n),n=nextNode;return this}function attrValue(n,attr){return n.tagName||"undefined"==typeof n.length||(n=n[0]),n?"for"==attr?n.htmlFor:"class"==attr||"className"==attr?n.className:n.getAttribute(attr)||n[attr]:null}function getNodes(ns,mode,tagName){var cs,i,ni,j,ci,cn,utag,n,cj,result=[],ri=-1;if(!ns)return result;if(tagName=tagName.replace("|",":")||"*","undefined"!=typeof ns.getElementsByTagName&&(ns=[ns]),mode){if("/"==mode||">"==mode)for(utag=tagName.toUpperCase(),i=0;ni=ns[i];i++)for(cn=ni.childNodes,j=0;cj=cn[j];j++)cj.nodeName!=utag&&cj.nodeName!=tagName&&"*"!=tagName||(result[++ri]=cj);else if("+"==mode)for(utag=tagName.toUpperCase(),i=0;n=ns[i];i++){for(;(n=n.nextSibling)&&1!=n.nodeType;);!n||n.nodeName!=utag&&n.nodeName!=tagName&&"*"!=tagName||(result[++ri]=n)}else if("~"==mode)for(utag=tagName.toUpperCase(),i=0;n=ns[i];i++)for(;n=n.nextSibling;)n.nodeName!=utag&&n.nodeName!=tagName&&"*"!=tagName||(result[++ri]=n)}else if(tagName=unescapeCssSelector(tagName),!supportsColonNsSeparator&&DQ.isXml(ns[0])&&tagName.indexOf(":")!==-1)for(i=0;ni=ns[i];i++)for(cs=ni.getElementsByTagName(tagName.split(":").pop()),j=0;ci=cs[j];j++)ci.tagName===tagName&&(result[++ri]=ci);else for(i=0;ni=ns[i];i++)for(cs=ni.getElementsByTagName(tagName),j=0;ci=cs[j];j++)result[++ri]=ci;return result}function concat(a,b){return a.push.apply(a,b),a}function byTag(cs,tagName){if((cs.tagName||cs===doc)&&(cs=[cs]),!tagName)return cs;var i,ci,result=[],ri=-1;for(tagName=tagName.toLowerCase(),i=0;ci=cs[i];i++)1==ci.nodeType&&ci.tagName.toLowerCase()==tagName&&(result[++ri]=ci);return result}function byId(cs,id){if(id=unescapeCssSelector(id),(cs.tagName||cs===doc)&&(cs=[cs]),!id)return cs;var i,ci,result=[],ri=-1;for(i=0;ci=cs[i];i++)if(ci&&ci.id==id)return result[++ri]=ci,result;return result}function byAttribute(cs,attr,value,op,custom){var a,xml,hasXml,i,ci,result=[],ri=-1,useGetStyle="{"==custom,fn=DQ.operators[op];for(value=unescapeCssSelector(value),i=0;ci=cs[i];i++)1===ci.nodeType&&(hasXml||(xml=DQ.isXml(ci),hasXml=!0),a=xml?ci.getAttribute(attr):useGetStyle?DQ.getStyle(ci,attr):"class"==attr||"className"==attr?ci.className:"for"==attr?ci.htmlFor:"href"==attr?ci.getAttribute("href",2):ci.getAttribute(attr),(fn&&fn(a,value)||!fn&&a)&&(result[++ri]=ci));return result}function byPseudo(cs,name,value){return value=unescapeCssSelector(value),DQ.pseudos[name](cs,value)}function nodupIEXml(cs){var r,i,len,c,d=++key;for(cs[0].setAttribute("_nodup",d),r=[cs[0]],i=1,len=cs.length;i<len;i++)c=cs[i],!c.getAttribute("_nodup")!=d&&(c.setAttribute("_nodup",d),r[r.length]=c);for(i=0,len=cs.length;i<len;i++)cs[i].removeAttribute("_nodup");return r}function nodup(cs){if(!cs)return[];var c,i,cj,d,j,len=cs.length,r=cs,ri=-1;if(!len||"undefined"!=typeof cs.nodeType||1==len)return cs;if(isIE&&"undefined"!=typeof cs[0].selectSingleNode)return nodupIEXml(cs);for(d=++key,cs[0]._nodup=d,i=1;c=cs[i];i++){if(c._nodup==d){for(r=[],j=0;j<i;j++)r[++ri]=cs[j];for(j=i+1;cj=cs[j];j++)cj._nodup!=d&&(cj._nodup=d,r[++ri]=cj);return r}c._nodup=d}return r}function quickDiffIEXml(c1,c2){var i,len,d=++key,r=[];for(i=0,len=c1.length;i<len;i++)c1[i].setAttribute("_qdiff",d);for(i=0,len=c2.length;i<len;i++)c2[i].getAttribute("_qdiff")!=d&&(r[r.length]=c2[i]);for(i=0,len=c1.length;i<len;i++)c1[i].removeAttribute("_qdiff");return r}function quickDiff(c1,c2){var i,len,len1=c1.length,d=++key,r=[];if(!len1)return c2;if(isIE&&"undefined"!=typeof c1[0].selectSingleNode)return quickDiffIEXml(c1,c2);for(i=0;i<len1;i++)c1[i]._qdiff=d;for(i=0,len=c2.length;i<len;i++)c2[i]._qdiff!=d&&(r[r.length]=c2[i]);return r}function quickId(ns,mode,root,id){if(ns==root){id=unescapeCssSelector(id);var d=root.ownerDocument||root;return d.getElementById(id)}return ns=getNodes(ns,mode,"*"),byId(ns,id)}var DQ,doc=document,cache={},simpleCache={},valueCache={},useClassList=!!doc.documentElement.classList,useElementPointer=!!doc.documentElement.firstElementChild,useChildrenCollection=function(){var d=doc.createElement("div");return d.innerHTML="<!-- -->text<!-- -->",d.children&&0===d.children.length}(),nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w\-\*\|\\]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,startIdRe=/^\s*#/,isIE=!!window.ActiveXObject,key=30803,longHex=/\\([0-9a-fA-F]{6})/g,shortHex=/\\([0-9a-fA-F]{1,6})\s{0,1}/g,nonHex=/\\([^0-9a-fA-F]{1})/g,escapes=/\\/g,num,hasEscapes,supportsColonNsSeparator=function(){var xmlDoc,xmlString='<r><a:b xmlns:a="n"></a:b></r>';return window.DOMParser?xmlDoc=(new DOMParser).parseFromString(xmlString,"application/xml"):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.loadXML(xmlString)),!!xmlDoc.getElementsByTagName("a:b").length}(),longHexToChar=function($0,$1){return String.fromCharCode(parseInt($1,16))},shortToLongHex=function($0,$1){for(;$1.length<6;)$1="0"+$1;return"\\"+$1},charToLongHex=function($0,$1){return num=$1.charCodeAt(0).toString(16),1===num.length&&(num="0"+num),"\\0000"+num},unescapeCssSelector=function(selector){return hasEscapes?selector.replace(longHex,longHexToChar):selector},setupEscapes=function(path){return hasEscapes=path.indexOf("\\")>-1,hasEscapes&&(path=path.replace(shortHex,shortToLongHex).replace(nonHex,charToLongHex).replace(escapes,"\\\\")),path};return eval("var batch = 30803, child, next, prev, byClassName;"),child=useChildrenCollection?function(parent,index){return parent.children[index]}:function(parent,index){for(var i=0,n=parent.firstChild;n;){if(1==n.nodeType&&++i==index)return n;n=n.nextSibling}return null},next=useElementPointer?function(n){return n.nextElementSibling}:function(n){for(;(n=n.nextSibling)&&1!=n.nodeType;);return n},prev=useElementPointer?function(n){return n.previousElementSibling}:function(n){for(;(n=n.previousSibling)&&1!=n.nodeType;);return n},byClassName=useClassList?function(nodeSet,cls){if(cls=unescapeCssSelector(cls),!cls)return nodeSet;var i,ci,classList,result=[],ri=-1;for(i=0;ci=nodeSet[i];i++)classList=ci.classList,classList?classList.contains(cls)&&(result[++ri]=ci):(" "+ci.className+" ").indexOf(cls)!==-1&&(result[++ri]=ci);return result}:function(nodeSet,cls){if(cls=unescapeCssSelector(cls),!cls)return nodeSet;var i,ci,result=[],ri=-1;for(i=0;ci=nodeSet[i];i++)(" "+ci.className+" ").indexOf(cls)!==-1&&(result[++ri]=ci);return result},DQ={getStyle:function(el,name){return Ext.fly(el,"_DomQuery").getStyle(name)},compile:function(path,type){type=type||"select";var fn=["var f = function(root) {\n var mode; ++batch; var n = root || document;\n"],lastPath,matchers=DQ.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe),tokenMatch,matched,j,t,m;for(path=setupEscapes(path),lmode&&lmode[1]&&(fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";',path=path.replace(lmode[1],""));"/"==path.substr(0,1);)path=path.substr(1);for(;path&&lastPath!=path;){for(lastPath=path,tokenMatch=path.match(tagTokenRe),"select"==type?tokenMatch?("#"==tokenMatch[1]?fn[fn.length]='n = quickId(n, mode, root, "'+tokenMatch[2]+'");':fn[fn.length]='n = getNodes(n, mode, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],"")):"@"!=path.substr(0,1)&&(fn[fn.length]='n = getNodes(n, mode, "*");'):tokenMatch&&("#"==tokenMatch[1]?fn[fn.length]='n = byId(n, "'+tokenMatch[2]+'");':fn[fn.length]='n = byTag(n, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],""));!(modeMatch=path.match(modeRe));){for(matched=!1,j=0;j<matchersLn;j++)if(t=matchers[j],m=path.match(t.re)){fn[fn.length]=t.select.replace(tplRe,function(x,i){return m[i]}),path=path.replace(m[0],""),matched=!0;break}matched||Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"compile",msg:'Error parsing selector. Parsing failed at "'+path+'"'})}modeMatch[1]&&(fn[fn.length]='mode="'+modeMatch[1].replace(trimRe,"")+'";',path=path.replace(modeMatch[1],""))}return fn[fn.length]="return nodup(n);\n}",eval(fn.join("")),f},jsSelect:function(path,root,type){root=root||doc,"string"==typeof root&&(root=doc.getElementById(root));var i,len,subPath,result,paths=path.split(","),results=[];for(i=0,len=paths.length;i<len;i++)subPath=paths[i].replace(trimRe,""),cache[subPath]?setupEscapes(subPath):(cache[subPath]=DQ.compile(subPath,type),cache[subPath]||Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"jsSelect",msg:subPath+" is not a valid selector"})),result=cache[subPath](root),result&&result!==doc&&(results=results.concat(result));return paths.length>1?nodup(results):results},isXml:function(el){var docEl=(el?el.ownerDocument||el:0).documentElement;return!!docEl&&"HTML"!==docEl.nodeName},select:doc.querySelectorAll?function(path,root,type,single){if(root=root||doc,!DQ.isXml(root))try{return root.parentNode&&9!==root.nodeType&&path.indexOf(",")===-1&&!startIdRe.test(path)&&(path="#"+Ext.escapeId(Ext.id(root))+" "+path,root=root.parentNode),single?[root.querySelector(path)]:Ext.Array.toArray(root.querySelectorAll(path))}catch(e){}return DQ.jsSelect.call(this,path,root,type)}:function(path,root,type){return DQ.jsSelect.call(this,path,root,type)},selectNode:function(path,root){return Ext.DomQuery.select(path,root,null,!0)[0]},selectValue:function(path,root,defaultValue){path=path.replace(trimRe,""),valueCache[path]?setupEscapes(path):valueCache[path]=DQ.compile(path,"select");var v,n=valueCache[path](root);return n=n[0]?n[0]:n,"function"==typeof n.normalize&&n.normalize(),v=n&&n.firstChild?n.firstChild.nodeValue:null,null===v||void 0===v||""===v?defaultValue:v},selectNumber:function(path,root,defaultValue){var v=DQ.selectValue(path,root,defaultValue||0);return parseFloat(v)},is:function(el,ss){"string"==typeof el&&(el=doc.getElementById(el));var isArray=Ext.isArray(el),result=DQ.filter(isArray?el:[el],ss);return isArray?result.length==el.length:result.length>0},filter:function(els,ss,nonMatches){ss=ss.replace(trimRe,""),simpleCache[ss]?setupEscapes(ss):simpleCache[ss]=DQ.compile(ss,"simple");var result=simpleCache[ss](els);return nonMatches?quickDiff(result,els):result},matchers:[{re:/^\.([\w\-\\]+)/,select:useClassList?'n = byClassName(n, "{1}");':'n = byClassName(n, " {1} ");'},{re:/^\:([\w\-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w\-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w\-\\]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w\-\.]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,v){return a==v},"!=":function(a,v){return a!=v},"^=":function(a,v){return a&&a.substr(0,v.length)==v},"$=":function(a,v){return a&&a.substr(a.length-v.length)==v},"*=":function(a,v){return a&&a.indexOf(v)!==-1},"%=":function(a,v){return a%v===0},"|=":function(a,v){return a&&(a==v||a.substr(0,v.length+1)==v+"-")},"~=":function(a,v){return a&&(" "+a+" ").indexOf(" "+v+" ")!=-1}},pseudos:{"first-child":function(c){var n,i,ci,r=[],ri=-1;for(i=0;ci=n=c[i];i++){for(;(n=n.previousSibling)&&1!=n.nodeType;);n||(r[++ri]=ci)}return r},"last-child":function(c){var n,i,ci,r=[],ri=-1;for(i=0;ci=n=c[i];i++){for(;(n=n.nextSibling)&&1!=n.nodeType;);n||(r[++ri]=ci)}return r},"nth-child":function(c,a){var i,n,j,cn,pn,r=[],ri=-1,m=nthRe.exec("even"==a&&"2n"||"odd"==a&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0;for(i=0;n=c[i];i++){if(pn=n.parentNode,batch!=pn._batch){for(j=0,cn=pn.firstChild;cn;cn=cn.nextSibling)1==cn.nodeType&&(cn.nodeIndex=++j);pn._batch=batch}1==f?0!==l&&n.nodeIndex!=l||(r[++ri]=n):(n.nodeIndex+l)%f===0&&(r[++ri]=n)}return r},"only-child":function(c){var i,ci,r=[],ri=-1;for(i=0;ci=c[i];i++)prev(ci)||next(ci)||(r[++ri]=ci);return r},empty:function(c){var i,ci,cns,j,cn,empty,r=[],ri=-1;for(i=0;ci=c[i];i++){for(cns=ci.childNodes,j=0,empty=!0;cn=cns[j];)if(++j,1==cn.nodeType||3==cn.nodeType){empty=!1;break}empty&&(r[++ri]=ci)}return r},contains:function(c,v){var i,ci,r=[],ri=-1;for(i=0;ci=c[i];i++)(ci.textContent||ci.innerText||ci.text||"").indexOf(v)!=-1&&(r[++ri]=ci);return r},nodeValue:function(c,v){var i,ci,r=[],ri=-1;for(i=0;ci=c[i];i++)ci.firstChild&&ci.firstChild.nodeValue==v&&(r[++ri]=ci);return r},checked:function(c){var i,ci,r=[],ri=-1;for(i=0;ci=c[i];i++)ci.checked===!0&&(r[++ri]=ci);return r},not:function(c,ss){return DQ.filter(c,ss,!0)},any:function(c,selectors){var s,i,ci,j,ss=selectors.split("|"),r=[],ri=-1;for(i=0;ci=c[i];i++)for(j=0;s=ss[j];j++)if(DQ.is(ci,s)){r[++ri]=ci;break}return r},odd:function(c){return this["nth-child"](c,"odd")},even:function(c){return this["nth-child"](c,"even")},nth:function(c,a){return c[a-1]||[]},first:function(c){return c[0]||[]},last:function(c){return c[c.length-1]||[]},has:function(c,ss){var i,ci,s=DQ.select,r=[],ri=-1;for(i=0;ci=c[i];i++)s(ss,ci).length>0&&(r[++ri]=ci);return r},next:function(c,ss){var i,ci,n,is=DQ.is,r=[],ri=-1;for(i=0;ci=c[i];i++)n=next(ci),n&&is(n,ss)&&(r[++ri]=ci);return r},prev:function(c,ss){var i,ci,n,is=DQ.is,r=[],ri=-1;for(i=0;ci=c[i];i++)n=prev(ci),n&&is(n,ss)&&(r[++ri]=ci);return r},focusable:function(candidates){for(var c,len=candidates.length,results=[],i=0;i<len;i++)c=candidates[i],Ext.fly(c,"_DomQuery").isFocusable()&&results.push(c);return results},visible:function(candidates,deep){for(var c,len=candidates.length,results=[],i=0;i<len;i++)c=candidates[i],Ext.fly(c,"_DomQuery").isVisible(deep)&&results.push(c);return results}}}}(),Ext.query=Ext.DomQuery.select,Ext.define("Ext.dom.Element_anim",{override:"Ext.dom.Element",animate:function(config){var listeners,anim,end,me=this,animId=me.dom.id||Ext.id(me.dom);return Ext.fx.Manager.hasFxBlock(animId)||(config.listeners&&(listeners=config.listeners,delete config.listeners),config.internalListeners&&(config.listeners=config.internalListeners,delete config.internalListeners),end=config.autoEnd,delete config.autoEnd,anim=new Ext.fx.Anim(me.anim(config)),listeners&&anim.on(listeners),Ext.fx.Manager.queueFx(anim),end&&anim.jumpToEnd()),me},anim:function(config){if(!Ext.isObject(config))return!!config&&{};var animConfig,me=this,duration=config.duration||Ext.fx.Anim.prototype.duration,easing=config.easing||"ease";return config.stopAnimation&&me.stopAnimation(),Ext.applyIf(config,Ext.fx.Manager.getFxDefaults(me.id)),Ext.fx.Manager.setFxDefaults(me.id,{delay:0}),animConfig={target:me.dom,remove:config.remove,alternate:config.alternate||!1,duration:duration,easing:easing,callback:config.callback,listeners:config.listeners,iterations:config.iterations||1,scope:config.scope,block:config.block,concurrent:config.concurrent,delay:config.delay||0,paused:!0,keyframes:config.keyframes,from:config.from||{},to:Ext.apply({},config)},Ext.apply(animConfig.to,config.to),delete animConfig.to.to,delete animConfig.to.from,delete animConfig.to.remove,delete animConfig.to.alternate,delete animConfig.to.keyframes,delete animConfig.to.iterations,delete animConfig.to.listeners,delete animConfig.to.target,delete animConfig.to.paused,delete animConfig.to.callback,delete animConfig.to.scope,delete animConfig.to.duration,delete animConfig.to.easing,delete animConfig.to.concurrent,delete animConfig.to.block,delete animConfig.to.stopAnimation,delete animConfig.to.delay,animConfig},slideIn:function(anchor,obj,slideOut){var beforeAnim,wrapAnim,restoreScroll,wrapDomParentNode,me=this,dom=me.dom,elStyle=dom.style;return anchor=anchor||"t",obj=obj||{},beforeAnim=function(){var box,originalStyles,anim,wrap,animScope=this,listeners=obj.listeners,el=Ext.fly(dom,"_anim");switch(slideOut||el.fixDisplay(),box=el.getBox(),"t"!=anchor&&"b"!=anchor||0!==box.height?"l"!=anchor&&"r"!=anchor||0!==box.width||(box.width=dom.scrollWidth):box.height=dom.scrollHeight,originalStyles=el.getStyles("width","height","left","right","top","bottom","position","z-index",!0),el.setSize(box.width,box.height),obj.preserveScroll&&(restoreScroll=el.cacheScrollValues()),wrap=el.wrap({role:"presentation",id:Ext.id()+"-anim-wrap-for-"+el.dom.id,style:{visibility:slideOut?"visible":"hidden"}}),wrapDomParentNode=wrap.dom.parentNode,wrap.setPositioning(el.getPositioning(!0)),wrap.isStyle("position","static")&&wrap.position("relative"),el.clearPositioning("auto"),wrap.clip(),restoreScroll&&restoreScroll(),el.setStyle({visibility:"",position:"absolute"}),slideOut&&wrap.setSize(box.width,box.height),anchor){case"t":anim={from:{width:box.width+"px",height:"0px"},to:{width:box.width+"px",height:box.height+"px"}},elStyle.bottom="0px";break;case"l":anim={from:{width:"0px",height:box.height+"px"},to:{width:box.width+"px",height:box.height+"px"}},me.anchorAnimX(anchor);break;case"r":anim={from:{x:box.x+box.width,width:"0px",height:box.height+"px"},to:{x:box.x,width:box.width+"px",height:box.height+"px"}},me.anchorAnimX(anchor);break;case"b":anim={from:{y:box.y+box.height,width:box.width+"px",height:"0px"},to:{y:box.y,width:box.width+"px",height:box.height+"px"}};break;case"tl":anim={from:{x:box.x,y:box.y,width:"0px",height:"0px"},to:{width:box.width+"px",height:box.height+"px"}},elStyle.bottom="0px",me.anchorAnimX("l");break;case"bl":anim={from:{y:box.y+box.height,width:"0px",height:"0px"},to:{y:box.y,width:box.width+"px",height:box.height+"px"}},me.anchorAnimX("l");break;case"br":anim={from:{x:box.x+box.width,y:box.y+box.height,width:"0px",height:"0px"},to:{x:box.x,y:box.y,width:box.width+"px",height:box.height+"px"}},me.anchorAnimX("r");break;case"tr":anim={from:{x:box.x+box.width,width:"0px",height:"0px"},to:{x:box.x,width:box.width+"px",height:box.height+"px"}},elStyle.bottom="0px",me.anchorAnimX("r")}wrap.show(),wrapAnim=Ext.apply({},obj),delete wrapAnim.listeners,wrapAnim=new Ext.fx.Anim(Ext.applyIf(wrapAnim,{target:wrap,duration:500,easing:"ease-out",from:slideOut?anim.to:anim.from,to:slideOut?anim.from:anim.to})),wrapAnim.on("afteranimate",function(){var el=Ext.fly(dom,"_anim");el.setStyle(originalStyles),slideOut&&(obj.useDisplay?el.setDisplayed(!1):el.hide()),wrap.dom&&(wrap.dom.parentNode?wrap.dom.parentNode.insertBefore(el.dom,wrap.dom):wrapDomParentNode.appendChild(el.dom),wrap.remove()),restoreScroll&&restoreScroll(),animScope.end()}),listeners&&wrapAnim.on(listeners)},me.animate({duration:obj.duration?2*Math.max(obj.duration,500):1e3,listeners:{beforeanimate:beforeAnim}}),me},slideOut:function(anchor,o){return this.slideIn(anchor,o,!0)},puff:function(obj){var beforeAnim,me=this,dom=me.dom,box=me.getBox(),originalStyles=me.getStyles("width","height","left","right","top","bottom","position","z-index","font-size","opacity",!0);return obj=Ext.applyIf(obj||{},{easing:"ease-out",duration:500,useDisplay:!1}),beforeAnim=function(){var el=Ext.fly(dom,"_anim");el.clearOpacity(),el.show(),this.to={width:2*box.width,height:2*box.height,x:box.x-box.width/2,y:box.y-box.height/2,opacity:0,fontSize:"200%"},this.on("afteranimate",function(){var el=Ext.fly(dom,"_anim");el&&(obj.useDisplay?el.setDisplayed(!1):el.hide(),el.setStyle(originalStyles),Ext.callback(obj.callback,obj.scope))})},me.animate({duration:obj.duration,easing:obj.easing,listeners:{beforeanimate:{fn:beforeAnim}}}),me},switchOff:function(obj){var beforeAnim,me=this,dom=me.dom;return obj=Ext.applyIf(obj||{},{easing:"ease-in",duration:500,remove:!1,useDisplay:!1}),beforeAnim=function(){var keyframe,position,el=Ext.fly(dom,"_anim"),animScope=this,size=el.getSize(),xy=el.getXY();el.clearOpacity(),el.clip(),position=el.getPositioning(),keyframe=new Ext.fx.Animator({target:dom,duration:obj.duration,easing:obj.easing,keyframes:{33:{opacity:.3},66:{height:1,y:xy[1]+size.height/2},100:{width:1,x:xy[0]+size.width/2}}}),keyframe.on("afteranimate",function(){var el=Ext.fly(dom,"_anim");obj.useDisplay?el.setDisplayed(!1):el.hide(),el.clearOpacity(),el.setPositioning(position),el.setSize(size),animScope.end()})},me.animate({duration:2*Math.max(obj.duration,500),listeners:{beforeanimate:{fn:beforeAnim}},callback:obj.callback,scope:obj.scope}),me},frame:function(color,count,obj){var beforeAnim,me=this,dom=me.dom;return color=color||"#C3DAF9",count=count||1,obj=obj||{},beforeAnim=function(){var box,proxy,proxyAnim,el=Ext.fly(dom,"_anim"),animScope=this;el.show(),box=el.getBox(),proxy=Ext.getBody().createChild({role:"presentation",id:el.dom.id+"-anim-proxy",style:{position:"absolute","pointer-events":"none","z-index":35e3,border:"0px solid "+color}}),proxyAnim=new Ext.fx.Anim({target:proxy,duration:obj.duration||1e3,iterations:count,from:{top:box.y,left:box.x,borderWidth:0,opacity:1,height:box.height,width:box.width},to:{top:box.y-20,left:box.x-20,borderWidth:10,opacity:0,height:box.height+40,width:box.width+40}}),proxyAnim.on("afteranimate",function(){proxy.remove(),animScope.end()})},me.animate({duration:2*Math.max(obj.duration,500)||2e3,listeners:{beforeanimate:{fn:beforeAnim}},callback:obj.callback,scope:obj.scope}),me},ghost:function(anchor,obj){var beforeAnim,me=this,dom=me.dom;return anchor=anchor||"b",beforeAnim=function(){var el=Ext.fly(dom,"_anim"),width=el.getWidth(),height=el.getHeight(),xy=el.getXY(),position=el.getPositioning(),to={opacity:0};switch(anchor){case"t":to.y=xy[1]-height;break;case"l":to.x=xy[0]-width;break;case"r":to.x=xy[0]+width;break;case"b":to.y=xy[1]+height;break;case"tl":to.x=xy[0]-width,to.y=xy[1]-height;break;case"bl":to.x=xy[0]-width,to.y=xy[1]+height;break;case"br":to.x=xy[0]+width,to.y=xy[1]+height;break;case"tr":to.x=xy[0]+width,to.y=xy[1]-height}this.to=to,this.on("afteranimate",function(){var el=Ext.fly(dom,"_anim");el&&(el.hide(),el.clearOpacity(),el.setPositioning(position))})},me.animate(Ext.applyIf(obj||{},{duration:500,easing:"ease-out",listeners:{beforeanimate:beforeAnim}})),me},highlight:function(color,o){var restore,to,attr,lns,event,fn,me=this,dom=me.dom,from={};return dom.tagName.match(me.tableTagRe)?me.select("div").highlight(color,o):(o=o||{},lns=o.listeners||{},attr=o.attr||"backgroundColor",from[attr]=color||"ffff9c",o.to?to=o.to:(to={},to[attr]=o.endColor||me.getColor(attr,"ffffff","")),o.listeners=Ext.apply(Ext.apply({},lns),{beforeanimate:function(){restore=dom.style[attr];var el=Ext.fly(dom,"_anim");if(el.clearOpacity(),el.show(),event=lns.beforeanimate)return fn=event.fn||event,fn.apply(event.scope||lns.scope||window,arguments)},afteranimate:function(){dom&&(dom.style[attr]=restore),event=lns.afteranimate,event&&(fn=event.fn||event,fn.apply(event.scope||lns.scope||window,arguments))}}),me.animate(Ext.apply({},o,{duration:1e3,easing:"ease-in",from:from,to:to})),me)},pause:function(ms){var me=this;return Ext.fx.Manager.setFxDefaults(me.id,{delay:ms}),me},fadeIn:function(o){var me=this,dom=me.dom;return me.animate(Ext.apply({},o,{opacity:1,internalListeners:{beforeanimate:function(anim){var el=Ext.fly(dom,"_anim");el.isStyle("display","none")?el.setDisplayed(""):el.show()}}})),this},fadeOut:function(o){var me=this,dom=me.dom;return o=Ext.apply({opacity:0,internalListeners:{afteranimate:function(anim){if(dom&&0===anim.to.opacity){var el=Ext.fly(dom,"_anim");o.useDisplay?el.setDisplayed(!1):el.hide()}}}},o),me.animate(o),me},scale:function(w,h,o){return this.animate(Ext.apply({},o,{width:w,height:h})),this},shift:function(config){return this.animate(config),this},anchorAnimX:function(anchor){var xName="l"===anchor?"right":"left";this.dom.style[xName]="0px"}}),Ext.define("Ext.dom.Element_dd",{override:"Ext.dom.Element",initDD:function(group,config,overrides){var dd=new Ext.dd.DD(Ext.id(this.dom),group,config);return Ext.apply(dd,overrides)},initDDProxy:function(group,config,overrides){var dd=new Ext.dd.DDProxy(Ext.id(this.dom),group,config);return Ext.apply(dd,overrides)},initDDTarget:function(group,config,overrides){var dd=new Ext.dd.DDTarget(Ext.id(this.dom),group,config);return Ext.apply(dd,overrides)}}),Ext.define("Ext.dom.Element_fx",{override:"Ext.dom.Element"},function(){var Element=Ext.dom.Element,VISIBILITY="visibility",DISPLAY="display",NONE="none",HIDDEN="hidden",OFFSETS="offsets",ASCLASS="asclass",NOSIZE="nosize",ORIGINALDISPLAY="originalDisplay",VISMODE="visibilityMode",ISVISIBLE="isVisible",OFFSETCLASS=Ext.baseCSSPrefix+"hide-offsets",getDisplay=function(el){var data=(el.$cache||el.getCache()).data,display=data[ORIGINALDISPLAY];return void 0===display&&(data[ORIGINALDISPLAY]=display=""),display},getVisMode=function(el){var data=(el.$cache||el.getCache()).data,visMode=data[VISMODE];return void 0===visMode&&(data[VISMODE]=visMode=Element.VISIBILITY),visMode};Element.override({originalDisplay:"",visibilityMode:1,setVisible:function(visible,animate){var me=this,dom=me.dom,visMode=getVisMode(me);if("string"==typeof animate){switch(animate){case DISPLAY:visMode=Element.DISPLAY;break;case VISIBILITY:visMode=Element.VISIBILITY;break;case OFFSETS:visMode=Element.OFFSETS;break;case NOSIZE:case ASCLASS:visMode=Element.ASCLASS}me.setVisibilityMode(visMode),animate=!1}if(animate&&me.anim)visible&&(me.setOpacity(.01),me.setVisible(!0)),Ext.isObject(animate)||(animate={duration:350,easing:"ease-in"}),me.animate(Ext.applyIf({callback:function(){visible||Ext.fly(dom,"_internal").setVisible(!1).setOpacity(1)},to:{opacity:visible?1:0}},animate));else{if(visMode==Element.DISPLAY)return me.setDisplayed(visible);visMode==Element.OFFSETS?me[visible?"removeCls":"addCls"](OFFSETCLASS):visMode==Element.VISIBILITY?(me.fixDisplay(),dom.style.visibility=visible?"":HIDDEN):visMode==Element.ASCLASS&&me[visible?"removeCls":"addCls"](me.visibilityCls||Element.visibilityCls)}return(me.$cache||me.getCache()).data[ISVISIBLE]=visible,me},hasMetrics:function(){var visMode=getVisMode(this);return this.isVisible()||visMode==Element.OFFSETS||visMode==Element.VISIBILITY},toggle:function(animate){var me=this;return me.setVisible(!me.isVisible(),me.anim(animate)),me},setDisplayed:function(value){return"boolean"==typeof value&&(value=value?getDisplay(this):NONE),this.setStyle(DISPLAY,value),this},fixDisplay:function(){var me=this;me.isStyle(DISPLAY,NONE)&&(me.setStyle(VISIBILITY,HIDDEN),me.setStyle(DISPLAY,getDisplay(me)),me.isStyle(DISPLAY,NONE)&&me.setStyle(DISPLAY,"block"))},hide:function(animate){return"string"==typeof animate?(this.setVisible(!1,animate),this):(this.setVisible(!1,this.anim(animate)),this)},show:function(animate){return"string"==typeof animate?(this.setVisible(!0,animate),this):(this.setVisible(!0,this.anim(animate)),this)}})}),Ext.define("Ext.dom.Element_position",{override:"Ext.dom.Element"},function(){var flyInstance,Element=this,LEFT="left",RIGHT="right",TOP="top",BOTTOM="bottom",POSITION="position",STATIC="static",RELATIVE="relative",ZINDEX="z-index",BODY="BODY",PADDING="padding",BORDER="border",SLEFT="-left",SRIGHT="-right",STOP="-top",SBOTTOM="-bottom",SWIDTH="-width",borders={l:BORDER+SLEFT+SWIDTH,r:BORDER+SRIGHT+SWIDTH,t:BORDER+STOP+SWIDTH,b:BORDER+SBOTTOM+SWIDTH},paddings={l:PADDING+SLEFT,r:PADDING+SRIGHT,t:PADDING+STOP,b:PADDING+SBOTTOM},paddingsTLRB=[paddings.l,paddings.r,paddings.t,paddings.b],bordersTLRB=[borders.l,borders.r,borders.t,borders.b],round=Math.round,doc=document,fly=function(el){return flyInstance||(flyInstance=new Ext.Element.Fly),flyInstance.attach(el),flyInstance};Element.override({pxRe:/^\d+(?:\.\d*)?px$/i,inheritableStatics:{getX:function(el){return Element.getXY(el)[0]},getXY:function(el){var box,scroll,bd=doc.body,docEl=doc.documentElement,leftBorder=0,topBorder=0,ret=[0,0];if(el=Ext.getDom(el),el!=doc&&el!=bd){if(Ext.isIE)try{box=el.getBoundingClientRect(),topBorder=docEl.clientTop||bd.clientTop,leftBorder=docEl.clientLeft||bd.clientLeft}catch(ex){box={left:0,top:0}}else box=el.getBoundingClientRect();scroll=fly(doc).getScroll(),ret=[round(box.left+scroll.left-leftBorder),round(box.top+scroll.top-topBorder)]}return ret},getY:function(el){return Element.getXY(el)[1]},setX:function(el,x){Element.setXY(el,[x,!1])},setXY:function(el,xy){(el=Ext.fly(el,"_setXY")).position();var pos,pts=el.translatePoints(xy),style=el.dom.style;style.right="auto";for(pos in pts)isNaN(pts[pos])||(style[pos]=pts[pos]+"px")},setY:function(el,y){Element.setXY(el,[!1,y])}},center:function(centerIn){return this.alignTo(centerIn||doc,"c-c")},clearPositioning:function(value){return value=value||"",this.setStyle({left:value,right:value,top:value,bottom:value,"z-index":"",position:STATIC})},getAnchorToXY:function(el,anchor,local,mySize){return el.getAnchorXY(anchor,local,mySize)},getBottom:function(local){return(local?this.getLocalY():this.getY())+this.getHeight()},getBorderPadding:function(){var paddingWidth=this.getStyle(paddingsTLRB),bordersWidth=this.getStyle(bordersTLRB);return{beforeX:(parseFloat(bordersWidth[borders.l])||0)+(parseFloat(paddingWidth[paddings.l])||0),afterX:(parseFloat(bordersWidth[borders.r])||0)+(parseFloat(paddingWidth[paddings.r])||0),beforeY:(parseFloat(bordersWidth[borders.t])||0)+(parseFloat(paddingWidth[paddings.t])||0),afterY:(parseFloat(bordersWidth[borders.b])||0)+(parseFloat(paddingWidth[paddings.b])||0)}},getCenterXY:function(){return this.getAlignToXY(doc,"c-c")},getLeft:function(local){return local?this.getLocalX():this.getX()},getLocalX:function(){var me=this,offsetParent=me.dom.offsetParent,x=me.getStyle("left");return x&&"auto"!==x?me.pxRe.test(x)?x=parseFloat(x):(x=me.getX(),offsetParent&&(x-=Element.getX(offsetParent))):x=0,x},getLocalXY:function(){var me=this,offsetParent=me.dom.offsetParent,style=me.getStyle(["left","top"]),x=style.left,y=style.top;return x&&"auto"!==x?me.pxRe.test(x)?x=parseFloat(x):(x=me.getX(),offsetParent&&(x-=Element.getX(offsetParent))):x=0,y&&"auto"!==y?me.pxRe.test(y)?y=parseFloat(y):(y=me.getY(),offsetParent&&(y-=Element.getY(offsetParent))):y=0,[x,y]},getLocalY:function(){var me=this,offsetParent=me.dom.offsetParent,y=me.getStyle("top");return y&&"auto"!==y?me.pxRe.test(y)?y=parseFloat(y):(y=me.getY(),offsetParent&&(y-=Element.getY(offsetParent))):y=0,y},getPageBox:function(getRegion){var me=this,dom=me.dom,isDoc=dom.nodeName==BODY,w=isDoc?Ext.Element.getViewWidth():dom.offsetWidth,h=isDoc?Ext.Element.getViewHeight():dom.offsetHeight,xy=me.getXY(),t=xy[1],r=xy[0]+w,b=xy[1]+h,l=xy[0];return getRegion?new Ext.util.Region(t,r,b,l):{left:l,top:t,width:w,height:h,right:r,bottom:b}},getPositioning:function(autoPx){var styles=this.getStyle(["left","top","position","z-index"]),dom=this.dom;return autoPx&&("auto"===styles.left&&(styles.left=dom.offsetLeft+"px"),"auto"===styles.top&&(styles.top=dom.offsetTop+"px")),styles},getRight:function(local){return(local?this.getLocalX():this.getX())+this.getWidth()},getTop:function(local){return local?this.getLocalY():this.getY()},getX:function(){return Element.getX(this.dom)},getXY:function(){return Element.getXY(this.dom)},getY:function(){return Element.getY(this.dom)},moveTo:function(x,y,animate){return this.setXY([x,y],animate)},position:function(pos,zIndex,x,y){var me=this;!pos&&me.isStyle(POSITION,STATIC)?me.setStyle(POSITION,RELATIVE):pos&&me.setStyle(POSITION,pos),zIndex&&me.setStyle(ZINDEX,zIndex),(x||y)&&me.setXY([x||!1,y||!1])},setBottom:function(bottom){return this.dom.style[BOTTOM]=this.addUnits(bottom),this},setBounds:function(x,y,width,height,animate){return this.setBox({x:x,y:y,width:width,height:height},animate)},setLeft:function(left){return this.dom.style[LEFT]=this.addUnits(left),this;
},setLeftTop:function(left,top){var me=this,style=me.dom.style;return style.left=me.addUnits(left),style.top=me.addUnits(top),me},setLocalX:function(x){var style=this.dom.style;style.right="auto",style.left=null===x?"auto":x+"px"},setLocalXY:function(x,y){var style=this.dom.style;style.right="auto",x&&x.length&&(y=x[1],x=x[0]),null===x?style.left="auto":void 0!==x&&(style.left=x+"px"),null===y?style.top="auto":void 0!==y&&(style.top=y+"px")},setLocalY:function(y){this.dom.style.top=null===y?"auto":y+"px"},setLocation:function(x,y,animate){return this.setXY([x,y],animate)},setPositioning:function(pc){return this.setStyle(pc)},setRight:function(right){return this.dom.style[RIGHT]=this.addUnits(right),this},setTop:function(top){return this.dom.style[TOP]=this.addUnits(top),this},setX:function(x,animate){return this.setXY([x,this.getY()],animate)},setXY:function(xy,animate){var me=this;return animate&&me.anim?(Ext.isObject(animate)||(animate={}),me.animate(Ext.applyIf({to:{x:xy[0],y:xy[1]}},animate))):Element.setXY(me.dom,xy),this},setY:function(y,animate){return this.setXY([this.getX(),y],animate)}}),Element.getTrueXY=Element.getXY}),Ext.define("Ext.dom.Element_scroll",{override:"Ext.dom.Element",isScrollable:function(){var dom=this.dom;return dom.scrollHeight>dom.clientHeight||dom.scrollWidth>dom.clientWidth},getScroll:function(){var left,top,me=this,dom=me.dom,doc=document,body=doc.body,docElement=doc.documentElement;return dom===doc||dom===body?(left=docElement.scrollLeft||(body?body.scrollLeft:0),top=docElement.scrollTop||(body?body.scrollTop:0)):(left=dom.scrollLeft,top=dom.scrollTop),{left:left,top:top}},getScrollLeft:function(){var dom=this.dom,doc=document;return dom===doc||dom===doc.body?this.getScroll().left:dom.scrollLeft},getScrollTop:function(){var dom=this.dom,doc=document;return dom===doc||dom===doc.body?this.getScroll().top:dom.scrollTop},setScrollLeft:function(left){return this.dom.scrollLeft=left,this},setScrollTop:function(top){return this.dom.scrollTop=top,this},scrollBy:function(deltaX,deltaY,animate){var me=this,dom=me.dom;return deltaX.length?(animate=deltaY,deltaY=deltaX[1],deltaX=deltaX[0]):"number"!=typeof deltaX&&(animate=deltaY,deltaY=deltaX.y,deltaX=deltaX.x),deltaX&&me.scrollTo("left",me.constrainScrollLeft(dom.scrollLeft+deltaX),animate),deltaY&&me.scrollTo("top",me.constrainScrollTop(dom.scrollTop+deltaY),animate),me},scrollTo:function(side,value,animate){var animCfg,top=/top/i.test(side),me=this,prop=top?"scrollTop":"scrollLeft",dom=me.dom;return animate&&me.anim?(animCfg={to:{}},animCfg.to[prop]=value,Ext.isObject(animate)&&Ext.applyIf(animCfg,animate),me.animate(animCfg)):(dom[prop]=value,dom[prop]=value),me},scrollIntoView:function(container,hscroll,animate,highlight){var newPos,me=this,dom=me.dom,offsets=me.getOffsetsTo(container=Ext.getDom(container)||Ext.getBody().dom),left=offsets[0]+container.scrollLeft,top=offsets[1]+container.scrollTop,bottom=top+dom.offsetHeight,right=left+dom.offsetWidth,ctClientHeight=container.clientHeight,ctScrollTop=parseInt(container.scrollTop,10),ctScrollLeft=parseInt(container.scrollLeft,10),ctBottom=ctScrollTop+ctClientHeight,ctRight=ctScrollLeft+container.clientWidth;return highlight&&(animate?animate=Ext.apply({listeners:{afteranimate:function(){me.scrollChildFly.attach(dom).highlight()}}},animate):me.scrollChildFly.attach(dom).highlight()),dom.offsetHeight>ctClientHeight||top<ctScrollTop?newPos=top:bottom>ctBottom&&(newPos=bottom-ctClientHeight),null!=newPos&&me.scrollChildFly.attach(container).scrollTo("top",newPos,animate),hscroll!==!1&&(newPos=null,dom.offsetWidth>container.clientWidth||left<ctScrollLeft?newPos=left:right>ctRight&&(newPos=right-container.clientWidth),null!=newPos&&me.scrollChildFly.attach(container).scrollTo("left",newPos,animate)),me},scrollChildIntoView:function(child,hscroll){this.scrollChildFly.attach(Ext.getDom(child)).scrollIntoView(this,hscroll)},scroll:function(direction,distance,animate){if(!this.isScrollable())return!1;direction=direction.charAt(0);var currentScroll,constrainedScroll,me=this,dom=me.dom,side="r"===direction||"l"===direction?"left":"top",scrolled=!1;return"l"!==direction&&"t"!==direction&&"u"!==direction||(distance=-distance),"left"===side?(currentScroll=dom.scrollLeft,constrainedScroll=me.constrainScrollLeft(currentScroll+distance)):(currentScroll=dom.scrollTop,constrainedScroll=me.constrainScrollTop(currentScroll+distance)),constrainedScroll!==currentScroll&&(this.scrollTo(side,constrainedScroll,animate),scrolled=!0),scrolled},constrainScrollLeft:function(left){var dom=this.dom;return Math.max(Math.min(left,dom.scrollWidth-dom.clientWidth),0)},constrainScrollTop:function(top){var dom=this.dom;return Math.max(Math.min(top,dom.scrollHeight-dom.clientHeight),0)}},function(){this.prototype.scrollChildFly=new this.Fly,this.prototype.scrolltoFly=new this.Fly}),Ext.define("Ext.dom.Element_style",{override:"Ext.dom.Element"},function(){function getBorderWidth(dom,el,inline,style){return"none"==style[this.styleName]?"0px":style[this.name]}var styleHooks,verticalStyleHooks90,verticalStyleHooks270,edges,k,edge,borderWidth,Element=this,view=document.defaultView,adjustDirect2DTableRe=/table-row|table-.*-group/,INTERNAL="_internal",HIDDEN="hidden",HEIGHT="height",WIDTH="width",ISCLIPPED="isClipped",OVERFLOW="overflow",OVERFLOWX="overflow-x",OVERFLOWY="overflow-y",ORIGINALCLIP="originalClip",DOCORBODYRE=/#document|body/i;if(view&&view.getComputedStyle||(Element.prototype.getStyle=function(property,inline){var camel,domStyle,values,hook,out,style,i,me=this,dom=me.dom,multiple="string"!=typeof property,hooks=me.styleHooks,prop=property,props=prop,len=1,isInline=inline;if(multiple&&(values={},prop=props[0],i=0,!(len=props.length)))return values;if(!dom||dom.documentElement)return values||"";domStyle=dom.style,inline?style=domStyle:(style=dom.currentStyle,style||(isInline=!0,style=domStyle));do{if(hook=hooks[prop],hook||(hooks[prop]=hook={name:Element.normalize(prop)}),hook.get)out=hook.get(dom,me,isInline,style);else if(camel=hook.name,hook.canThrow)try{out=style[camel]}catch(e){out=""}else out=style?style[camel]:"";if(!multiple)return out;values[prop]=out,prop=props[++i]}while(i<len);return values}),Element.override({getHeight:function(contentHeight,preciseHeight){var height,floating,me=this,hidden=me.isStyle("display","none");return hidden?0:(height=me.dom.offsetHeight,Ext.supports.Direct2DBug&&(floating=me.adjustDirect2DDimension(HEIGHT),preciseHeight?height+=floating:floating>0&&floating<.5&&height++),contentHeight&&(height-=me.getBorderWidth("tb")+me.getPadding("tb")),height<0?0:height)},getWidth:function(contentWidth,preciseWidth){var rect,width,floating,me=this,dom=me.dom,hidden=me.isStyle("display","none");return hidden?0:(Ext.supports.BoundingClientRect?(rect=dom.getBoundingClientRect(),width=!me.vertical||Ext.isIE9||Ext.supports.RotatedBoundingClientRect?rect.right-rect.left:rect.bottom-rect.top,width=preciseWidth?width:Math.ceil(width)):width=dom.offsetWidth,Ext.supports.Direct2DBug&&!me.vertical&&(floating=me.adjustDirect2DDimension(WIDTH),preciseWidth?width+=floating:floating>0&&floating<.5&&width++),contentWidth&&(width-=me.getBorderWidth("lr")+me.getPadding("lr")),width<0?0:width)},setWidth:function(width,animate){var me=this;return width=me.adjustWidth(width),animate&&me.anim?(Ext.isObject(animate)||(animate={}),me.animate(Ext.applyIf({to:{width:width}},animate))):me.dom.style.width=me.addUnits(width),me},setHeight:function(height,animate){var me=this;return height=me.adjustHeight(height),animate&&me.anim?(Ext.isObject(animate)||(animate={}),me.animate(Ext.applyIf({to:{height:height}},animate))):me.dom.style.height=me.addUnits(height),me},applyStyles:function(style){return Ext.DomHelper.applyStyles(this.dom,style),this},setSize:function(width,height,animate){var me=this;return Ext.isObject(width)&&(animate=height,height=width.height,width=width.width),width=me.adjustWidth(width),height=me.adjustHeight(height),animate&&me.anim?(animate===!0&&(animate={}),me.animate(Ext.applyIf({to:{width:width,height:height}},animate))):(me.dom.style.width=me.addUnits(width),me.dom.style.height=me.addUnits(height)),me},getViewSize:function(){var ret,me=this,dom=me.dom,isDoc=DOCORBODYRE.test(dom.nodeName);return ret=isDoc?{width:Element.getViewWidth(),height:Element.getViewHeight()}:{width:dom.clientWidth,height:dom.clientHeight}},getSize:function(contentSize){return{width:this.getWidth(contentSize),height:this.getHeight(contentSize)}},adjustWidth:function(width){var me=this,isNum="number"==typeof width;return isNum&&me.autoBoxAdjust&&!me.isBorderBox()&&(width-=me.getBorderWidth("lr")+me.getPadding("lr")),isNum&&width<0?0:width},adjustHeight:function(height){var me=this,isNum="number"==typeof height;return isNum&&me.autoBoxAdjust&&!me.isBorderBox()&&(height-=me.getBorderWidth("tb")+me.getPadding("tb")),isNum&&height<0?0:height},getColor:function(attr,defaultValue,prefix){var h,len,v=this.getStyle(attr),color=prefix||""===prefix?prefix:"#",i=0;if(!v||/transparent|inherit/.test(v))return defaultValue;if(/^r/.test(v))for(v=v.slice(4,v.length-1).split(","),len=v.length;i<len;i++)h=parseInt(v[i],10),color+=(h<16?"0":"")+h.toString(16);else v=v.replace("#",""),color+=3==v.length?v.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):v;return color.length>5?color.toLowerCase():defaultValue},setOpacity:function(opacity,animate){var me=this;return me.dom?(animate&&me.anim?("object"!=typeof animate&&(animate={duration:350,easing:"ease-in"}),me.animate(Ext.applyIf({to:{opacity:opacity}},animate))):me.setStyle("opacity",opacity),me):me},clearOpacity:function(){return this.setOpacity("")},adjustDirect2DDimension:function(dimension){var floating,me=this,dom=me.dom,display=me.getStyle("display"),inlineDisplay=dom.style.display,inlinePosition=dom.style.position,originIndex=dimension===WIDTH?0:1,currentStyle=dom.currentStyle;return"inline"===display&&(dom.style.display="inline-block"),dom.style.position=display.match(adjustDirect2DTableRe)?"absolute":"static",floating=(parseFloat(currentStyle[dimension])||2*parseFloat(currentStyle.msTransformOrigin.split(" ")[originIndex]))%1,dom.style.position=inlinePosition,"inline"===display&&(dom.style.display=inlineDisplay),floating},clip:function(){var style,me=this,data=(me.$cache||me.getCache()).data;return data[ISCLIPPED]||(data[ISCLIPPED]=!0,style=me.getStyle([OVERFLOW,OVERFLOWX,OVERFLOWY]),data[ORIGINALCLIP]={o:style[OVERFLOW],x:style[OVERFLOWX],y:style[OVERFLOWY]},me.setStyle(OVERFLOW,HIDDEN),me.setStyle(OVERFLOWX,HIDDEN),me.setStyle(OVERFLOWY,HIDDEN)),me},unclip:function(){var clip,me=this,data=(me.$cache||me.getCache()).data;return data[ISCLIPPED]&&(data[ISCLIPPED]=!1,clip=data[ORIGINALCLIP],clip.o&&me.setStyle(OVERFLOW,clip.o),clip.x&&me.setStyle(OVERFLOWX,clip.x),clip.y&&me.setStyle(OVERFLOWY,clip.y)),me},boxWrap:function(cls){cls=cls||Ext.baseCSSPrefix+"box";var el=Ext.get(this.insertHtml("beforeBegin","<div class='"+cls+"' role='presentation'>"+Ext.String.format(Element.boxMarkup,cls)+"</div>"));return Ext.DomQuery.selectNode("."+cls+"-mc",el.dom).appendChild(this.dom),el},getComputedHeight:function(){var me=this,h=Math.max(me.dom.offsetHeight,me.dom.clientHeight);return h||(h=parseFloat(me.getStyle(HEIGHT))||0,me.isBorderBox()||(h+=me.getFrameWidth("tb"))),h},getComputedWidth:function(){var me=this,w=Math.max(me.dom.offsetWidth,me.dom.clientWidth);return w||(w=parseFloat(me.getStyle(WIDTH))||0,me.isBorderBox()||(w+=me.getFrameWidth("lr"))),w},getFrameWidth:function(sides,onlyContentBox){return onlyContentBox&&this.isBorderBox()?0:this.getPadding(sides)+this.getBorderWidth(sides)},addClsOnOver:function(className,testFn,scope){var me=this,dom=me.dom,hasTest=Ext.isFunction(testFn);return me.hover(function(){hasTest&&testFn.call(scope||me,me)===!1||Ext.fly(dom,INTERNAL).addCls(className)},function(){Ext.fly(dom,INTERNAL).removeCls(className)}),me},addClsOnFocus:function(className,testFn,scope){var me=this,dom=me.dom,hasTest=Ext.isFunction(testFn);return me.on("focus",function(){return(!hasTest||testFn.call(scope||me,me)!==!1)&&void Ext.fly(dom,INTERNAL).addCls(className)}),me.on("blur",function(){Ext.fly(dom,INTERNAL).removeCls(className)}),me},addClsOnClick:function(className,testFn,scope){var me=this,dom=me.dom,hasTest=Ext.isFunction(testFn);return me.on("mousedown",function(){if(hasTest&&testFn.call(scope||me,me)===!1)return!1;Ext.fly(dom,INTERNAL).addCls(className);var d=Ext.getDoc(),fn=function(){Ext.fly(dom,INTERNAL).removeCls(className),d.removeListener("mouseup",fn)};d.on("mouseup",fn)}),me},getStyleSize:function(){var s,w,h,me=this,d=this.dom,isDoc=DOCORBODYRE.test(d.nodeName);return isDoc?{width:Element.getViewWidth(),height:Element.getViewHeight()}:(s=me.getStyle([HEIGHT,WIDTH],!0),s.width&&"auto"!=s.width&&(w=parseFloat(s.width),me.isBorderBox()&&(w-=me.getFrameWidth("lr"))),s.height&&"auto"!=s.height&&(h=parseFloat(s.height),me.isBorderBox()&&(h-=me.getFrameWidth("tb"))),{width:w||me.getWidth(!0),height:h||me.getHeight(!0)})},statics:{selectableCls:Ext.baseCSSPrefix+"selectable",unselectableCls:Ext.baseCSSPrefix+"unselectable"},selectable:function(){var me=this;return me.dom.unselectable="",me.removeCls(Element.unselectableCls),me.addCls(Element.selectableCls),me},unselectable:function(){var me=this;return Ext.isOpera&&(me.dom.unselectable="on"),me.removeCls(Element.selectableCls),me.addCls(Element.unselectableCls),me},setVertical:function(angle,cls){var me=this,proto=Element.prototype;me.vertical=!0,cls&&me.addCls(me.verticalCls=cls),me.setWidth=proto.setHeight,me.setHeight=proto.setWidth,Ext.isIE9m||(me.getWidth=proto.getHeight,me.getHeight=proto.getWidth),me.styleHooks=270===angle?Element.prototype.verticalStyleHooks270:Element.prototype.verticalStyleHooks90},setHorizontal:function(){var me=this,cls=me.verticalCls;delete me.vertical,cls&&(delete me.verticalCls,me.removeCls(cls)),delete me.setWidth,delete me.setHeight,Ext.isIE9m||(delete me.getWidth,delete me.getHeight),delete me.styleHooks}}),Element.prototype.styleHooks=styleHooks=Ext.dom.AbstractElement.prototype.styleHooks,Element.prototype.verticalStyleHooks90=verticalStyleHooks90=Ext.Object.chain(Element.prototype.styleHooks),Element.prototype.verticalStyleHooks270=verticalStyleHooks270=Ext.Object.chain(Element.prototype.styleHooks),verticalStyleHooks90.width={name:"height"},verticalStyleHooks90.height={name:"width"},verticalStyleHooks90["margin-top"]={name:"marginLeft"},verticalStyleHooks90["margin-right"]={name:"marginTop"},verticalStyleHooks90["margin-bottom"]={name:"marginRight"},verticalStyleHooks90["margin-left"]={name:"marginBottom"},verticalStyleHooks90["padding-top"]={name:"paddingLeft"},verticalStyleHooks90["padding-right"]={name:"paddingTop"},verticalStyleHooks90["padding-bottom"]={name:"paddingRight"},verticalStyleHooks90["padding-left"]={name:"paddingBottom"},verticalStyleHooks90["border-top"]={name:"borderLeft"},verticalStyleHooks90["border-right"]={name:"borderTop"},verticalStyleHooks90["border-bottom"]={name:"borderRight"},verticalStyleHooks90["border-left"]={name:"borderBottom"},verticalStyleHooks270.width={name:"height"},verticalStyleHooks270.height={name:"width"},verticalStyleHooks270["margin-top"]={name:"marginRight"},verticalStyleHooks270["margin-right"]={name:"marginBottom"},verticalStyleHooks270["margin-bottom"]={name:"marginLeft"},verticalStyleHooks270["margin-left"]={name:"marginTop"},verticalStyleHooks270["padding-top"]={name:"paddingRight"},verticalStyleHooks270["padding-right"]={name:"paddingBottom"},verticalStyleHooks270["padding-bottom"]={name:"paddingLeft"},verticalStyleHooks270["padding-left"]={name:"paddingTop"},verticalStyleHooks270["border-top"]={name:"borderRight"},verticalStyleHooks270["border-right"]={name:"borderBottom"},verticalStyleHooks270["border-bottom"]={name:"borderLeft"},verticalStyleHooks270["border-left"]={name:"borderTop"},Ext.isIE7m&&(styleHooks.fontSize=styleHooks["font-size"]={name:"fontSize",canThrow:!0},styleHooks.fontStyle=styleHooks["font-style"]={name:"fontStyle",canThrow:!0},styleHooks.fontFamily=styleHooks["font-family"]={name:"fontFamily",canThrow:!0}),Ext.isIEQuirks||Ext.isIE&&Ext.ieVersion<=8)for(edges=["Top","Right","Bottom","Left"],k=edges.length;k--;)edge=edges[k],borderWidth="border"+edge+"Width",styleHooks["border-"+edge.toLowerCase()+"-width"]=styleHooks[borderWidth]={name:borderWidth,styleName:"border"+edge+"Style",get:getBorderWidth};Ext.getDoc().on("selectstart",function(ev,dom){var doc=document.documentElement,selectableCls=Element.selectableCls,unselectableCls=Element.unselectableCls,tagName=dom&&dom.tagName;if(tagName=tagName&&tagName.toLowerCase(),"input"!==tagName&&"textarea"!==tagName)for(;dom&&1===dom.nodeType&&dom!==doc;){var el=Ext.fly(dom);if(el.hasCls(selectableCls))return;if(el.hasCls(unselectableCls))return void ev.stopEvent();dom=dom.parentNode}})}),Ext.onReady(function(){var opacityRe=/alpha\(opacity=(.*)\)/i,trimRe=/^\s+|\s+$/g,hooks=Ext.dom.Element.prototype.styleHooks;hooks.opacity={name:"opacity",afterSet:function(dom,value,el){el.isLayer&&el.onOpacitySet(value)}},!Ext.supports.Opacity&&Ext.isIE&&Ext.apply(hooks.opacity,{get:function(dom){var match,opacity,filter=dom.style.filter;return filter.match&&(match=filter.match(opacityRe),match&&(opacity=parseFloat(match[1]),!isNaN(opacity)))?opacity?opacity/100:0:1},set:function(dom,value){var style=dom.style,val=style.filter.replace(opacityRe,"").replace(trimRe,"");style.zoom=1,"number"==typeof value&&value>=0&&value<1?(value*=100,style.filter=val+(val.length?" ":"")+"alpha(opacity="+value+")"):style.filter=val}})}),Ext.define("Ext.util.Positionable",{_positionTopLeft:["position","top","left"],_alignRe:/^([a-z]+)-([a-z]+)(\?)?$/,afterSetPosition:Ext.emptyFn,adjustForConstraints:function(xy,parent){var vector=this.getConstrainVector(parent,xy);return vector&&(xy[0]+=vector[0],xy[1]+=vector[1]),xy},alignTo:function(element,position,offsets,animate){var me=this,el=me.el;return me.setXY(me.getAlignToXY(element,position,offsets),!(!el.anim||!animate)&&el.anim(animate))},anchorTo:function(anchorToEl,alignment,offsets,animate,monitorScroll,callback){var me=this,scroll=!Ext.isEmpty(monitorScroll),action=function(){me.alignTo(anchorToEl,alignment,offsets,animate),Ext.callback(callback,me)},anchor=me.getAnchor();return me.removeAnchor(),Ext.apply(anchor,{fn:action,scroll:scroll}),Ext.EventManager.onWindowResize(action,null),scroll&&Ext.EventManager.on(window,"scroll",action,null,{buffer:isNaN(monitorScroll)?50:monitorScroll}),action(),me},calculateAnchorXY:function(anchor,extraX,extraY,mySize){var xy,myWidth,myHeight,me=this,el=me.el,doc=document,isViewport=el.dom==doc.body||el.dom==doc,round=Math.round;switch(anchor=(anchor||"tl").toLowerCase(),mySize=mySize||{},myWidth=mySize.width||isViewport?Ext.Element.getViewWidth():me.getWidth(),myHeight=mySize.height||isViewport?Ext.Element.getViewHeight():me.getHeight(),anchor){case"tl":xy=[0,0];break;case"bl":xy=[0,myHeight];break;case"tr":xy=[myWidth,0];break;case"c":xy=[round(.5*myWidth),round(.5*myHeight)];break;case"t":xy=[round(.5*myWidth),0];break;case"l":xy=[0,round(.5*myHeight)];break;case"r":xy=[myWidth,round(.5*myHeight)];break;case"b":xy=[round(.5*myWidth),myHeight];break;case"tc":xy=[round(.5*myWidth),0];break;case"bc":xy=[round(.5*myWidth),myHeight];break;case"br":xy=[myWidth,myHeight]}return[xy[0]+extraX,xy[1]+extraY]},convertPositionSpec:Ext.identityFn,getAlignToXY:function(alignToEl,posSpec,offset){var alignMatch,myPosition,alignToElPosition,myWidth,myHeight,alignToElRegion,swapY,swapX,constrain,align1,align2,p1y,p1x,p2y,p2x,x,y,me=this,viewportWidth=Ext.Element.getViewWidth()-10,viewportHeight=Ext.Element.getViewHeight()-10,doc=document,docElement=doc.documentElement,docBody=doc.body,scrollX=docElement.scrollLeft||docBody.scrollLeft||0,scrollY=docElement.scrollTop||docBody.scrollTop||0;return alignToEl=Ext.get(alignToEl.el||alignToEl),!alignToEl||!alignToEl.dom,offset=offset||[0,0],posSpec=(posSpec&&"?"!=posSpec?/-/.test(posSpec)||""===posSpec?posSpec||"tl-bl":"tl-"+posSpec:"tl-bl?").toLowerCase(),posSpec=me.convertPositionSpec(posSpec),alignMatch=posSpec.match(me._alignRe),align1=alignMatch[1],align2=alignMatch[2],constrain=!!alignMatch[3],myPosition=me.getAnchorXY(align1,!0),alignToElPosition=me.getAnchorToXY(alignToEl,align2,!1),x=alignToElPosition[0]-myPosition[0]+offset[0],y=alignToElPosition[1]-myPosition[1]+offset[1],constrain&&(myWidth=me.getWidth(),myHeight=me.getHeight(),alignToElRegion=alignToEl.getRegion(),p1y=align1.charAt(0),p1x=align1.charAt(align1.length-1),p2y=align2.charAt(0),p2x=align2.charAt(align2.length-1),swapY="t"==p1y&&"b"==p2y||"b"==p1y&&"t"==p2y,swapX="r"==p1x&&"l"==p2x||"l"==p1x&&"r"==p2x,x+myWidth>viewportWidth+scrollX&&(x=swapX?alignToElRegion.left-myWidth:viewportWidth+scrollX-myWidth),x<scrollX&&(x=swapX?alignToElRegion.right:scrollX),y+myHeight>viewportHeight+scrollY&&(y=swapY?alignToElRegion.top-myHeight:viewportHeight+scrollY-myHeight),y<scrollY&&(y=swapY?alignToElRegion.bottom:scrollY)),[x,y]},getAnchor:function(){var anchor,el=this.el,data=(el.$cache||el.getCache()).data;if(el.dom)return anchor=data._anchor,anchor||(anchor=data._anchor={}),anchor},getAnchorXY:function(anchor,local,mySize){var me=this,myPos=me.getXY(),el=me.el,doc=document,isViewport=el.dom==doc.body||el.dom==doc,scroll=el.getScroll(),extraX=isViewport?scroll.left:local?0:myPos[0],extraY=isViewport?scroll.top:local?0:myPos[1];return me.calculateAnchorXY(anchor,extraX,extraY,mySize)},getBox:function(contentBox,local){var borderPadding,beforeX,beforeY,me=this,xy=local?me.getLocalXY():me.getXY(),x=xy[0],y=xy[1],w=me.getWidth(),h=me.getHeight();return contentBox&&(borderPadding=me.getBorderPadding(),beforeX=borderPadding.beforeX,beforeY=borderPadding.beforeY,x+=beforeX,y+=beforeY,w-=beforeX+borderPadding.afterX,h-=beforeY+borderPadding.afterY),{x:x,left:x,0:x,y:y,top:y,1:y,width:w,height:h,right:x+w,bottom:y+h}},calculateConstrainedPosition:function(constrainTo,proposedPosition,local,proposedSize){var vector,parentOffset,borderPadding,proposedConstrainPosition,me=this,fp=me.floatParent,parentNode=fp?fp.getTargetEl():null,xy=!1;return local&&fp?(parentOffset=parentNode.getXY(),borderPadding=parentNode.getBorderPadding(),parentOffset[0]+=borderPadding.beforeX,parentOffset[1]+=borderPadding.beforeY,proposedPosition&&(proposedConstrainPosition=[proposedPosition[0]+parentOffset[0],proposedPosition[1]+parentOffset[1]])):proposedConstrainPosition=proposedPosition,constrainTo=constrainTo||me.constrainTo||parentNode||me.container||me.el.parent(),vector=(me.constrainHeader?me.header:me).getConstrainVector(constrainTo,proposedConstrainPosition,proposedSize),vector&&(xy=proposedPosition||me.getPosition(local),xy[0]+=vector[0],xy[1]+=vector[1]),xy},getConstrainVector:function(constrainTo,proposedPosition,proposedSize){var thisRegion=this.getRegion(),vector=[0,0],shadowSize=this.shadow&&this.constrainShadow&&!this.shadowDisabled?this.shadow.getShadowSize():void 0,overflowed=!1,constraintInsets=this.constraintInsets;return constrainTo instanceof Ext.util.Region||(constrainTo=Ext.get(constrainTo.el||constrainTo).getViewRegion()),constraintInsets&&(constraintInsets=Ext.isObject(constraintInsets)?constraintInsets:Ext.Element.parseBox(constraintInsets),constrainTo.adjust(constraintInsets.top,constraintInsets.right,constraintInsets.bottom,constraintInsets.length)),proposedPosition&&thisRegion.translateBy(proposedPosition[0]-thisRegion.x,proposedPosition[1]-thisRegion.y),proposedSize&&(thisRegion.right=thisRegion.left+proposedSize[0],thisRegion.bottom=thisRegion.top+proposedSize[1]),shadowSize&&constrainTo.adjust(shadowSize[0],-shadowSize[1],-shadowSize[2],shadowSize[3]),thisRegion.right>constrainTo.right&&(overflowed=!0,vector[0]=constrainTo.right-thisRegion.right),thisRegion.left+vector[0]<constrainTo.left&&(overflowed=!0,vector[0]=constrainTo.left-thisRegion.left),thisRegion.bottom>constrainTo.bottom&&(overflowed=!0,vector[1]=constrainTo.bottom-thisRegion.bottom),thisRegion.top+vector[1]<constrainTo.top&&(overflowed=!0,vector[1]=constrainTo.top-thisRegion.top),!!overflowed&&vector},getOffsetsTo:function(offsetsTo){var o=this.getXY(),e=Ext.fly(offsetsTo.el||offsetsTo,"_internal").getXY();return[o[0]-e[0],o[1]-e[1]]},getRegion:function(){var box=this.getBox();return new Ext.util.Region(box.top,box.right,box.bottom,box.left)},getViewRegion:function(){var borderPadding,scroll,pos,top,left,width,height,me=this,el=me.el,isBody="BODY"===el.dom.nodeName;return isBody?(scroll=el.getScroll(),left=scroll.left,top=scroll.top,width=Ext.dom.AbstractElement.getViewportWidth(),height=Ext.dom.AbstractElement.getViewportHeight()):(borderPadding=me.getBorderPadding(),pos=me.getXY(),left=pos[0]+borderPadding.beforeX,top=pos[1]+borderPadding.beforeY,width=me.getWidth(!0),height=me.getHeight(!0)),new Ext.util.Region(top,left+width,top+height,left)},move:function(direction,distance,animate){var me=this,xy=me.getXY(),x=xy[0],y=xy[1],left=[x-distance,y],right=[x+distance,y],top=[x,y-distance],bottom=[x,y+distance],hash={l:left,left:left,r:right,right:right,t:top,top:top,up:top,b:bottom,bottom:bottom,down:bottom};direction=direction.toLowerCase(),me.setXY([hash[direction][0],hash[direction][1]],animate)},removeAnchor:function(){var anchor=this.getAnchor();return anchor&&anchor.fn&&(Ext.EventManager.removeResizeListener(anchor.fn),anchor.scroll&&Ext.EventManager.un(window,"scroll",anchor.fn),delete anchor.fn),this},setBox:function(box,animate){var me=this,el=me.el,x=box.x,y=box.y,w=box.width,h=box.height,doConstrain=me.constrain||me.constrainHeader,constrainedPos=doConstrain&&me.calculateConstrainedPosition(null,[x,y],!1,[w,h]);return constrainedPos&&(x=constrainedPos[0],y=constrainedPos[1]),animate&&el.anim?me.animate(Ext.applyIf({to:{x:x,y:y,width:el.adjustWidth(w),height:el.adjustHeight(h)},listeners:{afteranimate:Ext.Function.bind(me.afterSetPosition,me,[x,y])}},animate)):(me.setSize(w,h),me.setXY([x,y]),me.afterSetPosition(x,y)),me},setRegion:function(region,animate){return this.setBox({x:region.left,y:region.top,width:region.right-region.left,height:region.bottom-region.top},animate)},translatePoints:function(x,y){var pos=this.translateXY(x,y);return{left:pos.x,top:pos.y}},translateXY:function(x,y){var me=this,el=me.el,styles=el.getStyle(me._positionTopLeft),relative="relative"==styles.position,left=parseFloat(styles.left),top=parseFloat(styles.top),xy=me.getXY();return Ext.isArray(x)&&(y=x[1],x=x[0]),isNaN(left)&&(left=relative?0:el.dom.offsetLeft),isNaN(top)&&(top=relative?0:el.dom.offsetTop),left="number"==typeof x?x-xy[0]+left:void 0,top="number"==typeof y?y-xy[1]+top:void 0,{x:left,y:top}}}),Ext.define("Ext.dom.Element",function(Element){var visFly,HIDDEN="hidden",DOC=document,VISIBILITY="visibility",DISPLAY="display",NONE="none",XMASKED=Ext.baseCSSPrefix+"masked",XMASKEDRELATIVE=Ext.baseCSSPrefix+"masked-relative",EXTELMASKMSG=Ext.baseCSSPrefix+"mask-msg",bodyRe=/^body/i,noBoxAdjust=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1},isScrolled=function(c){var i,ci,r=[],ri=-1;for(i=0;ci=c[i];i++)(ci.scrollTop>0||ci.scrollLeft>0)&&(r[++ri]=ci);return r};return{extend:Ext.dom.AbstractElement,alternateClassName:["Ext.Element","Ext.core.Element"],tableTagRe:/^(?:tr|td|table|tbody)$/i,mixins:[Ext.util.Positionable],addUnits:function(){return Element.addUnits.apply(Element,arguments)},focus:function(defer,dom){var me=this;dom=dom||me.dom;try{Number(defer)?Ext.defer(me.focus,defer,me,[null,dom]):dom.focus()}catch(e){}return me},blur:function(){var me=this,dom=me.dom;if(dom!==document.body){try{dom.blur()}catch(e){}return me}return me.focus(void 0,dom)},isBorderBox:function(){var box=Ext.isBorderBox;return box&&Ext.isIE7m&&(box=!((this.dom.tagName||"").toLowerCase()in noBoxAdjust)),box},hover:function(overFn,outFn,scope,options){var me=this;return me.on("mouseenter",overFn,scope||me.dom,options),me.on("mouseleave",outFn,scope||me.dom,options),me},getAttributeNS:function(ns,name){return this.getAttribute(name,ns)},getAttribute:!Ext.isIE||Ext.isIE9p&&DOC.documentMode>=9?function(name,ns){var d=this.dom;return ns?d.getAttributeNS(ns,name)||d.getAttribute(ns+":"+name):d.getAttribute(name)||d[name]||null}:function(name,ns){var type,d=this.dom;return ns?(type=typeof d[ns+":"+name],"undefined"!=type&&"unknown"!=type?d[ns+":"+name]||null:null):("for"===name&&(name="htmlFor"),d[name]||null)},cacheScrollValues:function(){var scrolledDescendants,el,i,me=this,scrollValues=[],result=function(){for(i=0;i<scrolledDescendants.length;i++)el=scrolledDescendants[i],el.scrollLeft=scrollValues[i][0],el.scrollTop=scrollValues[i][1]};for(Ext.DomQuery.pseudos.isScrolled||(Ext.DomQuery.pseudos.isScrolled=isScrolled),scrolledDescendants=me.query(":isScrolled"),i=0;i<scrolledDescendants.length;i++)el=scrolledDescendants[i],scrollValues[i]=[el.scrollLeft,el.scrollTop];return result},autoBoxAdjust:!0,isVisible:function(deep){var me=this,dom=me.dom,stopNode=dom.ownerDocument.documentElement;for(visFly||(visFly=new Element.Fly);dom!==stopNode;){if(!dom||11===dom.nodeType||visFly.attach(dom).isStyle(VISIBILITY,HIDDEN)||visFly.isStyle(DISPLAY,NONE))return!1;if(!deep)break;dom=dom.parentNode}return!0},isDisplayed:function(){return!this.isStyle(DISPLAY,NONE)},enableDisplayMode:function(display){var me=this;return me.setVisibilityMode(Element.DISPLAY),Ext.isEmpty(display)||((me.$cache||me.getCache()).data.originalDisplay=display),me},mask:function(msg,msgCls,elHeight){var widthExpression,heightExpression,docElem,ie6DocElHeight,me=this,dom=me.dom,setExpression=dom.style.setExpression,data=(me.$cache||me.getCache()).data,maskShimEl=data.maskShimEl,maskEl=data.maskEl,maskMsg=data.maskMsg;if(bodyRe.test(dom.tagName)&&"static"==me.getStyle("position")||me.addCls(XMASKEDRELATIVE),maskEl&&maskEl.remove(),maskMsg&&maskMsg.remove(),maskShimEl&&maskShimEl.remove(),Ext.isIE6&&(maskShimEl=Ext.DomHelper.append(dom,{tag:"iframe",role:"presentation",cls:Ext.baseCSSPrefix+"shim "+Ext.baseCSSPrefix+"mask-shim"},!0),data.maskShimEl=maskShimEl,maskShimEl.setDisplayed(!0)),Ext.DomHelper.append(dom,[{role:"presentation",cls:Ext.baseCSSPrefix+"mask",style:"top:0;left:0;"},{role:"presentation",cls:msgCls?EXTELMASKMSG+" "+msgCls:EXTELMASKMSG,cn:{tag:"div",role:"presentation",cls:Ext.baseCSSPrefix+"mask-msg-inner",cn:{tag:"div",role:"presentation",cls:Ext.baseCSSPrefix+"mask-msg-text",html:msg||""}}}]),maskMsg=Ext.get(dom.lastChild),maskEl=Ext.get(maskMsg.dom.previousSibling),data.maskMsg=maskMsg,data.maskEl=maskEl,me.addCls(XMASKED),maskEl.setDisplayed(!0),"string"==typeof msg?(maskMsg.setDisplayed(!0),maskMsg.center(me)):maskMsg.setDisplayed(!1),Ext.isStrict&&!Ext.isIE6&&dom===DOC.body&&maskEl.addCls(Ext.baseCSSPrefix+"mask-fixed"),dom!==DOC.body||Ext.isIE6||Ext.isIEQuirks){if(!Ext.supports.IncludePaddingInWidthCalculation&&setExpression)try{maskEl.dom.style.setExpression("width",'this.parentNode.clientWidth + "px"'),widthExpression='this.parentNode.clientWidth + "px"',maskShimEl&&maskShimEl.dom.style.setExpression("width",widthExpression),maskEl.dom.style.setExpression("width",widthExpression)}catch(e){}if(!Ext.supports.IncludePaddingInHeightCalculation&&setExpression)try{heightExpression="this.parentNode."+(dom==DOC.body?"scrollHeight":"offsetHeight")+' + "px"',maskShimEl&&maskShimEl.dom.style.setExpression("height",heightExpression),maskEl.dom.style.setExpression("height",heightExpression)}catch(e){}else!Ext.isIE9m||Ext.isIE7&&Ext.isStrict||"auto"!=me.getStyle("height")||(Ext.isIE6&&Ext.isStrict&&(docElem=dom.parentNode,ie6DocElHeight=Math.max(docElem.clientHeight,docElem.scrollHeight)),maskShimEl&&maskShimEl.setSize(void 0,elHeight||ie6DocElHeight||me.getHeight()),maskEl.setSize(void 0,elHeight||ie6DocElHeight||me.getHeight()))}return maskEl},unmask:function(){var style,me=this,data=(me.$cache||me.getCache()).data,maskEl=data.maskEl,maskShimEl=data.maskShimEl,maskMsg=data.maskMsg;maskEl&&(style=maskEl.dom.style,style.clearExpression&&(style.clearExpression("width"),style.clearExpression("height")),maskEl&&(maskEl.remove(),
delete data.maskEl),maskMsg&&(maskMsg.remove(),delete data.maskMsg),me.removeCls([XMASKED,XMASKEDRELATIVE]),maskShimEl&&(style=maskShimEl.dom.style,style.clearExpression&&(style.clearExpression("width"),style.clearExpression("height")),maskShimEl.remove(),delete data.maskShimEl))},isMasked:function(){var me=this,data=(me.$cache||me.getCache()).data,maskEl=data.maskEl,maskMsg=data.maskMsg,hasMask=!1;return maskEl&&maskEl.isVisible()&&(maskMsg&&maskMsg.center(me),hasMask=!0),hasMask},createShim:function(){var shim,el=DOC.createElement("iframe");return el.frameBorder="0",el.className=Ext.baseCSSPrefix+"shim",el.src=Ext.SSL_SECURE_URL,el.setAttribute("role","presentation"),shim=Ext.get(this.dom.parentNode.insertBefore(el,this.dom)),shim.autoBoxAdjust=!1,shim},addKeyListener:function(key,fn,scope){var config;return config="object"!=typeof key||Ext.isArray(key)?{target:this,key:key,fn:fn,scope:scope}:{target:this,key:key.key,shift:key.shift,ctrl:key.ctrl,alt:key.alt,fn:fn,scope:scope},new Ext.util.KeyMap(config)},addKeyMap:function(config){return new Ext.util.KeyMap(Ext.apply({target:this},config))},on:function(eventName,fn,scope,options){return Ext.EventManager.on(this,eventName,fn,scope||this,options),this},un:function(eventName,fn,scope){return Ext.EventManager.un(this,eventName,fn,scope||this),this},removeAllListeners:function(){return Ext.EventManager.removeAll(this),this},purgeAllListeners:function(){return Ext.EventManager.purgeElement(this),this},select:function(selector){return Element.select(selector,!1,this.dom)}}},function(){function garbageCollect(){if(Ext.enableGarbageCollector){var eid,d,o,t;for(eid in EC)EC.hasOwnProperty(eid)&&(o=EC[eid],o.skipGarbageCollection||(d=o.dom,!d||d.parentNode&&(d.offsetParent||Ext.getElementById(eid))||(Ext.enableListenerCollection&&Ext.EventManager.removeAll(d),delete EC[eid])));if(Ext.isIE){t={};for(eid in EC)EC.hasOwnProperty(eid)&&(t[eid]=EC[eid]);EC=Ext.cache=t}}else clearInterval(Element.collectorThreadId)}var internalFly,DOC=document,EC=Ext.cache,Element=this,AbstractElement=Ext.dom.AbstractElement,focusRe=/^a|button|embed|iframe|input|object|select|textarea$/i,nonSpaceRe=/\S/,scriptTagRe=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/gi,replaceScriptTagRe=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,srcRe=/\ssrc=([\'\"])(.*?)\1/i,typeRe=/\stype=([\'\"])(.*?)\1/i,useDocForId=!Ext.isIE8m;Element.boxMarkup=['<div class="{0}-tl" role="presentation">','<div class="{0}-tr" role="presentation">','<div class="{0}-tc" role="presentation"></div>',"</div>","</div>",'<div class="{0}-ml" role="presentation">','<div class="{0}-mr" role="presentation">','<div class="{0}-mc" role="presentation"></div>',"</div>","</div>",'<div class="{0}-bl" role="presentation">','<div class="{0}-br" role="presentation">','<div class="{0}-bc" role="presentation"></div>',"</div>","</div>"].join(""),Element.collectorThreadId=setInterval(garbageCollect,3e4),Element.addMethods({monitorMouseLeave:function(delay,handler,scope){var timer,me=this,listeners={mouseleave:function(e){timer=setTimeout(Ext.Function.bind(handler,scope||me,[e]),delay)},mouseenter:function(){clearTimeout(timer)},freezeEvent:!0};return me.on(listeners),listeners},swallowEvent:function(eventName,preventDefault){var e,eLen,me=this,fn=function(e){e.stopPropagation(),preventDefault&&e.preventDefault()};if(Ext.isArray(eventName)){for(eLen=eventName.length,e=0;e<eLen;e++)me.on(eventName[e],fn);return me}return me.on(eventName,fn),me},relayEvent:function(eventName,observable){this.on(eventName,function(e){observable.fireEvent(eventName,e)})},clean:function(forceReclean){var nx,me=this,dom=me.dom,data=(me.$cache||me.getCache()).data,n=dom.firstChild,ni=-1;if(data.isCleaned&&forceReclean!==!0)return me;for(;n;)nx=n.nextSibling,3==n.nodeType?nonSpaceRe.test(n.nodeValue)?nx&&3==nx.nodeType&&(n.appendData(Ext.String.trim(nx.data)),dom.removeChild(nx),nx=n.nextSibling,n.nodeIndex=++ni):dom.removeChild(n):(internalFly.attach(n).clean(),n.nodeIndex=++ni),n=nx;return data.isCleaned=!0,me},load:function(options){return this.getLoader().load(options),this},getLoader:function(){var me=this,data=(me.$cache||me.getCache()).data,loader=data.loader;return loader||(data.loader=loader=new Ext.ElementLoader({target:me})),loader},syncContent:function(source){source=Ext.getDom(source);var i,destNode,sourceNode,nodeType,newAttrs,attLen,attName,sourceNodes=source.childNodes,sourceLen=sourceNodes.length,dest=this.dom,destNodes=dest.childNodes,destLen=destNodes.length;if(Ext.isIE9m&&dest.mergeAttributes)dest.mergeAttributes(source,!0),dest.src=source.src;else for(newAttrs=source.attributes,attLen=newAttrs.length,i=0;i<attLen;i++)attName=newAttrs[i].name,"id"!==attName&&dest.setAttribute(attName,newAttrs[i].value);if(sourceLen!==destLen)return void(dest.innerHTML=source.innerHTML);for(i=0;i<sourceLen;i++){if(sourceNode=sourceNodes[i],destNode=destNodes[i],nodeType=sourceNode.nodeType,nodeType!==destNode.nodeType||1===nodeType&&sourceNode.tagName!==destNode.tagName)return void(dest.innerHTML=source.innerHTML);3===nodeType?destNode.data=sourceNode.data:(sourceNode.id&&destNode.id!==sourceNode.id&&(destNode.id=sourceNode.id),destNode.style.cssText=sourceNode.style.cssText,destNode.className=sourceNode.className,internalFly.attach(destNode).syncContent(sourceNode))}},update:function(html,loadScripts,callback){var id,dom,interval,me=this;return me.dom?(html=html||"",dom=me.dom,loadScripts!==!0?(dom.innerHTML=html,Ext.callback(callback,me),me):(id=Ext.id(),html+='<span id="'+id+'" role="presentation"></span>',interval=setInterval(function(){var hd,match,attrs,srcMatch,typeMatch,el,s;if(!(el=DOC.getElementById(id)))return!1;for(clearInterval(interval),Ext.removeNode(el),hd=Ext.getHead().dom;match=scriptTagRe.exec(html);)attrs=match[1],srcMatch=!!attrs&&attrs.match(srcRe),srcMatch&&srcMatch[2]?(s=DOC.createElement("script"),s.src=srcMatch[2],typeMatch=attrs.match(typeRe),typeMatch&&typeMatch[2]&&(s.type=typeMatch[2]),hd.appendChild(s)):match[2]&&match[2].length>0&&(window.execScript?window.execScript(match[2]):window.eval(match[2]));Ext.callback(callback,me)},20),dom.innerHTML=html.replace(replaceScriptTagRe,""),me)):me},removeAllListeners:function(){return this.removeAnchor(),Ext.EventManager.removeAll(this.dom),this},createProxy:function(config,renderTo,matchBox){config="object"==typeof config?config:{tag:"div",role:"presentation",cls:config};var me=this,proxy=renderTo?Ext.DomHelper.append(renderTo,config,!0):Ext.DomHelper.insertBefore(me.dom,config,!0);return proxy.setVisibilityMode(Element.DISPLAY),proxy.hide(),matchBox&&me.setBox&&me.getBox&&proxy.setBox(me.getBox()),proxy},needsTabIndex:function(){if(this.dom)return"a"===this.dom.nodeName&&!this.dom.href||!focusRe.test(this.dom.nodeName)},isFocusable:function(asFocusEl){var tabIndex,dom=this.dom,tabIndexAttr=dom.getAttributeNode("tabIndex"),nodeName=dom.nodeName,canFocus=!1;return tabIndexAttr&&tabIndexAttr.specified&&(tabIndex=tabIndexAttr.value),dom&&!dom.disabled&&(tabIndex==-1?canFocus=Ext.FocusManager&&Ext.FocusManager.enabled&&asFocusEl:focusRe.test(nodeName)?("a"!==nodeName||dom.href)&&(canFocus=!0):canFocus=null!=tabIndex&&tabIndex>=0,canFocus=canFocus&&this.isVisible(!0)),canFocus}}),Ext.isIE9m&&(Element.prototype.getById=function(id,asDom){var cacheItem,el,ret,dom=this.dom;return dom&&(el=useDocForId&&DOC.getElementById(id)||dom.all[id])?(asDom?ret=el:(cacheItem=EC[id],ret=cacheItem&&cacheItem.el?Ext.updateCacheEntry(cacheItem,el).el:new Element(el)),ret):asDom?Ext.getDom(id):Element.get(id)}),Element.createAlias({addListener:"on",removeListener:"un",clearListeners:"removeAllListeners",focusable:"isFocusable"}),Element.Fly=AbstractElement.Fly=new Ext.Class({extend:Element,isFly:!0,constructor:function(dom){this.dom=dom,this.el=this},attach:AbstractElement.Fly.prototype.attach}),internalFly=new Element.Fly,Ext.isIE9m?Ext.getElementById=function(id){var detachedBodyEl,el=DOC.getElementById(id);return!el&&(detachedBodyEl=AbstractElement.detachedBodyEl)&&(el=detachedBodyEl.dom.all[id]),el}:DOC.querySelector||(Ext.getDetachedBody=Ext.getBody,Ext.getElementById=function(id){return DOC.getElementById(id)})}),Ext.define("Ext.dom.CompositeElementLite",{alternateClassName:"Ext.CompositeElementLite",statics:{importElementMethods:function(){var name,elementPrototype=Ext.dom.Element.prototype,prototype=this.prototype;for(name in elementPrototype)"function"==typeof elementPrototype[name]&&function(key){prototype[key]=prototype[key]||function(){return this.invoke(key,arguments)}}.call(prototype,name)}},constructor:function(elements,root){this.elements=[],this.add(elements,root),this.el=new Ext.dom.AbstractElement.Fly},isComposite:!0,getElement:function(el){return this.el.attach(el)},transformElement:function(el){return Ext.getDom(el)},getCount:function(){return this.elements.length},add:function(els,root){var i,ln,elements=this.elements;if(!els)return this;for("string"==typeof els?els=Ext.dom.Element.selectorFunction(els,root):els.isComposite?els=els.elements:Ext.isIterable(els)||(els=[els]),i=0,ln=els.length;i<ln;++i)elements.push(this.transformElement(els[i]));return this},invoke:function(fn,args){var element,i,elements=this.elements,ln=elements.length;for(fn=Ext.dom.Element.prototype[fn],i=0;i<ln;i++)element=elements[i],element&&fn.apply(this.getElement(element),args);return this},item:function(index){var el=this.elements[index],out=null;return el&&(out=this.getElement(el)),out},slice:function(){return this.elements.slice.apply(this.elements,arguments)},addListener:function(eventName,handler,scope,opt){var i,e,els=this.elements,len=els.length;for(i=0;i<len;i++)e=els[i],e&&Ext.EventManager.on(e,eventName,handler,scope||e,opt);return this},each:function(fn,scope){var i,e,me=this,els=me.elements,len=els.length;for(i=0;i<len&&(e=els[i],!e||(e=this.getElement(e),fn.call(scope||e,e,me,i)!==!1));i++);return me},fill:function(els){var me=this;return me.elements=[],me.add(els),me},insert:function(index,nodes){Ext.Array.insert(this.elements,index,nodes)},filter:function(selector){for(var add,el,me=this,els=me.elements,len=els.length,out=[],i=0,isFunc="function"==typeof selector;i<len;i++)el=els[i],add=!1,el&&(el=me.getElement(el),add=isFunc?selector.call(el,el,me,i)!==!1:el.is(selector),add&&out.push(me.transformElement(el)));return me.elements=out,me},indexOf:function(el){return Ext.Array.indexOf(this.elements,this.transformElement(el))},replaceElement:function(el,replacement,domReplace){var d,index=isNaN(el)?this.indexOf(el):el;return index>-1&&(replacement=Ext.getDom(replacement),domReplace&&(d=this.elements[index],d.parentNode.insertBefore(replacement,d),Ext.removeNode(d)),Ext.Array.splice(this.elements,index,1,replacement)),this},clear:function(removeDom){var me=this,els=me.elements,i=els.length-1;if(removeDom)for(;i>=0;i--)Ext.removeNode(els[i]);this.elements=[]},addElements:function(els,root){if(!els)return this;"string"==typeof els&&(els=Ext.dom.Element.selectorFunction(els,root));var e,yels=this.elements,eLen=els.length;for(e=0;e<eLen;e++)yels.push(Ext.get(els[e]));return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(el){return this.indexOf(el)!=-1},removeElement:function(keys,removeDom){keys=[].concat(keys);var val,el,k,me=this,elements=me.elements,kLen=keys.length;for(k=0;k<kLen;k++)val=keys[k],(el=elements[val]||elements[val=me.indexOf(val)])&&(removeDom&&(el.dom?el.remove():Ext.removeNode(el)),Ext.Array.erase(elements,val,1));return me}},function(){this.importElementMethods(),this.prototype.on=this.prototype.addListener,Ext.DomQuery&&(Ext.dom.Element.selectorFunction=Ext.DomQuery.select),Ext.dom.Element.select=function(selector,root){var elements;return"string"==typeof selector?elements=Ext.dom.Element.selectorFunction(selector,root):void 0!==selector.length&&(elements=selector),new Ext.CompositeElementLite(elements)},Ext.select=function(){return Ext.dom.Element.select.apply(Ext.dom.Element,arguments)}}),Ext.define("Ext.dom.CompositeElement",{alternateClassName:"Ext.CompositeElement",extend:Ext.dom.CompositeElementLite,getElement:function(el){return el},transformElement:function(el){return Ext.get(el)}},function(){Ext.dom.Element.select=function(selector,unique,root){var elements;return"string"==typeof selector?elements=Ext.dom.Element.selectorFunction(selector,root):void 0!==selector.length&&(elements=selector),unique===!0?new Ext.CompositeElement(elements):new Ext.CompositeElementLite(elements)}}),Ext.select=Ext.Element.select,Ext.define("Ext.util.HashMap",{mixins:{observable:Ext.util.Observable},generation:0,constructor:function(config){config=config||{};var me=this,keyFn=config.keyFn;me.initialConfig=config,me.addEvents("add","clear","remove","replace"),me.mixins.observable.constructor.call(me,config),me.clear(!0),keyFn&&(me.getKey=keyFn)},getCount:function(){return this.length},getData:function(key,value){return void 0===value&&(value=key,key=this.getKey(value)),[key,value]},getKey:function(o){return o.id},add:function(key,value){var me=this;return 1===arguments.length&&(value=key,key=me.getKey(value)),me.containsKey(key)?me.replace(key,value):(me.map[key]=value,++me.length,me.generation++,me.hasListeners.add&&me.fireEvent("add",me,key,value),value)},replace:function(key,value){var old,me=this,map=me.map;return 1===arguments.length&&(value=key,key=me.getKey(value)),me.containsKey(key)||me.add(key,value),old=map[key],map[key]=value,me.generation++,me.hasListeners.replace&&me.fireEvent("replace",me,key,value,old),value},remove:function(o){var key=this.findKey(o);return void 0!==key&&this.removeAtKey(key)},removeAtKey:function(key){var value,me=this;return!!me.containsKey(key)&&(value=me.map[key],delete me.map[key],--me.length,me.generation++,me.hasListeners.remove&&me.fireEvent("remove",me,key,value),!0)},get:function(key){var map=this.map;return map.hasOwnProperty(key)?map[key]:void 0},clear:function(initial){var me=this;return(initial||me.generation)&&(me.map={},me.length=0,me.generation=initial?0:me.generation+1),initial!==!0&&me.hasListeners.clear&&me.fireEvent("clear",me),me},containsKey:function(key){var map=this.map;return map.hasOwnProperty(key)&&void 0!==map[key]},contains:function(value){return this.containsKey(this.findKey(value))},getKeys:function(){return this.getArray(!0)},getValues:function(){return this.getArray(!1)},getArray:function(isKey){var key,arr=[],map=this.map;for(key in map)map.hasOwnProperty(key)&&arr.push(isKey?key:map[key]);return arr},each:function(fn,scope){var key,items=Ext.apply({},this.map),length=this.length;scope=scope||this;for(key in items)if(items.hasOwnProperty(key)&&fn.call(scope,key,items[key],length)===!1)break;return this},clone:function(){var key,hash=new this.self(this.initialConfig),map=this.map;hash.suspendEvents();for(key in map)map.hasOwnProperty(key)&&hash.add(key,map[key]);return hash.resumeEvents(),hash},findKey:function(value){var key,map=this.map;for(key in map)if(map.hasOwnProperty(key)&&map[key]===value)return key}}),Ext.define("Ext.AbstractManager",{typeName:"type",constructor:function(config){Ext.apply(this,config||{}),this.all=new Ext.util.HashMap,this.types={}},get:function(id){return this.all.get(id)},register:function(item){this.all.add(item)},unregister:function(item){this.all.remove(item)},registerType:function(type,cls){this.types[type]=cls,cls[this.typeName]=type},isRegistered:function(type){return void 0!==this.types[type]},create:function(config,defaultType){var type=config[this.typeName]||config.type||defaultType,Constructor=this.types[type];return new Constructor(config)},onAvailable:function(id,fn,scope){var item,callback,all=this.all;all.containsKey(id)?(item=all.get(id),fn.call(scope||item,item)):(callback=function(map,key,item){key==id&&(fn.call(scope||item,item),all.un("add",callback))},all.on("add",callback))},each:function(fn,scope){this.all.each(fn,scope||this)},getCount:function(){return this.all.getCount()}}),Ext.define("Ext.ComponentManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.ComponentMgr",singleton:!0,typeName:"xtype",create:function(component,defaultType){return"string"==typeof component?Ext.widget(component):component.isComponent?component:Ext.widget(component.xtype||defaultType,component)},registerType:function(type,cls){this.types[type]=cls,cls[this.typeName]=type,cls.prototype[this.typeName]=type}},function(){Ext.getCmp=function(id){return Ext.ComponentManager.get(id)}}),Ext.define("Ext.ComponentQuery",{singleton:!0},function(){var cq=this,domQueryOperators=Ext.dom.Query.operators,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,filterFnPattern=["var r = [],","i = 0,","it = items,","l = it.length,","c;","for (; i < l; i++) {","c = it[i];","if (c.{0}) {","r.push(c);","}","}","return r;"].join(""),filterItems=function(items,operation){return operation.method.apply(this,[items].concat(operation.args))},getItems=function(items,mode){for(var candidate,result=[],i=0,length=items.length,deep=">"!==mode;i<length;i++)candidate=items[i],candidate.getRefItems&&(result=result.concat(candidate.getRefItems(deep)));return result},getAncestors=function(items){for(var candidate,result=[],i=0,length=items.length;i<length;i++)for(candidate=items[i];candidate=candidate.getRefOwner();)result.push(candidate);return result},filterByXType=function(items,xtype,shallow){if("*"===xtype)return items.slice();for(var candidate,result=[],i=0,length=items.length;i<length;i++)candidate=items[i],candidate.isXType(xtype,shallow)&&result.push(candidate);return result},filterByClassName=function(items,className){for(var candidate,result=[],i=0,length=items.length;i<length;i++)candidate=items[i],candidate.hasCls(className)&&result.push(candidate);return result},filterByAttribute=function(items,property,operator,compareTo){var mustBeOwnProperty,presenceOnly,candidate,propValue,j,propLen,result=[],i=0,length=items.length;for("@"===property.charAt(0)&&(mustBeOwnProperty=!0,property=property.substr(1)),"?"===property.charAt(0)&&(mustBeOwnProperty=!0,presenceOnly=!0,property=property.substr(1));i<length;i++)if(candidate=items[i],!mustBeOwnProperty||candidate.hasOwnProperty(property))if(propValue=candidate[property],presenceOnly)result.push(candidate);else if("~="===operator){if(propValue)for(Ext.isArray(propValue)||(propValue=propValue.split(" ")),j=0,propLen=propValue.length;j<propLen;j++)if(domQueryOperators[operator](Ext.coerce(propValue[j],compareTo),compareTo)){result.push(candidate);break}}else(compareTo?domQueryOperators[operator](Ext.coerce(propValue,compareTo),compareTo):!!candidate[property])&&result.push(candidate);return result},filterById=function(items,id){for(var candidate,result=[],i=0,length=items.length;i<length;i++)candidate=items[i],candidate.getItemId()===id&&result.push(candidate);return result},filterByPseudo=function(items,name,value){return cq.pseudos[name](items,value)},modeRe=/^(\s?([>\^])\s?|\s|$)/,tokenRe=/^(#)?([\w\-]+|\*)(?:\((true|false)\))?/,matchers=[{re:/^\.([\w\-]+)(?:\((true|false)\))?/,method:filterByXType},{re:/^(?:\[((?:[@?$])?[\w\-]*)\s*(?:([\^$*~%!]?=)\s*['"]?(.*?)["']?)?\])/,method:filterByAttribute},{re:/^#([\w\-]+)/,method:filterById},{re:/^\:([\w\-]+)(?:\(((?:\{[^\}]+\})|(?:(?!\{)[^\s>\/]*?(?!\})))\))?/,method:filterByPseudo},{re:/^(?:\{([^\}]+)\})/,method:filterFnPattern}];cq.Query=Ext.extend(Object,{constructor:function(cfg){cfg=cfg||{},Ext.apply(this,cfg)},execute:function(root){var operation,workingItems,operations=this.operations,i=0,length=operations.length;for(root?Ext.isIterable(root)?workingItems=root:root.isMixedCollection&&(workingItems=root.items):workingItems=Ext.ComponentManager.all.getArray();i<length;i++)if(operation=operations[i],workingItems="^"===operation.mode?getAncestors(workingItems||[root]):operation.mode?getItems(workingItems||[root],operation.mode):filterItems(workingItems||getItems([root]),operation),i===length-1)return workingItems;return[]},is:function(component){var operation,i,j,mode,items,item,operations=this.operations,len=operations.length,active=[component];for(i=len-1;i>=0;--i)if(operation=operations[i],mode=operation.mode){if("^"===mode)active=getItems(active," ");else if(">"===mode){for(items=[],j=0,len=active.length;j<len;++j)item=active[j].getRefOwner(),item&&items.push(item);active=items}else active=getAncestors(active);if(0===active.length)return!1}else if(active=filterItems(active,operation),0===active.length)return!1;return!0},getMatches:function(components,operations){var i,len=operations.length;for(i=0;i<len&&(components=filterItems(components,operations[i]),0!==components.length);++i);return components}}),Ext.apply(this,{cache:{},pseudos:{not:function(components,selector){for(var component,CQ=Ext.ComponentQuery,i=0,length=components.length,results=[],index=-1;i<length;++i)component=components[i],CQ.is(component,selector)||(results[++index]=component);return results},first:function(components){var ret=[];return components.length>0&&ret.push(components[0]),ret},last:function(components){var len=components.length,ret=[];return len>0&&ret.push(components[len-1]),ret},focusable:function(cmps){for(var c,len=cmps.length,results=[],i=0;i<len;i++)c=cmps[i],c.isFocusable()&&results.push(c);return results},"nth-child":function(c,a){var i,n,nodeIndex,result=[],m=nthRe.exec("even"==a&&"2n"||"odd"==a&&"2n+1"||!nthRe2.test(a)&&"n+"+a||a),f=(m[1]||1)-0,l=m[2]-0;for(i=0;n=c[i];i++)nodeIndex=i+1,1==f?0!=l&&nodeIndex!=l||result.push(n):(nodeIndex+l)%f==0&&result.push(n);return result}},query:function(selector,root){for(var query,resultsLn,cmp,selectors=selector.split(","),length=selectors.length,i=0,results=[],noDupResults=[],dupMatcher={};i<length;i++)selector=Ext.String.trim(selectors[i]),query=this.cache[selector]||(this.cache[selector]=this.parse(selector)),results=results.concat(query.execute(root));if(length>1){for(resultsLn=results.length,i=0;i<resultsLn;i++)cmp=results[i],dupMatcher[cmp.id]||(noDupResults.push(cmp),dupMatcher[cmp.id]=!0);results=noDupResults}return results},is:function(component,selector){if(!selector)return!0;for(var query,selectors=selector.split(","),length=selectors.length,i=0;i<length;i++)if(selector=Ext.String.trim(selectors[i]),query=this.cache[selector]||(this.cache[selector]=this.parse(selector)),query.is(component))return!0;return!1},parse:function(selector){for(var lastSelector,tokenMatch,matchedChar,modeMatch,selectorMatch,i,matcher,method,operations=[],length=matchers.length;selector&&lastSelector!==selector;){for(lastSelector=selector,tokenMatch=selector.match(tokenRe),tokenMatch&&(matchedChar=tokenMatch[1],"#"===matchedChar?operations.push({method:filterById,args:[Ext.String.trim(tokenMatch[2])]}):"."===matchedChar?operations.push({method:filterByClassName,args:[Ext.String.trim(tokenMatch[2])]}):operations.push({method:filterByXType,args:[Ext.String.trim(tokenMatch[2]),Boolean(tokenMatch[3])]}),selector=selector.replace(tokenMatch[0],""));!(modeMatch=selector.match(modeRe));)for(i=0;selector&&i<length;i++){if(matcher=matchers[i],selectorMatch=selector.match(matcher.re),method=matcher.method,selectorMatch){operations.push({method:Ext.isString(matcher.method)?Ext.functionFactory("items",Ext.String.format.apply(Ext.String,[method].concat(selectorMatch.slice(1)))):matcher.method,args:selectorMatch.slice(1)}),selector=selector.replace(selectorMatch[0],"");break}i===length-1&&Ext.Error.raise('Invalid ComponentQuery selector: "'+arguments[0]+'"')}modeMatch[1]&&(operations.push({mode:modeMatch[2]||modeMatch[1]}),selector=selector.replace(modeMatch[0],""))}return new cq.Query({operations:operations})}})}),Ext.define("Ext.util.ProtoElement",function(){var splitWords=Ext.String.splitWords,toMap=Ext.Array.toMap;return{isProtoEl:!0,clsProp:"cls",styleProp:"style",removedProp:"removed",styleIsText:!1,constructor:function(config){var me=this;Ext.apply(me,config),me.classList=splitWords(me.cls),me.classMap=toMap(me.classList),delete me.cls,Ext.isFunction(me.style)?(me.styleFn=me.style,delete me.style):"string"==typeof me.style?me.style=Ext.Element.parseStyles(me.style):me.style&&(me.style=Ext.apply({},me.style))},flush:function(){this.flushClassList=[],this.removedClasses={},delete this.style,delete this.unselectableAttr},addCls:function(cls){for(var c,me=this,add="string"==typeof cls?splitWords(cls):cls,length=add.length,list=me.classList,map=me.classMap,flushList=me.flushClassList,i=0;i<length;++i)c=add[i],map[c]||(map[c]=!0,list.push(c),flushList&&(flushList.push(c),delete me.removedClasses[c]));return me},hasCls:function(cls){return cls in this.classMap},removeCls:function(cls){var i,c,me=this,list=me.classList,newList=me.classList=[],remove=toMap(splitWords(cls)),length=list.length,map=me.classMap,removedClasses=me.removedClasses;for(i=0;i<length;++i)c=list[i],remove[c]?(removedClasses&&map[c]&&(removedClasses[c]=!0,Ext.Array.remove(me.flushClassList,c)),delete map[c]):newList.push(c);return me},setStyle:function(prop,value){var me=this,style=me.style||(me.style={});return"string"==typeof prop?1===arguments.length?me.setStyle(Ext.Element.parseStyles(prop)):style[prop]=value:Ext.apply(style,prop),me},unselectable:function(){this.addCls(Ext.dom.Element.unselectableCls),Ext.isOpera&&(this.unselectableAttr=!0)},writeTo:function(to){var style,me=this,classList=me.flushClassList||me.classList,removedClasses=me.removedClasses;return me.styleFn?(style=Ext.apply({},me.styleFn()),Ext.apply(style,me.style)):style=me.style,to[me.clsProp]=classList.join(" "),style&&(to[me.styleProp]=me.styleIsText?Ext.DomHelper.generateStyles(style,null,!0):style),removedClasses&&(removedClasses=Ext.Object.getKeys(removedClasses),removedClasses.length&&(to[me.removedProp]=removedClasses.join(" "))),me.unselectableAttr&&(to.unselectable="on"),to}}}()),Ext.define("Ext.PluginManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.PluginMgr",singleton:!0,typeName:"ptype",create:function(config,defaultType,host){var result;return config.init?result=config:(host?(config=Ext.apply({},config),config.cmp=host):host=config.cmp,config.xclass?result=Ext.create(config):(result=Ext.ClassManager.getByAlias("plugin."+(config.ptype||defaultType)),"function"==typeof result&&(result=new result(config)))),result&&host&&result.setCmp&&!result.setCmpCalled&&(result.setCmp(host),result.setCmpCalled=!0),result},findByType:function(type,defaultsOnly){var name,item,matches=[],types=this.types;for(name in types)types.hasOwnProperty(name)&&(item=types[name],item.type==type&&(!defaultsOnly||defaultsOnly===!0&&item.isDefault)&&matches.push(item));return matches}},function(){Ext.preg=function(){return Ext.PluginManager.registerType.apply(Ext.PluginManager,arguments)}}),Ext.define("Ext.util.Filter",{id:null,anyMatch:!1,exactMatch:!1,caseSensitive:!1,disabled:!1,operator:null,statics:{createFilterFn:function(filters){return filters&&filters.length?function(candidate){var i,filter,isMatch=!0,length=filters.length;for(i=0;isMatch&&i<length;i++)filter=filters[i],filter.disabled||(isMatch=isMatch&&filter.filterFn.call(filter.scope||filter,candidate));return isMatch}:function(){return!0}}},operatorFns:{"<":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)<this.value},"<=":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)<=this.value},"=":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)==this.value},">=":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)>=this.value},">":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)>this.value},"!=":function(candidate){return Ext.coerce(this.getRoot(candidate)[this.property],this.value)!=this.value}},constructor:function(config){var me=this;me.initialConfig=config,Ext.apply(me,config),me.filter=me.filter||me.filterFn,void 0===me.filter&&me.setValue(config.value)},setValue:function(value){var me=this;me.value=value,void 0===me.property||void 0===me.value||(me.filter=me.createFilterFn()),me.filterFn=me.filter},setFilterFn:function(filterFn){this.filterFn=this.filter=filterFn},createFilterFn:function(){var me=this,matcher=me.createValueMatcher(),property=me.property;return me.operator?me.operatorFns[me.operator]:function(item){var value=me.getRoot(item)[property];return null===matcher?null===value:matcher.test(value)}},getRoot:function(item){var root=this.root;return void 0===root?item:item[root]},createValueMatcher:function(){var me=this,value=me.value,anyMatch=me.anyMatch,exactMatch=me.exactMatch,caseSensitive=me.caseSensitive,escapeRe=Ext.String.escapeRegex;return null===value?value:(value.exec||(value=String(value),anyMatch===!0?value=escapeRe(value):(value="^"+escapeRe(value),exactMatch===!0&&(value+="$")),value=new RegExp(value,caseSensitive?"":"i")),value)},serialize:function(){var me=this,result=Ext.apply({},me.initialConfig);return result.value=me.value,result}},function(){this.prototype.operatorFns["=="]=this.prototype.operatorFns["="]}),Ext.define("Ext.util.AbstractMixedCollection",{mixins:{observable:Ext.util.Observable},isMixedCollection:!0,generation:0,indexGeneration:0,constructor:function(allowFunctions,keyFn){var me=this;1===arguments.length&&Ext.isObject(allowFunctions)?(me.initialConfig=allowFunctions,Ext.apply(me,allowFunctions)):(me.allowFunctions=allowFunctions===!0,keyFn&&(me.getKey=keyFn),me.initialConfig={allowFunctions:me.allowFunctions,getKey:me.getKey}),me.items=[],me.map={},me.keys=[],me.indexMap={},me.length=0,me.mixins.observable.constructor.call(me)},allowFunctions:!1,add:function(key,obj){var out,len=this.length;return out=1===arguments.length?this.insert(len,key):this.insert(len,key,obj)},getKey:function(o){return o.id},replace:function(key,o){var old,index,me=this;return 1==arguments.length&&(o=arguments[0],key=me.getKey(o)),old=me.map[key],"undefined"==typeof key||null===key||"undefined"==typeof old?me.add(key,o):(me.generation++,index=me.indexOfKey(key),me.items[index]=o,me.map[key]=o,me.hasListeners.replace&&me.fireEvent("replace",key,old,o),o)},updateKey:function(oldKey,newKey){var item,me=this,map=me.map,indexMap=me.indexMap,index=me.indexOfKey(oldKey);index>-1&&(item=map[oldKey],delete map[oldKey],delete indexMap[oldKey],map[newKey]=item,indexMap[newKey]=index,me.keys[index]=newKey,me.indexGeneration=++me.generation)},addAll:function(objs){var key,me=this;if(arguments.length>1||Ext.isArray(objs))me.insert(me.length,arguments.length>1?arguments:objs);else for(key in objs)objs.hasOwnProperty(key)&&(me.allowFunctions||"function"!=typeof objs[key])&&me.add(key,objs[key])},each:function(fn,scope){for(var item,items=Ext.Array.push([],this.items),i=0,len=items.length;i<len&&(item=items[i],fn.call(scope||item,item,i,len)!==!1);i++);},eachKey:function(fn,scope){for(var keys=this.keys,items=this.items,i=0,len=keys.length;i<len;i++)fn.call(scope||window,keys[i],items[i],i,len)},findBy:function(fn,scope){for(var keys=this.keys,items=this.items,i=0,len=items.length;i<len;i++)if(fn.call(scope||window,items[i],keys[i]))return items[i];return null},find:function(){return Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.util.MixedCollection: find has been deprecated. Use findBy instead."),this.findBy.apply(this,arguments)},insert:function(index,key,obj){var out;return Ext.isIterable(key)?out=this.doInsert(index,key,obj):(out=arguments.length>2?this.doInsert(index,[key],[obj]):this.doInsert(index,[key]),out=out[0]),out},doInsert:function(index,keys,objects){var itemKey,removeIndex,i,syncIndices,passedDuplicates,oldKeys,oldObjects,me=this,len=keys.length,deDupedLen=len,fireAdd=me.hasListeners.add,newKeys={};if(null!=objects)me.useLinearSearch=!0;else for(objects=keys,keys=new Array(len),i=0;i<len;i++)keys[i]=this.getKey(objects[i]);for(me.suspendEvents(),i=0;i<len;i++)itemKey=keys[i],removeIndex=me.indexOfKey(itemKey),removeIndex!==-1&&(removeIndex<index&&index--,me.removeAt(removeIndex)),null!=itemKey&&(null!=newKeys[itemKey]&&(passedDuplicates=!0,deDupedLen--),
newKeys[itemKey]=i);if(me.resumeEvents(),passedDuplicates){oldKeys=keys,oldObjects=objects,keys=new Array(deDupedLen),objects=new Array(deDupedLen),i=0;for(itemKey in newKeys)keys[i]=oldKeys[newKeys[itemKey]],objects[i]=oldObjects[newKeys[itemKey]],i++;len=deDupedLen}for(syncIndices=index===me.length&&me.indexGeneration===me.generation,Ext.Array.insert(me.items,index,objects),Ext.Array.insert(me.keys,index,keys),me.length+=len,me.generation++,syncIndices&&(me.indexGeneration=me.generation),i=0;i<len;i++,index++)itemKey=keys[i],null!=itemKey&&(me.map[itemKey]=objects[i],syncIndices&&(me.indexMap[itemKey]=index)),fireAdd&&me.fireEvent("add",index,objects[i],itemKey);return objects},remove:function(o){var removeKey,index,me=this;return index=!me.useLinearSearch&&(removeKey=me.getKey(o))?me.indexOfKey(removeKey):Ext.Array.indexOf(me.items,o),index!==-1&&me.removeAt(index)},removeAll:function(items){var i,me=this;if(items||me.hasListeners.remove)if(items)for(i=items.length-1;i>=0;--i)me.remove(items[i]);else for(;me.length;)me.removeAt(0);else me.length=me.items.length=me.keys.length=0,me.map={},me.indexMap={},me.generation++,me.indexGeneration=me.generation},removeAt:function(index){var o,key,me=this;return index<me.length&&index>=0&&(me.length--,o=me.items[index],Ext.Array.erase(me.items,index,1),key=me.keys[index],"undefined"!=typeof key&&delete me.map[key],Ext.Array.erase(me.keys,index,1),me.hasListeners.remove&&me.fireEvent("remove",o,key),me.generation++,o)},removeRange:function(index,removeCount){var o,key,i,limit,syncIndices,trimming,me=this;if(index<me.length&&index>=0){for(removeCount||(removeCount=1),limit=Math.min(index+removeCount,me.length),removeCount=limit-index,trimming=limit===me.length,syncIndices=trimming&&me.indexGeneration===me.generation,i=index;i<limit;i++)key=me.keys[i],null!=key&&(delete me.map[key],syncIndices&&delete me.indexMap[key]);return o=me.items[i-1],me.length-=removeCount,me.generation++,syncIndices&&(me.indexGeneration=me.generation),trimming?me.items.length=me.keys.length=me.length:(me.items.splice(index,removeCount),me.keys.splice(index,removeCount)),o}return!1},removeAtKey:function(key){var i,me=this,keys=me.keys;if(null!=key)return me.removeAt(me.indexOfKey(key));for(i=keys.length-1;i>=0;i--)null==keys[i]&&me.removeAt(i)},getCount:function(){return this.length},indexOf:function(o){var key,me=this;return null!=o?!me.useLinearSearch&&(key=me.getKey(o))?this.indexOfKey(key):Ext.Array.indexOf(me.items,o):-1},indexOfKey:function(key){return this.map.hasOwnProperty(key)?(this.indexGeneration!==this.generation&&this.rebuildIndexMap(),this.indexMap[key]):-1},rebuildIndexMap:function(){var i,me=this,indexMap=me.indexMap={},keys=me.keys,len=keys.length;for(i=0;i<len;i++)indexMap[keys[i]]=i;me.indexGeneration=me.generation},get:function(key){var me=this,mk=me.map[key],item=void 0!==mk?mk:"number"==typeof key?me.items[key]:void 0;return"function"!=typeof item||me.allowFunctions?item:null},getAt:function(index){return this.items[index]},getByKey:function(key){return this.map[key]},contains:function(o){var key,me=this;return null!=o&&(!me.useLinearSearch&&(key=me.getKey(o))?null!=this.map[key]:Ext.Array.indexOf(this.items,o)!==-1)},containsKey:function(key){return this.map.hasOwnProperty(key)},clear:function(){var me=this;me.generation&&(me.length=0,me.items=[],me.keys=[],me.map={},me.indexMap={},me.generation++,me.indexGeneration=me.generation),me.hasListeners.clear&&me.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(property,root,start,end){var i,values=this.extractValues(property,root),length=values.length,sum=0;for(start=start||0,end=end||0===end?end:length-1,i=start;i<=end;i++)sum+=values[i];return sum},collect:function(property,root,allowNull){var value,strValue,i,values=this.extractValues(property,root),length=values.length,hits={},unique=[];for(i=0;i<length;i++)value=values[i],strValue=String(value),!allowNull&&Ext.isEmpty(value)||hits[strValue]||(hits[strValue]=!0,unique.push(value));return unique},extractValues:function(property,root){var values=this.items;return root&&(values=Ext.Array.pluck(values,root)),Ext.Array.pluck(values,property)},hasRange:function(start,end){return end<this.length},getRange:function(start,end){var tmp,reverse,me=this,items=me.items,range=[],len=items.length;return len<1?range:(start>end&&(reverse=!0,tmp=start,start=end,end=tmp),start<0&&(start=0),(null==end||end>=len)&&(end=len-1),range=items.slice(start,end+1),reverse&&range.length&&range.reverse(),range)},filter:function(property,value,anyMatch,caseSensitive){var filters=[];return Ext.isString(property)?filters.push(new Ext.util.Filter({property:property,value:value,anyMatch:anyMatch,caseSensitive:caseSensitive})):(Ext.isArray(property)||property instanceof Ext.util.Filter)&&(filters=filters.concat(property)),this.filterBy(Ext.util.Filter.createFilterFn(filters))},filterBy:function(fn,scope){var i,me=this,newMC=new me.self(me.initialConfig),keys=me.keys,items=me.items,length=items.length;for(newMC.getKey=me.getKey,i=0;i<length;i++)fn.call(scope||me,items[i],keys[i])&&newMC.add(keys[i],items[i]);return newMC.useLinearSearch=me.useLinearSearch,newMC},findIndex:function(property,value,start,anyMatch,caseSensitive){return Ext.isEmpty(value,!1)?-1:(value=this.createValueMatcher(value,anyMatch,caseSensitive),this.findIndexBy(function(o){return o&&value.test(o[property])},null,start))},findIndexBy:function(fn,scope,start){for(var me=this,keys=me.keys,items=me.items,i=start||0,len=items.length;i<len;i++)if(fn.call(scope||me,items[i],keys[i]))return i;return-1},createValueMatcher:function(value,anyMatch,caseSensitive,exactMatch){if(!value.exec){var er=Ext.String.escapeRegex;value=String(value),anyMatch===!0?value=er(value):(value="^"+er(value),exactMatch===!0&&(value+="$")),value=new RegExp(value,caseSensitive?"":"i")}return value},clone:function(){var me=this,copy=new me.self(me.initialConfig);return copy.add(me.keys,me.items),copy.useLinearSearch=me.useLinearSearch,copy}}),Ext.define("Ext.util.Sorter",{direction:"ASC",constructor:function(config){var me=this;Ext.apply(me,config),me.updateSortFunction()},createSortFunction:function(sorterFn){var me=this,direction=me.direction||"ASC",modifier="DESC"==direction.toUpperCase()?-1:1;return function(o1,o2){return modifier*sorterFn.call(me,o1,o2)}},defaultSorterFn:function(o1,o2){var me=this,transform=me.transform,v1=me.getRoot(o1)[me.property],v2=me.getRoot(o2)[me.property];return transform&&(v1=transform(v1),v2=transform(v2)),v1>v2?1:v1<v2?-1:0},getRoot:function(item){return void 0===this.root?item:item[this.root]},setDirection:function(direction){var me=this;me.direction=direction?direction.toUpperCase():direction,me.updateSortFunction()},toggle:function(){var me=this;me.direction=Ext.String.toggle(me.direction,"ASC","DESC"),me.updateSortFunction()},updateSortFunction:function(fn){var me=this;fn=fn||me.sorterFn||me.defaultSorterFn,me.sort=me.createSortFunction(fn)},serialize:function(){return{root:this.root,property:this.property,direction:this.direction}}}),Ext.define("Ext.util.Sortable",{isSortable:!0,defaultSortDirection:"ASC",statics:{createComparator:function(sorters){return sorters&&sorters.length?function(r1,r2){for(var result=sorters[0].sort(r1,r2),length=sorters.length,i=1;i<length;i++)result=result||sorters[i].sort.call(this,r1,r2);return result}:function(){return 0}}},initSortable:function(){var me=this,sorters=me.sorters;me.sorters=new Ext.util.AbstractMixedCollection((!1),function(item){return item.id||item.property}),sorters&&me.sorters.addAll(me.decodeSorters(sorters))},sort:function(sorters,direction,where,doSort){var sorter,newSorters,me=this;return Ext.isArray(sorters)?(doSort=where,where=direction,newSorters=sorters):Ext.isObject(sorters)?(doSort=where,where=direction,newSorters=[sorters]):Ext.isString(sorters)&&(sorter=me.sorters.get(sorters),sorter?void 0===direction?sorter.toggle():sorter.setDirection(direction):(sorter={property:sorters,direction:direction},newSorters=[sorter])),newSorters&&newSorters.length&&(newSorters=me.decodeSorters(newSorters),Ext.isString(where)?"prepend"===where?me.sorters.insert(0,newSorters):me.sorters.addAll(newSorters):(me.sorters.clear(),me.sorters.addAll(newSorters))),doSort!==!1&&(me.fireEvent("beforesort",me,newSorters),me.onBeforeSort(newSorters),sorters=me.sorters.items,sorters.length&&me.doSort(me.generateComparator())),sorters},generateComparator:function(){var sorters=this.sorters.getRange();return sorters.length?this.createComparator(sorters):this.emptyComparator},emptyComparator:function(){return 0},onBeforeSort:Ext.emptyFn,decodeSorters:function(sorters){Ext.isArray(sorters)||(sorters=void 0===sorters?[]:[sorters]);var field,config,i,length=sorters.length,Sorter=Ext.util.Sorter,fields=this.model?this.model.prototype.fields:null;for(i=0;i<length;i++)config=sorters[i],config instanceof Sorter||(Ext.isString(config)&&(config={property:config}),Ext.applyIf(config,{root:this.sortRoot,direction:"ASC"}),config.fn&&(config.sorterFn=config.fn),"function"==typeof config&&(config={sorterFn:config}),fields&&!config.transform&&(field=fields.get(config.property),config.transform=field&&field.sortType!==Ext.identityFn?field.sortType:void 0),sorters[i]=new Ext.util.Sorter(config));return sorters},getSorters:function(){return this.sorters.items},getFirstSorter:function(){for(var sorter,sorters=this.sorters.items,len=sorters.length,i=0;i<len;++i)if(sorter=sorters[i],!sorter.isGrouper)return sorter;return null}},function(){this.prototype.createComparator=this.createComparator}),Ext.define("Ext.util.MixedCollection",{extend:Ext.util.AbstractMixedCollection,mixins:{sortable:Ext.util.Sortable},constructor:function(){var me=this;me.callParent(arguments),me.addEvents("sort"),me.mixins.sortable.initSortable.call(me)},doSort:function(sorterFn){this.sortBy(sorterFn)},_sort:function(property,dir,fn){var i,len,o,me=this,dsc="DESC"==String(dir).toUpperCase()?-1:1,c=[],keys=me.keys,items=me.items;for(fn=fn||function(a,b){return a-b},i=0,len=items.length;i<len;i++)c[c.length]={key:keys[i],value:items[i],index:i};for(Ext.Array.sort(c,function(a,b){return fn(a[property],b[property])*dsc||(a.index<b.index?-1:1)}),i=0,len=c.length;i<len;i++)o=c[i],items[i]=o.value,keys[i]=o.key,me.indexMap[o.key]=i;me.generation++,me.indexGeneration=me.generation,me.fireEvent("sort",me)},sortBy:function(sorterFn){var item,key,i,me=this,items=me.items,keys=me.keys,length=items.length;for(i=0;i<length;i++)items[i].$extCollectionIndex=i;for(Ext.Array.sort(items,function(a,b){return sorterFn(a,b)||(a.$extCollectionIndex<b.$extCollectionIndex?-1:1)}),i=0;i<length;i++)item=items[i],key=me.getKey(item),keys[i]=key,me.indexMap[key]=i,delete items.$extCollectionIndex;me.generation++,me.indexGeneration=me.generation,me.fireEvent("sort",me,items,keys)},findInsertionIndex:function(newItem,sorterFn){var middle,comparison,me=this,items=me.items,start=0,end=items.length-1;for(sorterFn||(sorterFn=me.generateComparator());start<=end;)middle=start+end>>1,comparison=sorterFn(newItem,items[middle]),comparison>=0?start=middle+1:comparison<0&&(end=middle-1);return start},reorder:function(mapping){var oldIndex,me=this,items=me.items,index=0,length=items.length,order=[],remaining=[];me.suspendEvents();for(oldIndex in mapping)order[mapping[oldIndex]]=items[oldIndex];for(index=0;index<length;index++)void 0==mapping[index]&&remaining.push(items[index]);for(index=0;index<length;index++)void 0==order[index]&&(order[index]=remaining.shift());me.clear(),me.addAll(order),me.resumeEvents(),me.fireEvent("sort",me)},sortByKey:function(dir,fn){this._sort("key",dir,fn||function(a,b){var v1=String(a).toUpperCase(),v2=String(b).toUpperCase();return v1>v2?1:v1<v2?-1:0})}}),Ext.define("Ext.fx.target.Target",{isAnimTarget:!0,constructor:function(target){this.target=target,this.id=this.getId()},getId:function(){return this.target.id},remove:function(){Ext.destroy(this.target)}}),Ext.define("Ext.fx.target.Element",{extend:Ext.fx.target.Target,type:"element",getElVal:function(el,attr,val){return void 0==val&&(val="x"===attr?el.getX():"y"===attr?el.getY():"scrollTop"===attr?el.getScroll().top:"scrollLeft"===attr?el.getScroll().left:"height"===attr?el.getHeight():"width"===attr?el.getWidth():el.getStyle(attr)),val},getAttr:function(attr,val){var el=this.target;return[[el,this.getElVal(el,attr,val)]]},setAttr:function(targetData){var attrs,attr,o,i,j,ln2,ln=(this.target,targetData.length);for(i=0;i<ln;i++){attrs=targetData[i].attrs;for(attr in attrs)if(attrs.hasOwnProperty(attr))for(ln2=attrs[attr].length,j=0;j<ln2;j++)o=attrs[attr][j],this.setElVal(o[0],attr,o[1])}},setElVal:function(element,attr,value){"x"===attr?element.setX(value):"y"===attr?element.setY(value):"scrollTop"===attr?element.scrollTo("top",value):"scrollLeft"===attr?element.scrollTo("left",value):"width"===attr?element.setWidth(value):"height"===attr?element.setHeight(value):element.setStyle(attr,value)}}),Ext.define("Ext.fx.target.ElementCSS",{extend:Ext.fx.target.Element,setAttr:function(targetData,isFirstFrame){var attributes,attrs,attr,easing,duration,o,i,j,ln2,cssArr={attrs:[],duration:[],easing:[]},ln=targetData.length;for(i=0;i<ln;i++){attrs=targetData[i],duration=attrs.duration,easing=attrs.easing,attrs=attrs.attrs;for(attr in attrs)Ext.Array.indexOf(cssArr.attrs,attr)==-1&&(cssArr.attrs.push(attr.replace(/[A-Z]/g,function(v){return"-"+v.toLowerCase()})),cssArr.duration.push(duration+"ms"),cssArr.easing.push(easing))}for(attributes=cssArr.attrs.join(","),duration=cssArr.duration.join(","),easing=cssArr.easing.join(", "),i=0;i<ln;i++){attrs=targetData[i].attrs;for(attr in attrs)for(ln2=attrs[attr].length,j=0;j<ln2;j++)o=attrs[attr][j],o[0].setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",isFirstFrame?"":attributes),o[0].setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",isFirstFrame?"":duration),o[0].setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",isFirstFrame?"":easing),o[0].setStyle(attr,o[1]),isFirstFrame?o=o[0].dom.offsetWidth:o[0].on(Ext.supports.CSS3TransitionEnd,function(){this.setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",null),this.setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",null),this.setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",null)},o[0],{single:!0})}}}),Ext.define("Ext.fx.target.CompositeElement",{extend:Ext.fx.target.Element,isComposite:!0,constructor:function(target){target.id=target.id||Ext.id(null,"ext-composite-"),this.callParent([target])},getAttr:function(attr,val){var i,el,out=[],target=this.target,elements=target.elements,length=elements.length;for(i=0;i<length;i++)el=elements[i],el&&(el=target.getElement(el),out.push([el,this.getElVal(el,attr,val)]));return out},setAttr:function(targetData){var value,k,attrs,attr,i,j,ln2,target=this.target,ln=targetData.length,elements=target.elements,ln3=elements.length;for(i=0;i<ln;i++){attrs=targetData[i].attrs;for(attr in attrs)if(attrs.hasOwnProperty(attr))for(ln2=attrs[attr].length,j=0;j<ln2;j++)for(value=attrs[attr][j][1],k=0;k<ln3;++k)el=elements[k],el&&(el=target.getElement(el),this.setElVal(el,attr,value))}},remove:function(){this.target.remove()}}),Ext.define("Ext.fx.target.CompositeElementCSS",{extend:Ext.fx.target.CompositeElement,setAttr:function(){return Ext.fx.target.ElementCSS.prototype.setAttr.apply(this,arguments)}}),Ext.define("Ext.fx.target.Sprite",{extend:Ext.fx.target.Target,type:"draw",getFromPrim:function(sprite,attr){var obj;switch(attr){case"rotate":case"rotation":return obj=sprite.attr.rotation,{x:obj.x||0,y:obj.y||0,degrees:obj.degrees||0};case"scale":case"scaling":return obj=sprite.attr.scaling,{x:obj.x||1,y:obj.y||1,cx:obj.cx||0,cy:obj.cy||0};case"translate":case"translation":return obj=sprite.attr.translation,{x:obj.x||0,y:obj.y||0};default:return sprite.attr[attr]}},getAttr:function(attr,val){return[[this.target,void 0!=val?val:this.getFromPrim(this.target,attr)]]},setAttr:function(targetData){var attrsConf,attr,attrArr,attrs,sprite,idx,value,i,j,x,y,ln2,ln=targetData.length,spriteArr=[];for(i=0;i<ln;i++){attrsConf=targetData[i].attrs;for(attr in attrsConf)for(attrArr=attrsConf[attr],ln2=attrArr.length,j=0;j<ln2;j++)sprite=attrArr[j][0],attrs=attrArr[j][1],"translate"===attr||"translation"===attr?value={x:attrs.x,y:attrs.y}:"rotate"===attr||"rotation"===attr?(x=attrs.x,isNaN(x)&&(x=null),y=attrs.y,isNaN(y)&&(y=null),value={degrees:attrs.degrees,x:x,y:y}):"scale"===attr||"scaling"===attr?(x=attrs.x,isNaN(x)&&(x=null),y=attrs.y,isNaN(y)&&(y=null),value={x:x,y:y,cx:attrs.cx,cy:attrs.cy}):value="width"===attr||"height"===attr||"x"===attr||"y"===attr?parseFloat(attrs):attrs,idx=Ext.Array.indexOf(spriteArr,sprite),idx==-1&&(spriteArr.push([sprite,{}]),idx=spriteArr.length-1),spriteArr[idx][1][attr]=value}for(ln=spriteArr.length,i=0;i<ln;i++)spriteArr[i][0].setAttributes(spriteArr[i][1]);this.target.redraw()}}),Ext.define("Ext.fx.target.CompositeSprite",{extend:Ext.fx.target.Sprite,getAttr:function(attr,val){var i,sprite,out=[],sprites=[].concat(this.target.items),length=sprites.length;for(i=0;i<length;i++)sprite=sprites[i],out.push([sprite,void 0!=val?val:this.getFromPrim(sprite,attr)]);return out}}),Ext.define("Ext.fx.target.Component",{extend:Ext.fx.target.Target,type:"component",getPropMethod:{top:function(){return this.getPosition(!0)[1]},left:function(){return this.getPosition(!0)[0]},x:function(){return this.getPosition()[0]},y:function(){return this.getPosition()[1]},height:function(){return this.getHeight()},width:function(){return this.getWidth()},opacity:function(){return this.el.getStyle("opacity")}},setMethods:{top:"setPosition",left:"setPosition",x:"setPagePosition",y:"setPagePosition",height:"setSize",width:"setSize",opacity:"setOpacity"},getAttr:function(attr,val){return[[this.target,void 0!==val?val:this.getPropMethod[attr].call(this.target)]]},setAttr:function(targetData,isFirstFrame,isLastFrame){var attrs,attr,o,i,j,targets,left,top,w,h,methodProps,me=this,ln=targetData.length,methodsToCall={};for(i=0;i<ln;i++){attrs=targetData[i].attrs;for(attr in attrs)for(targets=attrs[attr].length,j=0;j<targets;j++)o=attrs[attr][j],methodProps=methodsToCall[me.setMethods[attr]]||(methodsToCall[me.setMethods[attr]]={}),methodProps.target=o[0],methodProps[attr]=o[1];methodsToCall.setPosition&&(o=methodsToCall.setPosition,left=void 0===o.left?void 0:parseFloat(o.left),top=void 0===o.top?void 0:parseFloat(o.top),o.target.setPosition(left,top)),methodsToCall.setPagePosition&&(o=methodsToCall.setPagePosition,o.target.setPagePosition(o.x,o.y)),methodsToCall.setSize&&(o=methodsToCall.setSize,w=void 0===o.width?o.target.getWidth():parseFloat(o.width),h=void 0===o.height?o.target.getHeight():parseFloat(o.height),o.target.el.setSize(w,h),(isLastFrame||me.dynamic)&&Ext.globalEvents.on({idle:Ext.Function.bind(o.target.setSize,o.target,[w,h]),single:!0})),methodsToCall.setOpacity&&(o=methodsToCall.setOpacity,o.target.el.setStyle("opacity",o.opacity))}}}),Ext.define("Ext.fx.Queue",{constructor:function(){this.targets=new Ext.util.HashMap,this.fxQueue={}},getFxDefaults:function(targetId){var target=this.targets.get(targetId);return target?target.fxDefaults:{}},setFxDefaults:function(targetId,obj){var target=this.targets.get(targetId);target&&(target.fxDefaults=Ext.apply(target.fxDefaults||{},obj))},stopAnimation:function(targetId){for(var me=this,queue=me.getFxQueue(targetId),ln=queue.length;ln;)queue[ln-1].end(),ln--},getActiveAnimation:function(targetId){var queue=this.getFxQueue(targetId);return!(!queue||!queue.length)&&queue[0]},hasFxBlock:function(targetId){var queue=this.getFxQueue(targetId);return queue&&queue[0]&&queue[0].block},getFxQueue:function(targetId){if(!targetId)return!1;var me=this,queue=me.fxQueue[targetId],target=me.targets.get(targetId);return!!target&&(queue||(me.fxQueue[targetId]=[],"element"!=target.type&&target.target.on("destroy",function(){me.fxQueue[targetId]=[]})),me.fxQueue[targetId])},queueFx:function(anim){var queue,ln,me=this,target=anim.target;target&&(queue=me.getFxQueue(target.getId()),ln=queue.length,ln?anim.concurrent?anim.paused=!1:queue[ln-1].on("afteranimate",function(){anim.paused=!1}):anim.paused=!1,anim.on("afteranimate",function(){if(Ext.Array.remove(queue,anim),0===queue.length&&me.targets.remove(anim.target),anim.remove&&"element"==target.type){var el=Ext.get(target.id);el&&el.remove()}},me,{single:!0}),queue.push(anim))}}),Ext.define("Ext.fx.Manager",{singleton:!0,mixins:{queue:Ext.fx.Queue},constructor:function(){var me=this;me.items=new Ext.util.MixedCollection,me.targetArr={},me.mixins.queue.constructor.call(me),me.taskRunner=new Ext.util.TaskRunner},interval:16,forceJS:!0,createTarget:function(target){var targetObj,me=this,useCSS3=!me.forceJS&&Ext.supports.Transitions;if(me.useCSS3=useCSS3,target){if(target.tagName||Ext.isString(target)||target.isFly)target=Ext.get(target),targetObj=new Ext.fx.target["Element"+(useCSS3?"CSS":"")](target);else if(target.dom)targetObj=new Ext.fx.target["Element"+(useCSS3?"CSS":"")](target);else if(target.isComposite)targetObj=new Ext.fx.target["CompositeElement"+(useCSS3?"CSS":"")](target);else if(target.isSprite)targetObj=new Ext.fx.target.Sprite(target);else if(target.isCompositeSprite)targetObj=new Ext.fx.target.CompositeSprite(target);else{if(!target.isComponent)return target.isAnimTarget?target:null;targetObj=new Ext.fx.target.Component(target)}return me.targets.add(targetObj),targetObj}return null},addAnim:function(anim){var me=this,items=me.items,task=me.task;items.add(anim.id,anim),!task&&items.length&&(task=me.task={run:me.runner,interval:me.interval,scope:me},me.taskRunner.start(task))},removeAnim:function(anim){var me=this,items=me.items,task=me.task;items.removeAtKey(anim.id),task&&!items.length&&(me.taskRunner.stop(task),delete me.task)},runner:function(){var anim,me=this,items=me.items.getRange(),i=0,len=items.length;for(me.targetArr={},me.timestamp=new Date;i<len;i++)anim=items[i],anim.isReady()&&me.startAnim(anim);for(i=0;i<len;i++)anim=items[i],anim.isRunning()&&me.runAnim(anim);me.applyPendingAttrs()},startAnim:function(anim){anim.start(this.timestamp)},runAnim:function(anim,forceEnd){if(anim){var target,o,me=this,useCSS3=me.useCSS3&&"element"==anim.target.type,elapsedTime=me.timestamp-anim.startTime,lastFrame=elapsedTime>=anim.duration;return forceEnd&&(elapsedTime=anim.duration,lastFrame=!0),target=this.collectTargetData(anim,elapsedTime,useCSS3,lastFrame),useCSS3&&(anim.target.setAttr(target.anims[anim.id].attributes,!0),me.collectTargetData(anim,anim.duration,useCSS3,lastFrame),anim.paused=!0,target=anim.target.target,anim.target.isComposite&&(target=anim.target.target.last()),o={},o[Ext.supports.CSS3TransitionEnd]=anim.lastFrame,o.scope=anim,o.single=!0,target.on(o)),target}},jumpToEnd:function(anim){var target=this.runAnim(anim,!0);this.applyAnimAttrs(target,target.anims[anim.id])},collectTargetData:function(anim,elapsedTime,useCSS3,isLastFrame){var targetId=anim.target.getId(),target=this.targetArr[targetId];return target||(target=this.targetArr[targetId]={id:targetId,el:anim.target,anims:{}}),target.anims[anim.id]={id:anim.id,anim:anim,elapsed:elapsedTime,isLastFrame:isLastFrame,attributes:[{duration:anim.duration,easing:useCSS3&&anim.reverse?anim.easingFn.reverse().toCSS3():anim.easing,attrs:anim.runAnim(elapsedTime)}]},target},applyAnimAttrs:function(target,animWrap){var anim=animWrap.anim;animWrap.attributes&&anim.isRunning()&&(target.el.setAttr(animWrap.attributes,!1,animWrap.isLastFrame),animWrap.isLastFrame&&anim.lastFrame())},applyPendingAttrs:function(){var target,targetId,animWrap,anim,animId,targetArr=this.targetArr;for(targetId in targetArr)if(targetArr.hasOwnProperty(targetId)){target=targetArr[targetId];for(animId in target.anims)target.anims.hasOwnProperty(animId)&&(animWrap=target.anims[animId],anim=animWrap.anim,animWrap.attributes&&anim.isRunning()&&(target.el.setAttr(animWrap.attributes,!1,animWrap.isLastFrame),animWrap.isLastFrame&&anim.lastFrame()))}}}),Ext.define("Ext.fx.Animator",{mixins:{observable:Ext.util.Observable},isAnimator:!0,duration:250,delay:0,delayStart:0,dynamic:!1,easing:"ease",running:!1,paused:!1,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(config){var me=this;config=Ext.apply(me,config||{}),me.config=config,me.id=Ext.id(null,"ext-animator-"),me.addEvents("beforeanimate","keyframe","afteranimate"),me.mixins.observable.constructor.call(me,config),me.timeline=[],me.createTimeline(me.keyframes),me.target&&(me.applyAnimator(me.target),Ext.fx.Manager.addAnim(me))},sorter:function(a,b){return a.pct-b.pct},createTimeline:function(keyframes){var prevMs,ms,i,ln,pct,attr,me=this,attrs=[],to=me.to||{},duration=me.duration;for(pct in keyframes)keyframes.hasOwnProperty(pct)&&me.animKeyFramesRE.test(pct)&&(attr={attrs:Ext.apply(keyframes[pct],to)},"from"==pct?pct=0:"to"==pct&&(pct=100),attr.pct=parseInt(pct,10),attrs.push(attr));for(Ext.Array.sort(attrs,me.sorter),ln=attrs.length,i=0;i<ln;i++)prevMs=attrs[i-1]?duration*(attrs[i-1].pct/100):0,ms=duration*(attrs[i].pct/100),me.timeline.push({duration:ms-prevMs,attrs:attrs[i].attrs})},applyAnimator:function(target){var anim,easing,damper,attrs,i,me=this,anims=[],timeline=me.timeline,ln=timeline.length;if(me.fireEvent("beforeanimate",me)!==!1){for(i=0;i<ln;i++)anim=timeline[i],attrs=anim.attrs,easing=attrs.easing||me.easing,damper=attrs.damper||me.damper,delete attrs.easing,delete attrs.damper,anim=new Ext.fx.Anim({target:target,easing:easing,damper:damper,duration:anim.duration,paused:!0,to:attrs}),anims.push(anim);for(me.animations=anims,me.target=anim.target,i=0;i<ln-1;i++)anim=anims[i],anim.nextAnim=anims[i+1],anim.on("afteranimate",function(){this.nextAnim.paused=!1}),anim.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},me);anims[ln-1].on("afteranimate",function(){this.lastFrame()},me)}},start:function(startTime){var delayDelta,me=this,delay=me.delay,delayStart=me.delayStart;if(delay){if(!delayStart)return void(me.delayStart=startTime);if(delayDelta=startTime-delayStart,delayDelta<delay)return;startTime=new Date(delayStart.getTime()+delay)}me.fireEvent("beforeanimate",me)!==!1&&(me.startTime=startTime,me.running=!0,me.animations[me.keyframeStep].paused=!1)},lastFrame:function(){var me=this,iter=me.iterations,iterCount=me.currentIteration;iterCount++,iterCount<iter?(me.startTime=new Date,me.currentIteration=iterCount,me.keyframeStep=0,me.applyAnimator(me.target),me.animations[me.keyframeStep].paused=!1):(me.currentIteration=0,me.end())},end:function(){var me=this;me.fireEvent("afteranimate",me,me.startTime,new Date-me.startTime)},isReady:function(){return this.paused===!1&&this.running===!1&&this.iterations>0},isRunning:function(){return!1}}),Ext.define("Ext.fx.CubicBezier",{singleton:!0,cubicBezierAtTime:function(t,p1x,p1y,p2x,p2y,duration){function sampleCurveX(t){return((ax*t+bx)*t+cx)*t}function solve(x,epsilon){var t=solveCurveX(x,epsilon);return((ay*t+by)*t+cy)*t}function solveCurveX(x,epsilon){var t0,t1,t2,x2,d2,i;for(t2=x,i=0;i<8;i++){if(x2=sampleCurveX(t2)-x,Math.abs(x2)<epsilon)return t2;if(d2=(3*ax*t2+2*bx)*t2+cx,Math.abs(d2)<1e-6)break;t2-=x2/d2}if(t0=0,t1=1,t2=x,t2<t0)return t0;if(t2>t1)return t1;for(;t0<t1;){if(x2=sampleCurveX(t2),Math.abs(x2-x)<epsilon)return t2;x>x2?t0=t2:t1=t2,t2=(t1-t0)/2+t0}return t2}var cx=3*p1x,bx=3*(p2x-p1x)-cx,ax=1-cx-bx,cy=3*p1y,by=3*(p2y-p1y)-cy,ay=1-cy-by;return solve(t,1/(200*duration))},cubicBezier:function(x1,y1,x2,y2){var fn=function(pos){return Ext.fx.CubicBezier.cubicBezierAtTime(pos,x1,y1,x2,y2,1)};return fn.toCSS3=function(){return"cubic-bezier("+[x1,y1,x2,y2].join(",")+")"},fn.reverse=function(){return Ext.fx.CubicBezier.cubicBezier(1-x2,1-y2,1-x1,1-y1)},fn}}),Ext.require("Ext.fx.CubicBezier",function(){var math=Math,pi=math.PI,pow=math.pow,sin=math.sin,sqrt=math.sqrt,abs=math.abs,backInSeed=1.70158;Ext.define("Ext.fx.Easing",{singleton:!0,linear:Ext.identityFn,ease:function(n){var q=.07813-n/2,Q=sqrt(.0066+q*q),x=Q-q,X=pow(abs(x),1/3)*(x<0?-1:1),y=-Q-q,Y=pow(abs(y),1/3)*(y<0?-1:1),t=X+Y+.25;return 3*pow(1-t,2)*t*.1+3*(1-t)*t*t+t*t*t},easeIn:function(n){return pow(n,1.7)},easeOut:function(n){return pow(n,.48)},easeInOut:function(n){var q=.48-n/1.04,Q=sqrt(.1734+q*q),x=Q-q,X=pow(abs(x),1/3)*(x<0?-1:1),y=-Q-q,Y=pow(abs(y),1/3)*(y<0?-1:1),t=X+Y+.5;return 3*(1-t)*t*t+t*t*t},backIn:function(n){return n*n*((backInSeed+1)*n-backInSeed)},backOut:function(n){return n-=1,n*n*((backInSeed+1)*n+backInSeed)+1},elasticIn:function(n){if(0===n||1===n)return n;var p=.3,s=p/4;return pow(2,-10*n)*sin((n-s)*(2*pi)/p)+1},elasticOut:function(n){return 1-Ext.fx.Easing.elasticIn(1-n)},bounceIn:function(n){return 1-Ext.fx.Easing.bounceOut(1-n)},bounceOut:function(n){var l,s=7.5625,p=2.75;return n<1/p?l=s*n*n:n<2/p?(n-=1.5/p,l=s*n*n+.75):n<2.5/p?(n-=2.25/p,l=s*n*n+.9375):(n-=2.625/p,l=s*n*n+.984375),l}},function(){var easing=Ext.fx.Easing.self,proto=easing.prototype;easing.implement({"back-in":proto.backIn,"back-out":proto.backOut,"ease-in":proto.easeIn,"ease-out":proto.easeOut,"elastic-in":proto.elasticIn,"elastic-out":proto.elasticOut,"bounce-in":proto.bounceIn,"bounce-out":proto.bounceOut,"ease-in-out":proto.easeInOut})})}),Ext.define("Ext.draw.Color",{colorToHexRe:/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/,rgbRe:/\s*rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)\s*/,hexRe:/\s*#([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/,lightnessFactor:.2,constructor:function(red,green,blue){var me=this,clamp=Ext.Number.constrain;me.r=clamp(red,0,255),me.g=clamp(green,0,255),me.b=clamp(blue,0,255)},getRed:function(){return this.r},getGreen:function(){return this.g},getBlue:function(){return this.b},getRGB:function(){var me=this;return[me.r,me.g,me.b]},getHSL:function(){var h,me=this,r=me.r/255,g=me.g/255,b=me.b/255,max=Math.max(r,g,b),min=Math.min(r,g,b),delta=max-min,s=0,l=.5*(max+min);return min!=max&&(s=l<.5?delta/(max+min):delta/(2-max-min),h=r==max?60*(g-b)/delta:g==max?120+60*(b-r)/delta:240+60*(r-g)/delta,h<0&&(h+=360),h>=360&&(h-=360)),[h,s,l]},getLighter:function(factor){var hsl=this.getHSL();return factor=factor||this.lightnessFactor,hsl[2]=Ext.Number.constrain(hsl[2]+factor,0,1),this.fromHSL(hsl[0],hsl[1],hsl[2])},getDarker:function(factor){return factor=factor||this.lightnessFactor,this.getLighter(-factor)},toString:function(){var me=this,round=Math.round,r=round(me.r).toString(16),g=round(me.g).toString(16),b=round(me.b).toString(16);return r=1==r.length?"0"+r:r,g=1==g.length?"0"+g:g,b=1==b.length?"0"+b:b,["#",r,g,b].join("")},toHex:function(color){if(Ext.isArray(color)&&(color=color[0]),!Ext.isString(color))return"";if("#"===color.substr(0,1))return color;var red,green,blue,rgb,digits=this.colorToHexRe.exec(color);return Ext.isArray(digits)?(red=parseInt(digits[2],10),green=parseInt(digits[3],10),blue=parseInt(digits[4],10),rgb=blue|green<<8|red<<16,digits[1]+"#"+("000000"+rgb.toString(16)).slice(-6)):color},fromString:function(str){var values,r,g,b,colorValue,parse=parseInt,firstChar=str.substr(0,1);return"#"!=firstChar&&(colorValue=Ext.draw.Color.cssColors[str],colorValue&&(str=colorValue,firstChar=str.substr(0,1))),4!=str.length&&7!=str.length||"#"!==firstChar?(values=str.match(this.rgbRe),values&&(r=values[1],g=values[2],b=values[3])):(values=str.match(this.hexRe),values&&(r=parse(values[1],16)>>0,g=parse(values[2],16)>>0,b=parse(values[3],16)>>0,4==str.length&&(r+=16*r,g+=16*g,b+=16*b))),"undefined"==typeof r?void 0:new Ext.draw.Color(r,g,b)},getGrayscale:function(){return.3*this.r+.59*this.g+.11*this.b},fromHSL:function(h,s,l){var C,X,m,rgb=[],abs=Math.abs,floor=Math.floor;if(0==s||null==h)rgb=[l,l,l];else{switch(h/=60,C=s*(1-abs(2*l-1)),X=C*(1-abs(h-2*floor(h/2)-1)),m=l-C/2,floor(h)){case 0:rgb=[C,X,0];break;case 1:rgb=[X,C,0];break;case 2:rgb=[0,C,X];break;case 3:rgb=[0,X,C];break;case 4:rgb=[X,0,C];break;case 5:rgb=[C,0,X]}rgb=[rgb[0]+m,rgb[1]+m,rgb[2]+m];
}return new Ext.draw.Color(255*rgb[0],255*rgb[1],255*rgb[2])}},function(){var prototype=this.prototype;this.addStatics({fromHSL:function(){return prototype.fromHSL.apply(prototype,arguments)},fromString:function(){return prototype.fromString.apply(prototype,arguments)},toHex:function(){return prototype.toHex.apply(prototype,arguments)},cssColors:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"}})}),Ext.define("Ext.draw.Draw",{singleton:!0,pathToStringRE:/,?([achlmqrstvxz]),?/gi,pathCommandRE:/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,pathValuesRE:/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,stopsRE:/^(\d+%?)$/,radian:Math.PI/180,availableAnimAttrs:{along:"along",blur:null,"clip-rect":"csv",cx:null,cy:null,fill:"color","fill-opacity":null,"font-size":null,height:null,opacity:null,path:"path",r:null,rotation:"csv",rx:null,ry:null,scale:"csv",stroke:"color","stroke-opacity":null,"stroke-width":null,translation:"csv",width:null,x:null,y:null},is:function(o,type){return type=String(type).toLowerCase(),"object"==type&&o===Object(o)||"undefined"==type&&typeof o==type||"null"==type&&null===o||"array"==type&&Array.isArray&&Array.isArray(o)||Object.prototype.toString.call(o).toLowerCase().slice(8,-1)==type},ellipsePath:function(sprite){var attr=sprite.attr;return Ext.String.format("M{0},{1}A{2},{3},0,1,1,{0},{4}A{2},{3},0,1,1,{0},{1}z",attr.x,attr.y-attr.ry,attr.rx,attr.ry,attr.y+attr.ry)},rectPath:function(sprite){var attr=sprite.attr;return attr.radius?Ext.String.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",attr.x+attr.radius,attr.y,attr.width-2*attr.radius,attr.radius,-attr.radius,attr.height-2*attr.radius,2*attr.radius-attr.width,2*attr.radius-attr.height):Ext.String.format("M{0},{1}L{2},{1},{2},{3},{0},{3}z",attr.x,attr.y,attr.width+attr.x,attr.height+attr.y)},path2string:function(){return this.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},pathToString:function(arrayPath){return arrayPath.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},parsePathString:function(pathString){if(!pathString)return null;var paramCounts={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},data=[],me=this;return me.is(pathString,"array")&&me.is(pathString[0],"array")&&(data=me.pathClone(pathString)),data.length||String(pathString).replace(me.pathCommandRE,function(a,b,c){var params=[],name=b.toLowerCase();for(c.replace(me.pathValuesRE,function(a,b){b&&params.push(+b)}),"m"==name&&params.length>2&&(data.push([b].concat(Ext.Array.splice(params,0,2))),name="l",b="m"==b?"l":"L");params.length>=paramCounts[name]&&(data.push([b].concat(Ext.Array.splice(params,0,paramCounts[name]))),paramCounts[name]););}),data.toString=me.path2string,data},mapPath:function(path,matrix){if(!matrix)return path;var x,y,i,ii,j,jj,pathi;for(path=this.path2curve(path),i=0,ii=path.length;i<ii;i++)for(pathi=path[i],j=1,jj=pathi.length;j<jj-1;j+=2)x=matrix.x(pathi[j],pathi[j+1]),y=matrix.y(pathi[j],pathi[j+1]),pathi[j]=x,pathi[j+1]=y;return path},pathClone:function(pathArray){var j,jj,i,ii,res=[];for(this.is(pathArray,"array")&&this.is(pathArray&&pathArray[0],"array")||(pathArray=this.parsePathString(pathArray)),i=0,ii=pathArray.length;i<ii;i++)for(res[i]=[],j=0,jj=pathArray[i].length;j<jj;j++)res[i][j]=pathArray[i][j];return res.toString=this.path2string,res},pathToAbsolute:function(pathArray){this.is(pathArray,"array")&&this.is(pathArray&&pathArray[0],"array")||(pathArray=this.parsePathString(pathArray));var r,pathSegment,j,ln2,res=[],x=0,y=0,mx=0,my=0,i=0,ln=pathArray.length;for(ln&&"M"==pathArray[0][0]&&(x=+pathArray[0][1],y=+pathArray[0][2],mx=x,my=y,i++,res[0]=["M",x,y]);i<ln;i++){if(r=res[i]=[],pathSegment=pathArray[i],pathSegment[0]!=pathSegment[0].toUpperCase())switch(r[0]=pathSegment[0].toUpperCase(),r[0]){case"A":r[1]=pathSegment[1],r[2]=pathSegment[2],r[3]=pathSegment[3],r[4]=pathSegment[4],r[5]=pathSegment[5],r[6]=+(pathSegment[6]+x),r[7]=+(pathSegment[7]+y);break;case"V":r[1]=+pathSegment[1]+y;break;case"H":r[1]=+pathSegment[1]+x;break;case"M":mx=+pathSegment[1]+x,my=+pathSegment[2]+y;default:for(j=1,ln2=pathSegment.length;j<ln2;j++)r[j]=+pathSegment[j]+(j%2?x:y)}else for(j=0,ln2=pathSegment.length;j<ln2;j++)res[i][j]=pathSegment[j];switch(r[0]){case"Z":x=mx,y=my;break;case"H":x=r[1];break;case"V":y=r[1];break;case"M":pathSegment=res[i],ln2=pathSegment.length,mx=pathSegment[ln2-2],my=pathSegment[ln2-1];default:pathSegment=res[i],ln2=pathSegment.length,x=pathSegment[ln2-2],y=pathSegment[ln2-1]}}return res.toString=this.path2string,res},pathToRelative:function(pathArray){this.is(pathArray,"array")&&this.is(pathArray&&pathArray[0],"array")||(pathArray=this.parsePathString(pathArray));var r,pa,i,j,k,len,ii,jj,kk,res=[],x=0,y=0,mx=0,my=0,start=0;for("M"==pathArray[0][0]&&(x=pathArray[0][1],y=pathArray[0][2],mx=x,my=y,start++,res.push(["M",x,y])),i=start,ii=pathArray.length;i<ii;i++){if(r=res[i]=[],pa=pathArray[i],pa[0]!=pa[0].toLowerCase())switch(r[0]=pa[0].toLowerCase(),r[0]){case"a":r[1]=pa[1],r[2]=pa[2],r[3]=pa[3],r[4]=pa[4],r[5]=pa[5],r[6]=+(pa[6]-x).toFixed(3),r[7]=+(pa[7]-y).toFixed(3);break;case"v":r[1]=+(pa[1]-y).toFixed(3);break;case"m":mx=pa[1],my=pa[2];default:for(j=1,jj=pa.length;j<jj;j++)r[j]=+(pa[j]-(j%2?x:y)).toFixed(3)}else for(r=res[i]=[],"m"==pa[0]&&(mx=pa[1]+x,my=pa[2]+y),k=0,kk=pa.length;k<kk;k++)res[i][k]=pa[k];switch(len=res[i].length,res[i][0]){case"z":x=mx,y=my;break;case"h":x+=+res[i][len-1];break;case"v":y+=+res[i][len-1];break;default:x+=+res[i][len-2],y+=+res[i][len-1]}}return res.toString=this.path2string,res},path2curve:function(path){var i,seg,segLn,point,me=this,points=me.pathToAbsolute(path),ln=points.length,attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};for(i=0;i<ln;i++){if(points[i]=me.command2curve(points[i],attrs),points[i].length>7){for(points[i].shift(),point=points[i];point.length;)Ext.Array.splice(points,i++,0,["C"].concat(Ext.Array.splice(point,0,6)));Ext.Array.erase(points,i,1),ln=points.length,i--}seg=points[i],segLn=seg.length,attrs.x=seg[segLn-2],attrs.y=seg[segLn-1],attrs.bx=parseFloat(seg[segLn-4])||attrs.x,attrs.by=parseFloat(seg[segLn-3])||attrs.y}return points},interpolatePaths:function(path,path2){var i,ii,seg,seg2,seglen,seg2len,me=this,p=me.pathToAbsolute(path),p2=me.pathToAbsolute(path2),attrs={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},attrs2={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},fixArc=function(pp,i){if(pp[i].length>7){pp[i].shift();for(var pi=pp[i];pi.length;)Ext.Array.splice(pp,i++,0,["C"].concat(Ext.Array.splice(pi,0,6)));Ext.Array.erase(pp,i,1),ii=Math.max(p.length,p2.length||0)}},fixM=function(path1,path2,a1,a2,i){path1&&path2&&"M"==path1[i][0]&&"M"!=path2[i][0]&&(Ext.Array.splice(path2,i,0,["M",a2.x,a2.y]),a1.bx=0,a1.by=0,a1.x=path1[i][1],a1.y=path1[i][2],ii=Math.max(p.length,p2.length||0))};for(i=0,ii=Math.max(p.length,p2.length||0);i<ii;i++)p[i]=me.command2curve(p[i],attrs),fixArc(p,i),p2[i]=me.command2curve(p2[i],attrs2),fixArc(p2,i),fixM(p,p2,attrs,attrs2,i),fixM(p2,p,attrs2,attrs,i),seg=p[i],seg2=p2[i],seglen=seg.length,seg2len=seg2.length,attrs.x=seg[seglen-2],attrs.y=seg[seglen-1],attrs.bx=parseFloat(seg[seglen-4])||attrs.x,attrs.by=parseFloat(seg[seglen-3])||attrs.y,attrs2.bx=parseFloat(seg2[seg2len-4])||attrs2.x,attrs2.by=parseFloat(seg2[seg2len-3])||attrs2.y,attrs2.x=seg2[seg2len-2],attrs2.y=seg2[seg2len-1];return[p,p2]},command2curve:function(pathCommand,d){var me=this;if(!pathCommand)return["C",d.x,d.y,d.x,d.y,d.x,d.y];switch("T"!=pathCommand[0]&&"Q"!=pathCommand[0]&&(d.qx=d.qy=null),pathCommand[0]){case"M":d.X=pathCommand[1],d.Y=pathCommand[2];break;case"A":pathCommand=["C"].concat(me.arc2curve.apply(me,[d.x,d.y].concat(pathCommand.slice(1))));break;case"S":pathCommand=["C",d.x+(d.x-(d.bx||d.x)),d.y+(d.y-(d.by||d.y))].concat(pathCommand.slice(1));break;case"T":d.qx=d.x+(d.x-(d.qx||d.x)),d.qy=d.y+(d.y-(d.qy||d.y)),pathCommand=["C"].concat(me.quadratic2curve(d.x,d.y,d.qx,d.qy,pathCommand[1],pathCommand[2]));break;case"Q":d.qx=pathCommand[1],d.qy=pathCommand[2],pathCommand=["C"].concat(me.quadratic2curve(d.x,d.y,pathCommand[1],pathCommand[2],pathCommand[3],pathCommand[4]));break;case"L":pathCommand=["C"].concat(d.x,d.y,pathCommand[1],pathCommand[2],pathCommand[1],pathCommand[2]);break;case"H":pathCommand=["C"].concat(d.x,d.y,pathCommand[1],d.y,pathCommand[1],d.y);break;case"V":pathCommand=["C"].concat(d.x,d.y,d.x,pathCommand[1],d.x,pathCommand[1]);break;case"Z":pathCommand=["C"].concat(d.x,d.y,d.X,d.Y,d.X,d.Y)}return pathCommand},quadratic2curve:function(x1,y1,ax,ay,x2,y2){var _13=1/3,_23=2/3;return[_13*x1+_23*ax,_13*y1+_23*ay,_13*x2+_23*ax,_13*y2+_23*ay,x2,y2]},rotate:function(x,y,rad){var cos=Math.cos(rad),sin=Math.sin(rad),X=x*cos-y*sin,Y=x*sin+y*cos;return{x:X,y:Y}},arc2curve:function(x1,y1,rx,ry,angle,large_arc_flag,sweep_flag,x2,y2,recursive){var xy,x,y,h,rx2,ry2,k,cx,cy,f1,f2,df,c1,s1,c2,s2,t,hx,hy,m1,m2,m3,m4,newres,i,ln,f2old,x2old,y2old,me=this,PI=Math.PI,radian=me.radian,_120=120*PI/180,rad=radian*(+angle||0),res=[],math=Math,mcos=math.cos,msin=math.sin,msqrt=math.sqrt,mabs=math.abs,masin=math.asin;if(recursive?(f1=recursive[0],f2=recursive[1],cx=recursive[2],cy=recursive[3]):(xy=me.rotate(x1,y1,-rad),x1=xy.x,y1=xy.y,xy=me.rotate(x2,y2,-rad),x2=xy.x,y2=xy.y,x=(x1-x2)/2,y=(y1-y2)/2,h=x*x/(rx*rx)+y*y/(ry*ry),h>1&&(h=msqrt(h),rx=h*rx,ry=h*ry),rx2=rx*rx,ry2=ry*ry,k=(large_arc_flag==sweep_flag?-1:1)*msqrt(mabs((rx2*ry2-rx2*y*y-ry2*x*x)/(rx2*y*y+ry2*x*x))),cx=k*rx*y/ry+(x1+x2)/2,cy=k*-ry*x/rx+(y1+y2)/2,f1=masin(((y1-cy)/ry).toFixed(7)),f2=masin(((y2-cy)/ry).toFixed(7)),f1=x1<cx?PI-f1:f1,f2=x2<cx?PI-f2:f2,f1<0&&(f1=2*PI+f1),f2<0&&(f2=2*PI+f2),sweep_flag&&f1>f2&&(f1-=2*PI),!sweep_flag&&f2>f1&&(f2-=2*PI)),df=f2-f1,mabs(df)>_120&&(f2old=f2,x2old=x2,y2old=y2,f2=f1+_120*(sweep_flag&&f2>f1?1:-1),x2=cx+rx*mcos(f2),y2=cy+ry*msin(f2),res=me.arc2curve(x2,y2,rx,ry,angle,0,sweep_flag,x2old,y2old,[f2,f2old,cx,cy])),df=f2-f1,c1=mcos(f1),s1=msin(f1),c2=mcos(f2),s2=msin(f2),t=math.tan(df/4),hx=4/3*rx*t,hy=4/3*ry*t,m1=[x1,y1],m2=[x1+hx*s1,y1-hy*c1],m3=[x2+hx*s2,y2-hy*c2],m4=[x2,y2],m2[0]=2*m1[0]-m2[0],m2[1]=2*m1[1]-m2[1],recursive)return[m2,m3,m4].concat(res);for(res=[m2,m3,m4].concat(res).join().split(","),newres=[],ln=res.length,i=0;i<ln;i++)newres[i]=i%2?me.rotate(res[i-1],res[i],rad).y:me.rotate(res[i],res[i+1],rad).x;return newres},rotateAndTranslatePath:function(sprite){var path,i,p,xy,j,alpha=sprite.rotation.degrees,cx=sprite.rotation.x,cy=sprite.rotation.y,dx=sprite.translation.x,dy=sprite.translation.y,res=[];if(!alpha&&!dx&&!dy)return this.pathToAbsolute(sprite.attr.path);for(dx=dx||0,dy=dy||0,path=this.pathToAbsolute(sprite.attr.path),i=path.length;i--;)if(p=res[i]=path[i].slice(),"A"==p[0])xy=this.rotatePoint(p[6],p[7],alpha,cx,cy),p[6]=xy.x+dx,p[7]=xy.y+dy;else for(j=1;null!=p[j+1];)xy=this.rotatePoint(p[j],p[j+1],alpha,cx,cy),p[j]=xy.x+dx,p[j+1]=xy.y+dy,j+=2;return res},rotatePoint:function(x,y,alpha,cx,cy){if(!alpha)return{x:x,y:y};cx=cx||0,cy=cy||0,x-=cx,y-=cy,alpha*=this.radian;var cos=Math.cos(alpha),sin=Math.sin(alpha);return{x:x*cos-y*sin+cx,y:x*sin+y*cos+cy}},pathDimensions:function(path){if(!(path&&path+""))return{x:0,y:0,width:0,height:0};path=this.path2curve(path);for(var p,xmin,ymin,xmax,ymax,dim,x=0,y=0,X=[],Y=[],i=0,ln=path.length;i<ln;i++)p=path[i],"M"==p[0]?(x=p[1],y=p[2],X.push(x),Y.push(y)):(dim=this.curveDim(x,y,p[1],p[2],p[3],p[4],p[5],p[6]),X=X.concat(dim.min.x,dim.max.x),Y=Y.concat(dim.min.y,dim.max.y),x=p[5],y=p[6]);return xmin=Math.min.apply(0,X),ymin=Math.min.apply(0,Y),xmax=Math.max.apply(0,X),ymax=Math.max.apply(0,Y),{x:Math.round(xmin),y:Math.round(ymin),path:path,width:Math.round(xmax-xmin),height:Math.round(ymax-ymin)}},intersectInside:function(path,cp1,cp2){return(cp2[0]-cp1[0])*(path[1]-cp1[1])>(cp2[1]-cp1[1])*(path[0]-cp1[0])},intersectIntersection:function(s,e,cp1,cp2){var p=[],dcx=cp1[0]-cp2[0],dcy=cp1[1]-cp2[1],dpx=s[0]-e[0],dpy=s[1]-e[1],n1=cp1[0]*cp2[1]-cp1[1]*cp2[0],n2=s[0]*e[1]-s[1]*e[0],n3=1/(dcx*dpy-dcy*dpx);return p[0]=(n1*dpx-n2*dcx)*n3,p[1]=(n1*dpy-n2*dcy)*n3,p},intersect:function(subjectPolygon,clipPolygon){for(var cp2,s,e,ln2,inputList,j,me=this,i=0,ln=clipPolygon.length,cp1=clipPolygon[ln-1],outputList=subjectPolygon;i<ln;++i){for(cp2=clipPolygon[i],inputList=outputList,outputList=[],s=inputList[inputList.length-1],j=0,ln2=inputList.length;j<ln2;j++)e=inputList[j],me.intersectInside(e,cp1,cp2)?(me.intersectInside(s,cp1,cp2)||outputList.push(me.intersectIntersection(s,e,cp1,cp2)),outputList.push(e)):me.intersectInside(s,cp1,cp2)&&outputList.push(me.intersectIntersection(s,e,cp1,cp2)),s=e;cp1=cp2}return outputList},bezier:function(a,b,c,d,x){if(0===x)return a;if(1===x)return d;var du=1-x,d3=du*du*du,r=x/du;return d3*(a+r*(3*b+r*(3*c+d*r)))},bezierDim:function(a,b,c,d){var r,A,top,C,delta,bottom,s,min,max,i,points=[];for(a+3*c==d+3*b?(r=a-b,r/=2*(a-b-b+c),r<1&&r>0&&points.push(r)):(A=a-3*b+3*c-d,top=2*(a-b-b+c),C=a-b,delta=top*top-4*A*C,bottom=A+A,0===delta?(r=top/bottom,r<1&&r>0&&points.push(r)):delta>0&&(s=Math.sqrt(delta),r=(s+top)/bottom,r<1&&r>0&&points.push(r),r=(top-s)/bottom,r<1&&r>0&&points.push(r))),min=Math.min(a,d),max=Math.max(a,d),i=0;i<points.length;i++)min=Math.min(min,this.bezier(a,b,c,d,points[i])),max=Math.max(max,this.bezier(a,b,c,d,points[i]));return[min,max]},curveDim:function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y){var x=this.bezierDim(p1x,c1x,c2x,p2x),y=this.bezierDim(p1y,c1y,c2y,p2y);return{min:{x:x[0],y:y[0]},max:{x:x[1],y:y[1]}}},getAnchors:function(prevX,prevY,curX,curY,nextX,nextY,value){value=value||4;var control1Length,control2Length,control1Angle,control2Angle,control1X,control1Y,control2X,control2Y,alpha,M=Math,PI=M.PI,halfPI=PI/2,abs=M.abs,sin=M.sin,cos=M.cos,atan=M.atan;return control1Length=(curX-prevX)/value,control2Length=(nextX-curX)/value,curY>=prevY&&curY>=nextY||curY<=prevY&&curY<=nextY?control1Angle=control2Angle=halfPI:(control1Angle=atan((curX-prevX)/abs(curY-prevY)),prevY<curY&&(control1Angle=PI-control1Angle),control2Angle=atan((nextX-curX)/abs(curY-nextY)),nextY<curY&&(control2Angle=PI-control2Angle)),alpha=halfPI-(control1Angle+control2Angle)%(2*PI)/2,alpha>halfPI&&(alpha-=PI),control1Angle+=alpha,control2Angle+=alpha,control1X=curX-control1Length*sin(control1Angle),control1Y=curY+control1Length*cos(control1Angle),control2X=curX+control2Length*sin(control2Angle),control2Y=curY+control2Length*cos(control2Angle),(curY>prevY&&control1Y<prevY||curY<prevY&&control1Y>prevY)&&(control1X+=abs(prevY-control1Y)*(control1X-curX)/(control1Y-curY),control1Y=prevY),(curY>nextY&&control2Y<nextY||curY<nextY&&control2Y>nextY)&&(control2X-=abs(nextY-control2Y)*(control2X-curX)/(control2Y-curY),control2Y=nextY),{x1:control1X,y1:control1Y,x2:control2X,y2:control2Y}},smooth:function(originalPath,value){for(var j,points,pathi,pathil,pathim,pathiml,pathip,pathipl,begl,path=this.path2curve(originalPath),newp=[path[0]],x=path[0][1],y=path[0][2],i=1,ii=path.length,beg=1,mx=x,my=y;i<ii;i++)if(pathi=path[i],pathil=pathi.length,pathim=path[i-1],pathiml=pathim.length,pathip=path[i+1],pathipl=pathip&&pathip.length,"M"!=pathi[0])pathi[pathil-2]!=mx||pathi[pathil-1]!=my||pathip&&"M"!=pathip[0]?points=pathip&&"M"!=pathip[0]?this.getAnchors(pathim[pathiml-2],pathim[pathiml-1],pathi[pathil-2],pathi[pathil-1],pathip[pathipl-2],pathip[pathipl-1],value):{x1:pathi[pathil-2],y1:pathi[pathil-1]}:(begl=newp[beg].length,points=this.getAnchors(pathim[pathiml-2],pathim[pathiml-1],mx,my,newp[beg][begl-2],newp[beg][begl-1],value),newp[beg][1]=points.x2,newp[beg][2]=points.y2),newp.push(["C",x,y,points.x1,points.y1,pathi[pathil-2],pathi[pathil-1]]),x=points.x2,y=points.y2;else{for(mx=pathi[1],my=pathi[2],j=i+1;"C"!=path[j][0];)j++;newp.push(["M",mx,my]),beg=newp.length,x=mx,y=my}return newp},findDotAtSegment:function(p1x,p1y,c1x,c1y,c2x,c2y,p2x,p2y,t){var t1=1-t;return{x:Math.pow(t1,3)*p1x+3*Math.pow(t1,2)*t*c1x+3*t1*t*t*c2x+Math.pow(t,3)*p2x,y:Math.pow(t1,3)*p1y+3*Math.pow(t1,2)*t*c1y+3*t1*t*t*c2y+Math.pow(t,3)*p2y}},snapEnds:function(from,to,stepsMax,prettyNumbers){if(Ext.isDate(from))return this.snapEndsByDate(from,to,stepsMax);var cur,floor,value,weight,i,topValue,step=(to-from)/stepsMax,level=Math.floor(Math.log(step)/Math.LN10)+1,m=Math.pow(10,level),modulo=Math.round(step%m*Math.pow(10,2-level)),interval=[[0,15],[10,1],[20,4],[25,2],[50,9],[100,15]],stepCount=0,topWeight=1e9,ln=interval.length;if(floor=Math.floor(from/m)*m,from==floor&&floor>0&&(floor=Math.floor((from-m/10)/m)*m),prettyNumbers){for(i=0;i<ln;i++)value=interval[i][0],weight=value-modulo<0?1e6:(value-modulo)/interval[i][1],weight<topWeight&&(topValue=value,topWeight=weight);if(step=Math.floor(step*Math.pow(10,-level))*Math.pow(10,level)+topValue*Math.pow(10,level-2),from<0&&to>=0){for(cur=0;cur>from;)cur-=step,stepCount++;for(from=+cur.toFixed(10),cur=0;cur<to;)cur+=step,stepCount++;to=+cur.toFixed(10)}else for(cur=from=floor;cur<to;)cur+=step,stepCount++;to=+cur.toFixed(10)}else from=floor,stepCount=stepsMax;return{from:from,to:to,power:level,step:step,steps:stepCount}},snapEndsByDate:function(from,to,stepsMax,lockEnds){var scale,j,yearDiff,s,selectedStep=!1,scales=[[Ext.Date.MILLI,[1,2,5,10,20,50,100,200,250,500]],[Ext.Date.SECOND,[1,2,5,10,15,30]],[Ext.Date.MINUTE,[1,2,5,10,15,30]],[Ext.Date.HOUR,[1,2,3,4,6,12]],[Ext.Date.DAY,[1,2,7,14]],[Ext.Date.MONTH,[1,2,3,6]]],sLen=scales.length,stop=!1;for(s=0;s<sLen;s++)if(scale=scales[s],!stop)for(j=0;j<scale[1].length;j++)if(to<Ext.Date.add(from,scale[0],scale[1][j]*stepsMax)){selectedStep=[scale[0],scale[1][j]],stop=!0;break}return selectedStep||(yearDiff=this.snapEnds(from.getFullYear(),to.getFullYear()+1,stepsMax,lockEnds),selectedStep=[Date.YEAR,Math.round(yearDiff.step)]),this.snapEndsByDateAndStep(from,to,selectedStep,lockEnds)},snapEndsByDateAndStep:function(from,to,step,lockEnds){var testFrom,testTo,date,year,month,day,fractionalMonth,stepsArray,fromStat=[from.getFullYear(),from.getMonth(),from.getDate(),from.getHours(),from.getMinutes(),from.getSeconds(),from.getMilliseconds()],stepUnit=step[0],stepValue=step[1],steps=0;if(lockEnds)testFrom=from;else switch(stepUnit){case Ext.Date.MILLI:testFrom=new Date(fromStat[0],fromStat[1],fromStat[2],fromStat[3],fromStat[4],fromStat[5],Math.floor(fromStat[6]/stepValue)*stepValue);break;case Ext.Date.SECOND:testFrom=new Date(fromStat[0],fromStat[1],fromStat[2],fromStat[3],fromStat[4],Math.floor(fromStat[5]/stepValue)*stepValue,0);break;case Ext.Date.MINUTE:testFrom=new Date(fromStat[0],fromStat[1],fromStat[2],fromStat[3],Math.floor(fromStat[4]/stepValue)*stepValue,0,0);break;case Ext.Date.HOUR:testFrom=new Date(fromStat[0],fromStat[1],fromStat[2],Math.floor(fromStat[3]/stepValue)*stepValue,0,0,0);break;case Ext.Date.DAY:testFrom=new Date(fromStat[0],fromStat[1],Math.floor((fromStat[2]-1)/stepValue)*stepValue+1,0,0,0,0);break;case Ext.Date.MONTH:testFrom=new Date(fromStat[0],Math.floor(fromStat[1]/stepValue)*stepValue,1,0,0,0,0),steps=[],stepsArray=!0;break;default:testFrom=new Date(Math.floor(fromStat[0]/stepValue)*stepValue,0,1,0,0,0,0),steps=[],stepsArray=!0}for(fractionalMonth=stepUnit===Ext.Date.MONTH&&(.5==stepValue||stepValue==1/3||.25==stepValue),testTo=new Date(testFrom);testTo<to;)if(fractionalMonth){switch(date=new Date(testTo),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),stepValue){case.5:day>=15?(day=1,++month>11&&year++):day=15;break;case 1/3:day>=20?(day=1,++month>11&&year++):day=day>=10?20:10;break;case.25:day>=22?(day=1,++month>11&&year++):day=day>=15?22:day>=8?15:8}testTo.setYear(year),testTo.setMonth(month),testTo.setDate(day),steps.push(new Date(testTo))}else stepsArray?(testTo=Ext.Date.add(testTo,stepUnit,stepValue),steps.push(new Date(testTo))):(testTo=Ext.Date.add(testTo,stepUnit,stepValue),steps++);return lockEnds&&(testTo=to),stepsArray?{from:+testFrom,to:+testTo,steps:steps}:{from:+testFrom,to:+testTo,step:(testTo-testFrom)/steps,steps:steps}},sorter:function(a,b){return a.offset-b.offset},rad:function(degrees){return degrees%360*Math.PI/180},normalizeRadians:function(radian){var twoPi=2*Math.PI;return radian>=0?radian%twoPi:(radian%twoPi+twoPi)%twoPi},degrees:function(radian){return 180*radian/Math.PI%360},normalizeDegrees:function(degrees){return degrees>=0?degrees%360:(degrees%360+360)%360},withinBox:function(x,y,bbox){return bbox=bbox||{},x>=bbox.x&&x<=bbox.x+bbox.width&&y>=bbox.y&&y<=bbox.y+bbox.height},parseGradient:function(gradient){var stop,vector,max,stopObj,me=this,type=gradient.type||"linear",angle=gradient.angle||0,radian=me.radian,stops=gradient.stops,stopsArr=[];"linear"==type&&(vector=[0,0,Math.cos(angle*radian),Math.sin(angle*radian)],max=1/(Math.max(Math.abs(vector[2]),Math.abs(vector[3]))||1),vector[2]*=max,vector[3]*=max,vector[2]<0&&(vector[0]=-vector[2],vector[2]=0),vector[3]<0&&(vector[1]=-vector[3],vector[3]=0));for(stop in stops)stops.hasOwnProperty(stop)&&me.stopsRE.test(stop)&&(stopObj={offset:parseInt(stop,10),color:Ext.draw.Color.toHex(stops[stop].color)||"#ffffff",opacity:stops[stop].opacity||1},stopsArr.push(stopObj));return Ext.Array.sort(stopsArr,me.sorter),"linear"==type?{id:gradient.id,type:type,vector:vector,stops:stopsArr}:{id:gradient.id,type:type,centerX:gradient.centerX,centerY:gradient.centerY,focalX:gradient.focalX,focalY:gradient.focalY,radius:gradient.radius,vector:vector,stops:stopsArr}}}),Ext.define("Ext.fx.PropertyHandler",{statics:{defaultHandler:{pixelDefaultsRE:/width|height|top$|bottom$|left$|right$/i,unitRE:/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/,scrollRE:/^scroll/i,computeDelta:function(from,end,damper,initial,attr){damper="number"==typeof damper?damper:1;var start,units,unitRE=this.unitRE,match=unitRE.exec(from);return match&&(from=match[1],units=match[2],this.scrollRE.test(attr)||units||!this.pixelDefaultsRE.test(attr)||(units="px")),from=+from||0,match=unitRE.exec(end),match&&(end=match[1],units=match[2]||units),end=+end||0,start=null!=initial?initial:from,{from:from,delta:(end-start)*damper,units:units}},get:function(from,end,damper,initialFrom,attr){var i,initial,res,j,len,ln=from.length,out=[];for(i=0;i<ln;i++)if(initialFrom&&(initial=initialFrom[i][1].from),Ext.isArray(from[i][1])&&Ext.isArray(end)){for(res=[],j=0,len=from[i][1].length;j<len;j++)res.push(this.computeDelta(from[i][1][j],end[j],damper,initial,attr));out.push([from[i][0],res])}else out.push([from[i][0],this.computeDelta(from[i][1],end,damper,initial,attr)]);return out},set:function(values,easing){var i,val,res,len,j,ln=values.length,out=[];for(i=0;i<ln;i++)if(val=values[i][1],Ext.isArray(val)){for(res=[],j=0,len=val.length;j<len;j++)res.push(val[j].from+val[j].delta*easing+(val[j].units||0));out.push([values[i][0],res])}else out.push([values[i][0],val.from+val.delta*easing+(val.units||0)]);return out}},stringHandler:{computeDelta:function(from,end,damper,initial,attr){return{from:from,delta:end}},get:function(from,end,damper,initialFrom,attr){var i,initial,ln=from.length,out=[];for(i=0;i<ln;i++)out.push([from[i][0],this.computeDelta(from[i][1],end,damper,initial,attr)]);return out},set:function(values,easing){var i,val,ln=values.length,out=[];for(i=0;i<ln;i++)val=values[i][1],out.push([values[i][0],val.delta]);return out}},color:{rgbRE:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hexRE:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3RE:/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,parseColor:function(color,damper){damper="number"==typeof damper?damper:1;var match,base,re,i,out=!1,reList=[this.hexRE,this.rgbRE,this.hex3RE],length=reList.length;for(i=0;i<length;i++)if(re=reList[i],base=i%2===0?16:10,match=re.exec(color),match&&4===match.length){2===i&&(match[1]+=match[1],match[2]+=match[2],match[3]+=match[3]),out={red:parseInt(match[1],base),green:parseInt(match[2],base),blue:parseInt(match[3],base)};break}return out||color},computeDelta:function(from,end,damper,initial){from=this.parseColor(from),end=this.parseColor(end,damper);var start=initial?initial:from,tfrom=typeof start,tend=typeof end;return"string"==tfrom||"undefined"==tfrom||"string"==tend||"undefined"==tend?end||start:{from:from,delta:{red:Math.round((end.red-start.red)*damper),green:Math.round((end.green-start.green)*damper),blue:Math.round((end.blue-start.blue)*damper)}}},get:function(start,end,damper,initialFrom){var i,initial,ln=start.length,out=[];for(i=0;i<ln;i++)initialFrom&&(initial=initialFrom[i][1].from),out.push([start[i][0],this.computeDelta(start[i][1],end,damper,initial)]);return out},set:function(values,easing){var i,val,parsedString,from,delta,ln=values.length,out=[];for(i=0;i<ln;i++)if(val=values[i][1]){if(from=val.from,delta=val.delta,val="object"==typeof val&&"red"in val?"rgb("+val.red+", "+val.green+", "+val.blue+")":val,val="object"==typeof val&&val.length?val[0]:val,"undefined"==typeof val)return[];parsedString="string"==typeof val?val:"rgb("+[(from.red+Math.round(delta.red*easing))%256,(from.green+Math.round(delta.green*easing))%256,(from.blue+Math.round(delta.blue*easing))%256].join(",")+")",out.push([values[i][0],parsedString])}return out}},object:{interpolate:function(prop,damper){damper="number"==typeof damper?damper:1;var p,out={};for(p in prop)out[p]=parseFloat(prop[p])*damper;return out},computeDelta:function(from,end,damper,initial){from=this.interpolate(from),end=this.interpolate(end,damper);var p,start=initial?initial:from,delta={};for(p in end)delta[p]=end[p]-start[p];return{from:from,delta:delta}},get:function(start,end,damper,initialFrom){var i,initial,ln=start.length,out=[];for(i=0;i<ln;i++)initialFrom&&(initial=initialFrom[i][1].from),out.push([start[i][0],this.computeDelta(start[i][1],end,damper,initial)]);return out},set:function(values,easing){var i,from,delta,val,p,ln=values.length,out=[],outObject={};for(i=0;i<ln;i++){val=values[i][1],from=val.from,delta=val.delta;for(p in from)outObject[p]=from[p]+delta[p]*easing;out.push([values[i][0],outObject])}return out}},path:{computeDelta:function(from,end,damper,initial){damper="number"==typeof damper?damper:1;var start;return from=+from||0,end=+end||0,start=null!=initial?initial:from,{from:from,delta:(end-start)*damper}},forcePath:function(path){return Ext.isArray(path)||Ext.isArray(path[0])||(path=Ext.draw.Draw.parsePathString(path)),path},get:function(start,end,damper,initialFrom){var startPathLn,pointsLn,i,deltaPath,initial,j,k,path,startPath,endPath=this.forcePath(end),out=[],startLn=start.length;for(i=0;i<startLn;i++){for(startPath=this.forcePath(start[i][1]),deltaPath=Ext.draw.Draw.interpolatePaths(startPath,endPath),startPath=deltaPath[0],endPath=deltaPath[1],startPathLn=startPath.length,path=[],j=0;j<startPathLn;j++){for(deltaPath=[startPath[j][0]],pointsLn=startPath[j].length,k=1;k<pointsLn;k++)initial=initialFrom&&initialFrom[0][1][j][k].from,deltaPath.push(this.computeDelta(startPath[j][k],endPath[j][k],damper,initial));path.push(deltaPath)}out.push([start[i][0],path])}return out},set:function(values,easing){var i,j,k,newPath,calcPath,deltaPath,deltaPathLn,pointsLn,ln=values.length,out=[];for(i=0;i<ln;i++){for(deltaPath=values[i][1],newPath=[],deltaPathLn=deltaPath.length,j=0;j<deltaPathLn;j++){for(calcPath=[deltaPath[j][0]],pointsLn=deltaPath[j].length,k=1;k<pointsLn;k++)calcPath.push(deltaPath[j][k].from+deltaPath[j][k].delta*easing);newPath.push(calcPath.join(","))}out.push([values[i][0],newPath.join(",")])}return out}}}},function(){for(var prop,props=["outlineColor","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fill","stroke"],length=props.length,i=0;i<length;i++)prop=props[i],this[prop]=this.color;for(props=["cursor"],length=props.length,i=0;i<length;i++)prop=props[i],this[prop]=this.stringHandler}),Ext.define("Ext.fx.Anim",{mixins:{observable:Ext.util.Observable},isAnimation:!0,duration:250,delay:0,delayStart:0,dynamic:!1,easing:"ease",damper:1,bezierRE:/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,reverse:!1,running:!1,paused:!1,iterations:1,autoEnd:!1,alternate:!1,currentIteration:0,startTime:0,frameCount:0,constructor:function(config){var curve,me=this;return config=config||{},config.keyframes?new Ext.fx.Animator(config):(Ext.apply(me,config),void 0===me.from&&(me.from={}),me.propHandlers={},me.config=config,me.target=Ext.fx.Manager.createTarget(me.target),me.easingFn=Ext.fx.Easing[me.easing],me.target.dynamic=me.dynamic,me.easingFn||(me.easingFn=String(me.easing).match(me.bezierRE),me.easingFn&&5==me.easingFn.length&&(curve=me.easingFn,me.easingFn=Ext.fx.CubicBezier.cubicBezier(+curve[1],+curve[2],+curve[3],+curve[4]))),me.id=Ext.id(null,"ext-anim-"),me.addEvents("beforeanimate","afteranimate","lastframe"),me.mixins.observable.constructor.call(me),Ext.fx.Manager.addAnim(me),void(config.autoEnd&&(me.running=!0,me.jumpToEnd())))},setAttr:function(attr,value){return Ext.fx.Manager.items.get(this.id).setAttr(this.target,attr,value)},initAttrs:function(){var start,end,propHandler,attr,me=this,from=me.from,to=me.to,initialFrom=me.initialFrom||{},out={};for(attr in to)to.hasOwnProperty(attr)&&(start=me.target.getAttr(attr,from[attr]),end=to[attr],propHandler=Ext.fx.PropertyHandler[attr]?me.propHandlers[attr]=Ext.fx.PropertyHandler[attr]:Ext.isObject(end)?me.propHandlers[attr]=Ext.fx.PropertyHandler.object:me.propHandlers[attr]=Ext.fx.PropertyHandler.defaultHandler,
out[attr]=propHandler.get(start,end,me.damper,initialFrom[attr],attr));me.currentAttrs=out},start:function(startTime){var delayDelta,me=this,delay=me.delay,delayStart=me.delayStart;if(delay){if(!delayStart)return void(me.delayStart=startTime);if(delayDelta=startTime-delayStart,delayDelta<delay)return;startTime=new Date(delayStart.getTime()+delay)}me.fireEvent("beforeanimate",me)!==!1&&(me.startTime=startTime,me.paused||me.currentAttrs||me.initAttrs(),me.running=!0,me.frameCount=0)},jumpToEnd:function(){var me=this;me.endWasCalled||(me.currentAttrs||me.initAttrs(),Ext.fx.Manager.jumpToEnd(me),me.end())},runAnim:function(elapsedTime){var easing,values,attr,lastFrame,me=this,attrs=me.currentAttrs,duration=me.duration,easingFn=me.easingFn,propHandlers=me.propHandlers,ret={};elapsedTime>=duration&&(elapsedTime=duration,lastFrame=!0),me.reverse&&(elapsedTime=duration-elapsedTime);for(attr in attrs)attrs.hasOwnProperty(attr)&&(values=attrs[attr],easing=lastFrame?1:easingFn(elapsedTime/duration),ret[attr]=propHandlers[attr].set(values,easing));return me.frameCount++,ret},lastFrame:function(){var me=this,iter=me.iterations,iterCount=me.currentIteration;iterCount++,iterCount<iter?(me.alternate&&(me.reverse=!me.reverse),me.startTime=new Date,me.currentIteration=iterCount,me.paused=!1):(me.currentIteration=0,me.end(),me.fireEvent("lastframe",me,me.startTime))},endWasCalled:0,end:function(){var me=this;me.endWasCalled++||(me.startTime=0,me.paused=!1,me.running=!1,Ext.fx.Manager.removeAnim(me),me.fireEvent("afteranimate",me,me.startTime),Ext.callback(me.callback,me.scope,[me,me.startTime]),me.remove&&me.target.remove())},isReady:function(){return this.paused===!1&&this.running===!1&&this.iterations>0},isRunning:function(){return this.paused===!1&&this.running===!0&&this.isAnimator!==!0}}),Ext.enableFx=!0,Ext.define("Ext.util.Animate",{isAnimate:!0,animate:function(animObj){var me=this;return Ext.fx.Manager.hasFxBlock(me.id)?me:(Ext.fx.Manager.queueFx(new Ext.fx.Anim(me.anim(animObj))),this)},anim:function(config){if(!Ext.isObject(config))return!!config&&{};var me=this;return config.stopAnimation&&me.stopAnimation(),Ext.applyIf(config,Ext.fx.Manager.getFxDefaults(me.id)),Ext.apply({target:me,paused:!0},config)},stopFx:Ext.Function.alias(Ext.util.Animate,"stopAnimation"),stopAnimation:function(){return Ext.fx.Manager.stopAnimation(this.id),this},syncFx:function(){return Ext.fx.Manager.setFxDefaults(this.id,{concurrent:!0}),this},sequenceFx:function(){return Ext.fx.Manager.setFxDefaults(this.id,{concurrent:!1}),this},hasActiveFx:Ext.Function.alias(Ext.util.Animate,"getActiveAnimation"),getActiveAnimation:function(){return Ext.fx.Manager.getActiveAnimation(this.id)}},function(){Ext.applyIf(Ext.Element.prototype,this.prototype),Ext.CompositeElementLite.importElementMethods()}),Ext.define("Ext.util.ElementContainer",{childEls:[],constructor:function(){var childEls,me=this;me.hasOwnProperty("childEls")&&(childEls=me.childEls,delete me.childEls,me.addChildEls.apply(me,childEls))},destroy:function(){var child,childName,i,me=this,childEls=me.getChildEls();for(i=childEls.length;i--;)childName=childEls[i],"string"!=typeof childName&&(childName=childName.name),child=me[childName],child&&(me[childName]=null,child.remove())},addChildEls:function(){var me=this,args=arguments;me.hasOwnProperty("childEls")?me.childEls.push.apply(me.childEls,args):me.childEls=me.getChildEls().concat(Array.prototype.slice.call(args)),me.prune(me.childEls,!1)},applyChildEls:function(el,id){var baseId,childName,i,selector,value,me=this,childEls=me.getChildEls();for(baseId=(id||me.id)+"-",i=childEls.length;i--;)childName=childEls[i],"string"==typeof childName?value=el.getById(baseId+childName):(value=(selector=childName.select)?Ext.select(selector,!0,el.dom):(selector=childName.selectNode)?Ext.get(Ext.DomQuery.selectNode(selector,el.dom)):el.getById(childName.id||baseId+childName.itemId),childName=childName.name),me[childName]=value},getChildEls:function(){var self,me=this;return me.hasOwnProperty("childEls")?me.childEls:(self=me.self,self.$childEls||me.getClassChildEls(self))},getClassChildEls:function(cls){var childEls,i,length,forked,mixin,mixins,name,parts,proto,supr,superMixins,me=this,result=cls.$childEls;if(!result){supr=cls.superclass,supr?(supr=supr.self,parts=[supr.$childEls||me.getClassChildEls(supr)],superMixins=supr.prototype.mixins||{}):(parts=[],superMixins={}),proto=cls.prototype,mixins=proto.mixins;for(name in mixins)mixins.hasOwnProperty(name)&&!superMixins.hasOwnProperty(name)&&(mixin=mixins[name].self,parts.push(mixin.$childEls||me.getClassChildEls(mixin)));for(parts.push(proto.hasOwnProperty("childEls")&&proto.childEls),i=0,length=parts.length;i<length;++i)childEls=parts[i],childEls&&childEls.length&&(result?(forked||(forked=!0,result=result.slice(0)),result.push.apply(result,childEls)):result=childEls);cls.$childEls=result=result?me.prune(result,!forked):[]}return result},prune:function(childEls,shared){for(var name,index=childEls.length,map={};index--;)name=childEls[index],"string"!=typeof name&&(name=name.name),map[name]?(shared&&(shared=!1,childEls=childEls.slice(0)),Ext.Array.erase(childEls,index,1)):map[name]=1;return childEls},removeChildEls:function(testFn){var n,i,cel,me=this,old=me.getChildEls(),keepers=me.childEls=[];for(i=0,n=old.length;i<n;++i)cel=old[i],testFn(cel)||keepers.push(cel)}}),Ext.define("Ext.util.Renderable",{frameCls:Ext.baseCSSPrefix+"frame",frameIdRegex:/[\-]frame\d+[TMB][LCR]$/,frameElNames:["TL","TC","TR","ML","MC","MR","BL","BC","BR","Table"],frameTpl:["{%this.renderDockedItems(out,values,0);%}",'<tpl if="top">','<tpl if="left"><div id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>",'<tpl if="left"><div id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</div>",'<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>','<tpl if="bottom">','<tpl if="left"><div id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></tpl>','<div id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>","{%this.renderDockedItems(out,values,1);%}"],frameTableTpl:["{%this.renderDockedItems(out,values,0);%}",'<table id="{fgid}Table" class="',Ext.plainTableCls,'" cellpadding="0" role="presentation">','<tbody role="presentation">','<tpl if="top">','<tr role="presentation">','<tpl if="left"><td id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>",'<tr role="presentation">','<tpl if="left"><td id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>{frameElCls}" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</td>",'<tpl if="right"><td id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>",'<tpl if="bottom">','<tr role="presentation">','<tpl if="left"><td id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>{frameElCls}" role="presentation"></td></tpl>','<td id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>{frameElCls}" role="presentation"></td>','<tpl if="right"><td id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>{frameElCls}" role="presentation"></td></tpl>',"</tr>","</tpl>","</tbody></table>","{%this.renderDockedItems(out,values,1);%}"],afterRender:function(){var item,pre,hide,contentEl,me=this,data={},protoEl=me.protoEl,target=me.el;me.finishRenderChildren(),me.contentEl&&(pre=Ext.baseCSSPrefix,hide=pre+"hide-",contentEl=Ext.get(me.contentEl),contentEl.removeCls([pre+"hidden",hide+"display",hide+"offsets",hide+"nosize"]),me.getContentTarget().appendChild(contentEl.dom)),protoEl.writeTo(data),item=data.removed,item&&target.removeCls(item),item=data.cls,item.length&&target.addCls(item),item=data.style,data.style&&target.setStyle(item),me.protoEl=null,me.ownerCt||me.updateLayout()},afterFirstLayout:function(width,height){var hasX,hasY,pos,xy,me=this,x=me.x,y=me.y;me.ownerLayout||(hasX=Ext.isDefined(x),hasY=Ext.isDefined(y)),!me.floating||hasX&&hasY||(me.floatParent?(pos=me.floatParent.getTargetEl().getViewRegion(),xy=me.el.getAlignToXY(me.floatParent.getTargetEl(),"c-c"),pos.x=xy[0]-pos.x,pos.y=xy[1]-pos.y):(xy=me.el.getAlignToXY(me.container,"c-c"),pos=me.container.translateXY(xy[0],xy[1])),x=hasX?x:pos.x,y=hasY?y:pos.y,hasX=hasY=!0),(hasX||hasY)&&me.setPosition(x,y),me.onBoxReady(width,height)},applyRenderSelectors:function(){var selector,me=this,selectors=me.renderSelectors,el=me.el,dom=el.dom;if(me.applyChildEls(el),selectors)for(selector in selectors)selectors.hasOwnProperty(selector)&&selectors[selector]&&(me[selector]=Ext.get(Ext.DomQuery.selectNode(selectors[selector],dom)))},beforeRender:function(){var me=this,overflowEl=(me.getTargetEl(),me.getOverflowEl()),layout=me.getComponentLayout(),overflowStyle=me.getOverflowStyle();me.frame=me.frame||me.alwaysFramed,layout.initialized||layout.initLayout(),overflowEl&&(overflowEl.setStyle(overflowStyle),me.overflowStyleSet=!0),me.setUI(me.ui),me.disabled&&me.disable(!0)},doApplyRenderTpl:function(out,values){var tpl,me=values.$comp;me.rendered||(tpl=me.initRenderTpl(),tpl.applyOut(values.renderData,out))},doAutoRender:function(){var me=this;me.rendered||(me.floating?me.render(document.body):me.render(Ext.isBoolean(me.autoRender)?Ext.getBody():me.autoRender))},doRenderContent:function(out,renderData){var me=renderData.$comp;me.html&&(Ext.DomHelper.generateMarkup(me.html,out),delete me.html),me.tpl&&(me.tpl.isTemplate||(me.tpl=new Ext.XTemplate(me.tpl)),me.data&&(me.tpl.applyOut(me.data,out),delete me.data))},doRenderFramingDockedItems:function(out,renderData,after){var me=renderData.$comp;!me.rendered&&me.doRenderDockedItems&&(renderData.renderData.$skipDockedItems=!0,me.doRenderDockedItems.call(this,out,renderData,after))},finishRender:function(containerIdx){var tpl,data,el,me=this;!me.el||me.$pid?(el=me.container?me.container.getById(me.id,!0):Ext.getDom(me.id),me.el?(delete me.$pid,me.el.dom||me.wrapPrimaryEl(me.el),el.parentNode.insertBefore(me.el.dom,el),Ext.removeNode(el)):me.wrapPrimaryEl(el)):me.rendering||(tpl=me.initRenderTpl(),tpl&&(data=me.initRenderData(),tpl.insertFirst(me.getTargetEl(),data))),me.container||(me.container=Ext.get(me.el.dom.parentNode)),me.ctCls&&me.container.addCls(me.ctCls),me.onRender(me.container,containerIdx),me.overflowStyleSet||me.getOverflowEl().setStyle(me.getOverflowStyle()),me.el.setVisibilityMode(Ext.Element[me.hideMode.toUpperCase()]),me.overCls&&me.el.hover(me.addOverCls,me.removeOverCls,me),me.hasListeners.render&&me.fireEvent("render",me),me.afterRender(),me.hasListeners.afterrender&&me.fireEvent("afterrender",me),me.initEvents(),me.hidden&&me.el.hide()},finishRenderChildren:function(){var layout=this.getComponentLayout();layout.finishRender()},getElConfig:function(){var i,frameElNames,len,suffix,frameGenId,frameData,me=this,autoEl=me.autoEl,frameInfo=me.getFrameInfo(),config={tag:"div",tpl:frameInfo?me.initFramingTpl(frameInfo.table):me.initRenderTpl()},protoEl=me.protoEl;if(me.initStyles(protoEl),protoEl.writeTo(config),protoEl.flush(),Ext.isString(autoEl)?config.tag=autoEl:Ext.apply(config,autoEl),config.id=me.id,config.tpl)if(frameInfo){for(frameElNames=me.frameElNames,len=frameElNames.length,config.tplData=frameData=me.getFrameRenderData(),frameData.renderData=me.initRenderData(),frameGenId=frameData.fgid,i=0;i<len;i++)suffix=frameElNames[i],me.addChildEls({name:"frame"+suffix,id:frameGenId+suffix});me.addChildEls({name:"frameBody",id:frameGenId+"MC"})}else config.tplData=me.initRenderData();return config},initFramingTpl:function(table){var tpl=this.getFrameTpl(table);return tpl&&!tpl.applyRenderTpl&&this.setupFramingTpl(tpl),tpl},setupFramingTpl:function(frameTpl){frameTpl.applyRenderTpl=this.doApplyRenderTpl,frameTpl.renderDockedItems=this.doRenderFramingDockedItems},getInsertPosition:function(position){return void 0!==position&&(position=Ext.isNumber(position)?this.container.dom.childNodes[position]:Ext.getDom(position)),position},getRenderTree:function(){var me=this;return me.hasListeners.beforerender&&me.fireEvent("beforerender",me)===!1?null:(me.beforeRender(),me.rendering=!0,me.el?{tag:"div",role:"presentation",id:me.$pid=Ext.id()}:me.getElConfig())},initContainer:function(container){var me=this;return!container&&me.el&&(container=me.el.dom.parentNode,me.allowDomMove=!1),me.container=container.dom?container:Ext.get(container),me.container},initRenderData:function(){var me=this;return Ext.apply({$comp:me,id:me.id,ui:me.ui,uiCls:me.uiCls,baseCls:me.baseCls,componentCls:me.componentCls,frame:me.frame,role:me.ariaRole,childElCls:""},me.renderData)},initRenderTpl:function(){var tpl=this.getTpl("renderTpl");return tpl&&!tpl.renderContent&&this.setupRenderTpl(tpl),tpl},onRender:function(parentNode,containerIdx){var width,height,me=this,x=me.x,y=me.y,lastBox=null,el=me.el;me.applyRenderSelectors(),me.rendering=null,me.rendered=!0,null!=x&&(lastBox={x:x}),null!=y&&((lastBox=lastBox||{}).y=y),!me.getFrameInfo()&&Ext.isBorderBox&&(width=me.width,height=me.height,"number"==typeof width&&(lastBox=lastBox||{},lastBox.width=width),"number"==typeof height&&(lastBox=lastBox||{},lastBox.height=height)),me.lastBox=el.lastBox=lastBox},render:function(container,position){var vetoed,tree,nextSibling,me=this,el=me.el&&(me.el=Ext.get(me.el));Ext.suspendLayouts(),container=me.initContainer(container),nextSibling=me.getInsertPosition(position),el?me.hasListeners.beforerender&&me.fireEvent("beforerender",me)===!1?vetoed=!0:(me.beforeRender(),me.initStyles(el),me.allowDomMove!==!1&&(nextSibling?container.dom.insertBefore(el.dom,nextSibling):container.dom.appendChild(el.dom))):(tree=me.getRenderTree(),me.ownerLayout&&me.ownerLayout.transformItemRenderTree&&(tree=me.ownerLayout.transformItemRenderTree(tree)),tree&&(el=nextSibling?Ext.DomHelper.insertBefore(nextSibling,tree):Ext.DomHelper.append(container,tree),me.wrapPrimaryEl(el))),el&&!vetoed&&me.finishRender(position),Ext.resumeLayouts(!me.hidden&&!container.isDetachedBody)},ensureAttachedToBody:function(runLayout){for(var body,comp=this;comp.ownerCt;)comp=comp.ownerCt;comp.container.isDetachedBody&&(comp.container=body=Ext.getBody(),body.appendChild(comp.el.dom),runLayout&&comp.updateLayout(),"number"!=typeof comp.x&&"number"!=typeof comp.y||comp.setPosition(comp.x,comp.y))},setupRenderTpl:function(renderTpl){renderTpl.renderBody=renderTpl.renderContent=this.doRenderContent},wrapPrimaryEl:function(dom){this.el=Ext.get(dom,!0)},initFrame:function(){if(!Ext.supports.CSS3BorderRadius&&this.frame){var frameTpl,frameGenId,i,frameData,suffix,me=this,frameInfo=me.getFrameInfo(),frameElNames=me.frameElNames,len=frameElNames.length;if(frameInfo)for(frameTpl=me.getFrameTpl(frameInfo.table),frameData=me.getFrameRenderData(),frameGenId=frameData.fgid,frameTpl.insertFirst(me.el,frameData),me.frameBody=me.el.down("."+me.frameCls+"-mc"),me.removeChildEls(function(c){return c.id&&me.frameIdRegex.test(c.id)}),i=0;i<len;i++)suffix=frameElNames[i],me["frame"+suffix]=me.el.getById(frameGenId+suffix)}},getFrameRenderData:function(){var me=this,frameInfo=me.frameSize,frameGenId=(me.frameGenId||0)+1;return me.frameGenId=frameGenId,{$comp:me,fgid:me.id+"-frame"+frameGenId,ui:me.ui,uiCls:me.uiCls,frameCls:me.frameCls,baseCls:me.baseCls,top:!!frameInfo.top,left:!!frameInfo.left,right:!!frameInfo.right,bottom:!!frameInfo.bottom,frameElCls:""}},updateFrame:function(){if(!Ext.supports.CSS3BorderRadius&&this.frame){var newMCClassName,me=this,wasTable=me.frameSize&&me.frameSize.table,oldFrameTL=me.frameTL,oldFrameBL=me.frameBL,oldFrameML=me.frameML,oldFrameMC=me.frameMC;me.initFrame(),oldFrameMC?me.frame&&(newMCClassName=me.frameMC.dom.className,oldFrameMC.insertAfter(me.frameMC),me.frameMC.remove(),me.frameBody=me.frameMC=oldFrameMC,oldFrameMC.dom.className=newMCClassName,wasTable?me.el.query("> table")[1].remove():(oldFrameTL&&oldFrameTL.remove(),oldFrameBL&&oldFrameBL.remove(),oldFrameML&&oldFrameML.remove())):me.frame&&me.applyRenderSelectors()}},getFrameInfo:function(){if(Ext.supports.CSS3BorderRadius||!this.frame)return!1;var styleEl,info,frameTop,frameRight,frameBottom,frameLeft,borderWidthT,borderWidthR,borderWidthB,borderWidthL,paddingT,paddingR,paddingB,paddingL,borderRadiusTL,borderRadiusTR,borderRadiusBR,borderRadiusBL,me=this,frameInfoCache=me.frameInfoCache,cls=me.getFramingInfoCls()+"-frameInfo",frameInfo=frameInfoCache[cls],max=Math.max;return null==frameInfo&&(styleEl=Ext.fly(me.getStyleProxy(cls),"frame-style-el"),info=styleEl.getStyle("font-family"),info?(info=info.split("-"),borderRadiusTL=parseInt(info[1],10),borderRadiusTR=parseInt(info[2],10),borderRadiusBR=parseInt(info[3],10),borderRadiusBL=parseInt(info[4],10),borderWidthT=parseInt(info[5],10),borderWidthR=parseInt(info[6],10),borderWidthB=parseInt(info[7],10),borderWidthL=parseInt(info[8],10),paddingT=parseInt(info[9],10),paddingR=parseInt(info[10],10),paddingB=parseInt(info[11],10),paddingL=parseInt(info[12],10),frameTop=max(borderWidthT,max(borderRadiusTL,borderRadiusTR)),frameRight=max(borderWidthR,max(borderRadiusTR,borderRadiusBR)),frameBottom=max(borderWidthB,max(borderRadiusBL,borderRadiusBR)),frameLeft=max(borderWidthL,max(borderRadiusTL,borderRadiusBL)),frameInfo={table:"t"===info[0].charAt(0),vertical:"v"===info[0].charAt(1),top:frameTop,right:frameRight,bottom:frameBottom,left:frameLeft,width:frameLeft+frameRight,height:frameTop+frameBottom,maxWidth:max(frameTop,frameRight,frameBottom,frameLeft),border:{top:borderWidthT,right:borderWidthR,bottom:borderWidthB,left:borderWidthL,width:borderWidthL+borderWidthR,height:borderWidthT+borderWidthB},padding:{top:paddingT,right:paddingR,bottom:paddingB,left:paddingL,width:paddingL+paddingR,height:paddingT+paddingB},radius:{tl:borderRadiusTL,tr:borderRadiusTR,br:borderRadiusBR,bl:borderRadiusBL}}):frameInfo=!1,frameInfoCache[cls]=frameInfo),me.frame=!!frameInfo,me.frameSize=frameInfo,frameInfo},getFramingInfoCls:function(){return this.baseCls+"-"+this.ui},getStyleProxy:function(cls){var result=this.styleProxyEl||(Ext.AbstractComponent.prototype.styleProxyEl=Ext.getBody().createChild({role:"presentation",style:{position:"absolute",top:"-10000px"}},null,!0));return result.className=cls,result},getFrameTpl:function(table){return this.getTpl(table?"frameTableTpl":"frameTpl")},frameInfoCache:{}}),Ext.define("Ext.state.Provider",{mixins:{observable:Ext.util.Observable},prefix:"ext-",constructor:function(config){config=config||{};var me=this;Ext.apply(me,config),me.addEvents("statechange"),me.state={},me.mixins.observable.constructor.call(me)},get:function(name,defaultValue){return"undefined"==typeof this.state[name]?defaultValue:this.state[name]},clear:function(name){var me=this;delete me.state[name],me.fireEvent("statechange",me,name,null)},set:function(name,value){var me=this;me.state[name]=value,me.fireEvent("statechange",me,name,value)},decodeValue:function(value){var all,type,keyValue,values,vLen,v,me=this,re=/^(a|n|d|b|s|o|e)\:(.*)$/,matches=re.exec(unescape(value));if(matches&&matches[1])switch(type=matches[1],value=matches[2],type){case"e":return null;case"n":return parseFloat(value);case"d":return new Date(Date.parse(value));case"b":return"1"==value;case"a":if(all=[],""!=value)for(values=value.split("^"),vLen=values.length,v=0;v<vLen;v++)value=values[v],all.push(me.decodeValue(value));return all;case"o":if(all={},""!=value)for(values=value.split("^"),vLen=values.length,v=0;v<vLen;v++)value=values[v],keyValue=value.split("="),all[keyValue[0]]=me.decodeValue(keyValue[1]);return all;default:return value}},encodeValue:function(value){var enc,len,key,flat="",i=0;if(null==value)return"e:1";if("number"==typeof value)enc="n:"+value;else if("boolean"==typeof value)enc="b:"+(value?"1":"0");else if(Ext.isDate(value))enc="d:"+value.toGMTString();else if(Ext.isArray(value)){for(len=value.length;i<len;i++)flat+=this.encodeValue(value[i]),i!=len-1&&(flat+="^");enc="a:"+flat}else if("object"==typeof value){for(key in value)"function"!=typeof value[key]&&void 0!==value[key]&&(flat+=key+"="+this.encodeValue(value[key])+"^");enc="o:"+flat.substring(0,flat.length-1)}else enc="s:"+value;return escape(enc)}}),Ext.define("Ext.state.Manager",{singleton:!0,constructor:function(){this.provider=new Ext.state.Provider},setProvider:function(stateProvider){this.provider=stateProvider},get:function(key,defaultValue){return this.provider.get(key,defaultValue)},set:function(key,value){this.provider.set(key,value)},clear:function(key){this.provider.clear(key)},getProvider:function(){return this.provider}}),Ext.define("Ext.state.Stateful",{mixins:{observable:Ext.util.Observable},stateful:!1,saveDelay:100,constructor:function(config){var me=this;config=config||{},void 0!==config.stateful&&(me.stateful=config.stateful),void 0!==config.saveDelay&&(me.saveDelay=config.saveDelay),me.stateId=me.stateId||config.stateId,me.stateEvents||(me.stateEvents=[]),config.stateEvents&&me.stateEvents.concat(config.stateEvents),this.addEvents("beforestaterestore","staterestore","beforestatesave","statesave"),me.mixins.observable.constructor.call(me),me.stateful!==!1&&(me.addStateEvents(me.stateEvents),me.initState())},addStateEvents:function(events){var i,event,stateEventsByName,me=this;if(me.stateful&&me.getStateId())for("string"==typeof events&&(events=Array.prototype.slice.call(arguments,0)),stateEventsByName=me.stateEventsByName||(me.stateEventsByName={}),i=events.length;i--;)event=events[i],stateEventsByName[event]||(stateEventsByName[event]=1,me.on(event,me.onStateChange,me))},onStateChange:function(){var statics,runner,me=this,delay=me.saveDelay;me.stateful&&(delay?(me.stateTask||(statics=Ext.state.Stateful,runner=statics.runner||(statics.runner=new Ext.util.TaskRunner),me.stateTask=runner.newTask({run:me.saveState,scope:me,interval:delay,repeat:1})),me.stateTask.start()):me.saveState())},saveState:function(){var state,me=this,id=me.stateful&&me.getStateId(),hasListeners=me.hasListeners;id&&(state=me.getState()||{},hasListeners.beforestatesave&&me.fireEvent("beforestatesave",me,state)===!1||(Ext.state.Manager.set(id,state),hasListeners.statesave&&me.fireEvent("statesave",me,state)))},getState:function(){return null},applyState:function(state){state&&Ext.apply(this,state)},getStateId:function(){var me=this;return me.stateId||(me.autoGenId?null:me.id)},initState:function(){var state,me=this,id=me.stateful&&me.getStateId(),hasListeners=me.hasListeners;id&&(state=Ext.state.Manager.get(id),state&&(state=Ext.apply({},state),hasListeners.beforestaterestore&&me.fireEvent("beforestaterestore",me,state)===!1||(me.applyState(state),hasListeners.staterestore&&me.fireEvent("staterestore",me,state))))},savePropToState:function(propName,state,stateName){var me=this,value=me[propName],config=me.initialConfig;return!(!me.hasOwnProperty(propName)||config&&config[propName]===value)&&(state&&(state[stateName||propName]=value),!0)},savePropsToState:function(propNames,state){var i,n,me=this;if("string"==typeof propNames)me.savePropToState(propNames,state);else for(i=0,n=propNames.length;i<n;++i)me.savePropToState(propNames[i],state);return state},destroy:function(){var me=this,task=me.stateTask;task&&(task.destroy(),me.stateTask=null),me.clearListeners()}}),Ext.define("Ext.AbstractComponent",{mixins:{positionable:Ext.util.Positionable,observable:Ext.util.Observable,animate:Ext.util.Animate,elementCt:Ext.util.ElementContainer,renderable:Ext.util.Renderable,state:Ext.state.Stateful},statics:{AUTO_ID:1e3,pendingLayouts:null,layoutSuspendCount:0,cancelLayout:function(comp,isDestroying){var context=this.runningLayoutContext||this.pendingLayouts;context&&context.cancelComponent(comp,!1,isDestroying)},flushLayouts:function(){var me=this,context=me.pendingLayouts;context&&context.invalidQueue.length&&(me.pendingLayouts=null,me.runningLayoutContext=context,Ext.override(context,{runComplete:function(){me.runningLayoutContext=null;var result=this.callParent();return Ext.globalEvents.hasListeners.afterlayout&&Ext.globalEvents.fireEvent("afterlayout"),result}}),context.run())},resumeLayouts:function(flush){this.layoutSuspendCount&&!--this.layoutSuspendCount&&(flush&&this.flushLayouts(),Ext.globalEvents.hasListeners.resumelayouts&&Ext.globalEvents.fireEvent("resumelayouts"))},suspendLayouts:function(){++this.layoutSuspendCount},updateLayout:function(comp,defer){var pending,me=this,running=me.runningLayoutContext;running?running.queueInvalidate(comp):(pending=me.pendingLayouts||(me.pendingLayouts=new Ext.layout.Context),pending.queueInvalidate(comp),defer||me.layoutSuspendCount||comp.isLayoutSuspended()||me.flushLayouts())}},isComponent:!0,getAutoId:function(){return this.autoGenId=!0,++Ext.AbstractComponent.AUTO_ID},deferLayouts:!1,autoGenId:!1,renderTpl:"{%this.renderContent(out,values)%}",frameSize:null,tplWriteMode:"overwrite",baseCls:Ext.baseCSSPrefix+"component",disabledCls:Ext.baseCSSPrefix+"item-disabled",ui:"default",uiCls:[],hidden:!1,disabled:!1,draggable:!1,floating:!1,hideMode:"display",autoShow:!1,autoRender:!1,allowDomMove:!0,rendered:!1,componentLayoutCounter:0,shrinkWrap:2,weight:0,maskOnDisable:!0,_isLayoutRoot:!1,contentPaddingProperty:"padding",horizontalPosProp:"left",borderBoxCls:Ext.baseCSSPrefix+"border-box",rootCls:Ext.baseCSSPrefix+"body",constructor:function(config){var i,len,xhooks,me=this;if(config?(Ext.apply(me,config),xhooks=me.xhooks,xhooks&&(delete me.xhooks,Ext.override(me,xhooks))):config={},me.initialConfig=config,me.mixins.elementCt.constructor.call(me),me.addEvents("beforeactivate","activate","beforedeactivate","deactivate","added","disable","enable","beforeshow","show","beforehide","hide","removed","beforerender","render","afterrender","boxready","beforedestroy","destroy","resize","move","focus","blur"),me.getId(),me.setupProtoEl(),me.cls&&(me.initialCls=me.cls,me.protoEl.addCls(me.cls)),me.style&&(me.initialStyle=me.style,me.protoEl.setStyle(me.style)),me.renderData=me.renderData||{},me.renderSelectors=me.renderSelectors||{},me.plugins&&(me.plugins=me.constructPlugins()),me.hasListeners||(me.hasListeners=new me.HasListeners),me.initComponent(),Ext.ComponentManager.register(me),me.mixins.observable.constructor.call(me),me.mixins.state.constructor.call(me,config),this.addStateEvents("resize"),me.plugins)for(i=0,len=me.plugins.length;i<len;i++)me.plugins[i]=me.initPlugin(me.plugins[i]);me.loader=me.getLoader(),me.renderTo&&me.render(me.renderTo),me.autoShow&&!me.isContained&&me.show()},initComponent:function(){var me=this;me.plugins&&!me.plugins.processed&&(me.plugins=me.constructPlugins()),me.setSize(me.width,me.height)},getState:function(){var me=this,state=null,sizeModel=me.getSizeModel();return sizeModel.width.configured&&(state=me.addPropertyToState(state,"width")),sizeModel.height.configured&&(state=me.addPropertyToState(state,"height")),state},addPropertyToState:function(state,propName,value){var me=this,len=arguments.length;return(3==len||me.hasOwnProperty(propName))&&(len<3&&(value=me[propName]),value!==me.initialConfig[propName]&&((state||(state={}))[propName]=value)),state},show:Ext.emptyFn,animate:function(animObj){var hasToWidth,hasToHeight,toHeight,toWidth,to,clearWidth,clearHeight,curWidth,w,curHeight,h,isExpanding,wasConstrained,wasConstrainedHeader,passedCallback,oldOverflow,me=this;return animObj=animObj||{},to=animObj.to||{},Ext.fx.Manager.hasFxBlock(me.id)?me:(hasToWidth=Ext.isDefined(to.width),hasToWidth&&(toWidth=Ext.Number.constrain(to.width,me.minWidth,me.maxWidth)),hasToHeight=Ext.isDefined(to.height),hasToHeight&&(toHeight=Ext.Number.constrain(to.height,me.minHeight,me.maxHeight)),animObj.dynamic||!hasToWidth&&!hasToHeight||(curWidth=(animObj.from?animObj.from.width:void 0)||me.getWidth(),w=curWidth,curHeight=(animObj.from?animObj.from.height:void 0)||me.getHeight(),h=curHeight,isExpanding=!1,hasToHeight&&toHeight>curHeight&&(h=toHeight,isExpanding=!0),hasToWidth&&toWidth>curWidth&&(w=toWidth,isExpanding=!0),(hasToHeight||hasToWidth)&&(oldOverflow=me.el.getStyle("overtflow"),"hidden"!==oldOverflow&&me.el.setStyle("overflow","hidden")),isExpanding&&(clearWidth=!Ext.isNumber(me.width),clearHeight=!Ext.isNumber(me.height),me.setSize(w,h),me.el.setSize(curWidth,curHeight),clearWidth&&delete me.width,clearHeight&&delete me.height),hasToWidth&&(to.width=toWidth),hasToHeight&&(to.height=toHeight)),wasConstrained=me.constrain,wasConstrainedHeader=me.constrainHeader,(wasConstrained||wasConstrainedHeader)&&(me.constrain=me.constrainHeader=!1,passedCallback=animObj.callback,animObj.callback=function(){me.constrain=wasConstrained,me.constrainHeader=wasConstrainedHeader,passedCallback&&passedCallback.call(animObj.scope||me,arguments),"hidden"!==oldOverflow&&me.el.setStyle("overflow",oldOverflow)}),me.mixins.animate.animate.apply(me,arguments))},setHiddenState:function(hidden){var hierarchyState=this.getHierarchyState();this.hidden=hidden,hidden?hierarchyState.hidden=!0:delete hierarchyState.hidden},onHide:function(){this.ownerLayout&&this.updateLayout({isRoot:!1})},onShow:function(){this.updateLayout({isRoot:!1})},constructPlugin:function(plugin){var me=this;return plugin="string"==typeof plugin?Ext.PluginManager.create({},plugin,me):Ext.PluginManager.create(plugin,null,me)},constructPlugins:function(){var result,i,len,me=this,plugins=me.plugins;if(plugins)for(result=[],result.processed=!0,Ext.isArray(plugins)||(plugins=[plugins]),i=0,len=plugins.length;i<len;i++)result[i]=me.constructPlugin(plugins[i]);return me.pluginsInitialized=!0,result},initPlugin:function(plugin){return plugin.init(this),plugin},addPlugin:function(plugin){var me=this;return plugin=me.constructPlugin(plugin),me.plugins?me.plugins.push(plugin):me.plugins=[plugin],
me.pluginsInitialized&&me.initPlugin(plugin),plugin},removePlugin:function(plugin){Ext.Array.remove(this.plugins,plugin),plugin.destroy()},findPlugin:function(ptype){var i,plugins=this.plugins,ln=plugins&&plugins.length;for(i=0;i<ln;i++)if(plugins[i].ptype===ptype)return plugins[i]},getPlugin:function(pluginId){var i,plugins=this.plugins,ln=plugins&&plugins.length;for(i=0;i<ln;i++)if(plugins[i].pluginId===pluginId)return plugins[i]},beforeLayout:Ext.emptyFn,registerFloatingItem:function(cmp){var me=this;me.floatingDescendants||(me.floatingDescendants=new Ext.ZIndexManager(me)),me.floatingDescendants.register(cmp)},unregisterFloatingItem:function(cmp){var me=this;me.floatingDescendants&&me.floatingDescendants.unregister(cmp)},layoutSuspendCount:0,suspendLayouts:function(){var me=this;me.rendered&&1==++me.layoutSuspendCount&&(me.suspendLayout=!0)},resumeLayouts:function(flushOptions){var me=this;me.rendered&&(--me.layoutSuspendCount||(me.suspendLayout=!1,flushOptions&&!me.isLayoutSuspended()&&me.updateLayout(flushOptions)))},setupProtoEl:function(){var cls=this.initCls();this.protoEl=new Ext.util.ProtoElement({cls:cls.join(" ")})},initCls:function(){var me=this,cls=[me.baseCls,me.getComponentLayout().targetCls];return Ext.isDefined(me.cmpCls)&&(Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.Component: cmpCls has been deprecated. Please use componentCls."),me.componentCls=me.cmpCls,delete me.cmpCls),me.componentCls?cls.push(me.componentCls):me.componentCls=me.baseCls,cls},setUI:function(ui){var classes,me=this,uiCls=me.uiCls,activeUI=me.activeUI;ui!==activeUI&&(activeUI?(classes=me.removeClsWithUI(uiCls,!0),classes.length&&me.removeCls(classes),me.removeUIFromElement()):me.uiCls=[],me.ui=ui,me.activeUI=ui,me.addUIToElement(),classes=me.addClsWithUI(uiCls,!0),classes.length&&me.addCls(classes),me.rendered&&me.updateLayout())},addClsWithUI:function(classes,skip){var length,cls,me=this,clsArray=[],i=0,uiCls=me.uiCls=Ext.Array.clone(me.uiCls),activeUI=me.activeUI;for("string"==typeof classes&&(classes=classes.indexOf(" ")<0?[classes]:Ext.String.splitWords(classes)),length=classes.length;i<length;i++)cls=classes[i],cls&&!me.hasUICls(cls)&&(uiCls.push(cls),activeUI&&(clsArray=clsArray.concat(me.addUIClsToElement(cls))));return skip!==!0&&activeUI&&me.addCls(clsArray),clsArray},removeClsWithUI:function(classes,skip){var length,cls,me=this,clsArray=[],i=0,extArray=Ext.Array,remove=extArray.remove,uiCls=me.uiCls=extArray.clone(me.uiCls),activeUI=me.activeUI;for("string"==typeof classes&&(classes=classes.indexOf(" ")<0?[classes]:Ext.String.splitWords(classes)),length=classes.length,i=0;i<length;i++)cls=classes[i],cls&&me.hasUICls(cls)&&(remove(uiCls,cls),activeUI&&(clsArray=clsArray.concat(me.removeUIClsFromElement(cls))));return skip!==!0&&activeUI&&me.removeCls(clsArray),clsArray},hasUICls:function(cls){var me=this,uiCls=me.uiCls||[];return Ext.Array.contains(uiCls,cls)},frameElementsArray:["tl","tc","tr","ml","mc","mr","bl","bc","br"],addUIClsToElement:function(cls){var frameElementsArray,frameElementsLength,i,el,frameElement,me=this,baseClsUi=me.baseCls+"-"+me.ui+"-"+cls,result=[Ext.baseCSSPrefix+cls,me.baseCls+"-"+cls,baseClsUi];if(me.rendered&&me.frame&&!Ext.supports.CSS3BorderRadius)for(frameElementsArray=me.frameElementsArray,frameElementsLength=frameElementsArray.length,i=0;i<frameElementsLength;i++)frameElement=frameElementsArray[i],el=me["frame"+frameElement.toUpperCase()],el&&el.addCls(baseClsUi+"-"+frameElement);return result},removeUIClsFromElement:function(cls){var frameElementsArray,frameElementsLength,i,el,frameElement,me=this,baseClsUi=me.baseCls+"-"+me.ui+"-"+cls,result=[Ext.baseCSSPrefix+cls,me.baseCls+"-"+cls,baseClsUi];if(me.rendered&&me.frame&&!Ext.supports.CSS3BorderRadius)for(frameElementsArray=me.frameElementsArray,frameElementsLength=frameElementsArray.length,i=0;i<frameElementsLength;i++)frameElement=frameElementsArray[i],el=me["frame"+frameElement.toUpperCase()],el&&el.removeCls(baseClsUi+"-"+frameElement);return result},addUIToElement:function(){var frameElementsArray,frameElementsLength,i,el,frameElement,me=this,baseClsUI=me.baseCls+"-"+me.ui;if(me.addCls(baseClsUI),me.rendered&&me.frame&&!Ext.supports.CSS3BorderRadius)for(frameElementsArray=me.frameElementsArray,frameElementsLength=frameElementsArray.length,i=0;i<frameElementsLength;i++)frameElement=frameElementsArray[i],el=me["frame"+frameElement.toUpperCase()],el&&el.addCls(baseClsUI+"-"+frameElement)},removeUIFromElement:function(){var frameElementsArray,frameElementsLength,i,el,frameElement,me=this,baseClsUI=me.baseCls+"-"+me.ui;if(me.removeCls(baseClsUI),me.rendered&&me.frame&&!Ext.supports.CSS3BorderRadius)for(frameElementsArray=me.frameElementsArray,frameElementsLength=frameElementsArray.length,i=0;i<frameElementsLength;i++)frameElement=frameElementsArray[i],el=me["frame"+frameElement.toUpperCase()],el&&el.removeCls(baseClsUI+"-"+frameElement)},getTpl:function(name){return Ext.XTemplate.getTpl(this,name)},initStyles:function(targetEl){var width,height,me=this,margin=(Ext.Element,me.margin),border=me.border,cls=me.cls,style=me.style,x=me.x,y=me.y;me.initPadding(targetEl),null!=margin&&targetEl.setStyle("margin",this.unitizeBox(margin===!0?5:margin)),null!=border&&me.setBorder(border,targetEl),cls&&cls!=me.initialCls&&(targetEl.addCls(cls),me.cls=me.initialCls=null),style&&style!=me.initialStyle&&(targetEl.setStyle(style),me.style=me.initialStyle=null),null!=x&&targetEl.setStyle(me.horizontalPosProp,"number"==typeof x?x+"px":x),null!=y&&targetEl.setStyle("top","number"==typeof y?y+"px":y),me.ownerCt&&!me.floating||(Ext.scopeCss&&targetEl.addCls(me.rootCls),Ext.isBorderBox&&targetEl.addCls(me.borderBoxCls)),me.getFrameInfo()||(width=me.width,height=me.height,null!=width&&("number"==typeof width?Ext.isBorderBox&&targetEl.setStyle("width",width+"px"):targetEl.setStyle("width",width)),null!=height&&("number"==typeof height?Ext.isBorderBox&&targetEl.setStyle("height",height+"px"):targetEl.setStyle("height",height)))},initPadding:function(targetEl){var me=this,padding=me.padding;null!=padding&&(me.layout&&me.layout.managePadding&&"padding"===me.contentPaddingProperty?targetEl.setStyle("padding",0):targetEl.setStyle("padding",this.unitizeBox(padding===!0?5:padding)))},parseBox:function(box){return Ext.dom.Element.parseBox(box)},unitizeBox:function(box){return Ext.dom.Element.unitizeBox(box)},setMargin:function(margin,preventLayout){var me=this;me.rendered?(margin||0===margin?(margin===!0&&(margin=5),margin=this.unitizeBox(margin)):margin="",me.getTargetEl().setStyle("margin",margin),preventLayout||me.updateLayout()):me.margin=margin},initEvents:function(){var afterRenderEvent,el,property,index,len,me=this,afterRenderEvents=me.afterRenderEvents;if(afterRenderEvents)for(property in afterRenderEvents)if(el=me[property],el&&el.on)for(afterRenderEvent=afterRenderEvents[property],index=0,len=afterRenderEvent.length;index<len;++index)me.mon(el,afterRenderEvent[index]);me.addFocusListener()},addFocusListener:function(){var needsTabIndex,me=this,focusEl=me.getFocusEl();if(focusEl){if(focusEl.isComponent)return focusEl.addFocusListener();needsTabIndex=focusEl.needsTabIndex(),me.focusListenerAdded||needsTabIndex&&!Ext.FocusManager.enabled||(needsTabIndex&&(focusEl.dom.tabIndex=-1),focusEl.on({focus:me.onFocus,blur:me.onBlur,scope:me}),me.focusListenerAdded=!0)}},getFocusEl:Ext.emptyFn,isFocusable:function(){var focusEl,me=this;if(me.focusable!==!1&&(focusEl=me.getFocusEl())&&me.rendered&&!me.destroying&&!me.isDestroyed&&!me.disabled&&me.isVisible(!0))return focusEl.isFocusable(!0)},beforeFocus:Ext.emptyFn,onFocus:function(e){var me=this,focusCls=me.focusCls,focusEl=me.getFocusEl();me.disabled||(me.beforeFocus(e),focusCls&&focusEl&&focusEl.addCls(me.addClsWithUI(focusCls,!0)),me.hasFocus||(me.hasFocus=!0,me.fireEvent("focus",me,e)))},beforeBlur:Ext.emptyFn,onBlur:function(e){var me=this,focusCls=me.focusCls,focusEl=me.getFocusEl();me.destroying||(me.beforeBlur(e),focusCls&&focusEl&&focusEl.removeCls(me.removeClsWithUI(focusCls,!0)),me.validateOnBlur&&me.validate(),me.hasFocus=!1,me.fireEvent("blur",me,e),me.postBlur(e))},postBlur:Ext.emptyFn,is:function(selector){return Ext.ComponentQuery.is(this,selector)},up:function(selector,limit){var result=this.getRefOwner(),limitSelector="string"==typeof limit,limitCount="number"==typeof limit,limitComponent=limit&&limit.isComponent,steps=0;if(selector)for(;result;result=result.getRefOwner()){if(steps++,selector.isComponent){if(result===selector)return result}else if(Ext.ComponentQuery.is(result,selector))return result;if(limitSelector&&result.is(limit))return;if(limitCount&&steps===limit)return;if(limitComponent&&result===limit)return}return result},nextSibling:function(selector){var it,last,idx,c,o=this.ownerCt;if(o&&(it=o.items,idx=it.indexOf(this)+1))if(selector){for(last=it.getCount();idx<last;idx++)if((c=it.getAt(idx)).is(selector))return c}else if(idx<it.getCount())return it.getAt(idx);return null},previousSibling:function(selector){var it,idx,c,o=this.ownerCt;if(o&&(it=o.items,idx=it.indexOf(this),idx!=-1))if(selector){for(--idx;idx>=0;idx--)if((c=it.getAt(idx)).is(selector))return c}else if(idx)return it.getAt(--idx);return null},previousNode:function(selector,includeSelf){var result,it,i,sib,node=this,ownerCt=node.ownerCt;if(includeSelf&&node.is(selector))return node;if(ownerCt){for(it=ownerCt.items.items,i=Ext.Array.indexOf(it,node)-1;i>-1;i--){if(sib=it[i],sib.query&&(result=sib.query(selector),result=result[result.length-1]))return result;if(sib.is(selector))return sib}return ownerCt.previousNode(selector,!0)}return null},nextNode:function(selector,includeSelf){var result,it,len,i,sib,node=this,ownerCt=node.ownerCt;if(includeSelf&&node.is(selector))return node;if(ownerCt){for(it=ownerCt.items.items,i=Ext.Array.indexOf(it,node)+1,len=it.length;i<len;i++){if(sib=it[i],sib.is(selector))return sib;if(sib.down&&(result=sib.down(selector)))return result}return ownerCt.nextNode(selector)}return null},getId:function(){return this.id||(this.id="ext-comp-"+this.getAutoId())},getItemId:function(){return this.itemId||this.id},getEl:function(){return this.el},getTargetEl:function(){return this.frameBody||this.el},getOverflowEl:function(){return this.getTargetEl()},getOverflowStyle:function(){var ox,oy,overflowStyle,me=this,result=null,auto=me.autoScroll;return"boolean"==typeof auto?(result={overflow:overflowStyle=auto?"auto":""},me.scrollFlags={overflowX:overflowStyle,overflowY:overflowStyle,x:auto,y:auto,both:auto}):(ox=me.overflowX,oy=me.overflowY,void 0!==ox||void 0!==oy?(ox&&ox===!0&&(ox="auto"),oy&&oy===!0&&(oy="auto"),result={overflowX:ox=ox||"",overflowY:oy=oy||""},me.scrollFlags={overflowX:ox,overflowY:oy,x:ox="auto"===ox||"scroll"===ox,y:oy="auto"===oy||"scroll"===oy,both:ox&&oy}):me.scrollFlags={overflowX:"",overflowY:"",x:!1,y:!1,both:!1}),result&&Ext.isIE7m&&(result.position="relative"),result},isXType:function(xtype,shallow){return shallow?this.xtype===xtype:this.xtypesMap[xtype]},getXTypes:function(){var xtypes,parentPrototype,parentXtypes,self=this.self;if(!self.xtypes){for(xtypes=[],parentPrototype=this;parentPrototype;)parentXtypes=parentPrototype.xtypes,void 0!==parentXtypes&&xtypes.unshift.apply(xtypes,parentXtypes),parentPrototype=parentPrototype.superclass;self.xtypeChain=xtypes,self.xtypes=xtypes.join("/")}return self.xtypes},update:function(htmlOrData,loadScripts,cb){var el,me=this,isData=me.tpl&&!Ext.isString(htmlOrData);isData?me.data=htmlOrData:me.html=Ext.isObject(htmlOrData)?Ext.DomHelper.markup(htmlOrData):htmlOrData,me.rendered&&(el=me.isContainer?me.layout.getRenderTarget():me.getTargetEl(),isData?me.tpl[me.tplWriteMode](el,htmlOrData||{}):el.update(me.html,loadScripts,cb),me.updateLayout())},setVisible:function(visible){return this[visible?"show":"hide"]()},isVisible:function(deep){var hidden,me=this;return me.hidden||!me.rendered||me.isDestroyed?hidden=!0:deep&&(hidden=me.isHierarchicallyHidden()),!hidden},isHierarchicallyHidden:function(){for(var parent,parentHierarchyState,child=this,hidden=!1;parent=child.ownerCt||child.floatParent;child=parent){if(parentHierarchyState=parent.getHierarchyState(),parentHierarchyState.hidden){hidden=!0;break}if(!child.getHierarchyState().collapseImmune){hidden=!!parentHierarchyState.collapsed;break}if(parent.collapsed&&!child.collapseImmune){hidden=!0;break}}return hidden},onBoxReady:function(width,height){var me=this;me.disableOnBoxReady?me.onDisable():me.enableOnBoxReady&&me.onEnable(),me.resizable&&me.initResizable(me.resizable),me.draggable&&me.initDraggable(),me.hasListeners.boxready&&me.fireEvent("boxready",me,width,height)},enable:function(silent){var me=this;return delete me.disableOnBoxReady,me.removeCls(me.disabledCls),me.rendered?me.onEnable():me.enableOnBoxReady=!0,me.disabled=!1,delete me.resetDisable,silent!==!0&&me.fireEvent("enable",me),me},disable:function(silent){var me=this;return delete me.enableOnBoxReady,me.addCls(me.disabledCls),me.rendered?me.onDisable():me.disableOnBoxReady=!0,me.disabled=!0,silent!==!0&&(delete me.resetDisable,me.fireEvent("disable",me)),me},onEnable:function(){this.maskOnDisable&&(this.el.dom.disabled=!1,this.unmask())},onDisable:function(){var me=this,focusCls=me.focusCls,focusEl=me.getFocusEl();focusCls&&focusEl&&focusEl.removeCls(me.removeClsWithUI(focusCls,!0)),me.maskOnDisable&&(me.el.dom.disabled=!0,me.mask())},mask:function(msg,msgCls,elHeight){var box=this.lastBox,target=this.getMaskTarget();box&&(elHeight=box.height),target.mask(msg,msgCls,elHeight)},unmask:function(){this.getMaskTarget().unmask()},getMaskTarget:function(){return this.el},isDisabled:function(){return this.disabled},setDisabled:function(disabled){return this[disabled?"disable":"enable"]()},isHidden:function(){return this.hidden},addCls:function(cls){var me=this,el=me.rendered?me.el:me.protoEl;return el.addCls.apply(el,arguments),me},addClass:function(){return this.addCls.apply(this,arguments)},hasCls:function(cls){var me=this,el=me.rendered?me.el:me.protoEl;return el.hasCls.apply(el,arguments)},removeCls:function(cls){var me=this,el=me.rendered?me.el:me.protoEl;return el.removeCls.apply(el,arguments),me},addOverCls:function(){var me=this;me.disabled||me.el.addCls(me.overCls)},removeOverCls:function(){this.el.removeCls(this.overCls)},addListener:function(element,listeners,scope,options){var fn,option,me=this;if(Ext.isString(element)&&(Ext.isObject(listeners)||options&&options.element)){if(options.element){fn=listeners,listeners={},listeners[element]=fn,element=options.element,scope&&(listeners.scope=scope);for(option in options)options.hasOwnProperty(option)&&me.eventOptionsRe.test(option)&&(listeners[option]=options[option])}return void(me[element]&&me[element].on?me.mon(me[element],listeners):(me.afterRenderEvents=me.afterRenderEvents||{},me.afterRenderEvents[element]||(me.afterRenderEvents[element]=[]),me.afterRenderEvents[element].push(listeners)))}return me.mixins.observable.addListener.apply(me,arguments)},removeManagedListenerItem:function(isClear,managedListener,item,ename,fn,scope){var me=this,element=managedListener.options?managedListener.options.element:null;return element?(element=me[element],void(element&&element.un&&(!isClear&&(managedListener.item!==item||managedListener.ename!==ename||fn&&managedListener.fn!==fn||scope&&managedListener.scope!==scope)||(element.un(managedListener.ename,managedListener.fn,managedListener.scope),isClear||Ext.Array.remove(me.managedListeners,managedListener))))):me.mixins.observable.removeManagedListenerItem.apply(me,arguments)},getBubbleTarget:function(){return this.ownerCt},isFloating:function(){return this.floating},isDraggable:function(){return!!this.draggable},isDroppable:function(){return!!this.droppable},onAdded:function(container,pos){var me=this;me.ownerCt=container,me.hierarchyState&&(me.hierarchyState.invalid=!0,delete me.hierarchyState),me.hasListeners.added&&me.fireEvent("added",me,container,pos)},onRemoved:function(destroying){var me=this;me.hasListeners.removed&&me.fireEvent("removed",me,me.ownerCt),delete me.ownerCt,delete me.ownerLayout},beforeDestroy:Ext.emptyFn,onResize:function(width,height,oldWidth,oldHeight){var me=this;me.floating&&me.constrain&&me.doConstrain(),me.hasListeners.resize&&me.fireEvent("resize",me,width,height,oldWidth,oldHeight)},setSize:function(width,height){var me=this;return width&&"object"==typeof width&&(height=width.height,width=width.width),"number"==typeof width?me.width=Ext.Number.constrain(width,me.minWidth,me.maxWidth):null===width&&delete me.width,"number"==typeof height?me.height=Ext.Number.constrain(height,me.minHeight,me.maxHeight):null===height&&delete me.height,me.rendered&&me.isVisible()&&me.updateLayout({isRoot:!1}),me},isLayoutRoot:function(){var me=this,ownerLayout=me.ownerLayout;return!(ownerLayout&&!me._isLayoutRoot&&!me.floating)||ownerLayout.isItemLayoutRoot(me)},isLayoutSuspended:function(){for(var ownerLayout,comp=this;comp;){if(comp.layoutSuspendCount||comp.suspendLayout)return!0;if(ownerLayout=comp.ownerLayout,!ownerLayout)break;comp=ownerLayout.owner}return!1},updateLayout:function(options){var defer,me=this,lastBox=me.lastBox,isRoot=options&&options.isRoot;lastBox&&(lastBox.invalid=!0),!me.rendered||me.layoutSuspendCount||me.suspendLayout||(me.hidden?Ext.AbstractComponent.cancelLayout(me):"boolean"!=typeof isRoot&&(isRoot=me.isLayoutRoot()),!isRoot&&me.ownerLayout&&me.ownerLayout.onContentChange(me)||me.isLayoutSuspended()||(defer=options&&options.hasOwnProperty("defer")?options.defer:me.deferLayouts,Ext.AbstractComponent.updateLayout(me,defer)))},getSizeModel:function(ownerCtSizeModel){var typeofWidth,typeofHeight,hasPixelWidth,hasPixelHeight,heightModel,ownerLayout,policy,shrinkWrap,topLevel,widthModel,me=this,models=Ext.layout.SizeModel,ownerContext=me.componentLayout.ownerContext,width=me.width,height=me.height;return ownerContext&&(widthModel=ownerContext.widthModel,heightModel=ownerContext.heightModel),widthModel&&heightModel||(hasPixelWidth="number"==(typeofWidth=typeof width),hasPixelHeight="number"==(typeofHeight=typeof height),topLevel=me.floating||!(ownerLayout=me.ownerLayout),topLevel?(policy=Ext.layout.Layout.prototype.autoSizePolicy,shrinkWrap=me.floating?3:me.shrinkWrap,hasPixelWidth&&(widthModel=models.configured),hasPixelHeight&&(heightModel=models.configured)):(policy=ownerLayout.getItemSizePolicy(me,ownerCtSizeModel),shrinkWrap=ownerLayout.isItemShrinkWrap(me)),ownerContext&&(ownerContext.ownerSizePolicy=policy),shrinkWrap=shrinkWrap===!0?3:shrinkWrap||0,topLevel&&shrinkWrap&&(width&&"string"==typeofWidth&&(shrinkWrap&=2),height&&"string"==typeofHeight&&(shrinkWrap&=1)),3!==shrinkWrap&&(ownerCtSizeModel||(ownerCtSizeModel=me.ownerCt&&me.ownerCt.getSizeModel()),ownerCtSizeModel&&(shrinkWrap|=(ownerCtSizeModel.width.shrinkWrap?1:0)|(ownerCtSizeModel.height.shrinkWrap?2:0))),widthModel||(widthModel=policy.setsWidth?policy.readsWidth?hasPixelWidth?models.calculatedFromConfigured:1&shrinkWrap?models.calculatedFromShrinkWrap:models.calculatedFromNatural:models.calculated:hasPixelWidth?models.configured:1&shrinkWrap?models.shrinkWrap:models.natural),heightModel||(heightModel=policy.setsHeight?policy.readsHeight?hasPixelHeight?models.calculatedFromConfigured:2&shrinkWrap?models.calculatedFromShrinkWrap:models.calculatedFromNatural:models.calculated:hasPixelHeight?models.configured:2&shrinkWrap?models.shrinkWrap:models.natural)),widthModel.pairsByHeightOrdinal[heightModel.ordinal]},isDescendant:function(ancestor){if(ancestor.isContainer)for(var c=this.ownerCt;c;c=c.ownerCt)if(c===ancestor)return!0;return!1},doComponentLayout:function(){return this.updateLayout(),this},forceComponentLayout:function(){this.updateLayout()},setComponentLayout:function(layout){var currentLayout=this.componentLayout;currentLayout&&currentLayout.isLayout&&currentLayout!=layout&&currentLayout.setOwner(null),this.componentLayout=layout,layout.setOwner(this)},getComponentLayout:function(){var me=this;return me.componentLayout&&me.componentLayout.isLayout||me.setComponentLayout(Ext.layout.Layout.create(me.componentLayout,"autocomponent")),me.componentLayout},afterComponentLayout:function(width,height,oldWidth,oldHeight){var me=this;1===++me.componentLayoutCounter&&me.afterFirstLayout(width,height),width===oldWidth&&height===oldHeight||me.onResize(width,height,oldWidth,oldHeight)},beforeComponentLayout:function(width,height){return!0},setPosition:function(x,y,animate){var me=this,pos=me.beforeSetPosition.apply(me,arguments);return pos&&me.rendered&&(x=pos.x,y=pos.y,animate?x===me.getLocalX()&&y===me.getLocalY()||(me.stopAnimation(),me.animate(Ext.apply({duration:1e3,listeners:{afteranimate:Ext.Function.bind(me.afterSetPosition,me,[x,y])},to:{left:x,top:y}},animate))):(me.setLocalXY(x,y),me.afterSetPosition(x,y))),me},beforeSetPosition:function(x,y,animate){var pos,x0;return x&&(Ext.isNumber(x0=x[0])?(animate=y,y=x[1],x=x0):void 0!==(x0=x.x)&&(animate=y,y=x.y,x=x0)),(this.constrain||this.constrainHeader)&&(pos=this.calculateConstrainedPosition(null,[x,y],!0),pos&&(x=pos[0],y=pos[1])),pos={x:this.x=x,y:this.y=y,anim:animate,hasX:void 0!==x,hasY:void 0!==y},pos.hasX||pos.hasY?pos:null},afterSetPosition:function(x,y){var me=this;me.onPosition(x,y),me.hasListeners.move&&me.fireEvent("move",me,x,y)},onPosition:Ext.emptyFn,setWidth:function(width){return this.setSize(width)},setHeight:function(height){return this.setSize(void 0,height)},getSize:function(contentSize){return this.el.getSize(contentSize)},getWidth:function(){return this.el.getWidth()},getHeight:function(){return this.el.getHeight()},getLoader:function(){var me=this,autoLoad=me.autoLoad?Ext.isObject(me.autoLoad)?me.autoLoad:{url:me.autoLoad}:null,loader=me.loader||autoLoad;return loader?(loader.isLoader?loader.setTarget(me):me.loader=new Ext.ComponentLoader(Ext.apply({target:me,autoLoad:autoLoad},loader)),me.loader):null},setDocked:function(dock,layoutParent){var me=this;return me.dock=dock,layoutParent&&me.ownerCt&&me.rendered&&me.ownerCt.updateLayout(),me},setBorder:function(border,targetEl){var me=this,initial=!!targetEl;(me.rendered||initial)&&(initial||(targetEl=me.el),border=border?border===!0?"1px":this.unitizeBox(border):0,targetEl.setStyle("border-width",border),initial||me.updateLayout()),me.border=border},onDestroy:function(){var me=this;me.monitorResize&&Ext.EventManager.resizeEvent&&Ext.EventManager.resizeEvent.removeListener(me.setSize,me),Ext.destroy(me.componentLayout,me.loadMask,me.floatingDescendants)},destroy:function(){var selector,el,me=this,selectors=me.renderSelectors;if(!(me.isDestroyed||me.hasListeners.beforedestroy&&me.fireEvent("beforedestroy",me)===!1)){if(me.destroying=!0,me.beforeDestroy(),me.floating?(delete me.floatParent,me.zIndexManager&&me.zIndexManager.unregister(me)):me.ownerCt&&me.ownerCt.remove&&me.ownerCt.remove(me,!1),me.stopAnimation(),me.onDestroy(),Ext.destroy(me.plugins),me.hasListeners.destroy&&me.fireEvent("destroy",me),Ext.ComponentManager.unregister(me),me.mixins.state.destroy.call(me),me.clearListeners(),me.rendered){if(me.preserveElOnDestroy||me.el.remove(),me.mixins.elementCt.destroy.call(me),selectors)for(selector in selectors)selectors.hasOwnProperty(selector)&&(el=me[selector],el&&(delete me[selector],el.remove()));delete me.el,delete me.frameBody,delete me.rendered}me.destroying=!1,me.isDestroyed=!0}},isDescendantOf:function(container){return!!this.findParentBy(function(p){return p===container})},getHierarchyState:function(inner){var parent,layout,hierarchyStateInner,getInner,me=this,hierarchyState=inner&&me.hierarchyStateInner||me.hierarchyState,ownerCt=me.ownerCt;return hierarchyState&&!hierarchyState.invalid||(parent=me.getRefOwner(),ownerCt&&(getInner=me.ownerLayout===ownerCt.layout),me.hierarchyState=hierarchyState=Ext.Object.chain(parent?parent.getHierarchyState(getInner):Ext.rootHierarchyState),me.initHierarchyState(hierarchyState),(layout=me.componentLayout).initHierarchyState&&layout.initHierarchyState(hierarchyState),me.isContainer&&(me.hierarchyStateInner=hierarchyStateInner=Ext.Object.chain(hierarchyState),layout=me.layout,layout&&layout.initHierarchyState&&layout.initHierarchyState(hierarchyStateInner,hierarchyState),inner&&(hierarchyState=hierarchyStateInner))),hierarchyState},initHierarchyState:function(hierarchyState){var me=this;me.collapsed&&(hierarchyState.collapsed=!0),me.hidden&&(hierarchyState.hidden=!0),me.collapseImmune&&(hierarchyState.collapseImmune=!0)},getAnchorToXY:function(el,anchor,local,mySize){return el.getAnchorXY(anchor,local,mySize)},getBorderPadding:function(){return this.el.getBorderPadding()},getLocalX:function(){return this.el.getLocalX()},getLocalXY:function(){return this.el.getLocalXY()},getLocalY:function(){return this.el.getLocalY()},getX:function(){return this.el.getX()},getXY:function(){return this.el.getXY()},getY:function(){return this.el.getY()},setLocalX:function(x){this.el.setLocalX(x)},setLocalXY:function(x,y){this.el.setLocalXY(x,y)},setLocalY:function(y){this.el.setLocalY(y)},setX:function(x,animate){this.el.setX(x,animate)},setXY:function(xy,animate){this.el.setXY(xy,animate)},setY:function(y,animate){this.el.setY(y,animate)}},function(){var AbstractComponent=this;AbstractComponent.createAlias({on:"addListener",prev:"previousSibling",next:"nextSibling"}),Ext.resumeLayouts=function(flush){AbstractComponent.resumeLayouts(flush)},Ext.suspendLayouts=function(){AbstractComponent.suspendLayouts()},Ext.batchLayouts=function(fn,scope){AbstractComponent.suspendLayouts(),fn.call(scope),AbstractComponent.resumeLayouts(!0)}}),Ext.define("Ext.AbstractPlugin",{disabled:!1,isPlugin:!0,constructor:function(config){this.pluginConfig=config,Ext.apply(this,config)},clonePlugin:function(overrideCfg){return new this.self(Ext.apply({},overrideCfg,this.pluginConfig))},setCmp:function(cmp){this.cmp=cmp},getCmp:function(){return this.cmp},init:Ext.emptyFn,destroy:Ext.emptyFn,enable:function(){this.disabled=!1},disable:function(){this.disabled=!0},onClassExtended:function(cls,data,hooks){var alias=data.alias;alias&&!data.ptype&&(Ext.isArray(alias)&&(alias=alias[0]),cls.prototype.ptype=alias.split("plugin.")[1])}}),Ext.define("Ext.Action",{constructor:function(config){this.initialConfig=config,this.itemId=config.itemId=config.itemId||config.id||Ext.id(),this.items=[]},isAction:!0,setText:function(text){this.initialConfig.text=text,this.callEach("setText",[text])},getText:function(){return this.initialConfig.text},setIconCls:function(cls){this.initialConfig.iconCls=cls,this.callEach("setIconCls",[cls])},getIconCls:function(){return this.initialConfig.iconCls},setDisabled:function(v){this.initialConfig.disabled=v,this.callEach("setDisabled",[v])},enable:function(){this.setDisabled(!1)},disable:function(){this.setDisabled(!0)},isDisabled:function(){return this.initialConfig.disabled},setHidden:function(v){this.initialConfig.hidden=v,this.callEach("setVisible",[!v])},show:function(){this.setHidden(!1)},hide:function(){this.setHidden(!0)},isHidden:function(){return this.initialConfig.hidden},setHandler:function(fn,scope){this.initialConfig.handler=fn,this.initialConfig.scope=scope,this.callEach("setHandler",[fn,scope])},each:function(fn,scope){Ext.each(this.items,fn,scope)},callEach:function(fnName,args){var item,items=this.items,i=0,len=items.length;for(Ext.suspendLayouts();i<len;i++)item=items[i],item[fnName].apply(item,args);Ext.resumeLayouts(!0)},addComponent:function(comp){this.items.push(comp),comp.on("destroy",this.removeComponent,this)},removeComponent:function(comp){Ext.Array.remove(this.items,comp)},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||Ext.global,arguments)}}),Ext.define("Ext.data.flash.BinaryXhr",{statics:{flashPluginActivated:function(){Ext.data.flash.BinaryXhr.flashPluginActive=!0,Ext.data.flash.BinaryXhr.flashPlugin=document.getElementById("ext-flash-polyfill"),Ext.globalEvents.fireEvent("flashready")},flashPluginActive:!1,flashPluginInjected:!1,connectionIndex:1,liveConnections:{},flashPlugin:null,onFlashStateChange:function(javascriptId,state,data){var connection;connection=this.liveConnections[Number(javascriptId)],connection&&connection.onFlashStateChange(state,data)},registerConnection:function(conn){var i=this.connectionIndex;return this.conectionIndex=this.connectionIndex+1,this.liveConnections[i]=conn,i},injectFlashPlugin:function(){var flashLoaderPath,flashObjectPath,me=this;me.flashPolyfillEl=Ext.getBody().appendChild({id:"ext-flash-polyfill",cn:[{tag:"p",html:"To view this page ensure that Adobe Flash Player version 11.1.0 or greater is installed."},{tag:"a",href:"http://www.adobe.com/go/getflashplayer",cn:[{tag:"img",src:window.location.protocol+"//www.adobe.com/images/shared/download_buttons/get_flash_player.gif",alt:"Get Adobe Flash player"}]}]}),flashLoaderPath=[Ext.Loader.getPath("Ext.data.Connection"),"../../../plugins/flash/swfobject.js"].join("/"),flashObjectPath="/plugins/flash/FlashPlugin.swf",Ext.flashPluginPath&&(flashObjectPath=Ext.flashPluginPath),Ext.Loader.loadScript({url:flashLoaderPath,onLoad:function(){var swfVersionStr="11.4.0",xiSwfUrlStr="playerProductInstall.swf",flashvars={},params={};params.quality="high",params.bgcolor="#ffffff",params.allowscriptaccess="sameDomain",params.allowfullscreen="true";var attributes={};attributes.id="ext-flash-polyfill",attributes.name="polyfill",attributes.align="middle",swfobject.embedSWF(flashObjectPath,"ext-flash-polyfill","0","0",swfVersionStr,xiSwfUrlStr,flashvars,params,attributes)},onError:function(){},scope:me}),Ext.globalEvents.addEvents("flashready"),Ext.data.flash.BinaryXhr.flashPluginInjected=!0}},readyState:0,status:0,statusText:"",responseBytes:null,javascriptId:null,constructor:function(config){Ext.data.flash.BinaryXhr.flashPluginInjected||Ext.data.flash.BinaryXhr.injectFlashPlugin();var me=this;Ext.apply(me,config),me.requestHeaders={}},abort:function(){var me=this;if(4!=me.readyState){if(me.aborted=!0,!Ext.data.flash.BinaryXhr.flashPluginActive)return void Ext.globalEvents.removeListener("flashready",me.onFlashReady,me);Ext.data.flash.BinaryXhr.flashPlugin.abortRequest(me.javascriptId),delete Ext.data.flash.BinaryXhr.liveConnections[me.javascriptId]}},getAllResponseHeaders:function(){var headers=[];return Ext.Object.each(this.responseHeaders,function(name,value){headers.push(name+": "+value)}),headers.join("\r\n")},getResponseHeader:function(header){var headers=this.responseHeaders;return headers&&headers[header]||null},open:function(method,url,async,user,password){var me=this;me.method=method,me.url=url,me.async=async!==!1,me.user=user,me.password=password},overrideMimeType:function(mimeType){this.mimeType=mimeType},send:function(body){var me=this;me.body=body,Ext.data.flash.BinaryXhr.flashPluginActive?this.onFlashReady():Ext.globalEvents.addListener("flashready",me.onFlashReady,me)},onFlashReady:function(){var req,status,me=this;me.javascriptId=Ext.data.flash.BinaryXhr.registerConnection(me),req={method:me.method,url:me.url,user:me.user,password:me.password,mimeType:me.mimeType,requestHeaders:me.requestHeaders,body:me.body,javascriptId:me.javascriptId},status=Ext.data.flash.BinaryXhr.flashPlugin.postBinary(req)},setReadyState:function(state){var me=this;me.readyState!=state&&(me.readyState=state,me.onreadystatechange())},setRequestHeader:function(header,value){this.requestHeaders[header]=value},onreadystatechange:Ext.emptyFn,parseData:function(data){var me=this;this.status=data.status||0,me.responseHeaders={},me.mimeType&&(me.responseHeaders["content-type"]=me.mimeType),"complete"==data.reason?(this.responseBytes=data.data,me.responseHeaders["content-length"]=data.data.length):"error"!=data.reason&&"securityError"!=data.reason||(this.statusText=data.text,me.responseHeaders["content-length"]=0)},onFlashStateChange:function(state,data){var me=this;4==state&&(me.parseData(data),delete Ext.data.flash.BinaryXhr.liveConnections[me.javascriptId]),me.setReadyState(state)}}),Ext.define("Ext.data.Connection",{mixins:{observable:Ext.util.Observable
},statics:{requestId:0},url:null,async:!0,method:null,username:"",password:"",disableCaching:!0,withCredentials:!1,binary:!1,cors:!1,isXdr:!1,defaultXdrContentType:"text/plain",disableCachingParam:"_dc",timeout:3e4,useDefaultHeader:!0,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:!0,defaultXhrHeader:"XMLHttpRequest",constructor:function(config){config=config||{},Ext.apply(this,config),this.requests={},this.mixins.observable.constructor.call(this)},request:function(options){options=options||{};var async,requestOptions,request,headers,xhr,me=this,scope=options.scope||window,username=options.username||me.username,password=options.password||me.password||"";return me.fireEvent("beforerequest",me,options)!==!1?(requestOptions=me.setOptions(options,scope),me.isFormUpload(options)?(me.upload(options.form,requestOptions.url,requestOptions.data,options),null):((options.autoAbort||me.autoAbort)&&me.abort(),async=options.async!==!1&&(options.async||me.async),xhr=me.openRequest(options,requestOptions,async,username,password),me.isXdr||(headers=me.setupHeaders(xhr,options,requestOptions.data,requestOptions.params)),request={id:++Ext.data.Connection.requestId,xhr:xhr,headers:headers,options:options,async:async,binary:options.binary||me.binary,timeout:setTimeout(function(){request.timedout=!0,me.abort(request)},options.timeout||me.timeout)},me.requests[request.id]=request,me.latestId=request.id,async&&(me.isXdr||(xhr.onreadystatechange=Ext.Function.bind(me.onStateChange,me,[request]))),me.isXdr&&me.processXdrRequest(request,xhr),xhr.send(requestOptions.data),async?request:me.onComplete(request))):(Ext.callback(options.callback,options.scope,[options,void 0,void 0]),null)},processXdrRequest:function(request,xhr){var me=this;delete request.headers,request.contentType=request.options.contentType||me.defaultXdrContentType,xhr.onload=Ext.Function.bind(me.onStateChange,me,[request,!0]),xhr.onerror=xhr.ontimeout=Ext.Function.bind(me.onStateChange,me,[request,!1])},processXdrResponse:function(response,xhr){response.getAllResponseHeaders=function(){return[]},response.getResponseHeader=function(){return""},response.contentType=xhr.contentType||this.defaultXdrContentType},upload:function(form,url,params,options){form=Ext.getDom(form),options=options||{};var hiddenItem,obj,value,name,vLen,v,hLen,h,id=Ext.id(),frame=document.createElement("iframe"),hiddens=[],encoding="multipart/form-data",buf={target:form.target,method:form.method,encoding:form.encoding,enctype:form.enctype,action:form.action},addField=function(name,value){hiddenItem=document.createElement("input"),Ext.fly(hiddenItem).set({type:"hidden",value:value,name:name}),form.appendChild(hiddenItem),hiddens.push(hiddenItem)};if(Ext.fly(frame).set({id:id,name:id,cls:Ext.baseCSSPrefix+"hide-display",src:Ext.SSL_SECURE_URL}),document.body.appendChild(frame),document.frames&&(document.frames[id].name=id),Ext.fly(form).set({target:id,method:"POST",enctype:encoding,encoding:encoding,action:url||buf.action}),params){obj=Ext.Object.fromQueryString(params)||{};for(name in obj)if(obj.hasOwnProperty(name))if(value=obj[name],Ext.isArray(value))for(vLen=value.length,v=0;v<vLen;v++)addField(name,value[v]);else addField(name,value)}for(Ext.fly(frame).on("load",Ext.Function.bind(this.onUploadComplete,this,[frame,options]),null,{single:!Ext.isOpera}),form.submit(),Ext.fly(form).set(buf),hLen=hiddens.length,h=0;h<hLen;h++)Ext.removeNode(hiddens[h])},onUploadComplete:function(frame,options){var callback,success,doc,contentNode,me=this,response={responseText:"",responseXML:null};try{if(doc=frame.contentWindow.document||frame.contentDocument||window.frames[frame.id].document){if(Ext.isOpera&&"about:blank"==doc.location)return;doc.body&&((contentNode=doc.body.firstChild)&&/pre/i.test(contentNode.tagName)?response.responseText=contentNode.textContent:(contentNode=doc.getElementsByTagName("textarea")[0])?response.responseText=contentNode.value:response.responseText=doc.body.textContent||doc.body.innerText),response.responseXML=doc.XMLDocument||doc,callback=options.success,success=!0}}catch(e){response.responseText='{success:false,message:"'+Ext.String.trim(e.message||e.description)+'"}',callback=options.failure,success=!1}me.fireEvent("requestcomplete",me,response,options),Ext.callback(callback,options.scope,[response,options]),Ext.callback(options.callback,options.scope,[options,success,response]),setTimeout(function(){Ext.removeNode(frame)},100)},isFormUpload:function(options){var form=this.getForm(options);return!!form&&(options.isUpload||/multipart\/form-data/i.test(form.getAttribute("enctype")))},getForm:function(options){return Ext.getDom(options.form)||null},setOptions:function(options,scope){var method,disableCache,data,me=this,params=options.params||{},extraParams=me.extraParams,urlParams=options.urlParams,url=options.url||me.url,jsonData=options.jsonData;return Ext.isFunction(params)&&(params=params.call(scope,options)),Ext.isFunction(url)&&(url=url.call(scope,options)),url=this.setupUrl(options,url),data=options.rawData||options.binaryData||options.xmlData||jsonData||null,jsonData&&!Ext.isPrimitive(jsonData)&&(data=Ext.encode(data)),options.binaryData&&me.nativeBinaryPostSupport()&&(data=new Uint8Array(options.binaryData),(Ext.isChrome&&Ext.chromeVersion<22||Ext.isSafari||Ext.isGecko)&&(data=data.buffer)),Ext.isObject(params)&&(params=Ext.Object.toQueryString(params)),Ext.isObject(extraParams)&&(extraParams=Ext.Object.toQueryString(extraParams)),params+=extraParams?(params?"&":"")+extraParams:"",urlParams=Ext.isObject(urlParams)?Ext.Object.toQueryString(urlParams):urlParams,params=this.setupParams(options,params),method=(options.method||me.method||(params||data?"POST":"GET")).toUpperCase(),this.setupMethod(options,method),disableCache=options.disableCaching!==!1&&(options.disableCaching||me.disableCaching),"GET"===method&&disableCache&&(url=Ext.urlAppend(url,(options.disableCachingParam||me.disableCachingParam)+"="+(new Date).getTime())),("GET"==method||data)&&params&&(url=Ext.urlAppend(url,params),params=null),urlParams&&(url=Ext.urlAppend(url,urlParams)),{url:url,method:method,data:data||params||null}},setupUrl:function(options,url){var form=this.getForm(options);return form&&(url=url||form.action),url},setupParams:function(options,params){var serializedForm,form=this.getForm(options);return form&&!this.isFormUpload(options)&&(serializedForm=Ext.Element.serializeForm(form),params=params?params+"&"+serializedForm:serializedForm),params},setupMethod:function(options,method){return this.isFormUpload(options)?"POST":method},setupHeaders:function(xhr,options,data,params){var key,header,me=this,headers=Ext.apply({},options.headers||{},me.defaultHeaders||{}),contentType=me.defaultPostHeader,jsonData=options.jsonData,xmlData=options.xmlData,type="Content-Type";headers.hasOwnProperty(type)||!data&&!params||(data&&(options.rawData?contentType="text/plain":xmlData&&Ext.isDefined(xmlData)?contentType="text/xml":jsonData&&Ext.isDefined(jsonData)&&(contentType="application/json")),headers[type]=contentType),me.useDefaultXhrHeader&&!headers["X-Requested-With"]&&(headers["X-Requested-With"]=me.defaultXhrHeader),void 0!==headers[type]&&null!==headers[type]||delete headers[type];try{for(key in headers)headers.hasOwnProperty(key)&&(header=headers[key],xhr.setRequestHeader(key,header))}catch(e){me.fireEvent("exception",key,header)}return headers},newRequest:function(options){var xhr,me=this;return options.binaryData?xhr=me.nativeBinaryPostSupport()?this.getXhrInstance():new Ext.data.flash.BinaryXhr:(options.cors||me.cors)&&Ext.isIE&&Ext.ieVersion<=9?(xhr=me.getXdrInstance(),me.isXdr=!0):xhr=me.getXhrInstance(),xhr},openRequest:function(options,requestOptions,async,username,password){var me=this,xhr=me.newRequest(options);return username?xhr.open(requestOptions.method,requestOptions.url,async,username,password):me.isXdr?xhr.open(requestOptions.method,requestOptions.url):xhr.open(requestOptions.method,requestOptions.url,async),(options.binary||me.binary)&&(window.Uint8Array?xhr.responseType="arraybuffer":xhr.overrideMimeType&&xhr.overrideMimeType("text/plain; charset=x-user-defined")),(options.withCredentials||me.withCredentials)&&(xhr.withCredentials=!0),xhr},getXdrInstance:function(){var xdr;return Ext.ieVersion>=8?xdr=new XDomainRequest:Ext.Error.raise({msg:"Your browser does not support CORS"}),xdr},getXhrInstance:function(){for(var xhr,options=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],i=0,len=options.length;i<len;++i)try{xhr=options[i],xhr();break}catch(e){}return xhr}(),isLoading:function(request){if(request||(request=this.getLatest()),!request||!request.xhr)return!1;var state=request.xhr.readyState;return request.xhr instanceof Ext.data.flash.BinaryXhr&&4!=state||!(0===state||4==state)},abort:function(request){var xhr,me=this;if(request||(request=me.getLatest()),request&&me.isLoading(request)){xhr=request.xhr;try{xhr.onreadystatechange=null}catch(e){xhr.onreadystatechange=Ext.emptyFn}xhr.abort(),me.clearTimeout(request),request.timedout||(request.aborted=!0),me.onComplete(request),me.cleanup(request)}},abortAll:function(){var id,requests=this.requests;for(id in requests)requests.hasOwnProperty(id)&&this.abort(requests[id])},getLatest:function(){var request,id=this.latestId;return id&&(request=this.requests[id]),request||null},onStateChange:function(request,xdrResult){var me=this;(request.xhr&&4==request.xhr.readyState||me.isXdr)&&(me.clearTimeout(request),me.onComplete(request,xdrResult),me.cleanup(request),Ext.EventManager.idleEvent.fire())},clearTimeout:function(request){clearTimeout(request.timeout),delete request.timeout},cleanup:function(request){request.xhr=null,delete request.xhr},onComplete:function(request,xdrResult){var xhr,result,success,response,me=this,options=request.options;try{xhr=request.xhr,result=me.parseStatus(xhr.status),result.success&&(result.success=4===xhr.readyState)}catch(e){result={success:!1,isException:!1}}return success=me.isXdr?xdrResult:result.success,success?(response=me.createResponse(request),me.fireEvent("requestcomplete",me,response,options),Ext.callback(options.success,options.scope,[response,options])):(response=result.isException||request.aborted||request.timedout?me.createException(request):me.createResponse(request),me.fireEvent("requestexception",me,response,options),Ext.callback(options.failure,options.scope,[response,options])),Ext.callback(options.callback,options.scope,[options,success,response]),delete me.requests[request.id],response},parseStatus:function(status){status=1223==status?204:status;var success=status>=200&&status<300||304==status,isException=!1;if(!success)switch(status){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:isException=!0}return{success:success,isException:isException}},createResponse:function(request){for(var line,index,key,response,me=this,xhr=request.xhr,isXdr=me.isXdr,headers={},lines=isXdr?[]:xhr.getAllResponseHeaders().replace(/\r\n/g,"\n").split("\n"),count=lines.length;count--;)line=lines[count],index=line.indexOf(":"),index>=0&&(key=line.substr(0,index).toLowerCase()," "==line.charAt(index+1)&&++index,headers[key]=line.substr(index+1));return request.xhr=null,delete request.xhr,response={request:request,requestId:request.id,status:xhr.status,statusText:xhr.statusText,getResponseHeader:function(header){return headers[header.toLowerCase()]},getAllResponseHeaders:function(){return headers}},isXdr&&me.processXdrResponse(response,xhr),request.binary?response.responseBytes=me.getByteArray(xhr):(response.responseText=xhr.responseText,response.responseXML=xhr.responseXML),xhr=null,response},createException:function(request){return{request:request,requestId:request.id,status:request.aborted?-1:0,statusText:request.aborted?"transaction aborted":"communication failure",aborted:request.aborted,timedout:request.timedout}},getByteArray:function(xhr){var byteArray,responseText,len,i,response=xhr.response,responseBody=xhr.responseBody;if(xhr instanceof Ext.data.flash.BinaryXhr)byteArray=xhr.responseBytes;else if(window.Uint8Array)byteArray=response?new Uint8Array(response):[];else if(Ext.isIE9p)try{byteArray=new VBArray(responseBody).toArray()}catch(e){byteArray=[]}else if(Ext.isIE)this.self.vbScriptInjected||this.injectVBScript(),getIEByteArray(xhr.responseBody,byteArray=[]);else for(byteArray=[],responseText=xhr.responseText,len=responseText.length,i=0;i<len;i++)byteArray.push(255&responseText.charCodeAt(i));return byteArray},injectVBScript:function(){var scriptTag=document.createElement("script");scriptTag.type="text/vbscript",scriptTag.text=["Function getIEByteArray(byteArray, out)","Dim len, i","len = LenB(byteArray)","For i = 1 to len","out.push(AscB(MidB(byteArray, i, 1)))","Next","End Function"].join("\n"),Ext.getHead().dom.appendChild(scriptTag),this.self.vbScriptInjected=!0},nativeBinaryPostSupport:function(){return Ext.isChrome||Ext.isSafari&&Ext.isDefined(window.Uint8Array)||Ext.isGecko&&Ext.isDefined(window.Uint8Array)}}),Ext.define("Ext.Ajax",{extend:Ext.data.Connection,singleton:!0,autoAbort:!1}),Ext.define("Ext.util.Floating",{focusOnToFront:!0,shadow:"sides",constrain:!1,constructor:function(dom){var me=this;me.fixed=me.fixed&&!(Ext.isIE6||Ext.isIEQuirks),me.el=new Ext.dom.Layer(Ext.apply({preventSync:!0,hideMode:me.hideMode,shadow:"undefined"!=typeof me.shadow?me.shadow:"sides",shadowOffset:me.shadowOffset,constrain:!1,fixed:me.fixed,shim:me.shim!==!1&&void 0},me.floating),dom),!me.modal||Ext.FocusManager&&Ext.FocusManager.enabled||me.mon(me.el,{keydown:me.onKeyDown,scope:me}),me.mon(me.el,{mousedown:me.onMouseDown,scope:me}),me.floating=!0,me.registerWithOwnerCt(),me.initHierarchyEvents()},initHierarchyEvents:function(){var me=this,syncHidden=this.syncHidden;me.hasHierarchyEventListeners||(me.mon(me.hierarchyEventSource,{hide:syncHidden,collapse:syncHidden,show:syncHidden,expand:syncHidden,added:syncHidden,scope:me}),me.hasHierarchyEventListeners=!0)},registerWithOwnerCt:function(){var me=this,ownerCt=me.ownerCt,zip=me.zIndexParent;zip&&zip.unregisterFloatingItem(me),zip=me.zIndexParent=me.up("[floating]"),me.setFloatParent(ownerCt||zip),delete me.ownerCt,zip?zip.registerFloatingItem(me):Ext.WindowManager.register(me)},onKeyDown:function(e){var shift,focusables,first,last,me=this;e.getKey()==Ext.EventObject.TAB&&(shift=e.shiftKey,focusables=me.el.query(":focusable"),first=focusables[0],last=focusables[focusables.length-1],first&&last&&e.target===(shift?first:last)&&(e.stopEvent(),(shift?last:first).focus(!1,!0)))},onMouseDown:function(e){var focusTask=this.focusTask;!this.floating||focusTask&&focusTask.id||this.toFront(!!e.getTarget(":focusable"))},setFloatParent:function(floatParent){var me=this;me.floatParent=floatParent,!me.constrain&&!me.constrainHeader||me.constrainTo||(me.constrainTo=floatParent?floatParent.getTargetEl():me.container)},syncShadow:function(){this.floating&&this.el.sync(!0)},onBeforeFloatLayout:function(){this.el.preventSync=!0},onAfterFloatLayout:function(){delete this.el.preventSync,this.syncShadow()},syncHidden:function(){var me=this,hidden=me.hidden||!me.rendered,hierarchicallyHidden=me.hierarchicallyHidden=me.isHierarchicallyHidden(),pendingShow=me.pendingShow;hidden!==hierarchicallyHidden&&(hierarchicallyHidden?(me.hide(),me.pendingShow=!0):pendingShow&&(delete me.pendingShow,pendingShow.length?me.show.apply(me,pendingShow):me.show()))},setZIndex:function(index){var me=this;return me.el.setZIndex(index),index+=10,me.floatingDescendants&&(index=100*Math.floor(me.floatingDescendants.setBase(index)/100)+1e4),index},doConstrain:function(constrainTo){var me=this,xy=me.calculateConstrainedPosition(constrainTo,null,!0);xy&&me.setPosition(xy)},toFront:function(preventFocus){var me=this,zip=me.zIndexParent,preventFocusSetting=me.preventFocusOnActivate;return zip&&me.bringParentToFront!==!1&&zip.toFront(!0),Ext.isDefined(preventFocus)||(preventFocus=!me.focusOnToFront),preventFocus&&(me.preventFocusOnActivate=!0),me.zIndexManager.bringToFront(me,preventFocus)&&(preventFocus||me.focus(!1,!0)),me.preventFocusOnActivate=preventFocusSetting,me},setActive:function(active,newActive){var me=this;active?(me.el.shadow&&!me.maximized&&me.el.enableShadow(!0),me.preventFocusOnActivate||me.focus(!1,!0),me.fireEvent("activate",me)):(me.isWindow&&newActive&&newActive.isWindow&&me.hideShadowOnDeactivate&&me.el.disableShadow(),me.fireEvent("deactivate",me))},toBack:function(){return this.zIndexManager.sendToBack(this),this},center:function(){var xy,me=this;return me.isVisible()?(xy=me.getAlignToXY(me.container,"c-c"),me.setPagePosition(xy)):me.needsCenter=!0,me},onFloatShow:function(){this.needsCenter&&this.center(),delete this.needsCenter,this.toFrontOnShow&&this.toFront()},fitContainer:function(animate){var me=this,parent=me.floatParent,container=parent?parent.getTargetEl():me.container,newBox=container.getViewSize(!1),newPosition=parent||container.dom!==document.body?[0,0]:container.getXY();newBox.x=newPosition[0],newBox.y=newPosition[1],me.setBox(newBox,animate)}}),Ext.define("Ext.Component",{alias:["widget.component","widget.box"],extend:Ext.AbstractComponent,mixins:{floating:Ext.util.Floating},statics:{DIRECTION_TOP:"top",DIRECTION_RIGHT:"right",DIRECTION_BOTTOM:"bottom",DIRECTION_LEFT:"left",VERTICAL_DIRECTION_Re:/^(?:top|bottom)$/,INVALID_ID_CHARS_Re:/[\.,\s]/g},resizeHandles:"all",floating:!1,defaultAlign:"tl-bl?",toFrontOnShow:!0,hideMode:"display",offsetsCls:Ext.baseCSSPrefix+"hide-offsets",bubbleEvents:[],defaultComponentLayoutType:"autocomponent",constructor:function(config){var me=this;config=config||{},config.initialConfig?(config.isAction&&(me.baseAction=config),config=config.initialConfig):(config.tagName||config.dom||Ext.isString(config))&&(config={applyTo:config,id:config.id||config}),me.callParent([config]),me.baseAction&&me.baseAction.addComponent(me)},initComponent:function(){var me=this;me.callParent(),me.listeners&&(me.on(me.listeners),me.listeners=null),me.enableBubble(me.bubbleEvents)},afterRender:function(){var me=this;me.callParent(),me.x&&me.y||!me.pageX&&!me.pageY||me.setPagePosition(me.pageX,me.pageY)},setAutoScroll:function(scroll){var me=this;return me.autoScroll=!!scroll,me.rendered&&me.getOverflowEl().setStyle(me.getOverflowStyle()),me.updateLayout(),me},setOverflowXY:function(overflowX,overflowY){var me=this,argCount=arguments.length;return argCount&&(me.overflowX=overflowX||"",argCount>1&&(me.overflowY=overflowY||"")),me.rendered&&me.getOverflowEl().setStyle(me.getOverflowStyle()),me.updateLayout(),me},beforeRender:function(){var cls,me=this,floating=me.floating;return floating&&(me.addCls(Ext.baseCSSPrefix+"layer"),cls=floating.cls,cls&&me.addCls(cls)),me.callParent()},beforeLayout:function(){this.callParent(arguments),this.floating&&this.onBeforeFloatLayout()},afterComponentLayout:function(){this.callParent(arguments),this.floating&&this.onAfterFloatLayout()},makeFloating:function(dom){this.mixins.floating.constructor.call(this,dom)},wrapPrimaryEl:function(dom){this.floating?this.makeFloating(dom):this.callParent(arguments)},initResizable:function(resizable){var me=this;resizable=Ext.apply({target:me,dynamic:!1,constrainTo:me.constrainTo||(me.floatParent?me.floatParent.getTargetEl():null),handles:me.resizeHandles},resizable),resizable.target=me,me.resizer=new Ext.resizer.Resizer(resizable)},getDragEl:function(){return this.el},initDraggable:function(){var me=this,dragTarget=me.resizer&&me.resizer.el!==me.el?me.resizerComponent=new Ext.Component({ariaRole:"presentation",el:me.resizer.el,rendered:!0,container:me.container}):me,ddConfig=Ext.applyIf({el:dragTarget.getDragEl(),constrainTo:me.constrain||me.draggable.constrain?me.constrainTo||(me.floatParent?me.floatParent.getTargetEl():me.container):void 0},me.draggable);(me.constrain||me.constrainDelegate)&&(ddConfig.constrain=me.constrain,ddConfig.constrainDelegate=me.constrainDelegate),me.dd=new Ext.util.ComponentDragger(dragTarget,ddConfig)},scrollBy:function(deltaX,deltaY,animate){var el;(el=this.getTargetEl())&&el.dom&&el.scrollBy.apply(el,arguments)},setLoading:function(load,targetEl){var me=this,config={target:me};return me.rendered&&(Ext.destroy(me.loadMask),me.loadMask=null,load===!1||me.collapsed||(Ext.isObject(load)?Ext.apply(config,load):Ext.isString(load)&&(config.msg=load),targetEl&&Ext.applyIf(config,{useTargetEl:!0}),me.loadMask=new Ext.LoadMask(config),me.loadMask.show())),me.loadMask},beforeSetPosition:function(){var adj,me=this,pos=me.callParent(arguments);return pos&&(adj=me.adjustPosition(pos.x,pos.y),pos.x=adj.x,pos.y=adj.y),pos||null},afterSetPosition:function(ax,ay){this.onPosition(ax,ay),this.fireEvent("move",this,ax,ay)},showAt:function(x,y,animate){var me=this;return me.rendered||!me.autoRender&&!me.floating?(me.floating?me.setPosition(x,y,animate):me.setPagePosition(x,y,animate),void me.show()):(me.x=x,me.y=y,me.show())},showBy:function(cmp,pos,off){var me=this;return me.floating&&cmp&&(me.show(),me.rendered&&!me.hidden&&me.alignTo(cmp,pos||me.defaultAlign,off)),me},setPagePosition:function(x,y,animate){var p,floatParentBox,me=this;return Ext.isArray(x)&&(y=x[1],x=x[0]),me.pageX=x,me.pageY=y,me.floating?(me.isContainedFloater()?(floatParentBox=me.floatParent.getTargetEl().getViewRegion(),Ext.isNumber(x)&&Ext.isNumber(floatParentBox.left)&&(x-=floatParentBox.left),Ext.isNumber(y)&&Ext.isNumber(floatParentBox.top)&&(y-=floatParentBox.top)):(p=me.el.translateXY(x,y),x=p.x,y=p.y),me.setPosition(x,y,animate)):(p=me.el.translateXY(x,y),me.setPosition(p.x,p.y,animate)),me},isContainedFloater:function(){return this.floating&&this.floatParent},updateBox:function(box){return this.setSize(box.width,box.height),this.setPagePosition(box.x,box.y),this},getOuterSize:function(){var el=this.el;return{width:el.getWidth()+el.getMargin("lr"),height:el.getHeight()+el.getMargin("tb")}},adjustPosition:function(x,y){var floatParentBox,me=this;return me.isContainedFloater()&&(floatParentBox=me.floatParent.getTargetEl().getViewRegion(),x+=floatParentBox.left,y+=floatParentBox.top),{x:x,y:y}},getPosition:function(local){var xy,floatParentBox,me=this,isContainedFloater=me.isContainedFloater();return local!==!0||isContainedFloater?(xy=me.getXY(),local===!0&&isContainedFloater&&(floatParentBox=me.floatParent.getTargetEl().getViewRegion(),xy[0]-=floatParentBox.left,xy[1]-=floatParentBox.top),xy):[me.getLocalX(),me.getLocalY()]},getId:function(){var xtype,me=this;return me.id||(xtype=me.getXType(),xtype=xtype?xtype.replace(Ext.Component.INVALID_ID_CHARS_Re,"-"):Ext.name.toLowerCase()+"-comp",me.id=xtype+"-"+me.getAutoId()),me.id},show:function(animateTarget,cb,scope){var me=this,rendered=me.rendered;return me.hierarchicallyHidden||me.floating&&!rendered&&me.isHierarchicallyHidden()?(rendered||me.initHierarchyEvents(),arguments.length>1?(arguments[0]=null,me.pendingShow=arguments):me.pendingShow=!0):rendered&&me.isVisible()?me.floating&&me.onFloatShow():me.fireEvent("beforeshow",me)!==!1?(me.hidden=!1,delete this.getHierarchyState().hidden,Ext.suspendLayouts(),rendered||!me.autoRender&&!me.floating||(me.doAutoRender(),rendered=me.rendered),rendered?(me.beforeShow(),Ext.resumeLayouts(),me.onShow.apply(me,arguments),me.afterShow.apply(me,arguments)):Ext.resumeLayouts(!0)):me.onShowVeto(),me},onShowVeto:Ext.emptyFn,beforeShow:Ext.emptyFn,onShow:function(){var me=this;me.el.show(),me.callParent(arguments),me.floating&&(me.maximized?me.fitContainer():me.constrain&&me.doConstrain())},getAnimateTarget:function(target){return target=target||this.animateTarget,target&&(target=target.isComponent?target.getEl():Ext.get(target)),target||null},afterShow:function(animateTarget,cb,scope){var fromBox,toBox,ghostPanel,me=this,myEl=me.el;animateTarget=me.getAnimateTarget(animateTarget),me.ghost||(animateTarget=null),animateTarget?(toBox={x:myEl.getX(),y:myEl.getY(),width:myEl.dom.offsetWidth,height:myEl.dom.offsetHeight},fromBox={x:animateTarget.getX(),y:animateTarget.getY(),width:animateTarget.dom.offsetWidth,height:animateTarget.dom.offsetHeight},myEl.addCls(me.offsetsCls),ghostPanel=me.ghost(),ghostPanel.el.stopAnimation(),ghostPanel.setX(-1e4),me.ghostBox=toBox,ghostPanel.el.animate({from:fromBox,to:toBox,listeners:{afteranimate:function(){delete ghostPanel.componentLayout.lastComponentSize,me.unghost(),delete me.ghostBox,myEl.removeCls(me.offsetsCls),me.onShowComplete(cb,scope)}}})):me.onShowComplete(cb,scope),me.fireHierarchyEvent("show")},onShowComplete:function(cb,scope){var me=this;me.floating&&me.onFloatShow(),Ext.callback(cb,scope||me),me.fireEvent("show",me),delete me.hiddenByLayout},hide:function(animateTarget,cb,scope){var continueHide,me=this;return me.pendingShow&&delete me.pendingShow,me.rendered&&!me.isVisible()||(continueHide=me.fireEvent("beforehide",me)!==!1,(me.hierarchicallyHidden||continueHide)&&(me.hidden=!0,me.getHierarchyState().hidden=!0,me.rendered&&me.onHide.apply(me,arguments))),me},onHide:function(animateTarget,cb,scope){var ghostPanel,fromSize,toBox,me=this,activeEl=Ext.Element.getActiveElement();(activeEl===me.el||me.el.contains(activeEl))&&Ext.fly(activeEl).blur(),animateTarget=me.getAnimateTarget(animateTarget),me.ghost||(animateTarget=null),animateTarget&&(toBox={x:animateTarget.getX(),y:animateTarget.getY(),width:animateTarget.dom.offsetWidth,height:animateTarget.dom.offsetHeight},ghostPanel=me.ghost(),ghostPanel.el.stopAnimation(),fromSize=me.getSize(),ghostPanel.el.animate({to:toBox,listeners:{afteranimate:function(){delete ghostPanel.componentLayout.lastComponentSize,ghostPanel.el.hide(),ghostPanel.setHiddenState(!0),ghostPanel.el.setSize(fromSize),me.afterHide(cb,scope)}}})),me.el.hide(),animateTarget||me.afterHide(cb,scope)},afterHide:function(cb,scope){var me=this;me.hiddenByLayout=null,Ext.AbstractComponent.prototype.onHide.call(me),Ext.callback(cb,scope||me),me.fireEvent("hide",me),me.fireHierarchyEvent("hide")},onDestroy:function(){var me=this;me.rendered&&Ext.destroy(me.dd,me.resizer,me.proxy,me.proxyWrap,me.resizerComponent),delete me.focusTask,me.callParent()},deleteMembers:function(){for(var args=arguments,len=args.length,i=0;i<len;++i)delete this[args[i]]},focus:function(selectText,delay,callback,scope){var focusEl,focusElDom,containerScrollTop,me=this;if(delay)return me.getFocusTask().delay(Ext.isNumber(delay)?delay:10,me.focus,me,[selectText,!1,callback,scope]),me;if(me.focusTask&&me.focusTask.cancel(),me.rendered&&!me.isDestroyed&&me.isVisible(!0)&&(focusEl=me.getFocusEl())){if(focusEl.isComponent)return focusEl.focus(selectText,delay);(focusElDom=focusEl.dom)&&(focusEl.needsTabIndex()&&(focusElDom.tabIndex=-1),me.floating&&(containerScrollTop=me.container.dom.scrollTop),focusEl.focus(),selectText&&(Ext.isArray(selectText)?me.selectText&&me.selectText.apply(me,selectText):focusElDom.select()),Ext.callback(callback,scope)),me.floating&&(me!==me.zIndexManager.getActive()&&me.toFront(!0),void 0!==containerScrollTop&&(me.container.dom.scrollTop=containerScrollTop))}return me},getFocusTask:function(){return this.focusTask||(Ext.Component.prototype.focusTask=new Ext.util.DelayedTask),this.focusTask},cancelFocus:function(){var task=this.focusTask;task&&task.cancel()},blur:function(){var focusEl,me=this;return me.rendered&&(focusEl=me.getFocusEl())&&(me.blurring=!0,focusEl.blur(),delete me.blurring),me},getEl:function(){return this.el},getResizeEl:function(){return this.el},getPositionEl:function(){return this.el},getActionEl:function(){return this.el},getVisibilityEl:function(){return this.el},getRefOwner:function(){return this.ownerCt||this.floatParent},getBubbleTarget:function(){return this.getRefOwner()},getContentTarget:function(){return this.el},cloneConfig:function(overrides){overrides=overrides||{};var self,id=overrides.id||Ext.id(),cfg=Ext.applyIf(overrides,this.initialConfig);return cfg.id=id,new(self=Ext.getClass(this))(cfg)},getXType:function(){return this.self.xtype},findParentBy:function(fn){var p;for(p=this.getBubbleTarget();p&&!fn(p,this);p=p.getBubbleTarget());return p||null},findParentByType:function(xtype){return Ext.isFunction(xtype)?this.findParentBy(function(p){return p.constructor===xtype}):this.up(xtype)},bubble:function(fn,scope,args){for(var p=this;p&&fn.apply(scope||p,args||[p])!==!1;)p=p.getBubbleTarget();return this},getProxy:function(){var target,me=this;return me.proxy||(target=Ext.getBody(),me.proxy=me.el.createProxy(Ext.baseCSSPrefix+"proxy-el",target,!0)),me.proxy},fireHierarchyEvent:function(ename){this.hierarchyEventSource.fireEvent(ename,this)},onAdded:function(){this.callParent(arguments),this.hierarchyEventSource.hasListeners.added&&this.fireHierarchyEvent("added")}},function(){this.hierarchyEventSource=this.prototype.hierarchyEventSource=new Ext.util.Observable({events:{hide:!0,show:!0,collapse:!0,expand:!0,added:!0}})}),Ext.define("Ext.layout.container.border.Region",{override:"Ext.Component",initBorderRegion:function(){var me=this;me._borderRegionInited||(me._borderRegionInited=!0,me.addStateEvents(["changeregion","changeweight"]),Ext.override(me,{getState:function(){var state=me.callParent();return state=me.addPropertyToState(state,"region"),state=me.addPropertyToState(state,"weight")}}))},getOwningBorderContainer:function(){var layout=this.getOwningBorderLayout();return layout&&layout.owner},getOwningBorderLayout:function(){var layout=this.ownerLayout;return layout&&layout.isBorderLayout?layout:null},setBorderRegion:function(region){var borderLayout,me=this,old=me.region;if(region!==old)if(borderLayout=me.getOwningBorderLayout()){var delta,items,index,regionFlags=borderLayout.regionFlags[region],placeholder=me.placeholder,splitter=me.splitter,owner=borderLayout.owner,regionMeta=borderLayout.regionMeta,collapsed=me.collapsed||me.floated;if(me.fireEventArgs("beforechangeregion",[me,region])===!1)return old;Ext.suspendLayouts(),me.region=region,Ext.apply(me,regionFlags),me.updateCollapseTool&&me.updateCollapseTool(),splitter&&(Ext.apply(splitter,regionFlags),splitter.updateOrientation(),items=owner.items,index=items.indexOf(me),index>=0&&(delta=regionMeta[region].splitterDelta,items.getAt(index+delta)!==splitter&&(items.remove(splitter),index=items.indexOf(me),delta>0&&++index,items.insert(index,splitter)))),placeholder&&(collapsed&&me.expand(!1),owner.remove(placeholder),me.placeholder=null,collapsed&&me.collapse(null,!1)),owner.updateLayout(),Ext.resumeLayouts(!0),me.fireEventArgs("changeregion",[me,old])}else me.region=region;return old},setRegionWeight:function(weight){var me=this,ownerCt=me.getOwningBorderContainer(),placeholder=me.placeholder,old=me.weight;return weight!==old&&me.fireEventArgs("beforechangeweight",[me,weight])!==!1&&(me.weight=weight,placeholder&&(placeholder.weight=weight),ownerCt&&ownerCt.updateLayout(),me.fireEventArgs("changeweight",[me,old])),old}}),Ext.define("Ext.ElementLoader",{mixins:{observable:Ext.util.Observable},statics:{Renderer:{Html:function(loader,response,active){return loader.getTarget().update(response.responseText,active.scripts===!0),!0}}},url:null,params:null,baseParams:null,autoLoad:!1,target:null,loadMask:!1,ajaxOptions:null,scripts:!1,isLoader:!0,constructor:function(config){var autoLoad,me=this;config=config||{},Ext.apply(me,config),me.setTarget(me.target),me.addEvents("beforeload","exception","load"),me.mixins.observable.constructor.call(me),me.autoLoad&&(autoLoad=me.autoLoad,autoLoad===!0&&(autoLoad={}),me.load(autoLoad))},setTarget:function(target){var me=this;target=Ext.get(target),me.target&&me.target!=target&&me.abort(),me.target=target},getTarget:function(){return this.target||null},abort:function(){var active=this.active;void 0!==active&&(Ext.Ajax.abort(active.request),active.mask&&this.removeMask(),delete this.active)},removeMask:function(){this.target.unmask()},addMask:function(mask){this.target.mask(mask===!0?null:mask)},load:function(options){options=Ext.apply({},options);
var me=this,mask=Ext.isDefined(options.loadMask)?options.loadMask:me.loadMask,params=Ext.apply({},options.params),ajaxOptions=Ext.apply({},options.ajaxOptions),callback=options.callback||me.callback,scope=options.scope||me.scope||me;Ext.applyIf(ajaxOptions,me.ajaxOptions),Ext.applyIf(options,ajaxOptions),Ext.applyIf(params,me.params),Ext.apply(params,me.baseParams),Ext.applyIf(options,{url:me.url}),Ext.apply(options,{scope:me,params:params,callback:me.onComplete}),me.fireEvent("beforeload",me,options)!==!1&&(mask&&me.addMask(mask),me.active={options:options,mask:mask,scope:scope,callback:callback,success:options.success||me.success,failure:options.failure||me.failure,renderer:options.renderer||me.renderer,scripts:Ext.isDefined(options.scripts)?options.scripts:me.scripts},me.active.request=Ext.Ajax.request(options),me.setOptions(me.active,options))},setOptions:Ext.emptyFn,onComplete:function(options,success,response){var scope,me=this,active=me.active;active&&(scope=active.scope,success&&(success=me.getRenderer(active.renderer).call(me,me,response,active)!==!1),success?(Ext.callback(active.success,scope,[me,response,options]),me.fireEvent("load",me,response,options)):(Ext.callback(active.failure,scope,[me,response,options]),me.fireEvent("exception",me,response,options)),Ext.callback(active.callback,scope,[me,success,response,options]),active.mask&&me.removeMask()),delete me.active},getRenderer:function(renderer){return Ext.isFunction(renderer)?renderer:this.statics().Renderer.Html},startAutoRefresh:function(interval,options){var me=this;me.stopAutoRefresh(),me.autoRefresh=setInterval(function(){me.load(options)},interval)},stopAutoRefresh:function(){clearInterval(this.autoRefresh),delete this.autoRefresh},isAutoRefreshing:function(){return Ext.isDefined(this.autoRefresh)},destroy:function(){var me=this;me.stopAutoRefresh(),delete me.target,me.abort(),me.clearListeners()}}),Ext.define("Ext.ComponentLoader",{extend:Ext.ElementLoader,statics:{Renderer:{Data:function(loader,response,active){var success=!0;try{loader.getTarget().update(Ext.decode(response.responseText))}catch(e){success=!1}return success},Component:function(loader,response,active){var success=!0,target=loader.getTarget(),items=[];try{items=Ext.decode(response.responseText)}catch(e){success=!1}return success&&(target.suspendLayouts(),active.removeAll&&target.removeAll(),target.add(items),target.resumeLayouts(!0)),success}}},target:null,loadMask:!1,renderer:"html",setTarget:function(target){var me=this;Ext.isString(target)&&(target=Ext.getCmp(target)),me.target&&me.target!=target&&me.abort(),me.target=target},removeMask:function(){this.target.setLoading(!1)},addMask:function(mask){this.target.setLoading(mask)},setOptions:function(active,options){active.removeAll=Ext.isDefined(options.removeAll)?options.removeAll:this.removeAll},getRenderer:function(renderer){if(Ext.isFunction(renderer))return renderer;var renderers=this.statics().Renderer;switch(renderer){case"component":return renderers.Component;case"data":return renderers.Data;default:return Ext.ElementLoader.Renderer.Html}}}),Ext.define("Ext.layout.SizeModel",{constructor:function(config){var name,me=this,SizeModel=me.self,sizeModelsArray=SizeModel.sizeModelsArray;Ext.apply(me,config),me[name=me.name]=!0,me.fixed=!(me.auto=me.natural||me.shrinkWrap),sizeModelsArray[me.ordinal=sizeModelsArray.length]=SizeModel[name]=SizeModel.sizeModels[name]=me},statics:{sizeModelsArray:[],sizeModels:{}},calculated:!1,configured:!1,constrainedMax:!1,constrainedMin:!1,natural:!1,shrinkWrap:!1,calculatedFromConfigured:!1,calculatedFromNatural:!1,calculatedFromShrinkWrap:!1,names:null},function(){var i,j,n,pairs,sizeModel,SizeModel=this,sizeModelsArray=SizeModel.sizeModelsArray;for(new SizeModel({name:"calculated"}),new SizeModel({name:"configured",names:{width:"width",height:"height"}}),new SizeModel({name:"natural"}),new SizeModel({name:"shrinkWrap"}),new SizeModel({name:"calculatedFromConfigured",configured:!0,names:{width:"width",height:"height"}}),new SizeModel({name:"calculatedFromNatural",natural:!0}),new SizeModel({name:"calculatedFromShrinkWrap",shrinkWrap:!0}),new SizeModel({name:"constrainedMax",configured:!0,constrained:!0,names:{width:"maxWidth",height:"maxHeight"}}),new SizeModel({name:"constrainedMin",configured:!0,constrained:!0,names:{width:"minWidth",height:"minHeight"}}),new SizeModel({name:"constrainedDock",configured:!0,constrained:!0,constrainedByMin:!0,names:{width:"dockConstrainedWidth",height:"dockConstrainedHeight"}}),i=0,n=sizeModelsArray.length;i<n;++i)for(sizeModel=sizeModelsArray[i],sizeModel.pairsByHeightOrdinal=pairs=[],j=0;j<n;++j)pairs.push({width:sizeModel,height:sizeModelsArray[j]})}),Ext.define("Ext.layout.Layout",{isLayout:!0,initialized:!1,running:!1,autoSizePolicy:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},statics:{layoutsByType:{},create:function(layout,defaultType){var alias,className,config,layoutClass,type,load,ClassManager=Ext.ClassManager,layoutsByType=this.layoutsByType;if(layout&&"string"!=typeof layout){if(layout.isLayout)return layout;config=layout,type=layout.type||defaultType}else type=layout||defaultType,config={};if(!(layoutClass=layoutsByType[type])){if(alias="layout."+type,className=ClassManager.getNameByAlias(alias),className||(load=!0),layoutClass=ClassManager.get(className),load||!layoutClass)return ClassManager.instantiateByAlias(alias,config||{});layoutsByType[type]=layoutClass}return new layoutClass(config)}},constructor:function(config){var me=this;me.id=Ext.id(null,me.type+"-"),Ext.apply(me,config),me.layoutCount=0},beginLayout:Ext.emptyFn,beginLayoutCycle:function(ownerContext){var changed,me=this,context=me.context;me.lastWidthModel!=ownerContext.widthModel&&(me.lastWidthModel&&(changed=!0),me.lastWidthModel=ownerContext.widthModel),me.lastHeightModel!=ownerContext.heightModel&&(me.lastWidthModel&&(changed=!0),me.lastHeightModel=ownerContext.heightModel),changed&&((context=ownerContext.context).clearTriggers(me,!1),context.clearTriggers(me,!0),me.triggerCount=0)},finishedLayout:function(ownerContext){this.lastWidthModel=ownerContext.widthModel,this.lastHeightModel=ownerContext.heightModel,this.ownerContext=null},redoLayout:Ext.emptyFn,undoLayout:Ext.emptyFn,getAnimatePolicy:function(){return this.animatePolicy},getItemSizePolicy:function(item){return this.autoSizePolicy},isItemBoxParent:function(itemContext){return!1},isItemLayoutRoot:function(item){var sizeModel=item.getSizeModel(),width=sizeModel.width,height=sizeModel.height;return!(!item.componentLayout.lastComponentSize&&(width.calculated||height.calculated))&&(!width.shrinkWrap&&!height.shrinkWrap)},isItemShrinkWrap:function(item){return item.shrinkWrap},isRunning:function(){return!!this.ownerContext},getItemsRenderTree:function(items,renderCfgs){var i,item,itemConfig,result,length=items.length;if(length)for(result=[],i=0;i<length;++i)item=items[i],item.rendered||(renderCfgs&&void 0!==renderCfgs[item.id]?itemConfig=renderCfgs[item.id]:(this.configureItem(item),itemConfig=item.getRenderTree(),renderCfgs&&(renderCfgs[item.id]=itemConfig)),itemConfig&&result.push(itemConfig));return result},finishRender:Ext.emptyFn,finishRenderItems:function(target,items){var i,item,length=items.length;for(i=0;i<length;i++)item=items[i],item.rendering&&(item.finishRender(i),this.afterRenderItem(item))},renderChildren:function(){var me=this,items=me.getLayoutItems(),target=me.getRenderTarget();me.renderItems(items,target)},renderItems:function(items,target){var item,me=this,ln=items.length,i=0;if(ln){for(Ext.suspendLayouts();i<ln;i++)item=items[i],item&&!item.rendered?me.renderItem(item,target,i):me.isValidParent(item,target,i)?me.configureItem(item):me.moveItem(item,target,i);Ext.resumeLayouts(!0)}},isValidParent:function(item,target,position){var className,itemDom=item.el?item.el.dom:Ext.getDom(item),targetDom=target&&target.dom||target,parentNode=itemDom.parentNode;return parentNode&&(className=parentNode.className,className&&className.indexOf(Ext.baseCSSPrefix+"resizable-wrap")!==-1&&(itemDom=itemDom.parentNode)),!(!itemDom||!targetDom)&&("number"==typeof position?(position=this.getPositionOffset(position),itemDom===targetDom.childNodes[position]):itemDom.parentNode===targetDom)},getPositionOffset:function(position){return position},configureItem:function(item){item.ownerLayout=this},renderItem:function(item,target,position){var me=this;item.rendered||(me.configureItem(item),item.render(target,position),me.afterRenderItem(item))},moveItem:function(item,target,position){target=target.dom||target,"number"==typeof position&&(position=target.childNodes[position]),target.insertBefore(item.el.dom,position||null),item.container=Ext.get(target),this.configureItem(item)},onContentChange:function(){return this.owner.updateLayout(),!0},initLayout:function(){this.initialized=!0},setOwner:function(owner){this.owner=owner},getLayoutItems:function(){return[]},onAdd:function(item){item.ownerLayout=this},afterRenderItem:Ext.emptyFn,onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,afterRemove:function(item){var removeClasses,me=this,el=item.el,owner=me.owner;item.rendered&&(removeClasses=[].concat(me.itemCls||[]),owner.itemCls&&(removeClasses=Ext.Array.push(removeClasses,owner.itemCls)),removeClasses.length&&el.removeCls(removeClasses)),delete item.ownerLayout},destroy:function(){var target,me=this;me.targetCls&&(target=me.getTarget(),target&&target.removeCls(me.targetCls)),me.onDestroy()},sortWeightedItems:function(items,reverseProp){for(var i=0,length=items.length;i<length;++i)items[i].$i=i;for(Ext.Array.sort(items,function(item1,item2){var ret=item2.weight-item1.weight;return ret||(ret=item1.$i-item2.$i,item1[reverseProp]&&(ret=-ret)),ret}),i=0;i<length;++i)delete items[i].$i}},function(){var Layout=this;Layout.prototype.sizeModels=Layout.sizeModels=Ext.layout.SizeModel.sizeModels}),Ext.define("Ext.layout.container.Container",{alias:["layout.container"],extend:Ext.layout.Layout,alternateClassName:"Ext.layout.ContainerLayout",mixins:{elementCt:Ext.util.ElementContainer},type:"container",beginCollapse:Ext.emptyFn,beginExpand:Ext.emptyFn,animatePolicy:null,childEls:["overflowPadderEl"],renderTpl:["{%this.renderBody(out,values)%}"],usesContainerHeight:!0,usesContainerWidth:!0,usesHeight:!0,usesWidth:!0,constructor:function(){this.callParent(arguments),this.mixins.elementCt.constructor.call(this)},destroy:function(){this.callParent(),this.mixins.elementCt.destroy.call(this)},beginLayout:function(ownerContext){this.callParent(arguments),ownerContext.targetContext=ownerContext.paddingContext=ownerContext.getEl("getTarget",this),this.cacheChildItems(ownerContext)},beginLayoutCycle:function(ownerContext,firstCycle){var me=this;me.callParent(arguments),firstCycle&&(me.usesContainerHeight&&++ownerContext.consumersContainerHeight,me.usesContainerWidth&&++ownerContext.consumersContainerWidth)},cacheChildItems:function(ownerContext){var i,context=ownerContext.context,childItems=[],items=this.getVisibleItems(),length=items.length;for(ownerContext.childItems=childItems,ownerContext.visibleItems=items,i=0;i<length;++i)childItems.push(context.getCmp(items[i]))},cacheElements:function(){var owner=this.owner;this.applyChildEls(owner.el,owner.id)},configureItem:function(item){var addClasses,me=this,itemCls=me.itemCls,ownerItemCls=me.owner.itemCls;item.ownerLayout=me,itemCls&&(addClasses="string"==typeof itemCls?[itemCls]:itemCls),ownerItemCls&&(addClasses=Ext.Array.push(addClasses||[],ownerItemCls)),addClasses&&item.addCls(addClasses)},doRenderBody:function(out,renderData){this.renderItems(out,renderData),this.renderContent(out,renderData)},doRenderContainer:function(out,renderData){var me=renderData.$comp.layout,tpl=me.getRenderTpl(),data=me.getRenderData();tpl.applyOut(data,out)},doRenderItems:function(out,renderData){var me=renderData.$layout,tree=me.getRenderTree();tree&&Ext.DomHelper.generateMarkup(tree,out)},finishRender:function(){var target,items,me=this;me.callParent(),me.cacheElements(),target=me.getRenderTarget(),items=me.getLayoutItems(),me.finishRenderItems(target,items)},notifyOwner:function(){this.owner.afterLayout(this)},getContainerSize:function(ownerContext,inDom){var gotWidth,gotHeight,width,height,targetContext=ownerContext.targetContext,frameInfo=targetContext.getFrameInfo(),padding=ownerContext.paddingContext.getPaddingInfo(),got=0,needed=0;return ownerContext.widthModel.shrinkWrap||(++needed,width=inDom?targetContext.getDomProp("width"):targetContext.getProp("width"),gotWidth="number"==typeof width,gotWidth&&(++got,width-=frameInfo.width+padding.width,width<0&&(width=0))),ownerContext.heightModel.shrinkWrap||(++needed,height=inDom?targetContext.getDomProp("height"):targetContext.getProp("height"),gotHeight="number"==typeof height,gotHeight&&(++got,height-=frameInfo.height+padding.height,height<0&&(height=0))),{width:width,height:height,needed:needed,got:got,gotAll:got==needed,gotWidth:gotWidth,gotHeight:gotHeight}},getPositionOffset:function(position){if(!this.createsInnerCt){var offset=this.owner.itemNodeOffset;offset&&(position+=offset)}return position},getLayoutItems:function(){var owner=this.owner,items=owner&&owner.items;return items&&items.items||[]},getRenderData:function(){var comp=this.owner;return{$comp:comp,$layout:this,ownerId:comp.id}},getRenderedItems:function(){var i,item,me=this,target=me.getRenderTarget(),items=me.getLayoutItems(),ln=items.length,renderedItems=[];for(i=0;i<ln;i++)item=items[i],item.rendered&&me.isValidParent(item,target,i)&&renderedItems.push(item);return renderedItems},getRenderTarget:function(){return this.owner.getTargetEl()},getElementTarget:function(){return this.getRenderTarget()},getRenderTpl:function(){var me=this,renderTpl=Ext.XTemplate.getTpl(this,"renderTpl");return renderTpl.renderContent||me.owner.setupRenderTpl(renderTpl),renderTpl},getRenderTree:function(){var result,itemsGen,items=this.owner.items,renderCfgs={};do itemsGen=items.generation,result=this.getItemsRenderTree(this.getLayoutItems(),renderCfgs);while(items.generation!==itemsGen);return result},renderChildren:function(){var itemsGen,items,me=this,ownerItems=me.owner.items,target=me.getRenderTarget();do itemsGen=ownerItems.generation,items=me.getLayoutItems(),me.renderItems(items,target);while(ownerItems.generation!==itemsGen)},getScrollbarsNeeded:function(width,height,contentWidth,contentHeight){var scrollbarSize=Ext.getScrollbarSize(),hasWidth="number"==typeof width,hasHeight="number"==typeof height,needHorz=0,needVert=0;return scrollbarSize.width?(hasHeight&&height<contentHeight&&(needVert=2,width-=scrollbarSize.width),hasWidth&&width<contentWidth&&(needHorz=1,!needVert&&hasHeight&&(height-=scrollbarSize.height,height<contentHeight&&(needVert=2))),needVert+needHorz):0},getTarget:function(){return this.owner.getTargetEl()},getVisibleItems:function(){var i,item,target=this.getRenderTarget(),items=this.getLayoutItems(),ln=items.length,visibleItems=[];for(i=0;i<ln;i++)item=items[i],item.rendered&&this.isValidParent(item,target,i)&&item.hidden!==!0&&visibleItems.push(item);return visibleItems},setupRenderTpl:function(renderTpl){var me=this;renderTpl.renderBody=me.doRenderBody,renderTpl.renderContainer=me.doRenderContainer,renderTpl.renderItems=me.doRenderItems},getContentTarget:function(){return this.owner.getDefaultContentTarget()}}),Ext.define("Ext.layout.container.Auto",{alias:["layout.auto","layout.autocontainer"],extend:Ext.layout.container.Container,type:"autocontainer",childEls:["outerCt","innerCt","clearEl"],reserveScrollbar:!1,managePadding:!0,manageOverflow:!1,lastOverflowAdjust:{width:0,height:0},renderTpl:["{% if (!(Ext.isIEQuirks || Ext.isIE7m)) { %}",'<span id="{ownerId}-outerCt" style="display:table;" role="presentation">','<div id="{ownerId}-innerCt" style="display:table-cell;height:100%;','vertical-align:top;{%this.renderPadding(out, values)%}" class="{innerCtCls}" role="presentation">',"{%this.renderBody(out,values)%}","</div>","</span>","{% } else if (values.shrinkWrapWidth) { %}",'<table id="{ownerId}-outerCt" class="'+Ext.plainTableCls+'" role="presentation">','<tbody role="presentation">','<tr role="presentation">','<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}" role="presentation">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</td>","</tr>","</tbody>","</table>","{% } else { %}",'<div id="{ownerId}-outerCt" style="zoom:1;{%this.renderPadding(out, values)%}" role="presentation">','<div id="{ownerId}-innerCt" style="zoom:1;height:100%;" class="{innerCtCls}" role="presentation">',"{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear"','role="presentation"></div>',"</div>","</div>","{% values.$layout.isShrinkWrapTpl = false %}","{% } %}"],tableTpl:['<table id="{ownerId}-outerCt" class="'+Ext.plainTableCls+'" role="presentation">','<tbody role="presentation">','<tr role="presentation">','<td id="{ownerId}-innerCt" style="vertical-align:top;padding:0;','{%this.renderPadding(out, values)%}" class="{innerCtCls}" role="presentation">',"</td>","</tr>","</tbody>","</table>"],isShrinkWrapTpl:!0,beginLayout:function(ownerContext){var bottomPadding,overflowYStyle,overflowXStyle,needsTable,me=this;me.callParent(arguments),me.initContextItems(ownerContext),me.isShrinkWrapTpl||(ownerContext.widthModel.shrinkWrap&&(needsTable=!0),Ext.isStrict&&Ext.isIE7&&(overflowXStyle=me.getOverflowXStyle(ownerContext),"auto"!==overflowXStyle&&"scroll"!==overflowXStyle||!ownerContext.paddingContext.getPaddingInfo().right||(needsTable=!0)),needsTable&&me.insertTableCt(ownerContext)),!me.isShrinkWrapTpl&&Ext.isIE7&&Ext.isStrict&&!me.clearElHasPadding&&(bottomPadding=ownerContext.paddingContext.getPaddingInfo().bottom,overflowYStyle=me.getOverflowYStyle(ownerContext),!bottomPadding||"auto"!==overflowYStyle&&"scroll"!==overflowYStyle||(me.clearEl.setStyle("height",bottomPadding),me.clearElHasPadding=!0))},beforeLayoutCycle:function(ownerContext){var comp=this.owner,hierarchyState=comp.hierarchyState,hierarchyStateInner=comp.hierarchyStateInner;hierarchyState&&!hierarchyState.invalid||(hierarchyState=comp.getHierarchyState(),hierarchyStateInner=comp.hierarchyStateInner),ownerContext.widthModel.shrinkWrap&&this.isShrinkWrapTpl?hierarchyStateInner.inShrinkWrapTable=!0:delete hierarchyStateInner.inShrinkWrapTable},beginLayoutCycle:function(ownerContext){var overflowXStyle,overflowYStyle,outerCtWidth,outerCtHeight,outerCtTableLayout,deferWidth,hierarchyStateInner,me=this,outerCt=me.outerCt,lastOuterCtWidth=me.lastOuterCtWidth||"",lastOuterCtHeight=me.lastOuterCtHeight||"",lastOuterCtTableLayout=me.lastOuterCtTableLayout||"",state=ownerContext.state;me.callParent(arguments),outerCtWidth=outerCtHeight=outerCtTableLayout="",!ownerContext.widthModel.shrinkWrap&&me.isShrinkWrapTpl&&(Ext.isIE7m&&Ext.isStrict&&(overflowYStyle=me.getOverflowYStyle(ownerContext),"auto"!==overflowYStyle&&"scroll"!==overflowYStyle||(deferWidth=!0)),deferWidth||(outerCtWidth="100%"),hierarchyStateInner=me.owner.hierarchyStateInner,overflowXStyle=me.getOverflowXStyle(ownerContext),outerCtTableLayout=hierarchyStateInner.inShrinkWrapTable||"auto"===overflowXStyle||"scroll"===overflowXStyle?"":"fixed"),ownerContext.heightModel.shrinkWrap||Ext.supports.PercentageHeightOverflowBug||(outerCtHeight="100%"),(outerCtWidth!==lastOuterCtWidth||me.hasOuterCtPxWidth)&&(outerCt.setStyle("width",outerCtWidth),me.lastOuterCtWidth=outerCtWidth,me.hasOuterCtPxWidth=!1),outerCtTableLayout!==lastOuterCtTableLayout&&(outerCt.setStyle("table-layout",outerCtTableLayout),me.lastOuterCtTableLayout=outerCtTableLayout),(outerCtHeight!==lastOuterCtHeight||me.hasOuterCtPxHeight)&&(outerCt.setStyle("height",outerCtHeight),me.lastOuterCtHeight=outerCtHeight,me.hasOuterCtPxHeight=!1),me.hasInnerCtPxHeight&&(me.innerCt.setStyle("height",""),me.hasInnerCtPxHeight=!1),state.overflowAdjust=state.overflowAdjust||me.lastOverflowAdjust},calculate:function(ownerContext){var me=this,state=ownerContext.state,containerSize=me.getContainerSize(ownerContext,!0),calculatedItems=state.calculatedItems||(state.calculatedItems=!me.calculateItems||me.calculateItems(ownerContext,containerSize));return me.setCtSizeIfNeeded(ownerContext,containerSize),calculatedItems&&ownerContext.hasDomProp("containerChildrenSizeDone")&&(me.calculateContentSize(ownerContext),containerSize.gotAll)?void(!me.manageOverflow||ownerContext.state.secondPass||me.reserveScrollbar||me.calculateOverflow(ownerContext,containerSize)):void(me.done=!1)},calculateContentSize:function(ownerContext){var me=this,containerDimensions=(ownerContext.widthModel.shrinkWrap?1:0)|(ownerContext.heightModel.shrinkWrap?2:0),calcWidth=1&containerDimensions||void 0,calcHeight=2&containerDimensions||void 0,needed=0,props=ownerContext.props;calcWidth&&(isNaN(props.contentWidth)?++needed:calcWidth=void 0),calcHeight&&(isNaN(props.contentHeight)?++needed:calcHeight=void 0),needed&&(calcWidth&&!ownerContext.setContentWidth(me.measureContentWidth(ownerContext))&&(me.done=!1),calcHeight&&!ownerContext.setContentHeight(me.measureContentHeight(ownerContext))&&(me.done=!1))},calculateOverflow:function(ownerContext){var width,height,scrollbarSize,scrollbars,xauto,yauto,targetEl,me=this;xauto="auto"===me.getOverflowXStyle(ownerContext),yauto="auto"===me.getOverflowYStyle(ownerContext),(xauto||yauto)&&(scrollbarSize=Ext.getScrollbarSize(),targetEl=ownerContext.overflowContext.el.dom,scrollbars=0,targetEl.scrollWidth>targetEl.clientWidth&&(scrollbars|=1),targetEl.scrollHeight>targetEl.clientHeight&&(scrollbars|=2),width=yauto&&2&scrollbars?scrollbarSize.width:0,height=xauto&&1&scrollbars?scrollbarSize.height:0,width===me.lastOverflowAdjust.width&&height===me.lastOverflowAdjust.height||(me.done=!1,ownerContext.invalidate({state:{overflowAdjust:{width:width,height:height},overflowState:scrollbars,secondPass:!0}})))},completeLayout:function(ownerContext){this.lastOverflowAdjust=ownerContext.state.overflowAdjust},doRenderPadding:function(out,renderData){var me=renderData.$layout,owner=renderData.$layout.owner,padding=owner[owner.contentPaddingProperty];me.managePadding&&padding&&out.push("padding:",owner.unitizeBox(padding))},finishedLayout:function(ownerContext){var innerCt=this.innerCt;this.callParent(arguments),(Ext.isIEQuirks||Ext.isIE8m)&&innerCt.repaint(),Ext.isOpera&&(innerCt.setStyle("position","relative"),innerCt.dom.scrollWidth,innerCt.setStyle("position",""))},getContainerSize:function(ownerContext,inDom){var size=this.callParent(arguments),overflowAdjust=ownerContext.state.overflowAdjust;return overflowAdjust&&(size.width-=overflowAdjust.width,size.height-=overflowAdjust.height),size},getRenderData:function(){var owner=this.owner,data=this.callParent();return(Ext.isIEQuirks||Ext.isIE7m)&&(1&owner.shrinkWrap||owner.floating&&!owner.width)&&(data.shrinkWrapWidth=!0),data},getRenderTarget:function(){return this.innerCt},getElementTarget:function(){return this.innerCt},getOverflowXStyle:function(ownerContext){return ownerContext.overflowXStyle||(ownerContext.overflowXStyle=this.owner.scrollFlags.overflowX||ownerContext.overflowContext.getStyle("overflow-x"))},getOverflowYStyle:function(ownerContext){return ownerContext.overflowYStyle||(ownerContext.overflowYStyle=this.owner.scrollFlags.overflowY||ownerContext.overflowContext.getStyle("overflow-y"))},initContextItems:function(ownerContext){var me=this,target=ownerContext.target,customOverflowEl=me.owner.customOverflowEl;ownerContext.outerCtContext=ownerContext.getEl("outerCt",me),ownerContext.innerCtContext=ownerContext.getEl("innerCt",me),customOverflowEl?ownerContext.overflowContext=ownerContext.getEl(customOverflowEl):ownerContext.overflowContext=ownerContext.targetContext,void 0!==target[target.contentPaddingProperty]&&(ownerContext.paddingContext=me.isShrinkWrapTpl?ownerContext.innerCtContext:ownerContext.outerCtContext)},initLayout:function(){var me=this,scrollbarWidth=Ext.getScrollbarSize().width,owner=me.owner;me.callParent(),scrollbarWidth&&me.manageOverflow&&!me.hasOwnProperty("lastOverflowAdjust")&&(owner.autoScroll||me.reserveScrollbar)&&(me.lastOverflowAdjust={width:scrollbarWidth,height:0})},insertTableCt:function(ownerContext){var renderTpl,fragment,childNodes,childLength,targetEl,me=this,owner=me.owner,i=0;for(renderTpl=Ext.XTemplate.getTpl(this,"tableTpl"),renderTpl.renderPadding=me.doRenderPadding,me.outerCt.dom.removeChild(me.innerCt.dom),fragment=document.createDocumentFragment(),childNodes=me.innerCt.dom.childNodes,childLength=childNodes.length;i<childLength;i++)fragment.appendChild(childNodes[0]);targetEl=me.getTarget(),targetEl.dom.innerHTML=renderTpl.apply({$layout:me,ownerId:me.owner.id}),targetEl.down("td").dom.appendChild(fragment),me.applyChildEls(owner.el,owner.id),me.isShrinkWrapTpl=!0,ownerContext.removeEl(me.outerCt),ownerContext.removeEl(me.innerCt),me.initContextItems(ownerContext)},measureContentHeight:function(ownerContext){var contentHeight=this.outerCt.getHeight(),target=ownerContext.target;return this.managePadding&&void 0===target[target.contentPaddingProperty]&&(contentHeight+=ownerContext.targetContext.getPaddingInfo().height),contentHeight},measureContentWidth:function(ownerContext){var dom,style,old,contentWidth,target;return this.chromeCellMeasureBug&&(dom=this.innerCt.dom,style=dom.style,old=style.display,"table-cell"==old&&(style.display="",dom.offsetWidth,style.display=old)),contentWidth=this.outerCt.getWidth(),target=ownerContext.target,this.managePadding&&void 0===target[target.contentPaddingProperty]&&(contentWidth+=ownerContext.targetContext.getPaddingInfo().width),contentWidth},setCtSizeIfNeeded:function(ownerContext,containerSize){var overflowStyleName,needsOuterHeight,needsInnerHeight,needsInnerCtPaddingHeight,me=this,width=containerSize.width,height=containerSize.height,padding=ownerContext.paddingContext.getPaddingInfo(),targetEl=me.getTarget(),overflowXStyle=me.getOverflowXStyle(ownerContext),overflowYStyle=me.getOverflowYStyle(ownerContext),canOverflowX="auto"===overflowXStyle||"scroll"===overflowXStyle,canOverflowY="auto"===overflowYStyle||"scroll"===overflowYStyle,scrollbarSize=Ext.getScrollbarSize(),isShrinkWrapTpl=me.isShrinkWrapTpl,manageOverflow=me.manageOverflow;width&&!ownerContext.widthModel.shrinkWrap&&(Ext.isIE7m&&Ext.isStrict&&isShrinkWrapTpl&&canOverflowY||Ext.isIEQuirks&&!isShrinkWrapTpl&&!canOverflowX)&&(manageOverflow||canOverflowY&&targetEl.dom.scrollHeight>targetEl.dom.clientHeight&&(width-=scrollbarSize.width),ownerContext.outerCtContext.setProp("width",width+padding.width),me.hasOuterCtPxWidth=!0),height&&!ownerContext.heightModel.shrinkWrap&&(Ext.supports.PercentageHeightOverflowBug&&(needsOuterHeight=!0),(Ext.isIE8&&Ext.isStrict||Ext.isIE7m&&Ext.isStrict&&isShrinkWrapTpl)&&(needsInnerHeight=!0,needsInnerCtPaddingHeight=!Ext.isIE8),(needsOuterHeight||needsInnerHeight)&&canOverflowX&&targetEl.dom.scrollWidth>targetEl.dom.clientWidth&&(height=Math.max(height-scrollbarSize.height,0)),needsOuterHeight&&(ownerContext.outerCtContext.setProp("height",height+padding.height),me.hasOuterCtPxHeight=!0),needsInnerHeight&&(needsInnerCtPaddingHeight&&(height+=padding.height),ownerContext.innerCtContext.setProp("height",height),me.hasInnerCtPxHeight=!0)),Ext.isIE7&&Ext.isStrict&&!isShrinkWrapTpl&&"auto"===overflowYStyle&&(overflowStyleName="auto"===overflowXStyle?"overflow-x":"overflow-y",targetEl.setStyle(overflowStyleName,"hidden"),targetEl.setStyle(overflowStyleName,"auto"))},setupRenderTpl:function(renderTpl){this.callParent(arguments),renderTpl.renderPadding=this.doRenderPadding},getContentTarget:function(){return this.innerCt}},function(){this.prototype.chromeCellMeasureBug=Ext.isChrome&&Ext.chromeVersion>=26}),Ext.define("Ext.ZIndexManager",{alternateClassName:"Ext.WindowGroup",statics:{zBase:9e3},constructor:function(container){var me=this;me.map={},me.zIndexStack=[],me.front=null,container?container.isContainer?(container.on("resize",me._onContainerResize,me),me.zseed=Ext.Number.from(me.rendered?container.getEl().getStyle("zIndex"):void 0,me.getNextZSeed()),me.targetEl=container.getTargetEl(),me.container=container):(Ext.EventManager.onWindowResize(me._onContainerResize,me),me.zseed=me.getNextZSeed(),me.targetEl=Ext.get(container)):(Ext.EventManager.onWindowResize(me._onContainerResize,me),me.zseed=me.getNextZSeed(),Ext.onDocumentReady(function(){me.targetEl=Ext.getBody()}))},getNextZSeed:function(){return Ext.ZIndexManager.zBase+=1e4},setBase:function(baseZIndex){this.zseed=baseZIndex;var result=this.assignZIndices();return this._activateLast(),result},assignZIndices:function(){for(var comp,topModal,a=this.zIndexStack,len=a.length,i=0,zIndex=this.zseed;i<len;i++)comp=a[i],comp&&!comp.hidden&&(zIndex=comp.setZIndex(zIndex),comp.modal&&(topModal=comp));return topModal&&this._showModalMask(topModal),zIndex},_setActiveChild:function(comp,oldFront){var front=this.front,oldPreventFocus=comp.preventFocusOnActivate;comp!==front&&(front&&!front.destroying&&front.setActive(!1,comp),this.front=comp,comp&&comp!=oldFront&&(comp.preventFocusOnActivate=comp.preventFocusOnActivate||oldFront&&(oldFront.preventFocusOnActivate||!oldFront.focusOnToFront),comp.setActive(!0),comp.modal&&this._showModalMask(comp),comp.preventFocusOnActivate=oldPreventFocus))},onComponentHide:function(comp){this._activateLast()},_activateLast:function(){for(var comp,me=this,stack=me.zIndexStack,i=stack.length-1;i>=0&&stack[i].hidden;--i);if(comp=stack[i]){if(me._setActiveChild(comp,me.front),comp.modal)return}else me.front&&!me.front.destroying&&me.front.setActive(!1),me.front=null;for(;i>=0;--i)if(comp=stack[i],comp.isVisible()&&comp.modal)return void me._showModalMask(comp);me._hideModalMask()},_showModalMask:function(comp){var viewSize,me=this,zIndex=comp.el.getStyle("zIndex")-4,maskTarget=comp.floatParent?comp.floatParent.getTargetEl():comp.container,mask=me.mask,shim=me.maskShim;mask||(Ext.isIE6&&(shim=me.maskShim=Ext.getBody().createChild({tag:"iframe",role:"presentation",cls:Ext.baseCSSPrefix+"shim "+Ext.baseCSSPrefix+"mask-shim"}),shim.setVisibilityMode(Ext.Element.DISPLAY)),mask=me.mask=Ext.getBody().createChild({role:"presentation",cls:Ext.baseCSSPrefix+"mask",style:"height:0;width:0"}),mask.setVisibilityMode(Ext.Element.DISPLAY),mask.on("click",me._onMaskClick,me)),mask.maskTarget=maskTarget,viewSize=me.getMaskBox(),shim&&(shim.setStyle("zIndex",zIndex),shim.show(),shim.setBox(viewSize)),mask.setStyle("zIndex",zIndex),mask.show(),mask.setBox(viewSize)},_hideModalMask:function(){var mask=this.mask,maskShim=this.maskShim;mask&&mask.isVisible()&&(mask.maskTarget=void 0,mask.hide(),maskShim&&maskShim.hide())},_onMaskClick:function(){this.front&&this.front.focus()},getMaskBox:function(){var maskTarget=this.mask.maskTarget;return maskTarget.dom===document.body?{height:Math.max(document.body.scrollHeight,Ext.dom.Element.getDocumentHeight()),width:Math.max(document.body.scrollWidth,document.documentElement.clientWidth),x:0,y:0}:maskTarget.getBox()},_onContainerResize:function(){var viewSize,me=this,mask=me.mask,maskShim=me.maskShim;mask&&mask.isVisible()&&(mask.hide(),maskShim&&maskShim.hide(),viewSize=me.getMaskBox(),maskShim&&(maskShim.setSize(viewSize),maskShim.show()),mask.setSize(viewSize),mask.show())},register:function(comp){var me=this,compAfterHide=comp.afterHide;comp.zIndexManager&&comp.zIndexManager.unregister(comp),comp.zIndexManager=me,me.map[comp.id]=comp,me.zIndexStack.push(comp),comp.afterHide=function(){compAfterHide.apply(comp,arguments),me.onComponentHide(comp)}},unregister:function(comp){var me=this,map=me.map;delete comp.zIndexManager,map&&map[comp.id]&&(delete map[comp.id],delete comp.afterHide,Ext.Array.remove(me.zIndexStack,comp),me._activateLast())},get:function(id){return id.isComponent?id:this.map[id]},bringToFront:function(comp,preventFocus){var me=this,result=!1,zIndexStack=me.zIndexStack;return comp=me.get(comp),comp!==me.front&&(Ext.Array.remove(zIndexStack,comp),
comp.preventBringToFront?zIndexStack.unshift(comp):zIndexStack.push(comp),me.assignZIndices(),preventFocus||me._activateLast(),result=!0,me.front=comp,comp.modal&&me._showModalMask(comp)),result},sendToBack:function(comp){var me=this;return comp=me.get(comp),Ext.Array.remove(me.zIndexStack,comp),me.zIndexStack.unshift(comp),me.assignZIndices(),this._activateLast(),comp},hideAll:function(){var item,id,map=this.map;for(id in map)map.hasOwnProperty(id)&&(item=map[id],item.isComponent&&item.isVisible()&&item.hide())},hide:function(){var comp,i=0,stack=this.zIndexStack,len=stack.length;for(this.tempHidden=[];i<len;i++)comp=stack[i],comp.isVisible()&&(this.tempHidden.push(comp),comp.el.hide(),comp.hidden=!0)},show:function(){for(var comp,i=0,tempHidden=this.tempHidden,len=tempHidden?tempHidden.length:0;i<len;i++)comp=tempHidden[i],comp.el.show(),comp.hidden=!1,comp.setPosition(comp.x,comp.y);delete this.tempHidden},getActive:function(){return this.front},getBy:function(fn,scope){for(var comp,r=[],i=0,stack=this.zIndexStack,len=stack.length;i<len;i++)comp=stack[i],fn.call(scope||comp,comp)!==!1&&r.push(comp);return r},each:function(fn,scope){var id,comp,map=this.map;for(id in map)if(map.hasOwnProperty(id)&&(comp=map[id],comp.isComponent&&fn.call(scope||comp,comp)===!1))return},eachBottomUp:function(fn,scope){for(var comp,stack=this.zIndexStack,i=0,len=stack.length;i<len;i++)if(comp=stack[i],comp.isComponent&&fn.call(scope||comp,comp)===!1)return},eachTopDown:function(fn,scope){for(var comp,stack=this.zIndexStack,i=stack.length;i-- >0;)if(comp=stack[i],comp.isComponent&&fn.call(scope||comp,comp)===!1)return},destroy:function(){var comp,id,me=this,map=me.map;for(id in map)map.hasOwnProperty(id)&&(comp=map[id],comp.isComponent&&comp.destroy());Ext.destroy(me.mask),Ext.destroy(me.maskShim),delete me.zIndexStack,delete me.map,delete me.container,delete me.targetEl}},function(){Ext.WindowManager=Ext.WindowMgr=new this}),Ext.define("Ext.Queryable",{isQueryable:!0,query:function(selector){return selector=selector||"*",Ext.ComponentQuery.query(selector,this)},queryBy:function(fn,scope){for(var item,out=[],items=this.getRefItems(!0),i=0,len=items.length;i<len;++i)item=items[i],fn.call(scope||item,item)!==!1&&out.push(item);return out},queryById:function(id){return this.down("#"+id)},child:function(selector){return selector&&selector.isComponent&&(selector="#"+Ext.escapeId(selector.getItemId())),selector=selector||"",this.query("> "+selector)[0]||null},down:function(selector){return selector&&selector.isComponent&&(selector="#"+Ext.escapeId(selector.getItemId())),selector=selector||"",this.query(selector)[0]||null},getRefItems:function(){return[]}}),Ext.define("Ext.layout.component.Component",{extend:Ext.layout.Layout,type:"component",isComponentLayout:!0,nullBox:{},usesContentHeight:!0,usesContentWidth:!0,usesHeight:!0,usesWidth:!0,beginLayoutCycle:function(ownerContext,firstCycle){var ownerLayout,v,widthName,heightName,me=this,owner=me.owner,ownerCtContext=ownerContext.ownerCtContext,heightModel=ownerContext.heightModel,widthModel=ownerContext.widthModel,body=owner.el.dom===document.body,lastBox=owner.lastBox||me.nullBox,lastSize=owner.el.lastBox||me.nullBox,dirty=!body;me.callParent(arguments),firstCycle&&(me.usesContentWidth&&++ownerContext.consumersContentWidth,me.usesContentHeight&&++ownerContext.consumersContentHeight,me.usesWidth&&++ownerContext.consumersWidth,me.usesHeight&&++ownerContext.consumersHeight,ownerCtContext&&!ownerCtContext.hasRawContent&&(ownerLayout=owner.ownerLayout,ownerLayout.usesWidth&&++ownerContext.consumersWidth,ownerLayout.usesHeight&&++ownerContext.consumersHeight)),widthModel.configured?(widthName=widthModel.names.width,body||(dirty=me.setWidthInDom||(firstCycle?owner[widthName]!==lastSize.width:widthModel.constrained)),ownerContext.setWidth(owner[widthName],dirty)):ownerContext.isTopLevel&&(widthModel.calculated&&(v=lastBox.width,ownerContext.setWidth(v,v!=lastSize.width)),v=lastBox.x,ownerContext.setProp("x",v,v!=lastSize.x)),heightModel.configured?(heightName=heightModel.names.height,body||(dirty=firstCycle?owner[heightName]!==lastSize.height:heightModel.constrained),ownerContext.setHeight(owner[heightName],dirty)):ownerContext.isTopLevel&&(heightModel.calculated&&(v=lastBox.height,ownerContext.setHeight(v,v!=lastSize.height)),v=lastBox.y,ownerContext.setProp("y",v,v!=lastSize.y))},finishedLayout:function(ownerContext){var len,i,elContext,lastBox,props,me=this,elementChildren=ownerContext.children,owner=me.owner;if(elementChildren)for(len=elementChildren.length,i=0;i<len;i++)elContext=elementChildren[i],elContext.el.lastBox=elContext.props;ownerContext.previousSize=me.lastComponentSize,me.lastComponentSize=owner.el.lastBox=props=ownerContext.props,lastBox=owner.lastBox||(owner.lastBox={}),lastBox.x=props.x,lastBox.y=props.y,lastBox.width=props.width,lastBox.height=props.height,lastBox.invalid=!1,me.callParent(arguments)},notifyOwner:function(ownerContext){var me=this,currentSize=me.lastComponentSize,prevSize=ownerContext.previousSize,args=[currentSize.width,currentSize.height];prevSize&&args.push(prevSize.width,prevSize.height),me.owner.afterComponentLayout.apply(me.owner,args)},getTarget:function(){return this.owner.el},getRenderTarget:function(){return this.owner.el},cacheTargetInfo:function(ownerContext){var target,me=this,targetInfo=me.targetInfo;return targetInfo||(target=ownerContext.getEl("getTarget",me),me.targetInfo=targetInfo={padding:target.getPaddingInfo(),border:target.getBorderInfo()}),targetInfo},measureAutoDimensions:function(ownerContext,dimensions){var isContainer,zeroWidth,zeroHeight,ready,size,temp,me=this,owner=me.owner,containerLayout=owner.layout,heightModel=ownerContext.heightModel,widthModel=ownerContext.widthModel,boxParent=ownerContext.boxParent,isBoxParent=ownerContext.isBoxParent,props=ownerContext.props,ret={gotWidth:!1,gotHeight:!1,isContainer:isContainer=!ownerContext.hasRawContent},hv=dimensions||3,needed=0,got=0;return widthModel.shrinkWrap&&ownerContext.consumersContentWidth?(++needed,zeroWidth=!(1&hv),isContainer?zeroWidth?(ret.contentWidth=0,ret.gotWidth=!0,++got):void 0!==(ret.contentWidth=ownerContext.getProp("contentWidth"))&&(ret.gotWidth=!0,++got):(size=props.contentWidth,"number"==typeof size?(ret.contentWidth=size,ret.gotWidth=!0,++got):(ready=!!zeroWidth||!!ownerContext.hasDomProp("containerChildrenSizeDone")&&(!(!isBoxParent&&boxParent&&!boxParent.widthModel.shrinkWrap)||boxParent.hasDomProp("width")),ready&&(temp=zeroWidth?0:containerLayout&&containerLayout.measureContentWidth?containerLayout.measureContentWidth(ownerContext):me.measureContentWidth(ownerContext),isNaN(ret.contentWidth=temp)||(ownerContext.setContentWidth(temp,!0),ret.gotWidth=!0,++got))))):widthModel.natural&&ownerContext.consumersWidth&&(++needed,size=props.width,"number"==typeof size?(ret.width=size,ret.gotWidth=!0,++got):(ready=!(!isBoxParent&&boxParent)||boxParent.hasDomProp("width"),ready&&(isNaN(ret.width=me.measureOwnerWidth(ownerContext))||(ownerContext.setWidth(ret.width,!1),ret.gotWidth=!0,++got)))),heightModel.shrinkWrap&&ownerContext.consumersContentHeight?(++needed,zeroHeight=!(2&hv),isContainer?zeroHeight?(ret.contentHeight=0,ret.gotHeight=!0,++got):void 0!==(ret.contentHeight=ownerContext.getProp("contentHeight"))&&(ret.gotHeight=!0,++got):(size=props.contentHeight,"number"==typeof size?(ret.contentHeight=size,ret.gotHeight=!0,++got):(ready=!!zeroHeight||!!ownerContext.hasDomProp("containerChildrenSizeDone")&&(!!owner.noWrap||(widthModel.shrinkWrap?!(!isBoxParent&&boxParent&&!boxParent.widthModel.shrinkWrap)||boxParent.hasDomProp("width"):(ownerContext.bodyContext||ownerContext).hasDomProp("width"))),ready&&(temp=zeroHeight?0:containerLayout&&containerLayout.measureContentHeight?containerLayout.measureContentHeight(ownerContext):me.measureContentHeight(ownerContext),isNaN(ret.contentHeight=temp)||(ownerContext.setContentHeight(temp,!0),ret.gotHeight=!0,++got))))):heightModel.natural&&ownerContext.consumersHeight&&(++needed,size=props.height,"number"==typeof size?(ret.height=size,ret.gotHeight=!0,++got):(ready=!(!isBoxParent&&boxParent)||boxParent.hasDomProp("width"),ready&&(isNaN(ret.height=me.measureOwnerHeight(ownerContext))||(ownerContext.setHeight(ret.height,!1),ret.gotHeight=!0,++got)))),boxParent&&ownerContext.onBoxMeasured(),ret.gotAll=got==needed,ret},measureContentWidth:function(ownerContext){return ownerContext.el.getWidth()-ownerContext.getFrameInfo().width},measureContentHeight:function(ownerContext){return ownerContext.el.getHeight()-ownerContext.getFrameInfo().height},measureOwnerHeight:function(ownerContext){return ownerContext.el.getHeight()},measureOwnerWidth:function(ownerContext){return ownerContext.el.getWidth()}}),Ext.define("Ext.layout.component.Auto",{alias:"layout.autocomponent",extend:Ext.layout.component.Component,type:"autocomponent",setHeightInDom:!1,setWidthInDom:!1,waitForOuterHeightInDom:!1,waitForOuterWidthInDom:!1,beginLayoutCycle:function(ownerContext,firstCycle){var me=this,lastWidthModel=me.lastWidthModel,lastHeightModel=me.lastHeightModel,el=me.owner.el;me.callParent(arguments),lastWidthModel&&lastWidthModel.fixed&&ownerContext.widthModel.shrinkWrap&&el.setWidth(null),lastHeightModel&&lastHeightModel.fixed&&ownerContext.heightModel.shrinkWrap&&el.setHeight(null)},calculate:function(ownerContext){var width,height,me=this,measurement=me.measureAutoDimensions(ownerContext),heightModel=ownerContext.heightModel,widthModel=ownerContext.widthModel;measurement.gotWidth?widthModel.shrinkWrap?me.publishOwnerWidth(ownerContext,measurement.contentWidth):me.publishInnerWidth&&me.publishInnerWidth(ownerContext,measurement.width):!widthModel.auto&&me.publishInnerWidth&&(width=me.waitForOuterWidthInDom?ownerContext.getDomProp("width"):ownerContext.getProp("width"),void 0===width?me.done=!1:me.publishInnerWidth(ownerContext,width)),measurement.gotHeight?heightModel.shrinkWrap?me.publishOwnerHeight(ownerContext,measurement.contentHeight):me.publishInnerHeight&&me.publishInnerHeight(ownerContext,measurement.height):!heightModel.auto&&me.publishInnerHeight&&(height=me.waitForOuterHeightInDom?ownerContext.getDomProp("height"):ownerContext.getProp("height"),void 0===height?me.done=!1:me.publishInnerHeight(ownerContext,height)),measurement.gotAll||(me.done=!1)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){return contentHeight+ownerContext.getFrameInfo().height},calculateOwnerWidthFromContentWidth:function(ownerContext,contentWidth){return contentWidth+ownerContext.getFrameInfo().width},publishOwnerHeight:function(ownerContext,contentHeight){var constrainedHeight,dirty,heightModel,me=this,owner=me.owner,height=me.calculateOwnerHeightFromContentHeight(ownerContext,contentHeight);isNaN(height)?me.done=!1:(constrainedHeight=Ext.Number.constrain(height,owner.minHeight,owner.maxHeight),constrainedHeight==height?dirty=me.setHeightInDom:(heightModel=me.sizeModels[constrainedHeight<height?"constrainedMax":"constrainedMin"],height=constrainedHeight,ownerContext.heightModel.calculatedFromShrinkWrap?ownerContext.heightModel=heightModel:ownerContext.invalidate({heightModel:heightModel})),ownerContext.setHeight(height,dirty))},publishOwnerWidth:function(ownerContext,contentWidth){var constrainedWidth,dirty,widthModel,me=this,owner=me.owner,width=me.calculateOwnerWidthFromContentWidth(ownerContext,contentWidth);isNaN(width)?me.done=!1:(constrainedWidth=Ext.Number.constrain(width,owner.minWidth,owner.maxWidth),constrainedWidth==width?dirty=me.setWidthInDom:(widthModel=me.sizeModels[constrainedWidth<width?"constrainedMax":"constrainedMin"],width=constrainedWidth,ownerContext.widthModel.calculatedFromShrinkWrap?ownerContext.widthModel=widthModel:ownerContext.invalidate({widthModel:widthModel})),ownerContext.setWidth(width,dirty))}}),Ext.define("Ext.container.AbstractContainer",{extend:Ext.Component,mixins:{queryable:Ext.Queryable},renderTpl:"{%this.renderContainer(out,values)%}",suspendLayout:!1,autoDestroy:!0,defaultType:"panel",detachOnRemove:!0,isContainer:!0,layoutCounter:0,baseCls:Ext.baseCSSPrefix+"container",defaultLayoutType:"auto",ariaRole:"presentation",initComponent:function(){var me=this;me.addEvents("afterlayout","beforeadd","beforeremove","add","remove"),me.callParent(),me.getLayout(),me.initItems()},initItems:function(){var me=this,items=me.items;me.items=new Ext.util.AbstractMixedCollection((!1),me.getComponentId),me.floatingItems=new Ext.util.MixedCollection((!1),me.getComponentId),items&&(Ext.isArray(items)||(items=[items]),me.add(items))},getFocusEl:function(){return this.getTargetEl()},finishRenderChildren:function(){this.callParent();var layout=this.getLayout();layout&&layout.finishRender()},beforeRender:function(){var targetCls,me=this,layout=me.getLayout();me.callParent(),layout.initialized||layout.initLayout(),targetCls=layout.targetCls,targetCls&&me.applyTargetCls(targetCls)},applyTargetCls:function(targetCls){this.addCls(targetCls)},afterComponentLayout:function(){var i,floater,floaters=this.floatingItems.items,floaterCount=floaters.length;for(this.callParent(arguments),i=0;i<floaterCount;i++)floater=floaters[i],!floater.rendered&&floater.autoShow&&floater.show()},onPosition:function(){this.callParent(arguments),this.repositionFloatingItems()},onResize:function(){this.callParent(arguments),this.repositionFloatingItems()},repositionFloatingItems:function(){var i,floater,floaters=this.floatingItems.items,floaterCount=floaters.length;for(i=0;i<floaterCount;i++)floater=floaters[i],floater.el&&!floater.hidden&&floater.setPosition(floater.x,floater.y)},setupRenderTpl:function(renderTpl){this.callParent(arguments),this.getLayout().setupRenderTpl(renderTpl)},getDefaultContentTarget:function(){return this.el},getContentTarget:function(){return this.getLayout().getContentTarget()},setLayout:function(layout){var currentLayout=this.layout;currentLayout&&currentLayout.isLayout&&currentLayout!=layout&&currentLayout.setOwner(null),this.layout=layout,layout.setOwner(this)},getLayout:function(){var me=this;return me.layout&&me.layout.isLayout||me.setLayout(Ext.layout.Layout.create(me.layout,me.self.prototype.layout||me.defaultLayoutType)),me.layout},doLayout:function(){return this.updateLayout(),this},afterLayout:function(layout){var me=this;++me.layoutCounter,me.hasListeners.afterlayout&&me.fireEvent("afterlayout",me,layout)},prepareItems:function(items,applyDefaults){items=Ext.isArray(items)?items.slice():[items];for(var item,me=this,i=0,len=items.length;i<len;i++)item=items[i],null==item?(Ext.Array.erase(items,i,1),--i,--len):(applyDefaults&&(item=this.applyDefaults(item)),item.isContained=me,items[i]=me.lookupComponent(item),delete item.isContained,delete items[i].isContained);return items},applyDefaults:function(config){var defaults=this.defaults;return defaults&&(Ext.isFunction(defaults)&&(defaults=defaults.call(this,config)),Ext.isString(config)&&(config=Ext.ComponentManager.get(config)),Ext.applyIf(config,defaults)),config},lookupComponent:function(comp){return"string"==typeof comp?Ext.ComponentManager.get(comp):Ext.ComponentManager.create(comp,this.defaultType)},getComponentId:function(comp){return comp.getItemId&&comp.getItemId()},add:function(){var addingArray,items,i,length,item,pos,ret,me=this,args=Ext.Array.slice(arguments),index="number"==typeof args[0]?args.shift():-1,layout=me.getLayout(),needsLayout=!1;for(1==args.length&&Ext.isArray(args[0])?(items=args[0],addingArray=!0):items=args,me.rendered&&Ext.suspendLayouts(),ret=items=me.prepareItems(items,!0),length=items.length,addingArray||1!=length||(ret=items[0]),i=0;i<length;i++)item=items[i],pos=index<0?me.items.length:index+i,item.floating?(me.floatingItems.add(item),item.onAdded(me,pos),me.hasListeners.add&&me.fireEvent("add",me,item,pos)):me.hasListeners.beforeadd&&me.fireEvent("beforeadd",me,item,pos)===!1||me.onBeforeAdd(item)===!1||(me.items.insert(pos,item),item.onAdded(me,pos),me.onAdd(item,pos),layout.onAdd(item,pos),needsLayout=!0,me.hasListeners.add&&me.fireEvent("add",me,item,pos));return needsLayout&&me.updateLayout(),me.rendered&&Ext.resumeLayouts(!0),ret},onAdd:Ext.emptyFn,onRemove:Ext.emptyFn,insert:function(index,comp){var compIdx;return comp&&comp.isComponent&&(compIdx=this.items.indexOf(comp),compIdx!==-1)?this.move(compIdx,index):this.add(index,comp)},move:function(fromIdx,toIdx){var item,items=this.items;return fromIdx.isComponent&&(fromIdx=items.indexOf(fromIdx)),item=items.removeAt(fromIdx),item!==!1&&(items.insert(toIdx,item),this.onMove(item,fromIdx,toIdx),this.updateLayout(),item)},onMove:Ext.emptyFn,onBeforeAdd:function(item){item.ownerCt&&item.ownerCt!==this&&item.ownerCt.remove(item,!1)},remove:function(comp,autoDestroy){var me=this,c=me.getComponent(comp);return!c||me.hasListeners.beforeremove&&me.fireEvent("beforeremove",me,c)===!1||(me.doRemove(c,autoDestroy),me.hasListeners.remove&&me.fireEvent("remove",me,c),me.destroying||c.floating||me.updateLayout()),c},doRemove:function(component,doDestroy){doDestroy=doDestroy===!0||doDestroy!==!1&&this.autoDestroy;var me=this,layout=me.layout,hasLayout=layout&&me.rendered,isDestroying=component.destroying||doDestroy,floating=component.floating;floating?me.floatingItems.remove(component):me.items.remove(component),hasLayout&&!floating&&(layout.running&&Ext.AbstractComponent.cancelLayout(component,isDestroying),layout.onRemove(component,isDestroying)),component.onRemoved(isDestroying),me.onRemove(component,isDestroying),doDestroy?component.destroy():(hasLayout&&!floating&&layout.afterRemove(component),me.detachOnRemove&&component.rendered&&me.detachComponent(component))},detachComponent:function(component){Ext.getDetachedBody().appendChild(component.getEl())},removeAll:function(autoDestroy){var item,me=this,removeItems=me.items.items.slice().concat(me.floatingItems.items),items=[],i=0,len=removeItems.length;for(me.suspendLayouts();i<len;i++)item=removeItems[i],me.remove(item,autoDestroy),item.ownerCt!==me&&items.push(item);return me.resumeLayouts(!!len),items},getRefItems:function(deep){for(var item,me=this,items=me.items.items,len=items.length,i=0,result=[];i<len;i++)item=items[i],result[result.length]=item,deep&&item.getRefItems&&result.push.apply(result,item.getRefItems(!0));for(items=me.floatingItems.items,len=items.length,i=0;i<len;i++)item=items[i],result[result.length]=item,deep&&item.getRefItems&&result.push.apply(result,item.getRefItems(!0));return result},cascade:function(fn,scope,origArgs){var c,me=this,cs=me.items?me.items.items:[],len=cs.length,i=0,args=origArgs?origArgs.concat(me):[me],componentIndex=args.length-1;if(fn.apply(scope||me,args)!==!1)for(;i<len;i++)c=cs[i],c.cascade?c.cascade(fn,scope,origArgs):(args[componentIndex]=c,fn.apply(scope||cs,args));return this},isAncestor:function(possibleDescendant){for(;possibleDescendant;){if(possibleDescendant.ownerCt===this)return!0;possibleDescendant=possibleDescendant.ownerCt}},getComponent:function(comp){Ext.isObject(comp)&&(comp=comp.getItemId());var c=this.items.get(comp);return c||"number"==typeof comp||(c=this.floatingItems.get(comp)),c},contains:function(comp,deep){var result=!1;return deep?(this.cascade(function(c){if(c.contains&&c.contains(comp))return result=!0,!1}),result):this.items.contains(comp)||this.floatingItems.contains(comp)},nextChild:function(child,selector){var result,me=this,childIndex=me.items.indexOf(child);return childIndex!==-1&&(result=selector?Ext.ComponentQuery(selector,me.items.items.slice(childIndex+1)):me.items.getAt(childIndex+1),!result&&me.ownerCt&&(result=me.ownerCt.nextChild(me,selector))),result},prevChild:function(child,selector){var result,me=this,childIndex=me.items.indexOf(child);return childIndex!==-1&&(result=selector?Ext.ComponentQuery(selector,me.items.items.slice(childIndex+1)):me.items.getAt(childIndex+1),!result&&me.ownerCt&&(result=me.ownerCt.nextChild(me,selector))),result},enable:function(){this.callParent(arguments);var item,i,itemsToDisable=this.getChildItemsToDisable(),length=itemsToDisable.length;for(i=0;i<length;i++)item=itemsToDisable[i],item.resetDisable&&item.enable();return this},disable:function(){this.callParent(arguments);var item,i,itemsToDisable=this.getChildItemsToDisable(),length=itemsToDisable.length;for(i=0;i<length;i++)item=itemsToDisable[i],item.resetDisable===!1||item.disabled||(item.disable(),item.resetDisable=!0);return this},getChildItemsToDisable:function(){return this.query("[isFormField],button")},beforeDestroy:function(){var c,me=this,items=me.items,floatingItems=me.floatingItems;if(items)for(;c=items.first();)me.doRemove(c,!0);if(floatingItems)for(;c=floatingItems.first();)me.doRemove(c,!0);Ext.destroy(me.layout),me.callParent()}}),Ext.define("Ext.container.Container",{extend:Ext.container.AbstractContainer,alias:"widget.container",alternateClassName:"Ext.Container",getChildByElement:function(el,deep){var item,itemEl,i=0,it=this.getRefItems(),ln=it.length;for(el=Ext.getDom(el);i<ln;i++)if(item=it[i],itemEl=item.getEl(),itemEl&&(itemEl.dom===el||itemEl.contains(el)))return deep&&item.getChildByElement?item.getChildByElement(el,deep):item;return null}}),Ext.define("Ext.layout.container.Editor",{alias:"layout.editor",extend:Ext.layout.container.Container,autoSizeDefault:{width:"field",height:"field"},sizePolicies:{$:{$:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},boundEl:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1}},boundEl:{$:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},boundEl:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}}},getItemSizePolicy:function(item){var me=this,autoSize=me.owner.autoSize,key=autoSize&&autoSize.width,policy=me.sizePolicies;return policy=policy[key]||policy.$,key=autoSize&&autoSize.height,policy=policy[key]||policy.$},calculate:function(ownerContext){var fieldWidth,fieldHeight,me=this,owner=me.owner,autoSize=owner.autoSize;autoSize===!0&&(autoSize=me.autoSizeDefault),autoSize&&(fieldWidth=me.getDimension(owner,autoSize.width,"getWidth",owner.width),fieldHeight=me.getDimension(owner,autoSize.height,"getHeight",owner.height)),ownerContext.childItems[0].setSize(fieldWidth,fieldHeight),ownerContext.setWidth(fieldWidth),ownerContext.setHeight(fieldHeight),ownerContext.setContentSize(fieldWidth||owner.field.getWidth(),fieldHeight||owner.field.getHeight())},getDimension:function(owner,type,getMethod,ownerSize){switch(type){case"boundEl":return owner.boundEl[getMethod]();case"field":return;default:return ownerSize}}}),Ext.define("Ext.Editor",{extend:Ext.container.Container,alias:"widget.editor",layout:"editor",allowBlur:!0,revertInvalid:!0,value:"",alignment:"c-c?",offsets:[0,0],shadow:"frame",constrain:!1,swallowKeys:!0,completeOnEnter:!0,cancelOnEsc:!0,updateEl:!1,focusOnToFront:!1,hidden:!0,baseCls:Ext.baseCSSPrefix+"editor",initComponent:function(){var me=this,field=me.field=Ext.ComponentManager.create(me.field,"textfield");field.inEditor=!0,field.msgTarget=field.msgTarget||"qtip",me.mon(field,{scope:me,blur:me.onFieldBlur,specialkey:me.onSpecialKey}),field.grow&&me.mon(field,"autosize",me.onFieldAutosize,me,{delay:1}),me.floating={constrain:me.constrain},me.items=field,me.callParent(arguments),me.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},onFieldAutosize:function(){this.updateLayout()},afterRender:function(ct,position){var me=this,field=me.field,inputEl=field.inputEl;me.callParent(arguments),inputEl&&(inputEl.dom.name="",me.swallowKeys&&inputEl.swallowEvent(["keypress","keydown"]))},onSpecialKey:function(field,event){var me=this,key=event.getKey(),complete=me.completeOnEnter&&key==event.ENTER,cancel=me.cancelOnEsc&&key==event.ESC;(complete||cancel)&&(event.stopEvent(),Ext.defer(function(){complete?me.completeEdit():me.cancelEdit()},1)),me.fireEvent("specialkey",me,field,event)},startEdit:function(el,value){var me=this,field=me.field;me.completeEdit(),me.boundEl=Ext.get(el),value=Ext.isDefined(value)?value:Ext.String.trim(me.boundEl.dom.innerText||me.boundEl.dom.innerHTML),me.rendered||(me.ownerCt&&(me.parentEl=me.ownerCt.el,me.parentEl.position()),me.render(me.parentEl||document.body)),me.fireEvent("beforestartedit",me,me.boundEl,value)!==!1&&(me.startValue=value,me.show(),field.suspendEvents(),field.reset(),field.setValue(value),field.resumeEvents(),me.realign(!0),field.focus([field.getRawValue().length]),field.autoSize&&field.autoSize(),me.editing=!0)},realign:function(autoSize){var me=this;autoSize===!0&&me.updateLayout(),me.alignTo(me.boundEl,me.alignment,me.offsets)},completeEdit:function(remainVisible){var value,me=this,field=me.field;if(me.editing)return field.assertValue&&field.assertValue(),value=me.getValue(),field.isValid()?String(value)===String(me.startValue)&&me.ignoreNoChange?void me.hideEdit(remainVisible):void(me.fireEvent("beforecomplete",me,value,me.startValue)!==!1&&(value=me.getValue(),me.updateEl&&me.boundEl&&me.boundEl.update(value),me.hideEdit(remainVisible),me.fireEvent("complete",me,value,me.startValue))):void(me.revertInvalid!==!1&&me.cancelEdit(remainVisible))},onShow:function(){var me=this;me.callParent(arguments),me.hideEl!==!1&&me.boundEl.hide(),me.fireEvent("startedit",me,me.boundEl,me.startValue)},cancelEdit:function(remainVisible){var value,me=this,startValue=me.startValue,field=me.field;me.editing&&(field&&(value=me.editedValue=me.getValue(),field.suspendEvents(),me.setValue(startValue),field.resumeEvents()),me.hideEdit(remainVisible),me.fireEvent("canceledit",me,value,startValue),delete me.editedValue)},hideEdit:function(remainVisible){remainVisible!==!0&&(this.editing=!1,this.hide())},onFieldBlur:function(field,e){var me=this,target=Ext.Element.getActiveElement();me.allowBlur===!0&&me.editing&&me.selectSameEditor!==!0&&me.completeEdit(),(Ext.fly(target).isFocusable()||target.getAttribute("tabIndex"))&&target.focus()},onHide:function(){var me=this,field=me.field;return me.editing?void me.completeEdit():(field.hasFocus&&field.triggerBlur&&field.triggerBlur(),field.collapse&&field.collapse(),me.hideEl!==!1&&me.boundEl.show(),void me.callParent(arguments))},setValue:function(value){this.field.setValue(value)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){var me=this;Ext.destroy(me.field),delete me.field,delete me.parentEl,delete me.boundEl,me.callParent(arguments)}}),Ext.define("Ext.util.KeyMap",{alternateClassName:"Ext.KeyMap",eventName:"keydown",constructor:function(config){var me=this;return 1!==arguments.length||"string"==typeof config||config.dom||config.tagName||config===document||config.isComponent?void me.legacyConstructor.apply(me,arguments):(Ext.apply(me,config),me.bindings=[],me.target.isComponent||(me.target=Ext.get(me.target)),me.binding?me.addBinding(me.binding):config.key&&me.addBinding(config),void me.enable())},legacyConstructor:function(el,binding,eventName){var me=this;Ext.apply(me,{target:Ext.get(el),eventName:eventName||me.eventName,bindings:[]}),binding&&me.addBinding(binding),me.enable()},addBinding:function(binding){var i,len,me=this,keyCode=binding.key;if(me.processing&&(me.bindings=bindings.slice(0)),Ext.isArray(binding))for(i=0,len=binding.length;i<len;i++)me.addBinding(binding[i]);else me.bindings.push(Ext.apply({keyCode:me.processKeys(keyCode)},binding))},removeBinding:function(binding){var i,item,keys,me=this,bindings=me.bindings,len=bindings.length;for(me.processing&&(me.bindings=bindings.slice(0)),keys=me.processKeys(binding.key),i=0;i<len;++i)if(item=bindings[i],item.fn===binding.fn&&item.scope===binding.scope&&binding.alt==item.alt&&binding.crtl==item.crtl&&binding.shift==item.shift&&Ext.Array.equals(item.keyCode,keys))return void Ext.Array.erase(me.bindings,i,1)},processKeys:function(keyCode){var key,keys,keyString,len,i,processed=!1;if(Ext.isString(keyCode)){for(keys=[],keyString=keyCode.toUpperCase(),i=0,len=keyString.length;i<len;++i)keys.push(keyString.charCodeAt(i));keyCode=keys,processed=!0}if(Ext.isArray(keyCode)||(keyCode=[keyCode]),!processed)for(i=0,len=keyCode.length;i<len;++i)key=keyCode[i],Ext.isString(key)&&(keyCode[i]=key.toUpperCase().charCodeAt(0));return keyCode},handleTargetEvent:function(){var tagRe=/input|textarea/i;return function(event){var bindings,i,len,target,contentEditable,me=this;if(me.enabled){if(bindings=me.bindings,i=0,len=bindings.length,event=me.processEvent.apply(me||me.processEventScope,arguments),me.ignoreInputFields&&(target=event.target,contentEditable=target.contentEditable,tagRe.test(target.tagName)||""===contentEditable||"true"===contentEditable))return;if(!event.getKey)return event;for(me.processing=!0;i<len;++i)me.processBinding(bindings[i],event);me.processing=!1}}}(),processEvent:Ext.identityFn,processBinding:function(binding,event){if(this.checkModifiers(binding,event)){var i,len,key=event.getKey(),handler=binding.fn||binding.handler,scope=binding.scope||this,keyCode=binding.keyCode,defaultEventAction=binding.defaultEventAction,keydownEvent=new Ext.EventObjectImpl(event);for(i=0,len=keyCode.length;i<len;++i)if(key===keyCode[i]){handler.call(scope,key,event)!==!0&&defaultEventAction&&keydownEvent[defaultEventAction]();break}}},checkModifiers:function(binding,e){for(var val,key,keys=["shift","ctrl","alt"],i=0,len=keys.length;i<len;++i)if(key=keys[i],val=binding[key],void 0!==val&&val!==e[key+"Key"])return!1;return!0},on:function(key,fn,scope){var keyCode,shift,ctrl,alt;Ext.isObject(key)&&!Ext.isArray(key)?(keyCode=key.key,shift=key.shift,ctrl=key.ctrl,alt=key.alt):keyCode=key,this.addBinding({key:keyCode,shift:shift,ctrl:ctrl,alt:alt,fn:fn,scope:scope})},un:function(key,fn,scope){var keyCode,shift,ctrl,alt;Ext.isObject(key)&&!Ext.isArray(key)?(keyCode=key.key,shift=key.shift,ctrl=key.ctrl,alt=key.alt):keyCode=key,this.removeBinding({key:keyCode,shift:shift,ctrl:ctrl,alt:alt,fn:fn,scope:scope})},isEnabled:function(){return this.enabled},enable:function(){var me=this;me.enabled||(me.target.on(me.eventName,me.handleTargetEvent,me),me.enabled=!0)},disable:function(){var me=this;me.enabled&&(me.target.removeListener(me.eventName,me.handleTargetEvent,me),me.enabled=!1)},setDisabled:function(disabled){disabled?this.disable():this.enable()},destroy:function(removeTarget){var me=this,target=me.target;me.bindings=[],me.disable(),removeTarget===!0&&(target.isComponent?target.destroy():target.remove()),delete me.target}}),Ext.define("Ext.util.KeyNav",{alternateClassName:"Ext.KeyNav",statics:{keyOptions:{left:37,right:39,up:38,down:40,space:32,pageUp:33,pageDown:34,del:46,backspace:8,home:36,end:35,enter:13,esc:27,tab:9}},constructor:function(config){var me=this;return 2===arguments.length?void me.legacyConstructor.apply(me,arguments):void me.setConfig(config)},legacyConstructor:function(el,config){this.setConfig(Ext.apply({target:el},config))},setConfig:function(config){var map,keyCodes,defaultScope,keyName,binding,me=this,keymapCfg={target:config.target,ignoreInputFields:config.ignoreInputFields,eventName:me.getKeyEvent("forceKeyDown"in config?config.forceKeyDown:me.forceKeyDown,config.eventName)};me.map&&me.map.destroy(),config.processEvent&&(keymapCfg.processEvent=config.processEvent,keymapCfg.processEventScope=config.processEventScope||me),config.keyMap?map=me.map=config.keyMap:(map=me.map=new Ext.util.KeyMap(keymapCfg),me.destroyKeyMap=!0),keyCodes=Ext.util.KeyNav.keyOptions,defaultScope=config.scope||me;for(keyName in keyCodes)keyCodes.hasOwnProperty(keyName)&&(binding=config[keyName])&&("function"==typeof binding&&(binding={handler:binding,defaultEventAction:void 0!==config.defaultEventAction?config.defaultEventAction:me.defaultEventAction}),map.addBinding({key:keyCodes[keyName],handler:Ext.Function.bind(me.handleEvent,binding.scope||defaultScope,binding.handler||binding.fn,!0),defaultEventAction:void 0!==binding.defaultEventAction?binding.defaultEventAction:me.defaultEventAction}));map.disable(),config.disabled||map.enable()},handleEvent:function(keyCode,event,handler){return handler.call(this,event)},disabled:!1,defaultEventAction:"stopEvent",forceKeyDown:!1,eventName:"keypress",destroy:function(removeEl){
this.destroyKeyMap&&this.map.destroy(removeEl),delete this.map},enable:function(){this.map&&(this.map.enable(),this.disabled=!1)},disable:function(){this.map&&this.map.disable(),this.disabled=!0},setDisabled:function(disabled){this.map.setDisabled(disabled),this.disabled=disabled},getKeyEvent:function(forceKeyDown,configuredEventName){return forceKeyDown||Ext.EventManager.useKeyDown&&!configuredEventName?"keydown":configuredEventName||this.eventName}}),Ext.define("Ext.FocusManager",{singleton:!0,alternateClassName:["Ext.FocusMgr"],mixins:{observable:Ext.util.Observable},enabled:!1,focusElementCls:Ext.baseCSSPrefix+"focus-element",focusFrameCls:Ext.baseCSSPrefix+"focus-frame",whitelist:["textfield"],constructor:function(config){var me=this,CQ=Ext.ComponentQuery;me.mixins.observable.constructor.call(me,config),me.addEvents("beforecomponentfocus","componentfocus","disable","enable"),me.focusTask=new Ext.util.DelayedTask(me.handleComponentFocus,me),Ext.override(Ext.AbstractComponent,{onFocus:function(){this.callParent(arguments),me.enabled&&this.hasFocus&&(Array.prototype.unshift.call(arguments,this),me.onComponentFocus.apply(me,arguments))},onBlur:function(){this.callParent(arguments),me.enabled&&!this.hasFocus&&(Array.prototype.unshift.call(arguments,this),me.onComponentBlur.apply(me,arguments))},onDestroy:function(){this.callParent(arguments),me.enabled&&(Array.prototype.unshift.call(arguments,this),me.onComponentDestroy.apply(me,arguments))}}),Ext.override(Ext.Component,{afterHide:function(){this.callParent(arguments),me.enabled&&(Array.prototype.unshift.call(arguments,this),me.onComponentHide.apply(me,arguments))}}),me.keyNav=new Ext.util.KeyNav(Ext.getDoc(),{disabled:!0,scope:me,backspace:me.focusLast,enter:me.navigateIn,esc:me.navigateOut,tab:me.navigateSiblings,space:me.navigateIn,del:me.focusLast,left:me.navigateSiblings,right:me.navigateSiblings,down:me.navigateSiblings,up:me.navigateSiblings}),me.focusData={},me.subscribers=new Ext.util.HashMap,me.focusChain={},Ext.apply(CQ.pseudos,{nextFocus:function(cmps,idx,step){step=step||1,idx=parseInt(idx,10);for(var c,len=cmps.length,i=idx;;){if((i+=step)>=len?i=0:i<0&&(i=len-1),i===idx)return[];if((c=cmps[i]).isFocusable())return[c]}return[]},prevFocus:function(cmps,idx){return this.nextFocus(cmps,idx,-1)},root:function(cmps){for(var c,len=cmps.length,results=[],i=0;i<len;i++)c=cmps[i],c.ownerCt||results.push(c);return results}})},addXTypeToWhitelist:function(xtype){var me=this;return Ext.isArray(xtype)?void Ext.Array.forEach(xtype,me.addXTypeToWhitelist,me):void(Ext.Array.contains(me.whitelist,xtype)||me.whitelist.push(xtype))},clearComponent:function(cmp){clearTimeout(this.cmpFocusDelay),cmp.isDestroyed||cmp.blur()},disable:function(){var me=this;me.enabled&&(delete me.options,me.enabled=!1,me.removeDOM(),me.keyNav.disable(),me.fireEvent("disable",me))},enable:function(options){var me=this;options===!0&&(options={focusFrame:!0}),me.options=options=options||{},me.enabled||(me.enabled=!0,me.initDOM(options),me.keyNav.enable(),me.focusEl.focus(),delete me.focusedCmp,me.fireEvent("enable",me))},focusLast:function(e){var me=this;return!!me.isWhitelisted(me.focusedCmp)||void(me.previousFocusedCmp&&me.previousFocusedCmp.focus())},getRootComponents:function(){var CQ=Ext.ComponentQuery,inline=CQ.query(":focusable:root:not([floating])"),floating=CQ.query(":focusable:root[floating]");return floating.sort(function(a,b){return a.el.getZIndex()>b.el.getZIndex()}),floating.concat(inline)},initDOM:function(options){var me=this,cls=me.focusFrameCls,needListeners=Ext.ComponentQuery.query("{getFocusEl()}:not([focusListenerAdded])"),i=0,len=needListeners.length;if(!Ext.isReady)return Ext.onReady(me.initDOM,me);for(;i<len;i++)needListeners[i].addFocusListener();me.focusEl||(me.focusEl=Ext.getBody(),me.focusEl.dom.tabIndex=-1),!me.focusFrame&&options.focusFrame&&(me.focusFrame=Ext.getBody().createChild({cls:cls,children:[{cls:cls+"-top"},{cls:cls+"-bottom"},{cls:cls+"-left"},{cls:cls+"-right"}],style:"top: -100px; left: -100px;"}),me.focusFrame.setVisibilityMode(Ext.Element.DISPLAY),me.focusFrame.hide().setLocalXY(0,0))},isWhitelisted:function(cmp){return cmp&&Ext.Array.some(this.whitelist,function(x){return cmp.isXType(x)})},navigateIn:function(e){var defaultRoot,firstChild,me=this,focusedCmp=me.focusedCmp;return!!me.isWhitelisted(focusedCmp)||void(focusedCmp?(firstChild=focusedCmp.hasFocus?Ext.ComponentQuery.query(">:focusable",focusedCmp)[0]:focusedCmp,firstChild?firstChild.focus():Ext.isFunction(focusedCmp.onClick)&&(e.button=0,focusedCmp.onClick(e),focusedCmp.isVisible(!0)?focusedCmp.focus():me.navigateOut())):(defaultRoot=me.getRootComponents()[0],defaultRoot&&(defaultRoot.getFocusEl()===me.focusEl&&me.focusEl.blur(),defaultRoot.focus())))},navigateOut:function(e){var parent,me=this;return me.focusedCmp&&(parent=me.focusedCmp.up(":focusable"))?parent.focus():me.focusEl.focus(),!0},navigateSiblings:function(e,source,parent){var idx,next,focusedCmp,siblings,me=this,src=source||me,key=e.getKey(),EO=Ext.EventObject,goBack=e.shiftKey||key==EO.LEFT||key==EO.UP,checkWhitelist=key==EO.LEFT||key==EO.RIGHT||key==EO.UP||key==EO.DOWN,nextSelector=goBack?"prev":"next";return focusedCmp=src.focusedCmp&&src.focusedCmp.comp||src.focusedCmp,!focusedCmp&&!parent||(!(!checkWhitelist||!me.isWhitelisted(focusedCmp))||(!focusedCmp||focusedCmp.is(":root")?siblings=me.getRootComponents():(parent=parent||focusedCmp.up(),parent&&(siblings=parent.getRefItems())),siblings&&(idx=focusedCmp?Ext.Array.indexOf(siblings,focusedCmp):-1,next=Ext.ComponentQuery.query(":"+nextSelector+"Focus("+idx+")",siblings)[0],next&&focusedCmp!==next)?(next.focus(),next):void 0))},onComponentBlur:function(cmp,e){var me=this;me.focusedCmp===cmp&&(me.previousFocusedCmp=cmp,delete me.focusedCmp),me.focusFrame&&me.focusFrame.hide()},onComponentFocus:function(cmp,e){var parent,me=this,chain=me.focusChain;if(!cmp.isFocusable()){if(me.clearComponent(cmp),chain[cmp.id])return;return parent=cmp.up(),void(parent&&(chain[cmp.id]=!0,parent.focus()))}me.focusChain={},me.focusTask.delay(10,null,null,[cmp,cmp.getFocusEl()])},handleComponentFocus:function(cmp,focusEl){var cls,ff,box,bt,bl,bw,bh,ft,fb,fl,fr,me=this;return me.fireEvent("beforecomponentfocus",me,cmp,me.previousFocusedCmp)===!1?void me.clearComponent(cmp):(me.focusedCmp=cmp,me.shouldShowFocusFrame(cmp)&&(cls="."+me.focusFrameCls+"-",ff=me.focusFrame,box=(focusEl.dom?focusEl:focusEl.el).getBox(),bt=box.top,bl=box.left,bw=box.width,bh=box.height,ft=ff.child(cls+"top"),fb=ff.child(cls+"bottom"),fl=ff.child(cls+"left"),fr=ff.child(cls+"right"),ft.setWidth(bw).setLocalXY(bl,bt),fb.setWidth(bw).setLocalXY(bl,bt+bh-2),fl.setHeight(bh-2).setLocalXY(bl,bt+2),fr.setHeight(bh-2).setLocalXY(bl+bw-2,bt+2),ff.show()),void me.fireEvent("componentfocus",me,cmp,me.previousFocusedCmp))},onComponentHide:function(cmp){var parent,me=this,cmpHadFocus=!1,focusedCmp=me.focusedCmp;focusedCmp&&(cmpHadFocus=cmp.hasFocus||cmp.isContainer&&cmp.isAncestor(me.focusedCmp)),me.clearComponent(cmp),cmpHadFocus&&(parent=cmp.up(":focusable"))?parent.focus():me.focusEl.focus()},onComponentDestroy:function(){},removeDOM:function(){var me=this;me.enabled||me.subscribers.length||(Ext.destroy(me.focusFrame),delete me.focusEl,delete me.focusFrame)},removeXTypeFromWhitelist:function(xtype){var me=this;return Ext.isArray(xtype)?void Ext.Array.forEach(xtype,me.removeXTypeFromWhitelist,me):void Ext.Array.remove(me.whitelist,xtype)},setupSubscriberKeys:function(container,keys){var me=this,el=container.getFocusEl(),scope=keys.scope,handlers={backspace:me.focusLast,enter:me.navigateIn,esc:me.navigateOut,scope:me},navSiblings=function(e){return me.focusedCmp===container?me.navigateSiblings(e,me,container):me.navigateSiblings(e)};return Ext.iterate(keys,function(key,cb){handlers[key]=function(e){var ret=navSiblings(e);return!(!Ext.isFunction(cb)||cb.call(scope||container,e,ret)!==!0)||ret}},me),new Ext.util.KeyNav(el,handlers)},shouldShowFocusFrame:function(cmp){var me=this,opts=me.options||{};return!(!me.focusFrame||!cmp)&&(!!opts.focusFrame||!!me.focusData[cmp.id].focusFrame)}}),Ext.define("Ext.Img",{extend:Ext.Component,alias:["widget.image","widget.imagecomponent"],autoEl:"img",baseCls:Ext.baseCSSPrefix+"img",src:"",alt:"",title:"",imgCls:"",ariaRole:"img",initComponent:function(){this.glyph&&(this.autoEl="div"),this.callParent()},getElConfig:function(){var img,glyphParts,me=this,autoEl=me.autoEl,config=me.callParent(),glyphFontFamily=Ext._glyphFontFamily,glyph=me.glyph;return"img"===autoEl||Ext.isObject(autoEl)&&"img"===autoEl.tag?img=config:me.glyph?("string"==typeof glyph&&(glyphParts=glyph.split("@"),glyph=glyphParts[0],glyphFontFamily=glyphParts[1]),config.html="&#"+glyph+";",glyphFontFamily&&(config.style="font-family:"+glyphFontFamily)):config.cn=[img={tag:"img",role:me.ariaRole,id:me.id+"-img"}],img&&(me.imgCls&&(img.cls=(img.cls?img.cls+" ":"")+me.imgCls),img.src=me.src||Ext.BLANK_IMAGE_URL),me.alt&&((img||config).alt=me.alt),me.title&&((img||config).title=me.title),config},onRender:function(){var el,me=this,autoEl=me.autoEl;me.callParent(arguments),el=me.el,"img"===autoEl||Ext.isObject(autoEl)&&"img"===autoEl.tag?me.imgEl=el:me.imgEl=el.getById(me.id+"-img")},onDestroy:function(){Ext.destroy(this.imgEl),this.imgEl=null,this.callParent()},setSrc:function(src){var me=this,imgEl=me.imgEl;me.src=src,imgEl&&(imgEl.dom.src=src||Ext.BLANK_IMAGE_URL)},setGlyph:function(glyph){var glyphParts,dom,me=this,glyphFontFamily=Ext._glyphFontFamily;glyph!=me.glyph&&("string"==typeof glyph&&(glyphParts=glyph.split("@"),glyph=glyphParts[0],glyphFontFamily=glyphParts[1]),dom=me.el.dom,dom.innerHTML="&#"+glyph+";",glyphFontFamily&&(dom.style="font-family:"+glyphFontFamily))}}),Ext.define("Ext.util.Bindable",{bindStore:function(store,initial,propertyName){propertyName=propertyName||"store";var me=this,oldStore=me[propertyName];return!initial&&oldStore&&(me.onUnbindStore(oldStore,initial,propertyName),store!==oldStore&&oldStore.autoDestroy?oldStore.destroyStore():me.unbindStoreListeners(oldStore)),store&&(store=Ext.data.StoreManager.lookup(store),me.bindStoreListeners(store),me.onBindStore(store,initial,propertyName)),me[propertyName]=store||null,me},getStore:function(){return this.store},unbindStoreListeners:function(store){var listeners=this.storeListeners;listeners&&store.un(listeners)},bindStoreListeners:function(store){var me=this,listeners=Ext.apply({},me.getStoreListeners(store));listeners.scope||(listeners.scope=me),me.storeListeners=listeners,store.on(listeners)},getStoreListeners:Ext.emptyFn,onUnbindStore:Ext.emptyFn,onBindStore:Ext.emptyFn}),Ext.define("Ext.LoadMask",{extend:Ext.Component,alias:"widget.loadmask",mixins:{floating:Ext.util.Floating,bindable:Ext.util.Bindable},msg:"Loading...",msgCls:Ext.baseCSSPrefix+"mask-loading",maskCls:Ext.baseCSSPrefix+"mask",useMsg:!0,useTargetEl:!1,baseCls:Ext.baseCSSPrefix+"mask-msg",ariaRole:"presentation",childEls:["msgEl","msgTextEl"],renderTpl:['<div id="{id}-msgEl" role="{role}"','<tpl if="ariaAttr"> {ariaAttr}</tpl>',' class="{[values.$comp.msgCls]} ',Ext.baseCSSPrefix,'mask-msg-inner{childElCls}">','<div id="{id}-msgTextEl" class="',Ext.baseCSSPrefix,"mask-msg-text",'{childElCls}"></div>',"</div>"],floating:{shadow:"frame"},focusOnToFront:!1,bringParentToFront:!1,constructor:function(config){var comp,me=this;2===arguments.length?(comp=config,config=arguments[1]):comp=config.target,comp.isComponent||(comp=Ext.get(comp),this.isElement=!0),me.ownerCt=comp,this.isElement||me.bindComponent(comp),me.callParent([config]),me.store&&me.bindStore(me.store,!0)},bindComponent:function(comp){var me=this,listeners={scope:this,resize:me.sizeMask,added:me.onComponentAdded,removed:me.onComponentRemoved};comp.floating?(listeners.move=me.sizeMask,me.activeOwner=comp):comp.ownerCt?me.onComponentAdded(comp.ownerCt):me.preventBringToFront=!0,me.mon(comp,listeners),me.mon(me.hierarchyEventSource,{show:me.onContainerShow,hide:me.onContainerHide,expand:me.onContainerExpand,collapse:me.onContainerCollapse,scope:me})},onComponentAdded:function(owner){var me=this;delete me.activeOwner,me.floatParent=owner,owner.floating||(owner=owner.up("[floating]")),owner?(me.activeOwner=owner,me.mon(owner,"move",me.sizeMask,me)):me.preventBringToFront=!0,owner=me.floatParent.ownerCt,me.rendered&&me.isVisible()&&owner&&(me.floatOwner=owner,me.mon(owner,"afterlayout",me.sizeMask,me,{single:!0}))},onComponentRemoved:function(owner){var me=this,activeOwner=me.activeOwner,floatOwner=me.floatOwner;activeOwner&&me.mun(activeOwner,"move",me.sizeMask,me),floatOwner&&me.mun(floatOwner,"afterlayout",me.sizeMask,me),delete me.activeOwner,delete me.floatOwner},afterRender:function(){this.callParent(arguments),this.container=this.floatParent.getContentTarget()},onContainerShow:function(container){this.isActiveContainer(container)&&this.onComponentShow()},onContainerHide:function(container){this.isActiveContainer(container)&&this.onComponentHide()},onContainerExpand:function(container){this.isActiveContainer(container)&&this.onComponentShow()},onContainerCollapse:function(container){this.isActiveContainer(container)&&this.onComponentHide()},isActiveContainer:function(container){return this.isDescendantOf(container)},onComponentHide:function(){var me=this;me.rendered&&me.isVisible()&&(me.hide(),me.showNext=!0)},onComponentShow:function(){this.showNext&&this.show(),delete this.showNext},sizeMask:function(){var target,me=this;me.rendered&&me.isVisible()&&(me.center(),target=me.getMaskTarget(),me.getMaskEl().show().setSize(target.getSize()).alignTo(target,"tl-tl"))},bindStore:function(store,initial){var me=this;me.mixins.bindable.bindStore.apply(me,arguments),store=me.store,store&&store.isLoading()&&me.onBeforeLoad()},getStoreListeners:function(store){var load=this.onLoad,beforeLoad=this.onBeforeLoad,result={cachemiss:beforeLoad,cachefilled:load};return store.proxy.isSynchronous||(result.beforeLoad=beforeLoad,result.load=load),result},onDisable:function(){this.callParent(arguments),this.loading&&this.onLoad()},getOwner:function(){return this.ownerCt||this.floatParent},getMaskTarget:function(){var owner=this.getOwner();return this.useTargetEl?owner.getTargetEl():owner.getEl()},onBeforeLoad:function(){var origin,me=this,owner=me.getOwner();me.disabled||(me.loading=!0,owner.componentLayoutCounter?me.maybeShow():(origin=owner.afterComponentLayout,owner.afterComponentLayout=function(){owner.afterComponentLayout=origin,origin.apply(owner,arguments),me.maybeShow()}))},maybeShow:function(){var me=this,owner=me.getOwner();owner.isVisible(!0)?me.loading&&owner.rendered&&me.show():me.showNext=!0},getMaskEl:function(){var me=this;return me.maskEl||(me.maskEl=me.el.insertSibling({role:"presentation",cls:me.maskCls,style:{zIndex:me.el.getStyle("zIndex")-2}},"before"))},onShow:function(){var me=this,msgEl=me.msgEl;me.callParent(arguments),me.loading=!0,me.useMsg?(msgEl.show(),me.msgTextEl.update(me.msg)):msgEl.parent().hide()},hide:function(){return this.isElement?(this.ownerCt.unmask(),void this.fireEvent("hide",this)):(delete this.showNext,this.callParent(arguments))},onHide:function(){this.callParent(),this.getMaskEl().hide()},show:function(){return this.isElement?(this.ownerCt.mask(this.useMsg?this.msg:"",this.msgCls),void this.fireEvent("show",this)):this.callParent(arguments)},afterShow:function(){this.callParent(arguments),this.sizeMask()},setZIndex:function(index){var me=this,owner=me.activeOwner;return owner&&(index=parseInt(owner.el.getStyle("zIndex"),10)+1),me.getMaskEl().setStyle("zIndex",index-1),me.mixins.floating.setZIndex.apply(me,arguments)},onLoad:function(){this.loading=!1,this.hide()},onDestroy:function(){var me=this;me.isElement&&me.ownerCt.unmask(),Ext.destroy(me.maskEl),me.callParent()}}),Ext.define("Ext.data.association.Association",{alternateClassName:"Ext.data.Association",primaryKey:"id",associationKeyFunction:null,defaultReaderType:"json",isAssociation:!0,initialConfig:null,statics:{AUTO_ID:1e3,create:function(association){switch(Ext.isString(association)&&(association={type:association}),association.type){case"belongsTo":return new Ext.data.association.BelongsTo(association);case"hasMany":return new Ext.data.association.HasMany(association);case"hasOne":return new Ext.data.association.HasOne(association)}return association}},constructor:function(config){Ext.apply(this,config);var keyReIdx,me=this,types=Ext.ModelManager.types,ownerName=config.ownerModel,associatedName=config.associatedModel,ownerModel=types[ownerName],associatedModel=types[associatedName],associationKey=config.associationKey;associationKey&&(keyReIdx=String(associationKey).search(/[\[\.]/),keyReIdx>=0&&(me.associationKeyFunction=Ext.functionFactory("obj","return obj"+(keyReIdx>0?".":"")+associationKey))),me.initialConfig=config,me.ownerModel=ownerModel,me.associatedModel=associatedModel,Ext.applyIf(me,{ownerName:ownerName,associatedName:associatedName}),me.associationId="association"+ ++me.statics().AUTO_ID},getReader:function(){var me=this,reader=me.reader,model=me.associatedModel;return reader&&(Ext.isString(reader)&&(reader={type:reader}),reader.isReader?reader.setModel(model):Ext.applyIf(reader,{model:model,type:me.defaultReaderType}),me.reader=Ext.createByAlias("reader."+reader.type,reader)),me.reader||null}}),Ext.define("Ext.ModelManager",{extend:Ext.AbstractManager,alternateClassName:"Ext.ModelMgr",singleton:!0,typeName:"mtype",associationStack:[],registerType:function(name,config){var model,proto=config.prototype;return proto&&proto.isModel?model=config:(config.extend||(config.extend="Ext.data.Model"),model=Ext.define(name,config)),this.types[name]=model,model},unregisterType:function(name){delete this.types[name]},onModelDefined:function(model){var association,i,created,stack=this.associationStack,length=stack.length,create=[];for(i=0;i<length;i++)association=stack[i],association.associatedModel==model.modelName&&create.push(association);for(i=0,length=create.length;i<length;i++)created=create[i],this.types[created.ownerModel].prototype.associations.add(Ext.data.association.Association.create(created)),Ext.Array.remove(stack,created)},registerDeferredAssociation:function(association){this.associationStack.push(association)},getModel:function(id){var model=id;return"string"==typeof model&&(model=this.types[model]),model},create:function(config,name,id){var Con="function"==typeof name?name:this.types[name||config.name];return new Con(config,id)}},function(){Ext.regModel=function(){return this.ModelManager.registerType.apply(this.ModelManager,arguments)}}),Ext.define("Ext.layout.component.ProgressBar",{alias:["layout.progressbar"],extend:Ext.layout.component.Auto,type:"progressbar",beginLayout:function(ownerContext){var i,textEls,me=this;if(me.callParent(arguments),!ownerContext.textEls)if(textEls=me.owner.textEl,textEls.isComposite)for(ownerContext.textEls=[],textEls=textEls.elements,i=textEls.length;i--;)ownerContext.textEls[i]=ownerContext.getEl(Ext.get(textEls[i]));else ownerContext.textEls=[ownerContext.getEl("textEl")]},calculate:function(ownerContext){var i,textEls,width,me=this;if(me.callParent(arguments),Ext.isNumber(width=ownerContext.getProp("width")))for(width-=ownerContext.getBorderInfo().width,textEls=ownerContext.textEls,i=textEls.length;i--;)textEls[i].setWidth(width);else me.done=!1}}),Ext.define("Ext.ProgressBar",{extend:Ext.Component,alias:"widget.progressbar",baseCls:Ext.baseCSSPrefix+"progress",animate:!1,text:"",waitTimer:null,childEls:["bar"],renderTpl:['<tpl if="internalText">','<div class="{baseCls}-text {baseCls}-text-back">{text}</div>',"</tpl>",'<div id="{id}-bar" class="{baseCls}-bar {baseCls}-bar-{ui}" role="presentation" style="width:{percentage}%">','<tpl if="internalText">','<div class="{baseCls}-text">',"<div>{text}</div>","</div>","</tpl>","</div>"],componentLayout:"progressbar",ariaRole:"progressbar",initComponent:function(){this.callParent(),this.addEvents("update")},initRenderData:function(){var me=this;return Ext.apply(me.callParent(),{internalText:!me.hasOwnProperty("textEl"),text:me.text||"&#160;",percentage:me.value?100*me.value:0})},onRender:function(){var me=this;me.callParent(arguments),me.textEl?(me.textEl=Ext.get(me.textEl),me.updateText(me.text)):me.textEl=me.el.select("."+me.baseCls+"-text")},updateProgress:function(value,text,animate){var me=this,oldValue=me.value;return me.value=value||0,text&&me.updateText(text),me.rendered&&!me.isDestroyed&&(animate===!0||animate!==!1&&me.animate?(me.bar.stopAnimation(),me.bar.animate(Ext.apply({from:{width:100*oldValue+"%"},to:{width:100*me.value+"%"}},me.animate))):me.bar.setStyle("width",100*me.value+"%")),me.fireEvent("update",me,me.value,text),me},updateText:function(text){var me=this;return me.text=text,me.rendered&&me.textEl.update(me.text),me},applyText:function(text){this.updateText(text)},getText:function(){return this.text},wait:function(o){var scope,me=this;return me.waitTimer||(scope=me,o=o||{},me.updateText(o.text),me.waitTimer=Ext.TaskManager.start({run:function(i){var inc=o.increment||10;i-=1,me.updateProgress(((i+inc)%inc+1)*(100/inc)*.01,null,o.animate)},interval:o.interval||1e3,duration:o.duration,onStop:function(){o.fn&&o.fn.apply(o.scope||me),me.reset()},scope:scope})),me},isWaiting:function(){return null!==this.waitTimer},reset:function(hide){var me=this;return me.updateProgress(0),me.clearTimer(),hide===!0&&me.hide(),me},clearTimer:function(){var me=this;me.waitTimer&&(me.waitTimer.onStop=null,Ext.TaskManager.stop(me.waitTimer),me.waitTimer=null)},onDestroy:function(){var me=this,bar=me.bar;me.clearTimer(),me.rendered&&(me.textEl.isComposite&&me.textEl.clear(),Ext.destroyMembers(me,"textEl","progressBar"),bar&&me.animate&&bar.stopAnimation()),me.callParent()}}),Ext.define("Ext.ShadowPool",{singleton:!0,markup:function(){return Ext.String.format('<div class="{0}{1}-shadow" role="presentation"></div>',Ext.baseCSSPrefix,Ext.isIE&&!Ext.supports.CSS3BoxShadow?"ie":"css")}(),shadows:[],pull:function(){var sh=this.shadows.shift();return sh||(sh=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,this.markup)),sh.autoBoxAdjust=!1),sh},push:function(sh){this.shadows.push(sh)},reset:function(){var s,shadows=[].concat(this.shadows),sLen=shadows.length;for(s=0;s<sLen;s++)shadows[s].remove();this.shadows=[]}}),Ext.define("Ext.Shadow",{localXYNames:{get:"getLocalXY",set:"setLocalXY"},constructor:function(config){var adjusts,offset,rad,me=this;switch(Ext.apply(me,config),Ext.isString(me.mode)||(me.mode=me.defaultMode),offset=me.offset,rad=Math.floor(offset/2),me.opacity=50,me.mode.toLowerCase()){case"drop":adjusts=Ext.supports.CSS3BoxShadow?{t:offset,l:offset,h:-offset,w:-offset}:{t:-rad,l:-rad,h:-rad,w:-rad};break;case"sides":adjusts=Ext.supports.CSS3BoxShadow?{t:offset,l:0,h:-offset,w:0}:{t:-(1+rad),l:1+rad-2*offset,h:-1,w:rad-1};break;case"frame":adjusts=Ext.supports.CSS3BoxShadow?{t:0,l:0,h:0,w:0}:{t:1+rad-2*offset,l:1+rad-2*offset,h:offset-rad-1,w:offset-rad-1};break;case"bottom":adjusts=Ext.supports.CSS3BoxShadow?{t:offset,l:0,h:-offset,w:0}:{t:offset,l:0,h:0,w:0}}me.adjusts=adjusts},getShadowSize:function(){var me=this,offset=me.el?me.offset:0,result=[offset,offset,offset,offset],mode=me.mode.toLowerCase();return me.el&&"frame"!==mode&&(result[0]=0,"drop"==mode&&(result[3]=0)),result},offset:4,defaultMode:"drop",boxShadowProperty:function(){var property="boxShadow",style=document.documentElement.style;return"boxShadow"in style||("WebkitBoxShadow"in style?property="WebkitBoxShadow":"MozBoxShadow"in style&&(property="MozBoxShadow")),property}(),show:function(target){var index,xy,me=this;target=Ext.get(target),index=parseInt(target.getStyle("z-index"),10)-1||0,xy=target[me.localXYNames.get](),me.el||(me.el=Ext.ShadowPool.pull(),me.fixed?me.el.dom.style.position="fixed":me.el.dom.style.position="",me.el.dom.nextSibling!=target.dom&&me.el.insertBefore(target)),me.el.setStyle("z-index",me.zIndex||index),Ext.isIE&&!Ext.supports.CSS3BoxShadow&&(me.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity="+me.opacity+") progid:DXImageTransform.Microsoft.Blur(pixelradius="+me.offset+")"),me.realign(xy[0],xy[1],target.dom.offsetWidth,target.dom.offsetHeight),me.el.dom.style.display="block"},isVisible:function(){return!!this.el},realign:function(l,t,targetWidth,targetHeight){if(this.el){var shadowWidth,shadowHeight,sws,shs,adjusts=this.adjusts,el=this.el,targetStyle=el.dom.style;el[this.localXYNames.set](l+adjusts.l,t+adjusts.t),shadowWidth=Math.max(targetWidth+adjusts.w,0),shadowHeight=Math.max(targetHeight+adjusts.h,0),sws=shadowWidth+"px",shs=shadowHeight+"px",targetStyle.width==sws&&targetStyle.height==shs||(targetStyle.width=sws,targetStyle.height=shs,Ext.supports.CSS3BoxShadow&&(targetStyle[this.boxShadowProperty]="0 0 "+(this.offset+2)+"px #888"))}},hide:function(){var me=this;me.el&&(me.el.dom.style.display="none",Ext.ShadowPool.push(me.el),delete me.el)},setZIndex:function(z){this.zIndex=z,this.el&&this.el.setStyle("z-index",z)},setOpacity:function(opacity){this.el&&(Ext.isIE&&!Ext.supports.CSS3BoxShadow&&(opacity=Math.floor(100*opacity/2)/100),this.opacity=opacity,this.el.setOpacity(opacity))}}),Ext.define("Ext.app.EventDomain",{statics:{instances:{}},isEventDomain:!0,constructor:function(){var me=this;Ext.app.EventDomain.instances[me.type]=me,me.bus={},me.monitoredClasses=[]},dispatch:function(target,ev,args){var selector,controllers,id,events,event,i,ln,me=this,bus=me.bus,selectors=bus[ev];if(!selectors)return!0;for(selector in selectors)if(selectors.hasOwnProperty(selector)&&me.match(target,selector)){controllers=selectors[selector];for(id in controllers)if(controllers.hasOwnProperty(id))for(events=controllers[id],i=0,ln=events.length;i<ln;i++)if(event=events[i],event.fire.apply(event,args)===!1)return!1}return!0},listen:function(selectors,controller){var i,tree,list,selector,options,listener,scope,event,listeners,ev,me=this,bus=me.bus,idProperty=me.idProperty,monitoredClasses=me.monitoredClasses,monitoredClassesCount=monitoredClasses.length;for(selector in selectors)if(selectors.hasOwnProperty(selector)&&(listeners=selectors[selector])){idProperty&&(selector="*"===selector?selector:selector.substring(1));for(ev in listeners)if(listeners.hasOwnProperty(ev)){for(options=null,listener=listeners[ev],scope=controller,event=new Ext.util.Event(controller,ev),Ext.isObject(listener)&&(options=listener,listener=options.fn,scope=options.scope||controller,delete options.fn,delete options.scope),"string"==typeof listener&&(listener=scope[listener]),event.addListener(listener,scope,options),i=monitoredClassesCount;i-- >0;)monitoredClasses[i].hasListeners._incr_(ev);tree=bus[ev]||(bus[ev]={}),tree=tree[selector]||(tree[selector]={}),list=tree[controller.id]||(tree[controller.id]=[]),list.push(event)}}},match:function(target,selector){var idProperty=this.idProperty;return!!idProperty&&("*"===selector||target[idProperty]===selector)},monitor:function(observable){var domain=this,prototype=observable.isInstance?observable:observable.prototype,fireEventArgs=prototype.fireEventArgs;domain.monitoredClasses.push(observable),prototype.fireEventArgs=function(ev,args){var ret=fireEventArgs.apply(this,arguments);return ret!==!1&&(ret=domain.dispatch(this,ev,args)),ret}},unlisten:function(controllerId){var controllers,ev,selector,selectors,bus=this.bus;for(ev in bus)if(bus.hasOwnProperty(ev)&&(selectors=bus[ev]))for(selector in selectors)controllers=selectors[selector],delete controllers[controllerId]}}),Ext.define("Ext.app.domain.Component",{extend:Ext.app.EventDomain,singleton:!0,type:"component",constructor:function(){var me=this;me.callParent(),me.monitor(Ext.Component)},match:function(target,selector){return target.is(selector)}}),Ext.define("Ext.app.EventBus",{singleton:!0,constructor:function(){var me=this,domains=Ext.app.EventDomain.instances;me.callParent(),me.domains=domains,me.bus=domains.component.bus},control:function(selectors,controller){return this.domains.component.listen(selectors,controller)},listen:function(to,controller){var domain,domains=this.domains;for(domain in to)to.hasOwnProperty(domain)&&domains[domain].listen(to[domain],controller)},unlisten:function(controllerId){var domain,domains=Ext.app.EventDomain.instances;for(domain in domains)domains[domain].unlisten(controllerId)}}),Ext.define("Ext.data.StoreManager",{extend:Ext.util.MixedCollection,alternateClassName:["Ext.StoreMgr","Ext.data.StoreMgr","Ext.StoreManager"],singleton:!0,register:function(){for(var s,i=0;s=arguments[i];i++)this.add(s)},unregister:function(){for(var s,i=0;s=arguments[i];i++)this.remove(this.lookup(s))},lookup:function(store){if(Ext.isArray(store)){var i,len,fields=["field1"],expand=!Ext.isArray(store[0]),data=store;if(expand)for(data=[],i=0,len=store.length;i<len;++i)data.push([store[i]]);else for(i=2,len=store[0].length;i<=len;++i)fields.push("field"+i);return new Ext.data.ArrayStore({data:data,fields:fields,autoDestroy:!0,autoCreated:!0,expanded:expand})}return Ext.isString(store)?this.get(store):Ext.data.AbstractStore.create(store)},getKey:function(o){return o.storeId}},function(){Ext.regStore=function(name,config){var store;return Ext.isObject(name)?config=name:config.storeId=name,store=config instanceof Ext.data.Store?config:new Ext.data.Store(config),Ext.data.StoreManager.register(store)},Ext.getStore=function(name){return Ext.data.StoreManager.lookup(name)}}),Ext.define("Ext.app.domain.Global",{extend:Ext.app.EventDomain,singleton:!0,type:"global",constructor:function(){var me=this;me.callParent(),me.monitor(Ext.globalEvents)},listen:function(listeners,controller){this.callParent([{global:listeners},controller])},match:function(){return!0}}),Ext.define("Ext.data.ResultSet",{loaded:!0,count:0,total:0,success:!1,constructor:function(config){Ext.apply(this,config),this.totalRecords=this.total,void 0===config.count&&(this.count=this.records.length)}}),Ext.define("Ext.data.reader.Reader",{alternateClassName:["Ext.data.Reader","Ext.data.DataReader"],mixins:{observable:Ext.util.Observable},totalProperty:"total",successProperty:"success",root:"",implicitIncludes:!0,readRecordsOnFailure:!0,isReader:!0,applyDefaults:!0,lastFieldGeneration:null,constructor:function(config){var me=this;me.mixins.observable.constructor.call(me,config),me.model=Ext.ModelManager.getModel(me.model),me.model&&me.model.prototype.fields&&me.buildExtractors(),this.addEvents("exception")},setModel:function(model,setOnProxy){var me=this,oldModel=me.model,force=!0;model=me.model=Ext.ModelManager.getModel(model),model&&oldModel===model&&(force=me.lastFieldGeneration!==model.prototype.fields.generation),model&&me.buildExtractors(force),setOnProxy&&me.proxy&&me.proxy.setModel(model,!0)},read:function(response){var data;return response&&(data=response.responseText?this.getResponseData(response):this.readRecords(response)),data||this.nullResultSet},readRecords:function(data){var success,recordCount,records,root,total,value,message,me=this;return me.lastFieldGeneration!==me.model.prototype.fields.generation&&me.buildExtractors(!0),me.rawData=data,data=me.getData(data),success=!0,recordCount=0,records=[],me.successProperty&&(value=me.getSuccess(data),value!==!1&&"false"!==value||(success=!1)),me.messageProperty&&(message=me.getMessage(data)),(me.readRecordsOnFailure||success)&&(root=Ext.isArray(data)?data:me.getRoot(data),root&&(total=root.length),me.totalProperty&&(value=parseInt(me.getTotal(data),10),isNaN(value)||(total=value)),root&&(records=me.extractData(root),recordCount=records.length)),new Ext.data.ResultSet({total:total||recordCount,count:recordCount,records:records,success:success,message:message})},extractData:function(root){var convertedValues,node,record,i,me=this,Model=me.model,length=root.length,records=new Array(length);for(!root.length&&Ext.isObject(root)&&(root=[root],length=1),i=0;i<length;i++)node=root[i],node.isModel?records[i]=node:(records[i]=record=new Model((void 0),me.getId(node),node,convertedValues={}),record.phantom=!1,me.convertRecordData(convertedValues,node,record),
me.implicitIncludes&&record.associations.length&&me.readAssociated(record,node));return records},readAssociated:function(record,data){for(var association,associationData,proxy,reader,associations=record.associations.items,i=0,length=associations.length;i<length;i++)association=associations[i],associationData=this.getAssociatedDataRoot(data,association.associationKeyFunction||association.associationKey||association.name),associationData&&(reader=association.getReader(),reader||(proxy=association.associatedModel.getProxy(),reader=proxy?proxy.getReader():new this.constructor({model:association.associatedName})),association.read(record,reader,associationData))},getAssociatedDataRoot:function(data,associationName){return Ext.isFunction(associationName)?associationName(data):data[associationName]},getFields:function(){return this.model.prototype.fields.items},getData:Ext.identityFn,getRoot:Ext.identityFn,getResponseData:function(response){},onMetaChange:function(meta){var newModel,clientIdProperty,me=this,fields=meta.fields||me.getFields();me.metaData=meta,me.root=meta.root||me.root,me.idProperty=meta.idProperty||me.idProperty,me.totalProperty=meta.totalProperty||me.totalProperty,me.successProperty=meta.successProperty||me.successProperty,me.messageProperty=meta.messageProperty||me.messageProperty,clientIdProperty=meta.clientIdProperty,me.model?(me.model.setFields(fields,me.idProperty,clientIdProperty),me.setModel(me.model,!0)):(newModel=Ext.define("Ext.data.reader.Json-Model"+Ext.id(),{extend:"Ext.data.Model",fields:fields,clientIdProperty:clientIdProperty}),me.idProperty&&(newModel.idProperty=me.idProperty),me.setModel(newModel,!0))},getIdProperty:function(){var idField=this.model.prototype.idField,idProperty=this.idProperty;return!idProperty&&idField&&null==(idProperty=idField.mapping)&&(idProperty=idField.name),idProperty},buildExtractors:function(force){var accessor,me=this,idProp=me.getIdProperty(),totalProp=me.totalProperty,successProp=me.successProperty,messageProp=me.messageProperty;force===!0&&delete me.convertRecordData,me.convertRecordData||(totalProp&&(me.getTotal=me.createAccessor(totalProp)),successProp&&(me.getSuccess=me.createAccessor(successProp)),messageProp&&(me.getMessage=me.createAccessor(messageProp)),idProp?(accessor=me.createAccessor(idProp),me.getId=function(record){var id=accessor.call(me,record);return void 0===id||""===id?null:id}):me.getId=function(){return null},me.convertRecordData=me.buildRecordDataExtractor(),me.lastFieldGeneration=me.model.prototype.fields.generation)},recordDataExtractorTemplate:["var me = this\n","    ,fields = me.model.prototype.fields\n","    ,value\n","    ,internalId\n",'<tpl for="fields">','    ,__field{#} = fields.map["{name}"]\n',"</tpl>",";\n","return function(dest, source, record) {\n",'<tpl for="fields">','{% var fieldAccessExpression =  this.createFieldAccessExpression(values, "__field" + xindex, "source");',"   if (fieldAccessExpression) { %}",'    value = {[ this.createFieldAccessExpression(values, "__field" + xindex, "source") ]};\n','<tpl if="hasCustomConvert">','    dest["{name}"] = value === undefined ? __field{#}.convert(__field{#}.defaultValue, record) : __field{#}.convert(value, record);\n','<tpl elseif="defaultValue !== undefined">',"    if (value === undefined) {\n","        if (me.applyDefaults) {\n",'<tpl if="convert">','            dest["{name}"] = __field{#}.convert(__field{#}.defaultValue, record);\n',"<tpl else>",'            dest["{name}"] = __field{#}.defaultValue\n',"</tpl>","        };\n","    } else {\n",'<tpl if="convert">','        dest["{name}"] = __field{#}.convert(value, record);\n',"<tpl else>",'        dest["{name}"] = value;\n',"</tpl>","    };\n","<tpl else>","    if (value !== undefined) {\n",'<tpl if="convert">','        dest["{name}"] = __field{#}.convert(value, record);\n',"<tpl else>",'        dest["{name}"] = value;\n',"</tpl>","    }\n","</tpl>","{% } else { %}",'<tpl if="defaultValue !== undefined">','<tpl if="convert">','    dest["{name}"] = __field{#}.convert(__field{#}.defaultValue, record);\n',"<tpl else>",'    dest["{name}"] = __field{#}.defaultValue\n',"</tpl>","</tpl>","{% } %}","</tpl>",'<tpl if="clientIdProp">','    if (record && (internalId = {[ this.createFieldAccessExpression({mapping: values.clientIdProp}, null, "source") ]})) {\n','        record.{["internalId"]} = internalId;\n',"    }\n","</tpl>","};"],buildRecordDataExtractor:function(){var me=this,modelProto=me.model.prototype,templateData={clientIdProp:modelProto.clientIdProperty,fields:modelProto.fields.items};return me.recordDataExtractorTemplate.createFieldAccessExpression=function(){return me.createFieldAccessExpression.apply(me,arguments)},Ext.functionFactory(me.recordDataExtractorTemplate.apply(templateData)).call(me)},destroyReader:function(){var me=this;delete me.proxy,delete me.model,delete me.convertRecordData,delete me.getId,delete me.getTotal,delete me.getSuccess,delete me.getMessage}},function(){var proto=this.prototype;Ext.apply(proto,{nullResultSet:new Ext.data.ResultSet({total:0,count:0,records:[],success:!0,message:""}),recordDataExtractorTemplate:new Ext.XTemplate(proto.recordDataExtractorTemplate)})}),Ext.define("Ext.data.reader.Json",{extend:Ext.data.reader.Reader,alternateClassName:"Ext.data.JsonReader",alias:"reader.json",root:"",metaProperty:"metaData",useSimpleAccessors:!1,readRecords:function(data){var meta,me=this;return me.getMeta?(meta=me.getMeta(data),meta&&me.onMetaChange(meta)):data.metaData&&me.onMetaChange(data.metaData),me.jsonData=data,me.callParent([data])},getResponseData:function(response){var data,error;try{return data=Ext.decode(response.responseText),this.readRecords(data)}catch(ex){return error=new Ext.data.ResultSet({total:0,count:0,records:[],success:!1,message:ex.message}),this.fireEvent("exception",this,response,error),Ext.Logger.warn("Unable to parse the JSON returned by the server"),error}},buildExtractors:function(){var me=this,metaProp=me.metaProperty;me.callParent(arguments),me.root?me.getRoot=me.createAccessor(me.root):me.getRoot=Ext.identityFn,metaProp&&(me.getMeta=me.createAccessor(metaProp))},extractData:function(root){var length,i,recordName=this.record,data=[];if(recordName)for(length=root.length,!length&&Ext.isObject(root)&&(length=1,root=[root]),i=0;i<length;i++)data[i]=root[i][recordName];else data=root;return this.callParent([data])},createAccessor:function(){var re=/[\[\.]/;return function(expr){if(Ext.isEmpty(expr))return Ext.emptyFn;if(Ext.isFunction(expr))return expr;if(this.useSimpleAccessors!==!0){var i=String(expr).search(re);if(i>=0)return Ext.functionFactory("obj","return obj"+(i>0?".":"")+expr)}return function(obj){return obj[expr]}}}(),createFieldAccessExpression:function(){var re=/[\[\.]/;return function(field,fieldVarName,dataName){var result,operatorIndex,mapping=field.mapping,hasMap=mapping||0===mapping,map=hasMap?mapping:field.name;if(mapping!==!1){if("function"==typeof map)result=fieldVarName+".mapping("+dataName+", this)";else if(this.useSimpleAccessors===!0||(operatorIndex=String(map).search(re))<0)hasMap&&!isNaN(map)||(map='"'+map+'"'),result=dataName+"["+map+"]";else if(0===operatorIndex)result=dataName+map;else{for(var parts=map.split("."),len=parts.length,i=1,tempResult=dataName+"."+parts[0],buffer=[tempResult];i<len;i++)tempResult+="."+parts[i],buffer.push(tempResult);result=buffer.join(" && ")}return result}}}()}),Ext.define("Ext.data.writer.Writer",{alias:"writer.base",alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],writeAllFields:!0,nameProperty:"name",writeRecordId:!0,isWriter:!0,constructor:function(config){Ext.apply(this,config)},write:function(request){for(var operation=request.operation,records=operation.records||[],len=records.length,i=0,data=[];i<len;i++)data.push(this.getRecordData(records[i],operation));return this.writeRecords(request,data)},getRecordData:function(record,operation){var changes,field,key,mappedIdProperty,f,fLen,isPhantom=record.phantom===!0,writeAll=this.writeAllFields||isPhantom,fields=record.fields,fieldItems=fields.items,data={},clientIdProperty=record.clientIdProperty;if(writeAll)for(fLen=fieldItems.length,f=0;f<fLen;f++)field=fieldItems[f],field.persist&&this.writeValue(data,field,record);else if("destroy"===operation.action)this.writeValue(data,record.idField,record);else{changes=record.getChanges();for(key in changes)changes.hasOwnProperty(key)&&(field=fields.get(key),field.persist&&this.writeValue(data,field,record))}return isPhantom?clientIdProperty&&operation&&operation.records.length>1&&(data[clientIdProperty]=record.internalId):this.writeRecordId&&(mappedIdProperty=fields.get(record.idProperty)[this.nameProperty]||record.idProperty,data[mappedIdProperty]=record.getId()),data},writeValue:function(data,field,record){var name=field[this.nameProperty],dateFormat=this.dateFormat||field.dateWriteFormat||field.dateFormat,value=record.get(field.name);null==name&&(name=field.name),field.serialize?data[name]=field.serialize(value,record):field.type===Ext.data.Types.DATE&&dateFormat&&Ext.isDate(value)?data[name]=Ext.Date.format(value,dateFormat):data[name]=value}}),Ext.define("Ext.data.writer.Json",{extend:Ext.data.writer.Writer,alternateClassName:"Ext.data.JsonWriter",alias:"writer.json",root:void 0,encode:!1,allowSingle:!0,expandData:!1,getExpandedData:function(data){for(var item,prop,nameParts,j,tempObj,dataLength=data.length,i=0,toObject=function(name,value){var o={};return o[name]=value,o};i<dataLength;i++){item=data[i];for(prop in item)if(item.hasOwnProperty(prop)&&(nameParts=prop.split("."),j=nameParts.length-1,j>0)){for(tempObj=item[prop];j>0;j--)tempObj=toObject(nameParts[j],tempObj);item[nameParts[0]]=item[nameParts[0]]||{},Ext.Object.merge(item[nameParts[0]],tempObj),delete item[prop]}}return data},writeRecords:function(request,data){var root=this.root;return this.expandData&&(data=this.getExpandedData(data)),this.allowSingle&&1===data.length&&(data=data[0]),this.encode?root&&(request.params[root]=Ext.encode(data)):(request.jsonData=request.jsonData||{},root?request.jsonData[root]=data:request.jsonData=data),request}}),Ext.define("Ext.data.proxy.Proxy",{alias:"proxy.proxy",alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],mixins:{observable:Ext.util.Observable},batchOrder:"create,update,destroy",batchActions:!0,defaultReaderType:"json",defaultWriterType:"json",isProxy:!0,isSynchronous:!1,constructor:function(config){var me=this;config=config||{},me.proxyConfig=config,me.mixins.observable.constructor.call(me,config),void 0===me.model||me.model instanceof Ext.data.Model?(me.reader&&me.setReader(me.reader),me.writer&&me.setWriter(me.writer)):me.setModel(me.model)},setModel:function(model,setOnStore){var me=this;me.model=Ext.ModelManager.getModel(model),me.setReader(this.reader),me.setWriter(this.writer),setOnStore&&me.store&&me.store.setModel(me.model)},getModel:function(){return this.model},setReader:function(reader){var me=this,needsCopy=!0,current=me.reader;return void 0!==reader&&"string"!=typeof reader||(reader={type:reader},needsCopy=!1),reader.isReader?reader.setModel(me.model):(needsCopy&&(reader=Ext.apply({},reader)),Ext.applyIf(reader,{proxy:me,model:me.model,type:me.defaultReaderType}),reader=Ext.createByAlias("reader."+reader.type,reader)),reader!==current&&reader.onMetaChange&&(reader.onMetaChange=Ext.Function.createSequence(reader.onMetaChange,this.onMetaChange,this)),me.reader=reader,me.reader},getReader:function(){return this.reader},onMetaChange:function(meta){this.fireEvent("metachange",this,meta)},setWriter:function(writer){var me=this,needsCopy=!0;return void 0!==writer&&"string"!=typeof writer||(writer={type:writer},needsCopy=!1),writer.isWriter||(needsCopy&&(writer=Ext.apply({},writer)),Ext.applyIf(writer,{model:me.model,type:me.defaultWriterType}),writer=Ext.createByAlias("writer."+writer.type,writer)),me.writer=writer,me.writer},getWriter:function(){return this.writer},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,destroy:Ext.emptyFn,batch:function(options,listeners){var batch,records,actions,aLen,action,a,r,rLen,record,me=this,useBatch=me.batchActions;for(void 0===options.operations&&(options={operations:options,listeners:listeners}),options.batch?Ext.isDefined(options.batch.runOperation)&&(batch=Ext.applyIf(options.batch,{proxy:me,listeners:{}})):options.batch={proxy:me,listeners:options.listeners||{}},batch||(batch=new Ext.data.Batch(options.batch)),batch.on("complete",Ext.bind(me.onBatchComplete,me,[options],0)),actions=me.batchOrder.split(","),aLen=actions.length,a=0;a<aLen;a++)if(action=actions[a],records=options.operations[action])if(useBatch)batch.add(new Ext.data.Operation({action:action,records:records}));else for(rLen=records.length,r=0;r<rLen;r++)record=records[r],batch.add(new Ext.data.Operation({action:action,records:[record]}));return batch.start(),batch},onBatchComplete:function(batchOptions,batch){var scope=batchOptions.scope||this;batch.hasException?Ext.isFunction(batchOptions.failure)&&Ext.callback(batchOptions.failure,scope,[batch,batchOptions]):Ext.isFunction(batchOptions.success)&&Ext.callback(batchOptions.success,scope,[batch,batchOptions]),Ext.isFunction(batchOptions.callback)&&Ext.callback(batchOptions.callback,scope,[batch,batchOptions])},clone:function(){return new this.self(this.proxyConfig)}}),Ext.define("Ext.data.Operation",{synchronous:!0,action:void 0,filters:void 0,sorters:void 0,groupers:void 0,start:void 0,limit:void 0,batch:void 0,callback:void 0,scope:void 0,started:!1,running:!1,complete:!1,success:void 0,exception:!1,error:void 0,actionCommitRecordsRe:/^(?:create|update)$/i,actionSkipSyncRe:/^destroy$/i,constructor:function(config){Ext.apply(this,config||{})},commitRecords:function(serverRecords){var mc,index,clientRecords,serverRec,clientRec,i,len,modifiedFields,recordModifiedFields,me=this,commitRecords=me.actionCommitRecordsRe.test(me.action);if(!me.actionSkipSyncRe.test(me.action)&&(clientRecords=me.records,clientRecords&&clientRecords.length)){if(commitRecords&&(recordModifiedFields=[]),clientRecords.length>1)if("update"==me.action||clientRecords[0].clientIdProperty)for(mc=new Ext.util.MixedCollection,mc.addAll(serverRecords),index=clientRecords.length;index--;)clientRec=clientRecords[index],serverRec=mc.findBy(me.matchClientRec,clientRec),modifiedFields=clientRec.copyFrom(serverRec),commitRecords&&recordModifiedFields.push(modifiedFields);else for(i=0,len=clientRecords.length;i<len;++i)clientRec=clientRecords[i],serverRec=serverRecords[i],clientRec&&serverRec&&(modifiedFields=me.updateRecord(clientRec,serverRec),commitRecords&&recordModifiedFields.push(modifiedFields));else modifiedFields=me.updateRecord(clientRecords[0],serverRecords[0]),commitRecords&&(recordModifiedFields[0]=modifiedFields);if(commitRecords)for(index=clientRecords.length;index--;)clientRecords[index].commit(!1,recordModifiedFields[index])}},updateRecord:function(clientRec,serverRec){return serverRec&&(clientRec.phantom||clientRec.getId()===serverRec.getId())?clientRec.copyFrom(serverRec):[]},matchClientRec:function(record){var clientRec=this,clientRecordId=clientRec.getId();return!(!clientRecordId||record.getId()!==clientRecordId)||record.internalId===clientRec.internalId},setStarted:function(){this.started=!0,this.running=!0},setCompleted:function(){this.complete=!0,this.running=!1},setSuccessful:function(){this.success=!0},setException:function(error){this.exception=!0,this.success=!1,this.running=!1,this.error=error},hasException:function(){return this.exception===!0},getError:function(){return this.error},getRecords:function(){var resultSet=this.getResultSet();return this.records||(resultSet?resultSet.records:null)},getResultSet:function(){return this.resultSet},isStarted:function(){return this.started===!0},isRunning:function(){return this.running===!0},isComplete:function(){return this.complete===!0},wasSuccessful:function(){return this.isComplete()&&this.success===!0},setBatch:function(batch){this.batch=batch},allowWrite:function(){return"read"!=this.action}}),Ext.define("Ext.data.AbstractStore",{mixins:{observable:Ext.util.Observable,sortable:Ext.util.Sortable},statics:{create:function(store){return store.isStore||(store.type||(store.type="store"),store=Ext.createByAlias("store."+store.type,store)),store}},onClassExtended:function(cls,data,hooks){var onBeforeClassCreated,model=data.model;"string"==typeof model&&(onBeforeClassCreated=hooks.onBeforeCreated,hooks.onBeforeCreated=function(){var me=this,args=arguments;Ext.require(model,function(){onBeforeClassCreated.apply(me,args)})})},remoteSort:!1,remoteFilter:!1,autoLoad:void 0,autoSync:!1,batchUpdateMode:"operation",filterOnLoad:!0,sortOnLoad:!0,implicitModel:!1,defaultProxyType:"memory",isDestroyed:!1,isStore:!0,sortRoot:"data",constructor:function(config){var filters,me=this;Ext.apply(me,config),me.removed=[],me.mixins.observable.constructor.apply(me,arguments),me.model=Ext.ModelManager.getModel(me.model),Ext.applyIf(me,{modelDefaults:null}),!me.model&&me.fields&&(me.model=Ext.define("Ext.data.Store.ImplicitModel-"+(me.storeId||Ext.id()),{extend:"Ext.data.Model",fields:me.fields,proxy:me.proxy||me.defaultProxyType}),delete me.fields,me.implicitModel=!0),me.setProxy(me.proxy||me.model.getProxy()),me.id&&!me.storeId&&(me.storeId=me.id,delete me.id),me.storeId&&Ext.data.StoreManager.register(me),me.mixins.sortable.initSortable.call(me),filters=me.decodeFilters(me.filters),me.filters=new Ext.util.MixedCollection,me.filters.addAll(filters)},setProxy:function(proxy){var me=this,model=me.model;return proxy instanceof Ext.data.proxy.Proxy?proxy.setModel(model):(Ext.isString(proxy)?proxy={type:proxy,model:model}:proxy.model||(proxy=Ext.apply({model:model},proxy)),proxy=Ext.createByAlias("proxy."+proxy.type,proxy)),me.disableMetaChangeEvent||proxy.on("metachange",me.onMetaChange,me),me.proxy=proxy,me.proxy},getProxy:function(){return this.proxy},onMetaChange:function(proxy,meta){this.fireEvent("metachange",this,meta)},create:function(data,options){var operation,me=this,instance=Ext.ModelManager.create(Ext.applyIf(data,me.modelDefaults),me.model.modelName);return options=options||{},Ext.applyIf(options,{action:"create",records:[instance]}),operation=new Ext.data.Operation(options),me.proxy.create(operation,me.onProxyWrite,me),instance},read:function(){return this.load.apply(this,arguments)},update:function(options){var operation,me=this;return options=options||{},Ext.applyIf(options,{action:"update",records:me.getUpdatedRecords()}),operation=new Ext.data.Operation(options),me.proxy.update(operation,me.onProxyWrite,me)},onProxyWrite:function(operation){var me=this,success=operation.wasSuccessful(),records=operation.getRecords();switch(operation.action){case"create":me.onCreateRecords(records,operation,success);break;case"update":me.onUpdateRecords(records,operation,success);break;case"destroy":me.onDestroyRecords(records,operation,success)}success&&(me.fireEvent("write",me,operation),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)),Ext.callback(operation.callback,operation.scope||me,[records,operation,success])},onCreateRecords:Ext.emptyFn,onUpdateRecords:Ext.emptyFn,onDestroyRecords:function(records,operation,success){success&&(this.removed=[])},destroy:function(options){var operation,me=this;return options=options||{},Ext.applyIf(options,{action:"destroy",records:me.getRemovedRecords()}),operation=new Ext.data.Operation(options),me.proxy.destroy(operation,me.onProxyWrite,me)},onBatchOperationComplete:function(batch,operation){return this.onProxyWrite(operation)},onBatchComplete:function(batch,operation){var i,me=this,operations=batch.operations,length=operations.length;for(me.suspendEvents(),i=0;i<length;i++)me.onProxyWrite(operations[i]);me.resumeEvents(),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)},onBatchException:function(batch,operation){},filterNew:function(item){return item.phantom===!0&&item.isValid()},getNewRecords:function(){return[]},getUpdatedRecords:function(){return[]},getModifiedRecords:function(){return[].concat(this.getNewRecords(),this.getUpdatedRecords())},filterUpdated:function(item){return item.dirty===!0&&item.phantom!==!0&&item.isValid()},getRemovedRecords:function(){return this.removed},filter:function(filters,value){},decodeFilters:function(filters){Ext.isArray(filters)||(filters=void 0===filters?[]:[filters]);var config,i,length=filters.length,Filter=Ext.util.Filter;for(i=0;i<length;i++)config=filters[i],config instanceof Filter||(Ext.apply(config,{root:"data"}),config.fn&&(config.filterFn=config.fn),"function"==typeof config&&(config={filterFn:config}),filters[i]=new Filter(config));return filters},clearFilter:function(supressEvent){},isFiltered:function(){},filterBy:function(fn,scope){},sync:function(options){var me=this,operations={},toCreate=me.getNewRecords(),toUpdate=me.getUpdatedRecords(),toDestroy=me.getRemovedRecords(),needsSync=!1;return toCreate.length>0&&(operations.create=toCreate,needsSync=!0),toUpdate.length>0&&(operations.update=toUpdate,needsSync=!0),toDestroy.length>0&&(operations.destroy=toDestroy,needsSync=!0),needsSync&&me.fireEvent("beforesync",operations)!==!1&&(options=options||{},me.proxy.batch(Ext.apply(options,{operations:operations,listeners:me.getBatchListeners()}))),me},getBatchListeners:function(){var me=this,listeners={scope:me,exception:me.onBatchException};return"operation"==me.batchUpdateMode?listeners.operationcomplete=me.onBatchOperationComplete:listeners.complete=me.onBatchComplete,listeners},save:function(){return this.sync.apply(this,arguments)},load:function(options){var me=this,operation={action:"read"};return me.remoteFilter&&(operation.filters=me.filters.items),me.remoteSort&&(operation.sorters=me.getSorters()),Ext.apply(operation,options),me.lastOptions=operation,operation=new Ext.data.Operation(operation),me.fireEvent("beforeload",me,operation)!==!1&&(me.loading=!0,me.proxy.read(operation,me.onProxyLoad,me)),me},reload:function(options){var o=Ext.apply({},options,this.lastOptions);return this.load(o)},afterEdit:function(record,modifiedFieldNames){var i,shouldSync,me=this;if(me.autoSync&&!me.autoSyncSuspended){for(i=modifiedFieldNames.length;i--;)if(record.fields.get(modifiedFieldNames[i]).persist){shouldSync=!0;break}shouldSync&&me.sync()}me.onUpdate(record,Ext.data.Model.EDIT,modifiedFieldNames),me.fireEvent("update",me,record,Ext.data.Model.EDIT,modifiedFieldNames)},afterReject:function(record){this.onUpdate(record,Ext.data.Model.REJECT,null),this.fireEvent("update",this,record,Ext.data.Model.REJECT,null)},afterCommit:function(record,modifiedFieldNames){modifiedFieldNames||(modifiedFieldNames=null),this.onUpdate(record,Ext.data.Model.COMMIT,modifiedFieldNames),this.fireEvent("update",this,record,Ext.data.Model.COMMIT,modifiedFieldNames)},onUpdate:Ext.emptyFn,onIdChanged:function(model,oldId,newId,oldInternalId){this.fireEvent("idchanged",this,model,oldId,newId,oldInternalId)},destroyStore:function(){var implicitModelName,me=this;me.isDestroyed||(me.clearListeners(),me.storeId&&Ext.data.StoreManager.unregister(me),me.clearData(),me.data=me.tree=me.sorters=me.filters=me.groupers=null,me.reader&&me.reader.destroyReader(),me.proxy=me.reader=me.writer=null,me.isDestroyed=!0,me.implicitModel?(implicitModelName=Ext.getClassName(me.model),Ext.undefine(implicitModelName),Ext.ModelManager.unregisterType(implicitModelName)):me.model=null)},getState:function(){var hasState,result,me=this,hasGroupers=!!me.groupers,groupers=[],sorters=[],filters=[];if(hasGroupers&&me.groupers.each(function(g){groupers[groupers.length]=g.serialize(),hasState=!0}),me.sorters&&me.sorters.each(function(s){hasGroupers&&!me.groupers.contains(s)&&(sorters[sorters.length]=s.serialize(),hasState=!0)}),me.filters&&me.statefulFilters&&me.filters.each(function(f){filters[filters.length]=f.serialize(),hasState=!0}),hasState)return result={},groupers.length&&(result.groupers=groupers),sorters.length&&(result.sorters=sorters),filters.length&&(result.filters=filters),result},applyState:function(state){var locallySorted,me=this,hasSorters=!!me.sorters,hasGroupers=!!me.groupers,hasFilters=!!me.filters;hasGroupers&&state.groupers&&(me.groupers.clear(),me.groupers.addAll(me.decodeGroupers(state.groupers))),hasSorters&&state.sorters&&(me.sorters.clear(),me.sorters.addAll(me.decodeSorters(state.sorters))),hasFilters&&state.filters&&(me.filters.clear(),me.filters.addAll(me.decodeFilters(state.filters))),hasSorters&&hasGroupers&&me.sorters.insert(0,me.groupers.getRange()),me.autoLoad&&(me.remoteSort||me.remoteGroup||me.remoteFilter)&&(me.autoLoad===!0?me.reload():me.reload(me.autoLoad)),hasFilters&&me.filters.length&&!me.remoteFilter&&(me.filter(),locallySorted=me.sortOnFilter),hasSorters&&me.sorters.length&&!me.remoteSort&&!locallySorted&&me.sort()},doSort:function(sorterFn){var me=this;me.remoteSort?me.load():(me.data.sortBy(sorterFn),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)),me.fireEvent("sort",me,me.sorters.getRange())},clearData:Ext.emptyFn,getCount:Ext.emptyFn,getById:Ext.emptyFn,removeAll:Ext.emptyFn,isLoading:function(){return!!this.loading},suspendAutoSync:function(){this.autoSyncSuspended=!0},resumeAutoSync:function(){this.autoSyncSuspended=!1}}),Ext.define("Ext.app.domain.Store",{extend:Ext.app.EventDomain,singleton:!0,type:"store",idProperty:"storeId",constructor:function(){var me=this;me.callParent(),me.monitor(Ext.data.AbstractStore)}}),Ext.define("Ext.app.Controller",{mixins:{observable:Ext.util.Observable},statics:{strings:{model:{getter:"getModel",upper:"Model"},view:{getter:"getView",upper:"View"},controller:{getter:"getController",upper:"Controller"},store:{getter:"getStore",upper:"Store"}},controllerRegex:/^(.*)\.controller\./,createGetter:function(baseGetter,name){return function(){return this[baseGetter](name)}},getGetterName:function(name,kindUpper){var index,fn="get",parts=name.split("."),numParts=parts.length;for(index=0;index<numParts;index++)fn+=Ext.String.capitalize(parts[index]);return fn+=kindUpper},processDependencies:function(cls,requires,namespace,kind,names){if(names&&names.length){var o,absoluteName,shortName,name,j,subLn,getterName,getter,me=this,strings=me.strings[kind];for(Ext.isArray(names)||(names=[names]),j=0,subLn=names.length;j<subLn;j++)name=names[j],o=me.getFullName(name,kind,namespace),absoluteName=o.absoluteName,shortName=o.shortName,requires.push(absoluteName),getterName=me.getGetterName(shortName,strings.upper),cls[getterName]=getter=me.createGetter(strings.getter,name),"controller"!==kind&&(getter["Ext.app.getter"]=!0)}},getFullName:function(name,kind,namespace){var sep,absoluteName,shortName=name;return(sep=name.indexOf("@"))>0?(shortName=name.substring(0,sep),absoluteName=name.substring(sep+1)+"."+shortName):name.indexOf(".")>0&&(Ext.ClassManager.isCreated(name)||Ext.Loader.isAClassNameWithAKnownPrefix(name))?absoluteName=name:namespace?(absoluteName=namespace+"."+kind+"."+name,shortName=name):absoluteName=name,{absoluteName:absoluteName,shortName:shortName}}},application:null,onClassExtended:function(cls,data,hooks){var onBeforeClassCreated=hooks.onBeforeCreated;hooks.onBeforeCreated=function(cls,data){var className,namespace,requires,proto,match,Controller=Ext.app.Controller,ctrlRegex=Controller.controllerRegex,requires=[];proto=cls.prototype,className=Ext.getClassName(cls),namespace=data.$namespace||Ext.app.getNamespace(className)||(match=ctrlRegex.exec(className))&&match[1],namespace&&(proto.$namespace=namespace),Controller.processDependencies(proto,requires,namespace,"model",data.models),Controller.processDependencies(proto,requires,namespace,"view",data.views),Controller.processDependencies(proto,requires,namespace,"store",data.stores),Controller.processDependencies(proto,requires,namespace,"controller",data.controllers),Ext.require(requires,Ext.Function.pass(onBeforeClassCreated,arguments,this))}},constructor:function(config){var me=this;me.mixins.observable.constructor.call(me,config),me.refs&&me.ref(me.refs),me.eventbus=Ext.app.EventBus,me.initAutoGetters()},initAutoGetters:function(){var prop,fn,proto=this.self.prototype;for(prop in proto)fn=proto[prop],fn&&fn["Ext.app.getter"]&&fn.call(this)},doInit:function(app){var me=this;me._initialized||(me.init(app),me._initialized=!0)},finishInit:function(app){var controller,i,l,me=this,controllers=me.controllers;if(me._initialized&&controllers&&controllers.length)for(i=0,l=controllers.length;i<l;i++)controller=me.getController(controllers[i]),controller.finishInit(app)},init:Ext.emptyFn,onLaunch:Ext.emptyFn,ref:function(refs){var info,ref,fn,me=this,i=0,length=refs.length;for(refs=Ext.Array.from(refs),me.references=me.references||[];i<length;i++)info=refs[i],ref=info.ref,fn="get"+Ext.String.capitalize(ref),me[fn]||(me[fn]=Ext.Function.pass(me.getRef,[ref,info],me)),me.references.push(ref.toLowerCase())},addRef:function(refs){this.ref(refs)},getRef:function(ref,info,config){var me=this,refCache=me.refCache||(me.refCache={}),cached=refCache[ref];return info=info||{},config=config||{},Ext.apply(info,config),info.forceCreate?Ext.ComponentManager.create(info,"component"):(cached||(info.selector&&(refCache[ref]=cached=Ext.ComponentQuery.query(info.selector)[0]),!cached&&info.autoCreate&&(refCache[ref]=cached=Ext.ComponentManager.create(info,"component")),cached&&cached.on("beforedestroy",function(){refCache[ref]=null})),cached)},hasRef:function(ref){var references=this.references;return references&&Ext.Array.indexOf(references,ref.toLowerCase())!==-1},control:function(selectors,listeners,controller){var obj,me=this,ctrl=controller;Ext.isString(selectors)?(obj={},obj[selectors]=listeners):(obj=selectors,ctrl=listeners),me.eventbus.control(obj,ctrl||me)},listen:function(to,controller){this.eventbus.listen(to,controller||this)},getController:function(id){var me=this,app=me.application;return id===me.id?me:app&&app.getController(id)},getStore:function(name){var storeId,store;return storeId=name.indexOf("@")==-1?name:name.split("@")[0],store=Ext.StoreManager.get(storeId),store||(name=Ext.app.Controller.getFullName(name,"store",this.$namespace),name&&(store=Ext.create(name.absoluteName,{storeId:storeId}))),store},getModel:function(model){var name=Ext.app.Controller.getFullName(model,"model",this.$namespace);return name&&Ext.ModelManager.getModel(name.absoluteName)},getView:function(view){var name=Ext.app.Controller.getFullName(view,"view",this.$namespace);return name&&Ext.ClassManager.get(name.absoluteName)},getApplication:function(){return this.application}}),Ext.define("Ext.container.DockingContainer",{isDockingContainer:!0,defaultDockWeights:{top:{render:1,visual:1},left:{render:3,visual:5},right:{render:5,visual:7},bottom:{render:7,visual:3}},dockOrder:{top:-1,left:-1,right:1,bottom:1},horizontalDocks:0,addDocked:function(items,pos){var item,length,me=this,i=0;for(items=me.prepareItems(items),length=items.length;i<length;i++)item=items[i],item.dock=item.dock||"top","left"!==item.dock&&"right"!==item.dock||me.horizontalDocks++,void 0!==pos?(i+=pos,me.dockedItems.insert(i,item)):me.dockedItems.add(item),item.onAdded(me,i),me.hasListeners.dockedadd&&me.fireEvent("dockedadd",me,item,i),me.onDockedAdd!==Ext.emptyFn&&me.onDockedAdd(item);return me.rendered&&!me.suspendLayout&&me.updateLayout(),items},destroyDockedItems:function(){var c,dockedItems=this.dockedItems;if(dockedItems)for(;c=dockedItems.first();)this.removeDocked(c,!0)},doRenderDockedItems:function(out,renderData,after){var items,tree,me=renderData.$comp,layout=me.componentLayout;layout.getDockedItems&&!renderData.$skipDockedItems&&(items=layout.getDockedItems("render",!after),tree=items&&layout.getItemsRenderTree(items),tree&&Ext.DomHelper.generateMarkup(tree,out))},getDockedComponent:function(comp){return Ext.isObject(comp)&&(comp=comp.getItemId()),this.dockedItems.get(comp)},getDockedItems:function(selector,beforeBody){var dockedItems=this.getComponentLayout().getDockedItems("render",beforeBody);return selector&&dockedItems.length&&(dockedItems=Ext.ComponentQuery.query(selector,dockedItems)),
dockedItems},getDockingRefItems:function(deep,containerItems){var items,selector=deep&&"*,* *",dockedItems=this.getDockedItems(selector,!0);return dockedItems.push.apply(dockedItems,containerItems),items=this.getDockedItems(selector,!1),dockedItems.push.apply(dockedItems,items),dockedItems},initDockingItems:function(){var me=this,items=me.dockedItems;me.dockedItems=new Ext.util.AbstractMixedCollection((!1),me.getComponentId),items&&me.addDocked(items)},insertDocked:function(pos,items){this.addDocked(items,pos)},onDockedAdd:Ext.emptyFn,onDockedRemove:Ext.emptyFn,removeDocked:function(item,autoDestroy){var layout,hasLayout,me=this;return autoDestroy=autoDestroy===!0||autoDestroy!==!1&&me.autoDestroy,me.dockedItems.contains(item)?("left"!==item.dock&&"right"!==item.dock||me.horizontalDocks--,layout=me.componentLayout,hasLayout=layout&&me.rendered,hasLayout&&layout.onRemove(item),me.dockedItems.remove(item),item.onRemoved(item.destroying||autoDestroy),me.onDockedRemove(item),autoDestroy?item.destroy():hasLayout&&layout.afterRemove(item),me.hasListeners.dockedremove&&me.fireEvent("dockedremove",me,item),me.destroying||me.suspendLayout||me.updateLayout(),item):item},setupDockingRenderTpl:function(renderTpl){renderTpl.renderDockedItems=this.doRenderDockedItems}}),Ext.define("Ext.toolbar.Fill",{extend:Ext.Component,alias:"widget.tbfill",alternateClassName:"Ext.Toolbar.Fill",ariaRole:"presentation",isFill:!0,flex:1}),Ext.define("Ext.layout.container.boxOverflow.None",{alternateClassName:"Ext.layout.boxOverflow.None",constructor:function(layout,config){this.layout=layout,Ext.apply(this,config)},handleOverflow:Ext.emptyFn,clearOverflow:Ext.emptyFn,beginLayout:Ext.emptyFn,beginLayoutCycle:Ext.emptyFn,calculate:function(ownerContext){var overflow,me=this,plan=ownerContext.state.boxPlan;plan&&plan.tooNarrow?(overflow=me.handleOverflow(ownerContext),overflow&&overflow.reservedSpace&&me.layout.publishInnerCtSize(ownerContext,overflow.reservedSpace)):me.clearOverflow()},completeLayout:Ext.emptyFn,finishedLayout:function(ownerContext){var hiddens,hiddenCount,me=this,owner=me.layout.owner;owner.hasListeners.overflowchange&&(hiddens=owner.query(">[hidden]"),hiddenCount=hiddens.length,hiddenCount!==me.lastHiddenCount&&(owner.fireEvent("overflowchange",me.lastHiddenCount,hiddenCount,hiddens),me.lastHiddenCount=hiddenCount))},onRemove:Ext.emptyFn,getItem:function(item){return this.layout.owner.getComponent(item)},getOwnerType:function(owner){var type;return type=owner.isToolbar?"toolbar":owner.isTabBar?"tabbar":owner.isMenu?"menu":owner.getXType()},getPrefixConfig:Ext.emptyFn,getSuffixConfig:Ext.emptyFn,getOverflowCls:function(){return""}}),Ext.define("Ext.toolbar.Item",{extend:Ext.Component,alias:"widget.tbitem",alternateClassName:"Ext.Toolbar.Item",enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn}),Ext.define("Ext.toolbar.Separator",{extend:Ext.toolbar.Item,alias:"widget.tbseparator",alternateClassName:"Ext.Toolbar.Separator",baseCls:Ext.baseCSSPrefix+"toolbar-separator",focusable:!1,ariaRole:"separator"}),Ext.define("Ext.button.Manager",{singleton:!0,alternateClassName:"Ext.ButtonToggleManager",groups:{},pressedButton:null,buttonSelector:"."+Ext.baseCSSPrefix+"btn",init:function(){var me=this;me.initialized||(Ext.getDoc().on({keydown:me.onDocumentKeyDown,mouseup:me.onDocumentMouseUp,scope:me}),me.initialized=!0)},onDocumentKeyDown:function(e){var btn,k=e.getKey();k!==e.SPACE&&k!==e.ENTER||(btn=e.getTarget(this.buttonSelector),btn&&Ext.getCmp(btn.id).onClick(e))},onButtonMousedown:function(button,e){var pressed=this.pressedButton;pressed&&pressed.onMouseUp(e),this.pressedButton=button},onDocumentMouseUp:function(e){var pressed=this.pressedButton;pressed&&(pressed.onMouseUp(e),this.pressedButton=null)},toggleGroup:function(btn,state){if(state){var i,g=this.groups[btn.toggleGroup],length=g.length;for(i=0;i<length;i++)g[i]!==btn&&g[i].toggle(!1)}},register:function(btn){var me=this,groups=this.groups,group=groups[btn.toggleGroup];me.init(),btn.toggleGroup&&(group||(group=groups[btn.toggleGroup]=[]),group.push(btn),btn.on("toggle",me.toggleGroup,me))},unregister:function(btn){if(btn.toggleGroup){var me=this,group=me.groups[btn.toggleGroup];group&&(Ext.Array.remove(group,btn),btn.un("toggle",me.toggleGroup,me))}},getPressed:function(group){var len,g=this.groups[group],i=0;if(g)for(len=g.length;i<len;i++)if(g[i].pressed===!0)return g[i];return null}}),Ext.define("Ext.menu.Manager",{singleton:!0,alternateClassName:"Ext.menu.MenuMgr",menuSelector:"."+Ext.baseCSSPrefix+"menu",menus:{},groups:{},attached:!1,lastShow:new Date,init:function(){var me=this;me.active=new Ext.util.MixedCollection,Ext.getDoc().addKeyListener(27,function(){me.active.length>0&&me.hideAll()},me)},hideAll:function(){var menus,m,mLen,active=this.active;if(active&&active.length>0){for(menus=Ext.Array.slice(active.items),mLen=menus.length,m=0;m<mLen;m++)menus[m].hide();return!0}return!1},onHide:function(m){var me=this,active=me.active;active.remove(m),active.length<1&&(Ext.getDoc().un("mousedown",me.onMouseDown,me),me.attached=!1)},onShow:function(m){var me=this,active=me.active,attached=me.attached;me.lastShow=new Date,active.add(m),attached||(Ext.getDoc().on("mousedown",me.onMouseDown,me,{buffer:Ext.isIE9m?10:void 0}),me.attached=!0),m.toFront()},onBeforeHide:function(m){m.activeChild&&m.activeChild.hide(),m.autoHideTimer&&(clearTimeout(m.autoHideTimer),delete m.autoHideTimer)},onBeforeShow:function(m){var active=this.active,parentMenu=m.parentMenu;active.remove(m),parentMenu||m.allowOtherMenus?parentMenu&&parentMenu.activeChild&&m!=parentMenu.activeChild&&parentMenu.activeChild.hide():this.hideAll()},onMouseDown:function(e){var me=this,active=me.active,lastShow=me.lastShow,doHide=!0;Ext.Date.getElapsed(lastShow)>50&&active.length>0&&!e.getTarget(me.menuSelector)&&(Ext.isIE9m&&!Ext.getDoc().contains(e.target)&&(doHide=!1),doHide&&me.hideAll())},register:function(menu){var me=this;me.active||me.init(),menu.floating&&(me.menus[menu.id]=menu,menu.on({beforehide:me.onBeforeHide,hide:me.onHide,beforeshow:me.onBeforeShow,show:me.onShow,scope:me}))},get:function(menu){var menus=this.menus;return"string"==typeof menu?menus?menus[menu]:null:menu.isMenu?menu:Ext.isArray(menu)?new Ext.menu.Menu({items:menu}):Ext.ComponentManager.create(menu,"menu")},unregister:function(menu){var me=this,menus=me.menus,active=me.active;delete menus[menu.id],active.remove(menu),menu.un({beforehide:me.onBeforeHide,hide:me.onHide,beforeshow:me.onBeforeShow,show:me.onShow,scope:me})},registerCheckable:function(menuItem){var groups=this.groups,groupId=menuItem.group;groupId&&(groups[groupId]||(groups[groupId]=[]),groups[groupId].push(menuItem))},unregisterCheckable:function(menuItem){var groups=this.groups,groupId=menuItem.group;groupId&&Ext.Array.remove(groups[groupId],menuItem)},onCheckChange:function(menuItem,state){var group,ln,curr,groups=this.groups,groupId=menuItem.group,i=0;if(groupId&&state)for(group=groups[groupId],ln=group.length;i<ln;i++)curr=group[i],curr!=menuItem&&curr.setChecked(!1)}}),Ext.define("Ext.util.ClickRepeater",{extend:Ext.util.Observable,constructor:function(el,config){var me=this;me.el=Ext.get(el),me.el.unselectable(),Ext.apply(me,config),me.callParent(),me.addEvents("mousedown","click","mouseup"),me.disabled||(me.disabled=!0,me.enable()),me.handler&&me.on("click",me.handler,me.scope||me)},interval:20,delay:250,preventDefault:!0,stopDefault:!1,timer:0,enable:function(){this.disabled&&(this.el.on("mousedown",this.handleMouseDown,this),Ext.isIE&&!(Ext.isIE10p||Ext.isStrict&&Ext.isIE9)&&this.el.on("dblclick",this.handleDblClick,this),(this.preventDefault||this.stopDefault)&&this.el.on("click",this.eventOptions,this)),this.disabled=!1},disable:function(force){!force&&this.disabled||(clearTimeout(this.timer),this.pressedCls&&this.el.removeCls(this.pressedCls),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.el.removeAllListeners()),this.disabled=!0},setDisabled:function(disabled){this[disabled?"disable":"enable"]()},eventOptions:function(e){this.preventDefault&&e.preventDefault(),this.stopDefault&&e.stopEvent()},destroy:function(){this.disable(!0),Ext.destroy(this.el),this.clearListeners()},handleDblClick:function(e){clearTimeout(this.timer),this.el.blur(),this.fireEvent("mousedown",this,e),this.fireEvent("click",this,e)},handleMouseDown:function(e){clearTimeout(this.timer),this.el.blur(),this.pressedCls&&this.el.addCls(this.pressedCls),this.mousedownTime=new Date,Ext.getDoc().on("mouseup",this.handleMouseUp,this),this.el.on("mouseout",this.handleMouseOut,this),this.fireEvent("mousedown",this,e),this.fireEvent("click",this,e),this.accelerate&&(this.delay=400),e=new Ext.EventObjectImpl(e),this.timer=Ext.defer(this.click,this.delay||this.interval,this,[e])},click:function(e){this.fireEvent("click",this,e),this.timer=Ext.defer(this.click,this.accelerate?this.easeOutExpo(Ext.Date.getElapsed(this.mousedownTime),400,-390,12e3):this.interval,this,[e])},easeOutExpo:function(t,b,c,d){return t==d?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},handleMouseOut:function(){clearTimeout(this.timer),this.pressedCls&&this.el.removeCls(this.pressedCls),this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this),this.pressedCls&&this.el.addCls(this.pressedCls),this.click()},handleMouseUp:function(e){clearTimeout(this.timer),this.el.un("mouseover",this.handleMouseReturn,this),this.el.un("mouseout",this.handleMouseOut,this),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.pressedCls&&this.el.removeCls(this.pressedCls),this.fireEvent("mouseup",this,e)}}),Ext.define("Ext.layout.component.Button",{alias:["layout.button"],extend:Ext.layout.component.Auto,type:"button",htmlRE:/<.*>/,beginLayout:function(ownerContext){var me=this,owner=me.owner,text=owner.text;me.callParent(arguments),ownerContext.btnWrapContext=ownerContext.getEl("btnWrap"),ownerContext.btnElContext=ownerContext.getEl("btnEl"),ownerContext.btnInnerElContext=ownerContext.getEl("btnInnerEl"),ownerContext.btnIconElContext=ownerContext.getEl("btnIconEl"),text&&me.htmlRE.test(text)&&(ownerContext.isHtmlText=!0,owner.btnInnerEl.setStyle("line-height","normal"),owner.btnInnerEl.setStyle("padding-top",""))},beginLayoutCycle:function(ownerContext){var owner=this.owner,lastWidthModel=this.lastWidthModel;this.callParent(arguments),lastWidthModel&&!this.lastWidthModel.shrinkWrap&&ownerContext.widthModel.shrinkWrap&&(owner.btnWrap.setStyle("height",""),owner.btnEl.setStyle("height",""),owner.btnInnerEl.setStyle("line-height",""))},calculate:function(ownerContext){var ownerHeight,contentHeight,btnElHeight,innerElHeight,me=this,owner=me.owner,btnElContext=ownerContext.btnElContext,btnInnerElContext=ownerContext.btnInnerElContext,btnWrapContext=ownerContext.btnWrapContext,mmax=Math.max;me.callParent(arguments),ownerContext.heightModel.shrinkWrap?(btnElHeight=owner.btnEl.getHeight(),ownerContext.isHtmlText&&(me.centerInnerEl(ownerContext,btnElHeight),me.ieCenterIcon(ownerContext,btnElHeight))):(ownerHeight=ownerContext.getProp("height"),ownerHeight?(contentHeight=ownerHeight-ownerContext.getFrameInfo().height-ownerContext.getPaddingInfo().height,btnElHeight=contentHeight,(owner.menu||owner.split)&&"bottom"===owner.arrowAlign&&(btnElHeight-=btnWrapContext.getPaddingInfo().bottom),innerElHeight=btnElHeight,!(owner.icon||owner.iconCls||owner.glyph)||"top"!==owner.iconAlign&&"bottom"!==owner.iconAlign||(innerElHeight-=btnInnerElContext.getPaddingInfo().height),btnWrapContext.setProp("height",mmax(0,contentHeight)),btnElContext.setProp("height",mmax(0,btnElHeight)),ownerContext.isHtmlText?me.centerInnerEl(ownerContext,btnElHeight):btnInnerElContext.setProp("line-height",mmax(0,innerElHeight)+"px"),me.ieCenterIcon(ownerContext,btnElHeight)):0!==ownerHeight&&(me.done=!1))},centerInnerEl:function(ownerContext,btnElHeight){var me=this,btnInnerElContext=ownerContext.btnInnerElContext,innerElHeight=me.owner.btnInnerEl.getHeight();ownerContext.heightModel.shrinkWrap&&btnElHeight<innerElHeight?ownerContext.btnElContext.setHeight(innerElHeight):btnElHeight>innerElHeight&&btnInnerElContext.setProp("padding-top",Math.round((btnElHeight-innerElHeight)/2)+btnInnerElContext.getPaddingInfo().top)},ieCenterIcon:function(ownerContext,btnElHeight){var iconAlign=this.owner.iconAlign;!Ext.isIEQuirks&&!Ext.isIE6||"left"!==iconAlign&&"right"!==iconAlign||ownerContext.btnIconElContext.setHeight(btnElHeight)},publishInnerWidth:function(ownerContext,width){this.owner.getFrameInfo().table&&ownerContext.btnInnerElContext.setWidth(width-ownerContext.getFrameInfo().width-ownerContext.getPaddingInfo().width-ownerContext.btnWrapContext.getPaddingInfo().width)}}),Ext.define("Ext.util.TextMetrics",{statics:{shared:null,measure:function(el,text,fixedWidth){var me=this,shared=me.shared;return shared||(shared=me.shared=new me(el,fixedWidth)),shared.bind(el),shared.setFixedWidth(fixedWidth||"auto"),shared.getSize(text)},destroy:function(){var me=this;Ext.destroy(me.shared),me.shared=null}},constructor:function(bindTo,fixedWidth){var me=this,measure=Ext.getBody().createChild({role:"presentation",cls:Ext.baseCSSPrefix+"textmetrics"});me.measure=measure,bindTo&&me.bind(bindTo),measure.position("absolute"),measure.setLocalXY(-1e3,-1e3),measure.hide(),fixedWidth&&measure.setWidth(fixedWidth)},getSize:function(text){var size,measure=this.measure;return measure.update(text),size=measure.getSize(),measure.update(""),size},bind:function(el){var me=this;me.el=Ext.get(el),me.measure.setStyle(me.el.getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(width){this.measure.setWidth(width)},getWidth:function(text){return this.measure.dom.style.width="auto",this.getSize(text).width},getHeight:function(text){return this.getSize(text).height},destroy:function(){var me=this;me.measure.remove(),delete me.el,delete me.measure}},function(){Ext.Element.addMethods({getTextWidth:function(text,min,max){return Ext.Number.constrain(Ext.util.TextMetrics.measure(this.dom,Ext.value(text,this.dom.innerHTML,!0)).width,min||0,max||1e6)}})}),Ext.define("Ext.button.Button",{alias:"widget.button",extend:Ext.Component,mixins:{queryable:Ext.Queryable},alternateClassName:"Ext.Button",isButton:!0,componentLayout:"button",hidden:!1,disabled:!1,pressed:!1,tabIndex:0,enableToggle:!1,menuAlign:"tl-bl?",showEmptyMenu:!1,textAlign:"center",clickEvent:"click",preventDefault:!0,handleMouseEvents:!0,tooltipType:"qtip",baseCls:Ext.baseCSSPrefix+"btn",pressedCls:"pressed",overCls:"over",focusCls:"focus",menuActiveCls:"menu-active",hrefTarget:"_blank",ariaRole:"button",childEls:["btnEl","btnWrap","btnInnerEl","btnIconEl"],renderTpl:['<span id="{id}-btnWrap" role="presentation" class="{baseCls}-wrap','<tpl if="splitCls"> {splitCls}</tpl>','{childElCls}" unselectable="on">','<span id="{id}-btnEl" class="{baseCls}-button" role="presentation">','<span id="{id}-btnInnerEl" class="{baseCls}-inner {innerCls}','{childElCls}" unselectable="on">',"{text}","</span>",'<span role="presentation" id="{id}-btnIconEl" class="{baseCls}-icon-el {iconCls}','{childElCls} {glyphCls}" unselectable="on" style="','<tpl if="iconUrl">background-image:url({iconUrl});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl><tpl if="iconCls || iconUrl">&#160;</tpl>',"</span>","</span>","</span>",'<tpl if="closable">','<span id="{id}-closeEl" role="presentation"',' class="{baseCls}-close-btn"','<tpl if="closeText">',' title="{closeText}" aria-label="{closeText}"',"</tpl>",">","</span>","</tpl>"],scale:"small",allowedScales:["small","medium","large"],iconAlign:"left",arrowAlign:"right",arrowCls:"arrow",maskOnDisable:!1,shrinkWrap:3,frame:!0,hasFrameTable:function(){return this.href&&this.frameTable},frameTableListener:function(){this.disabled||this.doNavigate()},doNavigate:function(){"_blank"===this.hrefTarget?window.open(this.href,this.hrefTarget):location.href=this.href},_triggerRegion:{},initComponent:function(){var me=this;me.autoEl={tag:"a",hidefocus:"on",unselectable:"on"},me.addCls(Ext.baseCSSPrefix+"unselectable"),me.callParent(arguments),me.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout","textchange","iconchange","glyphchange"),me.menu&&(me.split=!0,me.menu=Ext.menu.Manager.get(me.menu),me.menu.ownerButton=me),me.url&&(me.href=me.url),me.href&&!me.hasOwnProperty("preventDefault")&&(me.preventDefault=!1),Ext.isString(me.toggleGroup)&&""!==me.toggleGroup&&(me.enableToggle=!0),me.html&&!me.text&&(me.text=me.html,delete me.html),me.glyphCls=me.baseCls+"-glyph"},getActionEl:function(){return this.el},getFocusEl:function(){return this.el},onDisable:function(){this.callParent(arguments)},setComponentCls:function(){var me=this,cls=me.getComponentCls();Ext.isEmpty(me.oldCls)||(me.removeClsWithUI(me.oldCls),me.removeClsWithUI(me.pressedCls)),me.oldCls=cls,me.addClsWithUI(cls)},getComponentCls:function(){var cls,me=this;return cls=me.iconCls||me.icon||me.glyph?[me.text?"icon-text-"+me.iconAlign:"icon"]:me.text?["noicon"]:[],me.pressed&&(cls[cls.length]=me.pressedCls),cls},beforeRender:function(){var me=this,autoEl=me.autoEl,href=me.getHref(),hrefTarget=me.hrefTarget;me.disabled||(autoEl.tabIndex=me.tabIndex),href&&(autoEl.href=href,hrefTarget&&(autoEl.target=hrefTarget)),me.callParent(),me.oldCls=me.getComponentCls(),me.addClsWithUI(me.oldCls),Ext.applyIf(me.renderData,me.getTemplateArgs())},onRender:function(){var addOnclick,btn,btnListeners,me=this;me.doc=Ext.getDoc(),me.callParent(arguments),btn=me.el,me.tooltip&&me.setTooltip(me.tooltip,!0),me.handleMouseEvents?(btnListeners={scope:me,mouseover:me.onMouseOver,mouseout:me.onMouseOut,mousedown:me.onMouseDown},me.split&&(btnListeners.mousemove=me.onMouseMove)):btnListeners={scope:me},me.menu&&(me.mon(me.menu,{scope:me,show:me.onMenuShow,hide:me.onMenuHide}),me.keyMap=new Ext.util.KeyMap({target:me.el,key:Ext.EventObject.DOWN,handler:me.onDownKey,scope:me})),me.repeat?me.mon(new Ext.util.ClickRepeater(btn,Ext.isObject(me.repeat)?me.repeat:{}),"click",me.onRepeatClick,me):btnListeners[me.clickEvent]?addOnclick=!0:btnListeners[me.clickEvent]=me.onClick,me.mon(btn,btnListeners),me.hasFrameTable()&&me.mon(me.frameTable,"click",me.frameTableListener,me),addOnclick&&me.mon(btn,me.clickEvent,me.onClick,me),Ext.button.Manager.register(me)},getTemplateArgs:function(){var glyphParts,me=this,glyph=me.glyph,glyphFontFamily=Ext._glyphFontFamily;return"string"==typeof glyph&&(glyphParts=glyph.split("@"),glyph=glyphParts[0],glyphFontFamily=glyphParts[1]),{innerCls:me.getInnerCls(),splitCls:me.getSplitCls(),iconUrl:me.icon,iconCls:me.iconCls,glyph:glyph,glyphCls:glyph?me.glyphCls:"",glyphFontFamily:glyphFontFamily,text:me.text||"&#160;",closeText:me.closeText}},setHref:function(href){this.href=href,this.el.dom.href=this.getHref()},getHref:function(){var me=this,href=me.href;return!!href&&Ext.urlAppend(href,Ext.Object.toQueryString(Ext.apply({},me.params,me.baseParams)))},setParams:function(params){this.params=params,this.el.dom.href=this.getHref()},getSplitCls:function(){var me=this;return me.split?me.baseCls+"-"+me.arrowCls+" "+(me.baseCls+"-"+me.arrowCls+"-"+me.arrowAlign):""},getInnerCls:function(){return this.textAlign?this.baseCls+"-inner-"+this.textAlign:""},setIcon:function(icon){icon=icon||"";var me=this,btnIconEl=me.btnIconEl,oldIcon=me.icon||"";return me.icon=icon,icon!=oldIcon&&(btnIconEl&&(btnIconEl.setStyle("background-image",icon?"url("+icon+")":""),me.setComponentCls(),me.didIconStateChange(oldIcon,icon)&&me.updateLayout()),me.fireEvent("iconchange",me,oldIcon,icon)),me},setIconCls:function(cls){cls=cls||"";var me=this,btnIconEl=me.btnIconEl,oldCls=me.iconCls||"";return me.iconCls=cls,oldCls!=cls&&(btnIconEl&&(btnIconEl.removeCls(oldCls),btnIconEl.addCls(cls),me.setComponentCls(),me.didIconStateChange(oldCls,cls)&&me.updateLayout()),me.fireEvent("iconchange",me,oldCls,cls)),me},setGlyph:function(glyph){glyph=glyph||0;var fontFamily,glyphParts,me=this,btnIconEl=me.btnIconEl,oldGlyph=me.glyph;return me.glyph=glyph,btnIconEl&&("string"==typeof glyph&&(glyphParts=glyph.split("@"),glyph=glyphParts[0],fontFamily=glyphParts[1]||Ext._glyphFontFamily),glyph?oldGlyph!=glyph&&(btnIconEl.dom.innerHTML="&#"+glyph+";"):btnIconEl.dom.innerHTML="",fontFamily&&btnIconEl.setStyle("font-family",fontFamily)),me.fireEvent("glyphchange",me,me.glyph,oldGlyph),me},setTooltip:function(tooltip,initial){var me=this;return me.rendered?(initial&&tooltip||me.clearTip(),tooltip&&(Ext.quickTipsActive&&Ext.isObject(tooltip)?(Ext.tip.QuickTipManager.register(Ext.apply({target:me.el.id},tooltip)),me.tooltip=tooltip):me.el.dom.setAttribute(me.getTipAttr(),tooltip))):me.tooltip=tooltip,me},setTextAlign:function(align){var me=this,btnEl=me.btnEl;return btnEl&&(btnEl.removeCls(me.baseCls+"-inner-"+me.textAlign),btnEl.addCls(me.baseCls+"-inner-"+align)),me.textAlign=align,me},getTipAttr:function(){return"qtip"==this.tooltipType?"data-qtip":"title"},getRefItems:function(deep){var items,menu=this.menu;return menu&&(items=menu.getRefItems(deep),items.unshift(menu)),items||[]},clearTip:function(){var me=this,el=me.el;Ext.quickTipsActive&&Ext.isObject(me.tooltip)?Ext.tip.QuickTipManager.unregister(el):el.dom.removeAttribute(me.getTipAttr())},beforeDestroy:function(){var me=this;me.rendered&&me.clearTip(),me.menu&&me.destroyMenu!==!1&&Ext.destroy(me.menu),Ext.destroy(me.btnInnerEl,me.repeater),me.callParent()},onDestroy:function(){var me=this;me.rendered&&(me.doc.un("mouseover",me.monitorMouseOver,me),delete me.doc,Ext.destroy(me.keyMap),delete me.keyMap),Ext.button.Manager.unregister(me),me.callParent()},setHandler:function(handler,scope){return this.handler=handler,this.scope=scope,this},setText:function(text){text=text||"";var me=this,oldText=me.text||"";return text!=oldText&&(me.text=text,me.rendered&&(me.btnInnerEl.update(text||"&#160;"),me.setComponentCls(),Ext.isStrict&&Ext.isIE8&&me.el.repaint(),me.updateLayout()),me.fireEvent("textchange",me,oldText,text)),me},didIconStateChange:function(old,current){var currentEmpty=Ext.isEmpty(current);return Ext.isEmpty(old)?!currentEmpty:currentEmpty},getText:function(){return this.text},toggle:function(state,suppressEvent){var me=this;return state=void 0===state?!me.pressed:!!state,state!==me.pressed&&(me.rendered&&me[state?"addClsWithUI":"removeClsWithUI"](me.pressedCls),me.pressed=state,suppressEvent||(me.fireEvent("toggle",me,state),Ext.callback(me.toggleHandler,me.scope||me,[me,state]))),me},maybeShowMenu:function(){var me=this;!me.menu||me.hasVisibleMenu()||me.ignoreNextClick||me.showMenu(!0)},showMenu:function(fromEvent){var me=this,menu=me.menu;return me.rendered&&(me.tooltip&&Ext.quickTipsActive&&"title"!=me.getTipAttr()&&Ext.tip.QuickTipManager.getQuickTip().cancelShow(me.el),menu.isVisible()&&menu.hide(),(!fromEvent||me.showEmptyMenu||menu.items.getCount()>0)&&menu.showBy(me.el,me.menuAlign)),me},hideMenu:function(){return this.hasVisibleMenu()&&this.menu.hide(),this},hasVisibleMenu:function(){var menu=this.menu;return menu&&menu.rendered&&menu.isVisible()},onRepeatClick:function(repeat,e){this.onClick(e)},onClick:function(e){var me=this;me.doPreventDefault(e),"keydown"!==e.type&&0!==e.button||me.disabled||(me.doToggle(),me.maybeShowMenu(),me.fireHandler(e))},doPreventDefault:function(e){(this.preventDefault||this.disabled&&this.getHref()&&e)&&e.preventDefault()},fireHandler:function(e){var me=this,handler=me.handler;me.fireEvent("click",me,e)!==!1&&handler&&handler.call(me.scope||me,me,e)},doToggle:function(){var me=this;!me.enableToggle||me.allowDepress===!1&&me.pressed||me.toggle()},onMouseOver:function(e){var me=this;me.disabled||e.within(me.el,!0,!0)||me.onMouseEnter(e)},onMouseOut:function(e){var me=this;e.within(me.el,!0,!0)||(me.overMenuTrigger&&me.onMenuTriggerOut(e),me.onMouseLeave(e))},onMouseMove:function(e){var overPosition,triggerRegion,me=this,el=me.el,over=me.overMenuTrigger;me.split&&(overPosition="right"===me.arrowAlign?e.getX()-me.getX():e.getY()-el.getY(),triggerRegion=me.getTriggerRegion(),overPosition>triggerRegion.begin&&overPosition<triggerRegion.end?over||me.onMenuTriggerOver(e):over&&me.onMenuTriggerOut(e))},getTriggerRegion:function(){var me=this,region=me._triggerRegion,triggerSize=me.getTriggerSize(),btnSize="right"===me.arrowAlign?me.getWidth():me.getHeight();return region.begin=btnSize-triggerSize,region.end=btnSize,region},getTriggerSize:function(){var side,sideFirstLetter,me=this,size=me.triggerSize;return null==size&&(side=me.arrowAlign,sideFirstLetter=side.charAt(0),size=me.triggerSize=me.el.getFrameWidth(sideFirstLetter)+me.getBtnWrapFrameWidth(sideFirstLetter),me.frameSize&&(size=me.triggerSize+=me.frameSize[side])),size},getBtnWrapFrameWidth:function(side){return this.btnWrap.getFrameWidth(side)},addOverCls:function(){this.disabled||this.addClsWithUI(this.overCls)},removeOverCls:function(){this.removeClsWithUI(this.overCls)},onMouseEnter:function(e){this.fireEvent("mouseover",this,e)},onMouseLeave:function(e){this.fireEvent("mouseout",this,e)},onMenuTriggerOver:function(e){var me=this,arrowTip=me.arrowTooltip;me.overMenuTrigger=!0,me.split&&arrowTip&&me.btnWrap.dom.setAttribute(me.getTipAttr(),arrowTip),me.fireEvent("menutriggerover",me,me.menu,e)},onMenuTriggerOut:function(e){var me=this;delete me.overMenuTrigger,me.split&&me.arrowTooltip&&me.btnWrap.dom.setAttribute(me.getTipAttr(),""),me.fireEvent("menutriggerout",me,me.menu,e)},enable:function(silent){var me=this;return me.callParent(arguments),me.removeClsWithUI("disabled"),me.rendered&&me.el.dom.setAttribute("tabIndex",me.tabIndex),me},disable:function(silent){var me=this;return me.callParent(arguments),me.addClsWithUI("disabled"),me.removeClsWithUI(me.overCls),me.rendered&&me.el.dom.removeAttribute("tabIndex"),me.btnInnerEl&&Ext.isIE7m&&me.btnInnerEl.repaint(),me},setScale:function(scale){var me=this,ui=me.ui.replace("-"+me.scale,"");if(!Ext.Array.contains(me.allowedScales,scale))throw"#setScale: scale must be an allowed scale ("+me.allowedScales.join(", ")+")";me.scale=scale,me.setUI(ui)},setUI:function(ui){var me=this;me.scale&&!ui.match(me.scale)&&(ui=ui+"-"+me.scale),me.callParent([ui])},onMouseDown:function(e){var me=this;Ext.isIE&&me.getFocusEl().focus(),me.disabled||0!==e.button||(Ext.button.Manager.onButtonMousedown(me,e),me.addClsWithUI(me.pressedCls))},onMouseUp:function(e){var me=this;me.isDestroyed||0!==e.button||me.pressed||me.removeClsWithUI(me.pressedCls)},onMenuShow:function(e){var me=this;me.ignoreNextClick=0,me.addClsWithUI(me.menuActiveCls),me.fireEvent("menushow",me,me.menu)},onMenuHide:function(e){var me=this;me.removeClsWithUI(me.menuActiveCls),me.ignoreNextClick=Ext.defer(me.restoreClick,250,me),me.fireEvent("menuhide",me,me.menu),me.focus()},restoreClick:function(){this.ignoreNextClick=0},onDownKey:function(k,e){var me=this;if(me.menu&&!me.disabled)return me.showMenu(),e.stopEvent(),!1}}),Ext.define("Ext.layout.container.boxOverflow.Menu",{extend:Ext.layout.container.boxOverflow.None,alternateClassName:"Ext.layout.boxOverflow.Menu",noItemsMenuText:'<div class="'+Ext.baseCSSPrefix+'toolbar-no-items" role="menuitem">(None)</div>',constructor:function(layout){var me=this;me.callParent(arguments),me.triggerButtonCls=me.triggerButtonCls||Ext.baseCSSPrefix+"box-menu-after",me.menuItems=[]},beginLayout:function(ownerContext){this.callParent(arguments),this.clearOverflow(ownerContext)},beginLayoutCycle:function(ownerContext,firstCycle){this.callParent(arguments),firstCycle||(this.clearOverflow(ownerContext),this.layout.cacheChildItems(ownerContext))},onRemove:function(comp){Ext.Array.remove(this.menuItems,comp)},getSuffixConfig:function(){var me=this,layout=me.layout,owner=layout.owner,oid=owner.id;return me.menu=new Ext.menu.Menu({listeners:{scope:me,beforeshow:me.beforeMenuShow}}),me.menuTrigger=new Ext.button.Button({id:oid+"-menu-trigger",cls:Ext.layout.container.Box.prototype.innerCls+" "+me.triggerButtonCls+" "+Ext.baseCSSPrefix+"toolbar-item",plain:owner.usePlainButtons,ownerCt:owner,ownerLayout:layout,iconCls:Ext.baseCSSPrefix+me.getOwnerType(owner)+"-more-icon",ui:owner instanceof Ext.toolbar.Toolbar?"default-toolbar":"default",menu:me.menu,showEmptyMenu:!0,getSplitCls:function(){return""}}),me.menuTrigger.getRenderTree()},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},handleOverflow:function(ownerContext){var me=this,layout=me.layout,names=layout.names,plan=ownerContext.state.boxPlan,posArgs=[null,null];return me.showTrigger(ownerContext),"vertical"!==me.layout.direction&&(posArgs[names.heightIndex]=(plan.maxSize-me.menuTrigger[names.getHeight]())/2,me.menuTrigger.setPosition.apply(me.menuTrigger,posArgs)),{reservedSpace:me.triggerTotalWidth}},captureChildElements:function(){var me=this,menuTrigger=me.menuTrigger,names=me.layout.names;menuTrigger.rendering&&(menuTrigger.finishRender(),me.triggerTotalWidth=menuTrigger[names.getWidth]()+menuTrigger.el.getMargin(names.parallelMargins))},_asLayoutRoot:{isRoot:!0},clearOverflow:function(ownerContext){var item,me=this,items=me.menuItems,i=0,length=items.length,owner=me.layout.owner,asLayoutRoot=me._asLayoutRoot;for(owner.suspendLayouts(),me.captureChildElements(),me.hideTrigger(),owner.resumeLayouts();i<length;i++)item=items[i],item.suspendLayouts(),item.show(),item.resumeLayouts(asLayoutRoot);items.length=0},showTrigger:function(ownerContext){var childContext,comp,i,props,me=this,layout=me.layout,owner=layout.owner,names=layout.names,startProp=names.x,sizeProp=names.width,plan=ownerContext.state.boxPlan,available=plan.targetSize[sizeProp],childItems=ownerContext.childItems,len=childItems.length,menuTrigger=me.menuTrigger;for(menuTrigger.suspendLayouts(),menuTrigger.show(),menuTrigger.resumeLayouts(me._asLayoutRoot),available-=me.triggerTotalWidth,owner.suspendLayouts(),me.menuItems.length=0,i=0;i<len;i++)childContext=childItems[i],props=childContext.props,props[startProp]+props[sizeProp]>available&&(comp=childContext.target,me.menuItems.push(comp),comp.hide());owner.resumeLayouts()},hideTrigger:function(){var menuTrigger=this.menuTrigger;menuTrigger&&menuTrigger.hide()},beforeMenuShow:function(menu){var item,prev,me=this,items=me.menuItems,i=0,len=items.length,needsSep=function(group,prev){return group.isXType("buttongroup")&&!(prev instanceof Ext.toolbar.Separator)};for(menu.suspendLayouts(),me.clearMenu(),menu.removeAll();i<len;i++)item=items[i],!i&&item instanceof Ext.toolbar.Separator||(prev&&(needsSep(item,prev)||needsSep(prev,item))&&menu.add("-"),me.addComponentToMenu(menu,item),prev=item);menu.items.length<1&&menu.add(me.noItemsMenuText),menu.resumeLayouts()},createMenuConfig:function(component,hideOnClick){var me=this,config=Ext.apply({},component.initialConfig),group=component.toggleGroup;return Ext.copyTo(config,component,["iconCls","icon","itemId","disabled","handler","scope","menu","tabIndex"]),Ext.apply(config,{text:component.overflowText||component.text,hideOnClick:hideOnClick,destroyMenu:!1,listeners:{}}),component.isFormField?(config.value=component.getValue(),config.listeners.change=function(c,newVal,oldVal){component.setValue(newVal)}):(group||component.enableToggle)&&Ext.apply(config,{hideOnClick:!1,group:group,checked:component.pressed,handler:function(item,e){component.onClick(e)}}),component.isButton&&!component.changeListenersAdded&&(component.on({textchange:me.onButtonAttrChange,iconchange:me.onButtonAttrChange,toggle:me.onButtonToggle}),component.changeListenersAdded=!0),delete config.margin,delete config.ownerCt,delete config.xtype,delete config.id,delete config.itemId,config},onButtonAttrChange:function(btn){var clone=btn.overflowClone;clone.suspendLayouts(),clone.setText(btn.text),clone.setIcon(btn.icon),clone.setIconCls(btn.iconCls),clone.resumeLayouts(!0)},onButtonToggle:function(btn,state){btn.overflowClone.checked!==state&&btn.overflowClone.setChecked(state)},addComponentToMenu:function(menu,component){
var i,items,iLen,me=this;if(component instanceof Ext.toolbar.Separator)menu.add("-");else if(component.isComponent)if(component.isXType("splitbutton"))component.overflowClone=menu.add(me.createMenuConfig(component,!0));else if(component.isXType("button"))component.overflowClone=menu.add(me.createMenuConfig(component,!component.menu));else if(component.isXType("buttongroup"))for(items=component.items.items,iLen=items.length,i=0;i<iLen;i++)me.addComponentToMenu(menu,items[i]);else component.overflowClone=menu.add(Ext.create(Ext.getClassName(component),me.createMenuConfig(component)))},clearMenu:function(){var items,i,iLen,item,menu=this.menu;if(menu&&menu.items)for(items=menu.items.items,iLen=items.length,i=0;i<iLen;i++)item=items[i],item.setMenu&&item.setMenu(null)},destroy:function(){var trigger=this.menuTrigger;trigger&&!this.layout.owner.items.contains(trigger)&&delete trigger.ownerCt,Ext.destroy(this.menu,trigger)}}),Ext.define("Ext.layout.container.boxOverflow.Scroller",{extend:Ext.layout.container.boxOverflow.None,alternateClassName:"Ext.layout.boxOverflow.Scroller",mixins:{observable:Ext.util.Observable},animateScroll:!1,scrollIncrement:20,wheelIncrement:10,scrollRepeatInterval:60,scrollDuration:400,scrollerCls:Ext.baseCSSPrefix+"box-scroller",constructor:function(layout,config){var me=this;me.layout=layout,Ext.apply(me,config||{}),me.mixins.observable.constructor.call(me),me.addEvents("scroll"),me.scrollPosition=0,me.scrollSize=0},getPrefixConfig:function(){var cls,me=this,layout=me.layout,owner=layout.owner;return me.initCSSClasses(),cls=Ext.layout.container.Box.prototype.innerCls+" "+me.beforeCtCls,owner.plain&&(cls+=" "+me.scrollerCls+"-plain"),{role:"presentation",cls:cls,cn:{role:"presentation",id:owner.id+layout.names.beforeScrollerSuffix,cls:me.scrollerCls+" "+me.beforeScrollerCls,style:"display:none"}}},getSuffixConfig:function(){var me=this,layout=me.layout,owner=layout.owner,cls=Ext.layout.container.Box.prototype.innerCls+" "+me.afterCtCls;return owner.plain&&(cls+=" "+me.scrollerCls+"-plain"),{role:"presentation",cls:cls,cn:{role:"presentation",id:owner.id+layout.names.afterScrollerSuffix,cls:me.scrollerCls+" "+me.afterScrollerCls,style:"display:none"}}},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},initCSSClasses:function(){var me=this,prefix=Ext.baseCSSPrefix,layout=me.layout,names=layout.names,beforeXName=names.beforeX,afterXName=names.afterX,type=me.getOwnerType(layout.owner);me.beforeCtCls=me.beforeCtCls||prefix+"box-scroller-"+beforeXName,me.afterCtCls=me.afterCtCls||prefix+"box-scroller-"+afterXName,me.beforeScrollerCls=me.beforeScrollerCls||prefix+type+"-scroll-"+beforeXName,me.afterScrollerCls=me.afterScrollerCls||prefix+type+"-scroll-"+afterXName},beginLayout:function(ownerContext){this.layout;ownerContext.innerCtScrollPos=this.getScrollPosition(),this.callParent(arguments)},completeLayout:function(ownerContext){var last,me=this,plan=ownerContext.state.boxPlan,names=me.layout.names;plan&&plan.tooNarrow&&(last=ownerContext.childItems[ownerContext.childItems.length-1],me.scrollSize=last.props[names.x]+last.props[names.width],me.updateScrollButtons()),this.callParent(arguments)},finishedLayout:function(ownerContext){var me=this,layout=me.layout,scrollPos=Math.min(me.getMaxScrollPosition(),ownerContext.innerCtScrollPos);layout.innerCt[layout.names.setScrollLeft](scrollPos)},handleOverflow:function(ownerContext){var me=this,methodName=me.layout.names.getWidth;return me.showScrollers(),{reservedSpace:me.beforeCt[methodName]()+me.afterCt[methodName]()}},captureChildElements:function(){var before,after,hoverCls,pressedSuffix,pressedCls,hoverSuffix,me=this,el=me.layout.owner.el;me.beforeCt||(hoverSuffix="-hover",pressedSuffix="-pressed",hoverCls=me.scrollerCls+hoverSuffix,pressedCls=me.scrollerCls+pressedSuffix,before=me.beforeScroller=el.getById(me.layout.owner.id+"-before-scroller"),after=me.afterScroller=el.getById(me.layout.owner.id+"-after-scroller"),me.beforeCt=before.up(""),me.afterCt=after.up(""),me.createWheelListener(),before.addClsOnOver(hoverCls),before.addClsOnOver(me.beforeScrollerCls+hoverSuffix),before.addClsOnClick(pressedCls),before.addClsOnClick(me.beforeScrollerCls+pressedSuffix),after.addClsOnOver(hoverCls),after.addClsOnOver(me.afterScrollerCls+hoverSuffix),after.addClsOnClick(pressedCls),after.addClsOnClick(me.afterScrollerCls+pressedSuffix),before.setVisibilityMode(Ext.Element.DISPLAY),after.setVisibilityMode(Ext.Element.DISPLAY),me.beforeRepeater=new Ext.util.ClickRepeater(before,{interval:me.scrollRepeatInterval,handler:me.scrollLeft,scope:me}),me.afterRepeater=new Ext.util.ClickRepeater(after,{interval:me.scrollRepeatInterval,handler:me.scrollRight,scope:me}))},createWheelListener:function(){var me=this;me.layout.innerCt.on({mousewheel:function(e){me.scrollBy(me.getWheelDelta(e)*me.wheelIncrement*-1,!1)},stopEvent:!0})},getWheelDelta:function(e){return e.getWheelDelta()},clearOverflow:function(){this.hideScrollers()},showScrollers:function(){var me=this;me.captureChildElements(),me.beforeScroller.show(),me.afterScroller.show(),me.layout.owner.addClsWithUI("vertical"===me.layout.direction?"vertical-scroller":"scroller")},hideScrollers:function(){var me=this;void 0!==me.beforeScroller&&(me.beforeScroller.hide(),me.afterScroller.hide(),me.layout.owner.removeClsWithUI("vertical"===me.layout.direction?"vertical-scroller":"scroller"))},destroy:function(){var me=this;Ext.destroy(me.beforeRepeater,me.afterRepeater,me.beforeScroller,me.afterScroller,me.beforeCt,me.afterCt)},scrollBy:function(delta,animate){this.scrollTo(this.getScrollPosition()+delta,animate)},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){var beforeMeth,afterMeth,beforeCls,afterCls,disabledCls,me=this,suffix="-disabled";null!=me.beforeScroller&&null!=me.afterScroller&&(beforeMeth=me.atExtremeBefore()?"addCls":"removeCls",afterMeth=me.atExtremeAfter()?"addCls":"removeCls",disabledCls=me.scrollerCls+suffix,beforeCls=[disabledCls,me.beforeScrollerCls+suffix],afterCls=[disabledCls,me.afterScrollerCls+suffix],me.beforeScroller[beforeMeth](beforeCls),me.afterScroller[afterMeth](afterCls),me.scrolling=!1)},scrollLeft:function(){this.scrollBy(-this.scrollIncrement,!1)},scrollRight:function(){this.scrollBy(this.scrollIncrement,!1)},getScrollPosition:function(){var result,me=this,layout=me.layout;return result=isNaN(me.scrollPosition)?layout.innerCt[layout.names.getScrollLeft]():me.scrollPosition},getMaxScrollPosition:function(){var me=this,layout=me.layout,maxScrollPos=me.scrollSize-layout.innerCt[layout.names.getWidth]();return maxScrollPos<0?0:maxScrollPos},atExtremeBefore:function(){return!this.getScrollPosition()},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollPosition()},scrollTo:function(position,animate){var me=this,layout=me.layout,names=layout.names,oldPosition=me.getScrollPosition(),newPosition=Ext.Number.constrain(position,0,me.getMaxScrollPosition());newPosition==oldPosition||me.scrolling||(me.scrollPosition=NaN,void 0===animate&&(animate=me.animateScroll),layout.innerCt[names.scrollTo](names.beforeScrollX,newPosition,!!animate&&me.getScrollAnim()),animate?me.scrolling=!0:me.updateScrollButtons(),me.fireEvent("scroll",me,newPosition,!!animate&&me.getScrollAnim()))},scrollToItem:function(item,animate){var visibility,box,newPos,me=this,layout=me.layout,owner=layout.owner,names=layout.names;item=me.getItem(item),void 0!==item&&(item==owner.items.first()?newPos=0:item===owner.items.last()?newPos=me.getMaxScrollPosition():(visibility=me.getItemVisibility(item),visibility.fullyVisible||(box=item.getBox(!1,!0),newPos=box[names.x],visibility.hiddenEnd&&(newPos-=me.layout.innerCt[names.getWidth]()-box[names.width]))),void 0!==newPos&&me.scrollTo(newPos,animate))},getItemVisibility:function(item){var me=this,box=me.getItem(item).getBox(!0,!0),layout=me.layout,names=layout.names,itemStart=box[names.x],itemEnd=itemStart+box[names.width],scrollStart=me.getScrollPosition(),scrollEnd=scrollStart+layout.innerCt[names.getWidth]();return{hiddenStart:itemStart<scrollStart,hiddenEnd:itemEnd>scrollEnd,fullyVisible:itemStart>scrollStart&&itemEnd<scrollEnd}}}),Ext.define("Ext.util.Offset",{statics:{fromObject:function(obj){return new this(obj.x,obj.y)}},constructor:function(x,y){return this.x=null==x||isNaN(x)?0:x,this.y=null==y||isNaN(y)?0:y,this},copy:function(){return new Ext.util.Offset(this.x,this.y)},copyFrom:function(p){this.x=p.x,this.y=p.y},toString:function(){return"Offset["+this.x+","+this.y+"]"},equals:function(offset){return this.x==offset.x&&this.y==offset.y},round:function(to){if(isNaN(to))this.x=Math.round(this.x),this.y=Math.round(this.y);else{var factor=Math.pow(10,to);this.x=Math.round(this.x*factor)/factor,this.y=Math.round(this.y*factor)/factor}},isZero:function(){return 0==this.x&&0==this.y}}),Ext.define("Ext.util.Region",{statics:{getRegion:function(el){return Ext.fly(el).getRegion()},from:function(o){return new this(o.top,o.right,o.bottom,o.left)}},constructor:function(t,r,b,l){var me=this;me.y=me.top=me[1]=t,me.right=r,me.bottom=b,me.x=me.left=me[0]=l},contains:function(region){var me=this;return region.x>=me.x&&region.right<=me.right&&region.y>=me.y&&region.bottom<=me.bottom},intersect:function(region){var me=this,t=Math.max(me.y,region.y),r=Math.min(me.right,region.right),b=Math.min(me.bottom,region.bottom),l=Math.max(me.x,region.x);return b>t&&r>l&&new this.self(t,r,b,l)},union:function(region){var me=this,t=Math.min(me.y,region.y),r=Math.max(me.right,region.right),b=Math.max(me.bottom,region.bottom),l=Math.min(me.x,region.x);return new this.self(t,r,b,l)},constrainTo:function(r){var me=this,constrain=Ext.Number.constrain;return me.top=me.y=constrain(me.top,r.y,r.bottom),me.bottom=constrain(me.bottom,r.y,r.bottom),me.left=me.x=constrain(me.left,r.x,r.right),me.right=constrain(me.right,r.x,r.right),me},adjust:function(t,r,b,l){var me=this;return me.top=me.y+=t,me.left=me.x+=l,me.right+=r,me.bottom+=b,me},getOutOfBoundOffset:function(axis,p){if(Ext.isObject(axis)){p=axis;var d=new Ext.util.Offset;return d.x=this.getOutOfBoundOffsetX(p.x),d.y=this.getOutOfBoundOffsetY(p.y),d}return"x"==axis?this.getOutOfBoundOffsetX(p):this.getOutOfBoundOffsetY(p)},getOutOfBoundOffsetX:function(p){return p<=this.x?this.x-p:p>=this.right?this.right-p:0},getOutOfBoundOffsetY:function(p){return p<=this.y?this.y-p:p>=this.bottom?this.bottom-p:0},isOutOfBound:function(axis,p){return Ext.isObject(axis)?(p=axis,this.isOutOfBoundX(p.x)||this.isOutOfBoundY(p.y)):"x"==axis?this.isOutOfBoundX(p):this.isOutOfBoundY(p)},isOutOfBoundX:function(p){return p<this.x||p>this.right},isOutOfBoundY:function(p){return p<this.y||p>this.bottom},restrict:function(axis,p,factor){if(Ext.isObject(axis)){var newP;return factor=p,p=axis,newP=p.copy?p.copy():{x:p.x,y:p.y},newP.x=this.restrictX(p.x,factor),newP.y=this.restrictY(p.y,factor),newP}return"x"==axis?this.restrictX(p,factor):this.restrictY(p,factor)},restrictX:function(p,factor){return factor||(factor=1),p<=this.x?p-=(p-this.x)*factor:p>=this.right&&(p-=(p-this.right)*factor),p},restrictY:function(p,factor){return factor||(factor=1),p<=this.y?p-=(p-this.y)*factor:p>=this.bottom&&(p-=(p-this.bottom)*factor),p},getSize:function(){return{width:this.right-this.x,height:this.bottom-this.y}},copy:function(){return new this.self(this.y,this.right,this.bottom,this.x)},copyFrom:function(p){var me=this;return me.top=me.y=me[1]=p.y,me.right=p.right,me.bottom=p.bottom,me.left=me.x=me[0]=p.x,this},toString:function(){return"Region["+this.top+","+this.right+","+this.bottom+","+this.left+"]"},translateBy:function(x,y){1==arguments.length&&(y=x.y,x=x.x);var me=this;return me.top=me.y+=y,me.right+=x,me.bottom+=y,me.left=me.x+=x,me},round:function(){var me=this;return me.top=me.y=Math.round(me.y),me.right=Math.round(me.right),me.bottom=Math.round(me.bottom),me.left=me.x=Math.round(me.x),me},equals:function(region){return this.top==region.top&&this.right==region.right&&this.bottom==region.bottom&&this.left==region.left}}),Ext.define("Ext.dd.DragDropManager",{singleton:!0,alternateClassName:["Ext.dd.DragDropMgr","Ext.dd.DDM"],ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:!0,stopPropagation:!0,initialized:!1,locked:!1,init:function(){this.initialized=!0},POINT:0,INTERSECT:1,mode:0,notifyOccluded:!1,dragCls:Ext.baseCSSPrefix+"dd-drag-current",_execOnAll:function(sMethod,args){var i,j,oDD,item,ids=this.ids;for(i in ids)if(ids.hasOwnProperty(i)){item=ids[i];for(j in item)if(item.hasOwnProperty(j)){if(oDD=item[j],!this.isTypeOfDD(oDD))continue;oDD[sMethod].apply(oDD,args)}}},_onLoad:function(){this.init();var Event=Ext.EventManager;Event.on(document,"mouseup",this.handleMouseUp,this,!0),Event.on(document,"mousemove",this.handleMouseMove,this,!0),Event.on(window,"unload",this._onUnload,this,!0),Event.on(window,"resize",this._onResize,this,!0)},_onResize:function(e){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},locationCache:{},useCache:!0,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:!1,clickTimeout:null,startX:0,startY:0,regDragDrop:function(oDD,sGroup){this.initialized||this.init(),this.ids[sGroup]||(this.ids[sGroup]={}),this.ids[sGroup][oDD.id]=oDD},removeDDFromGroup:function(oDD,sGroup){this.ids[sGroup]||(this.ids[sGroup]={});var obj=this.ids[sGroup];obj&&obj[oDD.id]&&delete obj[oDD.id]},_remove:function(oDD,clearGroup){if(!this.clearingAll){var g,ids=this.ids,groups=oDD.groups;for(g in groups)groups.hasOwnProperty(g)&&(clearGroup?delete ids[g]:ids[g]&&delete ids[g][oDD.id]);delete this.handleIds[oDD.id]}},regHandle:function(sDDId,sHandleId){this.handleIds[sDDId]||(this.handleIds[sDDId]={}),this.handleIds[sDDId][sHandleId]=sHandleId},isDragDrop:function(id){return!!this.getDDById(id)},getRelated:function(p_oDD,bTargetsOnly){var i,j,dd,oDDs=[];for(i in p_oDD.groups)for(j in this.ids[i])dd=this.ids[i][j],this.isTypeOfDD(dd)&&(bTargetsOnly&&!dd.isTarget||(oDDs[oDDs.length]=dd));return oDDs},isLegalTarget:function(oDD,oTargetDD){var i,len,targets=this.getRelated(oDD,!0);for(i=0,len=targets.length;i<len;++i)if(targets[i].id==oTargetDD.id)return!0;return!1},isTypeOfDD:function(oDD){return oDD&&oDD.__ygDragDrop},isHandle:function(sDDId,sHandleId){return this.handleIds[sDDId]&&this.handleIds[sDDId][sHandleId]},getDDById:function(id){var i,dd;for(i in this.ids)if(dd=this.ids[i][id],dd instanceof Ext.dd.DDTarget)return dd;return null},handleMouseDown:function(e,oDD){var el,me=this;Ext.quickTipsActive&&Ext.tip.QuickTipManager.ddDisable(),me.dragCurrent&&me.handleMouseUp(e),me.mousedownEvent=e.clone(),me.currentTarget=e.getTarget(),me.dragCurrent=oDD,el=oDD.getEl(),Ext.isIE9m&&el.setCapture&&el.setCapture(),me.startX=e.getPageX(),me.startY=e.getPageY(),me.deltaX=me.startX-el.offsetLeft,me.deltaY=me.startY-el.offsetTop,me.dragThreshMet=!1,me.clickTimeout=setTimeout(function(){me.startDrag(me.startX,me.startY)},me.clickTimeThresh)},startDrag:function(x,y){var dragEl,me=this,current=me.dragCurrent;clearTimeout(me.clickTimeout),current&&(current.b4StartDrag(x,y),current.startDrag(x,y),dragEl=current.getDragEl(),dragEl&&Ext.fly(dragEl).addCls(me.dragCls)),me.dragThreshMet=!0},handleMouseUp:function(e){var me=this;Ext.quickTipsActive&&Ext.tip.QuickTipManager.ddEnable(),me.dragCurrent&&(Ext.isIE&&document.releaseCapture&&document.releaseCapture(),clearTimeout(me.clickTimeout),me.dragThreshMet&&me.fireEvents(e,!0),me.stopDrag(e),me.stopEvent(e))},stopEvent:function(e){this.stopPropagation&&e.stopPropagation(),this.preventDefault&&e.preventDefault()},stopDrag:function(e){var dragEl,me=this,current=me.dragCurrent;current&&(me.dragThreshMet&&(dragEl=current.getDragEl(),dragEl&&Ext.fly(dragEl).removeCls(me.dragCls),current.b4EndDrag(e),current.endDrag(e)),me.dragCurrent.onMouseUp(e)),me.dragCurrent=null,me.dragOvers={}},handleMouseMove:function(e){var diffX,diffY,me=this,current=me.dragCurrent;return!current||(me.dragThreshMet||(diffX=Math.abs(me.startX-e.getPageX()),diffY=Math.abs(me.startY-e.getPageY()),(diffX>me.clickPixelThresh||diffY>me.clickPixelThresh)&&me.startDrag(me.startX,me.startY)),me.dragThreshMet&&(current.b4Drag(e),current.onDrag(e),current.moveOnly||me.fireEvents(e,!1)),me.stopEvent(e),!0)},fireEvents:function(e,isDrop){var dragEl,oldDragElTop,overTarget,overTargetEl,xy,needsSort,i,len,sGroup,me=this,dragCurrent=me.dragCurrent,mousePoint=e.getPoint(),allTargets=[],oldOvers=[],outEvts=[],overEvts=[],dropEvts=[],enterEvts=[];if(dragCurrent&&!dragCurrent.isLocked()){me.notifyOccluded||Ext.supports.PointerEvents&&!Ext.isIE10m&&!Ext.isOpera||dragCurrent.deltaX<0||dragCurrent.deltaY<0||(dragEl=dragCurrent.getDragEl(),oldDragElTop=dragEl.style.top,dragEl.style.top="-10000px",xy=e.getXY(),e.target=document.elementFromPoint(xy[0],xy[1]),dragEl.style.top=oldDragElTop);for(i in me.dragOvers)overTarget=me.dragOvers[i],me.isTypeOfDD(overTarget)&&(me.notifyOccluded?this.isOverTarget(mousePoint,overTarget,me.mode)||outEvts.push(overTarget):e.within(overTarget.getEl())||outEvts.push(overTarget),oldOvers[i]=!0,delete me.dragOvers[i]);for(sGroup in dragCurrent.groups)if("string"==typeof sGroup)for(i in me.ids[sGroup])if(overTarget=me.ids[sGroup][i],me.isTypeOfDD(overTarget)&&(overTargetEl=overTarget.getEl())&&overTarget.isTarget&&!overTarget.isLocked()&&Ext.fly(overTargetEl).isVisible(!0)&&(overTarget!=dragCurrent||dragCurrent.ignoreSelf===!1))if(me.notifyOccluded)(overTarget.zIndex=me.getZIndex(overTargetEl))!==-1&&(needsSort=!0),allTargets.push(overTarget);else if(e.within(overTarget.getEl())){allTargets.push(overTarget);break}for(needsSort&&Ext.Array.sort(allTargets,me.byZIndex),i=0,len=allTargets.length;i<len&&(overTarget=allTargets[i],!me.isOverTarget(mousePoint,overTarget,me.mode)||(isDrop?dropEvts.push(overTarget):(oldOvers[overTarget.id]?overEvts.push(overTarget):enterEvts.push(overTarget),me.dragOvers[overTarget.id]=overTarget),me.notifyOccluded));i++);if(me.mode)outEvts.length&&(dragCurrent.b4DragOut(e,outEvts),dragCurrent.onDragOut(e,outEvts)),enterEvts.length&&dragCurrent.onDragEnter(e,enterEvts),overEvts.length&&(dragCurrent.b4DragOver(e,overEvts),dragCurrent.onDragOver(e,overEvts)),dropEvts.length&&(dragCurrent.b4DragDrop(e,dropEvts),dragCurrent.onDragDrop(e,dropEvts));else{for(i=0,len=outEvts.length;i<len;++i)dragCurrent.b4DragOut(e,outEvts[i].id),dragCurrent.onDragOut(e,outEvts[i].id);for(i=0,len=enterEvts.length;i<len;++i)dragCurrent.onDragEnter(e,enterEvts[i].id);for(i=0,len=overEvts.length;i<len;++i)dragCurrent.b4DragOver(e,overEvts[i].id),dragCurrent.onDragOver(e,overEvts[i].id);for(i=0,len=dropEvts.length;i<len;++i)dragCurrent.b4DragDrop(e,dropEvts[i].id),dragCurrent.onDragDrop(e,dropEvts[i].id)}isDrop&&!dropEvts.length&&dragCurrent.onInvalidDrop(e)}},getZIndex:function(element){var z,body=document.body,zIndex=-1;for(element=Ext.getDom(element);element!==body;)isNaN(z=Number(Ext.fly(element).getStyle("zIndex")))||(zIndex=z),element=element.parentNode;return zIndex},byZIndex:function(d1,d2){return d1.zIndex<d2.zIndex},getBestMatch:function(dds){var i,dd,winner=null,len=dds.length;if(1==len)winner=dds[0];else for(i=0;i<len;++i){if(dd=dds[i],dd.cursorIsOver){winner=dd;break}(!winner||winner.overlap.getArea()<dd.overlap.getArea())&&(winner=dd)}return winner},refreshCache:function(groups){var sGroup,i,oDD,loc;for(sGroup in groups)if("string"==typeof sGroup)for(i in this.ids[sGroup])oDD=this.ids[sGroup][i],this.isTypeOfDD(oDD)&&(loc=this.getLocation(oDD),loc?this.locationCache[oDD.id]=loc:delete this.locationCache[oDD.id])},verifyEl:function(el){if(el){var parent;if(Ext.isIE)try{parent=el.offsetParent}catch(e){}else parent=el.offsetParent;if(parent)return!0}return!1},getLocation:function(oDD){if(!this.isTypeOfDD(oDD))return null;if(oDD.getRegion)return oDD.getRegion();var pos,x1,x2,y1,y2,t,r,b,l,el=oDD.getEl();try{pos=Ext.Element.getXY(el)}catch(e){}return pos?(x1=pos[0],x2=x1+el.offsetWidth,y1=pos[1],y2=y1+el.offsetHeight,t=y1-oDD.padding[0],r=x2+oDD.padding[1],b=y2+oDD.padding[2],l=x1-oDD.padding[3],new Ext.util.Region(t,r,b,l)):null},isOverTarget:function(pt,oTarget,intersect){var dc,pos,el,curRegion,overlap,loc=this.locationCache[oTarget.id];return loc&&this.useCache||(loc=this.getLocation(oTarget),this.locationCache[oTarget.id]=loc),!!loc&&(oTarget.cursorIsOver=loc.contains(pt),dc=this.dragCurrent,dc&&dc.getTargetCoord&&(intersect||dc.constrainX||dc.constrainY)?(oTarget.overlap=null,pos=dc.getTargetCoord(pt.x,pt.y),el=dc.getDragEl(),curRegion=new Ext.util.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x),overlap=curRegion.intersect(loc),!!overlap&&(oTarget.overlap=overlap,!!intersect||oTarget.cursorIsOver)):oTarget.cursorIsOver)},_onUnload:function(e,me){Ext.dd.DragDropManager.unregAll()},unregAll:function(){var i,me=this,cache=me.elementCache;me.dragCurrent&&(me.stopDrag(),me.dragCurrent=null),me.clearingAll=!0,me._execOnAll("unreg",[]),delete me.clearingAll;for(i in cache)delete cache[i];me.elementCache={},me.ids={},me.handleIds={}},elementCache:{},getElWrapper:function(id){var oWrapper=this.elementCache[id];return oWrapper&&oWrapper.el||(oWrapper=this.elementCache[id]=new this.ElementWrapper(Ext.getDom(id))),oWrapper},getElement:function(id){return Ext.getDom(id)},getCss:function(id){var el=Ext.getDom(id);return el?el.style:null},ElementWrapper:function(el){this.el=el||null,this.id=this.el&&el.id,this.css=this.el&&el.style},getPosX:function(el){return Ext.Element.getX(el)},getPosY:function(el){return Ext.Element.getY(el)},swapNode:function(n1,n2){if(n1.swapNode)n1.swapNode(n2);else{var p=n2.parentNode,s=n2.nextSibling;s==n1?p.insertBefore(n1,n2):n2==n1.nextSibling?p.insertBefore(n2,n1):(n1.parentNode.replaceChild(n2,n1),p.insertBefore(n1,s))}},getScroll:function(){var doc=window.document,docEl=doc.documentElement,body=doc.body,top=0,left=0;return Ext.isGecko4?(top=window.scrollYOffset,left=window.scrollXOffset):docEl&&(docEl.scrollTop||docEl.scrollLeft)?(top=docEl.scrollTop,left=docEl.scrollLeft):body&&(top=body.scrollTop,left=body.scrollLeft),{top:top,left:left}},getStyle:function(el,styleProp){return Ext.fly(el).getStyle(styleProp)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(moveEl,targetEl){var aCoord=Ext.Element.getXY(targetEl);Ext.Element.setXY(moveEl,aCoord)},numericSort:function(a,b){return a-b},_timeoutCount:0,_addListeners:function(){document?this._onLoad():this._timeoutCount<=2e3&&(setTimeout(this._addListeners,10),document&&document.body&&(this._timeoutCount+=1))},handleWasClicked:function(node,id){if(this.isHandle(id,node.id))return!0;for(var p=node.parentNode;p;){if(this.isHandle(id,p.id))return!0;p=p.parentNode}return!1}},function(){this._addListeners()}),Ext.define("Ext.layout.container.Box",{alias:["layout.box"],extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.BoxLayout",defaultMargins:{top:0,right:0,bottom:0,left:0},padding:0,pack:"start",flex:void 0,stretchMaxPartner:void 0,alignRoundingMethod:"round",type:"box",scrollOffset:0,itemCls:Ext.baseCSSPrefix+"box-item",targetCls:Ext.baseCSSPrefix+"box-layout-ct",targetElCls:Ext.baseCSSPrefix+"box-target",innerCls:Ext.baseCSSPrefix+"box-inner",availableSpaceOffset:0,reserveOffset:!0,manageMargins:!0,createsInnerCt:!0,childEls:["innerCt","targetEl"],renderTpl:["{%var oc,l=values.$comp.layout,oh=l.overflowHandler;","if (oh.getPrefixConfig!==Ext.emptyFn) {","if(oc=oh.getPrefixConfig())dh.generateMarkup(oc, out)","}%}",'<div id="{ownerId}-innerCt" class="{[l.innerCls]} {[oh.getOverflowCls()]}" role="presentation">','<div id="{ownerId}-targetEl" class="{targetElCls}" role="presentation">',"{%this.renderBody(out, values)%}","</div>","</div>","{%if (oh.getSuffixConfig!==Ext.emptyFn) {","if(oc=oh.getSuffixConfig())dh.generateMarkup(oc, out)","}%}",{disableFormats:!0,definitions:"var dh=Ext.DomHelper;"}],constructor:function(config){var type,me=this;me.callParent(arguments),me.flexSortFn=Ext.Function.bind(me.flexSort,me),me.initOverflowHandler(),type=typeof me.padding,"string"!=type&&"number"!=type||(me.padding=Ext.util.Format.parseBox(me.padding),me.padding.height=me.padding.top+me.padding.bottom,me.padding.width=me.padding.left+me.padding.right)},_percentageRe:/^\s*(\d+(?:\.\d*)?)\s*[%]\s*$/,getItemSizePolicy:function(item,ownerSizeModel){var me=this,policy=me.sizePolicy,align=me.align,flex=item.flex,key=align,names=me.names,width=item[names.width],height=item[names.height],percentageRe=me._percentageRe,percentageWidth=percentageRe.test(width),isStretch="stretch"==align,isStretchMax="stretchmax"==align,constrain=me.constrainAlign;return!ownerSizeModel&&(isStretch||flex||percentageWidth||constrain&&!isStretchMax)&&(ownerSizeModel=me.owner.getSizeModel()),isStretch?!percentageRe.test(height)&&ownerSizeModel[names.height].shrinkWrap&&(key="stretchmax"):isStretchMax||(key=percentageRe.test(height)?"stretch":constrain&&!ownerSizeModel[names.height].shrinkWrap?"stretchmax":""),(flex||percentageWidth)&&(ownerSizeModel[names.width].shrinkWrap||(policy=policy.flex)),policy[key]},flexSort:function(a,b){var aMin,bMin,aMax,bMax,hasMin,hasMax,maxWidthName=this.names.maxWidth,minWidthName=this.names.minWidth,infiniteValue=1/0,aTarget=a.target,bTarget=b.target,result=0;return aMax=aTarget[maxWidthName]||infiniteValue,bMax=bTarget[maxWidthName]||infiniteValue,aMin=aTarget[minWidthName]||0,bMin=bTarget[minWidthName]||0,hasMin=isFinite(aMin)||isFinite(bMin),hasMax=isFinite(aMax)||isFinite(bMax),(hasMin||hasMax)&&(hasMax&&(result=aMax-bMax),0===result&&hasMin&&(result=bMin-aMin)),result},isItemBoxParent:function(itemContext){return!0},isItemShrinkWrap:function(item){return!0},roundFlex:function(width){return Math.ceil(width)},beginCollapse:function(child){var me=this;"vertical"===me.direction&&child.collapsedVertical()?(child.collapseMemento.capture(["flex"]),delete child.flex):"horizontal"===me.direction&&child.collapsedHorizontal()&&(child.collapseMemento.capture(["flex"]),delete child.flex)},beginExpand:function(child){child.collapseMemento.restore(["flex"])},beginLayout:function(ownerContext){var me=this,owner=me.owner,smp=owner.stretchMaxPartner,style=me.innerCt.dom.style,names=me.names;ownerContext.boxNames=names,me.overflowHandler.beginLayout(ownerContext),"string"==typeof smp&&(smp=Ext.getCmp(smp)||owner.query(smp)[0]),ownerContext.stretchMaxPartner=smp&&ownerContext.context.getCmp(smp),me.callParent(arguments),ownerContext.innerCtContext=ownerContext.getEl("innerCt",me),me.scrollParallel=owner.scrollFlags[names.x],me.scrollPerpendicular=owner.scrollFlags[names.y],me.scrollParallel&&(me.scrollPos=owner.getTargetEl().dom[names.scrollLeft]),style.width="",style.height=""},beginLayoutCycle:function(ownerContext,firstCycle){var me=this,align=me.align,names=ownerContext.boxNames,pack=me.pack,heightModelName=names.heightModel;me.overflowHandler.beginLayoutCycle(ownerContext,firstCycle),me.callParent(arguments),ownerContext.parallelSizeModel=ownerContext[names.widthModel],ownerContext.perpendicularSizeModel=ownerContext[heightModelName],ownerContext.boxOptions={align:align={stretch:"stretch"==align,stretchmax:"stretchmax"==align,center:align==names.center,bottom:align==names.afterY},pack:pack={center:"center"==pack,end:"end"==pack}},align.stretch&&ownerContext.perpendicularSizeModel.shrinkWrap&&(align.stretchmax=!0,align.stretch=!1),align.nostretch=!(align.stretch||align.stretchmax),ownerContext.parallelSizeModel.shrinkWrap&&(pack.center=pack.end=!1),me.cacheFlexes(ownerContext),me.targetEl.setWidth(2e4)},cacheFlexes:function(ownerContext){for(var child,childContext,flex,match,me=this,names=ownerContext.boxNames,widthModelName=names.widthModel,heightModelName=names.heightModel,nostretch=ownerContext.boxOptions.align.nostretch,totalFlex=0,childItems=ownerContext.childItems,i=childItems.length,flexedItems=[],minWidth=0,minWidthName=names.minWidth,percentageRe=me._percentageRe,percentageWidths=0,percentageHeights=0;i--;)childContext=childItems[i],child=childContext.target,childContext[widthModelName].calculated&&(childContext.flex=flex=child.flex,flex?(totalFlex+=flex,flexedItems.push(childContext),minWidth+=child[minWidthName]||0):(match=percentageRe.exec(child[names.width]),childContext.percentageParallel=parseFloat(match[1])/100,++percentageWidths)),nostretch&&childContext[heightModelName].calculated&&(match=percentageRe.exec(child[names.height]),childContext.percentagePerpendicular=parseFloat(match[1])/100,++percentageHeights);ownerContext.flexedItems=flexedItems,ownerContext.flexedMinSize=minWidth,ownerContext.totalFlex=totalFlex,ownerContext.percentageWidths=percentageWidths,ownerContext.percentageHeights=percentageHeights,Ext.Array.sort(flexedItems,me.flexSortFn)},calculate:function(ownerContext){var me=this,targetSize=me.getContainerSize(ownerContext),names=ownerContext.boxNames,state=ownerContext.state,plan=state.boxPlan||(state.boxPlan={}),targetContext=ownerContext.targetContext;plan.targetSize=targetSize,state.parallelDone||(state.parallelDone=me.calculateParallel(ownerContext,names,plan)),state.perpendicularDone||(state.perpendicularDone=me.calculatePerpendicular(ownerContext,names,plan)),state.parallelDone&&state.perpendicularDone?(!me.owner.dock||!Ext.isIE7m&&!Ext.isIEQuirks||me.owner.width||me.horizontal||(plan.isIEVerticalDock=!0,plan.calculatedWidth=plan.maxSize+ownerContext.getPaddingInfo().width+ownerContext.getFrameInfo().width,targetContext!==ownerContext&&(plan.calculatedWidth+=targetContext.getPaddingInfo().width)),me.publishInnerCtSize(ownerContext,me.reserveOffset?me.availableSpaceOffset:0),me.done&&ownerContext.boxOptions.align.stretchmax&&!state.stretchMaxDone&&(me.calculateStretchMax(ownerContext,names,plan),state.stretchMaxDone=!0),me.overflowHandler.calculate(ownerContext)):me.done=!1},calculateParallel:function(ownerContext,names,plan){var i,childMargins,remainingWidth,remainingFlex,childContext,flex,flexedWidth,contentWidth,mayNeedScrollbarAdjust,childWidth,percentageSpace,me=this,widthName=names.width,childItems=ownerContext.childItems,beforeXName=names.beforeX,afterXName=names.afterX,setWidthName=names.setWidth,childItemsLength=childItems.length,flexedItems=ownerContext.flexedItems,flexedItemsLength=flexedItems.length,pack=ownerContext.boxOptions.pack,padding=me.padding,targetSize=plan.targetSize,containerWidth=targetSize[widthName],totalMargin=0,left=padding[beforeXName],nonFlexWidth=left+padding[afterXName]+me.scrollOffset+(me.reserveOffset?me.availableSpaceOffset:0),scrollbarWidth=Ext.getScrollbarSize()[names.width];if(!ownerContext.parallelSizeModel.shrinkWrap&&!targetSize[names.gotWidth])return!1;if(scrollbarWidth&&me.scrollPerpendicular&&ownerContext.parallelSizeModel.shrinkWrap&&!ownerContext.boxOptions.align.stretch&&!ownerContext.perpendicularSizeModel.shrinkWrap){if(!ownerContext.state.perpendicularDone)return!1;mayNeedScrollbarAdjust=!0}for(i=0;i<childItemsLength;++i)if(childContext=childItems[i],childMargins=childContext.marginInfo||childContext.getMarginInfo(),totalMargin+=childMargins[widthName],!childContext[names.widthModel].calculated&&(childWidth=childContext.getProp(widthName),nonFlexWidth+=childWidth,isNaN(nonFlexWidth)))return!1;if(nonFlexWidth+=totalMargin,ownerContext.percentageWidths){if(percentageSpace=containerWidth-totalMargin,isNaN(percentageSpace))return!1;for(i=0;i<childItemsLength;++i)childContext=childItems[i],childContext.percentageParallel&&(childWidth=Math.ceil(percentageSpace*childContext.percentageParallel),childWidth=childContext.setWidth(childWidth),nonFlexWidth+=childWidth)}if(ownerContext.parallelSizeModel.shrinkWrap)plan.availableSpace=0,plan.tooNarrow=!1;else if(plan.availableSpace=containerWidth-nonFlexWidth,plan.tooNarrow=plan.availableSpace<ownerContext.flexedMinSize,plan.tooNarrow&&Ext.getScrollbarSize()[names.height]&&me.scrollParallel&&ownerContext.state.perpendicularDone)for(ownerContext.state.perpendicularDone=!1,
i=0;i<childItemsLength;++i)childItems[i].invalidate();for(contentWidth=nonFlexWidth,remainingWidth=plan.availableSpace,remainingFlex=ownerContext.totalFlex,i=0;i<flexedItemsLength;i++)childContext=flexedItems[i],flex=childContext.flex,flexedWidth=me.roundFlex(flex/remainingFlex*remainingWidth),flexedWidth=childContext[setWidthName](flexedWidth),contentWidth+=flexedWidth,remainingWidth=Math.max(0,remainingWidth-flexedWidth),remainingFlex-=flex;for(pack.center?(left+=remainingWidth/2,left<0&&(left=0)):pack.end&&(left+=remainingWidth),i=0;i<childItemsLength;++i)childContext=childItems[i],childMargins=childContext.marginInfo,left+=childMargins[beforeXName],childContext.setProp(names.x,left),left+=childMargins[afterXName]+childContext.props[widthName];return contentWidth+=ownerContext.targetContext.getPaddingInfo()[widthName],ownerContext.state.contentWidth=contentWidth,mayNeedScrollbarAdjust&&ownerContext.peek(names.contentHeight)>plan.targetSize[names.height]&&(contentWidth+=scrollbarWidth,ownerContext[names.hasOverflowY]=!0,ownerContext.target.componentLayout[names.setWidthInDom]=!0,ownerContext[names.invalidateScrollY]=Ext.isStrict&&Ext.isIE8),ownerContext[names.setContentWidth](contentWidth),!0},calculatePerpendicular:function(ownerContext,names,plan){var childTop,i,childHeight,childMargins,diff,height,childContext,stretchMaxPartner,stretchMaxChildren,shrinkWrapParallelOverflow,percentagePerpendicular,me=this,heightShrinkWrap=ownerContext.perpendicularSizeModel.shrinkWrap,targetSize=plan.targetSize,childItems=ownerContext.childItems,childItemsLength=childItems.length,mmax=Math.max,heightName=names.height,setHeightName=names.setHeight,beforeYName=names.beforeY,topPositionName=names.y,padding=me.padding,top=padding[beforeYName],availHeight=targetSize[heightName]-top-padding[names.afterY],align=ownerContext.boxOptions.align,isStretch=align.stretch,isStretchMax=align.stretchmax,isCenter=align.center,isBottom=align.bottom,constrain=me.constrainAlign,maxHeight=0,hasPercentageSizes=0,onBeforeInvalidateChild=me.onBeforeConstrainInvalidateChild,onAfterInvalidateChild=me.onAfterConstrainInvalidateChild,scrollbarHeight=Ext.getScrollbarSize().height;if((isStretch||(isCenter||isBottom)&&!heightShrinkWrap)&&isNaN(availHeight))return!1;if(!isStretch&&!ownerContext.parallelSizeModel.shrinkWrap&&!ownerContext.state.parallelDone&&me.scrollParallel)return!1;if(me.scrollParallel&&plan.tooNarrow&&(heightShrinkWrap?shrinkWrapParallelOverflow=!0:(availHeight-=scrollbarHeight,plan.targetSize[heightName]-=scrollbarHeight)),isStretch)height=availHeight;else{for(i=0;i<childItemsLength;i++){if(childContext=childItems[i],childMargins=(childContext.marginInfo||childContext.getMarginInfo())[heightName],percentagePerpendicular=childContext.percentagePerpendicular){if(++hasPercentageSizes,heightShrinkWrap)continue;childHeight=percentagePerpendicular*availHeight-childMargins,childHeight=childContext[names.setHeight](childHeight)}else childHeight=childContext.getProp(heightName);if(!heightShrinkWrap&&constrain&&childContext[names.heightModel].shrinkWrap&&childHeight>availHeight&&(childContext.invalidate({before:onBeforeInvalidateChild,after:onAfterInvalidateChild,layout:me,childHeight:availHeight,names:names}),ownerContext.state.parallelDone=!1),isNaN(maxHeight=mmax(maxHeight,childHeight+childMargins,childContext.target[names.minHeight]||0)))return!1}if(shrinkWrapParallelOverflow&&(maxHeight+=scrollbarHeight,ownerContext[names.hasOverflowX]=!0,ownerContext.target.componentLayout[names.setHeightInDom]=!0,ownerContext[names.invalidateScrollX]=Ext.isStrict&&Ext.isIE8),stretchMaxPartner=ownerContext.stretchMaxPartner,stretchMaxPartner&&(ownerContext.setProp("maxChildHeight",maxHeight),stretchMaxChildren=stretchMaxPartner.childItems,stretchMaxChildren&&stretchMaxChildren.length&&(maxHeight=mmax(maxHeight,stretchMaxPartner.getProp("maxChildHeight")),isNaN(maxHeight))))return!1;ownerContext[names.setContentHeight](maxHeight+me.padding[heightName]+ownerContext.targetContext.getPaddingInfo()[heightName]),shrinkWrapParallelOverflow&&(maxHeight-=scrollbarHeight),plan.maxSize=maxHeight,isStretchMax?height=maxHeight:(isCenter||isBottom||hasPercentageSizes)&&(height=constrain?heightShrinkWrap?maxHeight:availHeight:heightShrinkWrap?maxHeight:mmax(availHeight,maxHeight),height-=ownerContext.innerCtContext.getBorderInfo()[heightName])}for(i=0;i<childItemsLength;i++)childContext=childItems[i],childMargins=childContext.marginInfo||childContext.getMarginInfo(),childTop=top+childMargins[beforeYName],isStretch?childContext[setHeightName](height-childMargins[heightName]):(percentagePerpendicular=childContext.percentagePerpendicular,heightShrinkWrap&&percentagePerpendicular&&(childMargins=childContext.marginInfo||childContext.getMarginInfo(),childHeight=percentagePerpendicular*height-childMargins[heightName],childHeight=childContext.setHeight(childHeight)),isCenter?(diff=height-childContext.props[heightName],diff>0&&(childTop=top+Math[me.alignRoundingMethod](diff/2))):isBottom&&(childTop=mmax(0,height-childTop-childContext.props[heightName]))),childContext.setProp(topPositionName,childTop);return!0},onBeforeConstrainInvalidateChild:function(childContext,options){var heightModelName=options.names.heightModel;childContext[heightModelName].constrainedMin||(childContext[heightModelName]=Ext.layout.SizeModel.calculated)},onAfterConstrainInvalidateChild:function(childContext,options){var names=options.names;childContext.setProp(names.beforeY,0),childContext[names.heightModel].calculated&&childContext[names.setHeight](options.childHeight)},calculateStretchMax:function(ownerContext,names,plan){var childContext,props,i,childHeight,me=this,heightName=names.height,widthName=names.width,childItems=ownerContext.childItems,length=childItems.length,height=plan.maxSize,onBeforeStretchMaxInvalidateChild=me.onBeforeStretchMaxInvalidateChild,onAfterStretchMaxInvalidateChild=me.onAfterStretchMaxInvalidateChild;for(i=0;i<length;++i)childContext=childItems[i],props=childContext.props,childHeight=height-childContext.getMarginInfo()[heightName],(childHeight!=props[heightName]||childContext[names.heightModel].constrained)&&childContext.invalidate({before:onBeforeStretchMaxInvalidateChild,after:onAfterStretchMaxInvalidateChild,layout:me,childWidth:props[widthName],childHeight:childHeight,childX:props.x,childY:props.y,names:names})},onBeforeStretchMaxInvalidateChild:function(childContext,options){var heightModelName=options.names.heightModel;childContext[heightModelName].constrainedMax||(childContext[heightModelName]=Ext.layout.SizeModel.calculated)},onAfterStretchMaxInvalidateChild:function(childContext,options){var names=options.names,childHeight=options.childHeight,childWidth=options.childWidth;childContext.setProp("x",options.childX),childContext.setProp("y",options.childY),childContext[names.heightModel].calculated&&childContext[names.setHeight](childHeight),childContext[names.widthModel].calculated&&childContext[names.setWidth](childWidth)},completeLayout:function(ownerContext){var dom,el,overflowX,overflowY,styles,me=this,names=ownerContext.boxNames,invalidateScrollX=ownerContext.invalidateScrollX,invalidateScrollY=ownerContext.invalidateScrollY;me.overflowHandler.completeLayout(ownerContext),(invalidateScrollX||invalidateScrollY)&&(el=me.getTarget(),dom=el.dom,styles=dom.style,invalidateScrollX&&(overflowX=el.getStyle("overflowX"),"auto"==overflowX?(overflowX=styles.overflowX,styles.overflowX="scroll"):invalidateScrollX=!1),invalidateScrollY&&(overflowY=el.getStyle("overflowY"),"auto"==overflowY?(overflowY=styles.overflowY,styles.overflowY="scroll"):invalidateScrollY=!1),(invalidateScrollX||invalidateScrollY)&&(dom.scrollWidth,invalidateScrollX&&(styles.overflowX=overflowX),invalidateScrollY&&(styles.overflowY=overflowY))),me.scrollParallel&&(me.owner.getTargetEl().dom[names.scrollLeft]=me.scrollPos)},finishedLayout:function(ownerContext){this.overflowHandler.finishedLayout(ownerContext),this.callParent(arguments),this.targetEl.setWidth(ownerContext.innerCtContext.props.width)},publishInnerCtSize:function(ownerContext,reservedSpace){var innerCtHeight,me=this,names=ownerContext.boxNames,heightName=names.height,widthName=names.width,align=ownerContext.boxOptions.align,dock=me.owner.dock,padding=me.padding,plan=ownerContext.state.boxPlan,targetSize=plan.targetSize,height=targetSize[heightName],innerCtContext=ownerContext.innerCtContext,innerCtWidth=(ownerContext.parallelSizeModel.shrinkWrap||plan.tooNarrow&&me.scrollParallel?ownerContext.state.contentWidth-ownerContext.targetContext.getPaddingInfo()[widthName]:targetSize[widthName])-(reservedSpace||0);align.stretch?innerCtHeight=height:(innerCtHeight=plan.maxSize+padding[names.beforeY]+padding[names.afterY]+innerCtContext.getBorderInfo()[heightName],ownerContext.perpendicularSizeModel.shrinkWrap||!align.center&&!align.bottom||(innerCtHeight=Math.max(height,innerCtHeight))),innerCtContext[names.setWidth](innerCtWidth),innerCtContext[names.setHeight](innerCtHeight),isNaN(innerCtWidth+innerCtHeight)&&(me.done=!1),!plan.calculatedWidth||"left"!=dock&&"right"!=dock||ownerContext.setWidth(plan.calculatedWidth,!0,!0)},onRemove:function(comp,isDestroying){var el,me=this,names=me.names;me.callParent(arguments),me.overflowHandler&&me.overflowHandler.onRemove(comp),comp.layoutMarginCap==me.id&&delete comp.layoutMarginCap,me.owner.destroying||isDestroying||!comp.rendered||(el=comp.getEl(),el.setStyle(names.beforeY,""),el.setStyle(names.beforeX,""))},initOverflowHandler:function(){var handlerType,constructor,me=this,handler=me.overflowHandler;"string"==typeof handler&&(handler={type:handler}),handlerType="None",handler&&void 0!==handler.type&&(handlerType=handler.type),constructor=Ext.layout.container.boxOverflow[handlerType],constructor[me.type]&&(constructor=constructor[me.type]),me.overflowHandler=Ext.create("Ext.layout.container.boxOverflow."+handlerType,me,handler)},getRenderTarget:function(){return this.targetEl},getElementTarget:function(){return this.innerCt},destroy:function(){var me=this;Ext.destroy(me.innerCt,me.overflowHandler),me.flexSortFn=me.innerCt=null,me.callParent(arguments)},getRenderData:function(){var data=this.callParent();return data.targetElCls=this.targetElCls,data}}),Ext.define("Ext.layout.container.HBox",{alias:["layout.hbox"],extend:Ext.layout.container.Box,alternateClassName:"Ext.layout.HBoxLayout",align:"top",constrainAlign:!1,type:"hbox",direction:"horizontal",horizontal:!0,names:{beforeX:"left",beforeScrollX:"left",beforeScrollerSuffix:"-before-scroller",afterScrollerSuffix:"-after-scroller",leftCap:"Left",afterX:"right",width:"width",contentWidth:"contentWidth",minWidth:"minWidth",maxWidth:"maxWidth",widthCap:"Width",widthModel:"widthModel",widthIndex:0,x:"x",scrollLeft:"scrollLeft",overflowX:"overflowX",hasOverflowX:"hasOverflowX",invalidateScrollX:"invalidateScrollX",parallelMargins:"lr",center:"middle",beforeY:"top",afterY:"bottom",height:"height",contentHeight:"contentHeight",minHeight:"minHeight",maxHeight:"maxHeight",heightCap:"Height",heightModel:"heightModel",heightIndex:1,y:"y",overflowY:"overflowY",hasOverflowY:"hasOverflowY",invalidateScrollY:"invalidateScrollY",perpendicularMargins:"tb",getWidth:"getWidth",getHeight:"getHeight",setWidth:"setWidth",setHeight:"setHeight",gotWidth:"gotWidth",gotHeight:"gotHeight",setContentWidth:"setContentWidth",setContentHeight:"setContentHeight",setWidthInDom:"setWidthInDom",setHeightInDom:"setHeightInDom",getScrollLeft:"getScrollLeft",setScrollLeft:"setScrollLeft",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:1}}}),Ext.define("Ext.layout.container.VBox",{alias:["layout.vbox"],extend:Ext.layout.container.Box,alternateClassName:"Ext.layout.VBoxLayout",align:"left",constrainAlign:!1,type:"vbox",direction:"vertical",horizontal:!1,names:{beforeX:"top",beforeScrollX:"top",beforeScrollerSuffix:"-before-scroller",afterScrollerSuffix:"-after-scroller",leftCap:"Top",afterX:"bottom",width:"height",contentWidth:"contentHeight",minWidth:"minHeight",maxWidth:"maxHeight",widthCap:"Height",widthModel:"heightModel",widthIndex:1,x:"y",scrollLeft:"scrollTop",overflowX:"overflowY",hasOverflowX:"hasOverflowY",invalidateScrollX:"invalidateScrollY",parallelMargins:"tb",center:"center",beforeY:"left",afterY:"right",height:"width",contentHeight:"contentWidth",minHeight:"minWidth",maxHeight:"maxWidth",heightCap:"Width",heightModel:"widthModel",heightIndex:0,y:"x",overflowY:"overflowX",hasOverflowY:"hasOverflowX",invalidateScrollY:"invalidateScrollX",perpendicularMargins:"lr",getWidth:"getHeight",getHeight:"getWidth",setWidth:"setHeight",setHeight:"setWidth",gotWidth:"gotHeight",gotHeight:"gotWidth",setContentWidth:"setContentHeight",setContentHeight:"setContentWidth",setWidthInDom:"setHeightInDom",setHeightInDom:"setWidthInDom",getScrollLeft:"getScrollTop",setScrollLeft:"setScrollTop",scrollTo:"scrollTo"},sizePolicy:{flex:{"":{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},stretch:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1},stretchmax:{readsWidth:1,readsHeight:0,setsWidth:1,setsHeight:1}},"":{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},stretch:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},stretchmax:{readsWidth:1,readsHeight:1,setsWidth:1,setsHeight:0}}}),Ext.define("Ext.toolbar.Toolbar",{extend:Ext.container.Container,alias:"widget.toolbar",alternateClassName:"Ext.Toolbar",isToolbar:!0,baseCls:Ext.baseCSSPrefix+"toolbar",ariaRole:"toolbar",defaultType:"button",vertical:!1,enableOverflow:!1,menuTriggerCls:Ext.baseCSSPrefix+"toolbar-more-icon",trackMenus:!0,itemCls:Ext.baseCSSPrefix+"toolbar-item",statics:{shortcuts:{"-":"tbseparator"," ":"tbspacer"},shortcutsHV:{0:{"->":{xtype:"tbfill",height:0}},1:{"->":{xtype:"tbfill",width:0}}}},initComponent:function(){var me=this;!me.layout&&me.enableOverflow&&(me.layout={overflowHandler:"Menu"}),"right"!==me.dock&&"left"!==me.dock||(me.vertical=!0),me.layout=Ext.applyIf(Ext.isString(me.layout)?{type:me.layout}:me.layout||{},{type:me.vertical?"vbox":"hbox",align:me.vertical?"stretchmax":"middle"}),me.vertical&&me.addClsWithUI("vertical"),"footer"===me.ui&&(me.ignoreBorderManagement=!0),me.callParent(),me.addEvents("overflowchange")},getRefItems:function(deep){var handler,me=this,items=me.callParent(arguments),layout=me.layout;return deep&&me.enableOverflow&&(handler=layout.overflowHandler,handler&&handler.menu&&(items=items.concat(handler.menu.getRefItems(deep)))),items},lookupComponent:function(c){var args=arguments;if("string"==typeof c){var T=Ext.toolbar.Toolbar,shortcut=T.shortcutsHV[this.vertical?1:0][c]||T.shortcuts[c];c="string"==typeof shortcut?{xtype:shortcut}:shortcut?Ext.apply({},shortcut):{xtype:"tbtext",text:c},this.applyDefaults(c),args=[c]}return this.callParent(args)},applyDefaults:function(c){return Ext.isString(c)||(c=this.callParent(arguments)),c},trackMenu:function(item,remove){if(this.trackMenus&&item.menu){var method=remove?"mun":"mon",me=this;me[method](item,"mouseover",me.onButtonOver,me),me[method](item,"menushow",me.onButtonMenuShow,me),me[method](item,"menuhide",me.onButtonMenuHide,me)}},onBeforeAdd:function(component){var me=this,isButton=component.isButton;isButton&&me.defaultButtonUI&&"default"===component.ui&&!component.hasOwnProperty("ui")?component.ui=me.defaultButtonUI:(isButton||component.isFormField)&&"footer"!==me.ui&&(component.ui=component.ui+"-toolbar",component.addCls(component.baseCls+"-toolbar")),component instanceof Ext.toolbar.Separator&&component.setUI(me.vertical?"vertical":"horizontal"),me.callParent(arguments)},onAdd:function(component){this.callParent(arguments),this.trackMenu(component)},onRemove:function(c){this.callParent(arguments),this.trackMenu(c,!0)},getChildItemsToDisable:function(){return this.items.getRange()},onButtonOver:function(btn){this.activeMenuBtn&&this.activeMenuBtn!=btn&&(this.activeMenuBtn.hideMenu(),btn.showMenu(),this.activeMenuBtn=btn)},onButtonMenuShow:function(btn){this.activeMenuBtn=btn},onButtonMenuHide:function(btn){delete this.activeMenuBtn}}),Ext.define("Ext.layout.component.Dock",{extend:Ext.layout.component.Component,alias:"layout.dock",alternateClassName:"Ext.layout.component.AbstractDock",type:"dock",horzAxisProps:{name:"horz",oppositeName:"vert",dockBegin:"left",dockEnd:"right",horizontal:!0,marginBegin:"margin-left",maxSize:"maxWidth",minSize:"minWidth",pos:"x",setSize:"setWidth",shrinkWrapDock:"shrinkWrapDockWidth",size:"width",sizeModel:"widthModel"},vertAxisProps:{name:"vert",oppositeName:"horz",dockBegin:"top",dockEnd:"bottom",horizontal:!1,marginBegin:"margin-top",maxSize:"maxHeight",minSize:"minHeight",pos:"y",setSize:"setHeight",shrinkWrapDock:"shrinkWrapDockHeight",size:"height",sizeModel:"heightModel"},initializedBorders:-1,horizontalCollapsePolicy:{width:!0,x:!0},verticalCollapsePolicy:{height:!0,y:!0},finishRender:function(){var target,items,me=this;me.callParent(),target=me.getRenderTarget(),items=me.getDockedItems(),me.finishRenderItems(target,items)},isItemBoxParent:function(itemContext){return!0},isItemShrinkWrap:function(item){return!0},noBorderClasses:[Ext.baseCSSPrefix+"docked-noborder-top",Ext.baseCSSPrefix+"docked-noborder-right",Ext.baseCSSPrefix+"docked-noborder-bottom",Ext.baseCSSPrefix+"docked-noborder-left"],noBorderClassesSides:{top:Ext.baseCSSPrefix+"docked-noborder-top",right:Ext.baseCSSPrefix+"docked-noborder-right",bottom:Ext.baseCSSPrefix+"docked-noborder-bottom",left:Ext.baseCSSPrefix+"docked-noborder-left"},borderWidthProps:{top:"border-top-width",right:"border-right-width",bottom:"border-bottom-width",left:"border-left-width"},handleItemBorders:function(){var borders,docked,i,ln,item,dock,side,me=this,owner=me.owner,lastItems=me.lastDockedItems,oldBorders=me.borders,currentGeneration=owner.dockedItems.generation,noBorderClassesSides=me.noBorderClassesSides,borderWidthProps=me.borderWidthProps,collapsed=me.collapsed;if(me.initializedBorders!=currentGeneration&&(!owner.border||owner.manageBodyBorders)){for(me.initializedBorders=currentGeneration,me.collapsed=!1,me.lastDockedItems=docked=me.getLayoutItems(),me.collapsed=collapsed,borders={top:[],right:[],bottom:[],left:[]},i=0,ln=docked.length;i<ln;i++)item=docked[i],dock=item.dock,item.ignoreBorderManagement||(borders[dock].satisfied||(borders[dock].push(item),borders[dock].satisfied=!0),borders.top.satisfied||"bottom"===dock||borders.top.push(item),borders.right.satisfied||"left"===dock||borders.right.push(item),borders.bottom.satisfied||"top"===dock||borders.bottom.push(item),borders.left.satisfied||"right"===dock||borders.left.push(item));if(lastItems)for(i=0,ln=lastItems.length;i<ln;i++)item=lastItems[i],item.isDestroyed||item.ignoreBorderManagement||owner.manageBodyBorders||item.removeCls(me.noBorderClasses);if(oldBorders)for(side in oldBorders)owner.manageBodyBorders&&oldBorders[side].satisfied&&owner.setBodyStyle(borderWidthProps[side],"");for(side in borders)if(ln=borders[side].length,owner.manageBodyBorders)borders[side].satisfied&&owner.setBodyStyle(borderWidthProps[side],"1px");else{for(i=0;i<ln;i++)borders[side][i].addCls(noBorderClassesSides[side]);(borders[side].satisfied||owner.bodyBorder)&&owner.bodyBorder!==!1||owner.addBodyCls(noBorderClassesSides[side])}me.borders=borders}},beforeLayoutCycle:function(ownerContext){var collapsedHorz,collapsedVert,me=this,owner=me.owner,shrinkWrap=me.sizeModels.shrinkWrap,shrinkWrapDock=owner.shrinkWrapDock;owner.collapsed&&(owner.collapsedVertical()?(collapsedVert=!0,ownerContext.measureDimensions=1):(collapsedHorz=!0,ownerContext.measureDimensions=2)),ownerContext.collapsedVert=collapsedVert,ownerContext.collapsedHorz=collapsedHorz,collapsedVert?ownerContext.heightModel=shrinkWrap:collapsedHorz&&(ownerContext.widthModel=shrinkWrap),shrinkWrapDock=shrinkWrapDock===!0?3:shrinkWrapDock||0,ownerContext.shrinkWrapDockHeight=1&shrinkWrapDock&&ownerContext.heightModel.shrinkWrap,ownerContext.shrinkWrapDockWidth=2&shrinkWrapDock&&ownerContext.widthModel.shrinkWrap},beginLayout:function(ownerContext){var dockedItems,i,item,itemContext,offsets,collapsed,dock,me=this,owner=me.owner,docked=me.getLayoutItems(),layoutContext=ownerContext.context,dockedItemCount=docked.length;for(me.callParent(arguments),collapsed=owner.getCollapsed(),collapsed!==me.lastCollapsedState&&Ext.isDefined(me.lastCollapsedState)&&(me.owner.collapsed?(ownerContext.isCollapsingOrExpanding=1,owner.addClsWithUI(owner.collapsedCls)):(ownerContext.isCollapsingOrExpanding=2,owner.removeClsWithUI(owner.collapsedCls),ownerContext.lastCollapsedState=me.lastCollapsedState)),me.lastCollapsedState=collapsed,ownerContext.dockedItems=dockedItems=[],i=0;i<dockedItemCount;i++)item=docked[i],item.rendered&&(dock=item.dock,itemContext=layoutContext.getCmp(item),itemContext.dockedAt={x:0,y:0},itemContext.offsets=offsets=Ext.Element.parseBox(item.offsets||0),itemContext.horizontal="top"==dock||"bottom"==dock,offsets.width=offsets.left+offsets.right,offsets.height=offsets.top+offsets.bottom,dockedItems.push(itemContext));ownerContext.bodyContext=ownerContext.getEl("body")},beginLayoutCycle:function(ownerContext){var i,item,dock,me=this,docked=ownerContext.dockedItems,len=docked.length,owner=me.owner,frameBody=owner.frameBody,lastHeightModel=me.lastHeightModel;for(me.callParent(arguments),me.owner.manageHeight?me.lastBodyDisplay&&(owner.body.dom.style.display=me.lastBodyDisplay=""):("inline-block"!==me.lastBodyDisplay&&(owner.body.dom.style.display=me.lastBodyDisplay="inline-block"),lastHeightModel&&lastHeightModel.shrinkWrap&&!ownerContext.heightModel.shrinkWrap&&(owner.body.dom.style.marginBottom="")),ownerContext.widthModel.auto&&(ownerContext.widthModel.shrinkWrap&&owner.el.setWidth(null),owner.body.setWidth(null),frameBody&&frameBody.setWidth(null)),ownerContext.heightModel.auto&&(owner.body.setHeight(null),frameBody&&frameBody.setHeight(null)),ownerContext.collapsedVert?ownerContext.setContentHeight(0):ownerContext.collapsedHorz&&ownerContext.setContentWidth(0),i=0;i<len;i++)if(item=docked[i].target,dock=item.dock,"right"==dock)item.setLocalX(0);else if("left"!=dock)continue},calculate:function(ownerContext){var framing,horz,vert,forward,backward,me=this,measure=me.measureAutoDimensions(ownerContext,ownerContext.measureDimensions),state=ownerContext.state,horzDone=state.horzDone,vertDone=state.vertDone,bodyContext=ownerContext.bodyContext;for(ownerContext.borderInfo||ownerContext.getBorderInfo(),ownerContext.paddingInfo||ownerContext.getPaddingInfo(),ownerContext.frameInfo||ownerContext.getFrameInfo(),bodyContext.borderInfo||bodyContext.getBorderInfo(),bodyContext.paddingInfo||bodyContext.getPaddingInfo(),ownerContext.frameBorder||((framing=ownerContext.framing)?(ownerContext.frameBorder=framing.border,ownerContext.framePadding=framing.padding):(ownerContext.frameBorder=ownerContext.borderInfo,ownerContext.framePadding=ownerContext.paddingInfo)),horz=!horzDone&&me.createAxis(ownerContext,measure.contentWidth,ownerContext.widthModel,me.horzAxisProps,ownerContext.collapsedHorz),vert=!vertDone&&me.createAxis(ownerContext,measure.contentHeight,ownerContext.heightModel,me.vertAxisProps,ownerContext.collapsedVert),forward=0,backward=ownerContext.dockedItems.length;backward--;++forward)horz&&me.dockChild(ownerContext,horz,backward,forward),vert&&me.dockChild(ownerContext,vert,backward,forward);horz&&me.finishAxis(ownerContext,horz)&&(state.horzDone=horzDone=horz),vert&&me.finishAxis(ownerContext,vert)&&(state.vertDone=vertDone=vert),horzDone&&vertDone&&me.finishConstraints(ownerContext,horzDone,vertDone)?me.finishPositions(ownerContext,horzDone,vertDone):me.done=!1},createAxis:function(ownerContext,contentSize,sizeModel,axisProps,collapsedAxis){var bodyContext,framing,padding,end,me=this,begin=0,owner=me.owner,maxSize=owner[axisProps.maxSize],minSize=owner[axisProps.minSize]||0,dockBegin=axisProps.dockBegin,dockEnd=axisProps.dockEnd,posProp=axisProps.pos,sizeProp=axisProps.size,hasMaxSize=null!=maxSize,shrinkWrap=sizeModel.shrinkWrap;return shrinkWrap?collapsedAxis?end=0:(bodyContext=ownerContext.bodyContext,end=contentSize+bodyContext.borderInfo[sizeProp]):(framing=ownerContext.frameBorder,padding=ownerContext.framePadding,begin=framing[dockBegin]+padding[dockBegin],end=ownerContext.getProp(sizeProp)-(framing[dockEnd]+padding[dockEnd])),{shrinkWrap:sizeModel.shrinkWrap,sizeModel:sizeModel,initialBegin:begin,begin:begin,end:end,collapsed:collapsedAxis,horizontal:axisProps.horizontal,ignoreFrameBegin:null,ignoreFrameEnd:null,initialSize:end-begin,maxChildSize:0,hasMinMaxConstraints:(minSize||hasMaxSize)&&sizeModel.shrinkWrap,minSize:minSize,maxSize:hasMaxSize?maxSize:1e9,bodyPosProp:me.owner.manageHeight?posProp:axisProps.marginBegin,dockBegin:dockBegin,dockEnd:dockEnd,posProp:posProp,sizeProp:sizeProp,setSize:axisProps.setSize,shrinkWrapDock:ownerContext[axisProps.shrinkWrapDock],sizeModelName:axisProps.sizeModel,dockedPixelsEnd:0}},dockChild:function(ownerContext,axis,backward,forward){var pos,size,me=this,itemContext=ownerContext.dockedItems[axis.shrinkWrap?backward:forward],item=itemContext.target,dock=item.dock,sizeProp=axis.sizeProp;item.ignoreParentFrame&&ownerContext.isCollapsingOrExpanding&&itemContext.clearMarginCache(),itemContext.marginInfo||itemContext.getMarginInfo(),dock==axis.dockBegin?pos=axis.shrinkWrap?me.dockOutwardBegin(ownerContext,itemContext,item,axis):me.dockInwardBegin(ownerContext,itemContext,item,axis):dock==axis.dockEnd?pos=axis.shrinkWrap?me.dockOutwardEnd(ownerContext,itemContext,item,axis):me.dockInwardEnd(ownerContext,itemContext,item,axis):axis.shrinkWrapDock?(size=itemContext.getProp(sizeProp)+itemContext.marginInfo[sizeProp],axis.maxChildSize=Math.max(axis.maxChildSize,size),pos=0):pos=me.dockStretch(ownerContext,itemContext,item,axis),itemContext.dockedAt[axis.posProp]=pos},dockInwardBegin:function(ownerContext,itemContext,item,axis){var delta,size,dock,pos=axis.begin,sizeProp=axis.sizeProp,ignoreParentFrame=item.ignoreParentFrame;return ignoreParentFrame&&(axis.ignoreFrameBegin=itemContext,dock=item.dock,delta=ownerContext.frameBorder[dock],pos-=delta+ownerContext.framePadding[dock]),item.overlay||(size=itemContext.getProp(sizeProp)+itemContext.marginInfo[sizeProp],axis.begin+=size,ignoreParentFrame&&(axis.begin-=delta)),pos},dockInwardEnd:function(ownerContext,itemContext,item,axis){var frameEnd,sizeProp=axis.sizeProp,size=itemContext.getProp(sizeProp)+itemContext.marginInfo[sizeProp],pos=axis.end-size;return item.overlay||(axis.end=pos),item.ignoreParentFrame&&(axis.ignoreFrameEnd=itemContext,frameEnd=ownerContext.frameBorder[item.dock],pos+=frameEnd+ownerContext.framePadding[item.dock],axis.end+=frameEnd),pos},dockOutwardBegin:function(ownerContext,itemContext,item,axis){var size,pos=axis.begin,sizeProp=axis.sizeProp;return axis.collapsed?axis.ignoreFrameBegin=axis.ignoreFrameEnd=itemContext:item.ignoreParentFrame&&(axis.ignoreFrameBegin=itemContext),item.overlay||(size=itemContext.getProp(sizeProp)+itemContext.marginInfo[sizeProp],pos-=size,axis.begin=pos),pos},dockOutwardEnd:function(ownerContext,itemContext,item,axis){var size,pos=axis.end,sizeProp=axis.sizeProp;return size=itemContext.getProp(sizeProp)+itemContext.marginInfo[sizeProp],axis.collapsed?axis.ignoreFrameBegin=axis.ignoreFrameEnd=itemContext:item.ignoreParentFrame&&(axis.ignoreFrameEnd=itemContext),item.overlay||(axis.end=pos+size,axis.dockedPixelsEnd+=size),pos},dockStretch:function(ownerContext,itemContext,item,axis){var margin,size,dock=item.dock,sizeProp=axis.sizeProp,horizontal="top"==dock||"bottom"==dock,border=ownerContext.frameBorder,offsets=itemContext.offsets,padding=ownerContext.framePadding,endProp=horizontal?"right":"bottom",startProp=horizontal?"left":"top",pos=axis.begin+offsets[startProp];return item.stretch!==!1&&(size=axis.end-pos-offsets[endProp],item.ignoreParentFrame&&(pos-=padding[startProp]+border[startProp],size+=padding[sizeProp]+border[sizeProp]),margin=itemContext.marginInfo,size-=margin[sizeProp],itemContext[axis.setSize](size)),pos},finishAxis:function(ownerContext,axis){if(isNaN(axis.maxChildSize))return!1;var bodyPos,bodySize,delta,dirty,axisBegin=axis.begin,size=axis.end-axisBegin,collapsed=axis.collapsed,setSizeMethod=axis.setSize,beginName=axis.dockBegin,endName=axis.dockEnd,padding=ownerContext.framePadding,border=ownerContext.frameBorder,borderBegin=border[beginName],framing=ownerContext.framing,framingBegin=framing&&framing[beginName],paddingBegin=collapsed?0:padding[beginName],sizeProp=axis.sizeProp,ignoreFrameBegin=axis.ignoreFrameBegin,ignoreFrameEnd=axis.ignoreFrameEnd,bodyContext=ownerContext.bodyContext,extraPaddingBegin=Math.max(borderBegin+paddingBegin-framingBegin,0);return axis.shrinkWrap?(bodySize=axis.initialSize,framing?(delta=-axisBegin+borderBegin+paddingBegin,bodyPos=delta-framingBegin-extraPaddingBegin):(bodyPos=-axisBegin,delta=bodyPos+paddingBegin),collapsed||(size+=padding[sizeProp]),ignoreFrameBegin?(delta-=borderBegin,bodyPos-=borderBegin,ignoreFrameBegin.dockedAt[axis.posProp]-=paddingBegin):size+=borderBegin,collapsed||(ignoreFrameEnd?ignoreFrameEnd.dockedAt[axis.posProp]+=padding[endName]:size+=border[endName]),axis.size=size,axis.horizontal||this.owner.manageHeight||(dirty=!1)):(framing?(delta=0,bodyPos=axisBegin-framingBegin-extraPaddingBegin):(delta=-borderBegin,bodyPos=axisBegin-paddingBegin-borderBegin),bodySize=size),axis.delta=delta,bodyContext[setSizeMethod](bodySize,dirty),bodyContext.setProp(axis.bodyPosProp,bodyPos),!isNaN(size)},beforeInvalidateShrinkWrapDock:function(itemContext,options){var sizeModelName=options.axis.sizeModelName;itemContext[sizeModelName].constrainedMin||(itemContext[sizeModelName]=Ext.layout.SizeModel.calculated)},afterInvalidateShrinkWrapDock:function(itemContext,options){var pos,axis=options.axis,me=options.layout;itemContext[axis.sizeModelName].calculated&&(pos=me.dockStretch(options.ownerContext,itemContext,itemContext.target,axis),itemContext.setProp(axis.posProp,axis.delta+pos))},finishConstraints:function(ownerContext,horz,vert){var dirty,height,width,heightModel,widthModel,size,minSize,maxSize,maxChildSize,desiredSize,me=this,sizeModels=me.sizeModels,publishWidth=horz.shrinkWrap,publishHeight=vert.shrinkWrap,owner=me.owner;if(publishWidth&&(size=horz.size,minSize=horz.collapsed?0:horz.minSize,maxSize=horz.maxSize,maxChildSize=horz.maxChildSize,desiredSize=Math.max(size,maxChildSize),desiredSize>maxSize?(widthModel=sizeModels.constrainedMax,width=maxSize):desiredSize<minSize?(widthModel=sizeModels.constrainedMin,width=minSize):size<maxChildSize?(widthModel=sizeModels.constrainedDock,owner.dockConstrainedWidth=width=maxChildSize):width=size),publishHeight&&(size=vert.size,minSize=vert.collapsed?0:vert.minSize,maxSize=vert.maxSize,maxChildSize=vert.maxChildSize,desiredSize=Math.max(size,maxChildSize+size-vert.initialSize),desiredSize>maxSize?(heightModel=sizeModels.constrainedMax,height=maxSize):desiredSize<minSize?(heightModel=sizeModels.constrainedMin,height=minSize):size<maxChildSize?(heightModel=sizeModels.constrainedDock,owner.dockConstrainedHeight=height=maxChildSize):(ownerContext.collapsedVert||owner.manageHeight||(dirty=!1,ownerContext.bodyContext.setProp("margin-bottom",vert.dockedPixelsEnd)),height=size)),widthModel||heightModel){if(widthModel&&heightModel&&widthModel.constrainedMax&&heightModel.constrainedByMin)return ownerContext.invalidate({widthModel:widthModel}),!1;if(!ownerContext.widthModel.calculatedFromShrinkWrap&&!ownerContext.heightModel.calculatedFromShrinkWrap)return ownerContext.invalidate({widthModel:widthModel,heightModel:heightModel}),!1}else me.invalidateAxes(ownerContext,horz,vert);return publishWidth&&(ownerContext.setWidth(width),widthModel&&(ownerContext.widthModel=widthModel)),
publishHeight&&(ownerContext.setHeight(height,dirty),heightModel&&(ownerContext.heightModel=heightModel)),!0},invalidateAxes:function(ownerContext,horz,vert){var dockedItems,len,i,itemContext,itemSize,isHorz,axis,sizeProp,before=this.beforeInvalidateShrinkWrapDock,after=this.afterInvalidateShrinkWrapDock,horzSize=horz.end-horz.begin,vertSize=vert.initialSize,invalidateHorz=horz.shrinkWrapDock&&horz.maxChildSize<=horzSize,invalidateVert=vert.shrinkWrapDock&&vert.maxChildSize<=vertSize;if(invalidateHorz||invalidateVert)for(invalidateVert&&(vert.begin=vert.initialBegin,vert.end=vert.begin+vert.initialSize),dockedItems=ownerContext.dockedItems,i=0,len=dockedItems.length;i<len;++i)itemContext=dockedItems[i],isHorz=itemContext.horizontal,axis=null,invalidateHorz&&isHorz?(sizeProp=horz.sizeProp,itemSize=horzSize,axis=horz):invalidateVert&&!isHorz&&(sizeProp=vert.sizeProp,itemSize=vertSize,axis=vert),axis&&(itemSize-=itemContext.getMarginInfo()[sizeProp],itemSize!==itemContext.props[sizeProp]&&itemContext.invalidate({before:before,after:after,axis:axis,ownerContext:ownerContext,layout:this}))},finishPositions:function(ownerContext,horz,vert){var index,itemContext,dockedItems=ownerContext.dockedItems,length=dockedItems.length,deltaX=horz.delta,deltaY=vert.delta;for(index=0;index<length;++index)itemContext=dockedItems[index],itemContext.setProp("x",deltaX+itemContext.dockedAt.x),itemContext.setProp("y",deltaY+itemContext.dockedAt.y)},finishedLayout:function(ownerContext){var me=this,target=ownerContext.target;me.callParent(arguments),ownerContext.animatePolicy||(1===ownerContext.isCollapsingOrExpanding?target.afterCollapse(!1):2===ownerContext.isCollapsingOrExpanding&&target.afterExpand(!1))},getAnimatePolicy:function(ownerContext){var lastCollapsedState,policy,me=this;return 1==ownerContext.isCollapsingOrExpanding?lastCollapsedState=me.lastCollapsedState:2==ownerContext.isCollapsingOrExpanding&&(lastCollapsedState=ownerContext.lastCollapsedState),"left"==lastCollapsedState||"right"==lastCollapsedState?policy=me.horizontalCollapsePolicy:"top"!=lastCollapsedState&&"bottom"!=lastCollapsedState||(policy=me.verticalCollapsePolicy),policy},getDockedItems:function(order,beforeBody){var renderOrder,dock,dockedItems,i,isBefore,length,me=this,renderedOnly="visual"===order,all=renderedOnly?Ext.ComponentQuery.query("[rendered]",me.owner.dockedItems.items):me.owner.dockedItems.items,sort=all&&all.length&&order!==!1;if(null==beforeBody)dockedItems=sort&&!renderedOnly?all.slice():all;else{for(dockedItems=[],i=0,length=all.length;i<length;++i)dock=all[i].dock,isBefore="top"==dock||"left"==dock,(beforeBody?isBefore:!isBefore)&&dockedItems.push(all[i]);sort=sort&&dockedItems.length}return sort&&(renderOrder="render"==(order=order||"render"),Ext.Array.sort(dockedItems,function(a,b){var aw,bw;return!renderOrder||(aw=me.owner.dockOrder[a.dock])===(bw=me.owner.dockOrder[b.dock])||aw+bw?(aw=me.getItemWeight(a,order),bw=me.getItemWeight(b,order),void 0!==aw&&void 0!==bw?aw-bw:0):aw-bw})),dockedItems||[]},getItemWeight:function(item,order){var weight=item.weight||this.owner.defaultDockWeights[item.dock];return weight[order]||weight},getLayoutItems:function(){var items,itemCount,item,i,result,me=this;if(me.owner.collapsed)result=me.owner.getCollapsedDockedItems();else for(items=me.getDockedItems("visual"),itemCount=items.length,result=[],i=0;i<itemCount;i++)item=items[i],item.hidden||result.push(item);return result},measureContentWidth:function(ownerContext){var bodyContext=ownerContext.bodyContext;return bodyContext.el.getWidth()-bodyContext.getBorderInfo().width},measureContentHeight:function(ownerContext){var bodyContext=ownerContext.bodyContext;return bodyContext.el.getHeight()-bodyContext.getBorderInfo().height},redoLayout:function(ownerContext){var me=this,owner=me.owner;1==ownerContext.isCollapsingOrExpanding?(owner.reExpander&&owner.reExpander.el.show(),owner.addClsWithUI(owner.collapsedCls),ownerContext.redo(!0)):2==ownerContext.isCollapsingOrExpanding&&(owner.removeClsWithUI(owner.collapsedCls),ownerContext.bodyContext.redo())},renderChildren:function(){var me=this,items=me.getDockedItems(),target=me.getRenderTarget();me.handleItemBorders(),me.renderItems(items,target)},renderItems:function(items,target){var i,j,targetChildNode,item,me=this,dockedItemCount=items.length,itemIndex=0,correctPosition=0,staticNodeCount=0,targetNodes=me.getRenderTarget().dom.childNodes,targetChildCount=targetNodes.length;for(i=0,j=0;i<targetChildCount&&(targetChildNode=targetNodes[i],!Ext.fly(targetChildNode).hasCls(Ext.baseCSSPrefix+"resizable-handle"));i++){for(j=0;j<dockedItemCount&&(item=items[j],!item.rendered||item.el.dom!==targetChildNode);j++);j===dockedItemCount&&staticNodeCount++}for(;itemIndex<dockedItemCount;itemIndex++,correctPosition++)item=items[itemIndex],itemIndex!==correctPosition||"right"!==item.dock&&"bottom"!==item.dock||(correctPosition+=staticNodeCount),item&&!item.rendered?me.renderItem(item,target,correctPosition):me.isValidParent(item,target,correctPosition)||me.moveItem(item,target,correctPosition)},undoLayout:function(ownerContext){var me=this,owner=me.owner;1==ownerContext.isCollapsingOrExpanding?(owner.reExpander&&owner.reExpander.el.hide(),owner.removeClsWithUI(owner.collapsedCls),ownerContext.undo(!0)):2==ownerContext.isCollapsingOrExpanding&&(owner.addClsWithUI(owner.collapsedCls),ownerContext.bodyContext.undo())},sizePolicy:{nostretch:{setsWidth:0,setsHeight:0},horz:{shrinkWrap:{setsWidth:1,setsHeight:0,readsWidth:1},stretch:{setsWidth:1,setsHeight:0}},vert:{shrinkWrap:{setsWidth:0,setsHeight:1,readsHeight:1},stretch:{setsWidth:0,setsHeight:1}},stretchV:{setsWidth:0,setsHeight:1},autoStretchH:{readsWidth:1,setsWidth:1,setsHeight:0},autoStretchV:{readsHeight:1,setsWidth:0,setsHeight:1}},getItemSizePolicy:function(item,ownerSizeModel){var dock,vertical,me=this,policy=me.sizePolicy,shrinkWrapDock=me.owner.shrinkWrapDock;return item.stretch===!1?policy.nostretch:(dock=item.dock,vertical="left"==dock||"right"==dock,shrinkWrapDock=shrinkWrapDock===!0?3:shrinkWrapDock||0,vertical?(policy=policy.vert,shrinkWrapDock=1&shrinkWrapDock):(policy=policy.horz,shrinkWrapDock=2&shrinkWrapDock),shrinkWrapDock&&(ownerSizeModel||(ownerSizeModel=me.owner.getSizeModel()),ownerSizeModel[vertical?"height":"width"].shrinkWrap)?policy.shrinkWrap:policy.stretch)},configureItem:function(item,pos){this.callParent(arguments),item.addCls(Ext.baseCSSPrefix+"docked"),item.addClsWithUI(this.getDockCls(item.dock))},getDockCls:function(dock){return"docked-"+dock},afterRemove:function(item){this.callParent(arguments),this.itemCls&&item.el.removeCls(this.itemCls+"-"+item.dock);var dom=item.el.dom;!item.destroying&&dom&&dom.parentNode.removeChild(dom),this.childrenChanged=!0},borderCollapseMap:{},getBorderCollapseTable:function(){var table,me=this,map=me.borderCollapseMap,owner=me.owner,baseCls=owner.baseCls,ui=owner.ui;return map=map[baseCls]||(map[baseCls]={}),table=map[ui],table||(baseCls+="-"+ui+"-outer-border-",map[ui]=table=[0,baseCls+"l",baseCls+"b",baseCls+"bl",baseCls+"r",baseCls+"rl",baseCls+"rb",baseCls+"rbl",baseCls+"t",baseCls+"tl",baseCls+"tb",baseCls+"tbl",baseCls+"tr",baseCls+"trl",baseCls+"trb",baseCls+"trbl"]),table}}),Ext.define("Ext.panel.AbstractPanel",{extend:Ext.container.Container,mixins:{docking:Ext.container.DockingContainer},baseCls:Ext.baseCSSPrefix+"panel",isPanel:!0,contentPaddingProperty:"bodyPadding",shrinkWrapDock:!1,componentLayout:"dock",childEls:["body"],renderTpl:["{% this.renderDockedItems(out,values,0); %}",Ext.isIE7m||Ext.isIEQuirks?'<div style="position:relative;font-size:0;line-height:0;" role="presentation">&nbsp;</div>':"",'<div id="{id}-body" class="{baseCls}-body<tpl if="bodyCls"> {bodyCls}</tpl>',' {baseCls}-body-{ui}<tpl if="uiCls">','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>','</tpl>{childElCls}"','<tpl if="bodyRole"> role="{bodyRole}"<tpl else> role="presentation"</tpl>','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values);%}","</div>","{% this.renderDockedItems(out,values,1); %}"],bodyPosProps:{x:"x",y:"y"},border:!0,emptyArray:[],initComponent:function(){this.initBorderProps(),this.callParent()},initBorderProps:function(){var me=this;me.frame&&me.border&&void 0===me.bodyBorder&&(me.bodyBorder=!1),me.frame&&me.border&&(me.bodyBorder===!1||0===me.bodyBorder)&&(me.manageBodyBorders=!0)},beforeDestroy:function(){this.destroyDockedItems(),this.callParent()},initItems:function(){this.callParent(),this.initDockingItems()},initRenderData:function(){var me=this,data=me.callParent();return me.initBodyStyles(),me.protoBody.writeTo(data),delete me.protoBody,data},getComponent:function(comp){var component=this.callParent(arguments);return void 0!==component||Ext.isNumber(comp)||(component=this.getDockedComponent(comp)),component},getProtoBody:function(){var me=this,body=me.protoBody;return body||(me.protoBody=body=new Ext.util.ProtoElement({cls:me.bodyCls,style:me.bodyStyle,clsProp:"bodyCls",styleProp:"bodyStyle",styleIsText:!0})),body},initBodyStyles:function(){var me=this,body=me.getProtoBody();void 0!==me.bodyPadding&&(me.layout.managePadding?body.setStyle("padding",0):body.setStyle("padding",this.unitizeBox(me.bodyPadding===!0?5:me.bodyPadding))),me.initBodyBorder()},initBodyBorder:function(){var me=this;me.frame&&me.bodyBorder&&(Ext.isNumber(me.bodyBorder)||(me.bodyBorder=1),me.getProtoBody().setStyle("border-width",this.unitizeBox(me.bodyBorder)))},getCollapsedDockedItems:function(){var me=this;return me.header===!1||"placeholder"==me.collapseMode?me.emptyArray:[me.getReExpander()]},setBodyStyle:function(style,value){var me=this,body=me.rendered?me.body:me.getProtoBody();return Ext.isFunction(style)&&(style=style()),1==arguments.length?(Ext.isString(style)&&(style=Ext.Element.parseStyles(style)),body.setStyle(style)):body.setStyle(style,value),me},addBodyCls:function(cls){var me=this,body=me.rendered?me.body:me.getProtoBody();return body.addCls(cls),me},removeBodyCls:function(cls){var me=this,body=me.rendered?me.body:me.getProtoBody();return body.removeCls(cls),me},addUIClsToElement:function(cls){var me=this,result=me.callParent(arguments);return me.addBodyCls([Ext.baseCSSPrefix+cls,me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls]),result},removeUIClsFromElement:function(cls){var me=this,result=me.callParent(arguments);return me.removeBodyCls([Ext.baseCSSPrefix+cls,me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls]),result},addUIToElement:function(){var me=this;me.callParent(arguments),me.addBodyCls(me.baseCls+"-body-"+me.ui)},removeUIFromElement:function(){var me=this;me.callParent(arguments),me.removeBodyCls(me.baseCls+"-body-"+me.ui)},getTargetEl:function(){return this.body},applyTargetCls:function(targetCls){this.getProtoBody().addCls(targetCls)},getRefItems:function(deep){var items=this.callParent(arguments);return this.getDockingRefItems(deep,items)},setupRenderTpl:function(renderTpl){this.callParent(arguments),this.setupDockingRenderTpl(renderTpl)}}),Ext.define("Ext.panel.Header",{extend:Ext.container.Container,alias:"widget.header",isHeader:!0,defaultType:"tool",indicateDrag:!1,weight:-1,componentLayout:"body",childEls:["body"],renderTpl:['<div id="{id}-body" class="{headerCls}-body {baseCls}-body {bodyCls} {bodyTargetCls}','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>"','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl> role="presentation">',"{%this.renderContainer(out,values)%}","</div>"],headingTpl:['<span id="{id}-textEl" class="{headerCls}-text {cls}-text {cls}-text-{ui}" unselectable="on"','<tpl if="headerRole">',' role="{headerRole}"',"</tpl>",">{title}</span>"],shrinkWrap:3,titlePosition:0,headerCls:Ext.baseCSSPrefix+"header",initComponent:function(){var me=this,hasPosition=me.hasOwnProperty("titlePosition"),items=me.items,titlePosition=hasPosition?me.titlePosition:items?items.length:0,uiClasses=[me.orientation,me.getDockName()],ownerCt=me.ownerCt;me.addEvents("click","dblclick"),me.indicateDragCls=me.headerCls+"-draggable",me.title=me.title||"&#160;",me.tools=me.tools||[],items=me.items=items?Ext.Array.slice(items):[],me.orientation=me.orientation||"horizontal",me.dock=me.dock?me.dock:"horizontal"==me.orientation?"top":"left",(ownerCt?ownerCt.border!==!1||ownerCt.frame:me.border!==!1)||uiClasses.push(me.orientation+"-noborder"),me.addClsWithUI(uiClasses),me.addCls([me.headerCls,me.headerCls+"-"+me.orientation]),me.indicateDrag&&me.addCls(me.indicateDragCls),(me.iconCls||me.icon||me.glyph)&&(me.initIconCmp(),hasPosition||items.length||++titlePosition,items.push(me.iconCmp)),me.titleCmp=new Ext.Component({ariaRole:"presentation",focusable:!1,noWrap:!0,flex:1,rtl:me.rtl,id:me.id+"_hd",style:me.titleAlign?"text-align:"+me.titleAlign:"",cls:me.headerCls+"-text-container "+me.baseCls+"-text-container "+me.baseCls+"-text-container-"+me.ui,renderTpl:me.getTpl("headingTpl"),renderData:{title:me.title,cls:me.baseCls,headerCls:me.headerCls,headerRole:me.headerRole,ui:me.ui},childEls:["textEl"],autoEl:{unselectable:"on"},listeners:{render:me.onTitleRender,scope:me}}),me.layout="vertical"==me.orientation?{type:"vbox",align:"center",alignRoundingMethod:"ceil"}:{type:"hbox",align:"middle",alignRoundingMethod:"floor"},Ext.Array.push(items,me.tools),me.tools.length=0,me.callParent(),items.length<titlePosition&&(titlePosition=items.length),me.titlePosition=titlePosition,me.insert(titlePosition,me.titleCmp),me.on({dblclick:me.onDblClick,click:me.onClick,element:"el",scope:me})},setTitlePosition:function(index){var me=this;me.titlePosition=index=Math.min(index,me.items.length-1),me.insert(index,me.titleCmp)},initIconCmp:function(){var cfg,me=this,cls=[me.headerCls+"-icon",me.baseCls+"-icon",me.iconCls];me.glyph&&cls.push(me.baseCls+"-glyph"),cfg={focusable:!1,src:Ext.BLANK_IMAGE_URL,cls:cls,baseCls:me.baseCls+"-icon",id:me.id+"-iconEl",iconCls:me.iconCls,glyph:me.glyph},Ext.isEmpty(me.icon)||(delete cfg.iconCls,cfg.src=me.icon),me.iconCmp=new Ext.Img(cfg)},beforeRender:function(){this.protoEl.unselectable(),this.callParent()},afterLayout:function(){var frameBR,frameTR,frameTL,xPos,me=this;"vertical"===me.orientation&&(me.adjustTitlePosition(),frameTR=me.frameTR,frameTR&&(frameBR=me.frameBR,frameTL=me.frameTL,xPos=me.getWidth()-frameTR.getPadding("r")-(frameTL?frameTL.getPadding("l"):me.el.getBorderWidth("l"))+"px",frameBR.setStyle("background-position-x",xPos),frameTR.setStyle("background-position-x",xPos)),Ext.isIE7&&Ext.isStrict&&me.frame&&me.el.repaint())},beforeLayout:function(){this.callParent(),this.syncBeforeAfterTitleClasses()},adjustTitlePosition:function(){var titleEl,titleCmp=this.titleCmp;!Ext.isIE9m&&titleCmp&&(titleEl=titleCmp.el,titleEl.setStyle("left",titleEl.getWidth()+"px"))},onTitleRender:function(){"vertical"===this.orientation&&this.titleCmp.el.setVertical(90)},addUIClsToElement:function(cls){var array,i,me=this,result=me.callParent(arguments),classes=[me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls];if(me.bodyCls){for(array=me.bodyCls.split(" "),i=0;i<classes.length;i++)Ext.Array.contains(array,classes[i])||array.push(classes[i]);me.bodyCls=array.join(" ")}else me.bodyCls=classes.join(" ");return result},removeUIClsFromElement:function(cls){var array,i,me=this,result=me.callParent(arguments),classes=[me.baseCls+"-body-"+cls,me.baseCls+"-body-"+me.ui+"-"+cls];if(me.bodyCls){for(array=me.bodyCls.split(" "),i=0;i<classes.length;i++)Ext.Array.remove(array,classes[i]);me.bodyCls=array.join(" ")}return result},addUIToElement:function(){var array,cls,me=this;me.callParent(arguments),cls=me.baseCls+"-body-"+me.ui,me.rendered?me.bodyCls?me.body.addCls(me.bodyCls):me.body.addCls(cls):me.bodyCls?(array=me.bodyCls.split(" "),Ext.Array.contains(array,cls)||array.push(cls),me.bodyCls=array.join(" ")):me.bodyCls=cls,me.titleCmp&&me.titleCmp.rendered&&me.titleCmp.addCls(me.baseCls+"-text-container-"+me.ui)},removeUIFromElement:function(){var array,cls,me=this;me.callParent(arguments),cls=me.baseCls+"-body-"+me.ui,me.rendered?me.bodyCls?me.body.removeCls(me.bodyCls):me.body.removeCls(cls):me.bodyCls?(array=me.bodyCls.split(" "),Ext.Array.remove(array,cls),me.bodyCls=array.join(" ")):me.bodyCls=cls,me.titleCmp&&me.titleCmp.rendered&&me.titleCmp.removeCls(me.baseCls+"-text-container-"+me.ui)},onClick:function(e){this.fireClickEvent("click",e)},onDblClick:function(e){this.fireClickEvent("dblclick",e)},fireClickEvent:function(type,e){var toolCls="."+Ext.panel.Tool.prototype.baseCls;e.getTarget(toolCls)||this.fireEvent(type,this,e)},getFocusEl:function(){return this.el},getTargetEl:function(){return this.body||this.frameBody||this.el},applyTargetCls:function(targetCls){this.bodyTargetCls=targetCls},setTitle:function(title){var me=this,titleCmp=me.titleCmp;me.title=title,titleCmp.rendered?(titleCmp.textEl.update(me.title||"&#160;"),titleCmp.updateLayout()):me.titleCmp.on({render:function(){me.setTitle(title)},single:!0})},getMinWidth:function(){var result,l,i,me=this,textEl=me.titleCmp.textEl.dom,tools=me.tools;if(textEl.style.display="inline",result=textEl.offsetWidth,textEl.style.display="",tools&&(l=tools.length))for(i=0;i<l;i++)tools[i].el&&(result+=tools[i].el.dom.offsetWidth);return me.iconCmp&&(result+=me.iconCmp.el.dom.offsetWidth),result+10},setIconCls:function(cls){var me=this,isEmpty=!cls||!cls.length,iconCmp=me.iconCmp;me.iconCls=cls,me.iconCmp||isEmpty?iconCmp&&(isEmpty?(me.iconCmp.destroy(),delete me.iconCmp):(iconCmp.removeCls(iconCmp.iconCls),iconCmp.addCls(cls),iconCmp.iconCls=cls)):(me.initIconCmp(),me.insert(0,me.iconCmp))},setIcon:function(icon){var me=this,isEmpty=!icon||!icon.length,iconCmp=me.iconCmp;me.icon=icon,me.iconCmp||isEmpty?iconCmp&&(isEmpty?(me.iconCmp.destroy(),delete me.iconCmp):iconCmp.setSrc(me.icon)):(me.initIconCmp(),me.insert(0,me.iconCmp))},setGlyph:function(glyph){var me=this,iconCmp=me.iconCmp;me.iconCmp?iconCmp&&(glyph?me.iconCmp.setGlyph(glyph):(me.iconCmp.destroy(),delete me.iconCmp)):(me.initIconCmp(),me.insert(0,me.iconCmp))},getTools:function(){return this.tools.slice()},addTool:function(tool){this.add(Ext.ComponentManager.create(tool,"tool"))},syncBeforeAfterTitleClasses:function(force){var afterCls,beforeCls,i,item,me=this,items=me.items,childItems=items.items,titlePosition=me.titlePosition,itemCount=childItems.length,itemGeneration=items.generation,syncGen=me.syncBeforeAfterGen;if(force||syncGen!==itemGeneration)for(me.syncBeforeAfterGen=itemGeneration,i=0;i<itemCount;++i)item=childItems[i],afterCls=item.afterTitleCls||(item.afterTitleCls=item.baseCls+"-after-title"),beforeCls=item.beforeTitleCls||(item.beforeTitleCls=item.baseCls+"-before-title"),!me.title||i<titlePosition?(syncGen&&item.removeCls(afterCls),item.addCls(beforeCls)):i>titlePosition&&(syncGen&&item.removeCls(beforeCls),item.addCls(afterCls))},onAdd:function(component,index){var tools=this.tools;this.callParent(arguments),component.isTool&&(tools.push(component),tools[component.type]=component)},initRenderData:function(){return Ext.applyIf(this.callParent(),{bodyCls:this.bodyCls,bodyTargetCls:this.bodyTargetCls,headerCls:this.headerCls})},getDockName:function(){return this.dock},getFramingInfoCls:function(){var me=this,cls=me.callParent(),owner=me.ownerCt;return!me.expanding&&owner&&(owner.collapsed||me.isCollapsedExpander)&&(cls+="-"+owner.collapsedCls),cls+"-"+me.dock}}),Ext.define("Ext.dd.DragDrop",{constructor:function(id,sGroup,config){id&&this.init(id,sGroup,config)},id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:!1,lock:function(){this.locked=!0},moveOnly:!1,unlock:function(){this.locked=!1},isTarget:!0,padding:null,_domRef:null,__ygDragDrop:!0,constrainX:!1,constrainY:!1,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:!1,xTicks:null,yTicks:null,primaryButtonOnly:!0,available:!1,hasOuterHandles:!1,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},onInvalidDrop:function(e){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(constrainTo,pad,inContent){Ext.isNumber(pad)&&(pad={left:pad,right:pad,top:pad,bottom:pad}),pad=pad||this.defaultPadding;var c,xy,topSpace,leftSpace,b=Ext.get(this.getEl()).getBox(),ce=Ext.get(constrainTo),s=ce.getScroll(),cd=ce.dom;cd==document.body?c={x:s.left,y:s.top,width:Ext.Element.getViewWidth(),height:Ext.Element.getViewHeight()}:(xy=ce.getXY(),c={x:xy[0],y:xy[1],width:cd.clientWidth,height:cd.clientHeight}),topSpace=b.y-c.y,leftSpace=b.x-c.x,this.resetConstraints(),this.setXConstraint(leftSpace-(pad.left||0),c.width-leftSpace-b.width-(pad.right||0),this.xTickSize),this.setYConstraint(topSpace-(pad.top||0),c.height-topSpace-b.height-(pad.bottom||0),this.yTickSize)},getEl:function(){return this._domRef||(this._domRef=Ext.getDom(this.id)),this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(id,sGroup,config){this.initTarget(id,sGroup,config),Ext.EventManager.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(id,sGroup,config){this.config=config||{},this.DDMInstance=Ext.dd.DragDropManager,this.groups={},"string"!=typeof id&&(id=Ext.id(id)),this.id=id,this.addToGroup(sGroup?sGroup:"default"),this.handleElId=id,this.setDragElId(id),this.invalidHandleTypes={A:"A"},this.invalidHandleIds={},this.invalidHandleClasses=[],this.applyConfig(),this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0],this.isTarget=this.config.isTarget!==!1,this.maintainOffset=this.config.maintainOffset,this.primaryButtonOnly=this.config.primaryButtonOnly!==!1},handleOnAvailable:function(){this.available=!0,this.resetConstraints(),this.onAvailable()},setPadding:function(iTop,iRight,iBot,iLeft){iRight||0===iRight?iBot||0===iBot?this.padding=[iTop,iRight,iBot,iLeft]:this.padding=[iTop,iRight,iTop,iRight]:this.padding=[iTop,iTop,iTop,iTop]},setInitPosition:function(diffX,diffY){var dx,dy,p,el=this.getEl();this.DDMInstance.verifyEl(el)&&(dx=diffX||0,dy=diffY||0,p=Ext.Element.getXY(el),this.initPageX=p[0]-dx,this.initPageY=p[1]-dy,this.lastPageX=p[0],this.lastPageY=p[1],this.setStartPosition(p))},setStartPosition:function(pos){var p=pos||Ext.Element.getXY(this.getEl());this.deltaSetXY=null,this.startPageX=p[0],this.startPageY=p[1]},addToGroup:function(sGroup){this.groups[sGroup]=!0,this.DDMInstance.regDragDrop(this,sGroup)},removeFromGroup:function(sGroup){this.groups[sGroup]&&delete this.groups[sGroup],this.DDMInstance.removeDDFromGroup(this,sGroup)},setDragElId:function(id){this.dragElId=id},setHandleElId:function(id){"string"!=typeof id&&(id=Ext.id(id)),this.handleElId=id,this.DDMInstance.regHandle(this.id,id)},setOuterHandleElId:function(id){"string"!=typeof id&&(id=Ext.id(id)),Ext.EventManager.on(id,"mousedown",this.handleMouseDown,this),this.setHandleElId(id),this.hasOuterHandles=!0},unreg:function(){var me=this;Ext.EventManager.un(me.id,"mousedown",me.handleMouseDown,me),me._domRef=null,me.DDMInstance._remove(me,me.autoGroup)},destroy:function(){this.unreg()},isLocked:function(){return this.DDMInstance.isLocked()||this.locked},handleMouseDown:function(e,oDD){var me=this;me.primaryButtonOnly&&0!=e.button||me.isLocked()||(me.DDMInstance.refreshCache(me.groups),(me.hasOuterHandles||me.DDMInstance.isOverTarget(e.getPoint(),me))&&me.clickValidator(e)&&(me.setStartPosition(),me.b4MouseDown(e),me.onMouseDown(e),me.DDMInstance.handleMouseDown(e,me),me.DDMInstance.stopEvent(e)))},clickValidator:function(e){var target=e.getTarget();return this.isValidHandleChild(target)&&(this.id==this.handleElId||this.DDMInstance.handleWasClicked(target,this.id))},addInvalidHandleType:function(tagName){var type=tagName.toUpperCase();this.invalidHandleTypes[type]=type},addInvalidHandleId:function(id){"string"!=typeof id&&(id=Ext.id(id)),this.invalidHandleIds[id]=id},addInvalidHandleClass:function(cssClass){this.invalidHandleClasses.push(cssClass)},removeInvalidHandleType:function(tagName){var type=tagName.toUpperCase();delete this.invalidHandleTypes[type]},removeInvalidHandleId:function(id){"string"!=typeof id&&(id=Ext.id(id)),delete this.invalidHandleIds[id]},removeInvalidHandleClass:function(cssClass){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i)this.invalidHandleClasses[i]==cssClass&&delete this.invalidHandleClasses[i]},isValidHandleChild:function(node){var nodeName,i,len,valid=!0;try{nodeName=node.nodeName.toUpperCase()}catch(e){nodeName=node.nodeName}for(valid=valid&&!this.invalidHandleTypes[nodeName],valid=valid&&!this.invalidHandleIds[node.id],i=0,len=this.invalidHandleClasses.length;valid&&i<len;++i)valid=!Ext.fly(node).hasCls(this.invalidHandleClasses[i]);return valid},setXTicks:function(iStartX,iTickSize){this.xTicks=[],this.xTickSize=iTickSize;var i,tickMap={};for(i=this.initPageX;i>=this.minX;i-=iTickSize)tickMap[i]||(this.xTicks[this.xTicks.length]=i,tickMap[i]=!0);for(i=this.initPageX;i<=this.maxX;i+=iTickSize)tickMap[i]||(this.xTicks[this.xTicks.length]=i,tickMap[i]=!0);Ext.Array.sort(this.xTicks,this.DDMInstance.numericSort)},setYTicks:function(iStartY,iTickSize){this.yTicks=[],this.yTickSize=iTickSize;var i,tickMap={};for(i=this.initPageY;i>=this.minY;i-=iTickSize)tickMap[i]||(this.yTicks[this.yTicks.length]=i,tickMap[i]=!0);for(i=this.initPageY;i<=this.maxY;i+=iTickSize)tickMap[i]||(this.yTicks[this.yTicks.length]=i,tickMap[i]=!0);Ext.Array.sort(this.yTicks,this.DDMInstance.numericSort)},setXConstraint:function(iLeft,iRight,iTickSize){this.leftConstraint=iLeft,this.rightConstraint=iRight,this.minX=this.initPageX-iLeft,this.maxX=this.initPageX+iRight,iTickSize&&this.setXTicks(this.initPageX,iTickSize),this.constrainX=!0},clearConstraints:function(){this.constrainX=!1,this.constrainY=!1,this.clearTicks()},clearTicks:function(){this.xTicks=null,this.yTicks=null,this.xTickSize=0,this.yTickSize=0},setYConstraint:function(iUp,iDown,iTickSize){this.topConstraint=iUp,this.bottomConstraint=iDown,this.minY=this.initPageY-iUp,this.maxY=this.initPageY+iDown,iTickSize&&this.setYTicks(this.initPageY,iTickSize),this.constrainY=!0},resetConstraints:function(){if(this.initPageX||0===this.initPageX){var dx=this.maintainOffset?this.lastPageX-this.initPageX:0,dy=this.maintainOffset?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy)}else this.setInitPosition();this.constrainX&&this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize),this.constrainY&&this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)},getTick:function(val,tickArray){if(tickArray){if(tickArray[0]>=val)return tickArray[0];var i,len,next,diff1,diff2;for(i=0,len=tickArray.length;i<len;++i)if(next=i+1,tickArray[next]&&tickArray[next]>=val)return diff1=val-tickArray[i],diff2=tickArray[next]-val,diff2>diff1?tickArray[i]:tickArray[next];return tickArray[tickArray.length-1]}return val},toString:function(){return"DragDrop "+this.id}}),Ext.define("Ext.dd.DD",{extend:Ext.dd.DragDrop,constructor:function(id,sGroup,config){id&&this.init(id,sGroup,config)},scroll:!0,autoOffset:function(iPageX,iPageY){var x=iPageX-this.startPageX,y=iPageY-this.startPageY;this.setDelta(x,y)},setDelta:function(iDeltaX,iDeltaY){this.deltaX=iDeltaX,this.deltaY=iDeltaY},setDragElPos:function(iPageX,iPageY){var el=this.getDragEl();this.alignElWithMouse(el,iPageX,iPageY)},alignElWithMouse:function(el,iPageX,iPageY){var vpSize,aCoord,newLeft,newTop,oCoord=this.getTargetCoord(iPageX,iPageY),fly=el.dom?el:Ext.fly(el,"_dd"),elSize=fly.getSize(),EL=Ext.Element;return this.deltaSetXY?(vpSize=this.cachedViewportSize,this.setLocalXY(fly,Math.max(0,Math.min(oCoord.x+this.deltaSetXY[0],vpSize.width-elSize.width)),Math.max(0,Math.min(oCoord.y+this.deltaSetXY[1],vpSize.height-elSize.height)))):(vpSize=this.cachedViewportSize={width:EL.getDocumentWidth(),height:EL.getDocumentHeight()},aCoord=[Math.max(0,Math.min(oCoord.x,vpSize.width-elSize.width)),Math.max(0,Math.min(oCoord.y,vpSize.height-elSize.height))],fly.setXY(aCoord),newLeft=this.getLocalX(fly),newTop=fly.getLocalY(),this.deltaSetXY=[newLeft-oCoord.x,newTop-oCoord.y]),this.cachePosition(oCoord.x,oCoord.y),this.autoScroll(oCoord.x,oCoord.y,el.offsetHeight,el.offsetWidth),oCoord},cachePosition:function(iPageX,iPageY){if(iPageX)this.lastPageX=iPageX,this.lastPageY=iPageY;else{var aCoord=Ext.Element.getXY(this.getEl());this.lastPageX=aCoord[0],this.lastPageY=aCoord[1]}},autoScroll:function(x,y,h,w){if(this.scroll){var clientH=Ext.Element.getViewHeight(),clientW=Ext.Element.getViewWidth(),st=this.DDMInstance.getScrollTop(),sl=this.DDMInstance.getScrollLeft(),bot=h+y,right=w+x,toBot=clientH+st-y-this.deltaY,toRight=clientW+sl-x-this.deltaX,thresh=40,scrAmt=document.all?80:30;bot>clientH&&toBot<thresh&&window.scrollTo(sl,st+scrAmt),y<st&&st>0&&y-st<thresh&&window.scrollTo(sl,st-scrAmt),right>clientW&&toRight<thresh&&window.scrollTo(sl+scrAmt,st),x<sl&&sl>0&&x-sl<thresh&&window.scrollTo(sl-scrAmt,st)}},getTargetCoord:function(iPageX,iPageY){var x=iPageX-this.deltaX,y=iPageY-this.deltaY;return this.constrainX&&(x<this.minX&&(x=this.minX),x>this.maxX&&(x=this.maxX)),this.constrainY&&(y<this.minY&&(y=this.minY),y>this.maxY&&(y=this.maxY)),x=this.getTick(x,this.xTicks),y=this.getTick(y,this.yTicks),{x:x,y:y}},applyConfig:function(){this.callParent(),this.scroll=this.config.scroll!==!1},b4MouseDown:function(e){this.autoOffset(e.getPageX(),e.getPageY())},b4Drag:function(e){this.setDragElPos(e.getPageX(),e.getPageY())},toString:function(){return"DD "+this.id},getLocalX:function(el){return el.getLocalX()},setLocalXY:function(el,x,y){el.setLocalXY(x,y)}}),Ext.define("Ext.dd.DDProxy",{extend:Ext.dd.DD,statics:{dragElId:"ygddfdiv"},constructor:function(id,sGroup,config){id&&(this.init(id,sGroup,config),this.initFrame())},resizeFrame:!0,centerFrame:!1,createFrame:function(){var div,s,self=this,body=document.body;return body&&body.firstChild?(div=this.getDragEl(),void(div||(div=document.createElement("div"),div.id=this.dragElId,div.setAttribute("role","presentation"),s=div.style,s.position="absolute",s.visibility="hidden",s.cursor="move",s.border="2px solid #aaa",s.zIndex=999,body.insertBefore(div,body.firstChild)))):void setTimeout(function(){self.createFrame()},50)},initFrame:function(){this.createFrame()},applyConfig:function(){this.callParent(),this.resizeFrame=this.config.resizeFrame!==!1,this.centerFrame=this.config.centerFrame,this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(iPageX,iPageY){var dragEl=(this.getEl(),this.getDragEl()),s=dragEl.style;this._resizeProxy(),this.centerFrame&&this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2)),this.setDragElPos(iPageX,iPageY),Ext.fly(dragEl).show()},_resizeProxy:function(){if(this.resizeFrame){var el=this.getEl();Ext.fly(this.getDragEl()).setSize(el.offsetWidth,el.offsetHeight)}},b4MouseDown:function(e){var x=e.getPageX(),y=e.getPageY();this.autoOffset(x,y),this.setDragElPos(x,y)},b4StartDrag:function(x,y){this.showFrame(x,y)},b4EndDrag:function(e){Ext.fly(this.getDragEl()).hide()},endDrag:function(e){var lel=this.getEl(),del=this.getDragEl();del.style.visibility="",this.beforeMove(),lel.style.visibility="hidden",Ext.dd.DDM.moveToEl(lel,del),del.style.visibility="hidden",lel.style.visibility="",this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return"DDProxy "+this.id}}),Ext.define("Ext.dd.StatusProxy",{extend:Ext.Component,animRepair:!1,childEls:["ghost"],renderTpl:['<div class="'+Ext.baseCSSPrefix+'dd-drop-icon" role="presentation"></div><div id="{id}-ghost" class="'+Ext.baseCSSPrefix+'dd-drag-ghost" role="presentation"></div>'],repairCls:Ext.baseCSSPrefix+"dd-drag-repair",
ariaRole:"presentation",constructor:function(config){var me=this;config=config||{},Ext.apply(me,{hideMode:"visibility",hidden:!0,floating:!0,id:me.id||Ext.id(),cls:Ext.baseCSSPrefix+"dd-drag-proxy "+this.dropNotAllowed,shadow:config.shadow||!1,renderTo:Ext.getDetachedBody()}),me.callParent(arguments),this.dropStatus=this.dropNotAllowed},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",setStatus:function(cssClass){cssClass=cssClass||this.dropNotAllowed,this.dropStatus!=cssClass&&(this.el.replaceCls(this.dropStatus,cssClass),this.dropStatus=cssClass)},reset:function(clearGhost){var me=this,clsPrefix=Ext.baseCSSPrefix+"dd-drag-proxy ";me.el.replaceCls(clsPrefix+me.dropAllowed,clsPrefix+me.dropNotAllowed),me.dropStatus=me.dropNotAllowed,clearGhost&&me.ghost.update("")},update:function(html){"string"==typeof html?this.ghost.update(html):(this.ghost.update(""),html.style.margin="0",this.ghost.dom.appendChild(html));var el=this.ghost.dom.firstChild;el&&Ext.fly(el).setStyle("float","none")},getGhost:function(){return this.ghost},hide:function(clear){this.callParent(),clear&&this.reset(!0)},stop:function(){this.anim&&this.anim.isAnimated&&this.anim.isAnimated()&&this.anim.stop()},sync:function(){this.el.sync()},repair:function(xy,callback,scope){var me=this;me.callback=callback,me.scope=scope,xy&&me.animRepair!==!1?(me.el.addCls(me.repairCls),me.el.hideUnders(!0),me.anim=me.el.animate({duration:me.repairDuration||500,easing:"ease-out",to:{x:xy[0],y:xy[1]},stopAnimation:!0,callback:me.afterRepair,scope:me})):me.afterRepair()},afterRepair:function(){var me=this;me.hide(!0),me.el.removeCls(me.repairCls),"function"==typeof me.callback&&me.callback.call(me.scope||me),delete me.callback,delete me.scope}}),Ext.define("Ext.dd.DragSource",{extend:Ext.dd.DDProxy,dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",animRepair:!0,repairHighlightColor:"c3daf9",constructor:function(el,config){this.el=Ext.get(el),this.dragData||(this.dragData={}),Ext.apply(this,config),this.proxy||(this.proxy=new Ext.dd.StatusProxy({id:this.el.id+"-drag-status-proxy",animRepair:this.animRepair})),this.callParent([this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:!1,isTarget:!1,scroll:this.scroll===!0}]),this.dragging=!1},getDragData:function(e){return this.dragData},onDragEnter:function(e,id){var status,target=Ext.dd.DragDropManager.getDDById(id);this.cachedTarget=target,this.beforeDragEnter(target,e,id)!==!1&&(target.isNotifyTarget?(status=target.notifyEnter(this,e,this.dragData),this.proxy.setStatus(status)):this.proxy.setStatus(this.dropAllowed),this.afterDragEnter&&this.afterDragEnter(target,e,id))},beforeDragEnter:function(target,e,id){return!0},onDragOver:function(e,id){var status,target=this.cachedTarget||Ext.dd.DragDropManager.getDDById(id);this.beforeDragOver(target,e,id)!==!1&&(target.isNotifyTarget&&(status=target.notifyOver(this,e,this.dragData),this.proxy.setStatus(status)),this.afterDragOver&&this.afterDragOver(target,e,id))},beforeDragOver:function(target,e,id){return!0},onDragOut:function(e,id){var target=this.cachedTarget||Ext.dd.DragDropManager.getDDById(id);this.beforeDragOut(target,e,id)!==!1&&(target.isNotifyTarget&&target.notifyOut(this,e,this.dragData),this.proxy.reset(),this.afterDragOut&&this.afterDragOut(target,e,id)),this.cachedTarget=null},beforeDragOut:function(target,e,id){return!0},onDragDrop:function(e,id){var target=this.cachedTarget||Ext.dd.DragDropManager.getDDById(id);this.beforeDragDrop(target,e,id)!==!1&&(target.isNotifyTarget?target.notifyDrop(this,e,this.dragData)!==!1?this.onValidDrop(target,e,id):this.onInvalidDrop(target,e,id):this.onValidDrop(target,e,id),this.afterDragDrop&&this.afterDragDrop(target,e,id)),delete this.cachedTarget},beforeDragDrop:function(target,e,id){return!0},onValidDrop:function(target,e,id){this.hideProxy(),this.afterValidDrop&&this.afterValidDrop(target,e,id)},getRepairXY:function(e,data){return this.el.getXY()},onInvalidDrop:function(target,e,id){var me=this;e||(e=target,target=null,id=e.getTarget().id),me.beforeInvalidDrop(target,e,id)!==!1&&(me.cachedTarget&&(me.cachedTarget.isNotifyTarget&&me.cachedTarget.notifyOut(me,e,me.dragData),me.cacheTarget=null),me.proxy.repair(me.getRepairXY(e,me.dragData),me.afterRepair,me),me.afterInvalidDrop&&me.afterInvalidDrop(e,id))},afterRepair:function(){var me=this;Ext.enableFx&&me.el.highlight(me.repairHighlightColor),me.dragging=!1},beforeInvalidDrop:function(target,e,id){return!0},handleMouseDown:function(e){if(!this.dragging){var data=this.getDragData(e);data&&this.onBeforeDrag(data,e)!==!1&&(this.dragData=data,this.proxy.stop(),this.callParent(arguments))}},onBeforeDrag:function(data,e){return!0},onStartDrag:Ext.emptyFn,alignElWithMouse:function(){return this.proxy.ensureAttachedToBody(!0),this.callParent(arguments)},startDrag:function(x,y){this.proxy.reset(),this.proxy.hidden=!1,this.dragging=!0,this.proxy.update(""),this.onInitDrag(x,y),this.proxy.show()},onInitDrag:function(x,y){var clone=this.el.dom.cloneNode(!0);return clone.id=Ext.id(),this.proxy.update(clone),this.onStartDrag(x,y),!0},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide(),this.proxy.reset(!0),this.dragging=!1},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(e){},endDrag:function(e){this.onEndDrag(this.dragData,e)},onEndDrag:function(data,e){},autoOffset:function(x,y){this.setDelta(-12,-20)},destroy:function(){this.callParent(),Ext.destroy(this.proxy)}}),Ext.define("Ext.panel.Proxy",{alternateClassName:"Ext.dd.PanelProxy",moveOnDrag:!0,constructor:function(panel,config){var me=this;me.panel=panel,me.id=me.panel.id+"-ddproxy",Ext.apply(me,config)},insertProxy:!0,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost.el},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){var me=this;me.ghost&&(me.proxy&&(me.proxy.remove(),delete me.proxy),me.panel.unghost(null,me.moveOnDrag),delete me.ghost)},show:function(){var panelSize,me=this;me.ghost||(panelSize=me.panel.getSize(),me.panel.el.setVisibilityMode(Ext.Element.DISPLAY),me.ghost=me.panel.ghost(),me.insertProxy&&(me.proxy=me.panel.el.insertSibling({role:"presentation",cls:Ext.baseCSSPrefix+"panel-dd-spacer"}),me.proxy.setSize(panelSize)))},repair:function(xy,callback,scope){this.hide(),Ext.callback(callback,scope||this)},moveProxy:function(parentNode,before){this.proxy&&parentNode.insertBefore(this.proxy.dom,before)}}),Ext.define("Ext.panel.DD",{extend:Ext.dd.DragSource,constructor:function(panel,cfg){var me=this;me.panel=panel,me.dragData={panel:panel},me.panelProxy=new Ext.panel.Proxy(panel,cfg),me.proxy=me.panelProxy.proxy,me.callParent([panel.el,cfg]),me.setupEl(panel)},setupEl:function(panel){var me=this,header=panel.header,el=panel.body;header&&(me.setHandleElId(header.id),el=header.el),el?(el.setStyle("cursor","move"),me.scroll=!1):panel.on("boxready",me.setupEl,me,{single:!0})},showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(x,y){this.panelProxy.show()},b4MouseDown:function(e){var x=e.getPageX(),y=e.getPageY();this.autoOffset(x,y)},onInitDrag:function(x,y){return this.onStartDrag(x,y),!0},createFrame:Ext.emptyFn,getDragEl:function(e){var ghost=this.panelProxy.ghost;if(ghost)return ghost.el.dom},endDrag:function(e){this.panelProxy.hide(),this.panel.saveState()},autoOffset:function(x,y){x-=this.startPageX,y-=this.startPageY,this.setDelta(x,y)},onInvalidDrop:function(target,e,id){var me=this;me.beforeInvalidDrop(target,e,id)!==!1&&(me.cachedTarget&&(me.cachedTarget.isNotifyTarget&&me.cachedTarget.notifyOut(me,e,me.dragData),me.cacheTarget=null),me.afterInvalidDrop&&me.afterInvalidDrop(e,id))}}),Ext.define("Ext.util.Memento",function(){function captureOne(src,target,prop,prefix){src[prefix?prefix+prop:prop]=target[prop]}function removeOne(src,target,prop){delete src[prop]}function restoreOne(src,target,prop,prefix){var name=prefix?prefix+prop:prop,value=src[name];(value||src.hasOwnProperty(name))&&restoreValue(target,prop,value)}function restoreValue(target,prop,value){Ext.isDefined(value)?target[prop]=value:delete target[prop]}function doMany(doOne,src,target,props,prefix){if(src)if(Ext.isArray(props)){var p,pLen=props.length;for(p=0;p<pLen;p++)doOne(src,target,props[p],prefix)}else doOne(src,target,props,prefix)}return{data:null,target:null,constructor:function(target,props){target&&(this.target=target,props&&this.capture(props))},capture:function(props,target,prefix){var me=this;doMany(captureOne,me.data||(me.data={}),target||me.target,props,prefix)},remove:function(props){doMany(removeOne,this.data,null,props)},restore:function(props,clear,target,prefix){doMany(restoreOne,this.data,target||this.target,props,prefix),clear!==!1&&this.remove(props)},restoreAll:function(clear,target){var prop,me=this,t=target||this.target,data=me.data;for(prop in data)data.hasOwnProperty(prop)&&restoreValue(t,prop,data[prop]);clear!==!1&&delete me.data}}}()),Ext.define("Ext.panel.Panel",{extend:Ext.panel.AbstractPanel,alias:"widget.panel",alternateClassName:"Ext.Panel",collapsedCls:"collapsed",animCollapse:Ext.enableFx,minButtonWidth:75,collapsed:!1,collapseFirst:!0,hideCollapseTool:!1,titleCollapse:void 0,floatable:!0,collapsible:void 0,closable:!1,closeAction:"destroy",placeholderCollapseHideMode:Ext.Element.VISIBILITY,preventHeader:!1,header:void 0,headerPosition:"top",frame:!1,frameHeader:!0,manageHeight:!0,constrain:!1,constrainHeader:!1,initComponent:function(){var me=this;me.addEvents("beforeclose","close","beforeexpand","beforecollapse","expand","collapse","titlechange","iconchange","iconclschange","glyphchange","float","unfloat"),me.collapsible&&me.addStateEvents(["expand","collapse"]),me.unstyled&&me.setUI("plain"),me.frame&&me.setUI(me.ui+"-framed"),me.bridgeToolbars(),me.callParent(),me.collapseDirection=me.collapseDirection||me.headerPosition||Ext.Component.DIRECTION_TOP,me.hiddenOnCollapse=new Ext.dom.CompositeElement},beforeDestroy:function(){var me=this;Ext.destroy(me.placeholder,me.ghostPanel,me.dd),me.callParent()},getFocusEl:function(){return this.el},getHeader:function(){return this.header},setTitle:function(newTitle){var me=this,oldTitle=me.title,header=me.header,reExpander=me.reExpander,placeholder=me.placeholder;me.title=newTitle,header?header.isHeader?header.setTitle(newTitle):header.title=newTitle:me.rendered&&me.updateHeader(),reExpander&&reExpander.setTitle(newTitle),placeholder&&placeholder.setTitle&&placeholder.setTitle(newTitle),me.fireEvent("titlechange",me,newTitle,oldTitle)},setIconCls:function(newIconCls){var me=this,oldIconCls=me.iconCls,header=me.header,placeholder=me.placeholder;me.iconCls=newIconCls,header?header.isHeader?header.setIconCls(newIconCls):header.iconCls=newIconCls:me.updateHeader(),placeholder&&placeholder.setIconCls&&placeholder.setIconCls(newIconCls),me.fireEvent("iconclschange",me,newIconCls,oldIconCls)},setIcon:function(newIcon){var me=this,oldIcon=me.icon,header=me.header,placeholder=me.placeholder;me.icon=newIcon,header?header.isHeader?header.setIcon(newIcon):header.icon=newIcon:me.updateHeader(),placeholder&&placeholder.setIcon&&placeholder.setIcon(newIcon),me.fireEvent("iconchange",me,newIcon,oldIcon)},setGlyph:function(newGlyph){var me=this,oldGlyph=me.glyph,header=me.header,placeholder=me.placeholder;me.glyph=newGlyph,header?header.isHeader?header.setGlyph(newGlyph):header.glyph=newGlyph:me.updateHeader(),placeholder&&placeholder.setGlyph&&placeholder.setIcon(newGlyph),me.fireEvent("glyphchange",me,newGlyph,oldGlyph)},bridgeToolbars:function(){function initToolbar(toolbar,pos,useButtonAlign){return Ext.isArray(toolbar)?toolbar={xtype:"toolbar",items:toolbar}:toolbar.xtype||(toolbar.xtype="toolbar"),toolbar.dock=pos,"left"!=pos&&"right"!=pos||(toolbar.vertical=!0),useButtonAlign&&(toolbar.layout=Ext.applyIf(toolbar.layout||{},{pack:{left:"start",center:"center"}[me.buttonAlign]||"end"})),toolbar}var fbar,fbarDefaults,me=this,docked=[],minButtonWidth=me.minButtonWidth;me.tbar&&(docked.push(initToolbar(me.tbar,"top")),me.tbar=null),me.bbar&&(docked.push(initToolbar(me.bbar,"bottom")),me.bbar=null),me.buttons&&(me.fbar=me.buttons,me.buttons=null),me.fbar&&(fbar=initToolbar(me.fbar,"bottom",!0),fbar.ui="footer",minButtonWidth&&(fbarDefaults=fbar.defaults,fbar.defaults=function(config){var cls,defaults=fbarDefaults||{},isButton=!config.xtype||config.isButton;return isButton||(cls=Ext.ClassManager.getByAlias("widget."+config.xtype),cls&&(isButton=cls.prototype.isButton)),!isButton||"minWidth"in defaults||(defaults=Ext.apply({minWidth:minButtonWidth},defaults)),defaults}),docked.push(fbar),me.fbar=null),me.lbar&&(docked.push(initToolbar(me.lbar,"left")),me.lbar=null),me.rbar&&(docked.push(initToolbar(me.rbar,"right")),me.rbar=null),me.dockedItems?(Ext.isArray(me.dockedItems)||(me.dockedItems=[me.dockedItems]),me.dockedItems=me.dockedItems.concat(docked)):me.dockedItems=docked},isPlaceHolderCollapse:function(){return"placeholder"==this.collapseMode},onBoxReady:function(){this.callParent(),this.collapsed&&this.setHiddenDocked()},beforeRender:function(){var wasCollapsed,me=this;me.callParent(),me.initTools(),me.preventHeader||me.header===!1||me.updateHeader(),me.collapsed&&(me.isPlaceHolderCollapse()?me.hidden||(me.setHiddenState(!0),me.preventCollapseFire=!0,me.placeholderCollapse(),delete me.preventCollapseFire,wasCollapsed=me.collapsed,me.collapsed=!1):(me.beginCollapse(),me.addClsWithUI(me.collapsedCls))),wasCollapsed&&(me.collapsed=wasCollapsed)},initTools:function(){var i,tool,me=this,tools=me.tools;for(me.tools=[],i=tools&&tools.length;i;)--i,me.tools[i]=tool=tools[i],tool.toolOwner=me;!me.collapsible||me.hideCollapseTool||me.header===!1||me.preventHeader||(me.collapseDirection=me.collapseDirection||me.headerPosition||"top",me.collapseTool=me.expandTool=Ext.widget({xtype:"tool",handler:me.toggleCollapse,scope:me}),me.updateCollapseTool(),me.collapseFirst&&me.tools.unshift(me.collapseTool)),me.addTools(),me.closable&&(me.addClsWithUI("closable"),me.addTool(Ext.widget({xtype:"tool",type:"close",handler:Ext.Function.bind(me.close,me,[])}))),me.collapseTool&&!me.collapseFirst&&me.addTool(me.collapseTool)},addTools:Ext.emptyFn,updateCollapseTool:function(){var me=this,collapseTool=me.collapseTool;collapseTool&&(me.collapsed&&!me.isPlaceHolderCollapse()?collapseTool.setType("expand-"+me.getOppositeDirection(me.collapseDirection)):collapseTool.setType("collapse-"+me.collapseDirection))},close:function(){this.fireEvent("beforeclose",this)!==!1&&this.doClose()},doClose:function(){this.fireEvent("close",this),this[this.closeAction]()},updateHeader:function(force){var me=this,header=me.header,title=me.title,tools=me.tools,icon=me.icon||me.iconCls,vertical="left"===me.headerPosition||"right"===me.headerPosition;Ext.isObject(header)||header!==!1&&(force||title||icon||tools&&tools.length||me.collapsible&&!me.titleCollapse)?header&&header.isHeader?header.show():(header=me.header=Ext.widget(Ext.apply({xtype:"header",title:title,titleAlign:me.titleAlign,orientation:vertical?"vertical":"horizontal",dock:me.headerPosition||"top",textCls:me.headerTextCls,iconCls:me.iconCls,icon:me.icon,glyph:me.glyph,baseCls:me.baseCls+"-header",tools:tools,ui:me.ui,id:me.id+"_header",overCls:me.headerOverCls,indicateDrag:me.draggable,frame:(me.frame||me.alwaysFramed)&&me.frameHeader,ignoreParentFrame:me.frame||me.overlapHeader,ignoreBorderManagement:me.frame||me.ignoreHeaderBorderManagement,headerRole:me.headerRole,ownerCt:me,listeners:me.collapsible&&me.titleCollapse?{click:me.toggleCollapse,scope:me}:null},me.header)),me.addDocked(header,0)):header&&header.hide()},setUI:function(ui){var me=this;me.callParent(arguments),me.header&&me.header.rendered&&me.header.setUI(ui)},getDefaultContentTarget:function(){return this.body},getTargetEl:function(){var me=this;return me.body||me.protoBody||me.frameBody||me.el},isVisible:function(deep){var me=this;return me.collapsed&&me.placeholder?me.placeholder.isVisible(deep):me.callParent(arguments)},onHide:function(){var me=this,dd=me.dd;me.floatedFromCollapse&&me.slideOutFloatedPanel(!0),me.draggable&&dd&&dd.endDrag(),me.collapsed&&me.placeholder?me.placeholder.hide():me.callParent(arguments)},onShow:function(){var me=this;me.collapsed&&me.isPlaceHolderCollapse()?(me.setHiddenState(!0),me.placeholderCollapse()):me.callParent(arguments)},onRemoved:function(destroying){var me=this;me.placeholder&&!destroying&&me.ownerCt.remove(me.placeholder,!1),me.callParent(arguments)},addTool:function(tools){Ext.isArray(tools)||(tools=[tools]);var t,tool,me=this,header=me.header,tLen=tools.length;for(t=0;t<tLen;t++)tool=tools[t],tool.toolOwner=me,header&&header.isHeader?header.addTool(tool):me.tools.push(tool);me.updateHeader()},getOppositeDirection:function(d){var c=Ext.Component;switch(d){case c.DIRECTION_TOP:return c.DIRECTION_BOTTOM;case c.DIRECTION_RIGHT:return c.DIRECTION_LEFT;case c.DIRECTION_BOTTOM:return c.DIRECTION_TOP;case c.DIRECTION_LEFT:return c.DIRECTION_RIGHT}},getWidthAuthority:function(){return this.collapsed&&this.collapsedHorizontal()?1:this.callParent()},getHeightAuthority:function(){return this.collapsed&&this.collapsedVertical()?1:this.callParent()},collapsedHorizontal:function(){var dir=this.getCollapsed();return"left"===dir||"right"===dir},collapsedVertical:function(){var dir=this.getCollapsed();return"top"===dir||"bottom"===dir},restoreDimension:function(){var dir=this.collapseDirection;return"top"===dir||"bottom"===dir?"height":"width"},getCollapsed:function(){var me=this;return me.collapsed===!0?me.collapseDirection:me.collapsed},getState:function(){var memento,me=this,state=me.callParent();return state=me.addPropertyToState(state,"collapsed"),me.collapsed&&(memento=me.collapseMemento,memento=memento&&memento.data,me.collapsedVertical()?(state&&delete state.height,memento&&(state=me.addPropertyToState(state,"height",memento.height))):(state&&delete state.width,memento&&(state=me.addPropertyToState(state,"width",memento.width)))),state},findReExpander:function(direction){var comp,i,me=this,c=Ext.Component,dockedItems=me.dockedItems.items,dockedItemCount=dockedItems.length;if("mini"!==me.collapseMode)switch(direction){case c.DIRECTION_TOP:case c.DIRECTION_BOTTOM:for(i=0;i<dockedItemCount;i++)if(comp=dockedItems[i],!comp.hidden&&comp.isHeader&&(!comp.dock||"top"===comp.dock||"bottom"===comp.dock))return comp;break;case c.DIRECTION_LEFT:case c.DIRECTION_RIGHT:for(i=0;i<dockedItemCount;i++)if(comp=dockedItems[i],!comp.hidden&&comp.isHeader&&("left"===comp.dock||"right"===comp.dock))return comp;break;default:throw"Panel#findReExpander must be passed a valid collapseDirection"}},getReExpander:function(direction){var me=this,collapseDir=direction||me.collapseDirection,reExpander=me.reExpander||me.findReExpander(collapseDir);return me.expandDirection=me.getOppositeDirection(collapseDir),reExpander||(me.reExpander=reExpander=me.createReExpander(collapseDir,{dock:collapseDir,cls:Ext.baseCSSPrefix+"docked "+me.baseCls+"-"+me.ui+"-collapsed",isCollapsedExpander:!0}),me.dockedItems.insert(0,reExpander)),reExpander},createReExpander:function(direction,defaults){var me=this,isLeft="left"===direction,isRight="right"===direction,isVertical=isLeft||isRight,ownerCt=me.ownerCt,result=Ext.apply({hideMode:"offsets",title:me.title||"&#160;",titleAlign:me.titleAlign,orientation:isVertical?"vertical":"horizontal",textCls:me.headerTextCls,icon:me.icon,iconCls:me.iconCls,glyph:me.glyph,baseCls:me.self.prototype.baseCls+"-header",ui:me.ui,frame:me.frame&&me.frameHeader,ignoreParentFrame:me.frame||me.overlapHeader,ignoreBorderManagement:me.frame||me.ignoreHeaderBorderManagement,indicateDrag:me.draggable,collapseImmune:!0,headerRole:me.headerRole,ownerCt:ownerCt&&"placeholder"===me.collapseMode?ownerCt:me,ownerLayout:me.componentLayout,margin:me.margin},defaults);return"mini"===me.collapseMode&&(isVertical?result.width=1:result.height=1),me.hideCollapseTool||((isLeft||isRight&&me.isPlaceHolderCollapse())&&(result.titlePosition=1),result.tools=[{xtype:"tool",type:"expand-"+me.getOppositeDirection(direction),uiCls:["top"],handler:me.toggleCollapse,scope:me}]),result=new Ext.panel.Header(result),result.addClsWithUI(me.getHeaderCollapsedClasses(result)),result},getHeaderCollapsedClasses:function(header){var collapsedClasses,me=this,collapsedCls=me.collapsedCls;return collapsedClasses=[collapsedCls,collapsedCls+"-"+header.getDockName()],me.border&&(!me.frame||me.frame&&Ext.supports.CSS3BorderRadius)&&collapsedClasses.push(collapsedCls+"-border-"+header.getDockName()),collapsedClasses},beginCollapse:function(){var reExpander,me=this,lastBox=me.lastBox,rendered=me.rendered,collapseMemento=me.collapseMemento||(me.collapseMemento=new Ext.util.Memento(me)),sizeModel=me.getSizeModel(),header=me.header;collapseMemento.capture(["height","minHeight","width","minWidth"]),lastBox&&collapseMemento.capture(me.restoreDimension(),lastBox,"last."),me.collapsedVertical()?(sizeModel.width.shrinkWrap&&(me.width=rendered?me.getWidth():me.width||me.minWidth||100),delete me.height,me.minHeight=0):me.collapsedHorizontal()&&(sizeModel.height.shrinkWrap&&(me.height=rendered?me.getHeight():me.height||me.minHeight||100),delete me.width,me.minWidth=0),me.ownerCt&&me.ownerCt.getLayout().beginCollapse(me),me.isPlaceHolderCollapse()||header===!1||(header===(reExpander=me.getReExpander())?(header.collapseImmune=!0,header.getHierarchyState().collapseImmune=!0,header.addClsWithUI(me.getHeaderCollapsedClasses(header)),header.rendered&&header.updateFrame()):reExpander.el&&(reExpander.el.show(),reExpander.hidden=!1)),me.resizer&&me.resizer.disable()},beginExpand:function(){var reExpander,me=this,lastBox=me.lastBox,collapseMemento=me.collapseMemento,restoreDimension=me.restoreDimension(),header=me.header;collapseMemento&&(collapseMemento.restore(["minHeight","minWidth",restoreDimension]),lastBox&&collapseMemento.restore(restoreDimension,!0,lastBox,"last.")),me.ownerCt&&me.ownerCt.getLayout().beginExpand(me),me.isPlaceHolderCollapse()||header===!1||(header===(reExpander=me.getReExpander())?(delete header.collapseImmune,delete header.getHierarchyState().collapseImmune,header.removeClsWithUI(me.getHeaderCollapsedClasses(header)),header.rendered&&(header.expanding=!0,header.updateFrame(),delete header.expanding)):(reExpander.hidden=!0,reExpander.el.hide())),me.resizer&&me.resizer.enable()},collapse:function(direction,animate){var me=this,collapseDir=direction||me.collapseDirection,ownerCt=me.ownerCt,layout=me.ownerLayout;return me.isCollapsingOrExpanding?me:(arguments.length<2&&(animate=me.animCollapse),me.collapsed||me.fireEvent("beforecollapse",me,direction,animate)===!1?me:layout&&layout.onBeforeComponentCollapse&&layout.onBeforeComponentCollapse(me)===!1?me:ownerCt&&me.isPlaceHolderCollapse()?me.placeholderCollapse(direction,animate):(me.collapsed=collapseDir,me.beginCollapse(),me.getHierarchyState().collapsed=!0,me.fireHierarchyEvent("collapse"),me.doCollapseExpand(1,animate)))},doCollapseExpand:function(flags,animate){var me=this,originalAnimCollapse=me.animCollapse,ownerLayout=me.ownerLayout;return me.animCollapse=animate,me.isCollapsingOrExpanding=flags,animate&&me.addCls(Ext.baseCSSPrefix+"animating-size"),ownerLayout&&!animate?ownerLayout.onContentChange(me):me.updateLayout({isRoot:!0}),me.animCollapse=originalAnimCollapse,me},afterCollapse:function(animated){var me=this,ownerLayout=me.ownerLayout;me.isCollapsingOrExpanding=0,me.updateCollapseTool(),animated&&me.removeCls(Ext.baseCSSPrefix+"animating-size"),ownerLayout&&animated&&ownerLayout.onContentChange(me),me.setHiddenDocked(),me.fireEvent("collapse",me)},setHiddenDocked:function(){var item,reExpander,me=this,toHide=me.hiddenOnCollapse,items=me.getDockedItems(),len=items.length,i=0;for(me.header!==!1&&(reExpander=me.getReExpander()),toHide.add(me.body);i<len;i++)item=items[i],item&&item!==reExpander&&item.el&&toHide.add(item.el);toHide.setStyle("visibility","hidden")},restoreHiddenDocked:function(){var toShow=this.hiddenOnCollapse;toShow.setStyle("visibility",""),toShow.clear()},getPlaceholder:function(direction){var me=this,collapseDir=direction||me.collapseDirection,listeners=null,placeholder=me.placeholder,floatable=me.floatable,titleCollapse=me.titleCollapse;return placeholder||((floatable||me.collapsible&&titleCollapse)&&(listeners={click:{fn:!titleCollapse&&floatable?me.floatCollapsedPanel:me.toggleCollapse,element:"el",scope:me}}),me.placeholder=placeholder=Ext.widget(me.createReExpander(collapseDir,{id:me.id+"-placeholder",listeners:listeners}))),placeholder.placeholderFor||(placeholder.isComponent||(me.placeholder=placeholder=me.lookupComponent(placeholder)),Ext.applyIf(placeholder,{margins:me.margins,placeholderFor:me}),placeholder.addCls([Ext.baseCSSPrefix+"region-collapsed-placeholder",Ext.baseCSSPrefix+"region-collapsed-"+collapseDir+"-placeholder",me.collapsedCls])),placeholder},placeholderCollapse:function(direction,animate){var slideInDirection,me=this,ownerCt=me.ownerCt,collapseDir=direction||me.collapseDirection,floatCls=Ext.baseCSSPrefix+"border-region-slide-in",placeholder=me.getPlaceholder(collapseDir);return me.isCollapsingOrExpanding=1,me.setHiddenState(!0),me.collapsed=collapseDir,placeholder.rendered?(placeholder.el.dom.parentNode!==me.el.dom.parentNode&&me.el.dom.parentNode.insertBefore(placeholder.el.dom,me.el.dom),placeholder.hidden=!1,placeholder.el.show(),ownerCt.updateLayout()):ownerCt.insert(ownerCt.items.indexOf(me),placeholder),me.rendered?(me.el.setVisibilityMode(me.placeholderCollapseHideMode),animate?(me.el.addCls(floatCls),placeholder.el.hide(),slideInDirection=me.convertCollapseDir(collapseDir),me.el.slideOut(slideInDirection,{preserveScroll:!0,duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls),placeholder.el.show().setStyle("display","none").slideIn(slideInDirection,{easing:"linear",duration:100,listeners:{afteranimate:function(){placeholder.focus(),me.isCollapsingOrExpanding=0,me.fireEvent("collapse",me)}}})}}})):(me.el.hide(),me.isCollapsingOrExpanding=0,me.fireEvent("collapse",me))):(me.isCollapsingOrExpanding=0,me.preventCollapseFire||me.fireEvent("collapse",me)),me},floatCollapsedPanel:function(){var myBox,slideDirection,me=this,placeholder=me.placeholder,ps=placeholder.getSize(),floatCls=Ext.baseCSSPrefix+"border-region-slide-in",collapsed=me.collapsed,layoutOwner=me.ownerCt||me;if(!me.isSliding){if(me.el.hasCls(floatCls))return void me.slideOutFloatedPanel();switch(me.isSliding=!0,placeholder.el.hide(),placeholder.hidden=!0,me.el.show(),me.setHiddenState(!1),me.collapsed=!1,layoutOwner.updateLayout(),myBox=me.getBox(!1,!0),placeholder.el.show(),placeholder.hidden=!1,me.el.hide(),me.setHiddenState(!0),me.collapsed=collapsed,layoutOwner.updateLayout(),me.slideOutTask=me.slideOutTask||new Ext.util.DelayedTask(me.slideOutFloatedPanel,me),placeholder.el.on("mouseleave",me.onMouseLeaveFloated,me),me.el.on("mouseleave",me.onMouseLeaveFloated,me),placeholder.el.on("mouseenter",me.onMouseEnterFloated,me),me.el.on("mouseenter",me.onMouseEnterFloated,me),me.el.addCls(floatCls),me.floated=!0,me.collapseTool&&me.collapseTool.el.hide(),me.collapsed){case"top":me.setLocalXY(myBox.x,myBox.y+ps.height-1);break;case"right":me.setLocalXY(myBox.x-ps.width+1,myBox.y);break;case"bottom":me.setLocalXY(myBox.x,myBox.y-ps.height+1);break;case"left":me.setLocalXY(myBox.x+ps.width-1,myBox.y)}slideDirection=me.convertCollapseDir(me.collapsed),me.floatedFromCollapse=me.collapsed,me.collapsed=!1,me.setHiddenState(!1),me.el.slideIn(slideDirection,{preserveScroll:!0,duration:Ext.Number.from(me.animCollapse,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.isSliding=!1,me.fireEvent("float",me)}}})}},onMouseLeaveFloated:function(e){this.slideOutTask.delay(500)},onMouseEnterFloated:function(e){this.slideOutTask.cancel()},isLayoutRoot:function(){return!!this.floatedFromCollapse||this.callParent()},slideOutFloatedPanel:function(preventAnimate){var collapseDirection,me=this,compEl=me.el;me.isSliding||me.isDestroyed||(me.isSliding=!0,me.floated=!1,me.slideOutFloatedPanelBegin(),"string"==typeof me.collapsed&&(collapseDirection=me.convertCollapseDir(me.collapsed)),compEl.slideOut(collapseDirection,{preserveScroll:!0,duration:Ext.Number.from(me.animCollapse,Ext.fx.Anim.prototype.duration),autoEnd:preventAnimate===!0,listeners:{afteranimate:function(){me.slideOutFloatedPanelEnd(),me.el.removeCls(Ext.baseCSSPrefix+"border-region-slide-in")}}}))},slideOutFloatedPanelBegin:function(){var me=this,placeholderEl=me.placeholder.el,el=me.el;me.collapsed=me.floatedFromCollapse,me.setHiddenState(!0),me.floatedFromCollapse=null,placeholderEl.un("mouseleave",me.onMouseLeaveFloated,me),el.un("mouseleave",me.onMouseLeaveFloated,me),placeholderEl.un("mouseenter",me.onMouseEnterFloated,me),el.un("mouseenter",me.onMouseEnterFloated,me)},slideOutFloatedPanelEnd:function(suppressEvents){var me=this;me.collapseTool&&me.collapseTool.el.show(),me.slideOutTask.cancel(),me.isSliding=!1,suppressEvents||me.fireEvent("unfloat",me)},expand:function(animate){var me=this,layout=me.ownerLayout;return me.isCollapsingOrExpanding?me:(arguments.length||(animate=me.animCollapse),me.collapsed||me.floatedFromCollapse?me.fireEvent("beforeexpand",me,animate)===!1?me:layout&&layout.onBeforeComponentExpand&&layout.onBeforeComponentExpand(me)===!1?me:(delete me.getHierarchyState().collapsed,me.isPlaceHolderCollapse()?me.placeholderExpand(animate):(me.restoreHiddenDocked(),me.beginExpand(),me.collapsed=!1,me.doCollapseExpand(2,animate))):me)},placeholderExpand:function(animate){var finalPos,floatedPos,me=this,collapseDir=me.collapsed,floatCls=Ext.baseCSSPrefix+"border-region-slide-in",center=me.ownerLayout?me.ownerLayout.centerRegion:null;return Ext.AbstractComponent.layoutSuspendCount&&(animate=!1),me.floatedFromCollapse&&(floatedPos=me.getPosition(!0),me.slideOutFloatedPanelBegin(),me.slideOutFloatedPanelEnd(),me.floated=!1),animate?(Ext.suspendLayouts(),me.placeholder.hide(),me.el.show(),me.collapsed=!1,me.setHiddenState(!1),center&&!floatedPos&&(center.hidden=!0),Ext.resumeLayouts(!0),center.hidden=!1,me.el.addCls(floatCls),me.isCollapsingOrExpanding=2,floatedPos?(finalPos=me.getXY(),me.setLocalXY(floatedPos[0],floatedPos[1]),me.setXY([finalPos[0],finalPos[1]],{duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls),me.isCollapsingOrExpanding=0,me.fireEvent("expand",me)}}})):(me.el.hide(),me.placeholder.el.show(),me.placeholder.hidden=!1,me.setHiddenState(!1),me.el.slideIn(me.convertCollapseDir(collapseDir),{preserveScroll:!0,duration:Ext.Number.from(animate,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){me.el.removeCls(floatCls),me.placeholder.hide(),me.updateLayout(),me.isCollapsingOrExpanding=0,me.fireEvent("expand",me)}}}))):(me.floated=me.collapsed=!1,me.el.removeCls(floatCls),Ext.suspendLayouts(),me.placeholder.hide(),me.show(),Ext.resumeLayouts(!0),me.fireEvent("expand",me)),me},afterExpand:function(animated){var me=this,ownerLayout=me.ownerLayout;me.isCollapsingOrExpanding=0,me.updateCollapseTool(),animated&&me.removeCls(Ext.baseCSSPrefix+"animating-size"),ownerLayout&&animated&&ownerLayout.onContentChange(me),me.fireEvent("expand",me),me.fireHierarchyEvent("expand")},setBorder:function(border,targetEl){if(!targetEl){var me=this,header=me.header;border=border?border===!0?"1px":me.unitizeBox(border):0,header&&(header.isHeader?header.setBorder(border):header.border=border),me.rendered&&me.bodyBorder!==!1&&me.body.setStyle("border-width",border),me.updateLayout(),me.border=border}},toggleCollapse:function(){return this.collapsed||this.floatedFromCollapse?this.expand():this.collapse()},getKeyMap:function(){return this.keyMap||(this.keyMap=new Ext.util.KeyMap(Ext.apply({target:this.el},this.keys)))},
initDraggable:function(){var me=this;me.simpleDrag?me.initSimpleDraggable():me.dd=new Ext.panel.DD(me,Ext.isBoolean(me.draggable)?null:me.draggable)},initSimpleDraggable:function(){var ddConfig,dd,me=this;me.header||me.updateHeader(!0),me.header&&(ddConfig=Ext.applyIf({el:me.el,delegate:"#"+Ext.escapeId(me.header.id)},me.draggable),(me.constrain||me.constrainHeader)&&(ddConfig.constrain=me.constrain,ddConfig.constrainDelegate=me.constrainHeader,ddConfig.constrainTo=me.constrainTo||me.container),dd=me.dd=new Ext.util.ComponentDragger(me,ddConfig),me.relayEvents(dd,["dragstart","drag","dragend"]),me.maximized&&dd.disable())},ghostTools:function(){var t,tLen,tool,tools=[],header=this.header,headerTools=header?header.query("tool[hidden=false]"):[];if(headerTools.length)for(t=0,tLen=headerTools.length;t<tLen;t++)tool=headerTools[t],tools.push({type:tool.type});else tools=[{type:"placeholder"}];return tools},ghost:function(cls){var ghostHeader,tools,i,me=this,ghostPanel=me.ghostPanel,box=me.getBox(),header=me.header;if(ghostPanel?ghostPanel.el.show():me.ghostPanel=ghostPanel=Ext.widget(me.createGhost(cls)),ghostPanel.setHiddenState(!1),ghostPanel.floatParent=me.floatParent,ghostPanel.toFront(),header&&!me.preventHeader){for(ghostHeader=ghostPanel.header,ghostHeader.suspendLayouts(),tools=ghostHeader.query("tool"),i=tools.length;i--;)ghostHeader.remove(tools[i]);ghostPanel.addTool(me.ghostTools()),ghostPanel.setTitle(me.title),ghostHeader.setTitlePosition(header.titlePosition),me.iconCls?ghostPanel.setIconCls(me.iconCls):me.icon?ghostPanel.setIcon(me.icon):me.glyph&&ghostPanel.setGlyph(me.glyph),ghostHeader.addCls(Ext.baseCSSPrefix+"header-ghost"),ghostHeader.resumeLayouts()}return ghostPanel.setPagePosition(box.x,box.y),ghostPanel.setSize(box.width,box.height),me.el.hide(),ghostPanel},createGhost:function(cls){var me=this,header=me.header,frame=me.frame&&!me.alwaysFramed;return{xtype:"panel",hidden:!1,header:header?{titleAlign:header.titleAlign}:null,ui:frame?me.ui.replace(/-framed$/,""):me.ui,id:me.id+"-ghost",renderTo:Ext.getBody(),resizable:!1,floating:{shadow:!1},frame:frame,alwaysFramed:me.alwaysFramed,overlapHeader:me.overlapHeader,headerPosition:me.headerPosition,baseCls:me.baseCls,cls:me.baseCls+"-ghost "+(cls||"")}},unghost:function(show,matchPosition){var me=this,ghostPanel=me.ghostPanel;ghostPanel&&(show!==!1&&(me.el.show(),matchPosition!==!1&&(me.setPagePosition(ghostPanel.getXY()),"offsets"==me.hideMode&&delete me.el.hideModeStyles),Ext.defer(me.focus,10,me)),ghostPanel.el.hide(),ghostPanel.setHiddenState(!0))},beginDrag:function(){this.floatingDescendants&&this.floatingDescendants.hide()},endDrag:function(){this.floatingDescendants&&this.floatingDescendants.show()},initResizable:function(){this.callParent(arguments),this.collapsed&&this.resizer.disable()},convertCollapseDir:function(collapseDir){return collapseDir.substr(0,1)}},function(){this.prototype.animCollapse=Ext.enableFx}),Ext.define("Ext.tip.Tip",{extend:Ext.panel.Panel,alternateClassName:"Ext.Tip",minWidth:40,maxWidth:500,shadow:"sides",defaultAlign:"tl-bl?",constrainPosition:!0,autoRender:!0,hidden:!0,baseCls:Ext.baseCSSPrefix+"tip",floating:{shadow:!0,shim:!0},focusOnToFront:!1,closeAction:"hide",alwaysFramed:!0,frameHeader:!1,initComponent:function(){var me=this;me.floating=Ext.apply({},{shadow:me.shadow,constrain:me.constrainPosition},me.self.prototype.floating),me.callParent(arguments),me.constrain=me.constrain||me.constrainPosition},showAt:function(xy){var me=this;this.callParent(arguments),me.isVisible()&&(me.setPagePosition(xy[0],xy[1]),(me.constrainPosition||me.constrain)&&me.doConstrain(),me.toFront(!0))},initDraggable:function(){var me=this;me.draggable={el:me.getDragEl(),delegate:me.header.el,constrain:me,constrainTo:me.el.dom.parentNode},Ext.Component.prototype.initDraggable.call(me)},ghost:void 0,unghost:void 0}),Ext.define("Ext.tip.ToolTip",{extend:Ext.tip.Tip,alias:"widget.tooltip",alternateClassName:"Ext.ToolTip",autoHide:!0,showDelay:500,hideDelay:200,dismissDelay:5e3,trackMouse:!1,anchorToTarget:!0,anchorOffset:0,targetCounter:0,quickShowInterval:250,ariaRole:"tooltip",initComponent:function(){var me=this;me.callParent(arguments),me.lastActive=new Date,me.setTarget(me.target),me.origAnchor=me.anchor},onRender:function(ct,position){var me=this;me.callParent(arguments),me.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+me.getAnchorPosition(),me.anchorEl=me.el.createChild({role:"presentation",cls:Ext.baseCSSPrefix+"tip-anchor "+me.anchorCls})},setTarget:function(target){var tg,me=this,t=Ext.get(target);me.target&&(tg=Ext.get(me.target),me.mun(tg,"mouseover",me.onTargetOver,me),me.mun(tg,"mouseout",me.onTargetOut,me),me.mun(tg,"mousemove",me.onMouseMove,me)),me.target=t,t&&me.mon(t,{freezeEvent:!0,mouseover:me.onTargetOver,mouseout:me.onTargetOut,mousemove:me.onMouseMove,scope:me}),me.anchor&&(me.anchorTarget=me.target)},onMouseMove:function(e){var xy,me=this,t=me.delegate?e.getTarget(me.delegate):me.triggerElement=!0;t?(me.targetXY=e.getXY(),t===me.triggerElement?!me.hidden&&me.trackMouse&&(xy=me.getTargetXY(),me.constrainPosition&&(xy=me.el.adjustForConstraints(xy,me.el.parent())),me.setPagePosition(xy)):(me.hide(),me.lastActive=new Date(0),me.onTargetOver(e))):!me.closable&&me.isVisible()&&me.autoHide!==!1&&me.hide()},getTargetXY:function(){var mouseOffset,offsets,xy,dw,dh,de,bd,scrollX,scrollY,axy,sz,constrainPosition,me=this;if(me.delegate&&(me.anchorTarget=me.triggerElement),me.anchor){if(me.targetCounter++,offsets=me.getOffsets(),xy=me.anchorToTarget&&!me.trackMouse?me.getAlignToXY(me.anchorTarget,me.getAnchorAlign()):me.targetXY,dw=Ext.Element.getViewWidth()-5,dh=Ext.Element.getViewHeight()-5,de=document.documentElement,bd=document.body,scrollX=(de.scrollLeft||bd.scrollLeft||0)+5,scrollY=(de.scrollTop||bd.scrollTop||0)+5,axy=[xy[0]+offsets[0],xy[1]+offsets[1]],sz=me.getSize(),constrainPosition=me.constrainPosition,me.anchorEl.removeCls(me.anchorCls),me.targetCounter<2&&constrainPosition){if(axy[0]<scrollX)return me.anchorToTarget&&(me.defaultAlign="l-r",me.mouseOffset&&(me.mouseOffset[0]*=-1)),me.anchor="left",me.getTargetXY();if(axy[0]+sz.width>dw)return me.anchorToTarget&&(me.defaultAlign="r-l",me.mouseOffset&&(me.mouseOffset[0]*=-1)),me.anchor="right",me.getTargetXY();if(axy[1]<scrollY)return me.anchorToTarget&&(me.defaultAlign="t-b",me.mouseOffset&&(me.mouseOffset[1]*=-1)),me.anchor="top",me.getTargetXY();if(axy[1]+sz.height>dh)return me.anchorToTarget&&(me.defaultAlign="b-t",me.mouseOffset&&(me.mouseOffset[1]*=-1)),me.anchor="bottom",me.getTargetXY()}return me.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+me.getAnchorPosition(),me.anchorEl.addCls(me.anchorCls),me.targetCounter=0,axy}return mouseOffset=me.getMouseOffset(),me.targetXY?[me.targetXY[0]+mouseOffset[0],me.targetXY[1]+mouseOffset[1]]:mouseOffset},getMouseOffset:function(){var me=this,offset=me.anchor?[0,0]:[15,18];return me.mouseOffset&&(offset[0]+=me.mouseOffset[0],offset[1]+=me.mouseOffset[1]),offset},getAnchorPosition:function(){var m,me=this;switch(me.anchor?me.tipAnchor=me.anchor.charAt(0):(m=me.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/),me.tipAnchor=m[1].charAt(0)),me.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var mouseOffset,offsets,me=this,ap=me.getAnchorPosition().charAt(0);if(me.anchorToTarget&&!me.trackMouse)switch(ap){case"t":offsets=[0,9];break;case"b":offsets=[0,-13];break;case"r":offsets=[-13,0];break;default:offsets=[9,0]}else switch(ap){case"t":offsets=[-15-me.anchorOffset,30];break;case"b":offsets=[-19-me.anchorOffset,-13-me.el.dom.offsetHeight];break;case"r":offsets=[-15-me.el.dom.offsetWidth,-13-me.anchorOffset];break;default:offsets=[25,-13-me.anchorOffset]}return mouseOffset=me.getMouseOffset(),offsets[0]+=mouseOffset[0],offsets[1]+=mouseOffset[1],offsets},onTargetOver:function(e){var t,me=this,delegate=me.delegate;me.disabled||e.within(me.target.dom,!0)||(t=!delegate||e.getTarget(delegate),t&&(me.triggerElement=t,me.triggerEvent=e,me.clearTimer("hide"),me.targetXY=e.getXY(),me.delayShow()))},delayShow:function(){var me=this;me.hidden&&!me.showTimer?Ext.Date.getElapsed(me.lastActive)<me.quickShowInterval?me.show():me.showTimer=Ext.defer(me.showFromDelay,me.showDelay,me):me.hidden||me.autoHide===!1||me.show()},showFromDelay:function(){this.fromDelayShow=!0,this.show(),delete this.fromDelayShow},onShowVeto:function(){this.callParent(),delete this.triggerElement,this.clearTimer("show")},onTargetOut:function(e){var me=this,triggerEl=me.triggerElement,target=triggerEl===!0?me.target:triggerEl;me.disabled||!triggerEl||e.within(target,!0)||(me.showTimer&&(me.clearTimer("show"),me.triggerElement=null),me.autoHide!==!1&&me.delayHide())},delayHide:function(){var me=this;me.hidden||me.hideTimer||(me.hideTimer=Ext.defer(me.hide,me.hideDelay,me))},hide:function(){var me=this;me.clearTimer("dismiss"),me.lastActive=new Date,me.anchorEl&&me.anchorEl.hide(),me.callParent(arguments),delete me.triggerElement},show:function(){var me=this;this.callParent(),this.hidden===!1&&(me.setPagePosition(-1e4,-1e4),me.anchor&&(me.anchor=me.origAnchor),me.calledFromShowAt||me.showAt(me.getTargetXY()),me.anchor?(me.syncAnchor(),me.anchorEl.show()):me.anchorEl.hide())},showAt:function(xy){var me=this;me.lastActive=new Date,me.clearTimers(),me.calledFromShowAt=!0,me.isVisible()||this.callParent(arguments),me.isVisible()&&(me.setPagePosition(xy[0],xy[1]),(me.constrainPosition||me.constrain)&&me.doConstrain(),me.toFront(!0),me.el.sync(!0),me.dismissDelay&&me.autoHide!==!1&&(me.dismissTimer=Ext.defer(me.hide,me.dismissDelay,me)),me.anchor?(me.syncAnchor(),me.anchorEl.isVisible()||me.anchorEl.show()):me.anchorEl.hide()),delete me.calledFromShowAt},syncAnchor:function(){var anchorPos,targetPos,offset,me=this;switch(me.tipAnchor.charAt(0)){case"t":anchorPos="b",targetPos="tl",offset=[20+me.anchorOffset,1];break;case"r":anchorPos="l",targetPos="tr",offset=[-1,12+me.anchorOffset];break;case"b":anchorPos="t",targetPos="bl",offset=[20+me.anchorOffset,-1];break;default:anchorPos="r",targetPos="tl",offset=[1,12+me.anchorOffset]}me.anchorEl.alignTo(me.el,anchorPos+"-"+targetPos,offset),me.anchorEl.setStyle("z-index",parseInt(me.el.getZIndex(),10)||1).setVisibilityMode(Ext.Element.DISPLAY)},setPagePosition:function(x,y){var me=this;me.callParent(arguments),me.anchor&&me.syncAnchor()},_timerNames:{},clearTimer:function(name){var me=this,names=me._timerNames,propName=names[name]||(names[name]=name+"Timer"),timer=me[propName];timer&&(clearTimeout(timer),me[propName]=null)},clearTimers:function(){var me=this;me.clearTimer("show"),me.clearTimer("dismiss"),me.clearTimer("hide")},onShow:function(){var me=this;me.callParent(),me.mon(Ext.getDoc(),"mousedown",me.onDocMouseDown,me)},onHide:function(){var me=this;me.callParent(),me.mun(Ext.getDoc(),"mousedown",me.onDocMouseDown,me)},onDocMouseDown:function(e){var me=this;me.closable||e.within(me.el.dom)||(me.disable(),Ext.defer(me.doEnable,100,me))},doEnable:function(){this.isDestroyed||this.enable()},onDisable:function(){this.callParent(),this.clearTimers(),this.hide()},beforeDestroy:function(){var me=this;me.clearTimers(),Ext.destroy(me.anchorEl),delete me.anchorEl,delete me.target,delete me.anchorTarget,delete me.triggerElement,me.callParent()},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this),this.callParent()}}),Ext.define("Ext.tip.QuickTip",{extend:Ext.tip.ToolTip,alias:"widget.quicktip",alternateClassName:"Ext.QuickTip",interceptTitles:!1,title:"&#160;",tagConfig:{namespace:"data-",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor",showDelay:"qshowDelay"},shrinkWrapDock:!0,initComponent:function(){var me=this;me.target=me.target||Ext.getDoc(),me.targets=me.targets||{},me.callParent()},register:function(config){for(var target,j,targetLen,configs=Ext.isArray(config)?config:arguments,i=0,len=configs.length;i<len;i++)if(config=configs[i],target=config.target)if(Ext.isArray(target))for(j=0,targetLen=target.length;j<targetLen;j++)this.targets[Ext.id(target[j])]=config;else this.targets[Ext.id(target)]=config},unregister:function(el){delete this.targets[Ext.id(el)]},cancelShow:function(el){var me=this,activeTarget=me.activeTarget;el=Ext.get(el).dom,me.isVisible()?activeTarget&&activeTarget.el==el&&me.hide():activeTarget&&activeTarget.el==el&&me.clearTimer("show")},getTipCfg:function(e){var cfg,t=e.getTarget(),titleText=t.title;return this.interceptTitles&&titleText&&Ext.isString(titleText)?(t.qtip=titleText,t.removeAttribute("title"),e.preventDefault(),{text:titleText}):(cfg=this.tagConfig,(t=e.getTarget("["+cfg.namespace+cfg.attribute+"]"))?{target:t,text:t.getAttribute(cfg.namespace+cfg.attribute)}:void 0)},onTargetOver:function(e){var hasShowDelay,delay,elTarget,cfg,ns,tipConfig,autoHide,targets,targetEl,value,key,me=this,target=e.getTarget(me.delegate);if(!me.disabled&&(me.targetXY=e.getXY(),target&&1===target.nodeType&&target!=document.documentElement&&target!=document.body)){if(me.activeTarget&&(target==me.activeTarget.el||Ext.fly(me.activeTarget.el).contains(target)))return void(me.targetTextEmpty()?(me.onShowVeto(),delete me.activeTarget):(me.clearTimer("hide"),me.show()));if(target){targets=me.targets;for(key in targets)if(targets.hasOwnProperty(key)&&(value=targets[key],targetEl=Ext.fly(value.target),targetEl&&(targetEl.dom===target||targetEl.contains(target)))){elTarget=targetEl.dom;break}if(elTarget)return me.activeTarget=me.targets[elTarget.id],me.activeTarget.el=target,me.anchor=me.activeTarget.anchor,me.anchor&&(me.anchorTarget=target),hasShowDelay=parseInt(me.activeTarget.showDelay,10),hasShowDelay&&(delay=me.showDelay,me.showDelay=hasShowDelay),me.delayShow(),void(hasShowDelay&&(me.showDelay=delay))}elTarget=Ext.fly(target,"_quicktip-target"),cfg=me.tagConfig,ns=cfg.namespace,tipConfig=me.getTipCfg(e),tipConfig&&(tipConfig.target&&(target=tipConfig.target,elTarget=Ext.fly(target,"_quicktip-target")),autoHide=elTarget.getAttribute(ns+cfg.hide),me.activeTarget={el:target,text:tipConfig.text,width:+elTarget.getAttribute(ns+cfg.width)||null,autoHide:"user"!=autoHide&&"false"!==autoHide,title:elTarget.getAttribute(ns+cfg.title),cls:elTarget.getAttribute(ns+cfg.cls),align:elTarget.getAttribute(ns+cfg.align),showDelay:parseInt(elTarget.getAttribute(ns+cfg.showDelay),10)},me.anchor=elTarget.getAttribute(ns+cfg.anchor),me.anchor&&(me.anchorTarget=target),hasShowDelay=parseInt(me.activeTarget.showDelay,10),hasShowDelay&&(delay=me.showDelay,me.showDelay=hasShowDelay),me.delayShow(),hasShowDelay&&(me.showDelay=delay))}},onTargetOut:function(e){var hasHideDelay,delay,me=this,active=me.activeTarget;active&&e.within(me.activeTarget.el)&&!me.getTipCfg(e)||(me.clearTimer("show"),delete me.activeTarget,me.autoHide!==!1&&(hasHideDelay=active&&parseInt(active.hideDelay,10),hasHideDelay&&(delay=me.hideDelay,me.hideDelay=hasHideDelay),me.delayHide(),hasHideDelay&&(me.hideDelay=delay)))},targetTextEmpty:function(){var el,text,me=this,target=me.activeTarget,cfg=me.tagConfig;return!(!target||(el=target.el,!el||(text=el.getAttribute(cfg.namespace+cfg.attribute),text||me.targets[Ext.id(target.target)])))},show:function(){var me=this,fromDelay=me.fromDelayShow;return fromDelay&&me.targetTextEmpty()?(me.onShowVeto(),void delete me.activeTarget):void me.callParent(arguments)},showAt:function(xy){var dismiss,cls,me=this,target=me.activeTarget,header=me.header;target&&(me.rendered||(me.render(Ext.getBody()),me.activeTarget=target),me.suspendLayouts(),target.title?(me.setTitle(target.title),header.show()):header&&header.hide(),me.update(target.text),me.autoHide=target.autoHide,dismiss=target.dismissDelay,me.dismissDelay=Ext.isNumber(dismiss)?dismiss:me.dismissDelay,target.mouseOffset&&(xy[0]+=target.mouseOffset[0],xy[1]+=target.mouseOffset[1]),cls=me.lastCls,cls&&(me.removeCls(cls),delete me.lastCls),cls=target.cls,cls&&(me.addCls(cls),me.lastCls=cls),me.setWidth(target.width),me.anchor?me.constrainPosition=!1:target.align?(xy=me.getAlignToXY(target.el,target.align),me.constrainPosition=!1):me.constrainPosition=!0,me.resumeLayouts(!0)),me.callParent([xy])},hide:function(){delete this.activeTarget,this.callParent()}}),Ext.define("Ext.tip.QuickTipManager",{singleton:!0,alternateClassName:"Ext.QuickTips",disabled:!1,init:function(autoRender,config){var me=this;if(!me.tip){if(!Ext.isReady)return Ext.onReady(function(){Ext.tip.QuickTipManager.init(autoRender,config)}),!1;var tipConfig=Ext.apply({disabled:me.disabled,id:"ext-quicktips-tip"},config),className=tipConfig.className,xtype=tipConfig.xtype;className?delete tipConfig.className:xtype&&(className="widget."+xtype,delete tipConfig.xtype),autoRender!==!1&&(tipConfig.renderTo=document.body),me.tip=Ext.create(className||"Ext.tip.QuickTip",tipConfig),Ext.quickTipsActive=!0}},destroy:function(){Ext.destroy(this.tip),this.tip=void 0},ddDisable:function(){var me=this,tip=me.tip;tip&&!me.disabled&&tip.disable()},ddEnable:function(){var me=this,tip=me.tip;tip&&!me.disabled&&tip.enable()},enable:function(){var me=this,tip=me.tip;tip&&tip.enable(),me.disabled=!1},disable:function(){var me=this,tip=me.tip;tip&&tip.disable(),me.disabled=!0},isEnabled:function(){var tip=this.tip;return void 0!==tip&&!tip.disabled},getQuickTip:function(){return this.tip},register:function(){var tip=this.tip;tip.register.apply(tip,arguments)},unregister:function(){var tip=this.tip;tip.unregister.apply(tip,arguments)},tips:function(){var tip=this.tip;tip.register.apply(tip,arguments)}}),Ext.define("Ext.app.Application",{extend:Ext.app.Controller,scope:void 0,enableQuickTips:!0,appFolder:"app",appProperty:"app",namespaces:[],autoCreateViewport:!1,paths:null,onClassExtended:function(cls,data,hooks){var onBeforeClassCreated,paths,namespace,ns,appFolder,Controller=Ext.app.Controller,proto=cls.prototype,requires=[];if(namespace=data.name||cls.superclass.name,appFolder=data.appFolder||cls.superclass.appFolder,namespace&&(data.$namespace=namespace,Ext.app.addNamespaces(namespace)),data.namespaces&&Ext.app.addNamespaces(data.namespaces),data["paths processed"])delete data["paths processed"];else if(namespace&&appFolder&&Ext.Loader.setPath(namespace,appFolder),paths=data.paths)for(ns in paths)paths.hasOwnProperty(ns)&&Ext.Loader.setPath(ns,paths[ns]);data.autoCreateViewport&&Controller.processDependencies(proto,requires,namespace,"view",["Viewport"]),requires.length&&(onBeforeClassCreated=hooks.onBeforeCreated,hooks.onBeforeCreated=function(cls,data){var args=Ext.Array.clone(arguments);Ext.require(requires,function(){return onBeforeClassCreated.apply(this,args)})})},constructor:function(config){var me=this;me.callParent(arguments),me.doInit(me),me.initNamespace(),me.initControllers(),me.onBeforeLaunch(),me.finishInitControllers()},initNamespace:function(){var ns,me=this,appProperty=me.appProperty;ns=Ext.namespace(me.name),ns&&(ns.getApplication=function(){return me},appProperty&&(ns[appProperty]||(ns[appProperty]=me)))},initControllers:function(){var me=this,controllers=Ext.Array.from(me.controllers);me.controllers=new Ext.util.MixedCollection;for(var i=0,ln=controllers.length;i<ln;i++)me.getController(controllers[i])},finishInitControllers:function(){var controllers,i,l,me=this;for(controllers=me.controllers.getRange(),i=0,l=controllers.length;i<l;i++)controllers[i].finishInit(me)},launch:Ext.emptyFn,onBeforeLaunch:function(){var controllers,c,cLen,controller,me=this;for(me.enableQuickTips&&me.initQuickTips(),me.autoCreateViewport&&me.initViewport(),me.launch.call(me.scope||me),me.launched=!0,me.fireEvent("launch",me),controllers=me.controllers.items,cLen=controllers.length,c=0;c<cLen;c++)controller=controllers[c],controller.onLaunch(me)},getModuleClassName:function(name,kind){return Ext.app.Controller.getFullName(name,kind,this.name).absoluteName},initQuickTips:function(){Ext.tip.QuickTipManager.init()},initViewport:function(){var viewport=this.getView("Viewport");viewport&&viewport.create()},getController:function(name){var className,controller,me=this,controllers=me.controllers;return controller=controllers.get(name),controller||(className=me.getModuleClassName(name,"controller"),controller=Ext.create(className,{application:me,id:name}),controllers.add(controller),me._initialized&&controller.doInit(me)),controller},getApplication:function(){return this}}),Ext.define("Ext.app.domain.Controller",{extend:Ext.app.EventDomain,singleton:!0,type:"controller",idProperty:"id",constructor:function(){var me=this;me.callParent(),me.monitor(Ext.app.Controller)}}),Ext.define("Ext.direct.Provider",{alias:"direct.provider",mixins:{observable:Ext.util.Observable},isProvider:!0,constructor:function(config){var me=this;Ext.apply(me,config),Ext.applyIf(me,{id:Ext.id(null,"provider-")}),me.addEvents("connect","disconnect","data","exception"),me.mixins.observable.constructor.call(me,config)},isConnected:function(){return!1},connect:Ext.emptyFn,disconnect:Ext.emptyFn}),Ext.define("Ext.app.domain.Direct",{extend:Ext.app.EventDomain,singleton:!0,type:"direct",idProperty:"id",constructor:function(){var me=this;me.callParent(),me.monitor(Ext.direct.Provider)}}),Ext.define("Ext.button.Split",{alias:"widget.splitbutton",extend:Ext.button.Button,alternateClassName:"Ext.SplitButton",arrowCls:"split",split:!0,initComponent:function(){this.callParent(),this.addEvents("arrowclick")},setArrowHandler:function(handler,scope){this.arrowHandler=handler,this.scope=scope},onClick:function(e){var me=this;me.doPreventDefault(e),me.disabled||(me.overMenuTrigger?(e.preventDefault(),me.maybeShowMenu(),me.fireEvent("arrowclick",me,e),me.arrowHandler&&me.arrowHandler.call(me.scope||me,me,e)):(me.doToggle(),me.fireHandler(e)))}}),Ext.define("Ext.button.Cycle",{alias:"widget.cycle",extend:Ext.button.Split,alternateClassName:"Ext.CycleButton",getButtonText:function(item){var me=this,text="";return item&&me.showText===!0?(me.prependText&&(text+=me.prependText),text+=item.text):me.text},setActiveItem:function(item,suppressEvent){var me=this;Ext.isObject(item)||(item=me.menu.getComponent(item)),item&&(me.rendered?(me.setText(me.getButtonText(item)),me.setIconCls(item.iconCls),me.setGlyph(item.glyph)):(me.text=me.getButtonText(item),me.iconCls=item.iconCls,me.glyph=item.glyph),me.activeItem=item,item.checked||item.setChecked(!0,!1),me.forceIcon&&me.setIconCls(me.forceIcon),me.forceGlyph&&me.setGlyph(me.forceGlyph),suppressEvent||me.fireEvent("change",me,item))},getActiveItem:function(){return this.activeItem},initComponent:function(){var items,i,iLen,item,me=this,checked=0;for(me.addEvents("change"),me.changeHandler&&(me.on("change",me.changeHandler,me.scope||me),delete me.changeHandler),items=(me.menu.items||[]).concat(me.items||[]),me.menu=Ext.applyIf({cls:Ext.baseCSSPrefix+"cycle-menu",items:[]},me.menu),iLen=items.length,i=0;i<iLen;i++)item=items[i],item=Ext.applyIf({group:me.id,itemIndex:i,checkHandler:me.checkHandler,scope:me,checked:item.checked||!1},item),me.menu.items.push(item),item.checked&&(checked=i);me.itemCount=me.menu.items.length,me.callParent(arguments),me.on("click",me.toggleSelected,me),me.setActiveItem(checked,me),me.width&&me.showText&&me.addCls(Ext.baseCSSPrefix+"cycle-fixed-width")},checkHandler:function(item,pressed){pressed&&this.setActiveItem(item)},toggleSelected:function(){var checkItem,me=this,m=me.menu;checkItem=me.activeItem.next(":not([disabled])")||m.items.getAt(0),checkItem.setChecked(!0)}}),Ext.define("Ext.chart.Callout",{constructor:function(config){config.callouts&&(config.callouts.styles=Ext.applyIf(config.callouts.styles||{},{color:"#000",font:"11px Helvetica, sans-serif"}),this.callouts=Ext.apply(this.callouts||{},config.callouts),this.calloutsArray=[])},renderCallouts:function(){if(this.callouts){var i,count,j,p,item,label,storeItem,display,me=this,items=me.items,animate=me.chart.animate,config=me.callouts,styles=config.styles,group=me.calloutsArray,store=me.chart.getChartStore(),len=store.getCount(),ratio=items.length/len,previouslyPlacedCallouts=[];for(i=0,count=0;i<len;i++)for(j=0;j<ratio;j++)if(item=items[count],label=group[count],storeItem=store.getAt(i),display=!config.filter||config.filter(storeItem),display||label){label||(group[count]=label=me.onCreateCallout(storeItem,item,i,display,j,count));for(p in label)label[p]&&label[p].setAttributes&&label[p].setAttributes(styles,!0);if(!display)for(p in label)label[p]&&(label[p].setAttributes?label[p].setAttributes({hidden:!0},!0):label[p].setVisible&&label[p].setVisible(!1));config&&config.renderer&&config.renderer(label,storeItem),me.onPlaceCallout(label,storeItem,item,i,display,animate,j,count,previouslyPlacedCallouts),previouslyPlacedCallouts.push(label),count++}else count++;this.hideCallouts(count)}},onCreateCallout:function(storeItem,item,i,display){var me=this,config=(me.calloutsGroup,me.callouts),styles=config?config.styles:void 0,width=styles?styles.width:0,height=styles?styles.height:0,chart=me.chart,surface=chart.surface,calloutObj={lines:!1};return calloutObj.lines=surface.add(Ext.apply({},{type:"path",path:"M0,0",stroke:me.getLegendColor()||"#555"},styles)),config.items&&(calloutObj.panel=new Ext.Panel({style:"position: absolute;",width:width,height:height,items:config.items,renderTo:chart.el})),calloutObj},hideCallouts:function(index){for(var co,p,calloutsArray=this.calloutsArray,len=calloutsArray.length;len-- >index;){co=calloutsArray[len];for(p in co)co[p]&&co[p].hide(!0)}}}),Ext.define("Ext.draw.CompositeSprite",{extend:Ext.util.MixedCollection,mixins:{animate:Ext.util.Animate},autoDestroy:!1,isCompositeSprite:!0,constructor:function(config){var me=this;config=config||{},Ext.apply(me,config),me.addEvents("mousedown","mouseup","mouseover","mouseout","click"),me.id=Ext.id(null,"ext-sprite-group-"),me.callParent()},onClick:function(e){this.fireEvent("click",e)},onMouseUp:function(e){this.fireEvent("mouseup",e)},onMouseDown:function(e){this.fireEvent("mousedown",e)},onMouseOver:function(e){this.fireEvent("mouseover",e)},onMouseOut:function(e){this.fireEvent("mouseout",e)},attachEvents:function(o){var me=this;o.on({scope:me,mousedown:me.onMouseDown,mouseup:me.onMouseUp,mouseover:me.onMouseOver,mouseout:me.onMouseOut,click:me.onClick})},add:function(key,o){var result=this.callParent(arguments);return this.attachEvents(result),result},insert:function(index,key,o){return this.callParent(arguments)},remove:function(o){var me=this;return o.un({scope:me,mousedown:me.onMouseDown,mouseup:me.onMouseUp,mouseover:me.onMouseOver,mouseout:me.onMouseOut,click:me.onClick}),me.callParent(arguments)},getBBox:function(){for(var sprite,bb,i=0,items=this.items,len=this.length,infinity=1/0,minX=infinity,maxHeight=-infinity,minY=infinity,maxWidth=-infinity;i<len;i++)sprite=items[i],sprite.el&&!sprite.bboxExcluded&&(bb=sprite.getBBox(),minX=Math.min(minX,bb.x),minY=Math.min(minY,bb.y),maxHeight=Math.max(maxHeight,bb.height+bb.y),maxWidth=Math.max(maxWidth,bb.width+bb.x));return{x:minX,y:minY,height:maxHeight-minY,width:maxWidth-minX}},setAttributes:function(attrs,redraw){for(var i=0,items=this.items,len=this.length;i<len;i++)items[i].setAttributes(attrs,redraw);return this},hide:function(redraw){for(var i=0,items=this.items,len=this.length;i<len;i++)items[i].hide(redraw);return this},show:function(redraw){for(var i=0,items=this.items,len=this.length;i<len;i++)items[i].show(redraw);return this},redraw:function(){var me=this,i=0,items=me.items,surface=me.getSurface(),len=me.length;if(surface)for(;i<len;i++)surface.renderItem(items[i]);return me},setStyle:function(obj){for(var item,el,i=0,items=this.items,len=this.length;i<len;i++)item=items[i],el=item.el,el&&el.setStyle(obj)},addCls:function(obj){var i=0,items=this.items,surface=this.getSurface(),len=this.length;if(surface)for(;i<len;i++)surface.addCls(items[i],obj)},removeCls:function(obj){var i=0,items=this.items,surface=this.getSurface(),len=this.length;if(surface)for(;i<len;i++)surface.removeCls(items[i],obj)},getSurface:function(){var first=this.first();return first?first.surface:null},destroy:function(){var item,me=this,surface=me.getSurface(),destroySprites=me.autoDestroy;if(surface)for(;me.getCount()>0;)item=me.first(),me.remove(item),surface.remove(item,destroySprites);me.clearListeners()}}),Ext.define("Ext.draw.Surface",{mixins:{observable:Ext.util.Observable},separatorRe:/[, ]+/,enginePriority:["Svg","Vml"],statics:{create:function(config,enginePriority){enginePriority=enginePriority||this.prototype.enginePriority;for(var i=0,len=enginePriority.length;i<len;i++)if(Ext.supports[enginePriority[i]])return Ext.create("Ext.draw.engine."+enginePriority[i],config);return!1},save:function(surface,config){config=config||{};var exportTypes={"image/png":"Image","image/jpeg":"Image","image/svg+xml":"Svg"},prefix=exportTypes[config.type]||"Svg",exporter=Ext.draw.engine[prefix+"Exporter"];return exporter.generate(surface,config)}},availableAttrs:{blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,"dominant-baseline":"auto",fill:"none","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:"",height:0,hidden:!1,href:"http://sencha.com/",opacity:1,path:"M0,0",radius:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"none","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank",text:"","text-anchor":"middle",title:"Ext Draw",width:0,x:0,y:0,zIndex:0},container:void 0,height:352,width:512,x:0,y:0,orderSpritesByZIndex:!0,constructor:function(config){var me=this;config=config||{},Ext.apply(me,config),me.domRef=Ext.getDoc().dom,me.customAttributes={},me.addEvents("mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","click","dblclick"),me.mixins.observable.constructor.call(me),me.getId(),me.initGradients(),me.initItems(),me.renderTo&&(me.render(me.renderTo),delete me.renderTo),me.initBackground(config.background)},initSurface:Ext.emptyFn,renderItem:Ext.emptyFn,renderItems:Ext.emptyFn,setViewBox:function(x,y,width,height){isFinite(x)&&isFinite(y)&&isFinite(width)&&isFinite(height)&&(this.viewBox={x:x,y:y,width:width,height:height},this.applyViewBox())},addCls:Ext.emptyFn,removeCls:Ext.emptyFn,setStyle:Ext.emptyFn,initGradients:function(){if(this.hasOwnProperty("gradients")){var g,gLen,gradients=this.gradients,fn=this.addGradient;if(gradients)for(g=0,gLen=gradients.length;g<gLen&&fn.call(this,gradients[g],g,gLen)!==!1;g++);}},initItems:function(){var items=this.items;this.items=new Ext.draw.CompositeSprite,this.items.autoDestroy=!0,this.groups=new Ext.draw.CompositeSprite,items&&this.add(items)},initBackground:function(config){var gradientId,gradient,me=this,width=me.width,height=me.height;Ext.isString(config)&&(config={fill:config}),config&&(config.gradient?(gradient=config.gradient,gradientId=gradient.id,me.addGradient(gradient),me.background=me.add({type:"rect",isBackground:!0,x:0,y:0,width:width,height:height,fill:"url(#"+gradientId+")",zIndex:-1})):config.fill?me.background=me.add({type:"rect",isBackground:!0,x:0,y:0,width:width,height:height,fill:config.fill,zIndex:-1}):config.image&&(me.background=me.add({type:"image",isBackground:!0,x:0,y:0,width:width,height:height,src:config.image,zIndex:-1})),me.background.bboxExcluded=!0)},setSize:function(w,h){this.applyViewBox()},scrubAttrs:function(sprite){var i,attrs={},exclude={},sattr=sprite.attr;for(i in sattr)this.translateAttrs.hasOwnProperty(i)?(attrs[this.translateAttrs[i]]=sattr[i],exclude[this.translateAttrs[i]]=!0):this.availableAttrs.hasOwnProperty(i)&&!exclude[i]&&(attrs[i]=sattr[i]);return attrs},onClick:function(e){this.processEvent("click",e)},onDblClick:function(e){this.processEvent("dblclick",e)},onMouseUp:function(e){this.processEvent("mouseup",e)},onMouseDown:function(e){this.processEvent("mousedown",e)},onMouseOver:function(e){
this.processEvent("mouseover",e)},onMouseOut:function(e){this.processEvent("mouseout",e)},onMouseMove:function(e){this.fireEvent("mousemove",e)},onMouseEnter:Ext.emptyFn,onMouseLeave:Ext.emptyFn,addGradient:Ext.emptyFn,add:function(){var sprite,items,results,i,ln,item,args=Array.prototype.slice.call(arguments),hasMultipleArgs=args.length>1;if(hasMultipleArgs||Ext.isArray(args[0])){for(items=hasMultipleArgs?args:args[0],results=[],i=0,ln=items.length;i<ln;i++)item=items[i],item=this.add(item),results.push(item);return results}return sprite=this.prepareItems(args[0],!0)[0],this.insertByZIndex(sprite),this.onAdd(sprite),sprite},insertByZIndex:function(sprite){var otherZIndex,me=this,sprites=me.items.items,len=sprites.length,ceil=Math.ceil,zIndex=sprite.attr.zIndex,idx=len,high=idx-1,low=0;if(me.orderSpritesByZIndex&&len&&zIndex<sprites[high].attr.zIndex){for(;low<=high;)if(idx=ceil((low+high)/2),otherZIndex=sprites[idx].attr.zIndex,otherZIndex>zIndex)high=idx-1;else{if(!(otherZIndex<zIndex))break;low=idx+1}for(;idx<len&&sprites[idx].attr.zIndex<=zIndex;)idx++}return me.items.insert(idx,sprite),idx},onAdd:function(sprite){var groups,ln,i,group=sprite.group,draggable=sprite.draggable;if(group){for(groups=[].concat(group),ln=groups.length,i=0;i<ln;i++)group=groups[i],this.getGroup(group).add(sprite);delete sprite.group}draggable&&sprite.initDraggable()},remove:function(sprite,destroySprite){if(sprite){this.items.remove(sprite);var g,groups=[].concat(this.groups.items),gLen=groups.length;for(g=0;g<gLen;g++)groups[g].remove(sprite);sprite.onRemove(),destroySprite===!0&&sprite.destroy()}},removeAll:function(destroySprites){var i,items=this.items.items,ln=items.length;for(i=ln-1;i>-1;i--)this.remove(items[i],destroySprites)},onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,applyViewBox:function(){var viewBoxX,viewBoxY,viewBoxWidth,viewBoxHeight,relativeHeight,relativeWidth,size,me=this,viewBox=me.viewBox,width=me.width||1,height=me.height||1;viewBox&&(width||height)?(viewBoxX=viewBox.x,viewBoxY=viewBox.y,viewBoxWidth=viewBox.width,viewBoxHeight=viewBox.height,relativeHeight=height/viewBoxHeight,relativeWidth=width/viewBoxWidth,size=Math.min(relativeWidth,relativeHeight),viewBoxWidth*size<width&&(viewBoxX-=(width-viewBoxWidth*size)/2/size),viewBoxHeight*size<height&&(viewBoxY-=(height-viewBoxHeight*size)/2/size),me.viewBoxShift={dx:-viewBoxX,dy:-viewBoxY,scale:size},me.background&&me.background.setAttributes(Ext.apply({},{x:viewBoxX,y:viewBoxY,width:width/size,height:height/size},{hidden:!1}),!0)):me.background&&width&&height&&me.background.setAttributes(Ext.apply({x:0,y:0,width:width,height:height},{hidden:!1}),!0)},getBBox:function(sprite,isWithoutTransform){var realPath=this["getPath"+sprite.type](sprite);return isWithoutTransform?(sprite.bbox.plain=sprite.bbox.plain||Ext.draw.Draw.pathDimensions(realPath),sprite.bbox.plain):(sprite.dirtyTransform&&this.applyTransformations(sprite,!0),sprite.bbox.transform=sprite.bbox.transform||Ext.draw.Draw.pathDimensions(Ext.draw.Draw.mapPath(realPath,sprite.matrix)),sprite.bbox.transform)},transformToViewBox:function(x,y){if(this.viewBoxShift){var me=this,shift=me.viewBoxShift;return[x/shift.scale-shift.dx,y/shift.scale-shift.dy]}return[x,y]},applyTransformations:function(sprite,onlyMatrix){"text"==sprite.type&&(sprite.bbox.transform=0,this.transform(sprite,!1)),sprite.dirtyTransform=!1;var me=this,attr=sprite.attr;null==attr.translation.x&&null==attr.translation.y||me.translate(sprite),null==attr.scaling.x&&null==attr.scaling.y||me.scale(sprite),null!=attr.rotation.degrees&&me.rotate(sprite),sprite.bbox.transform=0,this.transform(sprite,onlyMatrix),sprite.transformations=[]},rotate:function(sprite){var bbox,deg=sprite.attr.rotation.degrees,centerX=sprite.attr.rotation.x,centerY=sprite.attr.rotation.y;Ext.isNumber(centerX)&&Ext.isNumber(centerY)||(bbox=this.getBBox(sprite,!0),centerX=Ext.isNumber(centerX)?centerX:bbox.x+bbox.width/2,centerY=Ext.isNumber(centerY)?centerY:bbox.y+bbox.height/2),sprite.transformations.push({type:"rotate",degrees:deg,x:centerX,y:centerY})},translate:function(sprite){var x=sprite.attr.translation.x||0,y=sprite.attr.translation.y||0;sprite.transformations.push({type:"translate",x:x,y:y})},scale:function(sprite){var bbox,x=sprite.attr.scaling.x||1,y=sprite.attr.scaling.y||1,centerX=sprite.attr.scaling.centerX,centerY=sprite.attr.scaling.centerY;Ext.isNumber(centerX)&&Ext.isNumber(centerY)||(bbox=this.getBBox(sprite,!0),centerX=Ext.isNumber(centerX)?centerX:bbox.x+bbox.width/2,centerY=Ext.isNumber(centerY)?centerY:bbox.y+bbox.height/2),sprite.transformations.push({type:"scale",x:x,y:y,centerX:centerX,centerY:centerY})},rectPath:function(x,y,w,h,r){return r?[["M",x+r,y],["l",w-2*r,0],["a",r,r,0,0,1,r,r],["l",0,h-2*r],["a",r,r,0,0,1,-r,r],["l",2*r-w,0],["a",r,r,0,0,1,-r,-r],["l",0,2*r-h],["a",r,r,0,0,1,r,-r],["z"]]:[["M",x,y],["l",w,0],["l",0,h],["l",-w,0],["z"]]},ellipsePath:function(x,y,rx,ry){return null==ry&&(ry=rx),[["M",x,y],["m",0,-ry],["a",rx,ry,0,1,1,0,2*ry],["a",rx,ry,0,1,1,0,-2*ry],["z"]]},getPathpath:function(el){return el.attr.path},getPathcircle:function(el){var a=el.attr;return this.ellipsePath(a.x,a.y,a.radius,a.radius)},getPathellipse:function(el){var a=el.attr;return this.ellipsePath(a.x,a.y,a.radiusX||a.width/2||0,a.radiusY||a.height/2||0)},getPathrect:function(el){var a=el.attr;return this.rectPath(a.x||0,a.y||0,a.width||0,a.height||0,a.r||0)},getPathimage:function(el){var a=el.attr;return this.rectPath(a.x||0,a.y||0,a.width,a.height)},getPathtext:function(el){var bbox=this.getBBoxText(el);return this.rectPath(bbox.x,bbox.y,bbox.width,bbox.height)},createGroup:function(id){var group=this.groups.get(id);return group||(group=new Ext.draw.CompositeSprite({surface:this}),group.id=id||Ext.id(null,"ext-surface-group-"),this.groups.add(group)),group},getGroup:function(id){var group;return"string"==typeof id?(group=this.groups.get(id),group||(group=this.createGroup(id))):group=id,group},prepareItems:function(items,applyDefaults){items=[].concat(items);var item,i,ln;for(i=0,ln=items.length;i<ln;i++)item=items[i],item instanceof Ext.draw.Sprite?item.surface=this:(item.surface=this,items[i]=this.createItem(item));return items},setText:Ext.emptyFn,createItem:Ext.emptyFn,getId:function(){return this.id||(this.id=Ext.id(null,"ext-surface-"))},destroy:function(){var me=this;delete me.domRef,me.background&&me.background.destroy(),me.removeAll(!0),Ext.destroy(me.groups.items)}}),Ext.define("Ext.layout.component.Draw",{alias:"layout.draw",extend:Ext.layout.component.Auto,setHeightInDom:!0,setWidthInDom:!0,type:"draw",measureContentWidth:function(ownerContext){var target=ownerContext.target,paddingInfo=ownerContext.getPaddingInfo(),bbox=this.getBBox(ownerContext);return target.viewBox?ownerContext.heightModel.shrinkWrap?paddingInfo.width:bbox.width/bbox.height*(ownerContext.getProp("contentHeight")-paddingInfo.height)+paddingInfo.width:target.autoSize?bbox.width+paddingInfo.width:bbox.x+bbox.width+paddingInfo.width},measureContentHeight:function(ownerContext){var target=ownerContext.target,paddingInfo=ownerContext.getPaddingInfo(),bbox=this.getBBox(ownerContext);return ownerContext.target.viewBox?ownerContext.widthModel.shrinkWrap?paddingInfo.height:bbox.height/bbox.width*(ownerContext.getProp("contentWidth")-paddingInfo.width)+paddingInfo.height:target.autoSize?bbox.height+paddingInfo.height:bbox.y+bbox.height+paddingInfo.height},getBBox:function(ownerContext){var bbox=ownerContext.surfaceBBox;return bbox||(bbox=ownerContext.target.surface.items.getBBox(),bbox.width===-(1/0)&&bbox.height===-(1/0)&&(bbox.width=bbox.height=bbox.x=bbox.y=0),ownerContext.surfaceBBox=bbox),bbox},publishInnerWidth:function(ownerContext,width){ownerContext.setContentWidth(width-ownerContext.getFrameInfo().width,!0)},publishInnerHeight:function(ownerContext,height){ownerContext.setContentHeight(height-ownerContext.getFrameInfo().height,!0)},finishedLayout:function(ownerContext){var props=ownerContext.props,paddingInfo=ownerContext.getPaddingInfo();this.owner.setSurfaceSize(props.contentWidth-paddingInfo.width,props.contentHeight-paddingInfo.height),this.callParent(arguments)}}),Ext.define("Ext.draw.Component",{alias:"widget.draw",extend:Ext.Component,enginePriority:["Svg","Vml"],baseCls:Ext.baseCSSPrefix+"surface",componentLayout:"draw",viewBox:!0,shrinkWrap:3,autoSize:!1,suspendSizing:0,initComponent:function(){this.callParent(arguments),this.addEvents("mousedown","mouseup","mousemove","mouseenter","mouseleave","click","dblclick")},onRender:function(){this.callParent(arguments),this.createSurface()!==!1&&this.configureSurfaceSize()},configureSurfaceSize:function(){var bbox,me=this,viewBox=me.viewBox,autoSize=me.autoSize;!viewBox&&!autoSize||me.suspendSizing||(bbox=me.surface.items.getBBox(),viewBox?me.surface.setViewBox(bbox.x,bbox.y,bbox.width,bbox.height):me.autoSizeSurface(bbox))},autoSizeSurface:function(bbox){bbox=bbox||this.surface.items.getBBox(),this.setSurfaceSize(bbox.width,bbox.height)},setSurfaceSize:function(width,height){if(this.surface.setSize(width,height),this.autoSize){var bbox=this.surface.items.getBBox();this.surface.setViewBox(bbox.x,bbox.y-+Ext.isOpera,width,height)}},createSurface:function(){function refire(eventName){return function(e){me.fireEvent(eventName,e)}}var surface,me=this,cfg=Ext.applyIf({renderTo:me.el,height:me.height,width:me.width,items:me.items},me.initialConfig);return delete cfg.listeners,cfg.gradients||(cfg.gradients=me.gradients),me.initSurfaceCfg(cfg),!!(surface=Ext.draw.Surface.create(cfg,me.enginePriority))&&(me.surface=surface,surface.owner=me,void surface.on({scope:me,mouseup:refire("mouseup"),mousedown:refire("mousedown"),mousemove:refire("mousemove"),mouseenter:refire("mouseenter"),mouseleave:refire("mouseleave"),click:refire("click"),dblclick:refire("dblclick")}))},initSurfaceCfg:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.surface),this.callParent(arguments)}}),Ext.chart=Ext.chart||{},Ext.define("Ext.chart.theme.Theme",function(){return function(){Ext.chart.theme=function(config,base){config=config||{};var l,colors,color,seriesThemes,markerThemes,seriesTheme,markerTheme,key,midColor,midL,i=0,d=Ext.Date.now(),gradients=[];if(config.baseColor&&(midColor=Ext.draw.Color.fromString(config.baseColor),midL=midColor.getHSL()[2],midL<.15?midColor=midColor.getLighter(.3):midL<.3?midColor=midColor.getLighter(.15):midL>.85?midColor=midColor.getDarker(.3):midL>.7&&(midColor=midColor.getDarker(.15)),config.colors=[midColor.getDarker(.3).toString(),midColor.getDarker(.15).toString(),midColor.toString(),midColor.getLighter(.15).toString(),midColor.getLighter(.3).toString()],delete config.baseColor),config.colors){for(colors=config.colors.slice(),markerThemes=base.markerThemes,seriesThemes=base.seriesThemes,l=colors.length,base.colors=colors;i<l;i++)color=colors[i],markerTheme=markerThemes[i]||{},seriesTheme=seriesThemes[i]||{},markerTheme.fill=seriesTheme.fill=markerTheme.stroke=seriesTheme.stroke=color,markerThemes[i]=markerTheme,seriesThemes[i]=seriesTheme;base.markerThemes=markerThemes.slice(0,l),base.seriesThemes=seriesThemes.slice(0,l)}for(key in base)key in config&&(Ext.isObject(config[key])&&Ext.isObject(base[key])?Ext.apply(base[key],config[key]):base[key]=config[key]);if(config.useGradients){for(colors=base.colors||function(){var ans=[];for(i=0,seriesThemes=base.seriesThemes,l=seriesThemes.length;i<l;i++)ans.push(seriesThemes[i].fill||seriesThemes[i].stroke);return ans}(),i=0,l=colors.length;i<l;i++)midColor=Ext.draw.Color.fromString(colors[i]),midColor&&(color=midColor.getDarker(.1).toString(),midColor=midColor.toString(),key="theme-"+midColor.substr(1)+"-"+color.substr(1)+"-"+d,gradients.push({id:key,angle:45,stops:{0:{color:midColor.toString()},100:{color:color.toString()}}}),colors[i]="url(#"+key+")");base.gradients=gradients,base.colors=colors}Ext.apply(this,base)}}(),{theme:"Base",themeAttrs:!1,initTheme:function(theme){var key,gradients,me=this,themes=Ext.chart.theme;if(theme){theme=theme.split(":");for(key in themes)if(key==theme[0])return gradients="gradients"==theme[1],me.themeAttrs=new themes[key]({useGradients:gradients}),gradients&&(me.gradients=me.themeAttrs.gradients),void(me.themeAttrs.background&&(me.background=me.themeAttrs.background))}}}}()),Ext.define("Ext.chart.MaskLayer",{extend:Ext.Component,constructor:function(config){config=Ext.apply(config||{},{style:"position:absolute;background-color:#ff9;cursor:crosshair;opacity:0.5;border:1px solid #00f;"}),this.callParent([config])},initComponent:function(){var me=this;me.callParent(arguments),me.addEvents("mousedown","mouseup","mousemove","mouseenter","mouseleave")},initDraggable:function(){this.callParent(arguments),this.dd.onStart=function(e){var me=this,comp=me.comp;this.startPosition=comp.getPosition(!0),comp.ghost&&!comp.liveDrag&&(me.proxy=comp.ghost(),me.dragTarget=me.proxy.header.el),(me.constrain||me.constrainDelegate)&&(me.constrainTo=me.calculateConstrainRegion())}}}),Ext.define("Ext.chart.Mask",{constructor:function(config){var me=this;me.addEvents("select"),config&&Ext.apply(me,config),me.enableMask&&me.on("afterrender",function(){var comp=new Ext.chart.MaskLayer({renderTo:me.el,hidden:!0});comp.el.on({mousemove:function(e){me.onMouseMove(e)},mouseup:function(e){me.onMouseUp(e)}}),comp.initDraggable(),me.maskType=me.mask,me.mask=comp,me.maskSprite=me.surface.add({type:"path",path:["M",0,0],zIndex:1001,opacity:.6,hidden:!0,stroke:"#00f",cursor:"crosshair"})},me,{single:!0})},onMouseUp:function(e){var sel,me=this,bbox=me.bbox||me.chartBBox;me.maskMouseDown=!1,me.mouseDown=!1,me.mouseMoved&&(me.handleMouseEvent(e),me.mouseMoved=!1,sel=me.maskSelection,me.fireEvent("select",me,{x:sel.x-bbox.x,y:sel.y-bbox.y,width:sel.width,height:sel.height}))},onMouseDown:function(e){this.handleMouseEvent(e)},onMouseMove:function(e){this.handleMouseEvent(e)},handleMouseEvent:function(e){var path,me=this,mask=me.maskType,bbox=me.bbox||me.chartBBox,x=bbox.x,y=bbox.y,math=Math,floor=math.floor,abs=math.abs,min=math.min,max=math.max,height=floor(y+bbox.height),width=floor(x+bbox.width),staticX=e.getPageX()-me.el.getX(),staticY=e.getPageY()-me.el.getY(),maskMouseDown=me.maskMouseDown;staticX=max(staticX,x),staticY=max(staticY,y),staticX=min(staticX,width),staticY=min(staticY,height),"mousedown"===e.type?(me.mouseDown=!0,me.mouseMoved=!1,me.maskMouseDown={x:staticX,y:staticY}):(me.mouseMoved=me.mouseDown,maskMouseDown&&me.mouseDown?("horizontal"==mask?(staticY=y,maskMouseDown.y=height):"vertical"==mask&&(staticX=x,maskMouseDown.x=width),width=maskMouseDown.x-staticX,height=maskMouseDown.y-staticY,path=["M",staticX,staticY,"l",width,0,0,height,-width,0,"z"],me.maskSelection={x:(width>0?staticX:staticX+width)+me.el.getX(),y:(height>0?staticY:staticY+height)+me.el.getY(),width:abs(width),height:abs(height)},me.mask.updateBox(me.maskSelection),me.mask.show(),me.maskSprite.setAttributes({hidden:!0},!0)):(path="horizontal"==mask?["M",staticX,y,"L",staticX,height]:"vertical"==mask?["M",x,staticY,"L",width,staticY]:["M",staticX,y,"L",staticX,height,"M",x,staticY,"L",width,staticY],me.maskSprite.setAttributes({path:path,"stroke-width":1,hidden:!1},!0)))},onMouseLeave:function(e){var me=this;me.mouseMoved=!1,me.mouseDown=!1,me.maskMouseDown=!1,me.mask.hide(),me.maskSprite.hide(!0)}}),Ext.define("Ext.chart.Navigation",{setZoom:function(zoomConfig){var i,ln,axis,zoomer,ends,from,to,store,count,step,length,horizontal,me=this,axesItems=me.axes.items,bbox=me.chartBBox,xScale=bbox.width,yScale=bbox.height,zoomArea={x:zoomConfig.x-me.el.getX(),y:zoomConfig.y-me.el.getY(),width:zoomConfig.width,height:zoomConfig.height};for(i=0,ln=axesItems.length;i<ln;i++)axis=axesItems[i],horizontal="bottom"==axis.position||"top"==axis.position,"Category"==axis.type?(store||(store=me.getChartStore(),count=store.data.items.length),zoomer=zoomArea,length=axis.length,step=Math.round(length/count),horizontal?(from=zoomer.x?Math.floor(zoomer.x/step)+1:0,to=(zoomer.x+zoomer.width)/step):(from=zoomer.y?Math.floor(zoomer.y/step)+1:0,to=(zoomer.y+zoomer.height)/step)):(zoomer={x:zoomArea.x/xScale,y:zoomArea.y/yScale,width:zoomArea.width/xScale,height:zoomArea.height/yScale},ends=axis.calcEnds(),horizontal?(from=(ends.to-ends.from)*zoomer.x+ends.from,to=(ends.to-ends.from)*zoomer.width+from):(to=(ends.to-ends.from)*(1-zoomer.y)+ends.from,from=to-(ends.to-ends.from)*zoomer.height)),axis.minimum=from,axis.maximum=to,horizontal?axis.doConstrain&&"vertical"!=me.maskType&&axis.doConstrain():axis.doConstrain&&"horizontal"!=me.maskType&&axis.doConstrain();me.redraw(!1)},restoreZoom:function(){var i,ln,axis,me=this,axesItems=me.axes.items;for(me.setSubStore(null),i=0,ln=axesItems.length;i<ln;i++)axis=axesItems[i],delete axis.minimum,delete axis.maximum;me.redraw(!1)}}),Ext.define("Ext.chart.Shape",{singleton:!0,circle:function(surface,opts){return surface.add(Ext.apply({type:"circle",x:opts.x,y:opts.y,stroke:null,radius:opts.radius},opts))},line:function(surface,opts){return surface.add(Ext.apply({type:"rect",x:opts.x-opts.radius,y:opts.y-opts.radius,height:2*opts.radius,width:2*opts.radius/5},opts))},square:function(surface,opts){return surface.add(Ext.applyIf({type:"rect",x:opts.x-opts.radius,y:opts.y-opts.radius,height:2*opts.radius,width:2*opts.radius,radius:null},opts))},triangle:function(surface,opts){return opts.radius*=1.75,surface.add(Ext.apply({type:"path",stroke:null,path:"M".concat(opts.x,",",opts.y,"m0-",.58*opts.radius,"l",.5*opts.radius,",",.87*opts.radius,"-",opts.radius,",0z")},opts))},diamond:function(surface,opts){var r=opts.radius;return r*=1.5,surface.add(Ext.apply({type:"path",stroke:null,path:["M",opts.x,opts.y-r,"l",r,r,-r,r,-r,-r,r,-r,"z"]},opts))},cross:function(surface,opts){var r=opts.radius;return r/=1.7,surface.add(Ext.apply({type:"path",stroke:null,path:"M".concat(opts.x-r,",",opts.y,"l",[-r,-r,r,-r,r,r,r,-r,r,r,-r,r,r,r,-r,r,-r,-r,-r,r,-r,-r,"z"])},opts))},plus:function(surface,opts){var r=opts.radius/1.3;return surface.add(Ext.apply({type:"path",stroke:null,path:"M".concat(opts.x-r/2,",",opts.y-r/2,"l",[0,-r,r,0,0,r,r,0,0,r,-r,0,0,r,-r,0,0,-r,-r,0,0,-r,"z"])},opts))},arrow:function(surface,opts){var r=opts.radius;return surface.add(Ext.apply({type:"path",path:"M".concat(opts.x-.7*r,",",opts.y-.4*r,"l",[.6*r,0,0,.4*-r,r,.8*r,-r,.8*r,0,.4*-r,.6*-r,0],"z")},opts))},drop:function(surface,x,y,text,size,angle){size=size||30,angle=angle||0,surface.add({type:"path",path:["M",x,y,"l",size,0,"A",.4*size,.4*size,0,1,0,x+.7*size,y-.7*size,"z"],fill:"#000",stroke:"none",rotate:{degrees:22.5-angle,x:x,y:y}}),angle=(angle+90)*Math.PI/180,surface.add({type:"text",x:x+size*Math.sin(angle)-10,y:y+size*Math.cos(angle)+5,text:text,"font-size":12*size/40,stroke:"none",fill:"#fff"})}}),Ext.define("Ext.chart.LegendItem",{extend:Ext.draw.CompositeSprite,hiddenSeries:!1,label:void 0,x:0,y:0,zIndex:500,boldRe:/bold\s\d{1,}.*/i,constructor:function(config){this.callParent(arguments),this.createLegend(config)},createLegend:function(config){var me=this,series=me.series,index=config.yFieldIndex;me.label=me.createLabel(config),me.createSeriesMarkers(config),me.setAttributes({hidden:!1},!0),me.yFieldIndex=index,me.on("mouseover",me.onMouseOver,me),me.on("mouseout",me.onMouseOut,me),me.on("mousedown",me.onMouseDown,me),series.visibleInLegend(index)||(me.hiddenSeries=!0,me.label.setAttributes({opacity:.5},!0)),me.updatePosition({x:0,y:0})},getLabelText:function(){function getSeriesProp(name){var val=series[name];return Ext.isArray(val)?val[idx]:val}var me=this,series=me.series,idx=me.yFieldIndex;return getSeriesProp("title")||getSeriesProp("yField")},createLabel:function(config){var me=this,legend=me.legend;return me.add("label",me.surface.add({type:"text",x:20,y:0,zIndex:(me.zIndex||0)+2,fill:legend.labelColor,font:legend.labelFont,text:me.getLabelText(),style:{cursor:"pointer"}}))},createSeriesMarkers:function(config){var me=this,index=config.yFieldIndex,series=me.series,seriesType=series.type,z=(me.surface,me.zIndex);if("line"===seriesType||"scatter"===seriesType){if("line"===seriesType){var seriesStyle=Ext.apply(series.seriesStyle,series.style);me.drawLine(.5,.5,16.5,.5,z,seriesStyle,index)}if(series.showMarkers||"scatter"===seriesType){var markerConfig=Ext.apply(series.markerStyle,series.markerConfig||{},{fill:series.getLegendColor(index)});me.drawMarker(8.5,.5,z,markerConfig)}}else me.drawFilledBox(12,12,z,index)},drawLine:function(fromX,fromY,toX,toY,z,seriesStyle,index){var me=this,surface=me.surface,series=me.series;return me.add("line",surface.add({type:"path",path:"M"+fromX+","+fromY+"L"+toX+","+toY,zIndex:(z||0)+2,"stroke-width":series.lineWidth,"stroke-linejoin":"round","stroke-dasharray":series.dash,stroke:seriesStyle.stroke||series.getLegendColor(index)||"#000",style:{cursor:"pointer"}}))},drawMarker:function(x,y,z,markerConfig){var me=this,surface=me.surface;me.series;return me.add("marker",Ext.chart.Shape[markerConfig.type](surface,{fill:markerConfig.fill,x:x,y:y,zIndex:(z||0)+2,radius:markerConfig.radius||markerConfig.size,style:{cursor:"pointer"}}))},drawFilledBox:function(width,height,z,index){var me=this,surface=me.surface,series=me.series;return me.add("box",surface.add({type:"rect",zIndex:(z||0)+2,x:0,y:0,width:width,height:height,fill:series.getLegendColor(index),style:{cursor:"pointer"}}))},onMouseOver:function(){var me=this;me.label.setStyle({"font-weight":"bold"}),me.series._index=me.yFieldIndex,me.series.highlightItem()},onMouseOut:function(){var me=this,legend=me.legend,boldRe=me.boldRe;me.label.setStyle({"font-weight":legend.labelFont&&boldRe.test(legend.labelFont)?"bold":"normal"}),me.series._index=me.yFieldIndex,me.series.unHighlightItem()},onMouseDown:function(){var me=this,index=me.yFieldIndex;me.hiddenSeries?(me.series.showAll(index),me.label.setAttributes({opacity:1},!0)):(me.series.hideAll(index),me.label.setAttributes({opacity:.5},!0)),me.hiddenSeries=!me.hiddenSeries,me.legend.chart.redraw()},updatePosition:function(relativeTo){var item,i,x,y,translate,o,relativeX,relativeY,me=this,items=me.items,ln=items.length,currentX=me.x,currentY=me.y;for(relativeTo||(relativeTo=me.legend),relativeX=relativeTo.x,relativeY=relativeTo.y,i=0;i<ln;i++){switch(translate=!0,item=items[i],item.type){case"text":x=20+relativeX+currentX,y=relativeY+currentY,translate=!1;break;case"rect":x=relativeX+currentX,y=relativeY+currentY-6;break;default:x=relativeX+currentX,y=relativeY+currentY}o={x:x,y:y},item.setAttributes(translate?{translate:o}:o,!0)}}}),Ext.define("Ext.chart.Legend",{visible:!0,update:!0,position:"bottom",x:0,y:0,labelColor:"#000",labelFont:"12px Helvetica, sans-serif",boxStroke:"#000",boxStrokeWidth:1,boxFill:"#FFF",itemSpacing:10,padding:5,width:0,height:0,boxZIndex:100,constructor:function(config){var me=this;config&&Ext.apply(me,config),me.items=[],me.isVertical="left|right|float".indexOf(me.position)!==-1,me.origX=me.x,me.origY=me.y},create:function(){var i,ln,series,me=this,seriesItems=me.chart.series.items;if(me.createBox(),me.rebuild!==!1&&me.createItems(),!me.created&&me.isDisplayed())for(me.created=!0,i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],series.on("titlechange",me.redraw,me)},init:Ext.emptyFn,redraw:function(){var me=this;me.create(),me.updatePosition()},isDisplayed:function(){return this.visible&&this.chart.series.findIndex("showInLegend",!0)!==-1},createItems:function(){var fields,i,li,j,lj,series,item,me=this,seriesItems=me.chart.series.items,items=me.items;for(me.removeItems(),i=0,li=seriesItems.length;i<li;i++)if(series=seriesItems[i],series.showInLegend)for(fields=[].concat(series.yField),j=0,lj=fields.length;j<lj;j++)item=me.createLegendItem(series,j),items.push(item);me.alignItems()},removeItems:function(){var i,me=this,items=me.items,len=items?items.length:0;if(len)for(i=0;i<len;i++)items[i].destroy();items.length=[]},alignItems:function(){var dim,maxWidth,maxHeight,totalWidth,totalHeight,me=this,padding=me.padding,vertical=me.isVertical,mfloor=Math.floor;dim=me.updateItemDimensions(),maxWidth=dim.maxWidth,maxHeight=dim.maxHeight,totalWidth=dim.totalWidth,totalHeight=dim.totalHeight,me.width=mfloor((vertical?maxWidth:totalWidth)+2*padding),me.height=mfloor((vertical?totalHeight:maxHeight)+2*padding)},updateItemDimensions:function(){var i,l,item,bbox,width,height,me=this,items=me.items,padding=me.padding,itemSpacing=me.itemSpacing,maxWidth=0,maxHeight=0,totalWidth=0,totalHeight=0,vertical=me.isVertical,mfloor=Math.floor,mmax=Math.max,spacing=0;for(i=0,l=items.length;i<l;i++)item=items[i],bbox=item.getBBox(),width=bbox.width,height=bbox.height,spacing=0===i?0:itemSpacing,item.x=padding+mfloor(vertical?0:totalWidth+spacing),item.y=padding+mfloor(vertical?totalHeight+spacing:0)+height/2,totalWidth+=spacing+width,totalHeight+=spacing+height,maxWidth=mmax(maxWidth,width),maxHeight=mmax(maxHeight,height);return{totalWidth:totalWidth,totalHeight:totalHeight,maxWidth:maxWidth,maxHeight:maxHeight}},createLegendItem:function(series,yFieldIndex){var me=this;return new Ext.chart.LegendItem({legend:me,series:series,surface:me.chart.surface,yFieldIndex:yFieldIndex})},getBBox:function(){var me=this;return{x:Math.round(me.x)-me.boxStrokeWidth/2,y:Math.round(me.y)-me.boxStrokeWidth/2,width:me.width+me.boxStrokeWidth,height:me.height+me.boxStrokeWidth}},createBox:function(){var box,bbox,me=this;return me.boxSprite&&me.boxSprite.destroy(),bbox=me.getBBox(),isNaN(bbox.width)||isNaN(bbox.height)?void(me.boxSprite=!1):(box=me.boxSprite=me.chart.surface.add(Ext.apply({type:"rect",stroke:me.boxStroke,"stroke-width":me.boxStrokeWidth,fill:me.boxFill,zIndex:me.boxZIndex},bbox)),void box.redraw())},calcPosition:function(){var x,y,me=this,legendWidth=me.width,legendHeight=me.height,chart=me.chart,chartBBox=chart.chartBBox,insets=chart.insetPadding,chartWidth=chartBBox.width-2*insets,chartHeight=chartBBox.height-2*insets,chartX=chartBBox.x+insets,chartY=chartBBox.y+insets,surface=chart.surface,mfloor=Math.floor;switch(me.position){case"left":x=insets,y=mfloor(chartY+chartHeight/2-legendHeight/2);break;case"right":x=mfloor(surface.width-legendWidth)-insets,y=mfloor(chartY+chartHeight/2-legendHeight/2);break;case"top":x=mfloor(chartX+chartWidth/2-legendWidth/2),y=insets;break;case"bottom":x=mfloor(chartX+chartWidth/2-legendWidth/2),y=mfloor(surface.height-legendHeight)-insets;break;default:x=mfloor(me.origX)+insets,y=mfloor(me.origY)+insets}return{x:x,y:y}},updatePosition:function(){var pos,i,l,bbox,me=this,items=me.items;if(me.isDisplayed()){for(pos=me.calcPosition(),me.x=pos.x,me.y=pos.y,i=0,l=items.length;i<l;i++)items[i].updatePosition();bbox=me.getBBox(),isNaN(bbox.width)||isNaN(bbox.height)?me.boxSprite&&me.boxSprite.hide(!0):(me.boxSprite||me.createBox(),me.boxSprite.setAttributes(bbox,!0),me.boxSprite.show(!0))}},toggle:function(show){var me=this,i=0,items=me.items,len=items.length;for(me.boxSprite&&(show?me.boxSprite.show(!0):me.boxSprite.hide(!0));i<len;++i)show?items[i].show(!0):items[i].hide(!0);me.visible=show}}),Ext.define("Ext.chart.theme.Base",{constructor:function(config){var ident=Ext.identityFn;Ext.chart.theme.call(this,config,{background:!1,axis:{stroke:"#444","stroke-width":1},axisLabelTop:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:ident},axisLabelRight:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:ident},axisLabelBottom:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:ident},axisLabelLeft:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:ident},axisTitleTop:{font:"bold 18px Arial",fill:"#444"},axisTitleRight:{font:"bold 18px Arial",fill:"#444",rotate:{x:0,y:0,degrees:270}},axisTitleBottom:{font:"bold 18px Arial",fill:"#444"},axisTitleLeft:{font:"bold 18px Arial",fill:"#444",rotate:{x:0,y:0,degrees:270}},series:{"stroke-width":0},seriesLabel:{font:"12px Arial",fill:"#333"},marker:{stroke:"#555",radius:3,size:3},colors:["#94ae0a","#115fa6","#a61120","#ff8809","#ffd13e","#a61187","#24ad9a","#7c7474","#a66111"],seriesThemes:[{fill:"#115fa6"},{fill:"#94ae0a"},{fill:"#a61120"},{fill:"#ff8809"},{fill:"#ffd13e"},{fill:"#a61187"},{fill:"#24ad9a"},{fill:"#7c7474"},{fill:"#115fa6"},{fill:"#94ae0a"},{fill:"#a61120"},{fill:"#ff8809"},{fill:"#ffd13e"},{fill:"#a61187"},{fill:"#24ad9a"},{fill:"#7c7474"},{fill:"#a66111"}],markerThemes:[{fill:"#115fa6",type:"circle"},{fill:"#94ae0a",type:"cross"},{fill:"#115fa6",type:"plus"},{fill:"#94ae0a",type:"circle"},{fill:"#a61120",type:"cross"}]})}},function(){for(var palette=["#b1da5a","#4ce0e7","#e84b67","#da5abd","#4d7fe6","#fec935"],names=["Green","Sky","Red","Purple","Blue","Yellow"],i=0,l=palette.length,themes=Ext.chart.theme,categories=[["#f0a50a","#c20024","#2044ba","#810065","#7eae29"],["#6d9824","#87146e","#2a9196","#d39006","#1e40ac"],["#fbbc29","#ce2e4e","#7e0062","#158b90","#57880e"],["#ef5773","#fcbd2a","#4f770d","#1d3eaa","#9b001f"],["#7eae29","#fdbe2a","#910019","#27b4bc","#d74dbc"],["#44dce1","#0b2592","#996e05","#7fb325","#b821a1"]],cats=categories.length;i<l;i++)themes[names[i]]=function(color){return Ext.extend(themes.Base,{constructor:function(config){themes.Base.prototype.constructor.call(this,Ext.apply({baseColor:color},config))}})}(palette[i]);for(i=0;i<cats;i++)themes["Category"+(i+1)]=function(category){return Ext.extend(themes.Base,{constructor:function(config){themes.Base.prototype.constructor.call(this,Ext.apply({colors:category},config))}})}(categories[i])}),Ext.define("Ext.chart.Chart",{extend:Ext.draw.Component,alias:"widget.chart",mixins:{themeManager:Ext.chart.theme.Theme,mask:Ext.chart.Mask,navigation:Ext.chart.Navigation,bindable:Ext.util.Bindable,observable:Ext.util.Observable},viewBox:!1,animate:!1,legend:!1,insetPadding:10,background:!1,refreshBuffer:1,constructor:function(config){var defaultAnim,me=this;config=Ext.apply({},config),me.initTheme(config.theme||me.theme),me.gradients&&Ext.apply(config,{gradients:me.gradients}),me.background&&Ext.apply(config,{background:me.background}),config.animate&&(defaultAnim={easing:"ease",duration:500},Ext.isObject(config.animate)?config.animate=Ext.applyIf(config.animate,defaultAnim):config.animate=defaultAnim),me.mixins.observable.constructor.call(me,config),config.mask&&(config=Ext.apply({enableMask:!0},config)),config.enableMask&&me.mixins.mask.constructor.call(me,config),me.mixins.navigation.constructor.call(me),me.callParent([config])},getChartStore:function(){return this.substore||this.store},initComponent:function(){var axes,series,me=this;me.callParent(),me.addEvents("itemmousedown","itemmouseup","itemmouseover","itemmouseout","itemclick","itemdblclick","itemdragstart","itemdrag","itemdragend","beforerefresh","refresh"),Ext.applyIf(me,{zoom:{width:1,height:1,x:0,y:0}}),me.maxGutters={left:0,right:0,bottom:0,top:0},me.store=Ext.data.StoreManager.lookup(me.store),axes=me.axes,me.axes=new Ext.util.MixedCollection((!1),function(a){return a.position}),axes&&me.axes.addAll(axes),series=me.series,me.series=new Ext.util.MixedCollection((!1),function(a){return a.seriesId||(a.seriesId=Ext.id(null,"ext-chart-series-"))}),series&&me.series.addAll(series),me.legend!==!1&&(me.legend=new Ext.chart.Legend(Ext.applyIf({chart:me},me.legend))),me.on({mousemove:me.onMouseMove,mouseleave:me.onMouseLeave,mousedown:me.onMouseDown,mouseup:me.onMouseUp,click:me.onClick,dblclick:me.onDblClick,scope:me})},afterComponentLayout:function(width,height,oldWidth,oldHeight){var me=this;Ext.isNumber(width)&&Ext.isNumber(height)&&(width!==oldWidth||height!==oldHeight?(me.curWidth=width,me.curHeight=height,me.redraw(!0),me.needsRedraw=!1):me.needsRedraw&&(me.redraw(),me.needsRedraw=!1)),this.callParent(arguments)},redraw:function(resize){var i,item,series,me=this,seriesItems=me.series.items,seriesLen=seriesItems.length,axesItems=me.axes.items,axesLen=axesItems.length,themeIndex=0,chartBBox=me.chartBBox={x:0,y:0,height:me.curHeight,width:me.curWidth},legend=me.legend;for(me.surface.setSize(chartBBox.width,chartBBox.height),i=0;i<seriesLen;i++)item=seriesItems[i],
series=item.initialized?item:me.initializeSeries(item,i,themeIndex),series.onRedraw(),Ext.isArray(item.yField)?themeIndex+=item.yField.length:++themeIndex;for(i=0;i<axesLen;i++)item=axesItems[i],item.initialized||me.initializeAxis(item);for(i=0;i<axesLen;i++)axesItems[i].processView();for(i=0;i<axesLen;i++)axesItems[i].drawAxis(!0);for(legend!==!1&&legend.visible&&(!legend.update&&legend.created||legend.create()),me.alignAxes(),legend!==!1&&legend.visible&&legend.updatePosition(),me.getMaxGutters(),me.resizing=!!resize,i=0;i<axesLen;i++)axesItems[i].drawAxis();for(i=0;i<seriesLen;i++)me.drawCharts(seriesItems[i]);me.resizing=!1},afterRender:function(){var me=this,legend=me.legend;me.callParent(arguments),me.categoryNames&&me.setCategoryNames(me.categoryNames),legend&&legend.init(),me.bindStore(me.store,!0),me.refresh(),"Vml"===me.surface.engine&&(me.on("added",me.onAddedVml,me),me.mon(me.hierarchyEventSource,"added",me.onContainerAddedVml,me))},onAddedVml:function(){this.needsRedraw=!0},onContainerAddedVml:function(container){this.isDescendantOf(container)&&(this.needsRedraw=!0)},getEventXY:function(e){var box=this.surface.getRegion(),pageXY=e.getXY(),x=pageXY[0]-box.left,y=pageXY[1]-box.top;return[x,y]},onClick:function(e){this.handleClick("itemclick",e)},onDblClick:function(e){this.handleClick("itemdblclick",e)},handleClick:function(name,e){var i,ln,series,item,me=this,position=me.getEventXY(e),seriesItems=me.series.items;for(i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],Ext.draw.Draw.withinBox(position[0],position[1],series.bbox)&&series.getItemForPoint&&(item=series.getItemForPoint(position[0],position[1]),item&&series.fireEvent(name,item))},onMouseDown:function(e){var i,ln,series,item,me=this,position=me.getEventXY(e),seriesItems=me.series.items;for(me.enableMask&&me.mixins.mask.onMouseDown.call(me,e),i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],Ext.draw.Draw.withinBox(position[0],position[1],series.bbox)&&series.getItemForPoint&&(item=series.getItemForPoint(position[0],position[1]),item&&series.fireEvent("itemmousedown",item))},onMouseUp:function(e){var i,ln,series,item,me=this,position=me.getEventXY(e),seriesItems=me.series.items;for(me.enableMask&&me.mixins.mask.onMouseUp.call(me,e),i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],Ext.draw.Draw.withinBox(position[0],position[1],series.bbox)&&series.getItemForPoint&&(item=series.getItemForPoint(position[0],position[1]),item&&series.fireEvent("itemmouseup",item))},onMouseMove:function(e){var i,ln,series,item,last,storeItem,storeField,me=this,position=me.getEventXY(e),seriesItems=me.series.items;for(me.enableMask&&me.mixins.mask.onMouseMove.call(me,e),i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],Ext.draw.Draw.withinBox(position[0],position[1],series.bbox)?series.getItemForPoint&&(item=series.getItemForPoint(position[0],position[1]),last=series._lastItemForPoint,storeItem=series._lastStoreItem,storeField=series._lastStoreField,(item!==last||item&&(item.storeItem!=storeItem||item.storeField!=storeField))&&(last&&(series.fireEvent("itemmouseout",last),delete series._lastItemForPoint,delete series._lastStoreField,delete series._lastStoreItem),item&&(series.fireEvent("itemmouseover",item),series._lastItemForPoint=item,series._lastStoreItem=item.storeItem,series._lastStoreField=item.storeField))):(last=series._lastItemForPoint,last&&(series.fireEvent("itemmouseout",last),delete series._lastItemForPoint,delete series._lastStoreField,delete series._lastStoreItem))},onMouseLeave:function(e){var i,ln,series,me=this,seriesItems=me.series.items;for(me.enableMask&&me.mixins.mask.onMouseLeave.call(me,e),i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],delete series._lastItemForPoint},delayRefresh:function(){var me=this;me.refreshTask||(me.refreshTask=new Ext.util.DelayedTask(me.refresh,me)),me.refreshTask.delay(me.refreshBuffer)},refresh:function(){var me=this;if(me.rendered&&void 0!==me.curWidth&&void 0!==me.curHeight){if(!me.isVisible(!0))return void(me.refreshPending||(me.setShowListeners("mon"),me.refreshPending=!0));me.fireEvent("beforerefresh",me)!==!1&&(me.redraw(),me.fireEvent("refresh",me))}},onShow:function(){var me=this;me.callParent(arguments),me.refreshPending&&(me.delayRefresh(),me.setShowListeners("mun")),delete me.refreshPending},setShowListeners:function(method){var me=this;me[method](me.hierarchyEventSource,{scope:me,single:!0,show:me.forceRefresh,expand:me.forceRefresh})},doRefresh:function(){this.setSubStore(null),this.refresh()},forceRefresh:function(container){var me=this;me.isDescendantOf(container)&&me.refreshPending&&(me.setShowListeners("mun"),me.delayRefresh()),delete me.refreshPending},bindStore:function(store,initial){var me=this;me.mixins.bindable.bindStore.apply(me,arguments),me.store&&!initial&&me.refresh()},getStoreListeners:function(){var refresh=this.doRefresh,delayRefresh=this.delayRefresh;return{refresh:refresh,add:delayRefresh,bulkremove:delayRefresh,update:delayRefresh,clear:refresh}},setSubStore:function(subStore){this.substore=subStore},initializeAxis:function(axis){var me=this,chartBBox=me.chartBBox,w=chartBBox.width,h=chartBBox.height,x=chartBBox.x,y=chartBBox.y,themeAttrs=me.themeAttrs,axes=me.axes,config={chart:me};switch(themeAttrs&&(config.axisStyle=Ext.apply({},themeAttrs.axis),config.axisLabelLeftStyle=Ext.apply({},themeAttrs.axisLabelLeft),config.axisLabelRightStyle=Ext.apply({},themeAttrs.axisLabelRight),config.axisLabelTopStyle=Ext.apply({},themeAttrs.axisLabelTop),config.axisLabelBottomStyle=Ext.apply({},themeAttrs.axisLabelBottom),config.axisTitleLeftStyle=Ext.apply({},themeAttrs.axisTitleLeft),config.axisTitleRightStyle=Ext.apply({},themeAttrs.axisTitleRight),config.axisTitleTopStyle=Ext.apply({},themeAttrs.axisTitleTop),config.axisTitleBottomStyle=Ext.apply({},themeAttrs.axisTitleBottom)),axis.position){case"top":Ext.apply(config,{length:w,width:h,x:x,y:y});break;case"bottom":Ext.apply(config,{length:w,width:h,x:x,y:h});break;case"left":Ext.apply(config,{length:h,width:w,x:x,y:h});break;case"right":Ext.apply(config,{length:h,width:w,x:w,y:h})}axis.chart?Ext.apply(axis,config):(Ext.apply(config,axis),axis=Ext.createByAlias("axis."+axis.type.toLowerCase(),config),axes.replace(axis)),axis.initialized=!0},getInsets:function(){var me=this,insetPadding=me.insetPadding;return{top:insetPadding,right:insetPadding,bottom:insetPadding,left:insetPadding}},calculateInsets:function(){function getAxis(edge){var i=axes.findIndex("position",edge);return i<0?null:axes.getAt(i)}var insets,i,l,edge,isVertical,axis,bbox,me=this,legend=me.legend,axes=me.axes,edges=["top","right","bottom","left"];for(insets=me.getInsets(),i=0,l=edges.length;i<l;i++)edge=edges[i],isVertical="left"===edge||"right"===edge,axis=getAxis(edge),legend!==!1&&legend.position===edge&&(bbox=legend.getBBox(),insets[edge]+=(isVertical?bbox.width:bbox.height)+me.insetPadding),axis&&axis.bbox&&(bbox=axis.bbox,insets[edge]+=isVertical?bbox.width:bbox.height);return insets},alignAxes:function(){var insets,chartBBox,i,l,axis,pos,isVertical,me=this,axesItems=me.axes.items;for(insets=me.calculateInsets(),chartBBox={x:insets.left,y:insets.top,width:me.curWidth-insets.left-insets.right,height:me.curHeight-insets.top-insets.bottom},me.chartBBox=chartBBox,i=0,l=axesItems.length;i<l;i++)axis=axesItems[i],pos=axis.position,isVertical="left"===pos||"right"===pos,axis.x="right"===pos?chartBBox.x+chartBBox.width:chartBBox.x,axis.y="top"===pos?chartBBox.y:chartBBox.y+chartBBox.height,axis.width=isVertical?chartBBox.width:chartBBox.height,axis.length=isVertical?chartBBox.height:chartBBox.width},initializeSeries:function(series,idx,themeIndex){var seriesObj,markerObj,seriesThemes,st,markerThemes,l,config,me=this,themeAttrs=me.themeAttrs,colorArrayStyle=[],isInstance=(series instanceof Ext.chart.series.Series).i=0;if(!series.initialized){if(config={chart:me,seriesId:series.seriesId},themeAttrs){if(seriesThemes=themeAttrs.seriesThemes,markerThemes=themeAttrs.markerThemes,seriesObj=Ext.apply({},themeAttrs.series),markerObj=Ext.apply({},themeAttrs.marker),config.seriesStyle=Ext.apply(seriesObj,seriesThemes[themeIndex%seriesThemes.length]),config.seriesLabelStyle=Ext.apply({},themeAttrs.seriesLabel),config.markerStyle=Ext.apply(markerObj,markerThemes[themeIndex%markerThemes.length]),themeAttrs.colors)config.colorArrayStyle=themeAttrs.colors;else{for(colorArrayStyle=[],l=seriesThemes.length;i<l;i++)st=seriesThemes[i],(st.fill||st.stroke)&&colorArrayStyle.push(st.fill||st.stroke);colorArrayStyle.length&&(config.colorArrayStyle=colorArrayStyle)}config.seriesIdx=idx,config.themeIdx=themeIndex}isInstance?Ext.applyIf(series,config):(Ext.applyIf(config,series),series=me.series.replace(Ext.createByAlias("series."+series.type.toLowerCase(),config)))}return series.initialize(),series.initialized=!0,series},getMaxGutters:function(){var i,ln,gutters,me=this,seriesItems=me.series.items,lowerH=0,upperH=0,lowerV=0,upperV=0;for(i=0,ln=seriesItems.length;i<ln;i++)gutters=seriesItems[i].getGutters(),gutters&&(gutters.verticalAxis?(lowerV=Math.max(lowerV,gutters.lower),upperV=Math.max(upperV,gutters.upper)):(lowerH=Math.max(lowerH,gutters.lower),upperH=Math.max(upperH,gutters.upper)));me.maxGutters={left:lowerH,right:upperH,bottom:lowerV,top:upperV}},drawAxis:function(axis){axis.drawAxis()},drawCharts:function(series){series.triggerafterrender=!1,series.drawSeries(),this.animate||series.fireEvent("afterrender",series)},save:function(config){return Ext.draw.Surface.save(this.surface,config)},destroy:function(){var me=this,task=me.refreshTask;task&&(task.cancel(),me.refreshTask=null),Ext.destroy(me.surface),me.bindStore(null),me.callParent(arguments)}}),Ext.define("Ext.chart.Highlight",{highlight:!1,highlightCfg:{fill:"#fdd","stroke-width":5,stroke:"#f55"},constructor:function(config){config.highlight&&"boolean"!=typeof config.highlight&&(this.highlightCfg=Ext.merge({},this.highlightCfg,config.highlight))},highlightItem:function(item){if(item){var p,from,to,pi,me=this,sprite=item.sprite,opts=Ext.merge({},me.highlightCfg,me.highlight),surface=me.chart.surface,animate=me.chart.animate;if(me.highlight&&sprite&&!sprite._highlighted){if(sprite._anim&&(sprite._anim.paused=!0),sprite._highlighted=!0,!sprite._defaults){sprite._defaults=Ext.apply({},sprite.attr),from={},to={};for(p in opts)if(p in sprite._defaults||(sprite._defaults[p]=surface.availableAttrs[p]),from[p]=sprite._defaults[p],to[p]=opts[p],Ext.isObject(opts[p])){from[p]={},to[p]={},Ext.apply(sprite._defaults[p],sprite.attr[p]),Ext.apply(from[p],sprite._defaults[p]);for(pi in sprite._defaults[p])pi in opts[p]?to[p][pi]=opts[p][pi]:to[p][pi]=from[p][pi];for(pi in opts[p])pi in to[p]||(to[p][pi]=opts[p][pi])}sprite._from=from,sprite._to=to,sprite._endStyle=to}animate?sprite._anim=new Ext.fx.Anim({target:sprite,from:sprite._from,to:sprite._to,duration:150}):sprite.setAttributes(sprite._to,!0)}}},unHighlightItem:function(){if(this.highlight&&this.items)for(var obj,p,sprite,me=this,items=me.items,len=items.length,opts=Ext.merge({},me.highlightCfg,me.highlight),animate=me.chart.animate,i=0;i<len;i++)if(items[i]&&(sprite=items[i].sprite,sprite&&sprite._highlighted)){sprite._anim&&(sprite._anim.paused=!0),obj={};for(p in opts)Ext.isObject(sprite._defaults[p])?obj[p]=Ext.apply({},sprite._defaults[p]):obj[p]=sprite._defaults[p];animate?(sprite._endStyle=obj,sprite._anim=new Ext.fx.Anim({target:sprite,to:obj,duration:150})):sprite.setAttributes(obj,!0),delete sprite._highlighted}},cleanHighlights:function(){if(this.highlight){var l,group=this.group,markerGroup=this.markerGroup,i=0;for(l=group.getCount();i<l;i++)delete group.getAt(i)._defaults;if(markerGroup)for(l=markerGroup.getCount();i<l;i++)delete markerGroup.getAt(i)._defaults}}}),Ext.define("Ext.chart.Label",{colorStringRe:/url\s*\(\s*#([^\/)]+)\s*\)/,constructor:function(config){var me=this;me.label=Ext.applyIf(me.label||{},{display:"none",stackedDisplay:"none",color:"#000",field:"name",minMargin:50,font:"11px Helvetica, sans-serif",orientation:"horizontal",renderer:Ext.identityFn}),"none"!==me.label.display&&(me.labelsGroup=me.chart.surface.getGroup(me.seriesId+"-labels"))},renderLabels:function(){var gradient,i,count,groupIndex,index,j,k,colorStopTotal,colorStopIndex,colorStop,item,label,storeItem,sprite,spriteColor,spriteBrightness,labelColor,colorString,total,totalPositive,totalNegative,topText,bottomText,me=this,chart=me.chart,gradients=chart.gradients,items=me.items,animate=chart.animate,config=me.label,display=config.display,stackedDisplay=config.stackedDisplay,format=config.renderer,color=config.color,field=[].concat(config.field),group=me.labelsGroup,groupLength=(group||0)&&group.length,store=me.chart.getChartStore(),len=store.getCount(),itemLength=(items||0)&&items.length,ratio=itemLength/len,gradientsCount=(gradients||0)&&gradients.length,Color=Ext.draw.Color,hides=[];if("none"!=display&&group){if(0==itemLength)for(;groupLength--;)hides.push(groupLength);else{for(i=0,count=0,groupIndex=0;i<len;i++)for(index=0,j=0;j<ratio;j++){for(item=items[count],label=group.getAt(groupIndex),storeItem=store.getAt(i);this.__excludes&&this.__excludes[index];)index++;if(!item&&label&&(label.hide(!0),groupIndex++),item&&field[j]){if(!label&&(label=me.onCreateLabel(storeItem,item,i,display),!label))break;if(label.setAttributes({fill:String(color)},!0),me.onPlaceLabel(label,storeItem,item,i,display,animate,index),groupIndex++,config.contrast&&item.sprite){if(sprite=item.sprite,colorString=animate&&sprite._endStyle?sprite._endStyle.fill:animate&&sprite._to?sprite._to.fill:sprite.attr.fill,colorString=colorString||sprite.attr.fill,spriteColor=Color.fromString(colorString),colorString&&!spriteColor){for(colorString=colorString.match(me.colorStringRe)[1],k=0;k<gradientsCount;k++)if(gradient=gradients[k],gradient.id==colorString){colorStop=0,colorStopTotal=0;for(colorStopIndex in gradient.stops)colorStop++,colorStopTotal+=Color.fromString(gradient.stops[colorStopIndex].color).getGrayscale();spriteBrightness=colorStopTotal/colorStop/255;break}}else spriteBrightness=spriteColor.getGrayscale()/255;label.isOutside&&(spriteBrightness=1),labelColor=Color.fromString(label.attr.fill||label.attr.color).getHSL(),labelColor[2]=spriteBrightness>.5?.2:.8,label.setAttributes({fill:String(Color.fromHSL.apply({},labelColor))},!0)}me.stacked&&stackedDisplay&&(item.totalPositiveValues||item.totalNegativeValues)&&(totalPositive=item.totalPositiveValues||0,totalNegative=item.totalNegativeValues||0,total=totalPositive+totalNegative,"total"==stackedDisplay?topText=format(total):"balances"==stackedDisplay&&(0==totalPositive&&0==totalNegative?topText=format(0):(topText=format(totalPositive),bottomText=format(totalNegative))),topText&&(label=group.getAt(groupIndex),label||(label=me.onCreateLabel(storeItem,item,i,"over")),labelColor=Color.fromString(label.attr.color||label.attr.fill).getHSL(),label.setAttributes({text:topText,style:config.font,fill:String(Color.fromHSL.apply({},labelColor))},!0),me.onPlaceLabel(label,storeItem,item,i,"over",animate,index),groupIndex++),bottomText&&(label=group.getAt(groupIndex),label||(label=me.onCreateLabel(storeItem,item,i,"under")),labelColor=Color.fromString(label.attr.color||label.attr.fill).getHSL(),label.setAttributes({text:bottomText,style:config.font,fill:String(Color.fromHSL.apply({},labelColor))},!0),me.onPlaceLabel(label,storeItem,item,i,"under",animate,index),groupIndex++))}count++,index++}for(groupLength=group.length;groupLength>groupIndex;)hides.push(groupIndex),groupIndex++}me.hideLabels(hides)}},hideLabels:function(hides){var labelsGroup=this.labelsGroup,hlen=!!hides&&hides.length;if(labelsGroup)if(hlen===!1)for(hlen=labelsGroup.getCount();hlen--;)labelsGroup.getAt(hlen).hide(!0);else for(;hlen--;)labelsGroup.getAt(hides[hlen]).hide(!0)}}),Ext.define("Ext.chart.TipSurface",{extend:Ext.draw.Component,spriteArray:!1,renderFirst:!0,constructor:function(config){this.callParent([config]),config.sprites&&(this.spriteArray=[].concat(config.sprites),delete config.sprites)},onRender:function(){var sp,sprites,me=this,i=0,l=0;if(this.callParent(arguments),sprites=me.spriteArray,me.renderFirst&&sprites)for(me.renderFirst=!1,l=sprites.length;i<l;i++)sp=me.surface.add(sprites[i]),sp.setAttributes({hidden:!1},!0)}}),Ext.define("Ext.chart.Tip",{constructor:function(config){var surface,sprites,tipSurface,me=this;config.tips&&(me.tipTimeout=null,me.tipConfig=Ext.apply({},config.tips,{renderer:Ext.emptyFn,constrainPosition:!0,autoHide:!0,shrinkWrapDock:!0}),me.tooltip=new Ext.tip.ToolTip(me.tipConfig),me.chart.surface.on("mousemove",me.tooltip.onMouseMove,me.tooltip),me.chart.surface.on("mouseleave",function(){me.hideTip()}),me.tipConfig.surface&&(surface=me.tipConfig.surface,sprites=surface.sprites,tipSurface=new Ext.chart.TipSurface({id:"tipSurfaceComponent",sprites:sprites}),surface.width&&surface.height&&tipSurface.setSize(surface.width,surface.height),me.tooltip.add(tipSurface),me.spriteTip=tipSurface))},showTip:function(item){var tooltip,spriteTip,tipConfig,trackMouse,sprite,surface,surfaceExt,pos,x,y,me=this;me.tooltip&&(clearTimeout(me.tipTimeout),tooltip=me.tooltip,spriteTip=me.spriteTip,tipConfig=me.tipConfig,trackMouse=tooltip.trackMouse,trackMouse||(tooltip.trackMouse=!0,sprite=item.sprite,surface=sprite.surface,surfaceExt=Ext.get(surface.getId()),surfaceExt&&(pos=surfaceExt.getXY(),x=pos[0]+(sprite.attr.x||0)+(sprite.attr.translation&&sprite.attr.translation.x||0),y=pos[1]+(sprite.attr.y||0)+(sprite.attr.translation&&sprite.attr.translation.y||0),tooltip.targetXY=[x,y])),spriteTip?tipConfig.renderer.call(tooltip,item.storeItem,item,spriteTip.surface):tipConfig.renderer.call(tooltip,item.storeItem,item),tooltip.delayShow(),tooltip.trackMouse=trackMouse)},hideTip:function(item){var tooltip=this.tooltip;tooltip&&(clearTimeout(this.tipTimeout),this.tipTimeout=setTimeout(function(){tooltip.delayHide()},0))}}),Ext.define("Ext.chart.axis.Abstract",{constructor:function(config){config=config||{};var me=this,pos=config.position||"left";pos=pos.charAt(0).toUpperCase()+pos.substring(1),config.label=Ext.apply(config["axisLabel"+pos+"Style"]||{},config.label||{}),config.axisTitleStyle=Ext.apply(config["axisTitle"+pos+"Style"]||{},config.labelTitle||{}),Ext.apply(me,config),me.fields=Ext.Array.from(me.fields),this.callParent(),me.labels=[],me.getId(),me.labelGroup=me.chart.surface.getGroup(me.axisId+"-labels")},alignment:null,grid:!1,steps:10,x:0,y:0,minValue:0,maxValue:0,getId:function(){return this.axisId||(this.axisId=Ext.id(null,"ext-axis-"))},processView:Ext.emptyFn,drawAxis:Ext.emptyFn,addDisplayAndLabels:Ext.emptyFn}),Ext.define("Ext.chart.axis.Axis",{extend:Ext.chart.axis.Abstract,alternateClassName:"Ext.chart.Axis",hidden:!1,forceMinMax:!1,dashSize:3,position:"bottom",skipFirst:!1,length:0,width:0,adjustEnd:!0,majorTickSteps:!1,nullGutters:{lower:0,upper:0,verticalAxis:void 0},applyData:Ext.emptyFn,getRange:function(){var axes,i,ln,ln2,j,k,aggregates,fields,fieldMap,record,field,value,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,series=chart.series.items,position=me.position,seriesClasses=Ext.chart.series,aggregations=[],min=1/0,max=-(1/0),vertical="left"===me.position||"right"===me.position||"radial"===me.position,dataLength=data.length,countedFields={},allFields={},excludable=!0;for(fields=me.fields,j=0,ln=fields.length;j<ln;j++)allFields[fields[j]]=!0;for(i=0,ln=series.length;i<ln;i++)if(!series[i].seriesIsHidden&&series[i].getAxesForXAndYFields&&(axes=series[i].getAxesForXAndYFields(),!axes.xAxis||axes.xAxis===position||!axes.yAxis||axes.yAxis===position)){if(fields=seriesClasses.Bar&&series[i]instanceof seriesClasses.Bar&&!series[i].column?vertical?Ext.Array.from(series[i].xField):Ext.Array.from(series[i].yField):vertical?Ext.Array.from(series[i].yField):Ext.Array.from(series[i].xField),me.fields.length){for(j=0,ln2=fields.length;j<ln2&&!allFields[fields[j]];j++);if(j==ln2)continue}if((aggregates=series[i].stacked)&&(seriesClasses.Bar&&series[i]instanceof seriesClasses.Bar?series[i].column!=vertical&&(aggregates=!1,excludable=!1):vertical||(aggregates=!1,excludable=!1)),aggregates){for(fieldMap={},j=0;j<fields.length;j++)excludable&&series[i].__excludes&&series[i].__excludes[j]||(allFields[fields[j]]||Ext.Logger.warn("Field `"+fields[j]+"` is not included in the "+position+" axis config."),allFields[fields[j]]=fieldMap[fields[j]]=!0);aggregations.push({fields:fieldMap,positiveValue:0,negativeValue:0})}else for(fields&&0!=fields.length||(fields=me.fields),j=0;j<fields.length;j++)excludable&&series[i].__excludes&&series[i].__excludes[j]||(allFields[fields[j]]=countedFields[fields[j]]=!0)}for(i=0;i<dataLength;i++){for(record=data[i],k=0;k<aggregations.length;k++)aggregations[k].positiveValue=0,aggregations[k].negativeValue=0;for(field in allFields)if(value=record.get(field),"Time"==me.type&&"string"==typeof value&&(value=Date.parse(value)),!isNaN(value))for(value=void 0===value?0:Number(value),countedFields[field]&&(min>value&&(min=value),max<value&&(max=value)),k=0;k<aggregations.length;k++)aggregations[k].fields[field]&&(value>=0?(aggregations[k].positiveValue+=value,max<aggregations[k].positiveValue&&(max=aggregations[k].positiveValue),min>0&&(min=0)):(aggregations[k].negativeValue+=value,min>aggregations[k].negativeValue&&(min=aggregations[k].negativeValue),max<0&&(max=0)))}return isFinite(max)||(max=me.prevMax||0),isFinite(min)||(min=me.prevMin||0),"number"==typeof min&&(min=Ext.Number.correctFloat(min)),"number"==typeof max&&(max=Ext.Number.correctFloat(max)),min==max||max==Math.floor(max)&&min==Math.floor(min)||(min=Math.floor(min),max=Math.floor(max)+1),isNaN(me.minimum)||(min=me.minimum),isNaN(me.maximum)||(max=me.maximum),min>=max&&(min=Math.floor(min),max=min+1),{min:min,max:max}},calcEnds:function(){var steps,prettyNumbers,out,changedRange,me=this,range=me.getRange(),min=range.min,max=range.max;return steps=Ext.isNumber(me.majorTickSteps)?me.majorTickSteps+1:me.steps,prettyNumbers=!(Ext.isNumber(me.maximum)&&Ext.isNumber(me.minimum)&&Ext.isNumber(me.majorTickSteps)&&me.majorTickSteps>0),out=Ext.draw.Draw.snapEnds(min,max,steps,prettyNumbers),Ext.isNumber(me.maximum)&&(out.to=me.maximum,changedRange=!0),Ext.isNumber(me.minimum)&&(out.from=me.minimum,changedRange=!0),me.adjustMaximumByMajorUnit&&(out.to=Math.ceil(out.to/out.step)*out.step,changedRange=!0),me.adjustMinimumByMajorUnit&&(out.from=Math.floor(out.from/out.step)*out.step,changedRange=!0),changedRange&&(out.steps=Math.ceil((out.to-out.from)/out.step)),me.prevMin=min==max?0:min,me.prevMax=max,out},drawAxis:function(init){var i,trueLength,currentX,currentY,path,seriesGutters,hasGutters,sameDirectionGutters,padding,subDashes,subDashValue,tick,axes,ln,val,begin,end,me=this,x=me.x,y=me.y,dashSize=me.dashSize,length=me.length,position=me.position,verticalAxis="left"==position||"right"==position,inflections=[],calcLabels=me.isNumericAxis,stepCalcs=me.applyData(),step=stepCalcs.step,steps=stepCalcs.steps,stepsArray=Ext.isArray(steps),from=stepCalcs.from,to=stepCalcs.to,axisRange=to-from||1,subDashesX=me.minorTickSteps||0,subDashesY=me.minorTickSteps||0,dashDirection=(Math.max(subDashesX+1,0),Math.max(subDashesY+1,0),"left"==position||"top"==position?-1:1),dashLength=dashSize*dashDirection,series=me.chart.series.items,firstSeries=series[0],gutters=Ext.clone(firstSeries?firstSeries.nullGutters:me.nullGutters),stepCount=0;if(me.from=from,me.to=to,!(me.hidden||from>to||stepsArray&&0==steps.length||!stepsArray&&isNaN(step))){if(stepsArray)steps=Ext.Array.filter(steps,function(elem,index,array){return+elem>+me.from&&+elem<+me.to},this),steps=Ext.Array.union([me.from],steps,[me.to]);else{for(steps=new Array,val=+me.from;val<+me.to;val+=step)steps.push(val);steps.push(+me.to)}for(stepCount=steps.length,i=0,ln=series.length;i<ln;i++)series[i].seriesIsHidden||series[i].getAxesForXAndYFields&&(axes=series[i].getAxesForXAndYFields(),axes.xAxis&&axes.yAxis&&axes.xAxis!==position&&axes.yAxis!==position||(seriesGutters=Ext.clone(series[i].getGutters()),hasGutters=void 0!==seriesGutters.verticalAxis,sameDirectionGutters=hasGutters&&seriesGutters.verticalAxis==verticalAxis,hasGutters&&(sameDirectionGutters||(padding=series[i].getPadding(),seriesGutters=verticalAxis?{lower:padding.bottom,upper:padding.top,verticalAxis:!0}:{lower:padding.left,upper:padding.right,verticalAxis:!1}),gutters.lower<seriesGutters.lower&&(gutters.lower=seriesGutters.lower),gutters.upper<seriesGutters.upper&&(gutters.upper=seriesGutters.upper),gutters.verticalAxis=verticalAxis)));if(calcLabels&&(me.labels=[]),gutters)if(verticalAxis)for(currentX=Math.floor(x),path=["M",currentX+.5,y,"l",0,-length],trueLength=length-(gutters.lower+gutters.upper),tick=0;tick<stepCount;tick++)currentY=y-gutters.lower-(steps[tick]-steps[0])*trueLength/axisRange,path.push("M",currentX,Math.floor(currentY)+.5,"l",2*dashLength,0),inflections.push([currentX,Math.floor(currentY)]),calcLabels&&me.labels.push(steps[tick]);else for(currentY=Math.floor(y),path=["M",x,currentY+.5,"l",length,0],trueLength=length-(gutters.lower+gutters.upper),tick=0;tick<stepCount;tick++)currentX=x+gutters.lower+(steps[tick]-steps[0])*trueLength/axisRange,path.push("M",Math.floor(currentX)+.5,currentY,"l",0,2*dashLength+1),inflections.push([Math.floor(currentX),currentY]),calcLabels&&me.labels.push(steps[tick]);if(subDashes=verticalAxis?subDashesY:subDashesX,Ext.isArray(subDashes)?subDashValue=2==subDashes.length?+Ext.Date.add(new Date,subDashes[0],subDashes[1])-Date.now():subDashes[0]:Ext.isNumber(subDashes)&&subDashes>0&&(subDashValue=step/(subDashes+1)),gutters&&subDashValue)for(tick=0;tick<stepCount-1;tick++)if(begin=+steps[tick],end=+steps[tick+1],verticalAxis)for(value=begin+subDashValue;value<end;value+=subDashValue)currentY=y-gutters.lower-(value-steps[0])*trueLength/axisRange,path.push("M",currentX,Math.floor(currentY)+.5,"l",dashLength,0);else for(value=begin+subDashValue;value<end;value+=subDashValue)currentX=x+gutters.upper+(value-steps[0])*trueLength/axisRange,path.push("M",Math.floor(currentX)+.5,currentY,"l",0,dashLength+1);me.axis||(me.axis=me.chart.surface.add(Ext.apply({type:"path",path:path},me.axisStyle))),me.axis.setAttributes({path:path},!0),me.inflections=inflections,!init&&me.grid&&me.drawGrid(),me.axisBBox=me.axis.getBBox(),me.drawLabel()}},drawGrid:function(){var point,prevPoint,styles,lineWidth,dlineWidth,me=this,surface=me.chart.surface,grid=me.grid,odd=grid.odd,even=grid.even,inflections=me.inflections,ln=inflections.length-(odd||even?0:1),position=me.position,maxGutters=me.chart.maxGutters,width=me.width-2,i=1,path=[],oddPath=[],evenPath=[];for((0===maxGutters.bottom&&0===maxGutters.top||"left"!=position&&"right"!=position)&&(0===maxGutters.left&&0===maxGutters.right||"top"!=position&&"bottom"!=position)||(i=0,ln++);i<ln;i++)point=inflections[i],prevPoint=inflections[i-1],odd||even?(path=i%2?oddPath:evenPath,styles=(i%2?odd:even)||{},lineWidth=(styles.lineWidth||styles["stroke-width"]||0)/2,dlineWidth=2*lineWidth,"left"==position?path.push("M",prevPoint[0]+1+lineWidth,prevPoint[1]+.5-lineWidth,"L",prevPoint[0]+1+width-lineWidth,prevPoint[1]+.5-lineWidth,"L",point[0]+1+width-lineWidth,point[1]+.5+lineWidth,"L",point[0]+1+lineWidth,point[1]+.5+lineWidth,"Z"):"right"==position?path.push("M",prevPoint[0]-lineWidth,prevPoint[1]+.5-lineWidth,"L",prevPoint[0]-width+lineWidth,prevPoint[1]+.5-lineWidth,"L",point[0]-width+lineWidth,point[1]+.5+lineWidth,"L",point[0]-lineWidth,point[1]+.5+lineWidth,"Z"):"top"==position?path.push("M",prevPoint[0]+.5+lineWidth,prevPoint[1]+1+lineWidth,"L",prevPoint[0]+.5+lineWidth,prevPoint[1]+1+width-lineWidth,"L",point[0]+.5-lineWidth,point[1]+1+width-lineWidth,"L",point[0]+.5-lineWidth,point[1]+1+lineWidth,"Z"):path.push("M",prevPoint[0]+.5+lineWidth,prevPoint[1]-lineWidth,"L",prevPoint[0]+.5+lineWidth,prevPoint[1]-width+lineWidth,"L",point[0]+.5-lineWidth,point[1]-width+lineWidth,"L",point[0]+.5-lineWidth,point[1]-lineWidth,"Z")):path="left"==position?path.concat(["M",point[0]+.5,point[1]+.5,"l",width,0]):"right"==position?path.concat(["M",point[0]-.5,point[1]+.5,"l",-width,0]):"top"==position?path.concat(["M",point[0]+.5,point[1]+.5,"l",0,width]):path.concat(["M",point[0]+.5,point[1]-.5,"l",0,-width]);odd||even?(oddPath.length&&(!me.gridOdd&&oddPath.length&&(me.gridOdd=surface.add({type:"path",path:oddPath})),me.gridOdd.setAttributes(Ext.apply({path:oddPath,hidden:!1},odd||{}),!0)),evenPath.length&&(me.gridEven||(me.gridEven=surface.add({type:"path",path:evenPath})),me.gridEven.setAttributes(Ext.apply({path:evenPath,hidden:!1},even||{}),!0))):path.length?(me.gridLines||(me.gridLines=me.chart.surface.add({type:"path",path:path,"stroke-width":me.lineWidth||1,stroke:me.gridColor||"#ccc"})),me.gridLines.setAttributes({hidden:!1,path:path},!0)):me.gridLines&&me.gridLines.hide(!0)},getOrCreateLabel:function(i,text){var me=this,labelGroup=me.labelGroup,textLabel=labelGroup.getAt(i),surface=me.chart.surface;return textLabel?text!=textLabel.attr.text&&(textLabel.setAttributes(Ext.apply({text:text},me.label),!0),textLabel._bbox=textLabel.getBBox()):(textLabel=surface.add(Ext.apply({group:labelGroup,type:"text",x:0,y:0,text:text},me.label)),surface.renderItem(textLabel),textLabel._bbox=textLabel.getBBox()),me.label.rotation?(textLabel.setAttributes({rotation:{degrees:0}},!0),textLabel._ubbox=textLabel.getBBox(),textLabel.setAttributes(me.label,!0)):textLabel._ubbox=textLabel._bbox,textLabel},rect2pointArray:function(sprite){var surface=this.chart.surface,rect=surface.getBBox(sprite,!0),p1=[rect.x,rect.y],p1p=p1.slice(),p2=[rect.x+rect.width,rect.y],p2p=p2.slice(),p3=[rect.x+rect.width,rect.y+rect.height],p3p=p3.slice(),p4=[rect.x,rect.y+rect.height],p4p=p4.slice(),matrix=sprite.matrix;return p1[0]=matrix.x.apply(matrix,p1p),p1[1]=matrix.y.apply(matrix,p1p),p2[0]=matrix.x.apply(matrix,p2p),p2[1]=matrix.y.apply(matrix,p2p),p3[0]=matrix.x.apply(matrix,p3p),p3[1]=matrix.y.apply(matrix,p3p),p4[0]=matrix.x.apply(matrix,p4p),p4[1]=matrix.y.apply(matrix,p4p),[p1,p2,p3,p4]},intersect:function(l1,l2){var r1=this.rect2pointArray(l1),r2=this.rect2pointArray(l2);return!!Ext.draw.Draw.intersect(r1,r2).length},drawHorizontalLabels:function(){var ratio,bbox,point,prevLabel,prevLabelId,textLabel,text,idx,last,x,y,i,firstLabel,me=this,labelConf=me.label,floor=Math.floor,max=Math.max,axes=me.chart.axes,insetPadding=me.chart.insetPadding,gutters=me.chart.maxGutters,position=me.position,inflections=me.inflections,ln=inflections.length,labels=me.labels,maxHeight=0,adjustEnd=me.adjustEnd,hasLeft=axes.findIndex("position","left")!=-1,hasRight=axes.findIndex("position","right")!=-1,reverse=me.reverse;for(last=ln-1,point=inflections[0],firstLabel=me.getOrCreateLabel(0,me.label.renderer(labels[0])),ratio=Math.floor(Math.abs(Math.sin(labelConf.rotate&&labelConf.rotate.degrees*Math.PI/180||0))),i=0;i<ln;i++){if(point=inflections[i],idx=i,reverse&&(idx=ln-i-1),text=me.label.renderer(labels[idx]),textLabel=me.getOrCreateLabel(i,text),bbox=textLabel._bbox,maxHeight=max(maxHeight,bbox.height+me.dashSize+me.label.padding),x=floor(point[0]-(ratio?bbox.height:bbox.width)/2),adjustEnd&&0==gutters.left&&0==gutters.right&&(0!=i||hasLeft?i!=last||hasRight||(x=Math.min(x,point[0]-bbox.width+insetPadding)):x=point[0]),y="top"==position?point[1]-2*me.dashSize-me.label.padding-bbox.height/2:point[1]+2*me.dashSize+me.label.padding+bbox.height/2,textLabel.setAttributes({hidden:!1,x:x,y:y},!0),0!=i&&(me.intersect(textLabel,prevLabel)||me.intersect(textLabel,firstLabel))){if(i!==last||0===prevLabelId){textLabel.hide(!0);continue}prevLabel.hide(!0)}prevLabel=textLabel,prevLabelId=i}return maxHeight},drawVerticalLabels:function(){var bbox,point,prevLabel,prevLabelId,textLabel,text,x,y,i,me=this,inflections=me.inflections,position=me.position,ln=inflections.length,chart=me.chart,insetPadding=chart.insetPadding,labels=me.labels,maxWidth=0,max=Math.max,floor=Math.floor,ceil=Math.ceil,axes=me.chart.axes,gutters=me.chart.maxGutters,hasTop=axes.findIndex("position","top")!=-1,hasBottom=axes.findIndex("position","bottom")!=-1,adjustEnd=me.adjustEnd,last=ln-1;
for(i=0;i<ln;i++){if(point=inflections[i],text=me.label.renderer(labels[i]),textLabel=me.getOrCreateLabel(i,text),bbox=textLabel._bbox,maxWidth=max(maxWidth,bbox.width+me.dashSize+me.label.padding),y=point[1],adjustEnd&&gutters.bottom+gutters.top<bbox.height/2&&(i!=last||hasTop?0!=i||hasBottom||(y=me.y+gutters.bottom-floor(bbox.height/2)):y=Math.max(y,me.y-me.length+ceil(bbox.height/2)-insetPadding)),x="left"==position?point[0]-bbox.width-me.dashSize-me.label.padding-2:point[0]+me.dashSize+me.label.padding+2,textLabel.setAttributes(Ext.apply({hidden:!1,x:x,y:y},me.label),!0),0!=i&&me.intersect(textLabel,prevLabel)){if(i!==last||0===prevLabelId){textLabel.hide(!0);continue}prevLabel.hide(!0)}prevLabel=textLabel,prevLabelId=i}return maxWidth},drawLabel:function(){var ln,i,me=this,position=me.position,labelGroup=me.labelGroup,inflections=me.inflections,maxWidth=0,maxHeight=0;for("left"==position||"right"==position?maxWidth=me.drawVerticalLabels():maxHeight=me.drawHorizontalLabels(),ln=labelGroup.getCount(),i=inflections.length;i<ln;i++)labelGroup.getAt(i).hide(!0);me.bbox={},Ext.apply(me.bbox,me.axisBBox),me.bbox.height=maxHeight,me.bbox.width=maxWidth,Ext.isString(me.title)&&me.drawTitle(maxWidth,maxHeight)},setTitle:function(title){this.title=title,this.drawLabel()},drawTitle:function(maxWidth,maxHeight){var base,bbox,pad,me=this,position=me.position,surface=me.chart.surface,displaySprite=me.displaySprite,title=me.title,rotate="left"==position||"right"==position,x=me.x,y=me.y;displaySprite?displaySprite.setAttributes({text:title},!0):(base={type:"text",x:0,y:0,text:title},displaySprite=me.displaySprite=surface.add(Ext.apply(base,me.axisTitleStyle,me.labelTitle)),surface.renderItem(displaySprite)),bbox=displaySprite.getBBox(),pad=me.dashSize+me.label.padding,rotate?(y-=me.length/2-bbox.height/2,"left"==position?x-=maxWidth+pad+bbox.width/2:x+=maxWidth+pad+bbox.width-bbox.width/2,me.bbox.width+=bbox.width+10):(x+=me.length/2-.5*bbox.width,"top"==position?y-=maxHeight+pad+.3*bbox.height:y+=maxHeight+pad+.8*bbox.height,me.bbox.height+=bbox.height+10),displaySprite.setAttributes({translate:{x:x,y:y}},!0)}}),Ext.define("Ext.chart.axis.Category",{extend:Ext.chart.axis.Axis,alternateClassName:"Ext.chart.CategoryAxis",alias:"axis.category",isCategoryAxis:!0,doConstrain:function(){var i,me=this,chart=me.chart,store=chart.getChartStore(),items=store.data.items,series=chart.series.items,seriesLength=series.length,data=[];for(i=0;i<seriesLength;i++)if("bar"===series[i].type&&series[i].stacked)return;for(i=me.minimum;i<me.maximum;i++)data.push(items[i]);chart.setSubStore(new Ext.data.Store({model:store.model,data:data}))},setLabels:function(){var d,dLen,record,labels,name,i,store=this.chart.getChartStore(),data=store.data.items,fields=this.fields,ln=fields.length;for(labels=this.labels=[],d=0,dLen=data.length;d<dLen;d++)for(record=data[d],i=0;i<ln;i++)name=record.get(fields[i]),labels.push(name)},applyData:function(){this.callParent(),this.setLabels();var count=this.chart.getChartStore().getCount();return{from:0,to:count-1,power:1,step:1,steps:count-1}}}),Ext.define("Ext.chart.axis.Gauge",{extend:Ext.chart.axis.Abstract,position:"gauge",alias:"axis.gauge",drawAxis:function(init){var sprite,i,chart=this.chart,surface=chart.surface,bbox=chart.chartBBox,centerX=bbox.x+bbox.width/2,centerY=bbox.y+bbox.height,margin=this.margin||10,rho=Math.min(bbox.width,2*bbox.height)/2+margin,sprites=[],steps=this.steps,pi=Math.PI,cos=Math.cos,sin=Math.sin;if(this.sprites&&!chart.resizing)return void this.drawLabel();if(this.margin>=0)if(this.sprites)for(sprites=this.sprites,i=0;i<=steps;i++)sprites[i].setAttributes({path:["M",centerX+(rho-margin)*cos(i/steps*pi-pi),centerY+(rho-margin)*sin(i/steps*pi-pi),"L",centerX+rho*cos(i/steps*pi-pi),centerY+rho*sin(i/steps*pi-pi),"Z"],stroke:"#ccc"},!0);else for(i=0;i<=steps;i++)sprite=surface.add({type:"path",path:["M",centerX+(rho-margin)*cos(i/steps*pi-pi),centerY+(rho-margin)*sin(i/steps*pi-pi),"L",centerX+rho*cos(i/steps*pi-pi),centerY+rho*sin(i/steps*pi-pi),"Z"],stroke:"#ccc"}),sprite.setAttributes({hidden:!1},!0),sprites.push(sprite);this.sprites=sprites,this.drawLabel(),this.title&&this.drawTitle()},drawTitle:function(){var labelBBox,me=this,chart=me.chart,surface=chart.surface,bbox=chart.chartBBox,labelSprite=me.titleSprite;labelSprite||(me.titleSprite=labelSprite=surface.add(Ext.apply({type:"text",zIndex:2},me.axisTitleStyle,me.labelTitle))),labelSprite.setAttributes(Ext.apply({text:me.title},me.label||{}),!0),labelBBox=labelSprite.getBBox(),labelSprite.setAttributes({x:bbox.x+bbox.width/2-labelBBox.width/2,y:bbox.y+bbox.height-labelBBox.height/2-4},!0)},setTitle:function(title){this.title=title,this.drawTitle()},drawLabel:function(){var label,i,adjY,idx,me=this,chart=me.chart,surface=chart.surface,bbox=chart.chartBBox,centerX=bbox.x+bbox.width/2,centerY=bbox.y+bbox.height,margin=me.margin||10,rho=Math.min(bbox.width,2*bbox.height)/2+2*margin,round=Math.round,labelArray=[],maxValue=me.maximum||0,minValue=me.minimum||0,steps=me.steps,pi=Math.PI,cos=Math.cos,sin=Math.sin,labelConf=this.label,renderer=labelConf.renderer||Ext.identityFn,reverse=me.reverse;if(this.labelArray)for(labelArray=this.labelArray,i=0;i<=steps;i++)adjY=0===i||i===steps?7:0,idx=reverse?steps-i:i,labelArray[i].setAttributes({text:renderer(round(minValue+idx/steps*(maxValue-minValue))),x:centerX+rho*cos(i/steps*pi-pi),y:centerY+rho*sin(i/steps*pi-pi)-adjY},!0);else for(i=0;i<=steps;i++)adjY=0===i||i===steps?7:0,idx=reverse?steps-i:i,label=surface.add({type:"text",text:renderer(round(minValue+idx/steps*(maxValue-minValue))),x:centerX+rho*cos(i/steps*pi-pi),y:centerY+rho*sin(i/steps*pi-pi)-adjY,"text-anchor":"middle","stroke-width":.2,zIndex:10,stroke:"#333"}),label.setAttributes({hidden:!1},!0),labelArray.push(label);this.labelArray=labelArray}}),Ext.define("Ext.chart.axis.Numeric",{extend:Ext.chart.axis.Axis,alternateClassName:"Ext.chart.NumericAxis",type:"Numeric",isNumericAxis:!0,alias:"axis.numeric",constructor:function(config){var label,me=this,hasLabel=!(!config.label||!config.label.renderer);me.callParent([config]),label=me.label,null==config.constrain&&(me.constrain=null!=config.minimum&&null!=config.maximum),hasLabel||(label.renderer=function(v){return me.roundToDecimal(v,me.decimals)})},roundToDecimal:function(v,dec){var val=Math.pow(10,dec||0);return Math.round(v*val)/val},minimum:NaN,maximum:NaN,constrain:!0,decimals:2,scale:"linear",doConstrain:function(){var d,dLen,record,i,value,addRecord,me=this,chart=me.chart,store=chart.getChartStore(),items=store.data.items,fields=(chart.series.items,me.fields),ln=fields.length,range=me.calcEnds(),min=range.from,max=range.to,data=[];for(d=0,dLen=items.length;d<dLen;d++){for(addRecord=!0,record=items[d],i=0;i<ln;i++){if(value=record.get(fields[i]),"Time"==me.type&&"string"==typeof value&&(value=Date.parse(value)),+value<+min){addRecord=!1;break}if(+value>+max){addRecord=!1;break}}addRecord&&data.push(record)}chart.setSubStore(new Ext.data.Store({model:store.model,data:data}))},position:"left",adjustMaximumByMajorUnit:!1,adjustMinimumByMajorUnit:!1,processView:function(){var i,l,me=this,chart=me.chart,series=chart.series.items;for(i=0,l=series.length;i<l;i++)if(series[i].stacked){delete me.minimum,delete me.maximum,me.constrain=!1;break}me.constrain&&me.doConstrain()},applyData:function(){return this.callParent(),this.calcEnds()}}),Ext.define("Ext.chart.axis.Radial",{extend:Ext.chart.axis.Numeric,position:"radial",alias:"axis.radial",drawAxis:function(init){var sprite,i,j,chart=this.chart,surface=chart.surface,bbox=chart.chartBBox,store=chart.getChartStore(),l=store.getCount(),centerX=bbox.x+bbox.width/2,centerY=bbox.y+bbox.height/2,rho=Math.min(bbox.width,bbox.height)/2,sprites=[],steps=this.steps,pi2=2*Math.PI,cos=Math.cos,sin=Math.sin;if(this.sprites&&!chart.resizing)return void this.drawLabel();if(this.sprites){for(sprites=this.sprites,i=0;i<steps;i++)sprites[i].setAttributes({x:centerX,y:centerY,radius:Math.max(rho*(i+1)/steps,0),stroke:"#ccc"},!0);for(j=0;j<l;j++)sprites[i+j].setAttributes({path:["M",centerX,centerY,"L",centerX+rho*cos(j/l*pi2),centerY+rho*sin(j/l*pi2),"Z"],stroke:"#ccc"},!0)}else{for(i=1;i<=steps;i++)sprite=surface.add({type:"circle",x:centerX,y:centerY,radius:Math.max(rho*i/steps,0),stroke:"#ccc"}),sprite.setAttributes({hidden:!1},!0),sprites.push(sprite);for(i=0;i<l;i++)sprite=surface.add({type:"path",path:["M",centerX,centerY,"L",centerX+rho*cos(i/l*pi2),centerY+rho*sin(i/l*pi2),"Z"],stroke:"#ccc"}),sprite.setAttributes({hidden:!1},!0),sprites.push(sprite)}this.sprites=sprites,this.drawLabel()},drawLabel:function(){var series,ln,record,label,nfields,xField,j,dx,dy,chart=this.chart,seriesItems=chart.series.items,surface=chart.surface,bbox=chart.chartBBox,store=chart.getChartStore(),data=store.data.items,centerX=bbox.x+bbox.width/2,centerY=bbox.y+bbox.height/2,rho=Math.min(bbox.width,bbox.height)/2,max=Math.max,round=Math.round,labelArray=[],fields=[],categories=[],aggregate=!this.maximum,maxValue=this.maximum||0,steps=this.steps,i=0,pi2=2*Math.PI,cos=Math.cos,sin=Math.sin,display=this.label.display,draw="none"!==display,margin=10;if(draw){for(i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],fields.push(series.yField),xField=series.xField;for(j=0,ln=data.length;j<ln;j++)if(record=data[j],categories.push(record.get(xField)),aggregate)for(i=0,nfields=fields.length;i<nfields;i++)maxValue=max(+record.get(fields[i]),maxValue);if(this.labelArray){if(labelArray=this.labelArray,"categories"!=display)for(i=0;i<steps;i++)labelArray[i].setAttributes({text:round((i+1)/steps*maxValue),x:centerX,y:centerY-rho*(i+1)/steps,"text-anchor":"middle","stroke-width":.1,stroke:"#333"},!0);if("scale"!=display)for(j=0,steps=categories.length;j<steps;j++)dx=cos(j/steps*pi2)*(rho+margin),dy=sin(j/steps*pi2)*(rho+margin),labelArray[i+j]&&labelArray[i+j].setAttributes({type:"text",text:categories[j],x:centerX+dx,y:centerY+dy,"text-anchor":dx*dx<=.001?"middle":dx<0?"end":"start"},!0)}else{if("categories"!=display)for(i=1;i<=steps;i++)label=surface.add({type:"text",text:round(i/steps*maxValue),x:centerX,y:centerY-rho*i/steps,"text-anchor":"middle","stroke-width":.1,stroke:"#333"}),label.setAttributes({hidden:!1},!0),labelArray.push(label);if("scale"!=display)for(j=0,steps=categories.length;j<steps;j++)dx=cos(j/steps*pi2)*(rho+margin),dy=sin(j/steps*pi2)*(rho+margin),label=surface.add({type:"text",text:categories[j],x:centerX+dx,y:centerY+dy,"text-anchor":dx*dx<=.001?"middle":dx<0?"end":"start"}),label.setAttributes({hidden:!1},!0),labelArray.push(label)}this.labelArray=labelArray}},getRange:function(){var range=this.callParent();return range.min=0,range},processView:function(){var i,ln,series,ends,me=this,seriesItems=me.chart.series.items,fields=[];for(i=0,ln=seriesItems.length;i<ln;i++)series=seriesItems[i],fields.push(series.yField);me.fields=fields,ends=me.calcEnds(),me.maximum=ends.to,me.steps=ends.steps}}),Ext.define("Ext.chart.axis.Time",{extend:Ext.chart.axis.Numeric,alternateClassName:"Ext.chart.TimeAxis",type:"Time",alias:"axis.time",dateFormat:!1,fromDate:!1,toDate:!1,step:[Ext.Date.DAY,1],constrain:!1,constructor:function(config){var label,f,df,me=this;me.callParent([config]),label=me.label||{},df=this.dateFormat,df&&(label.renderer?(f=label.renderer,label.renderer=function(v){return v=f(v),Ext.Date.format(new Date(f(v)),df)}):label.renderer=function(v){return Ext.Date.format(new Date(v>>0),df)})},processView:function(){var me=this;me.fromDate&&(me.minimum=+me.fromDate),me.toDate&&(me.maximum=+me.toDate),me.constrain&&me.doConstrain()},calcEnds:function(){var range,me=this,step=me.step;return step?(range=me.getRange(),range=Ext.draw.Draw.snapEndsByDateAndStep(new Date(range.min),new Date(range.max),Ext.isNumber(step)?[Date.MILLI,step]:step),me.minimum&&(range.from=me.minimum),me.maximum&&(range.to=me.maximum),range):me.callParent(arguments)}}),Ext.define("Ext.chart.series.Series",{mixins:{observable:Ext.util.Observable,labels:Ext.chart.Label,highlights:Ext.chart.Highlight,tips:Ext.chart.Tip,callouts:Ext.chart.Callout},type:null,title:null,showInLegend:!0,renderer:function(sprite,record,attributes,index,store){return attributes},shadowAttributes:null,animating:!1,nullGutters:{lower:0,upper:0,verticalAxis:void 0},nullPadding:{left:0,right:0,width:0,bottom:0,top:0,height:0},constructor:function(config){var me=this;config&&Ext.apply(me,config),me.shadowGroups=[],me.mixins.labels.constructor.call(me,config),me.mixins.highlights.constructor.call(me,config),me.mixins.tips.constructor.call(me,config),me.mixins.callouts.constructor.call(me,config),me.addEvents({scope:me,itemclick:!0,itemdblclick:!0,itemmouseover:!0,itemmouseout:!0,itemmousedown:!0,itemmouseup:!0,mouseleave:!0,afterdraw:!0,titlechange:!0}),me.mixins.observable.constructor.call(me,config),me.on({scope:me,itemmouseover:me.onItemMouseOver,itemmouseout:me.onItemMouseOut,mouseleave:me.onMouseLeave}),me.style&&Ext.apply(me.seriesStyle,me.style)},initialize:Ext.emptyFn,onRedraw:Ext.emptyFn,eachRecord:function(fn,scope){var chart=this.chart;chart.getChartStore().each(fn,scope)},getRecordCount:function(){var chart=this.chart,store=chart.getChartStore();return store?store.getCount():0},isExcluded:function(index){var excludes=this.__excludes;return!(!excludes||!excludes[index])},setBBox:function(noGutter){var clipBox,bbox,me=this,chart=me.chart,chartBBox=chart.chartBBox,maxGutters=noGutter?{left:0,right:0,bottom:0,top:0}:chart.maxGutters;clipBox={x:chartBBox.x,y:chartBBox.y,width:chartBBox.width,height:chartBBox.height},me.clipBox=clipBox,bbox={x:clipBox.x+maxGutters.left-chart.zoom.x*chart.zoom.width,y:clipBox.y+maxGutters.bottom-chart.zoom.y*chart.zoom.height,width:(clipBox.width-(maxGutters.left+maxGutters.right))*chart.zoom.width,height:(clipBox.height-(maxGutters.bottom+maxGutters.top))*chart.zoom.height},me.bbox=bbox},onAnimate:function(sprite,attr){var me=this;return sprite.stopAnimation(),me.animating?sprite.animate(Ext.applyIf(attr,me.chart.animate)):(me.animating=!0,sprite.animate(Ext.apply(Ext.applyIf(attr,me.chart.animate),{callback:function(){me.animating=!1,me.fireEvent("afterrender",me)}})))},getGutters:function(){return this.nullGutters},getPadding:function(){return this.nullPadding},onItemMouseOver:function(item){var me=this;item.series===me&&(me.highlight&&me.highlightItem(item),me.tooltip&&me.showTip(item))},onItemMouseOut:function(item){var me=this;item.series===me&&(me.unHighlightItem(),me.tooltip&&me.hideTip(item))},onMouseLeave:function(){var me=this;me.unHighlightItem(),me.tooltip&&me.hideTip()},getItemForPoint:function(x,y){if(!this.items||!this.items.length||this.seriesIsHidden)return null;var i,ln,me=this,items=me.items,bbox=me.bbox;if(!Ext.draw.Draw.withinBox(x,y,bbox))return null;for(i=0,ln=items.length;i<ln;i++)if(items[i]&&this.isItemInPoint(x,y,items[i],i))return items[i];return null},isItemInPoint:function(x,y,item,i){return!1},hideAll:function(){var item,len,i,j,l,sprite,shadows,me=this,items=me.items;for(me.seriesIsHidden=!0,me._prevShowMarkers=me.showMarkers,me.showMarkers=!1,me.hideLabels(0),i=0,len=items.length;i<len;i++)if(item=items[i],sprite=item.sprite,sprite&&sprite.setAttributes({hidden:!0},!0),sprite&&sprite.shadows)for(shadows=sprite.shadows,j=0,l=shadows.length;j<l;++j)shadows[j].setAttributes({hidden:!0},!0)},showAll:function(){var me=this,prevAnimate=me.chart.animate;me.chart.animate=!1,me.seriesIsHidden=!1,me.showMarkers=me._prevShowMarkers,me.drawSeries(),me.chart.animate=prevAnimate},hide:function(){if(this.items){var i,j,lsh,ln,shadows,me=this,items=me.items;if(items&&items.length){for(i=0,ln=items.length;i<ln;++i)if(items[i].sprite&&(items[i].sprite.hide(!0),shadows=items[i].shadows||items[i].sprite.shadows))for(j=0,lsh=shadows.length;j<lsh;++j)shadows[j].hide(!0);me.hideLabels()}}},getLegendColor:function(index){var fill,stroke,me=this;if(me.seriesStyle){if(fill=me.seriesStyle.fill,stroke=me.seriesStyle.stroke,fill&&"none"!=fill)return fill;if(stroke)return stroke}return me.colorArrayStyle?me.colorArrayStyle[me.themeIdx%me.colorArrayStyle.length]:"#000"},visibleInLegend:function(index){var excludes=this.__excludes;return excludes?!excludes[index]:!this.seriesIsHidden},setTitle:function(index,title){var me=this,oldTitle=me.title;Ext.isString(index)&&(title=index,index=0),Ext.isArray(oldTitle)?oldTitle[index]=title:me.title=title,me.fireEvent("titlechange",title,index)}}),Ext.define("Ext.chart.series.Cartesian",{extend:Ext.chart.series.Series,alternateClassName:["Ext.chart.CartesianSeries","Ext.chart.CartesianChart"],xField:null,yField:null,axis:"left",getLegendLabels:function(){var fields,i,ln,title,combo,label0,label1,me=this,labels=[],combinations=me.combinations;for(fields=[].concat(me.yField),i=0,ln=fields.length;i<ln;i++)title=me.title,labels.push((Ext.isArray(title)?title[i]:title)||fields[i]);if(combinations)for(combinations=Ext.Array.from(combinations),i=0,ln=combinations.length;i<ln;i++)combo=combinations[i],label0=labels[combo[0]],label1=labels[combo[1]],labels[combo[1]]=label0+" & "+label1,labels.splice(combo[0],1);return labels},eachYValue:function(record,fn,scope){var i,ln,accessor,me=this,yValueAccessors=me.getYValueAccessors();for(i=0,ln=yValueAccessors.length;i<ln;i++)accessor=yValueAccessors[i],fn.call(scope,accessor(record),i)},getYValueCount:function(){return this.getYValueAccessors().length},combine:function(index1,index2){var me=this,accessors=me.getYValueAccessors(),accessor1=accessors[index1],accessor2=accessors[index2];accessors[index2]=function(record){return accessor1(record)+accessor2(record)},accessors.splice(index1,1),me.callParent([index1,index2])},clearCombinations:function(){delete this.yValueAccessors,this.callParent()},getYValueAccessors:function(){function getFieldAccessor(field){return function(record){return record.get(field)}}var yFields,i,ln,me=this,accessors=me.yValueAccessors;if(!accessors)for(accessors=me.yValueAccessors=[],yFields=[].concat(me.yField),i=0,ln=yFields.length;i<ln;i++)accessors.push(getFieldAccessor(yFields[i]));return accessors},getMinMaxXValues:function(){var i,ln,record,min,max,xValue,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,count=me.getRecordCount(),xField=me.xField;if(count>0){for(min=1/0,max=-min,i=0,ln=data.length;i<ln;i++)record=data[i],xValue=record.get(xField),xValue>max&&(max=xValue),xValue<min&&(min=xValue);min==1/0&&(min=0),max==-(1/0)&&(max=count-1)}else min=max=0;return[min,max]},getMinMaxYValues:function(){function eachYValueStacked(yValue,i){me.isExcluded(i)||(yValue<0?negativeTotal+=yValue:positiveTotal+=yValue)}function eachYValue(yValue,i){me.isExcluded(i)||(yValue>max&&(max=yValue),yValue<min&&(min=yValue))}var i,ln,record,min,max,positiveTotal,negativeTotal,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,count=me.getRecordCount(),stacked=me.stacked;if(count>0){for(min=1/0,max=-min,i=0,ln=data.length;i<ln;i++)record=data[i],stacked?(positiveTotal=0,negativeTotal=0,me.eachYValue(record,eachYValueStacked),positiveTotal>max&&(max=positiveTotal),negativeTotal<min&&(min=negativeTotal)):me.eachYValue(record,eachYValue);min==1/0&&(min=0),max==-(1/0)&&(max=count-1)}else min=max=0;return[min,max]},getAxesForXAndYFields:function(){var fields,xAxis,yAxis,i,ln,flipXY,me=this,axes=me.chart.axes,axis=(me.reverse,[].concat(me.axis)),yFields={},yFieldList=[].concat(me.yField),xFields={},xFieldList=[].concat(me.xField);if(flipXY="bar"===me.type&&me.column===!1,flipXY&&(fields=yFieldList,yFieldList=xFieldList,xFieldList=fields),Ext.Array.indexOf(axis,"top")>-1)xAxis="top";else if(Ext.Array.indexOf(axis,"bottom")>-1)xAxis="bottom";else if(axes.get("top")&&axes.get("bottom")){for(i=0,ln=xFieldList.length;i<ln;i++)xFields[xFieldList[i]]=!0;for(fields=[].concat(axes.get("bottom").fields),i=0,ln=fields.length;i<ln;i++)if(xFields[fields[i]]){xAxis="bottom";break}for(fields=[].concat(axes.get("top").fields),i=0,ln=fields.length;i<ln;i++)if(xFields[fields[i]]){xAxis="top";break}}else axes.get("top")?xAxis="top":axes.get("bottom")&&(xAxis="bottom");if(Ext.Array.indexOf(axis,"left")>-1)yAxis=flipXY?"right":"left";else if(Ext.Array.indexOf(axis,"right")>-1)yAxis=flipXY?"left":"right";else if(axes.get("left")&&axes.get("right")){for(i=0,ln=yFieldList.length;i<ln;i++)yFields[yFieldList[i]]=!0;for(fields=[].concat(axes.get("right").fields),i=0,ln=fields.length;i<ln&&!yFields[fields[i]];i++);for(fields=[].concat(axes.get("left").fields),i=0,ln=fields.length;i<ln;i++)if(yFields[fields[i]]){yAxis="left";break}}else axes.get("left")?yAxis="left":axes.get("right")&&(yAxis="right");return flipXY?{xAxis:yAxis,yAxis:xAxis}:{xAxis:xAxis,yAxis:yAxis}}}),Ext.define("Ext.chart.series.Area",{extend:Ext.chart.series.Cartesian,alias:"series.area",type:"area",stacked:!0,style:{},constructor:function(config){this.callParent(arguments);var me=this,surface=me.chart.surface;config.highlightCfg=Ext.Object.merge({},{lineWidth:3,stroke:"#55c",opacity:.8,color:"#f00"},config.highlightCfg),Ext.apply(me,config,{__excludes:[]}),me.highlight&&(me.highlightSprite=surface.add({type:"path",path:["M",0,0],zIndex:1e3,opacity:.3,lineWidth:5,hidden:!0,stroke:"#444"})),me.group=surface.getGroup(me.seriesId)},shrink:function(xValues,yValues,size){var i,j,len=xValues.length,ratio=Math.floor(len/size),xSum=0,yCompLen=this.areas.length,ySum=[],xRes=[],yRes=[];for(j=0;j<yCompLen;++j)ySum[j]=0;for(i=0;i<len;++i){for(xSum+=+xValues[i],j=0;j<yCompLen;++j)ySum[j]+=+yValues[i][j];if(i%ratio==0){for(xRes.push(xSum/ratio),j=0;j<yCompLen;++j)ySum[j]/=ratio;for(yRes.push(ySum),xSum=0,j=0,ySum=[];j<yCompLen;++j)ySum[j]=0}}return{x:xRes,y:yRes}},getBounds:function(){var i,l,record,ends,allowDate,tmp,bbox,xScale,yScale,xValue,yValue,areaIndex,acumY,ln,sumValues,areaElem,axis,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,areas=[].concat(me.yField),areasLen=areas.length,xValues=[],yValues=[],infinity=1/0,minX=infinity,minY=infinity,maxX=-infinity,maxY=-infinity,math=Math,boundAxis=(math.min,math.max,me.getAxesForXAndYFields()),boundXAxis=boundAxis.xAxis,boundYAxis=boundAxis.yAxis;for(me.setBBox(),bbox=me.bbox,(axis=chart.axes.get(boundXAxis))&&("Time"===axis.type&&(allowDate=!0),ends=axis.applyData(),minX=ends.from,maxX=ends.to),(axis=chart.axes.get(boundYAxis))&&(ends=axis.applyData(),minY=ends.from,maxY=ends.to),me.xField&&!Ext.isNumber(minX)&&(axis=me.getMinMaxXValues(),allowDate=!0,minX=axis[0],maxX=axis[1]),me.yField&&!Ext.isNumber(minY)&&(axis=me.getMinMaxYValues(),minY=axis[0],maxY=axis[1]),Ext.isNumber(minY)||(minY=0),Ext.isNumber(maxY)||(maxY=0),l=data.length,l>0&&allowDate&&(tmp=data[0].get(me.xField),"number"!=typeof tmp&&(tmp=+tmp,isNaN(tmp)&&(allowDate=!1))),i=0;i<l;i++){for(record=data[i],xValue=record.get(me.xField),yValue=[],"number"!=typeof xValue&&(xValue=allowDate?+xValue:i),xValues.push(xValue),acumY=0,areaIndex=0;areaIndex<areasLen;areaIndex++)me.__excludes[areaIndex]||(areaElem=record.get(areas[areaIndex]),"number"==typeof areaElem&&yValue.push(areaElem));yValues.push(yValue)}return xScale=bbox.width/(maxX-minX||1),yScale=bbox.height/(maxY-minY||1),ln=xValues.length,ln>bbox.width&&me.areas&&(sumValues=me.shrink(xValues,yValues,bbox.width),xValues=sumValues.x,yValues=sumValues.y),{bbox:bbox,minX:minX,minY:minY,xValues:xValues,yValues:yValues,xScale:xScale,yScale:yScale,areasLen:areasLen}},getPaths:function(){var componentPath,i,ln,x,y,xValue,yValue,acumY,areaIndex,prevAreaIndex,areaElem,path,startX,idx,me=this,chart=me.chart,first=(chart.getChartStore(),!0),bounds=me.getBounds(),bbox=bounds.bbox,items=me.items=[],componentPaths=[],count=0,paths=[],reverse=me.reverse;for(ln=bounds.xValues.length,i=0;i<ln;i++)for(xValue=bounds.xValues[i],idx=reverse?ln-i-1:i,yValue=bounds.yValues[idx],x=bbox.x+(xValue-bounds.minX)*bounds.xScale,void 0===startX&&(startX=x),acumY=0,count=0,areaIndex=0;areaIndex<bounds.areasLen;areaIndex++)me.__excludes[areaIndex]||(componentPaths[areaIndex]||(componentPaths[areaIndex]=[]),areaElem=yValue[count],acumY+=areaElem,y=bbox.y+bbox.height-(acumY-bounds.minY)*bounds.yScale,paths[areaIndex]?(paths[areaIndex].push("L",x,y),componentPaths[areaIndex].push(["L",x,y])):(paths[areaIndex]=["M",x,y],componentPaths[areaIndex].push(["L",x,y])),items[areaIndex]||(items[areaIndex]={pointsUp:[],pointsDown:[],series:me}),items[areaIndex].pointsUp.push([x,y]),count++);for(areaIndex=0;areaIndex<bounds.areasLen;areaIndex++)if(!me.__excludes[areaIndex]){if(path=paths[areaIndex],0==areaIndex||first)first=!1,path.push("L",x,bbox.y+bbox.height,"L",startX,bbox.y+bbox.height,"Z");else{for(componentPath=componentPaths[prevAreaIndex],componentPath.reverse(),path.push("L",x,componentPath[0][2]),i=0;i<ln;i++)path.push(componentPath[i][0],componentPath[i][1],componentPath[i][2]),items[areaIndex].pointsDown[ln-i-1]=[componentPath[i][1],componentPath[i][2]];path.push("L",startX,path[2],"Z")}prevAreaIndex=areaIndex}return{paths:paths,areasLen:bounds.areasLen}},drawSeries:function(){var areaIndex,areaElem,paths,path,rendererAttributes,idx,me=this,chart=me.chart,store=chart.getChartStore(),surface=chart.surface,animate=chart.animate,group=me.group,endLineStyle=Ext.apply(me.seriesStyle,me.style),colorArrayStyle=me.colorArrayStyle,colorArrayLength=colorArrayStyle&&colorArrayStyle.length||0,themeIndex=me.themeIdx;if(me.unHighlightItem(),me.cleanHighlights(),!store||!store.getCount()||me.seriesIsHidden)return me.hide(),void(me.items=[]);for(paths=me.getPaths(),me.areas||(me.areas=[]),areaIndex=0;areaIndex<paths.areasLen;areaIndex++)me.__excludes[areaIndex]||(idx=themeIndex+areaIndex,me.areas[areaIndex]||(me.items[areaIndex].sprite=me.areas[areaIndex]=surface.add(Ext.apply({},{type:"path",group:group,path:paths.paths[areaIndex],stroke:endLineStyle.stroke||colorArrayStyle[idx%colorArrayLength],fill:colorArrayStyle[idx%colorArrayLength]},endLineStyle||{}))),areaElem=me.areas[areaIndex],path=paths.paths[areaIndex],animate?(rendererAttributes=me.renderer(areaElem,!1,{path:path,fill:colorArrayStyle[areaIndex%colorArrayLength],stroke:endLineStyle.stroke||colorArrayStyle[areaIndex%colorArrayLength]},areaIndex,store),me.animation=me.onAnimate(areaElem,{to:rendererAttributes})):(rendererAttributes=me.renderer(areaElem,!1,{path:path,hidden:!1,fill:colorArrayStyle[idx%colorArrayLength],stroke:endLineStyle.stroke||colorArrayStyle[idx%colorArrayLength]},areaIndex,store),me.areas[areaIndex].setAttributes(rendererAttributes,!0)));me.renderLabels(),me.renderCallouts()},onAnimate:function(sprite,attr){return sprite.show(),this.callParent(arguments)},onCreateLabel:function(storeItem,item,i,display){return null},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){var labelBox,width,height,me=this,chart=me.chart,resizing=chart.resizing,config=me.label,format=config.renderer,field=config.field,bbox=me.bbox,x=Number(item.point[i][0]),y=Number(item.point[i][1]);label.setAttributes({text:format(storeItem.get(field[index]),label,storeItem,item,i,display,animate,index),hidden:!0},!0),labelBox=label.getBBox(),width=labelBox.width/2,height=labelBox.height/2,x<bbox.x+width?x=bbox.x+width:x+width>bbox.x+bbox.width&&(x=bbox.x+bbox.width-width),y-=height,y<bbox.y+height?y+=2*height:y+height>bbox.y+bbox.height&&(y-=2*height),me.chart.animate&&!me.chart.resizing?(label.show(!0),me.onAnimate(label,{to:{x:x,y:y}})):(label.setAttributes({x:x,y:y},!0),resizing&&me.animation?me.animation.on("afteranimate",function(){label.show(!0)}):label.show(!0))},onPlaceCallout:function(callout,storeItem,item,i,display,animate,index){var dir,norm,normal,a,aprev,anext,boxx,boxy,boxw,boxh,p,x,y,me=this,chart=me.chart,items=(chart.surface,chart.resizing,me.callouts,me.items),prev=0!=i&&items[i-1].point,next=i!=items.length-1&&items[i+1].point,cur=item.point,bbox=callout&&callout.label?callout.label.getBBox():{width:0,height:0},offsetFromViz=30,offsetBox=3,clipRect=me.clipRect;if(bbox.width&&bbox.height){prev||(prev=cur),next||(next=cur),a=(next[1]-prev[1])/(next[0]-prev[0]),aprev=(cur[1]-prev[1])/(cur[0]-prev[0]),anext=(next[1]-cur[1])/(next[0]-cur[0]),norm=Math.sqrt(1+a*a),dir=[1/norm,a/norm],normal=[-dir[1],dir[0]],aprev>0&&anext<0&&normal[1]<0||aprev<0&&anext>0&&normal[1]>0?(normal[0]*=-1,normal[1]*=-1):(Math.abs(aprev)<Math.abs(anext)&&normal[0]<0||Math.abs(aprev)>Math.abs(anext)&&normal[0]>0)&&(normal[0]*=-1,normal[1]*=-1),x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,(boxx<clipRect[0]||boxx+boxw>clipRect[0]+clipRect[2])&&(normal[0]*=-1),(boxy<clipRect[1]||boxy+boxh>clipRect[1]+clipRect[3])&&(normal[1]*=-1),x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,callout.lines.setAttributes({path:["M",cur[0],cur[1],"L",x,y,"Z"]},!0),callout.box.setAttributes({x:boxx,y:boxy,width:boxw,height:boxh},!0),callout.label.setAttributes({x:x+(normal[0]>0?offsetBox:-(bbox.width+offsetBox)),y:y},!0);for(p in callout)callout[p].show(!0)}},isItemInPoint:function(x,y,item,i){var p,pln,point,me=this,pointsUp=item.pointsUp,pointsDown=item.pointsDown,abs=Math.abs,distChanged=!1,last=!1,reverse=me.reverse,dist=1/0;for(p=0,pln=pointsUp.length;p<pln;p++)if(point=[pointsUp[p][0],pointsUp[p][1]],distChanged=!1,last=p==pln-1,dist>abs(x-point[0])&&(dist=abs(x-point[0]),distChanged=!0,last&&++p),!distChanged||distChanged&&last){if(point=pointsUp[p-1],y>=point[1]&&(!pointsDown.length||y<=pointsDown[p-1][1]))return idx=reverse?pln-p:p-1,item.storeIndex=idx,item.storeField=me.yField[i],item.storeItem=me.chart.getChartStore().getAt(idx),item._points=pointsDown.length?[point,pointsDown[p-1]]:[point],!0;break}return!1},highlightSeries:function(){var area,to,fillColor;void 0!==this._index&&(area=this.areas[this._index],area.__highlightAnim&&(area.__highlightAnim.paused=!0),area.__highlighted=!0,area.__prevOpacity=area.__prevOpacity||area.attr.opacity||1,area.__prevFill=area.__prevFill||area.attr.fill,area.__prevLineWidth=area.__prevLineWidth||area.attr.lineWidth,fillColor=Ext.draw.Color.fromString(area.__prevFill),to={lineWidth:(area.__prevLineWidth||0)+2},fillColor?to.fill=fillColor.getLighter(.2).toString():to.opacity=Math.max(area.__prevOpacity-.3,0),this.chart.animate?area.__highlightAnim=new Ext.fx.Anim(Ext.apply({target:area,to:to},this.chart.animate)):area.setAttributes(to,!0))},unHighlightSeries:function(){var area;void 0!==this._index&&(area=this.areas[this._index],area.__highlightAnim&&(area.__highlightAnim.paused=!0),area.__highlighted&&(area.__highlighted=!1,area.__highlightAnim=new Ext.fx.Anim({target:area,to:{fill:area.__prevFill,opacity:area.__prevOpacity,lineWidth:area.__prevLineWidth}})))},highlightItem:function(item){var points,path,me=this;return item?(points=item._points,path=2===points.length?["M",points[0][0],points[0][1],"L",points[1][0],points[1][1]]:["M",points[0][0],points[0][1],"L",points[0][0],me.bbox.y+me.bbox.height],void me.highlightSprite.setAttributes({path:path,hidden:!1},!0)):void this.highlightSeries()},unHighlightItem:function(item){item||this.unHighlightSeries(),this.highlightSprite&&this.highlightSprite.hide(!0)},hideAll:function(index){var me=this;index=(isNaN(me._index)?index:me._index)||0,me.__excludes[index]=!0,me.areas[index].hide(!0),me.redraw()},showAll:function(index){var me=this;index=(isNaN(me._index)?index:me._index)||0,me.__excludes[index]=!1,me.areas[index].show(!0),me.redraw()},redraw:function(){var prevLegendConfig,me=this;prevLegendConfig=me.chart.legend.rebuild,me.chart.legend.rebuild=!1,me.chart.redraw(),me.chart.legend.rebuild=prevLegendConfig},hide:function(){if(this.areas){var i,ln,me=this,areas=me.areas;if(areas&&areas.length){for(i=0,ln=areas.length;i<ln;++i)areas[i]&&areas[i].hide(!0);me.hideLabels()}}},getLegendColor:function(index){var me=this;return index+=me.themeIdx,
me.colorArrayStyle[index%me.colorArrayStyle.length]}}),Ext.define("Ext.chart.series.Bar",{extend:Ext.chart.series.Cartesian,alternateClassName:["Ext.chart.BarSeries","Ext.chart.BarChart","Ext.chart.StackedBarChart"],type:"bar",alias:"series.bar",column:!1,style:{},gutter:38.2,groupGutter:38.2,xPadding:0,yPadding:10,defaultRotate:{x:0,y:0,degrees:0},constructor:function(config){this.callParent(arguments);var i,l,me=this,surface=me.chart.surface,shadow=me.chart.shadow;if(config.highlightCfg=Ext.Object.merge({lineWidth:3,stroke:"#55c",opacity:.8,color:"#f00"},config.highlightCfg),Ext.apply(me,config,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:1.2}},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:.9}},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:.6}}]}),me.group=surface.getGroup(me.seriesId+"-bars"),shadow)for(i=0,l=me.shadowAttributes.length;i<l;i++)me.shadowGroups.push(surface.getGroup(me.seriesId+"-shadows"+i))},getPadding:function(){var me=this,xPadding=me.xPadding,yPadding=me.yPadding,padding={};return Ext.isNumber(xPadding)?(padding.left=xPadding,padding.right=xPadding):Ext.isObject(xPadding)?(padding.left=xPadding.left,padding.right=xPadding.right):(padding.left=0,padding.right=0),padding.width=padding.left+padding.right,Ext.isNumber(yPadding)?(padding.bottom=yPadding,padding.top=yPadding):Ext.isObject(yPadding)?(padding.bottom=yPadding.bottom,padding.top=yPadding.top):(padding.bottom=0,padding.top=0),padding.height=padding.bottom+padding.top,padding},getBarGirth:function(){var padding,property,me=this,store=me.chart.getChartStore(),column=me.column,ln=store.getCount(),gutter=me.gutter/100;return property=column?"width":"height",me.style&&me.style[property]?(me.configuredColumnGirth=!0,+me.style[property]):(padding=me.getPadding(),(me.chart.chartBBox[property]-padding[property])/(ln*(gutter+1)-gutter))},getGutters:function(){var me=this,column=me.column,padding=me.getPadding(),halfBarGirth=me.getBarGirth()/2,lowerGutter=Math.ceil((column?padding.left:padding.bottom)+halfBarGirth),upperGutter=Math.ceil((column?padding.right:padding.top)+halfBarGirth);return{lower:lowerGutter,upper:upperGutter,verticalAxis:!column}},getBounds:function(){var i,ln,record,minX,maxX,colsScale,colsZero,gutters,ends,shrunkBarWidth,groupBarWidth,bbox,minY,maxY,axis,out,scale,zero,total,rec,j,plus,minus,inflections,tick,loc,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,bars=[].concat(me.yField),barsLoc=[],barsLen=bars.length,groupBarsLen=barsLen,groupGutter=me.groupGutter/100,column=me.column,padding=me.getPadding(),stacked=me.stacked,barWidth=me.getBarGirth(),barWidthProperty=column?"width":"height",math=Math,mmin=math.min,mmax=math.max,mabs=math.abs,boundAxes=me.getAxesForXAndYFields(),boundYAxis=boundAxes.yAxis;if(me.setBBox(!0),bbox=me.bbox,me.__excludes)for(j=0,total=me.__excludes.length;j<total;j++)me.__excludes[j]&&groupBarsLen--;if(axis=chart.axes.get(boundYAxis),axis&&(ends=axis.applyData(),minY=ends.from,maxY=ends.to),me.yField&&!Ext.isNumber(minY)&&(out=me.getMinMaxYValues(),minY=out[0],maxY=out[1]),Ext.isNumber(minY)||(minY=0),Ext.isNumber(maxY)||(maxY=0),scale=(column?bbox.height-padding.height:bbox.width-padding.width)/(maxY-minY),shrunkBarWidth=barWidth,groupBarWidth=barWidth/((stacked?1:groupBarsLen)*(groupGutter+1)-groupGutter),barWidthProperty in me.style&&(groupBarWidth=mmin(groupBarWidth,me.style[barWidthProperty]),shrunkBarWidth=groupBarWidth*((stacked?1:groupBarsLen)*(groupGutter+1)-groupGutter)),zero=column?bbox.y+bbox.height-padding.bottom:bbox.x+padding.left,stacked){for(total=[[],[]],i=0,ln=data.length;i<ln;i++)for(record=data[i],total[0][i]=total[0][i]||0,total[1][i]=total[1][i]||0,j=0;j<barsLen;j++)me.__excludes&&me.__excludes[j]||(rec=record.get(bars[j]),total[+(rec>0)][i]+=mabs(rec));total[+(maxY>0)].push(mabs(maxY)),total[+(minY>0)].push(mabs(minY)),minus=mmax.apply(math,total[0]),plus=mmax.apply(math,total[1]),scale=(column?bbox.height-padding.height:bbox.width-padding.width)/(plus+minus),zero+=minus*scale*(column?-1:1)}else minY/maxY<0&&(zero-=minY*scale*(column?-1:1));if(me.boundColumn)for(axis=chart.axes.get(boundAxes.xAxis),axis&&(ends=axis.applyData(),minX=ends.from,maxX=ends.to),me.xField&&!Ext.isNumber(minX)&&(out=me.getMinMaxYValues(),minX=out[0],maxX=out[1]),Ext.isNumber(minX)||(minX=0),Ext.isNumber(maxX)||(maxX=0),gutters=me.getGutters(),colsScale=(bbox.width-(gutters.lower+gutters.upper))/(maxX-minX||1),colsZero=bbox.x+gutters.lower,barsLoc=[],i=0,ln=data.length;i<ln;i++)record=data[i],rec=record.get(me.xField),barsLoc[i]=colsZero+(rec-minX)*colsScale-groupBarWidth/2;else if(me.configuredColumnGirth&&(axis=chart.axes.get(boundAxes.xAxis),axis&&(inflections=axis.inflections,axis.isCategoryAxis||inflections.length==data.length)))for(barsLoc=[],i=0,ln=data.length;i<ln;i++)tick=inflections[i],loc=column?tick[0]:tick[1],barsLoc[i]=loc-shrunkBarWidth/2;return{bars:bars,barsLoc:barsLoc,bbox:bbox,shrunkBarWidth:shrunkBarWidth,barsLen:barsLen,groupBarsLen:groupBarsLen,barWidth:barWidth,groupBarWidth:groupBarWidth,scale:scale,zero:zero,padding:padding,signed:minY/maxY<0,minY:minY,maxY:maxY}},getPaths:function(){var i,total,record,j,yValue,height,totalDim,totalNegDim,bottom,top,hasShadow,barAttr,attrs,counter,totalPositiveValues,totalNegativeValues,shadowIndex,shadow,sprite,offset,floorY,idx,xPos,yPos,width,usedWidth,barIdx,me=this,chart=me.chart,store=chart.getChartStore(),data=store.data.items,bounds=me.bounds=me.getBounds(),items=me.items=[],yFields=Ext.isArray(me.yField)?me.yField:[me.yField],gutter=me.gutter/100,groupGutter=me.groupGutter/100,animate=chart.animate,column=me.column,group=me.group,enableShadows=chart.shadow,shadowGroups=me.shadowGroups,shadowGroupsLn=(me.shadowAttributes,shadowGroups.length),bbox=bounds.bbox,barWidth=bounds.barWidth,shrunkBarWidth=bounds.shrunkBarWidth,padding=me.getPadding(),stacked=me.stacked,barsLen=bounds.barsLen,colors=me.colorArrayStyle,colorLength=colors&&colors.length||0,themeIndex=me.themeIdx,reverse=me.reverse,math=Math,mmax=math.max,mabs=(math.min,math.abs);for(i=0,total=data.length;i<total;i++){for(record=data[i],bottom=bounds.zero,top=bounds.zero,totalDim=0,totalNegDim=0,totalPositiveValues=totalNegativeValues=0,hasShadow=!1,usedWidth=0,j=0,counter=0;j<barsLen;j++)if(!me.__excludes||!me.__excludes[j]){if(yValue=record.get(bounds.bars[j]),yValue>=0?totalPositiveValues+=yValue:totalNegativeValues+=yValue,height=Math.round((yValue-mmax(bounds.minY,0))*bounds.scale),idx=themeIndex+(barsLen>1?j:0),barAttr={fill:colors[idx%colorLength]},column?(idx=reverse?total-i-1:i,barIdx=reverse?barsLen-counter-1:counter,xPos=me.boundColumn?bounds.barsLoc[idx]:me.configuredColumnGirth&&bounds.barsLoc.length?bounds.barsLoc[idx]+barIdx*bounds.groupBarWidth*(1+groupGutter)*!stacked:bbox.x+padding.left+.5*(barWidth-shrunkBarWidth)+idx*barWidth*(1+gutter)+barIdx*bounds.groupBarWidth*(1+groupGutter)*!stacked,Ext.apply(barAttr,{height:height,width:mmax(bounds.groupBarWidth,0),x:xPos,y:bottom-height})):(offset=total-1-i,width=height+(bottom==bounds.zero),xPos=bottom+(bottom!=bounds.zero),reverse&&(xPos=bounds.zero+bbox.width-width-(0===usedWidth?1:0),stacked&&(xPos-=usedWidth,usedWidth+=width)),yPos=me.configuredColumnGirth&&bounds.barsLoc.length?bounds.barsLoc[i]+counter*bounds.groupBarWidth*(1+groupGutter)*!stacked:bbox.y+padding.top+.5*(barWidth-shrunkBarWidth)+offset*barWidth*(1+gutter)+counter*bounds.groupBarWidth*(1+groupGutter)*!stacked+1,Ext.apply(barAttr,{height:mmax(bounds.groupBarWidth,0),width:width,x:xPos,y:yPos})),height<0&&(column?(barAttr.y=top,barAttr.height=mabs(height)):(barAttr.x=top+height,barAttr.width=mabs(height))),stacked&&(height<0?top+=height*(column?-1:1):bottom+=height*(column?-1:1),totalDim+=mabs(height),height<0&&(totalNegDim+=mabs(height))),barAttr.x=Math.floor(barAttr.x)+1,floorY=Math.floor(barAttr.y),Ext.isIE8m&&barAttr.y>floorY&&floorY--,barAttr.y=floorY,barAttr.width=Math.floor(barAttr.width),barAttr.height=Math.floor(barAttr.height),items.push({series:me,yField:yFields[j],storeItem:record,value:[record.get(me.xField),yValue],attr:barAttr,point:column?[barAttr.x+barAttr.width/2,yValue>=0?barAttr.y:barAttr.y+barAttr.height]:[yValue>=0?barAttr.x+barAttr.width:barAttr.x,barAttr.y+barAttr.height/2]}),animate&&chart.resizing){if(attrs=column?{x:barAttr.x,y:bounds.zero,width:barAttr.width,height:0}:{x:bounds.zero,y:barAttr.y,width:0,height:barAttr.height},enableShadows&&(stacked&&!hasShadow||!stacked))for(hasShadow=!0,shadowIndex=0;shadowIndex<shadowGroupsLn;shadowIndex++)shadow=shadowGroups[shadowIndex].getAt(stacked?i:i*barsLen+j),shadow&&shadow.setAttributes(attrs,!0);sprite=group.getAt(i*barsLen+j),sprite&&sprite.setAttributes(attrs,!0)}counter++}stacked&&items.length&&(items[i*counter].totalDim=totalDim,items[i*counter].totalNegDim=totalNegDim,items[i*counter].totalPositiveValues=totalPositiveValues,items[i*counter].totalNegativeValues=totalNegativeValues)}if(stacked&&0==counter)for(i=0,total=data.length;i<total;i++)for(shadowIndex=0;shadowIndex<shadowGroupsLn;shadowIndex++)shadow=shadowGroups[shadowIndex].getAt(i),shadow&&shadow.hide(!0)},renderShadows:function(i,barAttr,baseAttrs,bounds){var shadowIndex,shadowBarAttr,shadow,totalDim,totalNegDim,j,rendererAttributes,me=this,chart=me.chart,surface=chart.surface,animate=chart.animate,stacked=me.stacked,shadowGroups=me.shadowGroups,shadowAttributes=me.shadowAttributes,shadowGroupsLn=shadowGroups.length,store=chart.getChartStore(),column=me.column,items=me.items,shadows=[],reverse=me.reverse,zero=bounds.zero;if(stacked&&i%bounds.groupBarsLen===0||!stacked)for(j=i/bounds.groupBarsLen,shadowIndex=0;shadowIndex<shadowGroupsLn;shadowIndex++)shadowBarAttr=Ext.apply({},shadowAttributes[shadowIndex]),shadow=shadowGroups[shadowIndex].getAt(stacked?j:i),Ext.copyTo(shadowBarAttr,barAttr,"x,y,width,height"),shadow||(shadow=surface.add(Ext.apply({type:"rect",group:shadowGroups[shadowIndex]},Ext.apply({},baseAttrs,shadowBarAttr)))),stacked&&(totalDim=items[i].totalDim,totalNegDim=items[i].totalNegDim,column?(shadowBarAttr.y=zero+totalNegDim-totalDim-1,shadowBarAttr.height=totalDim):(reverse?shadowBarAttr.x=zero+bounds.bbox.width-totalDim:shadowBarAttr.x=zero-totalNegDim,shadowBarAttr.width=totalDim)),rendererAttributes=me.renderer(shadow,store.getAt(j),shadowBarAttr,i,store),rendererAttributes.hidden=!!barAttr.hidden,animate?me.onAnimate(shadow,{zero:bounds.zero+bounds.bbox.width,to:rendererAttributes}):shadow.setAttributes(rendererAttributes,!0),shadows.push(shadow);return shadows},drawSeries:function(){var items,ln,i,j,baseAttrs,sprite,rendererAttributes,shadowIndex,shadowGroup,bounds,endSeriesStyle,barAttr,attrs,anim,me=this,chart=me.chart,store=chart.getChartStore(),surface=chart.surface,animate=chart.animate,stacked=me.stacked,column=me.column,chartAxes=chart.axes,boundAxes=me.getAxesForXAndYFields(),boundXAxis=boundAxes.xAxis,enableShadows=(boundAxes.yAxis,chart.shadow),shadowGroups=me.shadowGroups,shadowGroupsLn=shadowGroups.length,group=me.group,seriesStyle=me.seriesStyle;if(!store||!store.getCount()||me.seriesIsHidden)return me.hide(),void(me.items=[]);for(endSeriesStyle=Ext.apply({},this.style,seriesStyle),delete endSeriesStyle.fill,delete endSeriesStyle.x,delete endSeriesStyle.y,delete endSeriesStyle.width,delete endSeriesStyle.height,me.unHighlightItem(),me.cleanHighlights(),me.boundColumn=boundXAxis&&Ext.Array.contains(me.axis,boundXAxis)&&chartAxes.get(boundXAxis)&&chartAxes.get(boundXAxis).isNumericAxis,me.getPaths(),bounds=me.bounds,items=me.items,baseAttrs=column?{y:bounds.zero,height:0}:{x:bounds.zero,width:0},ln=items.length,i=0;i<ln;i++){if(sprite=group.getAt(i),barAttr=items[i].attr,enableShadows&&(items[i].shadows=me.renderShadows(i,barAttr,baseAttrs,bounds)),sprite||(attrs=Ext.apply({},baseAttrs,barAttr),attrs=Ext.apply(attrs,endSeriesStyle||{}),sprite=surface.add(Ext.apply({},{type:"rect",group:group},attrs))),animate){if(rendererAttributes=me.renderer(sprite,store.getAt(i),barAttr,i,store),sprite._to=rendererAttributes,anim=me.onAnimate(sprite,{zero:bounds.zero+bounds.bbox.width,to:Ext.apply(rendererAttributes,endSeriesStyle)}),enableShadows&&stacked&&i%bounds.barsLen===0)for(j=i/bounds.barsLen,shadowIndex=0;shadowIndex<shadowGroupsLn;shadowIndex++)anim.on("afteranimate",function(){this.show(!0)},shadowGroups[shadowIndex].getAt(j))}else rendererAttributes=me.renderer(sprite,store.getAt(i),Ext.apply(barAttr,{hidden:!1}),i,store),sprite.setAttributes(Ext.apply(rendererAttributes,endSeriesStyle),!0);items[i].sprite=sprite}for(ln=group.getCount(),j=i;j<ln;j++)group.getAt(j).hide(!0);if(me.stacked&&(i=store.getCount()),enableShadows)for(shadowIndex=0;shadowIndex<shadowGroupsLn;shadowIndex++)for(shadowGroup=shadowGroups[shadowIndex],ln=shadowGroup.getCount(),j=i;j<ln;j++)shadowGroup.getAt(j).hide(!0);me.renderLabels()},onCreateLabel:function(storeItem,item,i,display){var me=this,surface=me.chart.surface,group=me.labelsGroup,config=me.label,endLabelStyle=Ext.apply({},config,me.seriesLabelStyle||{});return surface.add(Ext.apply({type:"text",group:group},endLabelStyle||{}))},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){var text,size,width,height,x,y,finalAttr,me=this,opt=me.bounds,groupBarWidth=opt.groupBarWidth,column=me.column,chart=me.chart,chartBBox=chart.chartBBox,resizing=chart.resizing,yValue=(item.value[0],item.value[1]),attr=item.attr,config=me.label,stacked=me.stacked,stackedDisplay=config.stackedDisplay,rotate="vertical"==config.orientation,field=[].concat(config.field),format=config.renderer,zero=opt.zero,insideStart="insideStart",insideEnd="insideEnd",outside="outside",over="over",under="under",labelMarginX=4,labelMarginY=2,reverse=(opt.signed,me.reverse);if(display==insideStart||display==insideEnd||display==outside){if(stacked&&display==outside)return void label.hide(!0);if(label.setAttributes({style:void 0}),text=Ext.isNumber(index)?format(storeItem.get(field[index]),label,storeItem,item,i,display,animate,index):"",label.setAttributes({text:text}),size=me.getLabelSize(text,label.attr.style),width=size.width,height=size.height,column){if(!width||!height||stacked&&attr.height<height)return void label.hide(!0);if(x=attr.x+(rotate?groupBarWidth/2:(groupBarWidth-width)/2),display==outside){var free=yValue>=0?attr.y-chartBBox.y:chartBBox.y+chartBBox.height-attr.y-attr.height;free<height+labelMarginY&&(display=insideEnd)}if(stacked||display==outside||height+labelMarginY>attr.height&&(display=outside),!y)if(y=attr.y,yValue>=0)switch(display){case insideStart:y+=attr.height+(rotate?-labelMarginY:-height/2);break;case insideEnd:y+=rotate?height+labelMarginX:height/2;break;case outside:y+=rotate?-labelMarginY:-height/2}else switch(display){case insideStart:y+=rotate?height+labelMarginY:height/2;break;case insideEnd:y+=rotate?attr.height-labelMarginY:attr.height-height/2;break;case outside:y+=rotate?attr.height+height+labelMarginY:attr.height+height/2}}else{if(!width||!height||stacked&&!attr.width)return void label.hide(!0);if(y=attr.y+(rotate?(groupBarWidth+height)/2:groupBarWidth/2),display==outside){var free=yValue>=0?chartBBox.x+chartBBox.width-attr.x-attr.width:attr.x-chartBBox.x;free<width+labelMarginX&&(display=insideEnd)}if(display!=outside&&!rotate&&width+2*labelMarginX>=attr.width)if(stacked){if(height>attr.width)return void label.hide(!0);x=attr.x+attr.width/2,rotate=!0}else display=outside;if(!x)if(x=attr.x,yValue>=0)switch(display){case insideStart:x+=reverse?attr.width+(rotate?-width/2:-width-labelMarginX):rotate?width/2:labelMarginX;break;case insideEnd:reverse?x-=rotate?-width/2:-width-labelMarginX:x+=attr.width+(rotate?-width/2:-width-labelMarginX);break;case outside:reverse?x-=width+(rotate?width/2:labelMarginX):x+=attr.width+(rotate?width/2:labelMarginX)}else switch(display){case insideStart:reverse?x-=rotate?-width/2:-width-labelMarginX:x+=attr.width+(rotate?-width/2:-width-labelMarginX);break;case insideEnd:x+=reverse?attr.width+(rotate?-width/2:-width-labelMarginX):rotate?width/2:labelMarginX;break;case outside:reverse?x-=width+(rotate?width/2:labelMarginX):x+=rotate?-width/2:-width-labelMarginX}}}else if((display==over||display==under)&&stacked&&stackedDisplay)switch(text=label.attr.text,label.setAttributes({style:Ext.applyIf(label.attr&&label.attr.style||{},{"font-weight":"bold","font-size":"14px"})}),size=me.getLabelSize(text,label.attr.style),width=size.width,height=size.height,display){case over:column?(x=attr.x+(rotate?groupBarWidth/2:(groupBarWidth-width)/2),y=zero-(item.totalDim-item.totalNegDim)-height/2-labelMarginY):(x=zero+(item.totalDim-item.totalNegDim)+labelMarginX,y=attr.y+(rotate?(groupBarWidth+height)/2:groupBarWidth/2));break;case under:column?(x=attr.x+(rotate?groupBarWidth/2:(groupBarWidth-width)/2),y=zero+item.totalNegDim+height/2):(x=zero-item.totalNegDim-width-labelMarginX,y=attr.y+(rotate?(groupBarWidth+height)/2:groupBarWidth/2))}return void 0==x||void 0==y?void label.hide(!0):(label.isOutside=display==outside,label.setAttributes({text:text}),finalAttr={x:x,y:y},finalAttr.rotate=rotate?{x:x,y:y,degrees:270}:me.defaultRotate,animate&&resizing&&(column?(x=attr.x+attr.width/2,y=zero):(x=zero,y=attr.y+attr.height/2),label.setAttributes({x:x,y:y},!0),rotate&&label.setAttributes({rotate:{x:x,y:y,degrees:270}},!0)),void(animate?me.onAnimate(label,{zero:item.point[0],to:finalAttr}):label.setAttributes(Ext.apply(finalAttr,{hidden:!1}),!0)))},getLabelSize:function(value,labelStyle){var bbox,w,h,tester=this.testerLabel,config=this.label,endLabelStyle=Ext.apply({},config,labelStyle,this.seriesLabelStyle||{}),rotated="vertical"===config.orientation;return tester||(tester=this.testerLabel=this.chart.surface.add(Ext.apply({type:"text",opacity:0},endLabelStyle))),tester.setAttributes({style:labelStyle,text:value},!0),bbox=tester.getBBox(),w=bbox.width,h=bbox.height,{width:rotated?h:w,height:rotated?w:h}},onAnimate:function(sprite,attr){var me=this,to=attr.to;return sprite.show(),me.reverse&&!me.column&&(attr.from={x:me.stacked||"text"==sprite.type?attr.zero:to.x+to.width,width:0},me.inHighlight&&delete attr.from.x),this.callParent(arguments)},isItemInPoint:function(x,y,item){var bbox=item.sprite.getBBox();return bbox.x<=x&&bbox.y<=y&&bbox.x+bbox.width>=x&&bbox.y+bbox.height>=y},hideAll:function(index){var axes=this.chart.axes,axesItems=axes.items,ln=axesItems.length,i=0;for(index=(isNaN(this._index)?index:this._index)||0,this.__excludes||(this.__excludes=[]),this.__excludes[index]=!0,this.drawSeries(),i;i<ln;i++)axesItems[i].drawAxis()},showAll:function(index){var axes=this.chart.axes,axesItems=axes.items,ln=axesItems.length,i=0;for(index=(isNaN(this._index)?index:this._index)||0,this.__excludes||(this.__excludes=[]),this.__excludes[index]=!1,this.drawSeries(),i;i<ln;i++)axesItems[i].drawAxis()},getLegendColor:function(index){var me=this,colors=me.colorArrayStyle,colorLength=colors&&colors.length;return me.style&&me.style.fill?me.style.fill:colors?colors[(me.themeIdx+index)%colorLength]:"#000"},highlightItem:function(item){this.callParent(arguments),this.inHighlight=!0,this.renderLabels(),delete this.inHighlight},unHighlightItem:function(){this.callParent(arguments),this.inHighlight=!0,this.renderLabels(),delete this.inHighlight},cleanHighlights:function(){this.callParent(arguments),this.inHighlight=!0,this.renderLabels(),delete this.inHighlight}}),Ext.define("Ext.chart.series.Column",{alternateClassName:["Ext.chart.ColumnSeries","Ext.chart.ColumnChart","Ext.chart.StackedColumnChart"],extend:Ext.chart.series.Bar,type:"column",alias:"series.column",column:!0,boundColumn:!1,xPadding:10,yPadding:0}),Ext.define("Ext.chart.series.Gauge",{extend:Ext.chart.series.Series,type:"gauge",alias:"series.gauge",rad:Math.PI/180,highlightDuration:150,angleField:!1,needle:!1,donut:!1,showInLegend:!1,style:{},constructor:function(config){this.callParent(arguments);var i,l,me=this,chart=me.chart,surface=chart.surface,shadow=(chart.store,chart.shadow);if(Ext.apply(me,config,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":1,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:2}},{"stroke-width":4,"stroke-opacity":1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:1.5}},{"stroke-width":2,"stroke-opacity":1,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:1}}]}),me.group=surface.getGroup(me.seriesId),shadow)for(i=0,l=me.shadowAttributes.length;i<l;i++)me.shadowGroups.push(surface.getGroup(me.seriesId+"-shadows"+i));surface.customAttributes.segment=function(opt){return me.getSegment(opt)}},initialize:function(){var me=this,store=me.chart.getChartStore(),data=store.data.items,label=me.label,ln=data.length;me.yField=[],label&&label.field&&ln>0&&me.yField.push(data[0].get(label.field))},getSegment:function(opt){var me=this,rad=me.rad,cos=Math.cos,sin=Math.sin,abs=Math.abs,x=me.centerX,y=me.centerY,x1=0,x2=0,x3=0,x4=0,y1=0,y2=0,y3=0,y4=0,delta=.01,startAngle=(opt.endRho-opt.startRho,opt.startAngle),endAngle=opt.endAngle,midAngle=(startAngle+endAngle)/2*rad,margin=opt.margin||0,flag=abs(endAngle-startAngle)>180,a1=Math.min(startAngle,endAngle)*rad,a2=Math.max(startAngle,endAngle)*rad,singleSlice=!1;return x+=margin*cos(midAngle),y+=margin*sin(midAngle),x1=x+opt.startRho*cos(a1),y1=y+opt.startRho*sin(a1),x2=x+opt.endRho*cos(a1),y2=y+opt.endRho*sin(a1),x3=x+opt.startRho*cos(a2),y3=y+opt.startRho*sin(a2),x4=x+opt.endRho*cos(a2),y4=y+opt.endRho*sin(a2),abs(x1-x3)<=delta&&abs(y1-y3)<=delta&&(singleSlice=!0),singleSlice?{path:[["M",x1,y1],["L",x2,y2],["A",opt.endRho,opt.endRho,0,+flag,1,x4,y4],["Z"]]}:{path:[["M",x1,y1],["L",x2,y2],["A",opt.endRho,opt.endRho,0,+flag,1,x4,y4],["L",x3,y3],["A",opt.startRho,opt.startRho,0,+flag,0,x1,y1],["Z"]]}},calcMiddle:function(item){var me=this,rad=me.rad,slice=item.slice,x=me.centerX,y=me.centerY,startAngle=slice.startAngle,endAngle=slice.endAngle,a1=(Math.max("rho"in slice?slice.rho:me.radius,me.label.minMargin),+me.donut,Math.min(startAngle,endAngle)*rad),a2=Math.max(startAngle,endAngle)*rad,midAngle=-(a1+(a2-a1)/2),xm=x+(item.endRho+item.startRho)/2*Math.cos(midAngle),ym=y-(item.endRho+item.startRho)/2*Math.sin(midAngle);item.middle={x:xm,y:ym}},drawSeries:function(){var rendererAttributes,centerX,centerY,slice,slices,sprite,value,item,ln,record,i,spriteOptions,bbox,splitAngle,sliceA,sliceB,me=this,chart=me.chart,store=chart.getChartStore(),group=me.group,animate=me.chart.animate,axis=me.chart.axes.get(0),minimum=axis&&axis.minimum||me.minimum||0,maximum=axis&&axis.maximum||me.maximum||0,field=me.angleField||me.field||me.xField,surface=chart.surface,chartBBox=chart.chartBBox,donut=(me.rad,+me.donut),items=[],seriesStyle=me.seriesStyle,colorArrayStyle=(me.seriesLabelStyle,me.colorArrayStyle),colorArrayLength=colorArrayStyle&&colorArrayStyle.length||0,cos=Math.cos,sin=Math.sin,defaultStart=-180,reverse=me.reverse;if(Ext.apply(seriesStyle,me.style||{}),me.setBBox(),bbox=me.bbox,me.colorSet&&(colorArrayStyle=me.colorSet,colorArrayLength=colorArrayStyle.length),!store||!store.getCount()||me.seriesIsHidden)return me.hide(),void(me.items=[]);for(centerX=me.centerX=chartBBox.x+chartBBox.width/2,centerY=me.centerY=chartBBox.y+chartBBox.height,me.radius=Math.min(centerX-chartBBox.x,centerY-chartBBox.y),me.slices=slices=[],me.items=items=[],me.value||(record=store.getAt(0),me.value=record.get(field)),value=reverse?maximum-me.value:me.value,me.needle?(sliceA={series:me,value:value,startAngle:defaultStart,endAngle:0,rho:me.radius},splitAngle=defaultStart*(1-(value-minimum)/(maximum-minimum)),slices.push(sliceA)):(splitAngle=defaultStart*(1-(value-minimum)/(maximum-minimum)),sliceA={series:me,value:value,startAngle:defaultStart,endAngle:splitAngle,rho:me.radius},sliceB={series:me,value:maximum-value,startAngle:splitAngle,endAngle:0,rho:me.radius},reverse?slices.push(sliceB,sliceA):slices.push(sliceA,sliceB)),i=0,ln=slices.length;i<ln;i++)slice=slices[i],sprite=group.getAt(i),rendererAttributes=Ext.apply({segment:{startAngle:slice.startAngle,endAngle:slice.endAngle,margin:0,rho:slice.rho,startRho:slice.rho*+donut/100,endRho:slice.rho}},Ext.apply(seriesStyle,colorArrayStyle&&{fill:colorArrayStyle[i%colorArrayLength]}||{})),item=Ext.apply({},rendererAttributes.segment,{slice:slice,series:me,storeItem:record,index:i}),items[i]=item,sprite||(spriteOptions=Ext.apply({type:"path",group:group},Ext.apply(seriesStyle,colorArrayStyle&&{fill:colorArrayStyle[i%colorArrayLength]}||{})),sprite=surface.add(Ext.apply(spriteOptions,rendererAttributes))),slice.sprite=slice.sprite||[],item.sprite=sprite,slice.sprite.push(sprite),animate?(rendererAttributes=me.renderer(sprite,record,rendererAttributes,i,store),sprite._to=rendererAttributes,me.onAnimate(sprite,{to:rendererAttributes})):(rendererAttributes=me.renderer(sprite,record,Ext.apply(rendererAttributes,{hidden:!1}),i,store),sprite.setAttributes(rendererAttributes,!0));me.needle&&(splitAngle=splitAngle*Math.PI/180,me.needleSprite?animate?me.onAnimate(me.needleSprite,{to:{path:["M",centerX+me.radius*+donut/100*cos(splitAngle),centerY+-Math.abs(me.radius*+donut/100*sin(splitAngle)),"L",centerX+me.radius*cos(splitAngle),centerY+-Math.abs(me.radius*sin(splitAngle))]}}):me.needleSprite.setAttributes({type:"path",path:["M",centerX+me.radius*+donut/100*cos(splitAngle),centerY+-Math.abs(me.radius*+donut/100*sin(splitAngle)),"L",centerX+me.radius*cos(splitAngle),centerY+-Math.abs(me.radius*sin(splitAngle))]}):me.needleSprite=me.chart.surface.add({type:"path",path:["M",centerX+me.radius*+donut/100*cos(splitAngle),centerY+-Math.abs(me.radius*+donut/100*sin(splitAngle)),"L",centerX+me.radius*cos(splitAngle),centerY+-Math.abs(me.radius*sin(splitAngle))],"stroke-width":4,stroke:"#222"}),me.needleSprite.setAttributes({hidden:!1},!0)),delete me.value},setValue:function(value){this.value=value,this.drawSeries()},onCreateLabel:function(storeItem,item,i,display){},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){},onPlaceCallout:function(){},onAnimate:function(sprite,attr){return sprite.show(),this.callParent(arguments)},isItemInPoint:function(x,y,item,i){var me=this,cx=me.centerX,cy=me.centerY,abs=Math.abs,dx=abs(x-cx),dy=abs(y-cy),startAngle=item.startAngle,endAngle=item.endAngle,rho=Math.sqrt(dx*dx+dy*dy),angle=Math.atan2(y-cy,x-cx)/me.rad;return 0===i&&angle>=startAngle&&angle<endAngle&&rho>=item.startRho&&rho<=item.endRho},getLegendColor:function(index){var colors=this.colorSet||this.colorArrayStyle;return colors[index%colors.length]}}),Ext.define("Ext.chart.series.Line",{extend:Ext.chart.series.Cartesian,alternateClassName:["Ext.chart.LineSeries","Ext.chart.LineChart"],type:"line",alias:"series.line",selectionTolerance:20,showMarkers:!0,markerConfig:{},style:{},smooth:!1,defaultSmoothness:3,fill:!1,constructor:function(config){this.callParent(arguments);var i,l,me=this,surface=me.chart.surface,shadow=me.chart.shadow;if(config.highlightCfg=Ext.Object.merge({"stroke-width":3},config.highlightCfg),Ext.apply(me,config,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}}]}),me.group=surface.getGroup(me.seriesId),me.showMarkers&&(me.markerGroup=surface.getGroup(me.seriesId+"-markers")),shadow)for(i=0,l=me.shadowAttributes.length;i<l;i++)me.shadowGroups.push(surface.getGroup(me.seriesId+"-shadows"+i))},shrink:function(xValues,yValues,size){for(var len=xValues.length,ratio=Math.floor(len/size),i=1,xSum=0,ySum=0,xRes=[+xValues[0]],yRes=[+yValues[0]];i<len;++i)xSum+=+xValues[i]||0,ySum+=+yValues[i]||0,i%ratio==0&&(xRes.push(xSum/ratio),yRes.push(ySum/ratio),xSum=0,ySum=0);return{x:xRes,y:yRes}},drawSeries:function(){var record,shadowBarAttr,shadows,shadow,shindex,fromPath,fill,fillPath,rendererAttributes,x,y,prevX,prevY,firstX,firstY,markerCount,i,j,ln,axis,ends,marker,markerAux,item,xValue,yValue,coords,xScale,yScale,minX,maxX,minY,maxY,line,animation,endMarkerStyle,endLineStyle,type,count,opacity,lineOpacity,fillOpacity,fillDefaultValue,me=this,chart=me.chart,chartAxes=chart.axes,store=chart.getChartStore(),data=store.data.items,storeCount=store.getCount(),surface=me.chart.surface,bbox={},group=me.group,showMarkers=me.showMarkers,markerGroup=me.markerGroup,enableShadows=chart.shadow,shadowGroups=me.shadowGroups,shadowAttributes=me.shadowAttributes,smooth=me.smooth,lnsh=shadowGroups.length,dummyPath=["M"],path=["M"],renderPath=["M"],smoothPath=["M"],markerIndex=chart.markerIndex,xValues=([].concat(me.axis),[]),yValues=[],onbreak=!1,reverse=me.reverse,storeIndices=[],markerStyle=Ext.apply({},me.markerStyle),seriesStyle=me.seriesStyle,colorArrayStyle=me.colorArrayStyle,colorArrayLength=colorArrayStyle&&colorArrayStyle.length||0,isNumber=Ext.isNumber,boundAxes=(me.seriesIdx,me.getAxesForXAndYFields()),boundXAxis=boundAxes.xAxis,boundYAxis=boundAxes.yAxis,xAxis=chartAxes&&chartAxes.get(boundXAxis),yAxis=chartAxes&&chartAxes.get(boundYAxis),xAxisType=boundXAxis?xAxis&&xAxis.type:"",yAxisType=boundYAxis?yAxis&&yAxis.type:"";if(me.fireEvent("beforedraw",me)!==!1){if(!storeCount||me.seriesIsHidden){if(me.hide(),me.items=[],me.line){if(me.line.hide(!0),me.line.shadows)for(shadows=me.line.shadows,j=0,lnsh=shadows.length;j<lnsh;j++)shadow=shadows[j],shadow.hide(!0);me.fillPath&&me.fillPath.hide(!0)}return me.line=null,void(me.fillPath=null)}if(endMarkerStyle=Ext.apply(markerStyle||{},me.markerConfig,{fill:me.seriesStyle.fill||colorArrayStyle[me.themeIdx%colorArrayStyle.length]}),type=endMarkerStyle.type,delete endMarkerStyle.type,endLineStyle=seriesStyle,endLineStyle["stroke-width"]||(endLineStyle["stroke-width"]=.5),opacity="opacity"in endLineStyle?endLineStyle.opacity:1,fillDefaultValue="opacity"in endLineStyle?endLineStyle.opacity:.3,lineOpacity="lineOpacity"in endLineStyle?endLineStyle.lineOpacity:opacity,fillOpacity="fillOpacity"in endLineStyle?endLineStyle.fillOpacity:fillDefaultValue,markerIndex&&markerGroup&&markerGroup.getCount())for(i=0;i<markerIndex;i++)marker=markerGroup.getAt(i),markerGroup.remove(marker),markerGroup.add(marker),markerAux=markerGroup.getAt(markerGroup.getCount()-2),marker.setAttributes({x:0,y:0,translate:{x:markerAux.attr.translation.x,y:markerAux.attr.translation.y}},!0);for(me.unHighlightItem(),me.cleanHighlights(),me.setBBox(),bbox=me.bbox,me.clipRect=[bbox.x,bbox.y,bbox.width,bbox.height],xAxis&&(ends=xAxis.applyData(),minX=ends.from,maxX=ends.to),yAxis&&(ends=yAxis.applyData(),minY=ends.from,maxY=ends.to),me.xField&&!Ext.isNumber(minX)&&(axis=me.getMinMaxXValues(),minX=axis[0],maxX=axis[1]),me.yField&&!Ext.isNumber(minY)&&(axis=me.getMinMaxYValues(),minY=axis[0],maxY=axis[1]),isNaN(minX)?(minX=0,xScale=bbox.width/(storeCount-1||1)):xScale=bbox.width/(maxX-minX||storeCount-1||1),isNaN(minY)?(minY=0,yScale=bbox.height/(storeCount-1||1)):yScale=bbox.height/(maxY-minY||storeCount-1||1),i=0,ln=data.length;i<ln;i++)record=data[i],xValue=record.get(me.xField),"Time"===xAxisType&&"string"==typeof xValue&&(xValue=Date.parse(xValue)),("string"==typeof xValue||"object"==typeof xValue&&!Ext.isDate(xValue)||"Category"===xAxisType)&&(xValue=i),yValue=record.get(me.yField),"Time"===yAxisType&&"string"==typeof yValue&&(yValue=Date.parse(yValue)),"undefined"==typeof yValue||"string"==typeof yValue&&!yValue||(("string"==typeof yValue||"object"==typeof yValue&&!Ext.isDate(yValue)||"Category"===yAxisType)&&(yValue=i),storeIndices.push(i),xValues.push(xValue),yValues.push(yValue));for(ln=xValues.length,ln>bbox.width&&(coords=me.shrink(xValues,yValues,bbox.width),xValues=coords.x,yValues=coords.y),me.items=[],count=0,ln=xValues.length,i=0;i<ln;i++)if(xValue=xValues[i],yValue=yValues[i],yValue!==!1){if(x=reverse?bbox.x+bbox.width-(xValue-minX)*xScale:bbox.x+(xValue-minX)*xScale,x=Ext.Number.toFixed(x,2),y=Ext.Number.toFixed(bbox.y+bbox.height-(yValue-minY)*yScale,2),onbreak&&(onbreak=!1,path.push("M")),path=path.concat([x,y]),
"undefined"==typeof firstY&&"undefined"!=typeof y&&(firstY=y,firstX=x),me.line&&!chart.resizing||(dummyPath=dummyPath.concat([x,bbox.y+bbox.height/2])),chart.animate&&chart.resizing&&me.line&&(me.line.setAttributes({path:dummyPath,opacity:lineOpacity},!0),me.fillPath&&me.fillPath.setAttributes({path:dummyPath,opacity:fillOpacity},!0),me.line.shadows))for(shadows=me.line.shadows,j=0,lnsh=shadows.length;j<lnsh;j++)shadow=shadows[j],shadow.setAttributes({path:dummyPath},!0);showMarkers&&(marker=markerGroup.getAt(count++),marker?(marker.setAttributes({value:'"'+xValue+", "+yValue+'"',x:0,y:0,hidden:!1},!0),marker._to={translate:{x:+x,y:+y}}):(marker=Ext.chart.Shape[type](surface,Ext.apply({group:[group,markerGroup],x:0,y:0,translate:{x:+(prevX||x),y:prevY||bbox.y+bbox.height/2},value:'"'+xValue+", "+yValue+'"',zIndex:4e3},endMarkerStyle)),marker._to={translate:{x:+x,y:+y}})),me.items.push({series:me,value:[xValue,yValue],point:[x,y],sprite:marker,storeItem:store.getAt(storeIndices[i])}),prevX=x,prevY=y}else 1==path.length&&(path=[]),onbreak=!0,me.items.push(!1);if(!(path.length<=1)){if(me.smooth&&(smoothPath=Ext.draw.Draw.smooth(path,isNumber(smooth)?smooth:me.defaultSmoothness)),renderPath=smooth?smoothPath:path,chart.markerIndex&&me.previousPath?(fromPath=me.previousPath,smooth||Ext.Array.erase(fromPath,1,2)):fromPath=path,!me.line&&(me.line=surface.add(Ext.apply({type:"path",group:group,path:dummyPath,stroke:endLineStyle.stroke||endLineStyle.fill},endLineStyle||{})),me.line.setAttributes({opacity:lineOpacity},!0),enableShadows&&me.line.setAttributes(Ext.apply({},me.shadowOptions),!0),me.line.setAttributes({fill:"none",zIndex:3e3}),!endLineStyle.stroke&&colorArrayLength&&me.line.setAttributes({stroke:colorArrayStyle[me.themeIdx%colorArrayLength]},!0),enableShadows))for(shadows=me.line.shadows=[],shindex=0;shindex<lnsh;shindex++)shadowBarAttr=shadowAttributes[shindex],shadowBarAttr=Ext.apply({},shadowBarAttr,{path:dummyPath}),shadow=surface.add(Ext.apply({},{type:"path",group:shadowGroups[shindex]},shadowBarAttr)),shadows.push(shadow);if(me.fill&&(fillPath=renderPath.concat([["L",x,bbox.y+bbox.height],["L",firstX,bbox.y+bbox.height],["L",firstX,firstY]]),me.fillPath||(me.fillPath=surface.add({group:group,type:"path",fill:endLineStyle.fill||colorArrayStyle[me.themeIdx%colorArrayLength],path:dummyPath}))),markerCount=showMarkers&&markerGroup.getCount(),chart.animate){if(fill=me.fill,line=me.line,rendererAttributes=me.renderer(line,!1,{path:renderPath},i,store),Ext.apply(rendererAttributes,endLineStyle||{},{stroke:endLineStyle.stroke||endLineStyle.fill}),delete rendererAttributes.fill,line.show(!0),chart.markerIndex&&me.previousPath?me.animation=animation=me.onAnimate(line,{to:rendererAttributes,from:{path:fromPath}}):me.animation=animation=me.onAnimate(line,{to:rendererAttributes}),enableShadows)for(shadows=line.shadows,j=0;j<lnsh;j++)shadows[j].show(!0),chart.markerIndex&&me.previousPath?me.onAnimate(shadows[j],{to:{path:renderPath},from:{path:fromPath}}):me.onAnimate(shadows[j],{to:{path:renderPath}});if(fill&&(me.fillPath.show(!0),me.onAnimate(me.fillPath,{to:Ext.apply({},{path:fillPath,fill:endLineStyle.fill||colorArrayStyle[me.themeIdx%colorArrayLength],"stroke-width":0,opacity:fillOpacity},endLineStyle||{})})),showMarkers){for(count=0,i=0;i<ln;i++)me.items[i]&&(item=markerGroup.getAt(count++),item&&(rendererAttributes=me.renderer(item,store.getAt(i),item._to,i,store),me.onAnimate(item,{to:Ext.applyIf(rendererAttributes,endMarkerStyle||{})}),item.show(!0)));for(;count<markerCount;count++)item=markerGroup.getAt(count),item.hide(!0)}}else{if(rendererAttributes=me.renderer(me.line,!1,{path:renderPath,hidden:!1},i,store),Ext.apply(rendererAttributes,endLineStyle||{},{stroke:endLineStyle.stroke||endLineStyle.fill}),delete rendererAttributes.fill,me.line.setAttributes(rendererAttributes,!0),me.line.setAttributes({opacity:lineOpacity},!0),enableShadows)for(shadows=me.line.shadows,j=0;j<lnsh;j++)shadows[j].setAttributes({path:renderPath,hidden:!1},!0);if(me.fill&&me.fillPath.setAttributes({path:fillPath,hidden:!1,opacity:fillOpacity},!0),showMarkers){for(count=0,i=0;i<ln;i++)me.items[i]&&(item=markerGroup.getAt(count++),item&&(rendererAttributes=me.renderer(item,store.getAt(i),item._to,i,store),item.setAttributes(Ext.apply(endMarkerStyle||{},rendererAttributes||{}),!0),item.attr.hidden||item.show(!0)));for(;count<markerCount;count++)item=markerGroup.getAt(count),item.hide(!0)}}chart.markerIndex&&(me.smooth?Ext.Array.erase(path,1,2):Ext.Array.splice(path,1,0,path[1],path[2]),me.previousPath=path),me.renderLabels(),me.renderCallouts(),me.fireEvent("draw",me)}}},onCreateLabel:function(storeItem,item,i,display){var me=this,group=me.labelsGroup,config=me.label,bbox=me.bbox,endLabelStyle=Ext.apply({},config,me.seriesLabelStyle||{});return me.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:group,x:Number(item.point[0]),y:bbox.y+bbox.height/2},endLabelStyle||{}))},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){var labelBox,markerBox,width,height,xOffset,yOffset,me=this,chart=me.chart,resizing=chart.resizing,config=me.label,format=config.renderer,field=config.field,bbox=me.bbox,x=Number(item.point[0]),y=Number(item.point[1]),radius=item.sprite.attr.radius;label.setAttributes({text:format(storeItem.get(field),label,storeItem,item,i,display,animate,index),hidden:!0},!0),markerBox=item.sprite.getBBox(),markerBox.width=markerBox.width||2*radius,markerBox.height=markerBox.height||2*radius,labelBox=label.getBBox(),width=labelBox.width/2,height=labelBox.height/2,"rotate"==display?(xOffset=markerBox.width/2+width+height/2,x+xOffset+width>bbox.x+bbox.width?x-=xOffset:x+=xOffset,label.setAttributes({rotation:{x:x,y:y,degrees:-45}},!0)):"under"!=display&&"over"!=display||(label.setAttributes({rotation:{degrees:0}},!0),x<bbox.x+width?x=bbox.x+width:x+width>bbox.x+bbox.width&&(x=bbox.x+bbox.width-width),yOffset=markerBox.height/2+height,y+="over"==display?-yOffset:yOffset,y<bbox.y+height?y+=2*yOffset:y+height>bbox.y+bbox.height&&(y-=2*yOffset)),me.chart.animate&&!me.chart.resizing?(label.show(!0),me.onAnimate(label,{to:{x:x,y:y}})):(label.setAttributes({x:x,y:y},!0),resizing&&me.animation?me.animation.on("afteranimate",function(){label.show(!0)}):label.show(!0))},highlightItem:function(){var me=this,line=me.line;me.callParent(arguments),line&&!me.highlighted&&("__strokeWidth"in line||(line.__strokeWidth=parseFloat(line.attr["stroke-width"])||0),line.__anim&&(line.__anim.paused=!0),line.__anim=new Ext.fx.Anim({target:line,to:{"stroke-width":line.__strokeWidth+3}}),me.highlighted=!0)},unHighlightItem:function(){var width,me=this,line=me.line;me.callParent(arguments),line&&me.highlighted&&(width=line.__strokeWidth||parseFloat(line.attr["stroke-width"])||0,line.__anim=new Ext.fx.Anim({target:line,to:{"stroke-width":width}}),me.highlighted=!1)},onPlaceCallout:function(callout,storeItem,item,i,display,animate,index){if(display){var dir,norm,normal,a,aprev,anext,boxx,boxy,boxw,boxh,p,x,y,me=this,chart=me.chart,config=(chart.surface,chart.resizing,me.callouts),items=me.items,prev=0!=i&&items[i-1].point,next=i!=items.length-1&&items[i+1].point,cur=[+item.point[0],+item.point[1]],offsetFromViz=config.offsetFromViz||30,offsetBox=(config.offsetToSide||10,config.offsetBox||3),clipRect=me.clipRect,bbox={width:config.styles.width||10,height:config.styles.height||10};prev||(prev=cur),next||(next=cur),a=(next[1]-prev[1])/(next[0]-prev[0]),aprev=(cur[1]-prev[1])/(cur[0]-prev[0]),anext=(next[1]-cur[1])/(next[0]-cur[0]),norm=Math.sqrt(1+a*a),dir=[1/norm,a/norm],normal=[-dir[1],dir[0]],aprev>0&&anext<0&&normal[1]<0||aprev<0&&anext>0&&normal[1]>0?(normal[0]*=-1,normal[1]*=-1):(Math.abs(aprev)<Math.abs(anext)&&normal[0]<0||Math.abs(aprev)>Math.abs(anext)&&normal[0]>0)&&(normal[0]*=-1,normal[1]*=-1),x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,(boxx<clipRect[0]||boxx+boxw>clipRect[0]+clipRect[2])&&(normal[0]*=-1),(boxy<clipRect[1]||boxy+boxh>clipRect[1]+clipRect[3])&&(normal[1]*=-1),x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,chart.animate?(me.onAnimate(callout.lines,{to:{path:["M",cur[0],cur[1],"L",x,y,"Z"]}}),callout.panel&&callout.panel.setPosition(boxx,boxy,!0)):(callout.lines.setAttributes({path:["M",cur[0],cur[1],"L",x,y,"Z"]},!0),callout.panel&&callout.panel.setPosition(boxx,boxy));for(p in callout)callout[p].show(!0)}},isItemInPoint:function(x,y,item,i){var prevItem,nextItem,prevPoint,nextPoint,ln,x1,y1,x2,y2,dist1,dist2,dist,me=this,items=me.items,tolerance=me.selectionTolerance,sqrt=Math.sqrt;Math.abs;return nextItem=items[i],prevItem=i&&items[i-1],i>=ln&&(prevItem=items[ln-1]),prevPoint=prevItem&&prevItem.point,nextPoint=nextItem&&nextItem.point,x1=prevItem?prevPoint[0]:nextPoint[0]-tolerance,y1=prevItem?prevPoint[1]:nextPoint[1],x2=nextItem?nextPoint[0]:prevPoint[0]+tolerance,y2=nextItem?nextPoint[1]:prevPoint[1],dist1=sqrt((x-x1)*(x-x1)+(y-y1)*(y-y1)),dist2=sqrt((x-x2)*(x-x2)+(y-y2)*(y-y2)),dist=Math.min(dist1,dist2),dist<=tolerance&&(dist==dist1?prevItem:nextItem)},toggleAll:function(show){var i,ln,shadow,shadows,me=this;if(show?Ext.chart.series.Cartesian.prototype.showAll.call(me):Ext.chart.series.Cartesian.prototype.hideAll.call(me),me.line&&(me.line.setAttributes({hidden:!show},!0),me.line.shadows))for(i=0,shadows=me.line.shadows,ln=shadows.length;i<ln;i++)shadow=shadows[i],shadow.setAttributes({hidden:!show},!0);me.fillPath&&me.fillPath.setAttributes({hidden:!show},!0)},hideAll:function(){this.toggleAll(!1)},showAll:function(){this.toggleAll(!0)}}),Ext.define("Ext.chart.series.Pie",{alternateClassName:["Ext.chart.PieSeries","Ext.chart.PieChart"],extend:Ext.chart.series.Series,type:"pie",alias:"series.pie",accuracy:1e5,rad:2*Math.PI/1e5,highlightDuration:150,angleField:!1,lengthField:!1,donut:!1,showInLegend:!1,style:{},constructor:function(config){this.callParent(arguments);var i,l,me=this,chart=me.chart,surface=chart.surface,shadow=(chart.store,chart.shadow);if(config.highlightCfg=Ext.merge({segment:{margin:20}},config.highlight),Ext.apply(me,config,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":1,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:2}},{"stroke-width":4,"stroke-opacity":1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:1.5}},{"stroke-width":2,"stroke-opacity":1,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:1}}]}),me.group=surface.getGroup(me.seriesId),shadow)for(i=0,l=me.shadowAttributes.length;i<l;i++)me.shadowGroups.push(surface.getGroup(me.seriesId+"-shadows"+i));surface.customAttributes.segment=function(opt){var ans=me.getSegment(opt);return ans.path&&0!==ans.path.length||(ans.path=["M",0,0]),ans},me.__excludes=me.__excludes||[]},onRedraw:function(){this.initialize()},initialize:function(){var i,ln,rec,me=this,store=me.chart.getChartStore(),data=store.data.items;if(me.callParent(),me.yField=[],me.label.field)for(i=0,ln=data.length;i<ln;i++)rec=data[i],me.yField.push(rec.get(me.label.field))},getSegment:function(opt){var me=this,rad=me.rad,cos=Math.cos,sin=Math.sin,x=me.centerX,y=me.centerY,x1=0,x2=0,x3=0,x4=0,y1=0,y2=0,y3=0,y4=0,x5=0,y5=0,x6=0,y6=0,delta=.01,startAngle=opt.startAngle,endAngle=opt.endAngle,midAngle=(startAngle+endAngle)/2*rad,margin=opt.margin||0,a1=Math.min(startAngle,endAngle)*rad,a2=Math.max(startAngle,endAngle)*rad,c1=cos(a1),s1=sin(a1),c2=cos(a2),s2=sin(a2),cm=cos(midAngle),sm=sin(midAngle),flag=0;return a2-a1<delta?{path:""}:(0!==margin&&(x+=margin*cm,y+=margin*sm),x2=x+opt.endRho*c1,y2=y+opt.endRho*s1,x4=x+opt.endRho*c2,y4=y+opt.endRho*s2,x6=x+opt.endRho*cm,y6=y+opt.endRho*sm,0!==opt.startRho?(x1=x+opt.startRho*c1,y1=y+opt.startRho*s1,x3=x+opt.startRho*c2,y3=y+opt.startRho*s2,x5=x+opt.startRho*cm,y5=y+opt.startRho*sm,{path:[["M",x2,y2],["A",opt.endRho,opt.endRho,0,0,1,x6,y6],["L",x6,y6],["A",opt.endRho,opt.endRho,0,flag,1,x4,y4],["L",x4,y4],["L",x3,y3],["A",opt.startRho,opt.startRho,0,flag,0,x5,y5],["L",x5,y5],["A",opt.startRho,opt.startRho,0,0,0,x1,y1],["L",x1,y1],["Z"]]}):{path:[["M",x,y],["L",x2,y2],["A",opt.endRho,opt.endRho,0,0,1,x6,y6],["L",x6,y6],["A",opt.endRho,opt.endRho,0,flag,1,x4,y4],["L",x4,y4],["L",x,y],["Z"]]})},calcMiddle:function(item){var me=this,rad=me.rad,slice=item.slice,x=me.centerX,y=me.centerY,startAngle=slice.startAngle,endAngle=slice.endAngle,midAngle=(+me.donut,-(startAngle+endAngle)*rad/2),r=(item.endRho+item.startRho)/2,xm=x+r*Math.cos(midAngle),ym=y-r*Math.sin(midAngle);item.middle={x:xm,y:ym}},drawSeries:function(){var record,rendererAttributes,shadowAttr,shadows,shadow,shindex,centerX,centerY,deltaRho,slice,slices,sprite,value,item,lenValue,ln,i,j,endAngle,spriteOptions,bbox,me=this,store=me.chart.getChartStore(),data=store.data.items,group=me.group,animate=me.chart.animate,field=me.angleField||me.field||me.xField,lenField=[].concat(me.lengthField),totalLenField=0,chart=me.chart,surface=chart.surface,chartBBox=chart.chartBBox,enableShadows=chart.shadow,shadowGroups=me.shadowGroups,shadowAttributes=me.shadowAttributes,lnsh=shadowGroups.length,layers=lenField.length,rhoAcum=0,donut=+me.donut,layerTotals=[],items=[],totalField=0,maxLenField=0,angle=0,seriesStyle=me.seriesStyle,colorArrayStyle=me.colorArrayStyle,colorArrayLength=colorArrayStyle&&colorArrayStyle.length||0,first=0;if(Ext.apply(seriesStyle,me.style||{}),me.setBBox(),bbox=me.bbox,me.colorSet&&(colorArrayStyle=me.colorSet,colorArrayLength=colorArrayStyle.length),!store||!store.getCount()||me.seriesIsHidden)return me.hide(),void(me.items=[]);for(me.unHighlightItem(),me.cleanHighlights(),centerX=me.centerX=chartBBox.x+chartBBox.width/2,centerY=me.centerY=chartBBox.y+chartBBox.height/2,me.radius=Math.min(centerX-chartBBox.x,centerY-chartBBox.y),me.slices=slices=[],me.items=items=[],i=0,ln=data.length;i<ln;i++)if(record=data[i],(!this.__excludes||!this.__excludes[i])&&(totalField+=+record.get(field),lenField[0])){for(j=0,totalLenField=0;j<layers;j++)totalLenField+=+record.get(lenField[j]);layerTotals[i]=totalLenField,maxLenField=Math.max(maxLenField,totalLenField)}for(totalField=totalField||1,i=0,ln=data.length;i<ln;i++){if(record=data[i],this.__excludes&&this.__excludes[i]?value=0:(value=record.get(field),0===first&&(first=1)),1==first)for(first=2,me.firstAngle=angle=me.accuracy*value/totalField/2,j=0;j<i;j++)slices[j].startAngle=slices[j].endAngle=me.firstAngle;endAngle=angle-me.accuracy*value/totalField,slice={series:me,value:value,startAngle:angle,endAngle:endAngle,storeItem:record},lenField[0]?(lenValue=+layerTotals[i],slice.rho=Math.floor(me.radius/maxLenField*lenValue)):slice.rho=me.radius,slices[i]=slice,function(){angle=endAngle}()}if(enableShadows)for(i=0,ln=slices.length;i<ln;i++)for(slice=slices[i],slice.shadowAttrs=[],j=0,rhoAcum=0,shadows=[];j<layers;j++){for(sprite=group.getAt(i*layers+j),deltaRho=lenField[j]?store.getAt(i).get(lenField[j])/layerTotals[i]*slice.rho:slice.rho,rendererAttributes={segment:{startAngle:slice.startAngle,endAngle:slice.endAngle,margin:0,rho:slice.rho,startRho:rhoAcum+deltaRho*donut/100,endRho:rhoAcum+deltaRho},hidden:!slice.value&&slice.startAngle%me.accuracy==slice.endAngle%me.accuracy},shindex=0,shadows=[];shindex<lnsh;shindex++)shadowAttr=shadowAttributes[shindex],shadow=shadowGroups[shindex].getAt(i),shadow||(shadow=chart.surface.add(Ext.apply({},{type:"path",group:shadowGroups[shindex],strokeLinejoin:"round"},rendererAttributes,shadowAttr))),shadowAttr=me.renderer(shadow,store.getAt(i),Ext.apply({},rendererAttributes,shadowAttr),i,store),animate?me.onAnimate(shadow,{to:shadowAttr}):shadow.setAttributes(shadowAttr,!0),shadows.push(shadow);slice.shadowAttrs[j]=shadows}for(i=0,ln=slices.length;i<ln;i++)for(slice=slices[i],j=0,rhoAcum=0;j<layers;j++)sprite=group.getAt(i*layers+j),deltaRho=lenField[j]?store.getAt(i).get(lenField[j])/layerTotals[i]*slice.rho:slice.rho,rendererAttributes=Ext.apply({segment:{startAngle:slice.startAngle,endAngle:slice.endAngle,margin:0,rho:slice.rho,startRho:rhoAcum+deltaRho*donut/100,endRho:rhoAcum+deltaRho},hidden:!slice.value&&slice.startAngle%me.accuracy==slice.endAngle%me.accuracy},Ext.apply(seriesStyle,colorArrayStyle&&{fill:colorArrayStyle[(layers>1?j:i)%colorArrayLength]}||{})),item=Ext.apply({},rendererAttributes.segment,{slice:slice,series:me,storeItem:slice.storeItem,index:i}),me.calcMiddle(item),enableShadows&&(item.shadows=slice.shadowAttrs[j]),items[i]=item,sprite||(spriteOptions=Ext.apply({type:"path",group:group,middle:item.middle},Ext.apply(seriesStyle,colorArrayStyle&&{fill:colorArrayStyle[(layers>1?j:i)%colorArrayLength]}||{})),sprite=surface.add(Ext.apply(spriteOptions,rendererAttributes))),slice.sprite=slice.sprite||[],item.sprite=sprite,slice.sprite.push(sprite),slice.point=[item.middle.x,item.middle.y],animate?(rendererAttributes=me.renderer(sprite,store.getAt(i),rendererAttributes,i,store),sprite._to=rendererAttributes,sprite._animating=!0,me.onAnimate(sprite,{to:rendererAttributes,listeners:{afteranimate:{fn:function(){this._animating=!1},scope:sprite}}})):(rendererAttributes=me.renderer(sprite,store.getAt(i),Ext.apply(rendererAttributes,{hidden:!1}),i,store),sprite.setAttributes(rendererAttributes,!0)),rhoAcum+=deltaRho;for(ln=group.getCount(),i=0;i<ln;i++)!slices[i/layers>>0]&&group.getAt(i)&&group.getAt(i).hide(!0);if(enableShadows)for(lnsh=shadowGroups.length,shindex=0;shindex<ln;shindex++)if(!slices[shindex/layers>>0])for(j=0;j<lnsh;j++)shadowGroups[j].getAt(shindex)&&shadowGroups[j].getAt(shindex).hide(!0);me.renderLabels(),me.renderCallouts()},setSpriteAttributes:function(sprite,attrs,animate){var me=this;animate?(sprite.stopAnimation(),sprite.animate({to:attrs,duration:me.highlightDuration})):sprite.setAttributes(attrs,!0)},createLabelLine:function(i){var me=this;return calloutLine=me.label.calloutLine,line=me.chart.surface.add({type:"path",stroke:void 0===i?"#555":calloutLine&&calloutLine.color||me.getLegendColor(i),lineWidth:calloutLine&&calloutLine.width||2,path:"M0,0Z"}),line},drawLabelLine:function(label,from,to,animate){var me=this,line=label.lineSprite,path="M"+from.x+" "+from.y+"L"+to.x+" "+to.y+"Z";me.setSpriteAttributes(line,{path:path},animate)},onCreateLabel:function(storeItem,item,i,display){var me=this,group=me.labelsGroup,config=me.label,middle=(me.centerX,me.centerY,item.middle),endLabelStyle=Ext.apply(me.seriesLabelStyle||{},config||{});return me.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:group,x:middle.x,y:middle.y},endLabelStyle))},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){function sign(x){return x?x<0?-1:1:0}var prevDg,labelBox,width,height,me=this,chart=me.chart,resizing=chart.resizing,config=me.label,format=config.renderer,field=config.field,centerX=me.centerX,centerY=me.centerY,middle=item.middle,opt={x:middle.x,y:middle.y},x=middle.x-centerX,y=middle.y-centerY,from={},rho=1,theta=Math.atan2(y,x||1),dg=Ext.draw.Draw.degrees(theta),isOutside="outside"===display,calloutLine=label.attr.calloutLine,lineWidth=calloutLine&&calloutLine.width||2,labelPadding=(label.attr.padding||20)+(isOutside?lineWidth/2+4:0),labelPaddingX=0,labelPaddingY=0;if(opt.hidden=!1,this.__excludes&&this.__excludes[i]&&(opt.hidden=!0),label.setAttributes({opacity:opt.hidden?0:1,text:format(storeItem.get(field),label,storeItem,item,i,display,animate,index)},!0),label.lineSprite){var attrs={opacity:opt.hidden?0:1};opt.hidden&&(attrs.translate={x:0,y:0}),me.setSpriteAttributes(label.lineSprite,attrs,!1)}switch(display){case"outside":label.isOutside=!0,rho=item.endRho,labelPaddingX=Math.abs(dg)<=90?labelPadding:-labelPadding,labelPaddingY=dg>=0?labelPadding:-labelPadding,label.setAttributes({rotation:{degrees:0}},!0),labelBox=label.getBBox(),width=labelBox.width/2*Math.cos(theta),height=labelBox.height/2*Math.sin(theta),width+=labelPaddingX,height+=labelPaddingY,rho+=Math.sqrt(width*width+height*height),opt.x=rho*Math.cos(theta)+centerX,opt.y=rho*Math.sin(theta)+centerY;break;case"rotate":dg=Ext.draw.Draw.normalizeDegrees(dg),dg=dg>90&&dg<270?dg+180:dg,prevDg=label.attr.rotation.degrees,null!=prevDg&&Math.abs(prevDg-dg)>90?(dg>prevDg?dg-=360:dg+=360,dg%=360):dg=Ext.draw.Draw.normalizeDegrees(dg),opt.rotate={degrees:dg,x:opt.x,y:opt.y}}if(opt.translate={x:0,y:0},!animate||resizing||"rotate"==display&&null==prevDg?label.setAttributes(opt,!0):me.onAnimate(label,{to:opt}),label._from=from,label.isOutside&&calloutLine){var line=label.lineSprite,animateLine=animate,fromPoint={x:(item.endRho-lineWidth/2)*Math.cos(theta)+centerX,y:(item.endRho-lineWidth/2)*Math.sin(theta)+centerY},labelCenter={x:opt.x,y:opt.y},toPoint={};if(calloutLine&&calloutLine.length)toPoint={x:(item.endRho+calloutLine.length)*Math.cos(theta)+centerX,y:(item.endRho+calloutLine.length)*Math.sin(theta)+centerY};else{var normalTheta=Ext.draw.Draw.normalizeRadians(-theta),cos=Math.cos(normalTheta),sin=Math.sin(normalTheta),labelWidth=(labelBox.width+lineWidth+4)/2,labelHeight=(labelBox.height+lineWidth+4)/2;Math.abs(cos)*labelHeight>Math.abs(sin)*labelWidth?(toPoint.x=labelCenter.x-labelWidth*sign(cos),toPoint.y=labelCenter.y+labelWidth*sin/cos*sign(cos)):(toPoint.x=labelCenter.x-labelHeight*cos/sin*sign(sin),toPoint.y=labelCenter.y+labelHeight*sign(sin))}line||(line=label.lineSprite=me.createLabelLine(i),animateLine=!1),me.drawLabelLine(label,fromPoint,toPoint,animateLine)}else delete label.lineSprite},onPlaceCallout:function(callout,storeItem,item,i,display,animate,index){var rhoCenter,p,me=this,chart=me.chart,centerX=me.centerX,centerY=me.centerY,middle=item.middle,opt={x:middle.x,y:middle.y},x=middle.x-centerX,y=middle.y-centerY,rho=1,theta=Math.atan2(y,x||1),bbox=callout&&callout.label?callout.label.getBBox():{width:0,height:0},offsetFromViz=20,offsetToSide=10,offsetBox=10;if(bbox.width&&bbox.height){rho=item.endRho+offsetFromViz,rhoCenter=(item.endRho+item.startRho)/2+(item.endRho-item.startRho)/3,opt.x=rho*Math.cos(theta)+centerX,opt.y=rho*Math.sin(theta)+centerY,x=rhoCenter*Math.cos(theta),y=rhoCenter*Math.sin(theta),chart.animate?(me.onAnimate(callout.lines,{to:{path:["M",x+centerX,y+centerY,"L",opt.x,opt.y,"Z","M",opt.x,opt.y,"l",x>0?offsetToSide:-offsetToSide,0,"z"]}}),me.onAnimate(callout.box,{to:{x:opt.x+(x>0?offsetToSide:-(offsetToSide+bbox.width+2*offsetBox)),y:opt.y+(y>0?-bbox.height-offsetBox/2:-bbox.height-offsetBox/2),width:bbox.width+2*offsetBox,height:bbox.height+2*offsetBox}}),me.onAnimate(callout.label,{to:{x:opt.x+(x>0?offsetToSide+offsetBox:-(offsetToSide+bbox.width+offsetBox)),y:opt.y+(y>0?-bbox.height/4:-bbox.height/4)}})):(callout.lines.setAttributes({path:["M",x+centerX,y+centerY,"L",opt.x,opt.y,"Z","M",opt.x,opt.y,"l",x>0?offsetToSide:-offsetToSide,0,"z"]},!0),callout.box.setAttributes({x:opt.x+(x>0?offsetToSide:-(offsetToSide+bbox.width+2*offsetBox)),y:opt.y+(y>0?-bbox.height-offsetBox/2:-bbox.height-offsetBox/2),width:bbox.width+2*offsetBox,height:bbox.height+2*offsetBox},!0),callout.label.setAttributes({x:opt.x+(x>0?offsetToSide+offsetBox:-(offsetToSide+bbox.width+offsetBox)),y:opt.y+(y>0?-bbox.height/4:-bbox.height/4)},!0));for(p in callout)callout[p].show(!0)}},onAnimate:function(sprite,attr){return sprite.show(),this.callParent(arguments)},isItemInPoint:function(x,y,item,i){var me=this,cx=me.centerX,cy=me.centerY,abs=Math.abs,dx=abs(x-cx),dy=abs(y-cy),startAngle=item.startAngle,endAngle=item.endAngle,rho=Math.sqrt(dx*dx+dy*dy),angle=Math.atan2(y-cy,x-cx)/me.rad;return angle>me.firstAngle&&(angle-=me.accuracy),angle<=startAngle&&angle>endAngle&&rho>=item.startRho&&rho<=item.endRho},hideAll:function(index){var i,l,shadow,shadows,sh,lsh,sprite;for(index=(isNaN(this._index)?index:this._index)||0,this.__excludes=this.__excludes||[],this.__excludes[index]=!0,sprite=this.slices[index].sprite,sh=0,lsh=sprite.length;sh<lsh;sh++){sprite[sh].setAttributes({hidden:!0},!0);var line=sprite[sh].lineSprite;line&&line.setAttributes({hidden:!0},!0)}if(this.slices[index].shadowAttrs)for(i=0,shadows=this.slices[index].shadowAttrs,l=shadows.length;i<l;i++)for(shadow=shadows[i],sh=0,lsh=shadow.length;sh<lsh;sh++)shadow[sh].setAttributes({hidden:!0},!0);this.drawSeries()},showAll:function(index){index=(isNaN(this._index)?index:this._index)||0,this.__excludes[index]=!1,this.drawSeries()},highlightItem:function(item){var highlightSegment,animate,attrs,i,shadows,shadow,ln,to,itemHighlightSegment,prop,group,display,label,middle,r,x,y,line,me=this,rad=me.rad;if(item=item||this.items[this._index],this.unHighlightItem(),!(!item||me.animating||item.sprite&&item.sprite._animating)&&(me.callParent([item]),me.highlight&&"segment"in me.highlightCfg&&(highlightSegment=me.highlightCfg.segment,animate=me.chart.animate,me.labelsGroup&&(group=me.labelsGroup,display=me.label.display,label=group.getAt(item.index),middle=(item.startAngle+item.endAngle)/2*rad,r=highlightSegment.margin||0,x=r*Math.cos(middle),y=r*Math.sin(middle),Math.abs(x)<1e-10&&(x=0),Math.abs(y)<1e-10&&(y=0),me.setSpriteAttributes(label,{translate:{x:x,y:y}},animate),line=label.lineSprite,line&&me.setSpriteAttributes(line,{translate:{x:x,y:y}},animate)),me.chart.shadow&&item.shadows)))for(i=0,shadows=item.shadows,ln=shadows.length;i<ln;i++){shadow=shadows[i],to={},itemHighlightSegment=item.sprite._from.segment;for(prop in itemHighlightSegment)prop in highlightSegment||(to[prop]=itemHighlightSegment[prop]);attrs={segment:Ext.applyIf(to,me.highlightCfg.segment)},me.setSpriteAttributes(shadow,attrs,animate)}},unHighlightItem:function(){var items,animate,shadowsEnabled,group,len,i,j,display,shadowLen,p,to,ihs,hs,sprite,shadows,shadow,item,label,attrs,me=this;if(me.highlight){if("segment"in me.highlightCfg&&me.items)for(items=me.items,animate=me.chart.animate,shadowsEnabled=!!me.chart.shadow,group=me.labelsGroup,len=items.length,i=0,j=0,display=me.label.display;i<len;i++)if(item=items[i],item&&(sprite=item.sprite,sprite&&sprite._highlighted)){if(group){label=group.getAt(item.index),attrs=Ext.apply({translate:{x:0,y:0}},"rotate"==display?{rotate:{x:label.attr.x,y:label.attr.y,degrees:label.attr.rotation.degrees}}:{}),me.setSpriteAttributes(label,attrs,animate);var line=label.lineSprite;line&&me.setSpriteAttributes(line,{translate:{x:0,y:0}},animate)}if(shadowsEnabled)for(shadows=item.shadows,shadowLen=shadows.length;j<shadowLen;j++){to={},ihs=item.sprite._to.segment,hs=item.sprite._from.segment,Ext.apply(to,hs);for(p in ihs)p in hs||(to[p]=ihs[p]);shadow=shadows[j],me.setSpriteAttributes(shadow,{segment:to},animate)}}me.callParent(arguments)}},getLegendColor:function(index){var me=this;return me.colorSet&&me.colorSet[index%me.colorSet.length]||me.colorArrayStyle[index%me.colorArrayStyle.length]}}),Ext.define("Ext.chart.series.Radar",{extend:Ext.chart.series.Series,type:"radar",alias:"series.radar",rad:Math.PI/180,showInLegend:!1,style:{},constructor:function(config){this.callParent(arguments);var me=this,surface=me.chart.surface;me.group=surface.getGroup(me.seriesId),me.showMarkers&&(me.markerGroup=surface.getGroup(me.seriesId+"-markers"))},drawSeries:function(){var d,record,s,sLen,series,centerX,centerY,items,radius,startPath,path,x,y,rho,i,nfields,me=this,store=me.chart.getChartStore(),data=store.data.items,group=me.group,chart=me.chart,seriesItems=chart.series.items,field=me.field||me.yField,surface=chart.surface,chartBBox=chart.chartBBox,colorArrayStyle=me.colorArrayStyle,maxValue=0,fields=[],max=Math.max,cos=Math.cos,sin=Math.sin,pi2=2*Math.PI,l=store.getCount(),seriesStyle=me.seriesStyle,axis=chart.axes&&chart.axes.get(0),aggregate=!(axis&&axis.maximum);if(me.setBBox(),maxValue=aggregate?0:axis.maximum||0,Ext.apply(seriesStyle,me.style||{}),!store||!store.getCount()||me.seriesIsHidden)return me.hide(),me.items=[],me.radar&&me.radar.hide(!0),void(me.radar=null);if(seriesStyle.stroke||(seriesStyle.stroke=colorArrayStyle[me.themeIdx%colorArrayStyle.length]),me.unHighlightItem(),me.cleanHighlights(),centerX=me.centerX=chartBBox.x+chartBBox.width/2,centerY=me.centerY=chartBBox.y+chartBBox.height/2,me.radius=radius=Math.min(chartBBox.width,chartBBox.height)/2,me.items=items=[],aggregate){for(s=0,sLen=seriesItems.length;s<sLen;s++)series=seriesItems[s],fields.push(series.yField);for(d=0;d<l;d++)for(record=data[d],i=0,nfields=fields.length;i<nfields;i++)maxValue=max(+record.get(fields[i]),maxValue)}for(maxValue=maxValue||1,startPath=[],path=[],i=0;i<l;i++)record=data[i],rho=radius*record.get(field)/maxValue,x=rho*cos(i/l*pi2),y=rho*sin(i/l*pi2),0==i?(path.push("M",x+centerX,y+centerY),startPath.push("M",.01*x+centerX,.01*y+centerY)):(path.push("L",x+centerX,y+centerY),startPath.push("L",.01*x+centerX,.01*y+centerY)),items.push({sprite:!1,point:[centerX+x,centerY+y],storeItem:record,series:me});path.push("Z"),me.radar||(me.radar=surface.add(Ext.apply({type:"path",group:group,path:startPath},seriesStyle||{}))),chart.resizing&&me.radar.setAttributes({path:startPath},!0),chart.animate?me.onAnimate(me.radar,{to:Ext.apply({path:path},seriesStyle||{})}):me.radar.setAttributes(Ext.apply({path:path},seriesStyle||{}),!0),me.showMarkers&&me.drawMarkers(),me.renderLabels(),me.renderCallouts()},drawMarkers:function(){var item,i,l,marker,rendererAttributes,me=this,chart=me.chart,surface=chart.surface,store=chart.getChartStore(),markerStyle=Ext.apply({},me.markerStyle||{}),endMarkerStyle=Ext.apply(markerStyle,me.markerConfig,{fill:me.colorArrayStyle[me.themeIdx%me.colorArrayStyle.length]}),items=me.items,type=endMarkerStyle.type,markerGroup=me.markerGroup,centerX=me.centerX,centerY=me.centerY;for(delete endMarkerStyle.type,i=0,l=items.length;i<l;i++)item=items[i],marker=markerGroup.getAt(i),marker?marker.show():marker=Ext.chart.Shape[type](surface,Ext.apply({group:markerGroup,x:0,y:0,translate:{x:centerX,y:centerY}},endMarkerStyle)),item.sprite=marker,chart.resizing&&marker.setAttributes({x:0,y:0,translate:{x:centerX,y:centerY}},!0),marker._to={translate:{x:item.point[0],y:item.point[1]}},rendererAttributes=me.renderer(marker,store.getAt(i),marker._to,i,store),rendererAttributes=Ext.applyIf(rendererAttributes||{},endMarkerStyle||{}),chart.animate?me.onAnimate(marker,{to:rendererAttributes}):marker.setAttributes(rendererAttributes,!0)},isItemInPoint:function(x,y,item){var point,tolerance=10,abs=Math.abs;return point=item.point,abs(point[0]-x)<=tolerance&&abs(point[1]-y)<=tolerance},onCreateLabel:function(storeItem,item,i,display){var me=this,group=me.labelsGroup,config=me.label,centerX=me.centerX,centerY=me.centerY,endLabelStyle=Ext.apply({},config,me.seriesLabelStyle||{});return me.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:group,x:centerX,y:centerY},endLabelStyle||{}))},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){function fixAngle(a){return a<0&&(a+=360),a%360}var labelBox,direction,me=this,chart=me.chart,resizing=chart.resizing,config=me.label,format=config.renderer,field=config.field,centerX=me.centerX,centerY=me.centerY,opt={x:Number(item.point[0]),y:Number(item.point[1])},x=opt.x-centerX,y=opt.y-centerY,theta=Math.atan2(y,x||1),deg=180*theta/Math.PI;label.setAttributes({text:format(storeItem.get(field),label,storeItem,item,i,display,animate,index),hidden:!0},!0),labelBox=label.getBBox(),deg=fixAngle(deg),deg>45&&deg<135||deg>225&&deg<315?(direction=deg>45&&deg<135?1:-1,opt.y+=direction*labelBox.height/2):(direction=deg>=135&&deg<=225?-1:1,opt.x+=direction*labelBox.width/2),resizing&&label.setAttributes({x:centerX,y:centerY},!0),animate?(label.show(!0),me.onAnimate(label,{to:opt})):(label.setAttributes(opt,!0),label.show(!0))},toggleAll:function(show){var i,ln,shadow,shadows,me=this;if(show?Ext.chart.series.Radar.superclass.showAll.call(me):Ext.chart.series.Radar.superclass.hideAll.call(me),me.radar&&(me.radar.setAttributes({hidden:!show},!0),me.radar.shadows))for(i=0,shadows=me.radar.shadows,ln=shadows.length;i<ln;i++)shadow=shadows[i],
shadow.setAttributes({hidden:!show},!0)},hideAll:function(){this.toggleAll(!1),this.hideMarkers(0)},showAll:function(){this.toggleAll(!0)},hideMarkers:function(index){for(var me=this,count=me.markerGroup&&me.markerGroup.getCount()||0,i=index||0;i<count;i++)me.markerGroup.getAt(i).hide(!0)},getAxesForXAndYFields:function(){var me=this,chart=me.chart,axes=chart.axes,axis=[].concat(axes&&axes.get(0));return{yAxis:axis}}}),Ext.define("Ext.chart.series.Scatter",{extend:Ext.chart.series.Cartesian,type:"scatter",alias:"series.scatter",constructor:function(config){this.callParent(arguments);var i,l,me=this,shadow=me.chart.shadow,surface=me.chart.surface;if(Ext.apply(me,config,{style:{},markerConfig:{},shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(0, 0, 0)"},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(0, 0, 0)"},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(0, 0, 0)"}]}),me.group=surface.getGroup(me.seriesId),shadow)for(i=0,l=me.shadowAttributes.length;i<l;i++)me.shadowGroups.push(surface.getGroup(me.seriesId+"-shadows"+i))},getBounds:function(){var bbox,xScale,yScale,minX,minY,maxX,maxY,axis,ends,me=this,chart=me.chart,store=chart.getChartStore(),chartAxes=chart.axes,boundAxes=me.getAxesForXAndYFields(),boundXAxis=boundAxes.xAxis,boundYAxis=boundAxes.yAxis;return me.setBBox(),bbox=me.bbox,(axis=chartAxes.get(boundXAxis))&&(ends=axis.applyData(),minX=ends.from,maxX=ends.to),(axis=chartAxes.get(boundYAxis))&&(ends=axis.applyData(),minY=ends.from,maxY=ends.to),me.xField&&!Ext.isNumber(minX)&&(axis=me.getMinMaxXValues(),minX=axis[0],maxX=axis[1]),me.yField&&!Ext.isNumber(minY)&&(axis=me.getMinMaxYValues(),minY=axis[0],maxY=axis[1]),isNaN(minX)?(minX=0,maxX=store.getCount()-1,xScale=bbox.width/(store.getCount()-1)):xScale=bbox.width/(maxX-minX),isNaN(minY)?(minY=0,maxY=store.getCount()-1,yScale=bbox.height/(store.getCount()-1)):yScale=bbox.height/(maxY-minY),{bbox:bbox,minX:minX,minY:minY,xScale:xScale,yScale:yScale}},getPaths:function(){var i,ln,record,x,y,xValue,yValue,sprite,me=this,chart=me.chart,enableShadows=chart.shadow,store=chart.getChartStore(),data=store.data.items,group=me.group,bounds=me.bounds=me.getBounds(),bbox=me.bbox,xScale=bounds.xScale,yScale=bounds.yScale,minX=bounds.minX,minY=bounds.minY,boxX=bbox.x,boxY=bbox.y,boxHeight=bbox.height,attrs=(me.items=[],[]),reverse=me.reverse;for(i=0,ln=data.length;i<ln;i++)record=data[i],xValue=record.get(me.xField),yValue=record.get(me.yField),"undefined"==typeof yValue||"string"==typeof yValue&&!yValue||null==xValue||null==yValue||(("string"==typeof xValue||"object"==typeof xValue&&!Ext.isDate(xValue))&&(xValue=i),("string"==typeof yValue||"object"==typeof yValue&&!Ext.isDate(yValue))&&(yValue=i),x=reverse?boxX+bbox.width-(xValue-minX)*xScale:boxX+(xValue-minX)*xScale,y=boxY+boxHeight-(yValue-minY)*yScale,attrs.push({x:x,y:y}),me.items.push({series:me,value:[xValue,yValue],point:[x,y],storeItem:record}),chart.animate&&chart.resizing&&(sprite=group.getAt(i),sprite&&(me.resetPoint(sprite),enableShadows&&me.resetShadow(sprite))));return attrs},resetPoint:function(sprite){var bbox=this.bbox;sprite.setAttributes({translate:{x:(bbox.x+bbox.width)/2,y:(bbox.y+bbox.height)/2}},!0)},resetShadow:function(sprite){var i,attr,me=this,shadows=sprite.shadows,shadowAttributes=me.shadowAttributes,ln=me.shadowGroups.length,bbox=me.bbox;for(i=0;i<ln;i++)attr=Ext.apply({},shadowAttributes[i]),attr.translate?(attr.translate.x+=(bbox.x+bbox.width)/2,attr.translate.y+=(bbox.y+bbox.height)/2):attr.translate={x:(bbox.x+bbox.width)/2,y:(bbox.y+bbox.height)/2},shadows[i].setAttributes(attr,!0)},createPoint:function(attr,type){var me=this,chart=me.chart,group=me.group,bbox=me.bbox;return Ext.chart.Shape[type](chart.surface,Ext.apply({},{x:0,y:0,group:group,translate:{x:(bbox.x+bbox.width)/2,y:(bbox.y+bbox.height)/2}},attr))},createShadow:function(sprite,endMarkerStyle,type){var i,shadow,shadows,attr,me=this,chart=me.chart,shadowGroups=me.shadowGroups,shadowAttributes=me.shadowAttributes,lnsh=shadowGroups.length,bbox=me.bbox;for(sprite.shadows=shadows=[],i=0;i<lnsh;i++)attr=Ext.apply({},shadowAttributes[i]),attr.translate?(attr.translate.x+=(bbox.x+bbox.width)/2,attr.translate.y+=(bbox.y+bbox.height)/2):Ext.apply(attr,{translate:{x:(bbox.x+bbox.width)/2,y:(bbox.y+bbox.height)/2}}),Ext.apply(attr,endMarkerStyle),shadow=Ext.chart.Shape[type](chart.surface,Ext.apply({},{x:0,y:0,group:shadowGroups[i]},attr)),shadows.push(shadow)},drawSeries:function(){var sprite,attrs,attr,ln,i,endMarkerStyle,shindex,type,shadows,rendererAttributes,shadowAttribute,me=this,chart=me.chart,store=chart.getChartStore(),group=me.group,enableShadows=chart.shadow,shadowGroups=me.shadowGroups,shadowAttributes=me.shadowAttributes,lnsh=shadowGroups.length;if(endMarkerStyle=Ext.apply(me.markerStyle,me.markerConfig),type=endMarkerStyle.type||"circle",delete endMarkerStyle.type,!store||!store.getCount())return me.hide(),void(me.items=[]);for(me.unHighlightItem(),me.cleanHighlights(),attrs=me.getPaths(),ln=attrs.length,i=0;i<ln;i++){if(attr=attrs[i],sprite=group.getAt(i),Ext.apply(attr,endMarkerStyle),sprite||(sprite=me.createPoint(attr,type),enableShadows&&me.createShadow(sprite,endMarkerStyle,type)),shadows=sprite.shadows,chart.animate)for(rendererAttributes=me.renderer(sprite,store.getAt(i),{translate:attr},i,store),sprite._to=rendererAttributes,me.onAnimate(sprite,{to:rendererAttributes}),shindex=0;shindex<lnsh;shindex++)shadowAttribute=Ext.apply({},shadowAttributes[shindex]),rendererAttributes=me.renderer(shadows[shindex],store.getAt(i),Ext.apply({},{hidden:!1,translate:{x:attr.x+(shadowAttribute.translate?shadowAttribute.translate.x:0),y:attr.y+(shadowAttribute.translate?shadowAttribute.translate.y:0)}},shadowAttribute),i,store),me.onAnimate(shadows[shindex],{to:rendererAttributes});else for(rendererAttributes=me.renderer(sprite,store.getAt(i),{translate:attr},i,store),sprite._to=rendererAttributes,sprite.setAttributes(rendererAttributes,!0),shindex=0;shindex<lnsh;shindex++)shadowAttribute=Ext.apply({},shadowAttributes[shindex]),rendererAttributes=me.renderer(shadows[shindex],store.getAt(i),Ext.apply({},{hidden:!1,translate:{x:attr.x+(shadowAttribute.translate?shadowAttribute.translate.x:0),y:attr.y+(shadowAttribute.translate?shadowAttribute.translate.y:0)}},shadowAttribute),i,store),shadows[shindex].setAttributes(rendererAttributes,!0);me.items[i].sprite=sprite}for(ln=group.getCount(),i=attrs.length;i<ln;i++)group.getAt(i).hide(!0);me.renderLabels(),me.renderCallouts()},onCreateLabel:function(storeItem,item,i,display){var me=this,group=me.labelsGroup,config=me.label,endLabelStyle=Ext.apply({},config,me.seriesLabelStyle),bbox=me.bbox;return me.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:group,x:Number(item.point[0]),y:bbox.y+bbox.height/2},endLabelStyle))},onPlaceLabel:function(label,storeItem,item,i,display,animate,index){var labelBox,markerBox,width,height,xOffset,yOffset,anim,me=this,chart=me.chart,resizing=chart.resizing,config=me.label,format=config.renderer,field=config.field,bbox=me.bbox,x=Number(item.point[0]),y=Number(item.point[1]),radius=item.sprite.attr.radius;label.setAttributes({text:format(storeItem.get(field),label,storeItem,item,i,display,animate,index),hidden:!0},!0),markerBox=item.sprite.getBBox(),markerBox.width=markerBox.width||2*radius,markerBox.height=markerBox.height||2*radius,labelBox=label.getBBox(),width=labelBox.width/2,height=labelBox.height/2,"rotate"==display?(xOffset=markerBox.width/2+width+height/2,x+xOffset+width>bbox.x+bbox.width?x-=xOffset:x+=xOffset,label.setAttributes({rotation:{x:x,y:y,degrees:-45}},!0)):"under"!=display&&"over"!=display||(label.setAttributes({rotation:{degrees:0}},!0),x<bbox.x+width?x=bbox.x+width:x+width>bbox.x+bbox.width&&(x=bbox.x+bbox.width-width),yOffset=markerBox.height/2+height,y+="over"==display?-yOffset:yOffset,y<bbox.y+height?y+=2*yOffset:y+height>bbox.y+bbox.height&&(y-=2*yOffset)),chart.animate?resizing?(anim=item.sprite.getActiveAnimation(),anim?anim.on("afteranimate",function(){label.setAttributes({x:x,y:y},!0),label.show(!0)}):label.show(!0)):me.onAnimate(label,{to:{x:x,y:y}}):(label.setAttributes({x:x,y:y},!0),label.show(!0))},onPlaceCallout:function(callout,storeItem,item,i,display,animate,index){var normal,boxx,boxy,boxw,boxh,p,x,y,me=this,chart=me.chart,cur=(chart.surface,chart.resizing,me.callouts,me.items,item.point),bbox=callout.label.getBBox(),offsetFromViz=30,offsetBox=3,clipRect=me.bbox;normal=[Math.cos(Math.PI/4),-Math.sin(Math.PI/4)],x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,(boxx<clipRect[0]||boxx+boxw>clipRect[0]+clipRect[2])&&(normal[0]*=-1),(boxy<clipRect[1]||boxy+boxh>clipRect[1]+clipRect[3])&&(normal[1]*=-1),x=cur[0]+normal[0]*offsetFromViz,y=cur[1]+normal[1]*offsetFromViz,boxx=x+(normal[0]>0?0:-(bbox.width+2*offsetBox)),boxy=y-bbox.height/2-offsetBox,boxw=bbox.width+2*offsetBox,boxh=bbox.height+2*offsetBox,chart.animate?(me.onAnimate(callout.lines,{to:{path:["M",cur[0],cur[1],"L",x,y,"Z"]}},!0),me.onAnimate(callout.box,{to:{x:boxx,y:boxy,width:boxw,height:boxh}},!0),me.onAnimate(callout.label,{to:{x:x+(normal[0]>0?offsetBox:-(bbox.width+offsetBox)),y:y}},!0)):(callout.lines.setAttributes({path:["M",cur[0],cur[1],"L",x,y,"Z"]},!0),callout.box.setAttributes({x:boxx,y:boxy,width:boxw,height:boxh},!0),callout.label.setAttributes({x:x+(normal[0]>0?offsetBox:-(bbox.width+offsetBox)),y:y},!0));for(p in callout)callout[p].show(!0)},onAnimate:function(sprite,attr){return sprite.show(),this.callParent(arguments)},isItemInPoint:function(x,y,item){var point,tolerance=10;Math.abs;return point=item.point,point[0]-tolerance<=x&&point[0]+tolerance>=x&&point[1]-tolerance<=y&&point[1]+tolerance>=y}}),Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.TableLayout",monitorResize:!1,type:"table",createsInnerCt:!0,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",tableAttrs:null,getItemSizePolicy:function(item){return this.autoSizePolicy},initHierarchyState:function(hierarchyStateInner){hierarchyStateInner.inShrinkWrapTable=!0},getLayoutItems:function(){var item,i,me=this,result=[],items=me.callParent(),len=items.length;for(i=0;i<len;i++)item=items[i],item.hidden||result.push(item);return result},getHiddenItems:function(){for(var item,result=[],items=this.owner.items.items,len=items.length,i=0;i<len;++i)item=items[i],item.rendered&&item.hidden&&result.push(item);return result},renderChildren:function(){var cells,curCell,rowIdx,cellIdx,item,trEl,tdEl,itemCt,me=this,items=me.getLayoutItems(),tbody=me.owner.getTargetEl().child("table",!0).tBodies[0],rows=tbody.rows,i=0,len=items.length,hiddenItems=me.getHiddenItems();for(cells=me.calculateCells(items);i<len;i++)if(curCell=cells[i],rowIdx=curCell.rowIdx,cellIdx=curCell.cellIdx,item=items[i],trEl=rows[rowIdx],trEl||(trEl=tbody.insertRow(rowIdx),me.trAttrs&&trEl.set(me.trAttrs)),itemCt=tdEl=Ext.get(trEl.cells[cellIdx]||trEl.insertCell(cellIdx)),me.needsDivWrap()&&(itemCt=tdEl.first()||tdEl.createChild({tag:"div",role:"presentation"}),itemCt.setWidth(null)),item.rendered?me.isValidParent(item,itemCt,rowIdx,cellIdx,tbody)||me.moveItem(item,itemCt,0):me.renderItem(item,itemCt,0),me.tdAttrs&&tdEl.set(me.tdAttrs),item.tdAttrs&&tdEl.set(item.tdAttrs),tdEl.set({colSpan:item.colspan||1,rowSpan:item.rowspan||1,id:item.cellId||"",cls:me.cellCls+" "+(item.cellCls||"")}),!cells[i+1]||cells[i+1].rowIdx!==rowIdx)for(cellIdx++;trEl.cells[cellIdx];)trEl.deleteCell(cellIdx);for(rowIdx++;tbody.rows[rowIdx];)tbody.deleteRow(rowIdx);for(i=0,len=hiddenItems.length;i<len;++i)me.ensureInDocument(hiddenItems[i].getEl())},ensureInDocument:function(el){for(var dom=el.dom.parentNode;dom;){if("BODY"==dom.tagName.toUpperCase())return;dom=dom.parentNode}Ext.getDetachedBody().appendChild(el)},calculate:function(ownerContext){if(ownerContext.hasDomProp("containerChildrenSizeDone")){var targetContext=ownerContext.targetContext,widthShrinkWrap=ownerContext.widthModel.shrinkWrap,heightShrinkWrap=ownerContext.heightModel.shrinkWrap,shrinkWrap=heightShrinkWrap||widthShrinkWrap,table=shrinkWrap&&targetContext.el.child("table",!0),targetPadding=shrinkWrap&&targetContext.getPaddingInfo();widthShrinkWrap&&ownerContext.setContentWidth(table.offsetWidth+targetPadding.width,!0),heightShrinkWrap&&ownerContext.setContentHeight(table.offsetHeight+targetPadding.height,!0)}else this.done=!1},finalizeLayout:function(){if(this.needsDivWrap()){var i,item,items=this.getLayoutItems(),iLen=items.length;for(i=0;i<iLen;i++)item=items[i],Ext.fly(item.el.dom.parentNode).setWidth(item.getWidth())}(Ext.isIE6||Ext.isIEQuirks)&&this.owner.getTargetEl().child("table").repaint()},calculateCells:function(items){for(var j,item,cells=[],rowIdx=0,colIdx=0,cellIdx=0,totalCols=this.columns||1/0,rowspans=[],i=0,len=items.length;i<len;i++){for(item=items[i];colIdx>=totalCols||rowspans[colIdx]>0;)if(colIdx>=totalCols)for(colIdx=0,cellIdx=0,rowIdx++,j=0;j<totalCols;j++)rowspans[j]>0&&rowspans[j]--;else colIdx++;for(cells.push({rowIdx:rowIdx,cellIdx:cellIdx}),j=item.colspan||1;j;--j)rowspans[colIdx]=item.rowspan||1,++colIdx;++cellIdx}return cells},getRenderTree:function(){var cells,i,item,curCell,tr,rowIdx,cellIdx,cell,me=this,items=me.getLayoutItems(),rows=[],result=Ext.apply({tag:"table",role:"presentation",cls:me.tableCls,cellspacing:0,cellpadding:0,cn:{tag:"tbody",role:"presentation",cn:rows}},me.tableAttrs),tdAttrs=me.tdAttrs,needsDivWrap=me.needsDivWrap(),len=items.length;for(cells=me.calculateCells(items),i=0;i<len;i++)item=items[i],curCell=cells[i],rowIdx=curCell.rowIdx,cellIdx=curCell.cellIdx,tr=rows[rowIdx],tr||(tr=rows[rowIdx]={tag:"tr",role:"presentation",cn:[]},me.trAttrs&&Ext.apply(tr,me.trAttrs)),cell=tr.cn[cellIdx]={tag:"td",role:"presentation"},tdAttrs&&Ext.apply(cell,tdAttrs),Ext.apply(cell,{colSpan:item.colspan||1,rowSpan:item.rowspan||1,id:item.cellId||"",cls:me.cellCls+" "+(item.cellCls||"")}),needsDivWrap&&(cell=cell.cn={tag:"div",role:"presentation"}),me.configureItem(item),cell.cn=item.getRenderTree();return result},isValidParent:function(item,target,rowIdx,cellIdx){var tbody,correctCell,table;return 3===arguments.length?(table=item.el.up("table"),table&&table.dom.parentNode===target.dom):(tbody=this.owner.getTargetEl().child("table",!0).tBodies[0],correctCell=tbody.rows[rowIdx].cells[cellIdx],item.el.dom.parentNode===correctCell)},needsDivWrap:function(){return Ext.isOpera10_5}}),Ext.define("Ext.container.ButtonGroup",{extend:Ext.panel.Panel,alias:"widget.buttongroup",alternateClassName:"Ext.ButtonGroup",baseCls:Ext.baseCSSPrefix+"btn-group",layout:{type:"table"},defaultType:"button",frame:!0,frameHeader:!1,titleAlign:"center",noTitleCls:"notitle",ariaRole:"group",initComponent:function(){var me=this,cols=me.columns;cols&&(me.layout=Ext.apply({},{columns:cols},me.layout)),me.title||me.addClsWithUI(me.noTitleCls),me.callParent(arguments)},onBeforeAdd:function(component){component.isButton&&(this.defaultButtonUI&&"default"===component.ui&&!component.hasOwnProperty("ui")?component.ui=this.defaultButtonUI:component.ui=component.ui+"-toolbar"),this.callParent(arguments)},applyDefaults:function(c){return Ext.isString(c)||(c=this.callParent(arguments)),c}}),Ext.define("Ext.container.Monitor",{target:null,selector:"",scope:null,addHandler:null,removeHandler:null,disabled:0,constructor:function(config){Ext.apply(this,config)},bind:function(target){var me=this;me.target=target,target.on("beforedestroy",me.disable,me),me.onContainerAdd(target)},unbind:function(){var me=this,target=me.target;target&&target.un("beforedestroy",me.disable,me),me.items=null},disable:function(){++this.disabled},enable:function(){this.disabled>0&&--this.disabled},handleAdd:function(ct,comp){this.disabled||(comp.is(this.selector)&&this.onItemAdd(comp.ownerCt,comp),comp.isQueryable&&this.onContainerAdd(comp))},onItemAdd:function(ct,comp){var me=this,items=me.items,handler=me.addHandler;me.disabled||(handler&&handler.call(me.scope||comp,comp),items&&items.add(comp))},onItemRemove:function(ct,comp){var me=this,items=me.items,handler=me.removeHandler;me.disabled||(handler&&handler.call(me.scope||comp,comp),items&&items.remove(comp))},onContainerAdd:function(ct,preventChildren){var items,len,i,comp,me=this,handleAdd=me.handleAdd,handleRemove=me.handleRemove;if(ct.isContainer&&(ct.on("add",handleAdd,me),ct.on("dockedadd",handleAdd,me),ct.on("remove",handleRemove,me),ct.on("dockedremove",handleRemove,me)),preventChildren!==!0)for(items=ct.query(me.selector),i=0,len=items.length;i<len;++i)comp=items[i],me.onItemAdd(comp.ownerCt,comp);for(items=ct.query(">container"),i=0,len=items.length;i<len;++i)me.onContainerAdd(items[i],!0)},handleRemove:function(ct,comp){var me=this;me.disabled||(comp.is(me.selector)&&me.onItemRemove(ct,comp),comp.isQueryable&&me.onContainerRemove(ct,comp))},onContainerRemove:function(ct,comp){var items,i,len,item,me=this;if(comp.isDestroyed||comp.destroying||!comp.isContainer)me.invalidateItems();else{for(me.removeCtListeners(comp),items=comp.query(me.selector),i=0,len=items.length;i<len;++i)item=items[i],me.onItemRemove(item.ownerCt,item);for(items=comp.query("container"),i=0,len=items.length;i<len;++i)me.removeCtListeners(items[i])}},removeCtListeners:function(comp){var me=this;comp.un("add",me.handleAdd,me),comp.un("dockedadd",me.handleAdd,me),comp.un("remove",me.handleRemove,me),comp.un("dockedremove",me.handleRemove,me)},getItems:function(){var me=this,items=me.items;return items||(items=me.items=new Ext.util.MixedCollection,items.addAll(me.target.query(me.selector))),items},invalidateItems:function(){this.items=null}}),Ext.define("Ext.container.Viewport",{extend:Ext.container.Container,alias:"widget.viewport",alternateClassName:"Ext.Viewport",isViewport:!0,ariaRole:"application",preserveElOnDestroy:!0,viewportCls:Ext.baseCSSPrefix+"viewport",initComponent:function(){var me=this,html=document.body.parentNode,el=me.el=Ext.getBody();Ext.getScrollbarSize(),me.width=me.height=void 0,me.callParent(arguments),Ext.fly(html).addCls(me.viewportCls),me.autoScroll&&(Ext.fly(html).setStyle(me.getOverflowStyle()),delete me.autoScroll),el.setHeight=el.setWidth=Ext.emptyFn,el.dom.scroll="no",me.allowDomMove=!1,me.renderTo=me.el},applyTargetCls:function(targetCls){this.el.addCls(targetCls)},onRender:function(){var me=this;me.callParent(arguments),me.width=Ext.Element.getViewportWidth(),me.height=Ext.Element.getViewportHeight()},afterFirstLayout:function(){var me=this;me.callParent(arguments),setTimeout(function(){Ext.EventManager.onWindowResize(me.fireResize,me)},1)},fireResize:function(width,height){width==this.width&&height==this.height||this.setSize(width,height)},initHierarchyState:function(hierarchyState){this.callParent([this.hierarchyState=Ext.rootHierarchyState])},beforeDestroy:function(){var me=this;me.removeUIFromElement(),me.el.removeCls(me.baseCls),Ext.fly(document.body.parentNode).removeCls(me.viewportCls),me.callParent()}}),Ext.define("Ext.data.IdGenerator",{isGenerator:!0,constructor:function(config){var me=this;Ext.apply(me,config),me.id&&(Ext.data.IdGenerator.all[me.id]=me)},getRecId:function(rec){return rec.modelName+"-"+rec.internalId},statics:{all:{},get:function(config){var generator,id,type;if("string"==typeof config)id=type=config,config=null;else{if(config.isGenerator)return config;id=config.id||config.type,type=config.type}return generator=this.all[id],generator||(generator=Ext.create("idgen."+type,config)),generator}}}),Ext.define("Ext.data.SortTypes",{singleton:!0,none:Ext.identityFn,stripTagsRE:/<\/?[^>]+>/gi,asText:function(s){return String(s).replace(this.stripTagsRE,"")},asUCText:function(s){return String(s).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(s){return String(s).toUpperCase()},asDate:function(s){return s?Ext.isDate(s)?s.getTime():Date.parse(String(s)):0},asFloat:function(s){var val=parseFloat(String(s).replace(/,/g,""));return isNaN(val)?0:val},asInt:function(s){var val=parseInt(String(s).replace(/,/g,""),10);return isNaN(val)?0:val}}),Ext.define("Ext.data.Types",{singleton:!0},function(){var st=Ext.data.SortTypes;Ext.apply(Ext.data.Types,{stripRe:/[\$,%]/g,AUTO:{sortType:st.none,type:"auto"},STRING:{convert:function(v){var defaultValue=this.useNull?null:"";return void 0===v||null===v?defaultValue:String(v)},sortType:st.asUCString,type:"string"},INT:{convert:function(v){return"number"==typeof v?parseInt(v):void 0!==v&&null!==v&&""!==v?parseInt(String(v).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:st.none,type:"int"},FLOAT:{convert:function(v){return"number"==typeof v?v:void 0!==v&&null!==v&&""!==v?parseFloat(String(v).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:st.none,type:"float"},BOOL:{convert:function(v){return"boolean"==typeof v?v:!this.useNull||void 0!==v&&null!==v&&""!==v?"true"===v||1==v:null},sortType:st.none,type:"bool"},DATE:{convert:function(v){var parsed,df=this.dateReadFormat||this.dateFormat;return v?v instanceof Date?v:df?Ext.Date.parse(v,df):(parsed=Date.parse(v),parsed?new Date(parsed):null):null},sortType:st.asDate,type:"date"}}),Ext.apply(Ext.data.Types,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})}),Ext.define("Ext.data.Field",{alias:"data.field",isField:!0,constructor:function(config){var st,me=this,types=Ext.data.Types;Ext.isString(config)&&(config={name:config}),Ext.apply(me,config),st=me.sortType,me.type?Ext.isString(me.type)&&(me.type=types[me.type.toUpperCase()]||types.AUTO):me.type=types.AUTO,Ext.isString(st)?me.sortType=Ext.data.SortTypes[st]:Ext.isEmpty(st)&&(me.sortType=me.type.sortType),config.hasOwnProperty("convert")?me.convert||!me.type.convert||config.hasOwnProperty("defaultValue")||(me.defaultValue=me.type.convert(me.defaultValue)):me.convert=me.type.convert,config.convert&&(me.hasCustomConvert=!0)},dateFormat:null,dateReadFormat:null,dateWriteFormat:null,useNull:!1,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:!0,persist:!0}),Ext.define("Ext.data.Errors",{extend:Ext.util.MixedCollection,isValid:function(){return 0===this.length},getByField:function(fieldName){var error,i,errors=[];for(i=0;i<this.length;i++)error=this.items[i],error.field==fieldName&&errors.push(error);return errors}}),Ext.define("Ext.data.validations",{singleton:!0,presenceMessage:"must be present",lengthMessage:"is the wrong length",formatMessage:"is the wrong format",inclusionMessage:"is not included in the list of acceptable values",exclusionMessage:"is not an acceptable value",emailMessage:"is not a valid email address",emailRe:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,presence:function(config,value){return 1===arguments.length&&(value=config),!!value||0===value||value===!1},length:function(config,value){if(void 0===value||null===value)return!1;var length=value.length,min=config.min,max=config.max;return!(min&&length<min||max&&length>max)},email:function(config,email){return Ext.data.validations.emailRe.test(email)},format:function(config,value){return!(!config.matcher||!config.matcher.test(value))},inclusion:function(config,value){return config.list&&Ext.Array.indexOf(config.list,value)!=-1},exclusion:function(config,value){return config.list&&Ext.Array.indexOf(config.list,value)==-1}}),Ext.define("Ext.data.Model",{alternateClassName:"Ext.data.Record",mixins:{observable:Ext.util.Observable},compareConvertFields:function(f1,f2){var f1SpecialConvert=f1.convert&&f1.type&&f1.convert!==f1.type.convert,f2SpecialConvert=f2.convert&&f2.type&&f2.convert!==f2.type.convert;return f1SpecialConvert&&!f2SpecialConvert?1:!f1SpecialConvert&&f2SpecialConvert?-1:0},itemNameFn:function(item){return item.name},onClassExtended:function(cls,data,hooks){var onBeforeClassCreated=hooks.onBeforeCreated;hooks.onBeforeCreated=function(cls,data){var field,associationConfig,i,ln,me=this,name=Ext.getClassName(cls),prototype=cls.prototype,superCls=cls.prototype.superclass,validations=data.validations||[],fields=data.fields||[],associationsConfigs=data.associations||[],addAssociations=function(items,type){var len,item,i=0;if(items)for(items=Ext.Array.from(items),len=items.length;i<len;++i)item=items[i],Ext.isObject(item)||(item={model:item}),item.type=type,associationsConfigs.push(item)},idgen=data.idgen,fieldsMixedCollection=new Ext.util.MixedCollection((!1),prototype.itemNameFn),associationsMixedCollection=new Ext.util.MixedCollection((!1),prototype.itemNameFn),superValidations=superCls.validations,superFields=superCls.fields,superAssociations=superCls.associations,dependencies=[],idProperty="idProperty"in data?data.idProperty:prototype.idProperty,idField=idProperty?idProperty.isField?idProperty:new Ext.data.Field(idProperty):null,idFieldDefined=!1,onFieldAddReplace=function(arg0,arg1,arg2){var newField,pos;fieldsMixedCollection.events.add.firing?(pos=arg0,newField=arg1):(newField=arg2,pos=arg1.originalIndex),newField.originalIndex=pos,idField&&(newField.mapping&&newField.mapping===idField.mapping||newField.name===idField.name)&&(prototype.idField=newField,idFieldDefined=!0,newField.defaultValue=void 0)},clsProxy=data.proxy,fieldConvertSortFn=function(){fieldsMixedCollection.sortBy(prototype.compareConvertFields)};for(cls.modelName=name,prototype.modelName=name,superValidations&&(validations=superValidations.concat(validations)),data.validations=validations,superFields&&(fields=superFields.items.concat(fields)),fieldsMixedCollection.on({add:onFieldAddReplace,replace:onFieldAddReplace}),i=0,ln=fields.length;i<ln;++i)field=fields[i],fieldsMixedCollection.add(field.isField?field:new Ext.data.Field(field));for(idField&&!idFieldDefined&&(prototype.idField=idField,idField.defaultValue=void 0,fieldsMixedCollection.add(idField)),fieldConvertSortFn(),fieldsMixedCollection.on({add:fieldConvertSortFn,replace:fieldConvertSortFn}),data.fields=fieldsMixedCollection,idgen&&(data.idgen=Ext.data.IdGenerator.get(idgen)),addAssociations(data.belongsTo,"belongsTo"),delete data.belongsTo,addAssociations(data.hasMany,"hasMany"),delete data.hasMany,addAssociations(data.hasOne,"hasOne"),delete data.hasOne,superAssociations&&(associationsConfigs=superAssociations.items.concat(associationsConfigs)),i=0,ln=associationsConfigs.length;i<ln;++i)dependencies.push("association."+associationsConfigs[i].type.toLowerCase());clsProxy?clsProxy.isProxy||dependencies.push("proxy."+(clsProxy.type||clsProxy)):cls.prototype.proxy||(cls.prototype.proxy=cls.prototype.defaultProxyType,dependencies.push("proxy."+cls.prototype.defaultProxyType)),Ext.require(dependencies,function(){for(Ext.ModelManager.registerType(name,cls),i=0,ln=associationsConfigs.length;i<ln;++i)associationConfig=associationsConfigs[i],associationConfig.isAssociation?associationConfig=Ext.applyIf({ownerModel:name,associatedModel:associationConfig.model},associationConfig.initialConfig):Ext.apply(associationConfig,{ownerModel:name,associatedModel:associationConfig.model}),void 0===Ext.ModelManager.getModel(associationConfig.model)?Ext.ModelManager.registerDeferredAssociation(associationConfig):associationsMixedCollection.add(Ext.data.association.Association.create(associationConfig));data.associations=associationsMixedCollection,onBeforeClassCreated.call(me,cls,data,hooks),clsProxy&&clsProxy.isProxy&&cls.setProxy(clsProxy),Ext.ModelManager.onModelDefined(cls)})}},inheritableStatics:{setProxy:function(proxy){return proxy.isProxy||("string"==typeof proxy&&(proxy={type:proxy}),proxy=Ext.createByAlias("proxy."+proxy.type,proxy)),proxy.setModel(this),this.proxy=this.prototype.proxy=proxy,proxy},getProxy:function(){var proxy=this.proxy;return proxy?proxy:(proxy=this.prototype.proxy,proxy.isProxy&&(proxy=proxy.clone()),this.setProxy(proxy))},setFields:function(fields,idProperty,clientIdProperty){var newField,idField,len,i,me=this,idFieldDefined=!1,proto=me.prototype,prototypeFields=proto.fields,superFields=proto.superclass.fields;for(idProperty&&(proto.idProperty=idProperty,idField=idProperty.isField?idProperty:new Ext.data.Field(idProperty)),clientIdProperty&&(proto.clientIdProperty=clientIdProperty),prototypeFields?prototypeFields.clear():prototypeFields=me.prototype.fields=new Ext.util.MixedCollection((!1),function(field){return field.name}),superFields&&(fields=superFields.items.concat(fields)),i=0,len=fields.length;i<len;i++)newField=new Ext.data.Field(fields[i]),idField&&(newField.mapping&&newField.mapping===idField.mapping||newField.name===idField.name)&&(idFieldDefined=!0,newField.defaultValue=void 0),prototypeFields.add(newField);return idField&&!idFieldDefined&&(idField.defaultValue=void 0,prototypeFields.add(idField)),me.fields=prototypeFields,prototypeFields},getFields:function(){return this.prototype.fields.items},load:function(id,config){config=Ext.apply({},config),config=Ext.applyIf(config,{action:"read",id:id});var callback,operation=new Ext.data.Operation(config),scope=config.scope||this;callback=function(operation){var record=null,success=operation.wasSuccessful();success?(record=operation.getRecords()[0],record.hasId()||record.setId(id),Ext.callback(config.success,scope,[record,operation])):Ext.callback(config.failure,scope,[record,operation]),Ext.callback(config.callback,scope,[record,operation,success])},this.getProxy().read(operation,callback,this)}},statics:{PREFIX:"ext-record",AUTO_ID:1,EDIT:"edit",REJECT:"reject",COMMIT:"commit",id:function(rec){var id=[this.PREFIX,"-",this.AUTO_ID++].join("");return rec.phantom=!0,rec.internalId=id,id}},idgen:{isGenerator:!0,type:"default",generate:function(){return null},getRecId:function(rec){return rec.modelName+"-"+rec.internalId}},editing:!1,dirty:!1,persistenceProperty:"data",evented:!1,isModel:!0,phantom:!1,idProperty:"id",clientIdProperty:null,defaultProxyType:"ajax",emptyData:[],constructor:function(data,id,raw,convertedData){var hasId,fields,length,field,name,value,newId,persistenceProperty,i,me=this,passedId=id||0===id,idProperty=me.idProperty,idField=me.idField;if(me.raw=raw||data,me.modified={},persistenceProperty=me[me.persistenceProperty]=convertedData||{},me.data=me[me.persistenceProperty],me.mixins.observable.constructor.call(me),!convertedData)if(data?!passedId&&idProperty&&(id=data[idProperty],hasId=id||0===id):data=me.emptyData,fields=me.fields.items,length=fields.length,i=0,Ext.isArray(data))for(;i<length;i++)field=fields[i],name=field.name,value=data[field.originalIndex],void 0===value&&(value=field.defaultValue),field.convert&&(value=field.convert(value,me)),void 0!==value&&(persistenceProperty[name]=value);else for(;i<length;i++)field=fields[i],name=field.name,value=data[name],void 0===value&&(value=field.defaultValue),field.convert&&(value=field.convert(value,me)),void 0!==value&&(persistenceProperty[name]=value);me.stores=[],passedId?(hasId=!0,persistenceProperty[idProperty]=idField&&idField.convert?idField.convert(id):id):hasId||(newId=me.idgen.generate(),null!=newId&&(me.preventInternalUpdate=!0,me.setId(newId),delete me.preventInternalUpdate)),me.internalId=hasId?id:Ext.data.Model.id(me),"function"==typeof me.init&&me.init(),me.id=me.idgen.getRecId(me)},get:function(field){return this[this.persistenceProperty][field]},_singleProp:{},set:function(fieldName,newValue){var currentValue,field,idChanged,key,modifiedFieldNames,name,oldId,newId,value,values,me=this,data=me[me.persistenceProperty],fields=me.fields,modified=me.modified,single="string"==typeof fieldName;single?(values=me._singleProp,values[fieldName]=newValue):values=fieldName;for(name in values)if(values.hasOwnProperty(name)){if(value=values[name],fields&&(field=fields.get(name))&&field.convert&&(value=field.convert(value,me)),currentValue=data[name],me.isEqual(currentValue,value))continue;if(data[name]=value,(modifiedFieldNames||(modifiedFieldNames=[])).push(name),field&&field.persist)if(modified.hasOwnProperty(name)){
if(me.isEqual(modified[name],value)){delete modified[name],me.dirty=!1;for(key in modified)if(modified.hasOwnProperty(key)){me.dirty=!0;break}}}else me.dirty=!0,modified[name]=currentValue;name==me.idProperty&&(idChanged=!0,oldId=currentValue,newId=value)}return single&&delete values[fieldName],idChanged&&me.changeId(oldId,newId),!me.editing&&modifiedFieldNames&&me.afterEdit(modifiedFieldNames),modifiedFieldNames||null},copyFrom:function(sourceRecord){var field,myData,sourceData,name,value,me=this,fields=me.fields.items,fieldCount=fields.length,modifiedFieldNames=[],i=0,idProperty=me.idProperty;if(sourceRecord){for(myData=me[me.persistenceProperty],sourceData=sourceRecord[sourceRecord.persistenceProperty];i<fieldCount;i++)field=fields[i],name=field.name,name!=idProperty&&(value=sourceData[name],void 0===value||me.isEqual(myData[name],value)||(myData[name]=value,modifiedFieldNames.push(name)));me.phantom&&!sourceRecord.phantom&&(me.beginEdit(),me.setId(sourceRecord.getId()),me.endEdit(!0),me.commit(!0))}return modifiedFieldNames},isEqual:function(a,b){return a instanceof Date&&b instanceof Date?a.getTime()===b.getTime():a===b},beginEdit:function(){var key,data,o,me=this;if(!me.editing){me.editing=!0,me.dirtySave=me.dirty,o=me[me.persistenceProperty],data=me.dataSave={};for(key in o)o.hasOwnProperty(key)&&(data[key]=o[key]);o=me.modified,data=me.modifiedSave={};for(key in o)o.hasOwnProperty(key)&&(data[key]=o[key])}},cancelEdit:function(){var me=this;me.editing&&(me.editing=!1,me.modified=me.modifiedSave,me[me.persistenceProperty]=me.dataSave,me.dirty=me.dirtySave,me.modifiedSave=me.dataSave=me.dirtySave=null)},endEdit:function(silent,modifiedFieldNames){var dataSave,changed,me=this;silent=silent===!0,me.editing&&(me.editing=!1,dataSave=me.dataSave,me.modifiedSave=me.dataSave=me.dirtySave=null,silent||(modifiedFieldNames||(modifiedFieldNames=me.getModifiedFieldNames(dataSave)),changed=me.dirty||modifiedFieldNames.length>0,changed&&me.afterEdit(modifiedFieldNames)))},getModifiedFieldNames:function(saved){var key,me=this,data=me[me.persistenceProperty],modified=[];saved=saved||me.dataSave;for(key in data)data.hasOwnProperty(key)&&(me.isEqual(data[key],saved[key])||modified.push(key));return modified},getChanges:function(){var field,modified=this.modified,changes={};for(field in modified)modified.hasOwnProperty(field)&&(changes[field]=this.get(field));return changes},isModified:function(fieldName){return this.modified.hasOwnProperty(fieldName)},setDirty:function(){var field,name,f,me=this,fields=me.fields.items,fLen=fields.length;for(me.dirty=!0,f=0;f<fLen;f++)field=fields[f],field.persist&&(name=field.name,me.modified[name]=me.get(name))},reject:function(silent){var field,me=this,modified=me.modified;for(field in modified)modified.hasOwnProperty(field)&&"function"!=typeof modified[field]&&(me[me.persistenceProperty][field]=modified[field]);me.dirty=!1,me.editing=!1,me.modified={},silent!==!0&&me.afterReject()},commit:function(silent,modifiedFieldNames){var me=this;me.phantom=me.dirty=me.editing=!1,me.modified={},silent!==!0&&me.afterCommit(modifiedFieldNames)},copy:function(newId){var me=this;return new me.self(me.raw,newId,null,Ext.apply({},me[me.persistenceProperty]))},setProxy:function(proxy){return proxy.isProxy||("string"==typeof proxy&&(proxy={type:proxy}),proxy=Ext.createByAlias("proxy."+proxy.type,proxy)),proxy.setModel(this.self),this.proxy=proxy,proxy},getProxy:function(){return this.hasOwnProperty("proxy")?this.proxy:this.self.getProxy()},validate:function(){var length,validation,field,valid,type,i,errors=new Ext.data.Errors,validations=this.validations,validators=Ext.data.validations;if(validations)for(length=validations.length,i=0;i<length;i++)validation=validations[i],field=validation.field||validation.name,type=validation.type,valid=validators[type](validation,this.get(field)),valid||errors.add({field:field,message:validation.message||validators[type+"Message"]});return errors},isValid:function(){return this.validate().isValid()},save:function(options){options=Ext.apply({},options);var storeCount,store,operation,callback,me=this,action=me.phantom?"create":"update",scope=options.scope||me,stores=me.stores,i=0;return Ext.apply(options,{records:[me],action:action}),operation=new Ext.data.Operation(options),callback=function(operation){var success=operation.wasSuccessful();if(success){for(storeCount=stores.length;i<storeCount;i++)store=stores[i],store.fireEvent("write",store,operation),store.fireEvent("datachanged",store);Ext.callback(options.success,scope,[me,operation])}else Ext.callback(options.failure,scope,[me,operation]);Ext.callback(options.callback,scope,[me,operation,success])},me.getProxy()[action](operation,callback,me),me},destroy:function(options){options=Ext.apply({records:[this],action:"destroy"},options);var stores,storeCount,store,args,operation,callback,me=this,isNotPhantom=me.phantom!==!0,scope=options.scope||me,i=0;return operation=new Ext.data.Operation(options),callback=function(operation){if(args=[me,operation],stores=Ext.Array.clone(me.stores),operation.wasSuccessful()){for(storeCount=stores.length;i<storeCount;i++)store=stores[i],store.remove?store.remove(me,!0):store.fireEvent("bulkremove",store,[me],[store.indexOf(me)],!1),isNotPhantom&&store.fireEvent("write",store,operation);me.clearListeners(),Ext.callback(options.success,scope,args)}else Ext.callback(options.failure,scope,args);Ext.callback(options.callback,scope,args)},isNotPhantom?me.getProxy().destroy(operation,callback,me):(operation.complete=operation.success=!0,operation.resultSet=me.getProxy().reader.nullResultSet,callback(operation)),me},getId:function(){return this.get(this.idField.name)},getObservableId:function(){return this.id},setId:function(id){this.set(this.idProperty,id)},changeId:function(oldId,newId){var hasOldId,hasId,oldInternalId,me=this;me.preventInternalUpdate||(hasOldId=me.hasId(oldId),hasId=me.hasId(newId),oldInternalId=me.internalId,me.phantom=!hasId,(hasId!==hasOldId||hasId&&hasOldId)&&(me.internalId=hasId?newId:Ext.data.Model.id(me)),me.fireEvent("idchanged",me,oldId,newId,oldInternalId),me.callStore("onIdChanged",oldId,newId,oldInternalId))},hasId:function(id){return 0===arguments.length&&(id=this.getId()),!(!id&&0!==id)},join:function(store){var me=this;me.stores.length?Ext.Array.include(this.stores,store):me.stores[0]=store,this.store=this.stores[0]},unjoin:function(store){Ext.Array.remove(this.stores,store),this.store=this.stores[0]||null},afterEdit:function(modifiedFieldNames){this.callStore("afterEdit",modifiedFieldNames)},afterReject:function(){this.callStore("afterReject")},afterCommit:function(modifiedFieldNames){this.callStore("afterCommit",modifiedFieldNames)},callStore:function(fn){var store,args=Ext.Array.clone(arguments),stores=this.stores,i=0,len=stores.length;for(args[0]=this;i<len;++i)store=stores[i],store&&Ext.isFunction(store[fn])&&store[fn].apply(store,args)},getData:function(includeAssociated){var name,f,me=this,fields=me.fields.items,fLen=fields.length,data={};for(f=0;f<fLen;f++)name=fields[f].name,data[name]=me.get(name);return includeAssociated===!0&&Ext.apply(data,me.getAssociatedData()),data},getAssociatedData:function(){return this.prepareAssociatedData({},1)},prepareAssociatedData:function(seenKeys,depth){var associatedStore,associatedRecords,associatedRecord,o,index,result,seenDepth,associationId,associatedRecordCount,association,i,j,type,name,me=this,associations=me.associations.items,associationCount=associations.length,associationData={},toRead=[],toReadKey=[],toReadIndex=[];for(i=0;i<associationCount;i++)if(association=associations[i],associationId=association.associationId,seenDepth=seenKeys[associationId],!seenDepth||seenDepth===depth)if(seenKeys[associationId]=depth,type=association.type,name=association.name,"hasMany"==type){if(associatedStore=me[association.storeName],associationData[name]=[],associatedStore&&associatedStore.getCount()>0)for(associatedRecords=associatedStore.data.items,associatedRecordCount=associatedRecords.length,j=0;j<associatedRecordCount;j++)associatedRecord=associatedRecords[j],associationData[name][j]=associatedRecord.getData(),toRead.push(associatedRecord),toReadKey.push(name),toReadIndex.push(j)}else"belongsTo"!=type&&"hasOne"!=type||(associatedRecord=me[association.instanceName],void 0!==associatedRecord&&(associationData[name]=associatedRecord.getData(),toRead.push(associatedRecord),toReadKey.push(name),toReadIndex.push(-1)));for(i=0,associatedRecordCount=toRead.length;i<associatedRecordCount;++i)associatedRecord=toRead[i],o=associationData[toReadKey[i]],index=toReadIndex[i],result=associatedRecord.prepareAssociatedData(seenKeys,depth+1),index===-1?Ext.apply(o,result):Ext.apply(o[index],result);return associationData}}),Ext.define("Ext.data.proxy.Server",{extend:Ext.data.proxy.Proxy,alias:"proxy.server",alternateClassName:"Ext.data.ServerProxy",pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",groupDirectionParam:"groupDir",sortParam:"sort",filterParam:"filter",directionParam:"dir",idParam:"id",simpleSortMode:!1,simpleGroupMode:!1,noCache:!0,cacheString:"_dc",timeout:3e4,constructor:function(config){var me=this;config=config||{},me.callParent([config]),me.extraParams=config.extraParams||{},me.api=Ext.apply({},config.api||me.api),me.nocache=me.noCache},create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:function(name,value){this.extraParams[name]=value},buildRequest:function(operation){var request,me=this,params=operation.params=Ext.apply({},operation.params,me.extraParams);return Ext.applyIf(params,me.getParams(operation)),void 0!==operation.id&&void 0===params[me.idParam]&&(params[me.idParam]=operation.id),request=new Ext.data.Request({params:params,action:operation.action,records:operation.records,operation:operation,url:operation.url,proxy:me}),request.url=me.buildUrl(request),operation.request=request,request},processResponse:function(success,operation,request,response,callback,scope){var reader,result,me=this;success===!0?(reader=me.getReader(),reader.applyDefaults="read"===operation.action,result=reader.read(me.extractResponseData(response)),result.success!==!1?(Ext.apply(operation,{response:response,resultSet:result}),operation.commitRecords(result.records),operation.setCompleted(),operation.setSuccessful()):(operation.setException(result.message),me.fireEvent("exception",this,response,operation))):(me.setException(operation,response),me.fireEvent("exception",this,response,operation)),"function"==typeof callback&&callback.call(scope||me,operation),me.afterRequest(request,success)},setException:function(operation,response){operation.setException({status:response.status,statusText:response.statusText})},extractResponseData:Ext.identityFn,applyEncoding:function(value){return Ext.encode(value)},encodeSorters:function(sorters){for(var min=[],length=sorters.length,i=0;i<length;i++)min[i]={property:sorters[i].property,direction:sorters[i].direction};return this.applyEncoding(min)},encodeFilters:function(filters){for(var min=[],length=filters.length,i=0;i<length;i++)min[i]={property:filters[i].property,value:filters[i].value};return this.applyEncoding(min)},getParams:function(operation){var hasGroups,index,me=this,params={},isDef=Ext.isDefined,groupers=operation.groupers,sorters=operation.sorters,filters=operation.filters,page=operation.page,start=operation.start,limit=operation.limit,simpleSortMode=me.simpleSortMode,simpleGroupMode=me.simpleGroupMode,pageParam=me.pageParam,startParam=me.startParam,limitParam=me.limitParam,groupParam=me.groupParam,groupDirectionParam=me.groupDirectionParam,sortParam=me.sortParam,filterParam=me.filterParam,directionParam=me.directionParam;return pageParam&&isDef(page)&&(params[pageParam]=page),startParam&&isDef(start)&&(params[startParam]=start),limitParam&&isDef(limit)&&(params[limitParam]=limit),hasGroups=groupParam&&groupers&&groupers.length>0,hasGroups&&(simpleGroupMode?(params[groupParam]=groupers[0].property,params[groupDirectionParam]=groupers[0].direction||"ASC"):params[groupParam]=me.encodeSorters(groupers)),sortParam&&sorters&&sorters.length>0&&(simpleSortMode?(index=0,sorters.length>1&&hasGroups&&(index=1),params[sortParam]=sorters[index].property,params[directionParam]=sorters[index].direction):params[sortParam]=me.encodeSorters(sorters)),filterParam&&filters&&filters.length>0&&(params[filterParam]=me.encodeFilters(filters)),params},buildUrl:function(request){var me=this,url=me.getUrl(request);return me.noCache&&(url=Ext.urlAppend(url,Ext.String.format("{0}={1}",me.cacheString,Ext.Date.now()))),url},getUrl:function(request){return request.url||this.api[request.action]||this.url},doRequest:function(operation,callback,scope){},afterRequest:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.reader,this.writer)}}),Ext.define("Ext.data.proxy.Ajax",{extend:Ext.data.proxy.Server,alias:"proxy.ajax",alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},defaultActionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},binary:!1,paramsAsJson:!1,doRequest:function(operation,callback,scope){var me=this,writer=me.getWriter(),request=me.buildRequest(operation),method=me.getMethod(request);return operation.allowWrite()&&(request=writer.write(request)),Ext.apply(request,{binary:me.binary,headers:me.headers,timeout:me.timeout,scope:me,callback:me.createRequestCallback(request,operation,callback,scope),method:method,disableCaching:!1}),"GET"!==method.toUpperCase()&&me.paramsAsJson&&(request=Ext.apply({jsonData:request.params},request),delete request.params),Ext.Ajax.request(request),request},getMethod:function(request){var method,actions=this.actionMethods,action=request.action;return actions&&(method=actions[action]),method||this.defaultActionMethods[action]},createRequestCallback:function(request,operation,callback,scope){var me=this;return function(options,success,response){me.processResponse(success,operation,request,response,callback,scope)}}}),Ext.define("Ext.data.proxy.Client",{extend:Ext.data.proxy.Proxy,alternateClassName:"Ext.data.ClientProxy",isSynchronous:!0,clear:function(){}}),Ext.define("Ext.data.proxy.Memory",{extend:Ext.data.proxy.Client,alias:"proxy.memory",alternateClassName:"Ext.data.MemoryProxy",constructor:function(config){this.callParent([config]),this.setReader(this.reader)},updateOperation:function(operation,callback,scope){var i=0,recs=operation.getRecords(),len=recs.length;for(i;i<len;i++)recs[i].commit();operation.setCompleted(),operation.setSuccessful(),Ext.callback(callback,scope||this,[operation])},create:function(){this.updateOperation.apply(this,arguments)},update:function(){this.updateOperation.apply(this,arguments)},destroy:function(){this.updateOperation.apply(this,arguments)},read:function(operation,callback,scope){var me=this,resultSet=operation.resultSet=me.getReader().read(me.data),records=resultSet.records,sorters=operation.sorters,groupers=operation.groupers,filters=operation.filters;operation.setCompleted(),resultSet.success&&(filters&&filters.length&&(records=resultSet.records=Ext.Array.filter(records,Ext.util.Filter.createFilterFn(filters)),resultSet.total=records.length),groupers&&groupers.length&&(sorters=sorters?sorters.concat(groupers):sorters),sorters&&sorters.length&&(resultSet.records=Ext.Array.sort(records,Ext.util.Sortable.createComparator(sorters))),me.enablePaging&&void 0!==operation.start&&void 0!==operation.limit&&(operation.start>=resultSet.total?(resultSet.success=!1,resultSet.count=0,resultSet.records=[]):(resultSet.records=Ext.Array.slice(resultSet.records,operation.start,operation.start+operation.limit),resultSet.count=resultSet.records.length))),resultSet.success?operation.setSuccessful():me.fireEvent("exception",me,null,operation),Ext.callback(callback,scope||me,[operation])},clear:Ext.emptyFn}),Ext.define("Ext.util.LruCache",{extend:Ext.util.HashMap,constructor:function(config){Ext.apply(this,config),this.callParent([config])},add:function(key,newValue){var entry,me=this,existingKey=me.findKey(newValue);return existingKey?(me.unlinkEntry(entry=me.map[existingKey]),entry.prev=me.last,entry.next=null):entry={prev:me.last,next:null,key:key,value:newValue},me.last?me.last.next=entry:me.first=entry,me.last=entry,me.callParent([key,entry]),me.prune(),newValue},insertBefore:function(key,newValue,sibling){var existingKey,entry,me=this;return(sibling=this.map[this.findKey(sibling)])?(existingKey=me.findKey(newValue),existingKey?me.unlinkEntry(entry=me.map[existingKey]):entry={prev:sibling.prev,next:sibling,key:key,value:newValue},sibling.prev?entry.prev.next=entry:me.first=entry,entry.next=sibling,sibling.prev=entry,me.prune(),newValue):me.add(key,newValue)},get:function(key){var entry=this.map[key];if(entry)return entry.next&&this.moveToEnd(entry),entry.value},removeAtKey:function(key){return this.unlinkEntry(this.map[key]),this.callParent(arguments)},clear:function(initial){return this.first=this.last=null,this.callParent(arguments)},unlinkEntry:function(entry){entry&&(entry.next?entry.next.prev=entry.prev:this.last=entry.prev,entry.prev?entry.prev.next=entry.next:this.first=entry.next,entry.prev=entry.next=null)},moveToEnd:function(entry){this.unlinkEntry(entry),(entry.prev=this.last)?this.last.next=entry:this.first=entry,this.last=entry},getArray:function(isKey){for(var arr=[],entry=this.first;entry;)arr.push(isKey?entry.key:entry.value),entry=entry.next;return arr},each:function(fn,scope,reverse){var me=this,entry=reverse?me.last:me.first,length=me.length;for(scope=scope||me;entry&&fn.call(scope,entry.key,entry.value,length)!==!1;)entry=reverse?entry.prev:entry.next;return me},findKey:function(value){var key,map=this.map;for(key in map)if(map.hasOwnProperty(key)&&map[key].value===value)return key},clone:function(){var key,newCache=new this.self(this.initialConfig),map=this.map;newCache.suspendEvents();for(key in map)map.hasOwnProperty(key)&&newCache.add(key,map[key].value);return newCache.resumeEvents(),newCache},prune:function(){var me=this,purgeCount=me.maxSize?me.length-me.maxSize:0;if(purgeCount>0)for(;me.first&&purgeCount;purgeCount--)me.removeAtKey(me.first.key)}}),Ext.define("Ext.data.PageMap",{extend:Ext.util.LruCache,clear:function(initial){var me=this;me.pageMapGeneration=(me.pageMapGeneration||0)+1,me.callParent(arguments)},forEach:function(fn,scope){var i,j,pageNumber,page,pageSize,me=this,pageNumbers=Ext.Object.getKeys(me.map),pageCount=pageNumbers.length;for(i=0;i<pageCount;i++)pageNumbers[i]=Number(pageNumbers[i]);for(Ext.Array.sort(pageNumbers),scope=scope||me,i=0;i<pageCount;i++)for(pageNumber=pageNumbers[i],page=me.getPage(pageNumber),pageSize=page.length,j=0;j<pageSize;j++)if(fn.call(scope,page[j],(pageNumber-1)*me.pageSize+j)===!1)return},findBy:function(fn,scope){var me=this,result=null;return scope=scope||me,me.forEach(function(rec,index){if(fn.call(scope,rec,index))return result=rec,!1}),result},findIndexBy:function(fn,scope){var me=this,result=-1;return scope=scope||me,me.forEach(function(rec,index){if(fn.call(scope,rec))return result=index,!1}),result},getPageFromRecordIndex:function(){return Ext.data.Store.prototype.getPageFromRecordIndex.apply(this,arguments)},addAll:function(records){this.addPage(1,records)},addPage:function(pageNumber,records){var startIdx,page,me=this,lastPage=pageNumber+Math.floor((records.length-1)/me.pageSize);for(startIdx=0;pageNumber<=lastPage;pageNumber++,startIdx+=me.pageSize)page=Ext.Array.slice(records,startIdx,startIdx+me.pageSize),me.add(pageNumber,page),me.fireEvent("pageAdded",pageNumber,page)},getCount:function(){var result=this.callParent();return result&&(result=(result-1)*this.pageSize+this.last.value.length),result},indexOf:function(record){return record?record.index:-1},insert:function(){},remove:function(){},removeAt:function(){},getPage:function(pageNumber){return this.get(pageNumber)},hasRange:function(start,end){for(var pageNumber=this.getPageFromRecordIndex(start),endPageNumber=this.getPageFromRecordIndex(end);pageNumber<=endPageNumber;pageNumber++)if(!this.hasPage(pageNumber))return!1;return!0},hasPage:function(pageNumber){return!!this.get(pageNumber)},getAt:function(index){return this.getRange(index,index)[0]},getRange:function(start,end){this.hasRange(start,end)||Ext.Error.raise("PageMap asked for range which it does not have");for(var sliceBegin,sliceEnd,doSlice,len,me=this,startPageNumber=me.getPageFromRecordIndex(start),endPageNumber=me.getPageFromRecordIndex(end),dataStart=(startPageNumber-1)*me.pageSize,dataEnd=endPageNumber*me.pageSize-1,pageNumber=startPageNumber,result=[],i=0;pageNumber<=endPageNumber;pageNumber++)pageNumber==startPageNumber?(sliceBegin=start-dataStart,doSlice=!0):(sliceBegin=0,doSlice=!1),pageNumber==endPageNumber&&(sliceEnd=me.pageSize-(dataEnd-end),doSlice=!0),doSlice?Ext.Array.push(result,Ext.Array.slice(me.getPage(pageNumber),sliceBegin,sliceEnd)):Ext.Array.push(result,me.getPage(pageNumber));for(len=result.length;i<len;i++)result[i].index=start++;return result}}),Ext.define("Ext.data.Group",{extend:Ext.util.Observable,key:void 0,dirty:!0,constructor:function(){this.callParent(arguments),this.records=[]},contains:function(record){return Ext.Array.indexOf(this.records,record)!==-1},add:function(records){Ext.Array.push(this.records,records),this.dirty=!0},remove:function(records){Ext.isArray(records)||(records=[records]);var i,len=records.length;for(i=0;i<len;++i)Ext.Array.remove(this.records,records[i]);this.dirty=!0},isDirty:function(){return this.dirty},hasAggregate:function(){return!!this.aggregate},setDirty:function(){this.dirty=!0},commit:function(){this.dirty=!1},isCollapsed:function(){return this.collapsed},getAggregateRecord:function(forceNew){var Model,me=this;return forceNew!==!0&&!me.dirty&&me.aggregate||(Model=me.store.model,me.aggregate=new Model,me.aggregate.isSummary=!0),me.aggregate}}),Ext.define("Ext.data.Store",{extend:Ext.data.AbstractStore,alias:"store.store",remoteSort:!1,remoteFilter:!1,remoteGroup:!1,groupField:void 0,groupDir:"ASC",trailingBufferZone:25,leadingBufferZone:200,pageSize:void 0,currentPage:1,clearOnPageLoad:!0,loading:!1,sortOnFilter:!0,buffered:!1,purgePageCount:5,clearRemovedOnLoad:!0,defaultPageSize:25,defaultViewSize:100,addRecordsOptions:{addRecords:!0},statics:{recordIdFn:function(record){return record.internalId},recordIndexFn:function(record){return record.index},grouperIdFn:function(grouper){return grouper.id||grouper.property},groupIdFn:function(group){return group.key}},constructor:function(config){config=Ext.apply({},config);var proxy,data,me=this,groupers=config.groupers||me.groupers,groupField=config.groupField||me.groupField;data=config.data||me.data,data&&(me.inlineData=data,delete config.data),!groupers&&groupField&&(groupers=[{property:groupField,direction:config.groupDir||me.groupDir}],(config.getGroupString||me.getGroupString!==Ext.data.Store.prototype.getGroupString)&&(groupers[0].getGroupString=function(record){return me.getGroupString(record)})),delete config.groupers,me.groupers=new Ext.util.MixedCollection((!1),Ext.data.Store.grouperIdFn),me.groupers.addAll(me.decodeGroupers(groupers)),me.groups=new Ext.util.MixedCollection((!1),Ext.data.Store.groupIdFn),me.callParent([config]),me.buffered?(me.data=new Ext.data.PageMap({store:me,keyFn:Ext.data.Store.recordIdFn,pageSize:me.pageSize,maxSize:me.purgePageCount,listeners:{clear:me.onPageMapClear,scope:me}}),me.pageRequests={},me.remoteSort=me.remoteGroup=me.remoteFilter=!0,me.sortOnLoad=!1,me.filterOnLoad=!1):me.data=new Ext.util.MixedCollection({getKey:Ext.data.Store.recordIdFn,maintainIndices:!0}),me.remoteGroup&&(me.remoteSort=!0),me.sorters.insert(0,me.groupers.getRange()),proxy=me.proxy,data=me.inlineData,me.buffered||me.pageSize||(me.pageSize=me.defaultPageSize),data?(proxy instanceof Ext.data.proxy.Memory?(proxy.data=data,me.read()):me.add.apply(me,[data]),me.sorters.items.length&&!me.remoteSort&&me.group(null,null,!0),delete me.inlineData):me.autoLoad&&Ext.defer(me.load,1,me,["object"==typeof me.autoLoad?me.autoLoad:void 0])},onBeforeSort:function(){var groupers=this.groupers;groupers.getCount()>0&&this.sort(groupers.items,"prepend",!1)},decodeGroupers:function(groupers){Ext.isArray(groupers)||(groupers=void 0===groupers?[]:[groupers]);var config,i,length=groupers.length,Grouper=Ext.util.Grouper,result=[];for(i=0;i<length;i++)config=groupers[i],config instanceof Grouper?result.push(config):(Ext.isString(config)&&(config={property:config}),config=Ext.apply({root:"data",direction:"ASC"},config),config.fn&&(config.sorterFn=config.fn),"function"==typeof config&&(config={sorterFn:config}),result.push(new Grouper(config)));return result},group:function(groupers,direction,suppressEvent){var grouper,newGroupers,me=this;groupers&&(me.sorters.removeAll(me.groupers.items),Ext.isArray(groupers)?newGroupers=groupers:Ext.isObject(groupers)?newGroupers=[groupers]:Ext.isString(groupers)&&(grouper=me.groupers.get(groupers),grouper?void 0===direction?grouper.toggle():grouper.setDirection(direction):(grouper={property:groupers,direction:direction||"ASC"},newGroupers=[grouper])),newGroupers&&newGroupers.length&&(me.groupers.clear(),me.groupers.addAll(me.decodeGroupers(newGroupers))),me.sorters.insert(0,me.groupers.items)),me.remoteGroup?me.buffered?(me.data.clear(),me.loadPage(1,{groupChange:!0})):me.load({scope:me,callback:suppressEvent?null:me.fireGroupChange}):(me.doSort(me.generateComparator()),me.constructGroups(),suppressEvent||me.fireGroupChange())},getGroupField:function(){var group,first=this.groupers.first();return first&&(group=first.property),group},constructGroups:function(){var groupValue,i,group,rec,me=this,data=this.data.items,len=data.length,groups=me.groups;if(groups.clear(),me.isGrouped())for(i=0;i<len;++i)rec=data[i],groupValue=me.getGroupString(rec),group=groups.get(groupValue),group||(group=new Ext.data.Group({key:groupValue,store:me}),groups.add(group)),group.add(rec)},clearGrouping:function(){var g,me=this,groupers=me.groupers.items,gLen=groupers.length;for(g=0;g<gLen;g++)me.sorters.remove(groupers[g]);me.groupers.clear(),me.remoteGroup?me.buffered?(me.data.clear(),me.loadPage(1,{groupChange:!0})):me.load({scope:me,callback:me.fireGroupChange}):(me.groups.clear(),me.sorters.length?me.sort():(me.fireEvent("datachanged",me),me.fireEvent("refresh",me)),me.fireGroupChange())},isGrouped:function(){return this.groupers.getCount()>0},fireGroupChange:function(){this.fireEvent("groupchange",this,this.groupers)},getGroups:function(requestGroupString){var record,groupStr,group,i,records=this.data.items,length=records.length,groups=[],pointers={};for(i=0;i<length;i++)record=records[i],groupStr=this.getGroupString(record),group=pointers[groupStr],void 0===group&&(group={name:groupStr,children:[]},groups.push(group),pointers[groupStr]=group),group.children.push(record);return requestGroupString?pointers[requestGroupString]:groups},getGroupsForGrouper:function(records,grouper){var oldValue,newValue,record,group,i,length=records.length,groups=[];for(i=0;i<length;i++)record=records[i],newValue=grouper.getGroupString(record),newValue!==oldValue&&(group={name:newValue,grouper:grouper,records:[]},groups.push(group)),group.records.push(record),oldValue=newValue;return groups},getGroupsForGrouperIndex:function(records,grouperIndex){var i,me=this,groupers=me.groupers,grouper=groupers.getAt(grouperIndex),groups=me.getGroupsForGrouper(records,grouper),length=groups.length;if(grouperIndex+1<groupers.length)for(i=0;i<length;i++)groups[i].children=me.getGroupsForGrouperIndex(groups[i].records,grouperIndex+1);for(i=0;i<length;i++)groups[i].depth=grouperIndex;return groups},getGroupData:function(sort){var me=this;return sort!==!1&&me.sort(),me.getGroupsForGrouperIndex(me.data.items,0)},getGroupString:function(instance){var group=this.groupers.first();return group?group.getGroupString(instance):""},insert:function(index,records){var i,len,record,out,me=this,sync=!1,defaults=me.modelDefaults;if(out=Ext.isIterable(records)?[]:records=[records],len=records.length){for(i=0;i<len;i++)record=records[i],record.isModel||(record=me.createModel(record)),out[i]=record,defaults&&record.set(defaults),record.join(me),sync=sync||record.phantom===!0;me.data.insert(index,out),me.snapshot&&me.snapshot.addAll(out),me.requireSort&&(me.suspendEvents(),me.sort(),me.resumeEvents()),me.isGrouped()&&me.updateGroupsOnAdd(out),me.fireEvent("add",me,out,index),me.fireEvent("datachanged",me),me.autoSync&&sync&&!me.autoSyncSuspended&&me.sync()}return out},updateGroupsOnAdd:function(records){var i,groupName,group,rec,me=this,groups=me.groups,len=records.length;for(i=0;i<len;++i)rec=records[i],groupName=me.getGroupString(rec),group=groups.getByKey(groupName),group||(group=groups.add(new Ext.data.Group({key:groupName,store:me}))),group.add(rec)},updateGroupsOnRemove:function(records){var i,groupName,group,rec,me=this,groups=me.groups,len=records.length;for(i=0;i<len;++i)rec=records[i],groupName=me.getGroupString(rec),group=groups.getByKey(groupName),group&&(group.remove(rec),0===group.records.length&&groups.remove(group))},updateGroupsOnUpdate:function(record,modifiedFieldNames){var len,i,items,group,me=this,groupField=me.getGroupField(),groupName=me.getGroupString(record),groups=me.groups;if(modifiedFieldNames&&Ext.Array.contains(modifiedFieldNames,groupField)){for(me.buffered&&Ext.Error.raise({msg:"Cannot move records between groups in a buffered store record"}),items=groups.items,i=0,len=items.length;i<len;++i)if(group=items[i],group.contains(record)){group.remove(record);break}group=groups.getByKey(groupName),group||(group=groups.add(new Ext.data.Group({key:groupName,store:me}))),group.add(record),me.data.remove(record),me.data.insert(me.data.findInsertionIndex(record,me.generateComparator()),record)}else groups.getByKey(groupName).setDirty()},add:function(arg){var records,length,isSorted,me=this;return records=Ext.isArray(arg)?arg:arguments,length=records.length,isSorted=!me.remoteSort&&me.sorters&&me.sorters.items.length,isSorted&&1===length?[me.addSorted(me.createModel(records[0]))]:(isSorted&&(me.requireSort=!0),records=me.insert(me.data.length,records),delete me.requireSort,records)},addSorted:function(record){var me=this,index=me.data.findInsertionIndex(record,me.generateComparator());return me.insert(index,record),record},createModel:function(record){return record.isModel||(record=Ext.ModelManager.create(record,this.model)),record},onUpdate:function(record,type,modifiedFieldNames){this.isGrouped()&&this.updateGroupsOnUpdate(record,modifiedFieldNames)},each:function(fn,scope){var record,d,data=this.data.items,dLen=data.length;for(d=0;d<dLen&&(record=data[d],fn.call(scope||record,record,d,dLen)!==!1);d++);},remove:function(records,isMove,silent){isMove=isMove===!0;var length,item,isNotPhantom,index,record,removeRange,removeCount,me=this,sync=!1,snapshot=me.snapshot,data=me.data,i=0,info=[],allRecords=[],indexes=[],fireRemoveEvent=!silent&&me.hasListeners.remove;if(records.isModel?(records=[records],length=1):Ext.isIterable(records)?length=records.length:"object"==typeof records&&(removeRange=!0,i=records.start,length=records.end+1,removeCount=length-i),!removeRange){for(i=0;i<length;++i)record=records[i],"number"==typeof record?(index=record,record=data.getAt(index)):index=me.indexOf(record),record&&index>-1&&info.push({record:record,index:index}),snapshot&&snapshot.remove(record);info=Ext.Array.sort(info,function(o1,o2){var index1=o1.index,index2=o2.index;return index1===o2.index2?0:index1<index2?-1:1}),i=0,length=info.length}if(length){for(;i<length;i++)removeRange?(record=data.getAt(i),index=i):(item=info[i],record=item.record,index=item.index),allRecords.push(record),indexes.push(index),isNotPhantom=record.phantom!==!0,!isMove&&isNotPhantom&&(record.removedFrom=index,
me.removed.push(record)),record.unjoin(me),index-=i,sync=sync||isNotPhantom,removeRange||(data.removeAt(index),fireRemoveEvent&&me.fireEvent("remove",me,record,index,!!isMove));removeRange&&data.removeRange(records.start,removeCount),silent||(me.fireEvent("bulkremove",me,allRecords,indexes,!!isMove),me.fireEvent("datachanged",me)),!isMove&&me.autoSync&&sync&&!me.autoSyncSuspended&&me.sync()}},removeAt:function(index,count){var me=this,storeCount=me.getCount();index<=storeCount&&(1===arguments.length?me.remove([index]):count&&me.remove({start:index,end:Math.min(index+count,storeCount)-1}))},removeAll:function(silent){var me=this,snapshot=me.snapshot,data=me.data;snapshot&&snapshot.removeAll(data.getRange()),me.buffered?data&&(silent&&me.suspendEvent("clear"),data.clear(),silent&&me.resumeEvent("clear")):(me.remove({start:0,end:me.getCount()-1},!1,silent),silent!==!0&&me.fireEvent("clear",me))},load:function(options){var me=this;return options="function"==typeof options?{callback:options}:Ext.apply({},options),me.remoteGroup&&!options.groupers&&me.groupers.items.length&&(options.groupers=me.groupers.items),options.page=options.page||me.currentPage,options.start=void 0!==options.start?options.start:(options.page-1)*me.pageSize,options.limit=options.limit||me.pageSize,options.addRecords=options.addRecords||!1,me.buffered?(options.limit=me.viewSize||me.defaultViewSize,options.loadCallback=options.callback,delete options.callback,me.loadToPrefetch(options)):me.callParent([options])},reload:function(options){var startIdx,endIdx,startPage,endPage,i,waitForReload,bufferZone,records,me=this;if(options||(options={}),!me.buffered)return me.callParent(arguments);if(delete me.totalCount,me.data.clear(!0),waitForReload=function(){me.rangeCached(startIdx,endIdx)&&(me.loading=!1,me.data.un("pageAdded",waitForReload),records=me.data.getRange(startIdx,endIdx),me.fireEvent("load",me,records,!0))},bufferZone=Math.ceil((me.leadingBufferZone+me.trailingBufferZone)/2),me.lastRequestStart?(startIdx=me.lastRequestStart,endIdx=me.lastRequestEnd):(startIdx=options.start||0,endIdx=startIdx+(options.count||me.pageSize)-1),startPage=me.getPageFromRecordIndex(Math.max(startIdx-bufferZone,0)),endPage=me.getPageFromRecordIndex(endIdx+bufferZone),me.fireEvent("beforeload",me,options)!==!1)for(me.loading=!0,me.data.on("pageAdded",waitForReload),i=startPage;i<=endPage;i++)me.prefetchPage(i,options)},onProxyLoad:function(operation){var me=this,resultSet=operation.getResultSet(),records=operation.getRecords(),successful=operation.wasSuccessful();me.isDestroyed||(resultSet&&(me.totalCount=resultSet.total),me.loading=!1,successful&&me.loadRecords(records,operation),me.hasListeners.load&&me.fireEvent("load",me,records,successful),me.hasListeners.read&&me.fireEvent("read",me,records,successful),Ext.callback(operation.callback,operation.scope||me,[records,operation,successful]))},getNewRecords:function(){return(this.snapshot||this.data).filterBy(this.filterNew).items},getUpdatedRecords:function(){return(this.snapshot||this.data).filterBy(this.filterUpdated).items},filter:function(filters,value){Ext.isString(filters)&&(filters={property:filters,value:value});var i,me=this,decoded=me.decodeFilters(filters),doLocalSort=me.sorters.length&&me.sortOnFilter&&!me.remoteSort,length=decoded.length;for(i=0;i<length;i++)me.filters.replace(decoded[i]);filters=me.filters.items,filters.length&&(me.remoteFilter?(delete me.totalCount,me.buffered?(me.data.clear(),me.loadPage(1)):(me.currentPage=1,me.load())):(me.snapshot=me.snapshot||me.data.clone(),me.data=me.snapshot.filter(filters),me.constructGroups(),doLocalSort?me.sort():(me.fireEvent("datachanged",me),me.fireEvent("refresh",me))),me.fireEvent("filterchange",me,filters))},clearFilter:function(suppressEvent){var me=this;if(me.filters.clear(),me.remoteFilter){if(suppressEvent)return;delete me.totalCount,me.buffered?(me.data.clear(),me.loadPage(1)):(me.currentPage=1,me.load())}else me.isFiltered()&&(me.data=me.snapshot,delete me.snapshot,me.constructGroups(),suppressEvent!==!0&&(me.fireEvent("datachanged",me),me.fireEvent("refresh",me)));me.fireEvent("filterchange",me,me.filters.items)},removeFilter:function(toRemove,applyFilters){var me=this;!me.remoteFilter&&me.isFiltered()&&(toRemove instanceof Ext.util.Filter?me.filters.remove(toRemove):me.filters.removeAtKey(toRemove),applyFilters!==!1?me.filters.length?me.filter():me.clearFilter():me.fireEvent("filterchange",me,me.filters.items))},addFilter:function(filters,applyFilters){var decoded,i,length,me=this;for(decoded=me.decodeFilters(filters),length=decoded.length,i=0;i<length;i++)me.filters.replace(decoded[i]);applyFilters!==!1&&me.filters.length?me.filter():me.fireEvent("filterchange",me,me.filters.items)},isFiltered:function(){var snapshot=this.snapshot;return!(!snapshot||snapshot===this.data)},filterBy:function(fn,scope){var me=this;me.snapshot=me.snapshot||me.data.clone(),me.data=me.queryBy(fn,scope||me),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)},queryBy:function(fn,scope){var me=this;return(me.snapshot||me.data).filterBy(fn,scope||me)},query:function(property,value,anyMatch,caseSensitive,exactMatch){var me=this,queryFn=me.createFilterFn(property,value,anyMatch,caseSensitive,exactMatch),results=me.queryBy(queryFn);return results||(results=new Ext.util.MixedCollection),results},loadData:function(data,append){var i,length=data.length,newData=[];for(i=0;i<length;i++)newData.push(this.createModel(data[i]));this.loadRecords(newData,append?this.addRecordsOptions:void 0)},loadRawData:function(data,append){var me=this,result=me.proxy.reader.read(data),records=result.records;result.success&&(me.totalCount=result.total,me.loadRecords(records,append?me.addRecordsOptions:void 0))},loadRecords:function(records,options){var start,addRecords,me=this,i=0,length=records.length,snapshot=me.snapshot;if(options&&(start=options.start,addRecords=options.addRecords),addRecords?snapshot&&snapshot.addAll(records):(delete me.snapshot,me.clearData(!0)),me.data.addAll(records),void 0!==start)for(;i<length;i++)records[i].index=start+i,records[i].join(me);else for(;i<length;i++)records[i].join(me);me.suspendEvents(),me.filterOnLoad&&!me.remoteFilter&&me.filter(),me.sortOnLoad&&!me.remoteSort&&me.sort(void 0,void 0,void 0,!0),me.resumeEvents(),me.isGrouped()&&me.constructGroups(),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)},loadPage:function(page,options){var me=this;return me.currentPage=page,options=Ext.apply({page:page,start:(page-1)*me.pageSize,limit:me.pageSize,addRecords:!me.clearOnPageLoad},options),me.buffered?(options.limit=me.viewSize||me.defaultViewSize,options.loadCallback=options.callback,delete options.callback,me.loadToPrefetch(options)):void me.read(options)},nextPage:function(options){this.loadPage(this.currentPage+1,options)},previousPage:function(options){this.loadPage(this.currentPage-1,options)},clearData:function(isLoad){var records,i,me=this;if(!me.buffered&&me.data)for(records=me.data.items,i=records.length;i--;)records[i].unjoin(me);me.data&&me.data.clear(),(isLoad!==!0||me.clearRemovedOnLoad)&&(me.removed.length=0)},loadToPrefetch:function(options){var i,records,dataSetSize,operation,me=this,prefetchOptions=options,startIdx=options.start,endIdx=options.start+options.limit-1,loadEndIdx=Math.min(endIdx,options.start+(me.viewSize||options.limit)-1),startPage=me.getPageFromRecordIndex(Math.max(startIdx-me.trailingBufferZone,0)),endPage=me.getPageFromRecordIndex(endIdx+me.leadingBufferZone),waitForRequestedRange=function(){me.rangeCached(startIdx,loadEndIdx)&&(me.loading=!1,records=me.data.getRange(startIdx,loadEndIdx),me.data.un("pageAdded",waitForRequestedRange),me.hasListeners.guaranteedrange&&me.guaranteeRange(startIdx,loadEndIdx,options.callback,options.scope),options.loadCallback&&options.loadCallback.call(options.scope||me,records,operation,!0),options.callback&&options.callback.call(options.scope||me,records,startIdx,endIdx,options),me.fireEvent("datachanged",me),me.fireEvent("refresh",me),me.fireEvent("load",me,records,!0),options.groupChange&&me.fireGroupChange())};me.fireEvent("beforeload",me,options)!==!1&&(delete me.totalCount,me.loading=!0,options.callback&&(prefetchOptions=Ext.apply({},options),delete prefetchOptions.callback),me.on("prefetch",function(store,records,successful,op){if(successful)if(operation=op,dataSetSize=me.getTotalCount())for(me.data.on("pageAdded",waitForRequestedRange),loadEndIdx=Math.min(loadEndIdx,dataSetSize-1),endPage=me.getPageFromRecordIndex(Math.min(loadEndIdx+me.leadingBufferZone,dataSetSize-1)),i=startPage+1;i<=endPage;++i)me.prefetchPage(i,prefetchOptions);else me.fireEvent("datachanged",me),me.fireEvent("refresh",me),me.fireEvent("load",me,records,!0);else me.fireEvent("load",me,records,!1)},null,{single:!0}),me.prefetchPage(startPage,prefetchOptions))},prefetch:function(options){var proxy,operation,me=this,pageSize=me.pageSize;return pageSize?(me.lastPageSize&&pageSize!=me.lastPageSize&&Ext.Error.raise("pageSize cannot be dynamically altered"),me.data.pageSize||(me.data.pageSize=pageSize)):me.pageSize=me.data.pageSize=pageSize=options.limit,me.lastPageSize=pageSize,options.page||(options.page=me.getPageFromRecordIndex(options.start),options.start=(options.page-1)*pageSize,options.limit=Math.ceil(options.limit/pageSize)*pageSize),me.pageRequests[options.page]||(options=Ext.apply({action:"read",filters:me.filters.items,sorters:me.sorters.items,groupers:me.groupers.items,pageMapGeneration:me.data.pageMapGeneration},options),operation=new Ext.data.Operation(options),me.fireEvent("beforeprefetch",me,operation)!==!1&&(proxy=me.proxy,me.pageRequests[options.page]=proxy.read(operation,me.onProxyPrefetch,me),proxy.isSynchronous&&delete me.pageRequests[options.page])),me},onPageMapClear:function(){var req,page,me=this,loadingFlag=me.wasLoading,reqs=me.pageRequests;me.data.events.pageadded&&me.data.events.pageadded.clearListeners(),me.loading=!0,me.totalCount=0;for(page in reqs)reqs.hasOwnProperty(page)&&(req=reqs[page],delete reqs[page],delete req.callback);me.fireEvent("clear",me),me.loading=loadingFlag},prefetchPage:function(page,options){var me=this,pageSize=me.pageSize||me.defaultPageSize,start=(page-1)*me.pageSize,total=me.totalCount;void 0!==total&&me.getCount()===total||me.prefetch(Ext.applyIf({page:page,start:start,limit:pageSize},options))},onProxyPrefetch:function(operation){var me=this,resultSet=operation.getResultSet(),records=operation.getRecords(),successful=operation.wasSuccessful(),page=operation.page;operation.pageMapGeneration===me.data.pageMapGeneration&&(resultSet&&(me.totalCount=resultSet.total,me.fireEvent("totalcountchange",me.totalCount)),void 0!==page&&delete me.pageRequests[page],me.loading=!1,me.fireEvent("prefetch",me,records,successful,operation),successful&&me.cachePage(records,operation.page),Ext.callback(operation.callback,operation.scope||me,[records,operation,successful]))},cachePage:function(records,page){var i,me=this,len=records.length;for(Ext.isDefined(me.totalCount)||(me.totalCount=records.length,me.fireEvent("totalcountchange",me.totalCount)),i=0;i<len;i++)records[i].join(me);me.data.addPage(page,records)},rangeCached:function(start,end){return this.data&&this.data.hasRange(start,end)},pageCached:function(page){return this.data&&this.data.hasPage(page)},pagePending:function(page){return!!this.pageRequests[page]},rangeSatisfied:function(start,end){return this.rangeCached(start,end)},getPageFromRecordIndex:function(index){return Math.floor(index/this.pageSize)+1},onGuaranteedRange:function(options){var range,me=this,totalCount=me.getTotalCount(),start=options.prefetchStart,end=options.prefetchEnd>totalCount-1?totalCount-1:options.prefetchEnd;end=Math.max(0,end),range=me.data.getRange(start,end),options.fireEvent!==!1&&me.fireEvent("guaranteedrange",range,start,end,options),options.callback&&options.callback.call(options.scope||me,range,start,end,options)},guaranteeRange:function(start,end,callback,scope,options){options=Ext.apply({callback:callback,scope:scope},options),this.getRange(start,end,options)},prefetchRange:function(start,end){var startPage,endPage,page,me=this;if(!me.rangeCached(start,end))for(startPage=me.getPageFromRecordIndex(start),endPage=me.getPageFromRecordIndex(end),me.data.maxSize=me.purgePageCount?endPage-startPage+1+me.purgePageCount:0,page=startPage;page<=endPage;page++)me.pageCached(page)||me.prefetchPage(page)},primeCache:function(start,end,direction){var me=this;direction===-1?(start=Math.max(start-me.leadingBufferZone,0),end=Math.min(end+me.trailingBufferZone,me.totalCount-1)):1===direction?(start=Math.max(Math.min(start-me.trailingBufferZone,me.totalCount-me.pageSize),0),end=Math.min(end+me.leadingBufferZone,me.totalCount-1)):(start=Math.min(Math.max(Math.floor(start-(me.leadingBufferZone+me.trailingBufferZone)/2),0),me.totalCount-me.pageSize),end=Math.min(Math.max(Math.ceil(end+(me.leadingBufferZone+me.trailingBufferZone)/2),0),me.totalCount-1)),me.prefetchRange(start,end)},sort:function(sorters){var me=this;return sorters&&me.buffered&&me.remoteSort&&me.data.clear(),me.callParent(arguments)},doSort:function(sorterFn){var range,ln,i,me=this;if(me.remoteSort)me.buffered?(me.data.clear(),me.loadPage(1)):me.load();else{if(me.data.sortBy(sorterFn),!me.buffered)for(range=me.getRange(),ln=range.length,i=0;i<ln;i++)range[i].index=i;me.fireEvent("datachanged",me),me.fireEvent("refresh",me)}},find:function(property,value,start,anyMatch,caseSensitive,exactMatch){var fn=this.createFilterFn(property,value,anyMatch,caseSensitive,exactMatch);return fn?this.data.findIndexBy(fn,null,start):-1},findRecord:function(){var me=this,index=me.find.apply(me,arguments);return index!==-1?me.getAt(index):null},createFilterFn:function(property,value,anyMatch,caseSensitive,exactMatch){return!Ext.isEmpty(value)&&(value=Ext.util.AbstractMixedCollection.prototype.createValueMatcher(value,anyMatch,caseSensitive,exactMatch),function(r){return value.test(r.data[property])})},findExact:function(property,value,start){return this.data.findIndexBy(function(rec){return rec.isEqual(rec.get(property),value)},this,start)},findBy:function(fn,scope,start){return this.data.findIndexBy(fn,scope,start)},collect:function(dataIndex,allowNull,bypassFilter){var me=this,data=bypassFilter===!0&&me.snapshot?me.snapshot:me.data;return data.collect(dataIndex,"data",allowNull)},getCount:function(){return this.data.getCount()},getTotalCount:function(){return this.totalCount||0},getAt:function(index){return this.data.getAt(index)},getRange:function(start,end,options){var requiredStart,requiredEnd,pageAddHandler,result,me=this,maxIndex=me.totalCount-1,lastRequestStart=me.lastRequestStart;return options=Ext.apply({prefetchStart:start,prefetchEnd:end},options),me.buffered?(end=end>=me.totalCount?maxIndex:end,requiredStart=0===start?0:start-1,requiredEnd=end===maxIndex?end:end+1,me.lastRequestStart=start,me.lastRequestEnd=end,me.rangeCached(requiredStart,requiredEnd)?(me.onGuaranteedRange(options),result=me.data.getRange(start,end)):(me.fireEvent("cachemiss",me,start,end),pageAddHandler=function(page,records){me.rangeCached(requiredStart,requiredEnd)&&(me.fireEvent("cachefilled",me,start,end),me.data.un("pageAdded",pageAddHandler),me.onGuaranteedRange(options))},me.data.on("pageAdded",pageAddHandler),me.prefetchRange(start,end)),me.primeCache(start,end,start<lastRequestStart?-1:1)):(result=me.data.getRange(start,end),options.callback&&options.callback.call(options.scope||me,result,start,end,options)),result},getById:function(id){var result=(this.snapshot||this.data).findBy(function(record){return record.getId()===id});return result},getByInternalId:function(internalId){var result;return result=this.buffered?(this.snapshot||this.data).findBy(function(record){return record.internalId===internalId}):this.data.get(internalId)},indexOf:function(record){return this.data.indexOf(record)},indexOfTotal:function(record){var index=record.index;return index||0===index?index:this.indexOf(record)},indexOfId:function(id){return this.indexOf(this.getById(id))},first:function(grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(function(records){return records.length?records[0]:void 0},me,!0):me.data.first()},last:function(grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(function(records){var len=records.length;return len?records[len-1]:void 0},me,!0):me.data.last()},sum:function(field,grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(me.getSum,me,!0,[field]):me.getSum(me.data.items,field)},getSum:function(records,field){for(var total=0,i=0,len=records.length;i<len;++i)total+=records[i].get(field);return total},count:function(grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(function(records){return records.length},me,!0):me.getCount()},min:function(field,grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(me.getMin,me,!0,[field]):me.getMin(me.data.items,field)},getMin:function(records,field){var value,min,i=1,len=records.length;for(len>0&&(min=records[0].get(field));i<len;++i)value=records[i].get(field),value<min&&(min=value);return min},max:function(field,grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(me.getMax,me,!0,[field]):me.getMax(me.data.items,field)},getMax:function(records,field){var value,max,i=1,len=records.length;for(len>0&&(max=records[0].get(field));i<len;++i)value=records[i].get(field),value>max&&(max=value);return max},average:function(field,grouped){var me=this;return grouped&&me.isGrouped()?me.aggregate(me.getAverage,me,!0,[field]):me.getAverage(me.data.items,field)},getAverage:function(records,field){var i=0,len=records.length,sum=0;if(records.length>0){for(;i<len;++i)sum+=records[i].get(field);return sum/len}return 0},aggregate:function(fn,scope,grouped,args){if(args=args||[],grouped&&this.isGrouped()){var group,i,groups=this.getGroups(),len=groups.length,out={};for(i=0;i<len;++i)group=groups[i],out[group.name]=this.getAggregate(fn,scope||this,group.children,args);return out}return this.getAggregate(fn,scope,this.data.items,args)},getAggregate:function(fn,scope,records,args){return args=args||[],fn.apply(scope||this,[records].concat(args))},onIdChanged:function(rec,oldId,newId,oldInternalId){var snapshot=this.snapshot;snapshot&&snapshot.updateKey(oldInternalId,newId),this.data.updateKey(oldInternalId,newId),this.callParent(arguments)},commitChanges:function(){for(var me=this,recs=me.getModifiedRecords(),len=recs.length,i=0;i<len;i++)recs[i].commit();me.removed.length=0},filterNewOnly:function(item){return item.phantom===!0},getRejectRecords:function(){return Ext.Array.push(this.data.filterBy(this.filterNewOnly).items,this.getUpdatedRecords())},rejectChanges:function(){for(var rec,me=this,recs=me.getRejectRecords(),len=recs.length,i=0;i<len;i++)rec=recs[i],rec.reject(),rec.phantom&&me.remove(rec);for(recs=me.removed,len=recs.length,i=len-1;i>=0;i--)rec=recs[i],me.insert(rec.removedFrom||0,rec),rec.reject();me.removed.length=0}},function(){Ext.regStore("ext-empty-store",{fields:[],proxy:"memory"})}),Ext.define("Ext.data.reader.Array",{extend:Ext.data.reader.Json,alternateClassName:"Ext.data.ArrayReader",alias:"reader.array",totalProperty:void 0,successProperty:void 0,createFieldAccessExpression:function(field,fieldVarName,dataName){var result,index=null==field.mapping?field.originalIndex:field.mapping;return"function"==typeof index?result=fieldVarName+".mapping("+dataName+", this)":(isNaN(index)&&(index='"'+index+'"'),result=dataName+"["+index+"]"),result}}),Ext.define("Ext.data.ArrayStore",{extend:Ext.data.Store,alias:"store.array",constructor:function(config){config=Ext.apply({proxy:{type:"memory",reader:"array"}},config),this.callParent([config])},loadData:function(data,append){if(this.expandData===!0){for(var r=[],i=0,ln=data.length;i<ln;i++)r[r.length]=[data[i]];data=r}this.callParent([data,append])}},function(){Ext.data.SimpleStore=Ext.data.ArrayStore}),Ext.define("Ext.data.Batch",{mixins:{observable:Ext.util.Observable},autoStart:!1,pauseOnException:!1,current:-1,total:0,isRunning:!1,isComplete:!1,hasException:!1,constructor:function(config){var me=this;me.mixins.observable.constructor.call(me,config),me.operations=[],me.exceptions=[]},add:function(operation){return this.total++,operation.setBatch(this),this.operations.push(operation),this},start:function(index){var me=this;return me.isRunning?me:(me.exceptions.length=0,me.hasException=!1,me.isRunning=!0,me.runOperation(Ext.isDefined(index)?index:me.current+1))},retry:function(){return this.start(this.current)},runNextOperation:function(){return this.runOperation(this.current+1)},pause:function(){return this.isRunning=!1,this},runOperation:function(index){var onProxyReturn,me=this,operations=me.operations,operation=operations[index];return void 0===operation?(me.isRunning=!1,me.isComplete=!0,me.fireEvent("complete",me,operations[operations.length-1])):(me.current=index,onProxyReturn=function(operation){var hasException=operation.hasException();hasException&&(me.hasException=!0,me.exceptions.push(operation),me.fireEvent("exception",me,operation)),hasException&&me.pauseOnException?me.pause():(operation.setCompleted(),me.fireEvent("operationcomplete",me,operation),me.runNextOperation())},operation.setStarted(),me.proxy[operation.action](operation,onProxyReturn,me)),me}}),Ext.define("Ext.data.BufferStore",{extend:Ext.data.Store,alias:"store.buffer",sortOnLoad:!1,filterOnLoad:!1,constructor:function(){Ext.Error.raise("The BufferStore class has been deprecated. Instead, specify the buffered config option on Ext.data.Store")}}),Ext.define("Ext.direct.Manager",{singleton:!0,mixins:{observable:Ext.util.Observable},exceptions:{TRANSPORT:"xhr",PARSE:"parse",DATA:"data",LOGIN:"login",SERVER:"exception"},constructor:function(){var me=this;me.addEvents("event","exception"),me.transactions=new Ext.util.MixedCollection,me.providers=new Ext.util.MixedCollection,me.mixins.observable.constructor.call(me)},addProvider:function(provider){var i,len,me=this,args=arguments,relayers=me.relayers||(me.relayers={});{if(!(args.length>1))return provider.isProvider||(provider=Ext.create("direct."+provider.type+"provider",provider)),me.providers.add(provider),provider.on("data",me.onProviderData,me),provider.relayedEvents&&(relayers[provider.id]=me.relayEvents(provider,provider.relayedEvents)),provider.isConnected()||provider.connect(),provider;for(i=0,len=args.length;i<len;++i)me.addProvider(args[i])}},getProvider:function(id){return id.isProvider?id:this.providers.get(id)},removeProvider:function(provider){var id,me=this,providers=me.providers,relayers=me.relayers;return provider=provider.isProvider?provider:providers.get(provider),provider?(provider.un("data",me.onProviderData,me),id=provider.id,relayers[id]&&(relayers[id].destroy(),delete relayers[id]),providers.remove(provider),provider):null},addTransaction:function(transaction){return this.transactions.add(transaction),transaction},removeTransaction:function(transaction){var me=this;return transaction=me.getTransaction(transaction),me.transactions.remove(transaction),transaction},getTransaction:function(transaction){return"object"==typeof transaction?transaction:this.transactions.get(transaction)},onProviderData:function(provider,event){var i,len,me=this;if(Ext.isArray(event))for(i=0,len=event.length;i<len;++i)me.onProviderData(provider,event[i]);else event.name&&"event"!=event.name&&"exception"!=event.name?me.fireEvent(event.name,event):event.status===!1&&me.fireEvent("exception",event),me.fireEvent("event",event,provider)},parseMethod:function(fn){if(Ext.isString(fn)){for(var parts=fn.split("."),i=0,len=parts.length,current=Ext.global;current&&i<len;)current=current[parts[i]],++i;fn=Ext.isFunction(current)?current:null}return fn||null}},function(){Ext.Direct=Ext.direct.Manager}),Ext.define("Ext.data.proxy.Direct",{extend:Ext.data.proxy.Server,alternateClassName:"Ext.data.DirectProxy",alias:"proxy.direct",paramOrder:void 0,paramsAsHash:!0,directFn:void 0,paramOrderRe:/[\s,|]/,constructor:function(config){var paramOrder,me=this;me.callParent(arguments),paramOrder=me.paramOrder,Ext.isString(paramOrder)&&(me.paramOrder=paramOrder.split(me.paramOrderRe))},resolveMethods:function(){var method,me=this,fn=me.directFn,api=me.api,Manager=Ext.direct.Manager;if(fn)method=me.directFn=Manager.parseMethod(fn),Ext.isFunction(method)||Ext.Error.raise("Cannot resolve directFn "+fn);else if(api)for(fn in api)api.hasOwnProperty(fn)&&(method=api[fn],api[fn]=Manager.parseMethod(method),Ext.isFunction(api[fn])||Ext.Error.raise("Cannot resolve Direct api "+fn+" method "+method));me.methodsResolved=!0},doRequest:function(operation,callback,scope){var fn,method,me=this,writer=me.getWriter(),request=me.buildRequest(operation),params=request.params,args=[];me.methodsResolved||me.resolveMethods(),fn=me.api[request.action]||me.directFn,operation.allowWrite()&&(request=writer.write(request)),"read"==operation.action?(method=fn.directCfg.method,args=method.getArgs(params,me.paramOrder,me.paramsAsHash)):args.push(request.jsonData),Ext.apply(request,{args:args,directFn:fn}),args.push(me.createRequestCallback(request,operation,callback,scope),me),fn.apply(window,args)},applyEncoding:Ext.identityFn,createRequestCallback:function(request,operation,callback,scope){var me=this;return function(data,event){me.processResponse(event.status,operation,request,event,callback,scope)}},extractResponseData:function(response){return Ext.isDefined(response.result)?response.result:response.data},setException:function(operation,response){operation.setException(response.message)},buildUrl:function(){return""}}),Ext.define("Ext.data.DirectStore",{extend:Ext.data.Store,alias:"store.direct",constructor:function(config){if(config=Ext.apply({},config),!config.proxy){var proxy={type:"direct",reader:{type:"json"}};Ext.copyTo(proxy,config,"paramOrder,paramsAsHash,directFn,api,simpleSortMode"),Ext.copyTo(proxy.reader,config,"totalProperty,root,idProperty"),config.proxy=proxy}this.callParent([config])}}),Ext.define("Ext.data.JsonP",{singleton:!0,requestCount:0,requests:{},timeout:3e4,disableCaching:!0,disableCachingParam:"_dc",callbackKey:"callback",request:function(options){options=Ext.apply({},options);var request,script,me=this,disableCaching=Ext.isDefined(options.disableCaching)?options.disableCaching:me.disableCaching,cacheParam=options.disableCachingParam||me.disableCachingParam,id=++me.requestCount,callbackName=options.callbackName||"callback"+id,callbackKey=options.callbackKey||me.callbackKey,timeout=Ext.isDefined(options.timeout)?options.timeout:me.timeout,params=Ext.apply({},options.params),url=options.url,name=Ext.name;return disableCaching&&!params[cacheParam]&&(params[cacheParam]=Ext.Date.now()),options.params=params,params[callbackKey]=name+".data.JsonP."+callbackName,script=me.createScript(url,params,options),me.requests[id]=request={url:url,params:params,script:script,id:id,scope:options.scope,success:options.success,failure:options.failure,callback:options.callback,callbackKey:callbackKey,callbackName:callbackName},timeout>0&&(request.timeout=setTimeout(Ext.bind(me.handleTimeout,me,[request]),timeout)),me.setupErrorHandling(request),me[callbackName]=Ext.bind(me.handleResponse,me,[request],!0),me.loadScript(request),request},abort:function(request){var key,me=this,requests=me.requests;if(request)request.id||(request=requests[request]),me.handleAbort(request);else for(key in requests)requests.hasOwnProperty(key)&&me.abort(requests[key])},setupErrorHandling:function(request){request.script.onerror=Ext.bind(this.handleError,this,[request])},handleAbort:function(request){request.errorType="abort",this.handleResponse(null,request)},handleError:function(request){request.errorType="error",this.handleResponse(null,request)},cleanupErrorHandling:function(request){request.script.onerror=null},handleTimeout:function(request){request.errorType="timeout",this.handleResponse(null,request)},handleResponse:function(result,request){var success=!0;request.timeout&&clearTimeout(request.timeout),delete this[request.callbackName],delete this.requests[request.id],this.cleanupErrorHandling(request),Ext.fly(request.script).remove(),request.errorType?(success=!1,Ext.callback(request.failure,request.scope,[request.errorType])):Ext.callback(request.success,request.scope,[result]),Ext.callback(request.callback,request.scope,[success,result,request.errorType]),Ext.EventManager.idleEvent.fire()},createScript:function(url,params,options){var script=document.createElement("script");return script.setAttribute("src",Ext.urlAppend(url,Ext.Object.toQueryString(params))),script.setAttribute("async",!0),script.setAttribute("type","text/javascript"),script},loadScript:function(request){Ext.getHead().appendChild(request.script)}}),Ext.define("Ext.data.proxy.JsonP",{extend:Ext.data.proxy.Server,alternateClassName:"Ext.data.ScriptTagProxy",alias:["proxy.jsonp","proxy.scripttag"],defaultWriterType:"base",callbackKey:"callback",recordParam:"records",autoAppendParams:!0,constructor:function(){this.addEvents("exception"),this.callParent(arguments)},doRequest:function(operation,callback,scope){var me=this,request=me.buildRequest(operation),params=request.params;return Ext.apply(request,{callbackKey:me.callbackKey,timeout:me.timeout,scope:me,disableCaching:!1,callback:me.createRequestCallback(request,operation,callback,scope)}),me.autoAppendParams&&(request.params={}),request.jsonp=Ext.data.JsonP.request(request),request.params=params,operation.setStarted(),me.lastRequest=request,request},createRequestCallback:function(request,operation,callback,scope){var me=this;return function(success,response,errorType){delete me.lastRequest,me.processResponse(success,operation,request,response,callback,scope)}},setException:function(operation,response){operation.setException(operation.request.jsonp.errorType)},buildUrl:function(request){var params,filters,filter,i,me=this,url=me.callParent(arguments),records=request.records,writer=me.getWriter();if(writer&&request.operation.allowWrite()&&(request=writer.write(request)),params=request.params,filters=params.filters,delete params.filters,filters&&filters.length)for(i=0;i<filters.length;i++)filter=filters[i],filter.value&&(params[filter.property]=filter.value);return(!writer||!writer.encode)&&Ext.isArray(records)&&records.length>0&&(params[me.recordParam]=me.encodeRecords(records)),me.autoAppendParams&&(url=Ext.urlAppend(url,Ext.Object.toQueryString(params))),url},abort:function(){var lastRequest=this.lastRequest;lastRequest&&Ext.data.JsonP.abort(lastRequest.jsonp)},encodeRecords:function(records){for(var encoded=[],i=0,len=records.length;i<len;i++)encoded.push(Ext.encode(records[i].getData()));return encoded}}),Ext.define("Ext.data.JsonPStore",{extend:Ext.data.Store,alias:"store.jsonp",constructor:function(config){config=Ext.apply({proxy:{type:"jsonp",reader:"json"}},config),this.callParent([config])}}),Ext.define("Ext.data.JsonStore",{extend:Ext.data.Store,alias:"store.json",constructor:function(config){config=Ext.apply({proxy:{type:"ajax",reader:"json",writer:"json"}},config),this.callParent([config])}}),Ext.define("Ext.data.NodeInterface",{statics:{decorate:function(modelClass){var idName,idField,idType;"string"==typeof modelClass?modelClass=Ext.ModelManager.getModel(modelClass):modelClass.isModel&&(modelClass=Ext.ModelManager.getModel(modelClass.modelName)),modelClass.prototype.isNode||(idName=modelClass.prototype.idProperty,idField=modelClass.prototype.fields.get(idName),idType=modelClass.prototype.fields.get(idName).type.type,modelClass.override(this.getPrototypeBody()),this.applyFields(modelClass,[{name:"parentId",type:idType,defaultValue:null,useNull:idField.useNull},{name:"index",type:"int",defaultValue:-1,persist:!1,convert:null},{name:"depth",type:"int",defaultValue:0,persist:!1,convert:null},{name:"expanded",type:"bool",defaultValue:!1,persist:!1,convert:null},{name:"expandable",type:"bool",defaultValue:!0,persist:!1,convert:null},{name:"checked",
type:"auto",defaultValue:null,persist:!1,convert:null},{name:"leaf",type:"bool",defaultValue:!1},{name:"cls",type:"string",defaultValue:"",persist:!1,convert:null},{name:"iconCls",type:"string",defaultValue:"",persist:!1,convert:null},{name:"icon",type:"string",defaultValue:"",persist:!1,convert:null},{name:"root",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"isLast",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"isFirst",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"allowDrop",type:"boolean",defaultValue:!0,persist:!1,convert:null},{name:"allowDrag",type:"boolean",defaultValue:!0,persist:!1,convert:null},{name:"loaded",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"loading",type:"boolean",defaultValue:!1,persist:!1,convert:null},{name:"href",type:"string",defaultValue:"",persist:!1,convert:null},{name:"hrefTarget",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qtip",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qtitle",type:"string",defaultValue:"",persist:!1,convert:null},{name:"qshowDelay",type:"int",defaultValue:0,persist:!1,convert:null},{name:"children",type:"auto",defaultValue:null,persist:!1,convert:null}]))},applyFields:function(modelClass,addFields){var addField,i,modelPrototype=modelClass.prototype,fields=modelPrototype.fields,keys=fields.keys,ln=addFields.length;for(i=0;i<ln;i++)addField=addFields[i],Ext.Array.contains(keys,addField.name)||fields.add(new Ext.data.Field(addField))},getPrototypeBody:function(){var bubbledEvents={idchanged:!0,append:!0,remove:!0,bulkremove:!0,move:!0,insert:!0,beforeappend:!0,beforeremove:!0,beforemove:!0,beforeinsert:!0,expand:!0,collapse:!0,beforeexpand:!0,beforecollapse:!0,sort:!0,rootchange:!0};return{isNode:!0,constructor:function(){var me=this;return me.callParent(arguments),me.firstChild=me.lastChild=me.parentNode=me.previousSibling=me.nextSibling=null,me.childNodes=[],me},createNode:function(node){return node.isModel||(node=Ext.ModelManager.create(node,this.modelName)),node.childNodes||(node.firstChild=node.lastChild=node.parentNode=node.previousSibling=node.nextSibling=null,node.childNodes=[]),node},isLeaf:function(){return this.get("leaf")===!0},setFirstChild:function(node){this.firstChild=node},setLastChild:function(node){this.lastChild=node},updateInfo:function(commit,info){var i,propName,newValue,field,currentValue,key,settingIndexInNewParent,persistentField,me=this,oldDepth=me.data.depth,childInfo={},children=me.childNodes,childCount=children.length,phantom=me.phantom,dataObject=me[me.persistenceProperty],fields=me.fields,modified=me.modified,newParentId=info.parentId;info||Ext.Error.raise("NodeInterface expects update info to be passed");for(propName in info)if(field=fields.get(propName),newValue=info[propName],persistentField=field&&field.persist,currentValue=dataObject[propName],settingIndexInNewParent=persistentField&&"index"===propName&&currentValue!==-1&&newParentId&&newParentId!==modified.parentId,(settingIndexInNewParent||!me.isEqual(currentValue,newValue))&&(dataObject[propName]=newValue,persistentField))if(!settingIndexInNewParent&&modified.hasOwnProperty(propName)){if(me.isEqual(modified[propName],newValue)){delete modified[propName],me.dirty=!1;for(key in modified)if(modified.hasOwnProperty(key)){me.dirty=!0;break}}}else me.dirty=!0,modified[propName]=currentValue;if(commit&&(me.commit(),me.phantom=phantom),me.data.depth!==oldDepth)for(childInfo={depth:me.data.depth+1},i=0;i<childCount;i++)children[i].updateInfo(commit,childInfo)},isLast:function(){return this.get("isLast")},isFirst:function(){return this.get("isFirst")},hasChildNodes:function(){return!this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){var me=this;return!!me.get("expandable")&&!(me.isLeaf()||me.isLoaded()&&!me.phantom&&!me.hasChildNodes())},triggerUIUpdate:function(){this.afterEdit([])},appendChild:function(node,suppressEvents,commit){var i,ln,index,oldParent,previousSibling,me=this,childInfo={isLast:!0,parentId:me.getId(),depth:(me.data.depth||0)+1};if(!Ext.isArray(node)){if(node=me.createNode(node),suppressEvents!==!0&&me.fireEventArgs("beforeappend",[me,node])===!1)return!1;if(index=me.childNodes.length,oldParent=node.parentNode){if(suppressEvents!==!0&&node.fireEventArgs("beforemove",[node,oldParent,me,index])===!1)return!1;oldParent.removeChild(node,!1,!1,!0)}return Ext.suspendLayouts(),index=me.childNodes.length,0===index&&me.setFirstChild(node),me.childNodes[index]=node,node.parentNode=me,node.nextSibling=null,me.setLastChild(node),previousSibling=me.childNodes[index-1],previousSibling?(node.previousSibling=previousSibling,previousSibling.nextSibling=node,previousSibling.updateInfo(commit,{isLast:!1}),previousSibling.triggerUIUpdate()):node.previousSibling=null,childInfo.isFirst=0===index,childInfo.index=index,node.updateInfo(commit,childInfo),me.isLoaded()?1===me.childNodes.length&&me.triggerUIUpdate():me.set("loaded",!0),index&&me.childNodes[index-1].isExpanded()&&me.childNodes[index-1].cascadeBy(me.triggerUIUpdate),!node.isLeaf()&&node.phantom&&node.set("loaded",!0),Ext.resumeLayouts(!0),suppressEvents!==!0&&(me.fireEventArgs("append",[me,node,index]),oldParent&&node.fireEventArgs("move",[node,oldParent,me,index])),node}for(me.callStore("suspendAutoSync"),i=0,ln=node.length-1;i<ln;i++)me.appendChild(node[i],suppressEvents,commit);me.callStore("resumeAutoSync"),me.appendChild(node[ln],suppressEvents,commit)},getOwnerTree:function(){for(var store,node=this;node.parentNode;)node=node.parentNode;if(store=node.store,store&&(store.treeStore&&(store=store.treeStore),store.tree))return store.ownerTree},removeChild:function(node,destroy,suppressEvents,isMove){var i,childCount,previousSibling,me=this,index=me.indexOf(node);if(index===-1||suppressEvents!==!0&&me.fireEventArgs("beforeremove",[me,node,!!isMove])===!1)return!1;if(Ext.suspendLayouts(),Ext.Array.erase(me.childNodes,index,1),me.firstChild===node&&me.setFirstChild(node.nextSibling),me.lastChild===node&&me.setLastChild(node.previousSibling),previousSibling=node.previousSibling,previousSibling&&(node.previousSibling.nextSibling=node.nextSibling),node.nextSibling)for(node.nextSibling.previousSibling=node.previousSibling,0===index&&node.nextSibling.updateInfo(!1,{isFirst:!0}),i=index,childCount=me.childNodes.length;i<childCount;i++)me.childNodes[i].updateInfo(!1,{index:i});else previousSibling&&(previousSibling.updateInfo(!1,{isLast:!0}),previousSibling.isExpanded()?previousSibling.cascadeBy(me.triggerUIUpdate):previousSibling.triggerUIUpdate());return me.childNodes.length||me.triggerUIUpdate(),Ext.resumeLayouts(!0),suppressEvents!==!0&&(node.removeContext={parentNode:node.parentNode,previousSibling:node.previousSibling,nextSibling:node.nextSibling},node.previousSibling=node.nextSibling=node.parentNode=null,me.fireEventArgs("remove",[me,node,!!isMove]),node.removeContext=null),destroy?node.destroy(!0):node.clear(),node},copy:function(newId,deep){var i,me=this,result=me.callParent(arguments),len=me.childNodes?me.childNodes.length:0;if(deep)for(i=0;i<len;i++)result.appendChild(me.childNodes[i].copy(void 0,!0));return result},clear:function(destroy){var me=this;me.parentNode=me.previousSibling=me.nextSibling=null,destroy&&(me.firstChild=me.lastChild=null)},destroy:function(silent){var n,me=this,options=me.destroyOptions,nodes=me.childNodes,nLen=nodes.length;if(silent===!0){for(me.clear(!0),n=0;n<nLen;n++)nodes[n].destroy(!0);me.childNodes=null,delete me.destroyOptions,me.callParent([options])}else me.destroyOptions=silent,me.remove(!0)},insertBefore:function(node,refNode,suppressEvents){var childCount,previousSibling,i,me=this,index=me.indexOf(refNode),oldParent=node.parentNode,refIndex=index;if(!refNode)return me.appendChild(node);if(node===refNode)return!1;if(node=me.createNode(node),suppressEvents!==!0&&me.fireEventArgs("beforeinsert",[me,node,refNode])===!1)return!1;if(oldParent===me&&me.indexOf(node)<index&&refIndex--,oldParent){if(suppressEvents!==!0&&node.fireEventArgs("beforemove",[node,oldParent,me,index,refNode])===!1)return!1;oldParent.removeChild(node,!1,!1,!0)}for(0===refIndex&&me.setFirstChild(node),Ext.Array.splice(me.childNodes,refIndex,0,node),node.parentNode=me,node.nextSibling=refNode,refNode.previousSibling=node,previousSibling=me.childNodes[refIndex-1],previousSibling?(node.previousSibling=previousSibling,previousSibling.nextSibling=node):node.previousSibling=null,node.updateInfo(!1,{parentId:me.getId(),index:refIndex,isFirst:0===refIndex,isLast:!1,depth:(me.data.depth||0)+1}),i=refIndex+1,childCount=me.childNodes.length;i<childCount;i++)me.childNodes[i].updateInfo(!1,{index:i});return me.isLoaded()?1===me.childNodes.length&&me.triggerUIUpdate():me.set("loaded",!0),!node.isLeaf()&&node.phantom&&node.set("loaded",!0),suppressEvents!==!0&&(me.fireEventArgs("insert",[me,node,refNode]),oldParent&&node.fireEventArgs("move",[node,oldParent,me,refIndex,refNode])),node},insertChild:function(index,node){var sibling=this.childNodes[index];return sibling?this.insertBefore(node,sibling):this.appendChild(node)},remove:function(destroy,suppressEvents){var me=this,parentNode=me.parentNode;return parentNode?parentNode.removeChild(me,destroy,suppressEvents):destroy&&me.destroy(!0),me},removeAll:function(destroy,suppressEvents,fromParent){var node,me=this,childNodes=me.childNodes,i=0,len=childNodes.length;if(len){for(me.fireEventArgs("bulkremove",[me,childNodes,!1]);i<len;++i)node=childNodes[i],node.removeContext={parentNode:node.parentNode,previousSibling:node.previousSibling,nextSibling:node.nextSibling},node.previousSibling=node.nextSibling=node.parentNode=null,me.fireEventArgs("remove",[me,node,!1]),node.removeContext=null,destroy?node.destroy(!0):node.removeAll(!1,suppressEvents,!0);return me.firstChild=me.lastChild=null,fromParent?me.childNodes=null:(me.childNodes.length=0,me.triggerUIUpdate()),me}},getChildAt:function(index){return this.childNodes[index]},replaceChild:function(newChild,oldChild,suppressEvents){var s=oldChild?oldChild.nextSibling:null;return this.removeChild(oldChild,!1,suppressEvents),this.insertBefore(newChild,s,suppressEvents),oldChild},indexOf:function(child){return Ext.Array.indexOf(this.childNodes,child)},indexOfId:function(id){for(var childNodes=this.childNodes,len=childNodes.length,i=0;i<len;++i)if(childNodes[i].getId()===id)return i;return-1},getPath:function(field,separator){field=field||this.idProperty,separator=separator||"/";for(var path=[this.get(field)],parent=this.parentNode;parent;)path.unshift(parent.get(field)),parent=parent.parentNode;return separator+path.join(separator)},getDepth:function(){return this.get("depth")},bubble:function(fn,scope,args){for(var p=this;p&&fn.apply(scope||p,args||[p])!==!1;)p=p.parentNode},cascade:function(){return Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.data.Node: cascade has been deprecated. Please use cascadeBy instead."),this.cascadeBy.apply(this,arguments)},cascadeBy:function(fn,scope,args){if(fn.apply(scope||this,args||[this])!==!1){var i,childNodes=this.childNodes,length=childNodes.length;for(i=0;i<length;i++)childNodes[i].cascadeBy(fn,scope,args)}},eachChild:function(fn,scope,args){var i,childNodes=this.childNodes,length=childNodes.length;for(i=0;i<length&&fn.apply(scope||this,args||[childNodes[i]])!==!1;i++);},findChild:function(attribute,value,deep){return this.findChildBy(function(){return this.get(attribute)==value},null,deep)},findChildBy:function(fn,scope,deep){for(var n,res,cs=this.childNodes,len=cs.length,i=0;i<len;i++){if(n=cs[i],fn.call(scope||n,n)===!0)return n;if(deep&&(res=n.findChildBy(fn,scope,deep),null!==res))return res}return null},contains:function(node){return node.isAncestor(this)},isAncestor:function(node){for(var p=this.parentNode;p;){if(p===node)return!0;p=p.parentNode}return!1},sort:function(sortFn,recursive,suppressEvent){var i,n,cs=this.childNodes,ln=cs.length,info={isFirst:!0};if(ln>0){for(Ext.Array.sort(cs,sortFn),this.setFirstChild(cs[0]),this.setLastChild(cs[ln-1]),i=0;i<ln;i++)n=cs[i],n.previousSibling=cs[i-1],n.nextSibling=cs[i+1],info.isLast=i===ln-1,info.index=i,n.updateInfo(!1,info),info.isFirst=!1,recursive&&!n.isLeaf()&&n.sort(sortFn,!0,!0);suppressEvent!==!0&&this.fireEventArgs("sort",[this,cs])}},isExpanded:function(){return this.get("expanded")},isLoaded:function(){return this.get("loaded")},isLoading:function(){return this.get("loading")},isRoot:function(){return!this.parentNode},isVisible:function(){for(var parent=this.parentNode;parent;){if(!parent.isExpanded())return!1;parent=parent.parentNode}return!0},expand:function(recursive,callback,scope){var owner,me=this;me.isLeaf()?Ext.callback(callback,scope||me):me.isLoading()?me.on("expand",function(){me.expand(recursive,callback,scope)},me,{single:!0}):me.isExpanded()?recursive?(owner=me.getOwnerTree(),me.expandChildren(!0,!!owner&&owner.singleExpand,callback,scope)):Ext.callback(callback,scope||me,[me.childNodes]):me.fireEventArgs("beforeexpand",[me,me.onChildNodesAvailable,me,[recursive,callback,scope]])},onChildNodesAvailable:function(records,recursive,callback,scope){var owner,me=this;Ext.suspendLayouts(),me.set("expanded",!0),me.fireEventArgs("expand",[me,me.childNodes,!1]),recursive?(owner=me.getOwnerTree(),me.expandChildren(!0,!!owner&&owner.singleExpand,callback,scope)):Ext.callback(callback,scope||me,[me.childNodes]),Ext.resumeLayouts(!0)},expandChildren:function(recursive,singleExpand,callback,scope){var i,node,me=this,allNodes=me.childNodes,expandNodes=[],ln=singleExpand?Math.min(allNodes.length,1):allNodes.length;for(i=0;i<ln;++i)node=allNodes[i],node.isLeaf()||(expandNodes[expandNodes.length]=node);for(ln=expandNodes.length,i=0;i<ln;++i)expandNodes[i].expand(recursive);callback&&Ext.callback(callback,scope||me,[me.childNodes])},collapse:function(recursive,callback,scope){var i,collapseChildren,me=this,expanded=me.isExpanded(),len=me.childNodes.length;if(!me.isLeaf()&&(!expanded&&recursive||me.fireEventArgs("beforecollapse",[me])!==!1)){if(Ext.suspendLayouts(),me.isExpanded())recursive&&(collapseChildren=function(){for(i=0;i<len;i++)me.childNodes[i].setCollapsed(!0)},callback=callback?Ext.Function.createSequence(collapseChildren,callback):collapseChildren),me.set("expanded",!1),me.fireEventArgs("collapse",[me,me.childNodes,!1,callback?Ext.Function.bind(callback,scope,[me.childNodes]):null,null]),callback=null;else if(recursive)for(i=0;i<len;i++)me.childNodes[i].setCollapsed(!0);Ext.resumeLayouts(!0)}Ext.callback(callback,scope||me,[me.childNodes])},setCollapsed:function(recursive){var i,me=this,len=me.childNodes.length;if(!me.isLeaf()&&me.fireEventArgs("beforecollapse",[me,Ext.emptyFn])!==!1&&(me.data.expanded=!1,me.fireEventArgs("collapse",[me,me.childNodes,!1,null,null]),recursive))for(i=0;i<len;i++)me.childNodes[i].setCollapsed(!0)},collapseChildren:function(recursive,callback,scope){var i,node,me=this,allNodes=me.childNodes,ln=allNodes.length,collapseNodes=[];for(i=0;i<ln;++i)node=allNodes[i],!node.isLeaf()&&node.isLoaded()&&node.isExpanded()&&collapseNodes.push(node);if(ln=collapseNodes.length)for(i=0;i<ln;++i)node=collapseNodes[i],i===ln-1?node.collapse(recursive,callback,scope):node.collapse(recursive);else Ext.callback(callback,scope)},fireEventArgs:function(eventName,args){var result,eventSource,tree,treeStore,rootNode,fireEventArgs=Ext.data.Model.prototype.fireEventArgs;if(bubbledEvents[eventName]){for(eventSource=this;result!==!1&&eventSource;eventSource=(rootNode=eventSource).parentNode)eventSource.hasListeners[eventName]&&(result=fireEventArgs.call(eventSource,eventName,args));return tree=rootNode.rootOf,result!==!1&&tree&&(treeStore=tree.treeStore,treeStore&&treeStore.hasListeners[eventName]&&(result=treeStore.fireEventArgs.call(treeStore,eventName,args)),result!==!1&&tree.hasListeners[eventName]&&(result=tree.fireEventArgs.call(tree,eventName,args))),result}return fireEventArgs.apply(this,arguments)},serialize:function(){var children,i,result=Ext.data.writer.Json.prototype.getRecordData(this),childNodes=this.childNodes,len=childNodes.length;if(len>0){for(children=[],i=0;i<len;i++)children.push(childNodes[i].serialize());result.children=children}return result}}}}}),Ext.define("Ext.data.NodeStore",{extend:Ext.data.Store,alias:"store.node",isNodeStore:!0,node:null,recursive:!1,rootVisible:!1,isExpandingOrCollapsing:0,constructor:function(config){var node,me=this;config=config||{},Ext.apply(me,config),config.proxy={type:"proxy"},me.callParent([config]),node=me.node,node&&(me.node=null,me.setNode(node))},getTotalCount:function(){return this.getCount()},setNode:function(node){var me=this;me.node&&me.node!=node&&(me.mun(me.node,{expand:me.onNodeExpand,collapse:me.onNodeCollapse,append:me.onNodeAppend,insert:me.onNodeInsert,bulkremove:me.onBulkRemove,remove:me.onNodeRemove,sort:me.onNodeSort,scope:me}),me.node=null),node&&(Ext.data.NodeInterface.decorate(node.self),me.removeAll(),me.rootVisible?me.add(node):node.isExpanded()||me.treeStore.autoLoad===!1||node.expand(),me.mon(node,{expand:me.onNodeExpand,collapse:me.onNodeCollapse,append:me.onNodeAppend,insert:me.onNodeInsert,bulkremove:me.onBulkRemove,remove:me.onNodeRemove,sort:me.onNodeSort,scope:me}),me.node=node,node.isExpanded()&&node.isLoaded()&&me.onNodeExpand(node,node.childNodes,!0))},onNodeSort:function(node,childNodes){var me=this;(me.indexOf(node)!==-1||node===me.node&&!me.rootVisible&&node.isExpanded())&&(Ext.suspendLayouts(),me.onNodeCollapse(node,childNodes,!0),me.onNodeExpand(node,childNodes,!0),Ext.resumeLayouts(!0))},onNodeExpand:function(parent,records,suppressEvent){var me=this,insertIndex=me.indexOf(parent)+1,toAdd=[];suppressEvent||me.fireEvent("beforeexpand",parent,records,insertIndex),me.handleNodeExpand(parent,records,toAdd),me.insert(insertIndex,toAdd),suppressEvent||me.fireEvent("expand",parent,records)},handleNodeExpand:function(parent,records,toAdd){var i,record,me=this,ln=records?records.length:0;if((me.recursive||parent===me.node)&&(parent===this.node||me.isVisible(parent))&&ln)for(i=0;i<ln;i++)record=records[i],toAdd.push(record),record.isExpanded()&&(record.isLoaded()?me.handleNodeExpand(record,record.childNodes,toAdd):(record.set("expanded",!1),record.expand()))},onBulkRemove:function(parent,childNodes,isMove){this.onNodeCollapse(parent,childNodes,!0)},onNodeCollapse:function(parent,records,suppressEvent,callback,scope){var node,lastNodeIndexPlus,sibling,found,me=this,collapseIndex=me.indexOf(parent)+1;if(me.recursive||parent===me.node){if(suppressEvent||me.fireEvent("beforecollapse",parent,records,collapseIndex,callback,scope),records.length&&me.data.contains(records[0])){for(node=parent;node.parentNode;){if(sibling=node.nextSibling){found=!0,lastNodeIndexPlus=me.indexOf(sibling);break}node=node.parentNode}found||(lastNodeIndexPlus=me.getCount()),me.removeAt(collapseIndex,lastNodeIndexPlus-collapseIndex)}suppressEvent||me.fireEvent("collapse",parent,records,collapseIndex)}},onNodeAppend:function(parent,node,index){var refNode,sibling,me=this;if(me.isVisible(node)){if(0===index)refNode=parent;else{for(sibling=node.previousSibling;sibling.isExpanded()&&sibling.lastChild;)sibling=sibling.lastChild;refNode=sibling}me.insert(me.indexOf(refNode)+1,node),!node.isLeaf()&&node.isExpanded()&&(node.isLoaded()?me.onNodeExpand(node,node.childNodes,!0):me.treeStore.fillCount||(node.set("expanded",!1),node.expand()))}},onNodeInsert:function(parent,node,refNode){var me=this,index=this.indexOf(refNode);index!=-1&&me.isVisible(node)&&(me.insert(index,node),!node.isLeaf()&&node.isExpanded()&&(node.isLoaded()?me.onNodeExpand(node,node.childNodes,!0):(node.set("expanded",!1),node.expand())))},onNodeRemove:function(parent,node,isMove){var me=this;me.indexOf(node)!=-1&&(!node.isLeaf()&&node.isExpanded()&&(node.parentNode=node.removeContext.parentNode,node.nextSibling=node.removeContext.nextSibling,me.onNodeCollapse(node,node.childNodes,!0),node.parentNode=node.nextSibling=null),me.remove(node))},isVisible:function(node){for(var parent=node.parentNode;parent;){if(parent===this.node&&parent.data.expanded)return!0;if(!parent.data.expanded)return!1;parent=parent.parentNode}return!1}}),Ext.define("Ext.data.Request",{action:void 0,params:void 0,method:"GET",url:void 0,constructor:function(config){Ext.apply(this,config)}}),Ext.define("Ext.data.SequentialIdGenerator",{extend:Ext.data.IdGenerator,alias:"idgen.sequential",constructor:function(){var me=this;me.callParent(arguments),me.parts=[me.prefix,""]},prefix:"",seed:1,generate:function(){var me=this,parts=me.parts;return parts[1]=me.seed++,parts.join("")}}),Ext.define("Ext.data.Tree",{alias:"data.tree",mixins:{observable:Ext.util.Observable},root:null,constructor:function(root){var me=this;me.mixins.observable.constructor.call(me),root&&me.setRootNode(root),me.on({scope:me,idchanged:me.onNodeIdChanged,insert:me.onNodeInsert,append:me.onNodeAppend,remove:me.onNodeRemove})},getRootNode:function(){return this.root},setRootNode:function(node){var me=this;return me.root=node,node.rootOf?node.rootOf.removeRootNode():node.parentNode&&node.parentNode.removeChild(node),node.rootOf=me,node.fireEventArgs("beforeappend",[null,node])!==!1&&(node.set("root",!0),node.updateInfo(!0,{isFirst:!0,isLast:!0,depth:0,index:0,parentId:null}),me.nodeHash={},node.fireEvent("append",null,node),node.fireEvent("rootchange",node)),node},removeRootNode:function(){var me=this,root=me.root;return root.set("root",!1),root.fireEvent("remove",null,root,!1),root.fireEvent("rootchange",null),root.rootOf=me.root=null,root},flatten:function(){return Ext.Object.getValues(this.nodeHash)},onNodeInsert:function(parent,node){this.registerNode(node,!0)},onNodeAppend:function(parent,node){this.registerNode(node,!0)},onNodeRemove:function(parent,node){this.unregisterNode(node,!0)},onNodeIdChanged:function(node,oldId,newId,oldInternalId){var nodeHash=this.nodeHash;nodeHash[node.internalId]=node,delete nodeHash[oldInternalId]},getNodeById:function(id){return this.nodeHash[id]},registerNode:function(node,includeChildren){var children,length,i,me=this;if(me.nodeHash[node.internalId]=node,includeChildren===!0)for(children=node.childNodes,length=children.length,i=0;i<length;i++)me.registerNode(children[i],!0)},unregisterNode:function(node,includeChildren){var children,length,i,me=this;if(delete me.nodeHash[node.internalId],includeChildren===!0)for(children=node.childNodes,length=children.length,i=0;i<length;i++)me.unregisterNode(children[i],!0)},sort:function(sorterFn,recursive){this.getRootNode().sort(sorterFn,recursive)},filter:function(filters,recursive){this.getRootNode().filter(filters,recursive)}}),Ext.define("Ext.data.TreeModel",{extend:Ext.data.Model},function(){Ext.data.NodeInterface.decorate(this)}),Ext.define("Ext.data.TreeStore",{extend:Ext.data.AbstractStore,alias:"store.tree",clearOnLoad:!0,clearRemovedOnLoad:!0,nodeParam:"node",defaultRootId:"root",defaultRootText:"Root",defaultRootProperty:"children",rootProperty:"children",fillCount:0,folderSort:!1,constructor:function(config){var root,fields,defaultRoot,me=this;config=Ext.apply({},config),fields=config.fields||me.fields,fields||(config.fields=[{name:"text",type:"string"}],defaultRoot=config.defaultRootProperty||me.defaultRootProperty,defaultRoot!==me.defaultRootProperty&&config.fields.push({name:defaultRoot,type:"auto",defaultValue:null,persist:!1})),me.callParent([config]),me.tree=new Ext.data.Tree,me.tree.treeStore=me,me.tree.on({scope:me,remove:me.onNodeRemove,beforeexpand:me.onBeforeNodeExpand,append:me.onNodeAdded,insert:me.onNodeAdded,sort:me.onNodeSort}),me.onBeforeSort(),root=me.root,root&&(delete me.root,me.setRootNode(root)),Ext.isDefined(me.nodeParameter)&&(Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.data.TreeStore: nodeParameter has been deprecated. Please use nodeParam instead."),me.nodeParam=me.nodeParameter,delete me.nodeParameter)},setProxy:function(proxy){var reader,needsRoot;return proxy instanceof Ext.data.proxy.Proxy?needsRoot=Ext.isEmpty(proxy.getReader().root):Ext.isString(proxy)?needsRoot=!0:(reader=proxy.reader,needsRoot=!(reader&&!Ext.isEmpty(reader.root))),proxy=this.callParent(arguments),proxy.idParam=this.nodeParam,needsRoot&&(reader=proxy.getReader(),reader.root=this.defaultRootProperty,reader.buildExtractors(!0)),proxy},onBeforeSort:function(){this.folderSort&&this.sort({property:"leaf",direction:"ASC"},"prepend",!1)},onBeforeNodeExpand:function(node,callback,scope,args){var reader,dataRoot,data,callbackArgs,me=this;node.isLoaded()?(callbackArgs=[node.childNodes],args&&callbackArgs.push.apply(callbackArgs,args),Ext.callback(callback,scope||node,callbackArgs)):(dataRoot=data=(node.raw||node[node.persistenceProperty])[(reader=me.getProxy().getReader()).root])?(me.fillNode(node,reader.extractData(dataRoot)),delete data[reader.root],callbackArgs=[node.childNodes],args&&callbackArgs.push.apply(callbackArgs,args),Ext.callback(callback,scope||node,callbackArgs)):node.isLoading()?me.on("load",function(){callbackArgs=[node.childNodes],args&&callbackArgs.push.apply(callbackArgs,args),Ext.callback(callback,scope||node,callbackArgs)},me,{single:!0,priority:1001}):me.read({node:node,internalCallback:function(){delete me.lastOptions.internalCallback,callbackArgs=[node.childNodes],args&&callbackArgs.push.apply(callbackArgs,args),Ext.callback(callback,scope||node,callbackArgs)}})},getNewRecords:function(){return Ext.Array.filter(this.tree.flatten(),this.filterNew)},getUpdatedRecords:function(){return Ext.Array.filter(this.tree.flatten(),this.filterUpdated)},onNodeRemove:function(parent,node,isMove){var me=this;node.unjoin(me),node.phantom||isMove||Ext.Array.include(me.removed,node),!me.autoSync||me.autoSyncSuspended||isMove||me.sync()},onNodeAdded:function(parent,node){var dataRoot,me=this,proxy=me.getProxy(),reader=proxy.getReader(),data=node.raw||node[node.persistenceProperty];Ext.Array.remove(me.removed,node),node.join(me),node.isLeaf()||me.lazyFill||(dataRoot=reader.getRoot(data),dataRoot&&(me.fillNode(node,reader.extractData(dataRoot)),delete data[reader.root])),me.autoSync&&!me.autoSyncSuspended&&(node.phantom||node.dirty)&&me.sync()},onNodeSort:function(){this.autoSync&&!this.autoSyncSuspended&&this.sync()},setRootNode:function(root,preventLoad){var me=this,model=me.model,idProperty=model.prototype.idProperty;return root=root||{},root.isModel?root.isModel&&!root.isNode&&Ext.data.NodeInterface.decorate(model):(root=Ext.apply({},root),Ext.applyIf(root,{id:me.defaultRootId,text:me.defaultRootText,allowDrag:!1}),void 0===root[idProperty]&&(root[idProperty]=me.defaultRootId),Ext.data.NodeInterface.decorate(model),root=Ext.ModelManager.create(root,model)),me.getProxy().getReader().buildExtractors(!0),me.tree.setRootNode(root),preventLoad===!0||root.isLoaded()||me.autoLoad!==!0&&!root.isExpanded()||(root.data.expanded=!1,root.expand()),root},getRootNode:function(){return this.tree.getRootNode()},getNodeById:function(id){return this.tree.getNodeById(id)},getById:function(id){return this.getNodeById(id)},load:function(options){options=options||{},options.params=options.params||{};var operation,me=this,node=options.node||me.tree.getRootNode(),callback=options.callback,scope=options.scope;return node||(node=me.setRootNode({expanded:!0},!0)),node.data.expanded&&(node.data.loaded=!1,me.clearOnLoad&&(node.data.expanded=!1),options.callback=function(){me.clearOnLoad||node.collapse(),node.expand(),Ext.callback(callback,scope,arguments)}),options.id=node.getId(),options=Ext.apply({action:"read",filters:me.filters.items,sorters:me.getSorters(),node:options.node||node},options),me.lastOptions=options,operation=new Ext.data.Operation(options),me.fireEvent("beforeload",me,operation)!==!1&&(me.clearOnLoad&&(me.clearRemovedOnLoad&&me.clearRemoved(node),me.tree.un("remove",me.onNodeRemove,me),node.removeAll(!1),me.tree.on("remove",me.onNodeRemove,me)),me.loading=!0,me.proxy.read(operation,me.onProxyLoad,me)),me.loading&&node&&node.set("loading",!0),me},clearRemoved:function(node){var removedNode,targetNode,targetId,me=this,removed=me.removed,id=node.getId(),removedLength=removed.length,i=removedLength,recordsToClear={},newRemoved=[],removedHash={};if(node===me.getRootNode())return void(me.removed=[]);for(;i--;)removedNode=removed[i],removedHash[removedNode.getId()]=removedNode;for(i=removedLength;i--;){for(removedNode=removed[i],targetNode=removedNode;targetNode&&targetNode.getId()!==id;)targetId=targetNode.get("parentId"),targetNode=targetNode.parentNode||me.getNodeById(targetId)||removedHash[targetId];targetNode&&(recordsToClear[removedNode.getId()]=removedNode)}for(i=0;i<removedLength;i++)removedNode=removed[i],recordsToClear[removedNode.getId()]||newRemoved.push(removedNode);me.removed=newRemoved},fillNode:function(node,newNodes){var i,sortCollection,node1,node2,rootFill,me=this,ln=newNodes?newNodes.length:0,sorters=me.sorters,needsIndexSort=!1,performLocalSort=ln&&me.sortOnLoad&&!me.remoteSort&&sorters&&sorters.items&&sorters.items.length;for(i=1;i<ln&&(node1=newNodes[i],node2=newNodes[i-1],!(needsIndexSort=node1[node1.persistenceProperty].index!=node2[node2.persistenceProperty].index));i++);return performLocalSort?(needsIndexSort&&me.sorters.insert(0,me.indexSorter),sortCollection=new Ext.util.MixedCollection,sortCollection.addAll(newNodes),sortCollection.sort(me.sorters.items),newNodes=sortCollection.items,me.sorters.remove(me.indexSorter)):needsIndexSort&&Ext.Array.sort(newNodes,me.sortByIndex),node.set("loaded",!0),rootFill=0===me.fillCount,rootFill&&me.fireEvent("beforefill",me,node,newNodes),++me.fillCount,newNodes.length&&node.appendChild(newNodes,void 0,!0),rootFill&&me.fireEvent("fillcomplete",me,node,newNodes),--me.fillCount,newNodes},sortByIndex:function(node1,node2){return node1[node1.persistenceProperty].index-node2[node2.persistenceProperty].index},onIdChanged:function(model,oldId,newId,oldInternalId){this.tree.onNodeIdChanged(model,oldId,newId,oldInternalId),this.callParent(arguments)},onProxyLoad:function(operation){var me=this,successful=operation.wasSuccessful(),records=operation.getRecords(),node=operation.node,scope=operation.scope||me,args=[records,operation,successful];me.loading=!1,node.set("loading",!1),successful&&(me.clearOnLoad||(records=me.cleanRecords(node,records)),records=me.fillNode(node,records)),Ext.callback(operation.internalCallback,scope,args),me.fireEvent("read",me,operation.node,records,successful),me.fireEvent("load",me,operation.node,records,successful),Ext.callback(operation.callback,scope,args)},cleanRecords:function(node,records){for(var rec,nodeHash={},childNodes=node.childNodes,i=0,len=childNodes.length,out=[];i<len;++i)nodeHash[childNodes[i].getId()]=!0;for(i=0,len=records.length;i<len;++i)rec=records[i],nodeHash[rec.getId()]||out.push(rec);return out},removeAll:function(){var root=this.getRootNode();root&&root.destroy(!0),this.fireEvent("clear",this)},doSort:function(sorterFn){var me=this;me.remoteSort?me.load():(me.tree.sort(sorterFn,!0),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)),me.fireEvent("sort",me,me.sorters.getRange())}},function(){var proto=this.prototype;proto.indexSorter=new Ext.util.Sorter({sorterFn:proto.sortByIndex})}),Ext.define("Ext.data.UuidGenerator",function(){function toHex(value,length){var ret=value.toString(16);return ret.length>length?ret=ret.substring(ret.length-length):ret.length<length&&(ret=Ext.String.leftPad(ret,length,"0")),ret}function rand(lo,hi){var v=Math.random()*(hi-lo+1);return Math.floor(v)+lo}function split(bignum){if("number"==typeof bignum){var hi=Math.floor(bignum/twoPow32);return{lo:Math.floor(bignum-hi*twoPow32),hi:hi}}return bignum}var twoPow14=Math.pow(2,14),twoPow16=Math.pow(2,16),twoPow28=Math.pow(2,28),twoPow32=Math.pow(2,32);return{extend:Ext.data.IdGenerator,alias:"idgen.uuid",id:"uuid",version:4,constructor:function(){var me=this;me.callParent(arguments),me.parts=[],me.init()},generate:function(){var me=this,parts=me.parts,ts=me.timestamp;return parts[0]=toHex(ts.lo,8),parts[1]=toHex(65535&ts.hi,4),parts[2]=toHex(ts.hi>>>16&4095|me.version<<12,4),
parts[3]=toHex(128|me.clockSeq>>>8&63,2)+toHex(255&me.clockSeq,2),parts[4]=toHex(me.salt.hi,4)+toHex(me.salt.lo,8),4==me.version?me.init():(++ts.lo,ts.lo>=twoPow32&&(ts.lo=0,++ts.hi)),parts.join("-").toLowerCase()},getRecId:function(rec){return rec.getId()},init:function(){var salt,time,me=this;4==me.version?(me.clockSeq=rand(0,twoPow14-1),salt=me.salt||(me.salt={}),time=me.timestamp||(me.timestamp={}),salt.lo=rand(0,twoPow32-1),salt.hi=rand(0,twoPow16-1),time.lo=rand(0,twoPow32-1),time.hi=rand(0,twoPow28-1)):(me.salt=split(me.salt),me.timestamp=split(me.timestamp),me.salt.hi|=256)},reconfigure:function(config){Ext.apply(this,config),this.init()}}}()),Ext.define("Ext.data.reader.Xml",{extend:Ext.data.reader.Reader,alternateClassName:"Ext.data.XmlReader",alias:"reader.xml",createAccessor:function(expr){var me=this;return Ext.isEmpty(expr)?Ext.emptyFn:Ext.isFunction(expr)?expr:function(root){return me.getNodeValue(Ext.DomQuery.selectNode(expr,root))}},getNodeValue:function(node){if(node&&("function"==typeof node.normalize&&node.normalize(),node=node.firstChild))return node.nodeValue},getResponseData:function(response){var error,msg,xml=response.responseXML;return xml?this.readRecords(xml):(msg="XML data not found in the response",error=new Ext.data.ResultSet({total:0,count:0,records:[],success:!1,message:msg}),this.fireEvent("exception",this,response,error),Ext.Logger.warn(msg),error)},getData:function(data){return data.documentElement||data},getRoot:function(data){var nodeName=data.nodeName,root=this.root;return!root||nodeName&&nodeName==root?data:Ext.DomQuery.isXml(data)?Ext.DomQuery.selectNode(root,data):void 0},extractData:function(root){var recordName=this.record;return root=recordName!=root.nodeName?Ext.DomQuery.select(recordName,root):[root],this.callParent([root])},getAssociatedDataRoot:function(data,associationName){return Ext.DomQuery.select(associationName,data)[0]},readRecords:function(doc){return Ext.isArray(doc)&&(doc=doc[0]),this.xmlData=doc,this.callParent([doc])},createFieldAccessExpression:function(field,fieldVarName,dataName){var selector,result,namespace=this.namespace;return selector=field.mapping||(namespace?namespace+"|":"")+field.name,result="function"==typeof selector?fieldVarName+".mapping("+dataName+", this)":'me.getNodeValue(Ext.DomQuery.selectNode("'+selector+'", '+dataName+"))"}}),Ext.define("Ext.data.writer.Xml",{extend:Ext.data.writer.Writer,alternateClassName:"Ext.data.XmlWriter",alias:"writer.xml",documentRoot:"xmlData",defaultDocumentRoot:"xmlData",header:"",record:"record",writeRecords:function(request,data){var item,key,me=this,xml=[],i=0,len=data.length,root=me.documentRoot,record=me.record,needsRoot=1!==data.length;for(xml.push(me.header||""),!root&&needsRoot&&(root=me.defaultDocumentRoot),root&&xml.push("<",root,">");i<len;++i){item=data[i],xml.push("<",record,">");for(key in item)item.hasOwnProperty(key)&&xml.push("<",key,">",item[key],"</",key,">");xml.push("</",record,">")}return root&&xml.push("</",root,">"),request.xmlData=xml.join(""),request}}),Ext.define("Ext.data.XmlStore",{extend:Ext.data.Store,alias:"store.xml",constructor:function(config){config=Ext.apply({proxy:{type:"ajax",reader:"xml",writer:"xml"}},config),this.callParent([config])}}),Ext.define("Ext.data.association.BelongsTo",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.BelongsToAssociation",alias:"association.belongsto",constructor:function(config){this.callParent(arguments);var me=this,ownerProto=me.ownerModel.prototype,associatedName=me.associatedName,getterName=me.getterName||"get"+associatedName,setterName=me.setterName||"set"+associatedName;Ext.applyIf(me,{name:associatedName,foreignKey:associatedName.toLowerCase()+"_id",instanceName:associatedName+"BelongsToInstance",associationKey:associatedName.toLowerCase()}),ownerProto[getterName]=me.createGetter(),ownerProto[setterName]=me.createSetter()},createSetter:function(){var me=this,foreignKey=me.foreignKey,instanceName=me.instanceName;return function(value,options,scope){var setByRecord=value&&value.isModel,valueToSet=setByRecord?value.getId():value;if(setByRecord?this[instanceName]=value:this[instanceName]instanceof Ext.data.Model&&!this.isEqual(this.get(foreignKey),valueToSet)&&delete this[instanceName],this.set(foreignKey,valueToSet),Ext.isFunction(options)&&(options={callback:options,scope:scope||this}),Ext.isObject(options))return this.save(options)}},createGetter:function(){var me=this,associatedName=me.associatedName,associatedModel=me.associatedModel,foreignKey=me.foreignKey,primaryKey=me.primaryKey,instanceName=me.instanceName;return function(options,scope){options=options||{};var success,instance,args,model=this,foreignKeyId=model.get(foreignKey);return options.reload===!0||void 0===model[instanceName]?(instance=Ext.ModelManager.create({},associatedName),instance.set(primaryKey,foreignKeyId),"function"==typeof options&&(options={callback:options,scope:scope||model}),success=options.success,options.success=function(rec){model[instanceName]=rec,success&&success.apply(this,arguments)},associatedModel.load(foreignKeyId,options),model[instanceName]=instance,instance):(instance=model[instanceName],args=[instance],scope=scope||options.scope||model,Ext.callback(options,scope,args),Ext.callback(options.success,scope,args),Ext.callback(options.failure,scope,args),Ext.callback(options.callback,scope,args),instance)}},read:function(record,reader,associationData){record[this.instanceName]=reader.read([associationData]).records[0]}}),Ext.define("Ext.util.Inflector",{singleton:!0,plurals:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat|potat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status|sex)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/^person$/,"people"],[/^man$/,"men"],[/^(child)$/,"$1ren"],[/s$/i,"s"],[/$/,"s"]],singulars:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/people$/i,"person"],[/s$/i,""]],uncountable:["sheep","fish","series","species","money","rice","information","equipment","grass","mud","offspring","deer","means"],singular:function(matcher,replacer){this.singulars.unshift([matcher,replacer])},plural:function(matcher,replacer){this.plurals.unshift([matcher,replacer])},clearSingulars:function(){this.singulars=[]},clearPlurals:function(){this.plurals=[]},isTransnumeral:function(word){return Ext.Array.indexOf(this.uncountable,word)!=-1},pluralize:function(word){if(this.isTransnumeral(word))return word;var tuple,regex,i,plurals=this.plurals,length=plurals.length;for(i=0;i<length;i++)if(tuple=plurals[i],regex=tuple[0],regex==word||regex.test&&regex.test(word))return word.replace(regex,tuple[1]);return word},singularize:function(word){if(this.isTransnumeral(word))return word;var tuple,regex,i,singulars=this.singulars,length=singulars.length;for(i=0;i<length;i++)if(tuple=singulars[i],regex=tuple[0],regex==word||regex.test&&regex.test(word))return word.replace(regex,tuple[1]);return word},classify:function(word){return Ext.String.capitalize(this.singularize(word))},ordinalize:function(number){var parsed=parseInt(number,10),mod10=parsed%10,mod100=parsed%100;if(11<=mod100&&mod100<=13)return number+"th";switch(mod10){case 1:return number+"st";case 2:return number+"nd";case 3:return number+"rd";default:return number+"th"}}},function(){var singular,irregulars={alumnus:"alumni",cactus:"cacti",focus:"foci",nucleus:"nuclei",radius:"radii",stimulus:"stimuli",ellipsis:"ellipses",paralysis:"paralyses",oasis:"oases",appendix:"appendices",index:"indexes",beau:"beaux",bureau:"bureaux",tableau:"tableaux",woman:"women",child:"children",man:"men",corpus:"corpora",criterion:"criteria",curriculum:"curricula",genus:"genera",memorandum:"memoranda",phenomenon:"phenomena",foot:"feet",goose:"geese",tooth:"teeth",antenna:"antennae",formula:"formulae",nebula:"nebulae",vertebra:"vertebrae",vita:"vitae"};for(singular in irregulars)this.plural(singular,irregulars[singular]),this.singular(irregulars[singular],singular)}),Ext.define("Ext.data.association.HasMany",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.HasManyAssociation",alias:"association.hasmany",constructor:function(config){var ownerProto,name,me=this;me.callParent(arguments),me.name=me.name||Ext.util.Inflector.pluralize(me.associatedName.toLowerCase()),ownerProto=me.ownerModel.prototype,name=me.name,Ext.applyIf(me,{storeName:name+"Store",foreignKey:me.ownerName.toLowerCase()+"_id"}),ownerProto[name]=me.createStore()},createStore:function(){var that=this,associatedModel=that.associatedModel,storeName=that.storeName,foreignKey=that.foreignKey,primaryKey=that.primaryKey,filterProperty=that.filterProperty,autoLoad=that.autoLoad,storeConfig=that.storeConfig||{};return function(){var config,filter,id,me=this,modelDefaults={};return void 0===me[storeName]&&(id=me.get(primaryKey),filterProperty?filter={property:filterProperty,value:me.get(filterProperty),exactMatch:!0}:me.hasId(id)&&(filter={property:foreignKey,value:id,exactMatch:!0}),modelDefaults[foreignKey]=me.get(primaryKey),config=Ext.apply({},storeConfig,{model:associatedModel,filters:filter?[filter]:void 0,remoteFilter:!1,modelDefaults:modelDefaults,disableMetaChangeEvent:!0}),me[storeName]=Ext.data.AbstractStore.create(config),autoLoad&&me[storeName].load()),me[storeName]}},read:function(record,reader,associationData){var inverse,items,iLen,i,store=record[this.name]();if(store.add(reader.read(associationData).records),inverse=this.associatedModel.prototype.associations.findBy(function(assoc){return"belongsTo"===assoc.type&&assoc.associatedName===record.$className}))for(items=store.data.items,iLen=items.length,i=0;i<iLen;i++)items[i][inverse.instanceName]=record}}),Ext.define("Ext.data.association.HasOne",{extend:Ext.data.association.Association,alternateClassName:"Ext.data.HasOneAssociation",alias:"association.hasone",constructor:function(config){this.callParent(arguments);var me=this,ownerProto=me.ownerModel.prototype,associatedName=me.associatedName,getterName=me.getterName||"get"+associatedName,setterName=me.setterName||"set"+associatedName;Ext.applyIf(me,{name:associatedName,foreignKey:associatedName.toLowerCase()+"_id",instanceName:associatedName+"HasOneInstance",associationKey:associatedName.toLowerCase()}),ownerProto[getterName]=me.createGetter(),ownerProto[setterName]=me.createSetter()},createSetter:function(){var me=this,foreignKey=me.foreignKey,instanceName=me.instanceName;return function(value,options,scope){var setByRecord=value&&value.isModel,valueToSet=setByRecord?value.getId():value;if(setByRecord?this[instanceName]=value:this[instanceName]instanceof Ext.data.Model&&!this.isEqual(this.get(foreignKey),valueToSet)&&delete this[instanceName],this.set(foreignKey,valueToSet),Ext.isFunction(options)&&(options={callback:options,scope:scope||this}),Ext.isObject(options))return this.save(options)}},createGetter:function(){var me=this,associatedName=(me.ownerModel,me.associatedName),associatedModel=me.associatedModel,foreignKey=me.foreignKey,primaryKey=me.primaryKey,instanceName=me.instanceName;return function(options,scope){options=options||{};var success,instance,args,model=this,foreignKeyId=model.get(foreignKey);return options.reload===!0||void 0===model[instanceName]?(instance=Ext.ModelManager.create({},associatedName),instance.set(primaryKey,foreignKeyId),"function"==typeof options&&(options={callback:options,scope:scope||model}),success=options.success,options.success=function(rec){model[instanceName]=rec,success&&success.apply(this,arguments)},associatedModel.load(foreignKeyId,options),model[instanceName]=instance,instance):(instance=model[instanceName],args=[instance],scope=scope||options.scope||model,Ext.callback(options,scope,args),Ext.callback(options.success,scope,args),Ext.callback(options.failure,scope,args),Ext.callback(options.callback,scope,args),instance)}},read:function(record,reader,associationData){var inverse=this.associatedModel.prototype.associations.findBy(function(assoc){return"belongsTo"===assoc.type&&assoc.associatedName===record.$className}),newRecord=reader.read([associationData]).records[0];record[this.instanceName]=newRecord,inverse&&(newRecord[inverse.instanceName]=record)}}),Ext.define("Ext.data.proxy.WebStorage",{extend:Ext.data.proxy.Client,alternateClassName:"Ext.data.WebStorageProxy",id:void 0,constructor:function(config){this.callParent(arguments),this.cache={},this.id=this.id||(this.store?this.store.storeId:void 0),this.initialize()},create:function(operation,callback,scope){var id,record,i,me=this,records=operation.records,length=records.length,ids=me.getIds();for(operation.setStarted(),void 0===me.isHierarchical&&(me.isHierarchical=!!records[0].isNode,me.isHierarchical&&me.getStorageObject().setItem(me.getTreeKey(),!0)),i=0;i<length;i++)record=records[i],record.phantom?(record.phantom=!1,id=me.getNextId()):id=record.getId(),me.setRecord(record,id),record.commit(),ids.push(id);me.setIds(ids),operation.setCompleted(),operation.setSuccessful(),"function"==typeof callback&&callback.call(scope||me,operation)},read:function(operation,callback,scope){var ids,length,record,data,id,me=this,records=[],i=0,success=!0,Model=me.model;if(operation.setStarted(),me.isHierarchical)records=me.getTreeData();else if(ids=me.getIds(),length=ids.length,id=operation.id)data=me.getRecord(id),null!==data&&(record=new Model(data,id,data)),record?records.push(record):success=!1;else for(;i<length;i++)id=ids[i],data=me.getRecord(id),records.push(new Model(data,id,data));success&&operation.setSuccessful(),operation.setCompleted(),operation.resultSet=Ext.create("Ext.data.ResultSet",{records:records,total:records.length,loaded:!0}),"function"==typeof callback&&callback.call(scope||me,operation)},update:function(operation,callback,scope){var record,id,i,records=operation.records,length=records.length,ids=this.getIds();for(operation.setStarted(),i=0;i<length;i++)record=records[i],this.setRecord(record),record.commit(),id=record.getId(),void 0!==id&&Ext.Array.indexOf(ids,id)==-1&&ids.push(id);this.setIds(ids),operation.setCompleted(),operation.setSuccessful(),"function"==typeof callback&&callback.call(scope||this,operation)},destroy:function(operation,callback,scope){var id,me=this,records=operation.records,ids=me.getIds(),idLength=ids.length,newIds=[],removedHash={},i=records.length;for(operation.setStarted();i--;)Ext.apply(removedHash,me.removeRecord(records[i]));for(i=0;i<idLength;i++)id=ids[i],removedHash[id]||newIds.push(id);me.setIds(newIds),operation.setCompleted(),operation.setSuccessful(),"function"==typeof callback&&callback.call(scope||me,operation)},getRecord:function(id){var me=this,cache=me.cache,data=cache[id]?cache[id]:Ext.decode(me.getStorageObject().getItem(me.getRecordKey(id)));return data?(cache[id]=data,data[me.model.prototype.idProperty]=id,data):null},setRecord:function(record,id){id?record.setId(id):id=record.getId();for(var field,name,obj,key,me=this,rawData=record.data,data={},model=me.model,fields=model.prototype.fields.items,length=fields.length,i=0;i<length;i++)field=fields[i],name=field.name,field.persist&&(data[name]=rawData[name]);delete data[me.model.prototype.idProperty],record.isNode&&1===record.get("depth")&&delete data.parentId,obj=me.getStorageObject(),key=me.getRecordKey(id),me.cache[id]=data,obj.removeItem(key),obj.setItem(key,Ext.encode(data))},removeRecord:function(record){var i,childNodes,me=this,id=record.getId(),records={};if(records[id]=record,me.getStorageObject().removeItem(me.getRecordKey(id)),delete me.cache[id],record.childNodes)for(childNodes=record.childNodes,i=childNodes.length;i--;)Ext.apply(records,me.removeRecord(childNodes[i]));return records},getRecordKey:function(id){return id.isModel&&(id=id.getId()),Ext.String.format("{0}-{1}",this.id,id)},getRecordCounterKey:function(){return Ext.String.format("{0}-counter",this.id)},getTreeKey:function(){return Ext.String.format("{0}-tree",this.id)},getIds:function(){var i,me=this,ids=(me.getStorageObject().getItem(me.id)||"").split(","),model=me.model,length=ids.length,isString="string"===model.prototype.fields.get(model.prototype.idProperty).type.type;if(1==length&&""===ids[0])ids=[];else for(i=0;i<length;i++)ids[i]=isString?ids[i]:+ids[i];return ids},setIds:function(ids){var obj=this.getStorageObject(),str=ids.join(",");obj.removeItem(this.id),Ext.isEmpty(str)||obj.setItem(this.id,str)},getNextId:function(){var id,me=this,obj=me.getStorageObject(),key=me.getRecordCounterKey(),model=me.model,isString="string"===model.prototype.fields.get(model.prototype.idProperty).type.type;return id=me.idGenerator.generate(),obj.setItem(key,id),isString||(id=+id),id},getTreeData:function(){for(var rootLength,record,parent,parentId,children,id,me=this,ids=me.getIds(),length=ids.length,records=[],recordHash={},root=[],i=0,Model=me.model,idProperty=Model.prototype.idProperty;i<length;i++)id=ids[i],record=me.getRecord(id),records.push(record),recordHash[id]=record,record.parentId||root.push(record);for(rootLength=root.length,Ext.Array.sort(records,me.sortByParentId),i=rootLength;i<length;i++)record=records[i],parentId=record.parentId,parent&&parent[idProperty]===parentId||(parent=recordHash[parentId],parent.children=children=[]),children.push(record);for(i=length;i--;)record=records[i],record.children||record.leaf||(record.loaded=!0);for(i=rootLength;i--;)record=root[i],root[i]=new Model(record,record[idProperty],record);return root},sortByParentId:function(node1,node2){return(node1.parentId||0)-(node2.parentId||0)},initialize:function(){var me=this,storageObject=me.getStorageObject(),lastId=+storageObject.getItem(me.getRecordCounterKey());storageObject.setItem(me.id,storageObject.getItem(me.id)||""),storageObject.getItem(me.getTreeKey())&&(me.isHierarchical=!0),me.idGenerator=new Ext.data.SequentialIdGenerator({seed:lastId?lastId+1:1})},clear:function(){var i,me=this,obj=me.getStorageObject(),ids=me.getIds(),len=ids.length;for(i=0;i<len;i++)obj.removeItem(me.getRecordKey(ids[i]));obj.removeItem(me.getRecordCounterKey()),obj.removeItem(me.getTreeKey()),obj.removeItem(me.id),me.cache={}},getStorageObject:function(){}}),Ext.define("Ext.data.proxy.LocalStorage",{extend:Ext.data.proxy.WebStorage,alias:"proxy.localstorage",alternateClassName:"Ext.data.LocalStorageProxy",getStorageObject:function(){return window.localStorage}}),Ext.define("Ext.data.proxy.Rest",{extend:Ext.data.proxy.Ajax,alternateClassName:"Ext.data.RestProxy",alias:"proxy.rest",actionMethods:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},defaultActionMethods:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},appendId:!0,batchActions:!1,buildUrl:function(request){var me=this,operation=request.operation,records=operation.records||[],record=records[0],format=me.format,url=me.getUrl(request),id=record?record.getId():operation.id;return me.appendId&&me.isValidId(id)&&(url.match(/\/$/)||(url+="/"),url+=id),format&&(url.match(/\.$/)||(url+="."),url+=format),request.url=url,me.callParent(arguments)},isValidId:function(id){return id||0===id}}),Ext.define("Ext.data.proxy.SessionStorage",{extend:Ext.data.proxy.WebStorage,alias:"proxy.sessionstorage",alternateClassName:"Ext.data.SessionStorageProxy",getStorageObject:function(){return window.sessionStorage}}),Ext.define("Ext.dd.DDTarget",{extend:Ext.dd.DragDrop,constructor:function(id,sGroup,config){id&&this.initTarget(id,sGroup,config)},getDragEl:Ext.emptyFn,isValidHandleChild:Ext.emptyFn,startDrag:Ext.emptyFn,endDrag:Ext.emptyFn,onDrag:Ext.emptyFn,onDragDrop:Ext.emptyFn,onDragEnter:Ext.emptyFn,onDragOut:Ext.emptyFn,onDragOver:Ext.emptyFn,onInvalidDrop:Ext.emptyFn,onMouseDown:Ext.emptyFn,onMouseUp:Ext.emptyFn,setXConstraint:Ext.emptyFn,setYConstraint:Ext.emptyFn,resetConstraints:Ext.emptyFn,clearConstraints:Ext.emptyFn,clearTicks:Ext.emptyFn,setInitPosition:Ext.emptyFn,setDragElId:Ext.emptyFn,setHandleElId:Ext.emptyFn,setOuterHandleElId:Ext.emptyFn,addInvalidHandleClass:Ext.emptyFn,addInvalidHandleId:Ext.emptyFn,addInvalidHandleType:Ext.emptyFn,removeInvalidHandleClass:Ext.emptyFn,removeInvalidHandleId:Ext.emptyFn,removeInvalidHandleType:Ext.emptyFn,toString:function(){return"DDTarget "+this.id}}),Ext.define("Ext.dd.DragTracker",{mixins:{observable:Ext.util.Observable},active:!1,trackOver:!1,tolerance:5,autoStart:!1,constructor:function(config){var me=this;Ext.apply(me,config),me.addEvents("mouseover","mouseout","mousedown","mouseup","mousemove","beforedragstart","dragstart","dragend","drag"),me.dragRegion=new Ext.util.Region(0,0,0,0),me.el&&me.initEl(me.el),me.mixins.observable.constructor.call(me),me.disabled&&me.disable()},initEl:function(el){var me=this;me.el=Ext.get(el),me.handle=Ext.get(me.delegate),me.delegate=me.handle?void 0:me.delegate,me.handle||(me.handle=me.el),me.handleListeners={scope:me,delegate:me.delegate,mousedown:me.onMouseDown},(me.trackOver||me.overCls)&&Ext.apply(me.handleListeners,{mouseover:me.onMouseOver,mouseout:me.onMouseOut}),me.mon(me.handle,me.handleListeners)},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},destroy:function(){var me=this;me.active&&me.endDrag({}),me.clearListeners(),me.mun(me.handle,me.handleListeners),me.el=me.handle=null},onMouseOver:function(e,target){var me=this;me.disabled||(Ext.EventManager.contains(e)||me.delegate)&&(me.mouseIsOut=!1,me.overCls&&me.el.addCls(me.overCls),me.fireEvent("mouseover",me,e,me.delegate?e.getTarget(me.delegate,target):me.handle))},onMouseOut:function(e){var me=this;me.mouseIsDown?me.mouseIsOut=!0:(me.overCls&&me.el.removeCls(me.overCls),me.fireEvent("mouseout",me,e))},onMouseDown:function(e,target){var el,me=this;me.disabled||e.dragTracked||(me.dragTarget=me.delegate?target:me.handle.dom,me.startXY=me.lastXY=e.getXY(),me.startRegion=Ext.fly(me.dragTarget).getRegion(),me.fireEvent("mousedown",me,e)!==!1&&me.fireEvent("beforedragstart",me,e)!==!1&&me.onBeforeStart(e)!==!1&&(me.mouseIsDown=!0,e.dragTracked=!0,el=me.el.dom,Ext.isIE&&el.setCapture&&el.setCapture(),me.preventDefault!==!1&&e.preventDefault(),Ext.getDoc().on({scope:me,mouseup:me.onMouseUp,mousemove:me.onMouseMove,selectstart:me.stopSelect}),me.autoStart&&(me.timer=Ext.defer(me.triggerStart,me.autoStart===!0?1e3:me.autoStart,me,[e]))))},onMouseMove:function(e,target){var me=this,xy=e.getXY(),s=me.startXY;if(e.preventDefault(),me.lastXY=xy,!me.active){if(!(Math.max(Math.abs(s[0]-xy[0]),Math.abs(s[1]-xy[1]))>me.tolerance))return;me.triggerStart(e)}me.fireEvent("mousemove",me,e)===!1?me.onMouseUp(e):(me.onDrag(e),me.fireEvent("drag",me,e))},onMouseUp:function(e){var me=this;me.mouseIsDown=!1,me.mouseIsOut&&(me.mouseIsOut=!1,me.onMouseOut(e)),e.preventDefault(),Ext.isIE&&document.releaseCapture&&document.releaseCapture(),me.fireEvent("mouseup",me,e),me.endDrag(e)},endDrag:function(e){var me=this,wasActive=me.active;Ext.getDoc().un({mousemove:me.onMouseMove,mouseup:me.onMouseUp,selectstart:me.stopSelect,scope:me}),me.clearStart(),me.active=!1,wasActive&&(me.onEnd(e),me.fireEvent("dragend",me,e)),me._constrainRegion=Ext.EventObject.dragTracked=null},triggerStart:function(e){var me=this;me.clearStart(),me.active=!0,me.onStart(e),me.fireEvent("dragstart",me,e)},clearStart:function(){var timer=this.timer;timer&&(clearTimeout(timer),this.timer=null)},stopSelect:function(e){return e.stopEvent(),!1},onBeforeStart:function(e){},onStart:function(xy){},onDrag:function(e){},onEnd:function(e){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getConstrainRegion:function(){var me=this;if(me.constrainTo){if(me.constrainTo instanceof Ext.util.Region)return me.constrainTo;me._constrainRegion||(me._constrainRegion=Ext.fly(me.constrainTo).getViewRegion())}else me._constrainRegion||(me._constrainRegion=me.getDragCt().getViewRegion());return me._constrainRegion},getXY:function(constrain){return constrain?this.constrainModes[constrain](this,this.lastXY):this.lastXY},getOffset:function(constrain){var xy=this.getXY(constrain),s=this.startXY;return[xy[0]-s[0],xy[1]-s[1]]},constrainModes:{point:function(me,xy){var dr=me.dragRegion,constrainTo=me.getConstrainRegion();return constrainTo?(dr.x=dr.left=dr[0]=dr.right=xy[0],dr.y=dr.top=dr[1]=dr.bottom=xy[1],dr.constrainTo(constrainTo),[dr.left,dr.top]):xy},dragTarget:function(me,xy){var adjust,s=me.startXY,dr=me.startRegion.copy(),constrainTo=me.getConstrainRegion();return constrainTo?(dr.translateBy(xy[0]-s[0],xy[1]-s[1]),dr.right>constrainTo.right&&(xy[0]+=adjust=constrainTo.right-dr.right,dr.left+=adjust),dr.left<constrainTo.left&&(xy[0]+=constrainTo.left-dr.left),dr.bottom>constrainTo.bottom&&(xy[1]+=adjust=constrainTo.bottom-dr.bottom,dr.top+=adjust),dr.top<constrainTo.top&&(xy[1]+=constrainTo.top-dr.top),xy):xy}}}),Ext.define("Ext.dd.DragZone",{extend:Ext.dd.DragSource,constructor:function(el,config){var me=this,scroll=me.containerScroll;me.callParent([el,config]),scroll&&(el=me.scrollEl||el,el=Ext.get(el),Ext.isObject(scroll)&&(el.ddScrollConfig=scroll),Ext.dd.ScrollManager.register(el))},getDragData:function(e){return Ext.dd.Registry.getHandleFromEvent(e)},onInitDrag:function(x,y){return this.proxy.update(this.dragData.ddel.cloneNode(!0)),this.onStartDrag(x,y),!0},getRepairXY:function(e){return Ext.fly(this.dragData.ddel).getXY()},destroy:function(){this.callParent(),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.scrollEl||this.el)}}),Ext.define("Ext.dd.ScrollManager",{singleton:!0,constructor:function(){var ddm=Ext.dd.DragDropManager;ddm.fireEvents=Ext.Function.createSequence(ddm.fireEvents,this.onFire,this),ddm.stopDrag=Ext.Function.createSequence(ddm.stopDrag,this.onStop,this),this.doScroll=Ext.Function.bind(this.doScroll,this),this.ddmInstance=ddm,this.els={},this.dragEl=null,this.proc={}},onStop:function(e){var sm=Ext.dd.ScrollManager;sm.dragEl=null,sm.clearProc()},triggerRefresh:function(){this.ddmInstance.dragCurrent&&this.ddmInstance.refreshCache(this.ddmInstance.dragCurrent.groups)},doScroll:function(){if(this.ddmInstance.dragCurrent){var proc=this.proc,procEl=proc.el,ddScrollConfig=proc.el.ddScrollConfig,inc=ddScrollConfig&&ddScrollConfig.increment?ddScrollConfig.increment:this.increment,animate=ddScrollConfig&&"animate"in ddScrollConfig?ddScrollConfig.animate:this.animate;animate?procEl.scroll(proc.dir,inc,!0,this.animDuration,this.triggerRefresh):procEl.scroll(proc.dir,inc)&&this.triggerRefresh()}},clearProc:function(){var proc=this.proc;proc.id&&clearInterval(proc.id),proc.id=0,proc.el=null,proc.dir=""},startProc:function(el,dir){this.clearProc(),this.proc.el=el,this.proc.dir=dir;var group=el.ddScrollConfig?el.ddScrollConfig.ddGroup:void 0,freq=el.ddScrollConfig&&el.ddScrollConfig.frequency?el.ddScrollConfig.frequency:this.frequency;void 0!==group&&this.ddmInstance.dragCurrent.ddGroup!=group||(this.proc.id=setInterval(this.doScroll,freq))},onFire:function(e,isDrop){if(!isDrop&&this.ddmInstance.dragCurrent){this.dragEl&&this.dragEl==this.ddmInstance.dragCurrent||(this.dragEl=this.ddmInstance.dragCurrent,this.refreshCache());var id,el,r,c,pt=e.getPoint(),proc=this.proc,els=this.els;for(id in els)if(el=els[id],r=el._region,c=el.ddScrollConfig?el.ddScrollConfig:this,r&&r.contains(pt)&&el.isScrollable()){if(r.bottom-pt.y<=c.vthresh)return void(proc.el!=el&&this.startProc(el,"down"));if(r.right-pt.x<=c.hthresh)return void(proc.el!=el&&this.startProc(el,"right"));if(pt.y-r.top<=c.vthresh)return void(proc.el!=el&&this.startProc(el,"up"));if(pt.x-r.left<=c.hthresh)return void(proc.el!=el&&this.startProc(el,"left"))}this.clearProc()}},register:function(el){if(Ext.isArray(el))for(var i=0,len=el.length;i<len;i++)this.register(el[i]);else el=Ext.get(el),this.els[el.id]=el},unregister:function(el){if(Ext.isArray(el))for(var i=0,len=el.length;i<len;i++)this.unregister(el[i]);else el=Ext.get(el),delete this.els[el.id]},vthresh:25,hthresh:25,increment:100,frequency:500,animate:!0,animDuration:.4,ddGroup:void 0,refreshCache:function(){var id,els=this.els;for(id in els)"object"==typeof els[id]&&(els[id]._region=els[id].getRegion())}}),Ext.define("Ext.dd.DropTarget",{extend:Ext.dd.DDTarget,constructor:function(el,config){this.el=Ext.get(el),Ext.apply(this,config),this.containerScroll&&Ext.dd.ScrollManager.register(this.el),this.callParent([this.el.dom,this.ddGroup||this.group,{isTarget:!0}])},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",isTarget:!0,isNotifyTarget:!0,notifyEnter:function(dd,e,data){return this.overClass&&this.el.addCls(this.overClass),this.dropAllowed},notifyOver:function(dd,e,data){return this.dropAllowed},notifyOut:function(dd,e,data){this.overClass&&this.el.removeCls(this.overClass)},notifyDrop:function(dd,e,data){return!1},destroy:function(){this.callParent(),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.el)}}),Ext.define("Ext.dd.Registry",{singleton:!0,constructor:function(){this.elements={},this.handles={},this.autoIdSeed=0},getId:function(el,autogen){if("string"==typeof el)return el;var id=el.id;return id||autogen===!1||(id="extdd-"+ ++this.autoIdSeed,el.id=id),id},register:function(el,data){if(data=data||{},"string"==typeof el&&(el=document.getElementById(el)),data.ddel=el,this.elements[this.getId(el)]=data,data.isHandle!==!1&&(this.handles[data.ddel.id]=data),data.handles){var i,len,hs=data.handles;for(i=0,len=hs.length;i<len;i++)this.handles[this.getId(hs[i])]=data}},unregister:function(el){var hs,i,len,id=this.getId(el,!1),data=this.elements[id];if(data&&(delete this.elements[id],data.handles))for(hs=data.handles,i=0,len=hs.length;i<len;i++)delete this.handles[this.getId(hs[i],!1)]},getHandle:function(id){return"string"!=typeof id&&(id=id.id),this.handles[id]},getHandleFromEvent:function(e){var t=e.getTarget();return t?this.handles[t.id]:null},getTarget:function(id){return"string"!=typeof id&&(id=id.id),this.elements[id]},getTargetFromEvent:function(e){var t=e.getTarget();return t?this.elements[t.id]||this.handles[t.id]:null}}),Ext.define("Ext.dd.DropZone",{extend:Ext.dd.DropTarget,getTargetFromEvent:function(e){return Ext.dd.Registry.getTargetFromEvent(e)},onNodeEnter:function(n,dd,e,data){},onNodeOver:function(n,dd,e,data){return this.dropAllowed},onNodeOut:function(n,dd,e,data){},onNodeDrop:function(n,dd,e,data){return!1},onContainerOver:function(dd,e,data){return this.dropNotAllowed},onContainerDrop:function(dd,e,data){return!1},notifyEnter:function(dd,e,data){return this.dropNotAllowed},notifyOver:function(dd,e,data){var n=this.getTargetFromEvent(e);return n?(this.lastOverNode!=n&&(this.lastOverNode&&this.onNodeOut(this.lastOverNode,dd,e,data),this.onNodeEnter(n,dd,e,data),this.lastOverNode=n),this.onNodeOver(n,dd,e,data)):(this.lastOverNode&&(this.onNodeOut(this.lastOverNode,dd,e,data),this.lastOverNode=null),this.onContainerOver(dd,e,data))},notifyOut:function(dd,e,data){this.lastOverNode&&(this.onNodeOut(this.lastOverNode,dd,e,data),this.lastOverNode=null)},notifyDrop:function(dd,e,data){var me=this,n=me.getTargetFromEvent(e),result=n?me.onNodeDrop(n,dd,e,data):me.onContainerDrop(dd,e,data);return me.lastOverNode&&(me.onNodeOut(me.lastOverNode,dd,e,data),me.lastOverNode=null),result},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}}),Ext.define("Ext.direct.Event",{alias:"direct.event",status:!0,constructor:function(config){Ext.apply(this,config)},getName:function(){return this.name;
},getData:function(){return this.data}}),Ext.define("Ext.direct.RemotingEvent",{extend:Ext.direct.Event,alias:"direct.rpc",getTransaction:function(){var me=this;return me.transaction||Ext.direct.Manager.getTransaction(me.tid)}}),Ext.define("Ext.direct.ExceptionEvent",{extend:Ext.direct.RemotingEvent,alias:"direct.exception",status:!1}),Ext.define("Ext.direct.JsonProvider",{extend:Ext.direct.Provider,alias:"direct.jsonprovider",parseResponse:function(response){return Ext.isEmpty(response.responseText)?null:Ext.isObject(response.responseText)?response.responseText:Ext.decode(response.responseText)},createEvents:function(response){var event,i,len,me=this,data=null,events=[];try{data=me.parseResponse(response)}catch(e){return event=new Ext.direct.ExceptionEvent({data:e,xhr:response,code:Ext.direct.Manager.exceptions.PARSE,message:"Error parsing json response: \n\n "+e}),[event]}if(Ext.isArray(data))for(i=0,len=data.length;i<len;++i)events.push(me.createEvent(data[i]));else Ext.isObject(data)&&events.push(me.createEvent(data));return events},createEvent:function(response){return"object"==typeof response&&"type"in response?Ext.create("direct."+response.type,response):new Ext.direct.ExceptionEvent({data:response,code:Ext.direct.Manager.exceptions.DATA,message:"Invalid data: event type is not specified"})}}),Ext.define("Ext.direct.PollingProvider",{extend:Ext.direct.JsonProvider,alias:"direct.pollingprovider",interval:3e3,constructor:function(config){var me=this;me.callParent(arguments),me.addEvents("beforepoll","poll")},isConnected:function(){return!!this.pollTask},connect:function(){var me=this,url=me.url;url&&!me.pollTask&&(me.pollTask=Ext.TaskManager.start({run:me.runPoll,interval:me.interval,scope:me}),me.fireEvent("connect",me))},disconnect:function(){var me=this;me.pollTask&&(Ext.TaskManager.stop(me.pollTask),delete me.pollTask,me.fireEvent("disconnect",me))},runPoll:function(){var me=this,url=me.url;me.fireEvent("beforepoll",me)!==!1&&(Ext.isFunction(url)?url(me.baseParams):Ext.Ajax.request({url:url,callback:me.onData,scope:me,params:me.baseParams}),me.fireEvent("poll",me))},onData:function(opt,success,response){var i,len,events,me=this;if(success)for(events=me.createEvents(response),i=0,len=events.length;i<len;++i)me.fireEvent("data",me,events[i]);else events=new Ext.direct.ExceptionEvent({data:null,code:Ext.direct.Manager.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:response}),me.fireEvent("data",me,events)}}),Ext.define("Ext.direct.RemotingMethod",{constructor:function(config){var name,pLen,p,param,me=this,params=Ext.isDefined(config.params)?config.params:config.len;if(me.name=config.name,me.formHandler=config.formHandler,Ext.isNumeric(params))me.len=params,me.ordered=!0;else for(me.params={},pLen=params.length,p=0;p<pLen;p++)param=params[p],name=Ext.isObject(param)?param.name:param,me.params[name]=!0},getArgs:function(params,paramOrder,paramsAsHash){var i,len,me=this,args=[];if(me.ordered){if(me.len>0)if(paramOrder)for(i=0,len=paramOrder.length;i<len;i++)args.push(params[paramOrder[i]]);else paramsAsHash&&args.push(params)}else args.push(params);return args},getCallData:function(args){var callback,scope,name,options,me=this,data=null,len=me.len,params=me.params;if(me.ordered)callback=args[len],scope=args[len+1],options=args[len+2],0!==len&&(data=args.slice(0,len));else{data=Ext.apply({},args[0]),callback=args[1],scope=args[2],options=args[3];for(name in data)data.hasOwnProperty(name)&&!params[name]&&delete data[name]}return{data:data,callback:callback,scope:scope,options:options}}}),Ext.define("Ext.direct.Transaction",{alias:"direct.transaction",alternateClassName:"Ext.Direct.Transaction",statics:{TRANSACTION_ID:0},constructor:function(config){var me=this;Ext.apply(me,config),me.id=me.tid=++me.self.TRANSACTION_ID,me.retryCount=0},send:function(){var me=this;me.provider.queueTransaction(me)},retry:function(){var me=this;me.retryCount++,me.send()},getProvider:function(){return this.provider}}),Ext.define("Ext.direct.RemotingProvider",{extend:Ext.direct.JsonProvider,alias:"direct.remotingprovider",enableBuffer:10,maxRetries:1,constructor:function(config){var me=this;me.callParent(arguments),me.addEvents("beforecall","call","beforecallback"),me.namespace=Ext.isString(me.namespace)?Ext.ns(me.namespace):me.namespace||Ext.global,me.transactions=new Ext.util.MixedCollection,me.callBuffer=[]},getNamespace:function(root,action){var parts,ns,i,l;for(root=root||Ext.global,parts=action.toString().split("."),i=0,l=parts.length;i<l;i++)if(ns=parts[i],root=root[ns],"undefined"==typeof root)return root;return root},createNamespaces:function(root,action){var parts,ns;root=root||Ext.global,parts=action.toString().split(".");for(var i=0,l=parts.length;i<l;i++)ns=parts[i],root[ns]=root[ns]||{},root=root[ns];return root},initAPI:function(){var action,cls,methods,i,len,method,me=this,actions=me.actions,namespace=me.namespace;for(action in actions)if(actions.hasOwnProperty(action))for(me.disableNestedActions?(cls=namespace[action],cls||(cls=namespace[action]={})):(cls=me.getNamespace(namespace,action),cls||(cls=me.createNamespaces(namespace,action))),methods=actions[action],i=0,len=methods.length;i<len;++i)method=new Ext.direct.RemotingMethod(methods[i]),cls[method.name]=me.createHandler(action,method)},createHandler:function(action,method){var handler,me=this,slice=Array.prototype.slice;return handler=method.formHandler?function(form,callback,scope){me.configureFormRequest(action,method,form,callback,scope)}:function(){me.configureRequest(action,method,slice.call(arguments,0))},handler.directCfg={action:action,method:method},handler},isConnected:function(){return!!this.connected},connect:function(){var me=this;me.url&&(me.initAPI(),me.connected=!0,me.fireEvent("connect",me))},disconnect:function(){var me=this;me.connected&&(me.connected=!1,me.fireEvent("disconnect",me))},runCallback:function(transaction,event){var callback,options,result,success=!!event.status,funcName=success?"success":"failure";transaction&&transaction.callback&&(callback=transaction.callback,options=transaction.callbackOptions,result="undefined"!=typeof event.result?event.result:event.data,Ext.isFunction(callback)?callback(result,event,success,options):(Ext.callback(callback[funcName],callback.scope,[result,event,success,options]),Ext.callback(callback.callback,callback.scope,[result,event,success,options])))},onData:function(options,success,response){var i,len,events,event,transaction,transactions,me=this;if(success)for(events=me.createEvents(response),i=0,len=events.length;i<len;++i)event=events[i],transaction=me.getTransaction(event),me.fireEvent("data",me,event),transaction&&me.fireEvent("beforecallback",me,event,transaction)!==!1&&(me.runCallback(transaction,event,!0),Ext.direct.Manager.removeTransaction(transaction));else for(transactions=[].concat(options.transaction),i=0,len=transactions.length;i<len;++i)transaction=me.getTransaction(transactions[i]),transaction&&transaction.retryCount<me.maxRetries?transaction.retry():(event=new Ext.direct.ExceptionEvent({data:null,transaction:transaction,code:Ext.direct.Manager.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:response}),me.fireEvent("data",me,event),transaction&&me.fireEvent("beforecallback",me,transaction)!==!1&&(me.runCallback(transaction,event,!1),Ext.direct.Manager.removeTransaction(transaction)))},getTransaction:function(options){return options&&options.tid?Ext.direct.Manager.getTransaction(options.tid):null},configureRequest:function(action,method,args){var callData,data,callback,scope,opts,transaction,params,me=this;callData=method.getCallData(args),data=callData.data,callback=callData.callback,scope=callData.scope,opts=callData.options||{},params=Ext.apply({},{provider:me,args:args,action:action,method:method.name,data:data,callbackOptions:opts,callback:scope&&Ext.isFunction(callback)?Ext.Function.bind(callback,scope):callback}),opts.timeout&&Ext.applyIf(params,{timeout:opts.timeout}),transaction=new Ext.direct.Transaction(params),me.fireEvent("beforecall",me,transaction,method)!==!1&&(Ext.direct.Manager.addTransaction(transaction),me.queueTransaction(transaction),me.fireEvent("call",me,transaction,method))},getCallData:function(transaction){return{action:transaction.action,method:transaction.method,data:transaction.data,type:"rpc",tid:transaction.id}},sendRequest:function(data){var request,callData,params,i,len,me=this,enableUrlEncode=me.enableUrlEncode;if(request={url:me.url,callback:me.onData,scope:me,transaction:data,timeout:me.timeout},data.timeout&&(request.timeout=data.timeout),Ext.isArray(data))for(callData=[],i=0,len=data.length;i<len;++i)callData.push(me.getCallData(data[i]));else callData=me.getCallData(data);enableUrlEncode?(params={},params[Ext.isString(enableUrlEncode)?enableUrlEncode:"data"]=Ext.encode(callData),request.params=params):request.jsonData=callData,Ext.Ajax.request(request)},queueTransaction:function(transaction){var me=this,enableBuffer=me.enableBuffer;return transaction.form?void me.sendFormRequest(transaction):enableBuffer===!1||"undefined"!=typeof transaction.timeout?void me.sendRequest(transaction):(me.callBuffer.push(transaction),void(enableBuffer?(me.callTask||(me.callTask=new Ext.util.DelayedTask(me.combineAndSend,me)),me.callTask.delay(Ext.isNumber(enableBuffer)?enableBuffer:10)):me.combineAndSend()))},combineAndSend:function(){var me=this,buffer=me.callBuffer,len=buffer.length;len>0&&(me.sendRequest(1==len?buffer[0]:buffer),me.callBuffer=[])},configureFormRequest:function(action,method,form,callback,scope){var transaction,isUpload,params,me=this;transaction=new Ext.direct.Transaction({provider:me,action:action,method:method.name,args:[form,callback,scope],callback:scope&&Ext.isFunction(callback)?Ext.Function.bind(callback,scope):callback,isForm:!0}),me.fireEvent("beforecall",me,transaction,method)!==!1&&(Ext.direct.Manager.addTransaction(transaction),isUpload="multipart/form-data"==String(form.getAttribute("enctype")).toLowerCase(),params={extTID:transaction.id,extAction:action,extMethod:method.name,extType:"rpc",extUpload:String(isUpload)},Ext.apply(transaction,{form:Ext.getDom(form),isUpload:isUpload,params:callback&&Ext.isObject(callback.params)?Ext.apply(params,callback.params):params}),me.fireEvent("call",me,transaction,method),me.sendFormRequest(transaction))},sendFormRequest:function(transaction){var me=this;Ext.Ajax.request({url:me.url,params:transaction.params,callback:me.onData,scope:me,form:transaction.form,isUpload:transaction.isUpload,transaction:transaction})}}),Ext.define("Ext.dom.Layer",{extend:Ext.Element,alternateClassName:"Ext.Layer",statics:{shims:[]},isLayer:!0,localXYNames:{get:"getLocalXY",set:"setLocalXY"},constructor:function(config,existingEl){config=config||{};var me=this,dh=Ext.DomHelper,cp=config.parentEl,pel=cp?Ext.getDom(cp):document.body,hm=config.hideMode,cls=Ext.baseCSSPrefix+(!config.fixed||Ext.isIE6||Ext.isIEQuirks?"layer":"fixed-layer");me.el=me,existingEl&&(me.dom=Ext.getDom(existingEl)),me.dom?(me.addCls(cls),me.dom.parentNode||pel.appendChild(me.dom)):me.dom=dh.append(pel,config.dh||{tag:"div",cls:cls}),config.preventSync&&(me.preventSync=!0),config.id?me.id=me.dom.id=config.id:me.id=Ext.id(me.dom),Ext.Element.addToCache(me),config.cls&&me.addCls(config.cls),me.constrain=config.constrain!==!1,hm?(me.setVisibilityMode(Ext.Element[hm.toUpperCase()]),me.visibilityMode==Ext.Element.ASCLASS&&(me.visibilityCls=config.visibilityCls)):config.useDisplay?me.setVisibilityMode(Ext.Element.DISPLAY):me.setVisibilityMode(Ext.Element.VISIBILITY),config.shadow?(me.shadowOffset=config.shadowOffset||4,me.shadow=new Ext.Shadow({offset:me.shadowOffset,mode:config.shadow,fixed:config.fixed}),me.disableShadow()):me.shadowOffset=0,me.useShim=config.shim!==!1&&Ext.useShims,config.hidden===!0?me.hide():config.hidden===!1&&me.show()},getZIndex:function(){return parseInt((this.getShim()||this).getStyle("z-index"),10)},getShim:function(){var shim,pn,me=this;return me.useShim?(me.shim||(shim=me.self.shims.shift(),shim||(shim=me.createShim(),shim.enableDisplayMode("block"),shim.hide()),pn=me.dom.parentNode,shim.dom.parentNode!=pn&&pn.insertBefore(shim.dom,me.dom),me.shim=shim),me.shim):null},hideShim:function(){var me=this;me.shim&&(me.shim.setDisplayed(!1),me.self.shims.push(me.shim),delete me.shim)},disableShadow:function(){var me=this;me.shadow&&!me.shadowDisabled&&(me.shadowDisabled=!0,me.shadow.hide(),me.lastShadowOffset=me.shadowOffset,me.shadowOffset=0)},enableShadow:function(show){var me=this;me.shadow&&me.shadowDisabled&&(me.shadowDisabled=!1,me.shadowOffset=me.lastShadowOffset,delete me.lastShadowOffset,show&&me.sync(!0))},sync:function(doShow){var shadowPos,shimStyle,shadowSize,shim,xy,x,y,w,h,shimIndex,me=this,shadow=me.shadow;if(!me.preventSync)return!me.updating&&me.isVisible()&&(shadow||me.useShim)&&(shim=me.getShim(),xy=me[me.localXYNames.get](),x=xy[0],y=xy[1],w=me.dom.offsetWidth,h=me.dom.offsetHeight,shadow&&!me.shadowDisabled?(doShow&&!shadow.isVisible()?shadow.show(me):shadow.realign(x,y,w,h),shim&&(shimIndex=shim.getStyle("z-index"),shimIndex>me.zindex&&me.shim.setStyle("z-index",me.zindex-2),shim.show(),shadow.isVisible()?(shadowPos=shadow.el.getXY(),shimStyle=shim.dom.style,shadowSize=shadow.el.getSize(),Ext.supports.CSS3BoxShadow&&(shadowSize.height+=6,shadowSize.width+=4,shadowPos[0]-=2,shadowPos[1]-=4),shimStyle.left=shadowPos[0]+"px",shimStyle.top=shadowPos[1]+"px",shimStyle.width=shadowSize.width+"px",shimStyle.height=shadowSize.height+"px"):(shim.setSize(w,h),shim[me.localXYNames.set](x,y)))):shim&&(shimIndex=shim.getStyle("z-index"),shimIndex>me.zindex&&me.shim.setStyle("z-index",me.zindex-2),shim.show(),shim.setSize(w,h),shim[me.localXYNames.set](x,y))),me},remove:function(){this.hideUnders(),this.callParent()},beginUpdate:function(){this.updating=!0},endUpdate:function(){this.updating=!1,this.sync(!0)},hideUnders:function(){this.shadow&&this.shadow.hide(),this.hideShim()},constrainXY:function(){if(this.constrain){var vw=Ext.Element.getViewWidth(),vh=Ext.Element.getViewHeight(),s=Ext.getDoc().getScroll(),xy=this.getXY(),x=xy[0],y=xy[1],so=this.shadowOffset,w=this.dom.offsetWidth+so,h=this.dom.offsetHeight+so,moved=!1;x+w>vw+s.left&&(x=vw-w-so,moved=!0),y+h>vh+s.top&&(y=vh-h-so,moved=!0),x<s.left&&(x=s.left,moved=!0),y<s.top&&(y=s.top,moved=!0),moved&&(Ext.Layer.superclass.setXY.call(this,[x,y]),this.sync())}return this},getConstrainOffset:function(){return this.shadowOffset},setVisible:function(visible,animate,duration,callback,easing){var cb,me=this;return cb=function(){visible&&me.sync(!0),callback&&callback()},visible||me.hideUnders(!0),me.callParent([visible,animate,duration,callback,easing]),animate||cb(),me},beforeFx:function(){return this.beforeAction(),this.callParent(arguments)},afterFx:function(){this.callParent(arguments),this.sync(this.isVisible())},beforeAction:function(){!this.updating&&this.shadow&&this.shadow.hide()},setLeft:function(left){return this.callParent(arguments),this.sync()},setTop:function(top){return this.callParent(arguments),this.sync()},setLeftTop:function(left,top){return this.callParent(arguments),this.sync()},setLocalX:function(){return this.callParent(arguments),this.sync()},setLocalXY:function(){return this.callParent(arguments),this.sync()},setLocalY:function(){return this.callParent(arguments),this.sync()},setXY:function(xy,animate,duration,callback,easing){var me=this;return callback=me.createCB(callback),me.fixDisplay(),me.beforeAction(),me.callParent([xy,animate,duration,callback,easing]),animate||callback(),me},createCB:function(callback){var me=this,showShadow=me.shadow&&me.shadow.isVisible();return function(){me.constrainXY(),me.sync(showShadow),callback&&callback()}},setX:function(x,animate,duration,callback,easing){return this.setXY([x,this.getY()],animate,duration,callback,easing),this},setY:function(y,animate,duration,callback,easing){return this.setXY([this.getX(),y],animate,duration,callback,easing),this},setSize:function(w,h,animate,duration,callback,easing){var me=this;return callback=me.createCB(callback),me.beforeAction(),me.callParent([w,h,animate,duration,callback,easing]),animate||callback(),me},setWidth:function(w,animate,duration,callback,easing){var me=this;return callback=me.createCB(callback),me.beforeAction(),me.callParent([w,animate,duration,callback,easing]),animate||callback(),me},setHeight:function(h,animate,duration,callback,easing){var me=this;return callback=me.createCB(callback),me.beforeAction(),me.callParent([h,animate,duration,callback,easing]),animate||callback(),me},setBounds:function(x,y,width,height,animate,duration,callback,easing){var me=this;return callback=me.createCB(callback),me.beforeAction(),animate?me.callParent([x,y,width,height,animate,duration,callback,easing]):(Ext.Layer.superclass.setXY.call(me,[x,y]),Ext.Layer.superclass.setSize.call(me,width,height),callback()),me},setZIndex:function(zindex){var me=this;return me.zindex=zindex,me.getShim()&&me.shim.setStyle("z-index",zindex++),me.shadow&&me.shadow.setZIndex(zindex++),me.setStyle("z-index",zindex)},onOpacitySet:function(opacity){var shadow=this.shadow;shadow&&shadow.setOpacity(opacity)}}),Ext.define("Ext.draw.Matrix",{constructor:function(a,b,c,d,e,f){null!=a?this.matrix=[[a,c,e],[b,d,f],[0,0,1]]:this.matrix=[[1,0,0],[0,1,0],[0,0,1]]},add:function(a,b,c,d,e,f){var x,y,z,res,me=this,out=[[],[],[]],matrix=[[a,c,e],[b,d,f],[0,0,1]];for(x=0;x<3;x++)for(y=0;y<3;y++){for(res=0,z=0;z<3;z++)res+=me.matrix[x][z]*matrix[z][y];out[x][y]=res}me.matrix=out},prepend:function(a,b,c,d,e,f){var x,y,z,res,me=this,out=[[],[],[]],matrix=[[a,c,e],[b,d,f],[0,0,1]];for(x=0;x<3;x++)for(y=0;y<3;y++){for(res=0,z=0;z<3;z++)res+=matrix[x][z]*me.matrix[z][y];out[x][y]=res}me.matrix=out},invert:function(){var matrix=this.matrix,a=matrix[0][0],b=matrix[1][0],c=matrix[0][1],d=matrix[1][1],e=matrix[0][2],f=matrix[1][2],x=a*d-b*c;return new Ext.draw.Matrix(d/x,-b/x,-c/x,a/x,(c*f-d*e)/x,(b*e-a*f)/x)},clone:function(){var matrix=this.matrix,a=matrix[0][0],b=matrix[1][0],c=matrix[0][1],d=matrix[1][1],e=matrix[0][2],f=matrix[1][2];return new Ext.draw.Matrix(a,b,c,d,e,f)},translate:function(x,y){this.prepend(1,0,0,1,x,y)},scale:function(x,y,cx,cy){var me=this;null==y&&(y=x),me.add(x,0,0,y,cx*(1-x),cy*(1-y))},rotate:function(a,x,y){a=Ext.draw.Draw.rad(a);var me=this,cos=+Math.cos(a).toFixed(9),sin=+Math.sin(a).toFixed(9);me.add(cos,sin,-sin,cos,x-cos*x+sin*y,-(sin*x)+y-cos*y)},x:function(x,y){var matrix=this.matrix;return x*matrix[0][0]+y*matrix[0][1]+matrix[0][2]},y:function(x,y){var matrix=this.matrix;return x*matrix[1][0]+y*matrix[1][1]+matrix[1][2]},get:function(i,j){return+this.matrix[i][j].toFixed(4)},toString:function(){var me=this;return[me.get(0,0),me.get(0,1),me.get(1,0),me.get(1,1),0,0].join()},toSvg:function(){var me=this;return"matrix("+[me.get(0,0),me.get(1,0),me.get(0,1),me.get(1,1),me.get(0,2),me.get(1,2)].join()+")"},toFilter:function(dx,dy){var me=this;return dx=dx||0,dy=dy||0,"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', filterType='bilinear', M11="+me.get(0,0)+", M12="+me.get(0,1)+", M21="+me.get(1,0)+", M22="+me.get(1,1)+", Dx="+(me.get(0,2)+dx)+", Dy="+(me.get(1,2)+dy)+")"},offset:function(){var matrix=this.matrix;return[(matrix[0][2]||0).toFixed(4),(matrix[1][2]||0).toFixed(4)]},split:function(){function norm(a){return a[0]*a[0]+a[1]*a[1]}function normalize(a){var mag=Math.sqrt(norm(a));a[0]/=mag,a[1]/=mag}var row,matrix=this.matrix,out={translateX:matrix[0][2],translateY:matrix[1][2]};return row=[[matrix[0][0],matrix[0][1]],[matrix[1][1],matrix[1][1]]],out.scaleX=Math.sqrt(norm(row[0])),normalize(row[0]),out.shear=row[0][0]*row[1][0]+row[0][1]*row[1][1],row[1]=[row[1][0]-row[0][0]*out.shear,row[1][1]-row[0][1]*out.shear],out.scaleY=Math.sqrt(norm(row[1])),normalize(row[1]),out.shear/=out.scaleY,out.rotate=Math.asin(-row[0][1]),out.isSimple=!(+out.shear.toFixed(9)||out.scaleX.toFixed(9)!=out.scaleY.toFixed(9)&&out.rotate),out}}),Ext.define("Ext.draw.SpriteDD",{extend:Ext.dd.DragSource,constructor:function(sprite,cfg){var me=this,el=sprite.el;me.sprite=sprite,me.el=el,me.dragData={el:el,sprite:sprite},me.callParent([el,cfg]),me.sprite.setStyle("cursor","move")},showFrame:Ext.emptyFn,createFrame:Ext.emptyFn,getDragEl:function(e){return this.el},getRegion:function(){var pos,x1,x2,y1,y2,bbox,sprite,me=this,el=me.el;sprite=me.sprite,bbox=sprite.getBBox();try{pos=Ext.Element.getXY(el)}catch(e){}return pos?(x1=pos[0],x2=x1+bbox.width,y1=pos[1],y2=y1+bbox.height,new Ext.util.Region(y1,x2,y2,x1)):null},startDrag:function(x,y){var me=this;me.sprite.attr;me.prev=me.sprite.surface.transformToViewBox(x,y)},onDrag:function(e){var dx,dy,xy=e.getXY(),me=this,sprite=me.sprite,attr=sprite.attr;xy=me.sprite.surface.transformToViewBox(xy[0],xy[1]),dx=xy[0]-me.prev[0],dy=xy[1]-me.prev[1],sprite.setAttributes({translate:{x:attr.translation.x+dx,y:attr.translation.y+dy}},!0),me.prev=xy},setDragElPos:function(){return!1}}),Ext.define("Ext.draw.Sprite",{mixins:{observable:Ext.util.Observable,animate:Ext.util.Animate},dirty:!1,dirtyHidden:!1,dirtyTransform:!1,dirtyPath:!0,dirtyFont:!0,zIndexDirty:!0,isSprite:!0,zIndex:0,fontProperties:["font","font-size","font-weight","font-style","font-family","text-anchor","text"],pathProperties:["x","y","d","path","height","width","radius","r","rx","ry","cx","cy"],constructor:function(config){var me=this;config=Ext.merge({},config||{}),me.id=Ext.id(null,"ext-sprite-"),me.transformations=[],Ext.copyTo(this,config,"surface,group,type,draggable"),me.bbox={},me.attr={zIndex:0,translation:{x:null,y:null},rotation:{degrees:null,x:null,y:null},scaling:{x:null,y:null,cx:null,cy:null}},delete config.surface,delete config.group,delete config.type,delete config.draggable,me.setAttributes(config),me.addEvents("beforedestroy","destroy","render","mousedown","mouseup","mouseover","mouseout","mousemove","click"),me.mixins.observable.constructor.apply(this,arguments)},initDraggable:function(){var me=this;me.el||me.surface.createSpriteElement(me),me.dd=new Ext.draw.SpriteDD(me,Ext.isBoolean(me.draggable)?null:me.draggable),me.on("beforedestroy",me.dd.destroy,me.dd)},setAttributes:function(attrs,redraw){var attr,i,newTranslation,translation,newRotate,rotation,newScaling,scaling,me=this,fontProps=me.fontProperties,fontPropsLength=fontProps.length,pathProps=me.pathProperties,pathPropsLength=pathProps.length,hasSurface=!!me.surface,custom=hasSurface&&me.surface.customAttributes||{},spriteAttrs=me.attr,dirtyBBox=!1;attrs=Ext.apply({},attrs);for(attr in custom)attrs.hasOwnProperty(attr)&&"function"==typeof custom[attr]&&Ext.apply(attrs,custom[attr].apply(me,[].concat(attrs[attr])));for(!!attrs.hidden!=!!spriteAttrs.hidden&&(me.dirtyHidden=!0),i=0;i<pathPropsLength;i++)if(attr=pathProps[i],attr in attrs&&attrs[attr]!==spriteAttrs[attr]){me.dirtyPath=!0,dirtyBBox=!0;break}"zIndex"in attrs&&(me.zIndexDirty=!0),"text"in attrs&&(me.dirtyFont=!0,dirtyBBox=!0,attrs.text=me.transformText(attrs.text));for(i=0;i<fontPropsLength;i++)if(attr=fontProps[i],attr in attrs&&attrs[attr]!==spriteAttrs[attr]){me.dirtyFont=!0,dirtyBBox=!0;break}return newTranslation=attrs.translation||attrs.translate,delete attrs.translate,delete attrs.translation,translation=spriteAttrs.translation,newTranslation&&("x"in newTranslation&&newTranslation.x!==translation.x||"y"in newTranslation&&newTranslation.y!==translation.y)&&(me.dirtyTransform=!0,translation.x=newTranslation.x,translation.y=newTranslation.y),newRotate=attrs.rotation||attrs.rotate,rotation=spriteAttrs.rotation,delete attrs.rotate,delete attrs.rotation,newRotate&&("x"in newRotate&&newRotate.x!==rotation.x||"y"in newRotate&&newRotate.y!==rotation.y||"degrees"in newRotate&&newRotate.degrees!==rotation.degrees)&&(me.dirtyTransform=!0,rotation.x=newRotate.x,rotation.y=newRotate.y,rotation.degrees=newRotate.degrees),newScaling=attrs.scaling||attrs.scale,scaling=spriteAttrs.scaling,delete attrs.scale,delete attrs.scaling,newScaling&&("x"in newScaling&&newScaling.x!==scaling.x||"y"in newScaling&&newScaling.y!==scaling.y||"cx"in newScaling&&newScaling.cx!==scaling.cx||"cy"in newScaling&&newScaling.cy!==scaling.cy)&&(me.dirtyTransform=!0,scaling.x=newScaling.x,scaling.y=newScaling.y,scaling.cx=newScaling.cx,scaling.cy=newScaling.cy),!me.dirtyTransform&&dirtyBBox&&(null!==spriteAttrs.scaling.x&&null!==spriteAttrs.scaling.y&&null!==spriteAttrs.rotation.y&&null!==spriteAttrs.rotation.y||(me.dirtyTransform=!0)),Ext.apply(spriteAttrs,attrs),me.dirty=!0,redraw===!0&&hasSurface&&me.redraw(),this},transformText:Ext.identityFn,getBBox:function(){return this.surface.getBBox(this)},setText:function(text){return this.surface.setText(this,text)},hide:function(redraw){return this.setAttributes({hidden:!0},redraw),this},show:function(redraw){return this.setAttributes({hidden:!1},redraw),this},remove:function(){return!!this.surface&&(this.surface.remove(this),!0)},onRemove:function(){this.surface.onRemove(this)},destroy:function(){var me=this;me.fireEvent("beforedestroy",me)!==!1&&(me.remove(),me.surface.onDestroy(me),me.clearListeners(),me.fireEvent("destroy"))},redraw:function(){var owner,me=this,changed=!me.el||me.dirty,surface=me.surface;return surface.renderItem(me),changed&&(owner=surface.owner,!me.isBackground&&owner&&(owner.viewBox||owner.autoSize)&&owner.configureSurfaceSize()),this},setStyle:function(){return this.el.setStyle.apply(this.el,arguments),this},addCls:function(obj){return this.surface.addCls(this,obj),this},removeCls:function(obj){return this.surface.removeCls(this,obj),this}}),Ext.define("Ext.draw.Text",{extend:Ext.draw.Component,alias:"widget.text",text:"",focusable:!1,viewBox:!1,autoSize:!0,baseCls:Ext.baseCSSPrefix+"surface "+Ext.baseCSSPrefix+"draw-text",initComponent:function(){var me=this;me.textConfig=Ext.apply({type:"text",text:me.text,rotate:{degrees:me.degrees||0}},me.textStyle),Ext.apply(me.textConfig,me.getStyles(me.styleSelectors||me.styleSelector)),me.initialConfig.items=[me.textConfig],me.callParent(arguments)},getStyles:function(selectors){selectors=Ext.Array.from(selectors);for(var rule,style,i=0,len=selectors.length,result={};i<len;i++)rule=Ext.util.CSS.getRule(selectors[i]),rule&&(style=rule.style,style&&Ext.apply(result,{"font-family":style.fontFamily,"font-weight":style.fontWeight,"line-height":style.lineHeight,"font-size":style.fontSize,fill:style.color}));return result},setAngle:function(degrees){var surface,sprite,me=this;me.rendered?(surface=me.surface,sprite=surface.items.items[0],me.degrees=degrees,sprite.setAttributes({rotate:{degrees:degrees}},!0),(me.autoSize||me.viewBox)&&me.updateLayout()):me.degrees=degrees},setText:function(text){var surface,sprite,me=this;me.rendered?(surface=me.surface,sprite=surface.items.items[0],me.text=text||"",surface.remove(sprite),me.textConfig.type="text",me.textConfig.text=me.text,sprite=surface.add(me.textConfig),sprite.setAttributes({rotate:{degrees:me.degrees}},!0),(me.autoSize||me.viewBox)&&me.updateLayout()):me.on({render:function(){me.setText(text)},single:!0})}}),Ext.define("Ext.draw.engine.ImageExporter",{singleton:!0,defaultUrl:"http://svg.sencha.io",supportedTypes:["image/png","image/jpeg"],widthParam:"width",heightParam:"height",typeParam:"type",svgParam:"svg",formCls:Ext.baseCSSPrefix+"hide-display",generate:function(surface,config){config=config||{};var form,me=this,type=config.type;return Ext.Array.indexOf(me.supportedTypes,type)!==-1&&(form=Ext.getBody().createChild({tag:"form",method:"POST",action:config.url||me.defaultUrl,cls:me.formCls,children:[{tag:"input",type:"hidden",name:config.widthParam||me.widthParam,value:config.width||surface.width},{tag:"input",type:"hidden",name:config.heightParam||me.heightParam,value:config.height||surface.height},{tag:"input",type:"hidden",name:config.typeParam||me.typeParam,value:type},{tag:"input",type:"hidden",name:config.svgParam||me.svgParam}]}),form.last(null,!0).value=Ext.draw.engine.SvgExporter.generate(surface),form.dom.submit(),form.remove(),!0)}}),Ext.define("Ext.draw.engine.Svg",{extend:Ext.draw.Surface,engine:"Svg",trimRe:/^\s+|\s+$/g,spacesRe:/\s+/,xlink:"http://www.w3.org/1999/xlink",translateAttrs:{radius:"r",radiusX:"rx",radiusY:"ry",path:"d",lineWidth:"stroke-width",fillOpacity:"fill-opacity",strokeOpacity:"stroke-opacity",strokeLinejoin:"stroke-linejoin"},parsers:{},minDefaults:{circle:{cx:0,cy:0,r:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},ellipse:{cx:0,cy:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},rect:{x:0,y:0,width:0,height:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},text:{x:0,y:0,"text-anchor":"start","font-family":null,"font-size":null,"font-weight":null,"font-style":null,fill:"#000",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},path:{d:"M0,0",fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},image:{x:0,y:0,width:0,height:0,preserveAspectRatio:"none",opacity:null}},createSvgElement:function(type,attrs){var key,el=this.domRef.createElementNS("http://www.w3.org/2000/svg",type);if(attrs)for(key in attrs)el.setAttribute(key,String(attrs[key]));return el},createSpriteElement:function(sprite){var el=this.createSvgElement(sprite.type);return el.id=sprite.id,el.style&&(el.style.webkitTapHighlightColor="rgba(0,0,0,0)"),sprite.el=Ext.get(el),this.applyZIndex(sprite),sprite.matrix=new Ext.draw.Matrix,sprite.bbox={plain:0,transform:0},this.applyAttrs(sprite),this.applyTransformations(sprite),sprite.fireEvent("render",sprite),el},getBBoxText:function(sprite){var bb,height,width,i,ln,el,bbox={};if(sprite&&sprite.el){el=sprite.el.dom;try{return bbox=el.getBBox()}catch(e){}for(bbox={x:bbox.x,y:1/0,width:0,height:0},ln=el.getNumberOfChars(),i=0;i<ln;i++)bb=el.getExtentOfChar(i),bbox.y=Math.min(bb.y,bbox.y),height=bb.y+bb.height-bbox.y,bbox.height=Math.max(bbox.height,height),width=bb.x+bb.width-bbox.x,bbox.width=Math.max(bbox.width,width);return bbox}},hide:function(){Ext.get(this.el).hide()},show:function(){Ext.get(this.el).show()},hidePrim:function(sprite){this.addCls(sprite,Ext.baseCSSPrefix+"hide-visibility")},showPrim:function(sprite){this.removeCls(sprite,Ext.baseCSSPrefix+"hide-visibility")},getDefs:function(){return this._defs||(this._defs=this.createSvgElement("defs"))},transform:function(sprite,matrixOnly){for(var transform,type,matrix=new Ext.draw.Matrix,transforms=sprite.transformations,transformsLength=transforms.length,i=0;i<transformsLength;i++)transform=transforms[i],type=transform.type,"translate"==type?matrix.translate(transform.x,transform.y):"rotate"==type?matrix.rotate(transform.degrees,transform.x,transform.y):"scale"==type&&matrix.scale(transform.x,transform.y,transform.centerX,transform.centerY);sprite.matrix=matrix,matrixOnly||sprite.el.set({transform:matrix.toSvg()})},setSize:function(width,height){var me=this,el=me.el;width=+width||me.width,height=+height||me.height,me.width=width,me.height=height,el.setSize(width,height),el.set({width:width,height:height}),me.callParent([width,height])},getRegion:function(){var svgXY=this.el.getXY(),rectXY=this.bgRect.getXY(),max=Math.max,x=max(svgXY[0],rectXY[0]),y=max(svgXY[1],rectXY[1]);return{left:x,top:y,right:x+this.width,bottom:y+this.height}},onRemove:function(sprite){sprite.el&&(sprite.el.destroy(),delete sprite.el),this.callParent(arguments)},setViewBox:function(x,y,width,height){isFinite(x)&&isFinite(y)&&isFinite(width)&&isFinite(height)&&(this.callParent(arguments),this.el.dom.setAttribute("viewBox",[x,y,width,height].join(" ")))},render:function(container){var el,defs,bgRect,webkitRect,me=this;me.el||(cfg={xmlns:"http://www.w3.org/2000/svg",version:1.1,width:me.width||0,height:me.height||0},me.forceLtr&&(cfg.direction="ltr"),el=me.createSvgElement("svg",cfg),defs=me.getDefs(),bgRect=me.createSvgElement("rect",{
width:"100%",height:"100%",fill:"#000",stroke:"none",opacity:0}),Ext.isSafari3&&(webkitRect=me.createSvgElement("rect",{x:-10,y:-10,width:"110%",height:"110%",fill:"none",stroke:"#000"})),el.appendChild(defs),Ext.isSafari3&&el.appendChild(webkitRect),el.appendChild(bgRect),container.appendChild(el),me.el=Ext.get(el),me.bgRect=Ext.get(bgRect),Ext.isSafari3&&(me.webkitRect=Ext.get(webkitRect),me.webkitRect.hide()),me.el.on({scope:me,mouseup:me.onMouseUp,mousedown:me.onMouseDown,mouseover:me.onMouseOver,mouseout:me.onMouseOut,mousemove:me.onMouseMove,mouseenter:me.onMouseEnter,mouseleave:me.onMouseLeave,click:me.onClick,dblclick:me.onDblClick})),me.renderAll()},onMouseEnter:function(e){this.el.parent().getRegion().contains(e.getPoint())&&this.fireEvent("mouseenter",e)},onMouseLeave:function(e){this.el.parent().getRegion().contains(e.getPoint())||this.fireEvent("mouseleave",e)},processEvent:function(name,e){var sprite,target=e.getTarget();this.surface;this.fireEvent(name,e),"tspan"==target.nodeName&&target.parentNode&&(target=target.parentNode),sprite=this.items.get(target.id),sprite&&sprite.fireEvent(name,sprite,e)},tuneText:function(sprite,attrs){var height,text,i,ln,factor,x,tspans=(sprite.el.dom,[]);if(attrs.hasOwnProperty("text")&&(text=sprite.tspans&&Ext.Array.map(sprite.tspans,function(t){return t.textContent}).join(""),sprite.tspans&&attrs.text==text?tspans=sprite.tspans||[]:(tspans=this.setText(sprite,attrs.text),sprite.tspans=tspans)),tspans.length){for(height=this.getBBoxText(sprite).height,x=sprite.el.dom.getAttribute("x"),i=0,ln=tspans.length;i<ln;i++)factor=Ext.isFF3_0||Ext.isFF3_5?2:4,tspans[i].setAttribute("x",x),tspans[i].setAttribute("dy",i?1.2*height:height/factor);sprite.dirty=!0}},setText:function(sprite,textString){for(var tspan,text,i,ln,texts,me=this,el=sprite.el.dom,tspans=[];el.firstChild;)el.removeChild(el.firstChild);for(texts=String(textString).split("\n"),i=0,ln=texts.length;i<ln;i++)text=texts[i],text&&(tspan=me.createSvgElement("tspan"),tspan.appendChild(document.createTextNode(Ext.htmlDecode(text))),el.appendChild(tspan),tspans[i]=tspan);return tspans},renderAll:function(){this.items.each(this.renderItem,this)},renderItem:function(sprite){this.el&&(sprite.el||this.createSpriteElement(sprite),sprite.zIndexDirty&&this.applyZIndex(sprite),sprite.dirty&&(this.applyAttrs(sprite),sprite.dirtyTransform&&this.applyTransformations(sprite)))},redraw:function(sprite){sprite.dirty=sprite.zIndexDirty=!0,this.renderItem(sprite)},applyAttrs:function(sprite){var groups,i,ln,attrs,key,style,me=this,el=sprite.el,group=sprite.group,sattr=sprite.attr,parsers=me.parsers,gradientsMap=me.gradientsMap||{},safariFix=Ext.isSafari&&!Ext.isStrict;if(group){for(groups=[].concat(group),ln=groups.length,i=0;i<ln;i++)group=groups[i],me.getGroup(group).add(sprite);delete sprite.group}attrs=me.scrubAttrs(sprite)||{},sprite.bbox.plain=0,sprite.bbox.transform=0,"circle"==sprite.type||"ellipse"==sprite.type?(attrs.cx=attrs.cx||attrs.x,attrs.cy=attrs.cy||attrs.y):"rect"==sprite.type?attrs.rx=attrs.ry=attrs.r:"path"==sprite.type&&attrs.d&&(attrs.d=Ext.draw.Draw.pathToString(Ext.draw.Draw.pathToAbsolute(attrs.d))),sprite.dirtyPath=!1,attrs["clip-rect"]&&(me.setClip(sprite,attrs),delete attrs["clip-rect"]),"text"==sprite.type&&attrs.font&&sprite.dirtyFont&&el.set({style:"font: "+attrs.font}),"image"==sprite.type&&el.dom.setAttributeNS(me.xlink,"href",attrs.src),Ext.applyIf(attrs,me.minDefaults[sprite.type]),sprite.dirtyHidden&&(sattr.hidden?me.hidePrim(sprite):me.showPrim(sprite),sprite.dirtyHidden=!1);for(key in attrs)if(attrs.hasOwnProperty(key)&&null!=attrs[key]){if(safariFix&&"color|stroke|fill".indexOf(key)>-1&&attrs[key]in gradientsMap&&(attrs[key]=gradientsMap[attrs[key]]),"hidden"==key&&"text"==sprite.type)continue;key in parsers?el.dom.setAttribute(key,parsers[key](attrs[key],sprite,me)):el.dom.setAttribute(key,attrs[key])}"text"==sprite.type&&me.tuneText(sprite,attrs),sprite.dirtyFont=!1,style=sattr.style,style&&el.setStyle(style),sprite.dirty=!1,Ext.isSafari3&&(me.webkitRect.show(),setTimeout(function(){me.webkitRect.hide()}))},setClip:function(sprite,params){var clipEl,clipPath,me=this,rect=params["clip-rect"];rect&&(sprite.clip&&sprite.clip.parentNode.parentNode.removeChild(sprite.clip.parentNode),clipEl=me.createSvgElement("clipPath"),clipPath=me.createSvgElement("rect"),clipEl.id=Ext.id(null,"ext-clip-"),clipPath.setAttribute("x",rect.x),clipPath.setAttribute("y",rect.y),clipPath.setAttribute("width",rect.width),clipPath.setAttribute("height",rect.height),clipEl.appendChild(clipPath),me.getDefs().appendChild(clipEl),sprite.el.dom.setAttribute("clip-path","url(#"+clipEl.id+")"),sprite.clip=clipPath)},applyZIndex:function(sprite){var prevEl,me=this,items=me.items,idx=items.indexOf(sprite),el=sprite.el;if(me.el.dom.childNodes[idx+2]!==el.dom){if(idx>0)do prevEl=items.getAt(--idx).el;while(!prevEl&&idx>0);el.insertAfter(prevEl||me.bgRect)}sprite.zIndexDirty=!1},createItem:function(config){var sprite=new Ext.draw.Sprite(config);return sprite.surface=this,sprite},addGradient:function(gradient){gradient=Ext.draw.Draw.parseGradient(gradient);var gradientEl,stop,stopEl,i,gradientsMap,me=this,ln=gradient.stops.length,vector=gradient.vector,usePlain=Ext.isSafari&&!Ext.isStrict;if(gradientsMap=me.gradientsMap||{},usePlain)gradientsMap["url(#"+gradient.id+")"]=gradient.stops[0].color;else for("linear"==gradient.type?(gradientEl=me.createSvgElement("linearGradient"),gradientEl.setAttribute("x1",vector[0]),gradientEl.setAttribute("y1",vector[1]),gradientEl.setAttribute("x2",vector[2]),gradientEl.setAttribute("y2",vector[3])):(gradientEl=me.createSvgElement("radialGradient"),gradientEl.setAttribute("cx",gradient.centerX),gradientEl.setAttribute("cy",gradient.centerY),gradientEl.setAttribute("r",gradient.radius),Ext.isNumber(gradient.focalX)&&Ext.isNumber(gradient.focalY)&&(gradientEl.setAttribute("fx",gradient.focalX),gradientEl.setAttribute("fy",gradient.focalY))),gradientEl.id=gradient.id,me.getDefs().appendChild(gradientEl),i=0;i<ln;i++)stop=gradient.stops[i],stopEl=me.createSvgElement("stop"),stopEl.setAttribute("offset",stop.offset+"%"),stopEl.setAttribute("stop-color",stop.color),stopEl.setAttribute("stop-opacity",stop.opacity),gradientEl.appendChild(stopEl);me.gradientsMap=gradientsMap},hasCls:function(sprite,className){return className&&(" "+(sprite.el.dom.getAttribute("class")||"")+" ").indexOf(" "+className+" ")!=-1},addCls:function(sprite,className){var i,len,v,el=sprite.el,cls=[],curCls=el.getAttribute("class")||"";if(Ext.isArray(className)){for(i=0,len=className.length;i<len;i++)v=className[i],"string"==typeof v&&(" "+curCls+" ").indexOf(" "+v+" ")==-1&&cls.push(v);cls.length&&el.set({class:" "+cls.join(" ")})}else"string"!=typeof className||this.hasCls(sprite,className)||el.set({class:curCls+" "+className})},removeCls:function(sprite,className){var i,idx,len,cls,elClasses,me=this,el=sprite.el,curCls=el.getAttribute("class")||"";if(Ext.isArray(className)||(className=[className]),curCls){for(elClasses=curCls.replace(me.trimRe," ").split(me.spacesRe),i=0,len=className.length;i<len;i++)cls=className[i],"string"==typeof cls&&(cls=cls.replace(me.trimRe,""),idx=Ext.Array.indexOf(elClasses,cls),idx!=-1&&Ext.Array.erase(elClasses,idx,1));el.set({class:elClasses.join(" ")})}},destroy:function(){var me=this;me.callParent(),me.el&&me.el.remove(),me._defs&&Ext.get(me._defs).destroy(),me.bgRect&&Ext.get(me.bgRect).destroy(),me.webkitRect&&Ext.get(me.webkitRect).destroy(),delete me.el}}),Ext.define("Ext.draw.engine.SvgExporter",function(){var surface,len,width,height,commaRe=/,/g,fontRegex=/(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)\s('*.*'*)/,rgbColorRe=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,rgbaColorRe=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,([\d\.]+)\)/g,init=function(s){surface=s,len=surface.length,width=surface.width,height=surface.height},spriteProcessor={path:function(sprite){var props,p,pLen,attr=sprite.attr,path=attr.path,pathString="";if(Ext.isArray(path[0]))for(pLen=path.length,p=0;p<pLen;p++)pathString+=path[p].join(" ");else pathString=Ext.isArray(path)?path.join(" "):path.replace(commaRe," ");return props=toPropertyString({d:pathString,fill:attr.fill||"none",stroke:attr.stroke,"fill-opacity":attr.opacity,"stroke-width":attr["stroke-width"],"stroke-opacity":attr["stroke-opacity"],"z-index":attr.zIndex,transform:sprite.matrix.toSvg()}),"<path "+props+"/>"},text:function(sprite){var props,attr=sprite.attr,match=fontRegex.exec(attr.font),size=match&&match[1]||"12",family=match&&match[3]||"Arial",text=attr.text,factor=Ext.isFF3_0||Ext.isFF3_5?2:4,tspanString="";return sprite.getBBox(),tspanString+='<tspan x="'+(attr.x||"")+'" dy="',tspanString+=size/factor+'">',tspanString+=Ext.htmlEncode(text)+"</tspan>",props=toPropertyString({x:attr.x,y:attr.y,"font-size":size,"font-family":family,"font-weight":attr["font-weight"],"text-anchor":attr["text-anchor"],fill:attr.fill||"#000","fill-opacity":attr.opacity,transform:sprite.matrix.toSvg()}),"<text "+props+">"+tspanString+"</text>"},rect:function(sprite){var attr=sprite.attr,props=toPropertyString({x:attr.x,y:attr.y,rx:attr.rx,ry:attr.ry,width:attr.width,height:attr.height,fill:attr.fill||"none","fill-opacity":attr.opacity,stroke:attr.stroke,"stroke-opacity":attr["stroke-opacity"],"stroke-width":attr["stroke-width"],transform:sprite.matrix&&sprite.matrix.toSvg()});return"<rect "+props+"/>"},circle:function(sprite){var attr=sprite.attr,props=toPropertyString({cx:attr.x,cy:attr.y,r:attr.radius,fill:attr.translation.fill||attr.fill||"none","fill-opacity":attr.opacity,stroke:attr.stroke,"stroke-opacity":attr["stroke-opacity"],"stroke-width":attr["stroke-width"],transform:sprite.matrix.toSvg()});return"<circle "+props+" />"},image:function(sprite){var attr=sprite.attr,props=toPropertyString({x:attr.x-(attr.width/2>>0),y:attr.y-(attr.height/2>>0),width:attr.width,height:attr.height,"xlink:href":attr.src,transform:sprite.matrix.toSvg()});return"<image "+props+" />"}},svgHeader=function(){var svg='<?xml version="1.0" standalone="yes"?>';return svg+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'},svgContent=function(){var item,itemsLen,items,gradient,getSvgString,colorstops,stop,coll,keys,colls,k,kLen,key,collI,i,stopsLen,sortedItems,za,zb,svg='<svg width="'+width+'px" height="'+height+'px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',defs="";if(items=surface.items.items,itemsLen=items.length,getSvgString=function(node){for(var attrLength,j,child,attr,tagName,attrItem,childs=node.childNodes,childLength=childs.length,i=0,svgString="";i<childLength;i++){for(child=childs[i],attr=child.attributes,tagName=child.tagName,svgString+="<"+tagName,j=0,attrLength=attr.length;j<attrLength;j++)attrItem=attr.item(j),svgString+=" "+attrItem.name+'="'+attrItem.value+'"';svgString+=">",child.childNodes.length>0&&(svgString+=getSvgString(child)),svgString+="</"+tagName+">"}return svgString},surface.getDefs)defs=getSvgString(surface.getDefs());else for(coll=surface.gradientsColl,coll&&(keys=coll.keys,colls=coll.items,k=0,kLen=keys.length);k<kLen;k++){key=keys[k],collI=colls[k],gradient=surface.gradientsColl.getByKey(key),defs+='<linearGradient id="'+key+'" x1="0" y1="0" x2="1" y2="1">';var color=gradient.colors.replace(rgbColorRe,"rgb($1|$2|$3)");for(color=color.replace(rgbaColorRe,"rgba($1|$2|$3|$4)"),colorstops=color.split(","),i=0,stopsLen=colorstops.length;i<stopsLen;i++)stop=colorstops[i].split(" "),color=Ext.draw.Color.fromString(stop[1].replace(/\|/g,",")),defs+='<stop offset="'+stop[0]+'" stop-color="'+color.toString()+'" stop-opacity="1"></stop>';defs+="</linearGradient>"}for(svg+="<defs>"+defs+"</defs>",svg+=spriteProcessor.rect({attr:{width:"100%",height:"100%",fill:"#fff",stroke:"none",opacity:"0"}}),sortedItems=new Array(itemsLen),i=0;i<itemsLen;i++)sortedItems[i]=i;for(sortedItems.sort(function(a,b){return za=items[a].attr.zIndex||0,zb=items[b].attr.zIndex||0,za==zb?a-b:za-zb}),i=0;i<itemsLen;i++)item=items[sortedItems[i]],item.attr.hidden||(svg+=spriteProcessor[item.type](item));return svg+="</svg>"},toPropertyString=function(obj){var key,propString="";for(key in obj)obj.hasOwnProperty(key)&&null!=obj[key]&&(propString+=key+'="'+obj[key]+'" ');return propString};return{singleton:!0,generate:function(surface,config){return config=config||{},init(surface),svgHeader()+svgContent()}}}),Ext.define("Ext.draw.engine.Vml",{extend:Ext.draw.Surface,engine:"Vml",map:{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},bitesRe:/([clmz]),?([^clmz]*)/gi,valRe:/-?[^,\s\-]+/g,fillUrlRe:/^url\(\s*['"]?([^\)]+?)['"]?\s*\)$/i,pathlike:/^(path|rect)$/,NonVmlPathRe:/[ahqstv]/gi,partialPathRe:/[clmz]/g,fontFamilyRe:/^['"]+|['"]+$/g,baseVmlCls:Ext.baseCSSPrefix+"vml-base",vmlGroupCls:Ext.baseCSSPrefix+"vml-group",spriteCls:Ext.baseCSSPrefix+"vml-sprite",measureSpanCls:Ext.baseCSSPrefix+"vml-measure-span",zoom:21600,coordsize:1e3,coordorigin:"0 0",zIndexShift:0,orderSpritesByZIndex:!1,path2vml:function(path){var res,pa,p,r,i,ii,j,jj,me=this,nonVML=me.NonVmlPathRe,map=me.map,val=me.valRe,zoom=me.zoom,bites=me.bitesRe,command=Ext.Function.bind(Ext.draw.Draw.pathToAbsolute,Ext.draw.Draw);if(String(path).match(nonVML))command=Ext.Function.bind(Ext.draw.Draw.path2curve,Ext.draw.Draw);else if(!String(path).match(me.partialPathRe))return res=String(path).replace(bites,function(all,command,args){var vals=[],isMove="m"==command.toLowerCase(),res=map[command];return args.replace(val,function(value){isMove&&2===vals.length&&(res+=vals+map["m"==command?"l":"L"],vals=[]),vals.push(Math.round(value*zoom))}),res+vals});for(pa=command(path),res=[],i=0,ii=pa.length;i<ii;i++){for(p=pa[i],r=pa[i][0].toLowerCase(),"z"==r&&(r="x"),j=1,jj=p.length;j<jj;j++)r+=Math.round(p[j]*me.zoom)+(j!=jj-1?",":"");res.push(r)}return res.join(" ")},translateAttrs:{radius:"r",radiusX:"rx",radiusY:"ry",lineWidth:"stroke-width",fillOpacity:"fill-opacity",strokeOpacity:"stroke-opacity",strokeLinejoin:"stroke-linejoin"},minDefaults:{circle:{fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},ellipse:{cx:0,cy:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},rect:{x:0,y:0,width:0,height:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},text:{x:0,y:0,"text-anchor":"start",font:'10px "Arial"',fill:"#000",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},path:{d:"M0,0",fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},image:{x:0,y:0,width:0,height:0,preserveAspectRatio:"none",opacity:null}},onMouseEnter:function(e){this.fireEvent("mouseenter",e)},onMouseLeave:function(e){this.fireEvent("mouseleave",e)},processEvent:function(name,e){var sprite,target=e.getTarget();this.surface;this.fireEvent(name,e),sprite=this.items.get(target.id),sprite&&sprite.fireEvent(name,sprite,e)},createSpriteElement:function(sprite){var path,skew,textPath,me=this,attr=sprite.attr,type=sprite.type,zoom=me.zoom,vml=sprite.vml||(sprite.vml={}),el=(Math.round,"image"===type?me.createNode("image"):me.createNode("shape"));return el.coordsize=zoom+" "+zoom,el.coordorigin=attr.coordorigin||"0 0",Ext.get(el).addCls(me.spriteCls),"text"==type&&(vml.path=path=me.createNode("path"),path.textpathok=!0,vml.textpath=textPath=me.createNode("textpath"),textPath.on=!0,el.appendChild(textPath),el.appendChild(path)),el.id=sprite.id,sprite.el=Ext.get(el),sprite.el.setStyle("zIndex",-me.zIndexShift),me.el.appendChild(el),"image"!==type&&(skew=me.createNode("skew"),skew.on=!0,el.appendChild(skew),sprite.skew=skew),sprite.matrix=new Ext.draw.Matrix,sprite.bbox={plain:null,transform:null},this.applyAttrs(sprite),this.applyTransformations(sprite),sprite.fireEvent("render",sprite),sprite.el},getBBoxText:function(sprite){var vml=sprite.vml;return{x:vml.X+(vml.bbx||0)-vml.W/2,y:vml.Y-vml.H/2,width:vml.W,height:vml.H}},applyAttrs:function(sprite){var style,groups,i,ln,scrubbedAttrs,cx,cy,rx,ry,me=this,group=(sprite.vml,sprite.group),spriteAttr=sprite.attr,el=sprite.el,dom=el.dom;if(group){for(groups=[].concat(group),ln=groups.length,i=0;i<ln;i++)group=groups[i],me.getGroup(group).add(sprite);delete sprite.group}scrubbedAttrs=me.scrubAttrs(sprite)||{},sprite.zIndexDirty&&me.setZIndex(sprite),Ext.applyIf(scrubbedAttrs,me.minDefaults[sprite.type]),"image"==sprite.type&&(Ext.apply(sprite.attr,{x:scrubbedAttrs.x,y:scrubbedAttrs.y,width:scrubbedAttrs.width,height:scrubbedAttrs.height}),el.setStyle({width:scrubbedAttrs.width+"px",height:scrubbedAttrs.height+"px"}),dom.src=scrubbedAttrs.src),dom.href&&(dom.href=scrubbedAttrs.href),dom.title&&(dom.title=scrubbedAttrs.title),dom.target&&(dom.target=scrubbedAttrs.target),dom.cursor&&(dom.cursor=scrubbedAttrs.cursor),sprite.dirtyHidden&&(scrubbedAttrs.hidden?me.hidePrim(sprite):me.showPrim(sprite),sprite.dirtyHidden=!1),sprite.dirtyPath&&("circle"==sprite.type||"ellipse"==sprite.type?(cx=scrubbedAttrs.x,cy=scrubbedAttrs.y,rx=scrubbedAttrs.rx||scrubbedAttrs.r||0,ry=scrubbedAttrs.ry||scrubbedAttrs.r||0,dom.path=Ext.String.format("ar{0},{1},{2},{3},{4},{1},{4},{1}",Math.round((cx-rx)*me.zoom),Math.round((cy-ry)*me.zoom),Math.round((cx+rx)*me.zoom),Math.round((cy+ry)*me.zoom),Math.round(cx*me.zoom)),sprite.dirtyPath=!1):"text"!==sprite.type&&"image"!==sprite.type&&(sprite.attr.path=scrubbedAttrs.path=me.setPaths(sprite,scrubbedAttrs)||scrubbedAttrs.path,dom.path=me.path2vml(scrubbedAttrs.path),sprite.dirtyPath=!1)),"clip-rect"in scrubbedAttrs&&me.setClip(sprite,scrubbedAttrs),"text"==sprite.type&&me.setTextAttributes(sprite,scrubbedAttrs),(scrubbedAttrs.opacity||scrubbedAttrs["stroke-opacity"]||scrubbedAttrs.fill)&&me.setFill(sprite,scrubbedAttrs),(scrubbedAttrs.stroke||scrubbedAttrs["stroke-opacity"]||scrubbedAttrs.fill)&&me.setStroke(sprite,scrubbedAttrs),style=spriteAttr.style,style&&el.setStyle(style),sprite.dirty=!1},setZIndex:function(sprite){var items,iLen,item,i,me=this,zIndex=sprite.attr.zIndex,shift=me.zIndexShift;if(zIndex<shift){for(items=me.items.items,iLen=items.length,i=0;i<iLen;i++)(zIndex=items[i].attr.zIndex)&&zIndex<shift&&(shift=zIndex);for(me.zIndexShift=shift,i=0;i<iLen;i++)item=items[i],item.el&&item.el.setStyle("zIndex",item.attr.zIndex-shift),item.zIndexDirty=!1}else sprite.el&&(sprite.el.setStyle("zIndex",zIndex-shift),sprite.zIndexDirty=!1)},setPaths:function(sprite,params){var spriteAttr=sprite.attr;sprite.attr["stroke-width"]||1;return sprite.bbox.plain=null,sprite.bbox.transform=null,"circle"==sprite.type?(spriteAttr.rx=spriteAttr.ry=params.r,Ext.draw.Draw.ellipsePath(sprite)):"ellipse"==sprite.type?(spriteAttr.rx=params.rx,spriteAttr.ry=params.ry,Ext.draw.Draw.ellipsePath(sprite)):"rect"==sprite.type?(spriteAttr.rx=spriteAttr.ry=params.r,Ext.draw.Draw.rectPath(sprite)):!("path"!=sprite.type||!spriteAttr.path)&&Ext.draw.Draw.pathToAbsolute(spriteAttr.path)},setFill:function(sprite,params){var gradient,fillUrl,rotation,angle,me=this,el=sprite.el.dom,fillEl=el.fill,newfill=!1;fillEl||(fillEl=el.fill=me.createNode("fill"),newfill=!0),Ext.isArray(params.fill)&&(params.fill=params.fill[0]),"none"==params.fill?fillEl.on=!1:("number"==typeof params.opacity&&(fillEl.opacity=params.opacity),"number"==typeof params["fill-opacity"]&&(fillEl.opacity=params["fill-opacity"]),fillEl.on=!0,"string"==typeof params.fill&&(fillUrl=params.fill.match(me.fillUrlRe),fillUrl?(fillUrl=fillUrl[1],"#"==fillUrl.charAt(0)&&(gradient=me.gradientsColl.getByKey(fillUrl.substring(1))),gradient?(rotation=params.rotation,angle=-(gradient.angle+270+(rotation?rotation.degrees:0))%360,0===angle&&(angle=180),fillEl.angle=angle,fillEl.type="gradient",fillEl.method="sigma",fillEl.colors?fillEl.colors.value=gradient.colors:fillEl.colors=gradient.colors):(fillEl.src=fillUrl,fillEl.type="tile")):(fillEl.color=Ext.draw.Color.toHex(params.fill),fillEl.src="",fillEl.type="solid"))),newfill&&el.appendChild(fillEl)},setStroke:function(sprite,params){var width,opacity,me=this,el=sprite.el.dom,strokeEl=sprite.strokeEl,newStroke=!1;strokeEl||(strokeEl=sprite.strokeEl=me.createNode("stroke"),newStroke=!0),Ext.isArray(params.stroke)&&(params.stroke=params.stroke[0]),params.stroke&&"none"!=params.stroke&&0!=params.stroke&&0!=params["stroke-width"]?(strokeEl.on=!0,params.stroke&&!params.stroke.match(me.fillUrlRe)&&(strokeEl.color=Ext.draw.Color.toHex(params.stroke)),strokeEl.dashstyle=params["stroke-dasharray"]?"dash":"solid",strokeEl.joinstyle=params["stroke-linejoin"],strokeEl.endcap=params["stroke-linecap"]||"round",strokeEl.miterlimit=params["stroke-miterlimit"]||8,width=.75*parseFloat(params["stroke-width"]||1),opacity=params["stroke-opacity"]||1,Ext.isNumber(width)&&width<1?(strokeEl.weight=1,strokeEl.opacity=opacity*width):(strokeEl.weight=width,strokeEl.opacity=opacity)):strokeEl.on=!1,newStroke&&el.appendChild(strokeEl)},setClip:function(sprite,params){var me=this,clipEl=(sprite.el,sprite.clipEl),rect=String(params["clip-rect"]).split(me.separatorRe);clipEl||(clipEl=sprite.clipEl=me.el.insertFirst(Ext.getDoc().dom.createElement("div")),clipEl.addCls(Ext.baseCSSPrefix+"vml-sprite")),4==rect.length?(rect[2]=+rect[2]+ +rect[0],rect[3]=+rect[3]+ +rect[1],clipEl.setStyle("clip",Ext.String.format("rect({1}px {2}px {3}px {0}px)",rect[0],rect[1],rect[2],rect[3])),clipEl.setSize(me.el.width,me.el.height)):clipEl.setStyle("clip","")},setTextAttributes:function(sprite,params){var fontProp,paramProp,me=this,vml=sprite.vml,textStyle=vml.textpath.style,spanCacheStyle=me.span.style,zoom=me.zoom,fontObj=(Math.round,{fontSize:"font-size",fontWeight:"font-weight",fontStyle:"font-style"});if(sprite.dirtyFont){params.font&&(textStyle.font=spanCacheStyle.font=params.font),params["font-family"]&&(textStyle.fontFamily='"'+params["font-family"].split(",")[0].replace(me.fontFamilyRe,"")+'"',spanCacheStyle.fontFamily=params["font-family"]);for(fontProp in fontObj)paramProp=params[fontObj[fontProp]],paramProp&&(textStyle[fontProp]=spanCacheStyle[fontProp]=paramProp);me.setText(sprite,params.text),vml.textpath.string&&(me.span.innerHTML=String(vml.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br/>")),vml.W=me.span.offsetWidth,vml.H=me.span.offsetHeight+2,"middle"==params["text-anchor"]?textStyle["v-text-align"]="center":"end"==params["text-anchor"]?(textStyle["v-text-align"]="right",vml.bbx=-Math.round(vml.W/2)):(textStyle["v-text-align"]="left",vml.bbx=Math.round(vml.W/2))}vml.X=params.x,vml.Y=params.y,vml.path.v=Ext.String.format("m{0},{1}l{2},{1}",Math.round(vml.X*zoom),Math.round(vml.Y*zoom),Math.round(vml.X*zoom)+1),sprite.bbox.plain=null,sprite.bbox.transform=null,sprite.dirtyFont=!1},setText:function(sprite,text){sprite.vml.textpath.string=Ext.htmlDecode(text)},hide:function(){this.el.hide()},show:function(){this.el.show()},hidePrim:function(sprite){sprite.el.addCls(Ext.baseCSSPrefix+"hide-visibility")},showPrim:function(sprite){sprite.el.removeCls(Ext.baseCSSPrefix+"hide-visibility")},setSize:function(width,height){var me=this;width=width||me.width,height=height||me.height,me.width=width,me.height=height,me.el&&(void 0!=width&&me.el.setWidth(width),void 0!=height&&me.el.setHeight(height)),me.callParent(arguments)},applyViewBox:function(){var items,iLen,i,me=this,viewBox=me.viewBox,width=me.width,height=me.height;if(me.callParent(),viewBox&&(width||height))for(items=me.items.items,iLen=items.length,i=0;i<iLen;i++)me.applyTransformations(items[i])},onAdd:function(item){this.callParent(arguments),this.el&&this.renderItem(item)},onRemove:function(sprite){sprite.el&&(sprite.el.remove(),delete sprite.el),this.callParent(arguments)},render:function(container){var el,me=this,doc=Ext.getDoc().dom;if(!me.createNode)try{doc.namespaces.rvml||doc.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),me.createNode=function(tagName){return doc.createElement("<rvml:"+tagName+' class="rvml">')}}catch(e){me.createNode=function(tagName){return doc.createElement("<"+tagName+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}me.el||(el=doc.createElement("div"),me.el=Ext.get(el),me.el.addCls(me.baseVmlCls),me.span=doc.createElement("span"),Ext.get(me.span).addCls(me.measureSpanCls),el.appendChild(me.span),me.el.setSize(me.width||0,me.height||0),container.appendChild(el),me.el.on({scope:me,mouseup:me.onMouseUp,mousedown:me.onMouseDown,mouseover:me.onMouseOver,mouseout:me.onMouseOut,mousemove:me.onMouseMove,mouseenter:me.onMouseEnter,mouseleave:me.onMouseLeave,click:me.onClick,dblclick:me.onDblClick})),me.renderAll()},renderAll:function(){this.items.each(this.renderItem,this)},redraw:function(sprite){sprite.dirty=!0,this.renderItem(sprite)},renderItem:function(sprite){this.el&&(sprite.el||this.createSpriteElement(sprite),sprite.dirty&&(this.applyAttrs(sprite),sprite.dirtyTransform&&this.applyTransformations(sprite)))},rotationCompensation:function(deg,dx,dy){var matrix=new Ext.draw.Matrix;return matrix.rotate(-deg,.5,.5),{x:matrix.x(dx,dy),y:matrix.y(dx,dy)}},transform:function(sprite,matrixOnly){for(var transform,type,offset,me=this,bbox=me.getBBox(sprite,!0),matrix=(bbox.x+.5*bbox.width,bbox.y+.5*bbox.height,new Ext.draw.Matrix),transforms=sprite.transformations,transformsLength=transforms.length,i=0,deltaDegrees=0,deltaScaleX=1,deltaScaleY=1,el=sprite.el,dom=el.dom,domStyle=dom.style,skew=(me.zoom,sprite.skew),shift=me.viewBoxShift;i<transformsLength;i++)transform=transforms[i],type=transform.type,"translate"==type?matrix.translate(transform.x,transform.y):"rotate"==type?(matrix.rotate(transform.degrees,transform.x,transform.y),deltaDegrees+=transform.degrees):"scale"==type&&(matrix.scale(transform.x,transform.y,transform.centerX,transform.centerY),deltaScaleX*=transform.x,deltaScaleY*=transform.y);sprite.matrix=matrix.clone(),matrixOnly||(shift&&matrix.prepend(shift.scale,0,0,shift.scale,shift.dx*shift.scale,shift.dy*shift.scale),"image"!=sprite.type&&skew?(skew.origin="0,0",skew.matrix=matrix.toString(),offset=matrix.offset(),offset[0]>32767?offset[0]=32767:offset[0]<-32768&&(offset[0]=-32768),offset[1]>32767?offset[1]=32767:offset[1]<-32768&&(offset[1]=-32768),skew.offset=offset):(domStyle.filter=matrix.toFilter(),domStyle.left=Math.min(matrix.x(bbox.x,bbox.y),matrix.x(bbox.x+bbox.width,bbox.y),matrix.x(bbox.x,bbox.y+bbox.height),matrix.x(bbox.x+bbox.width,bbox.y+bbox.height))+"px",domStyle.top=Math.min(matrix.y(bbox.x,bbox.y),matrix.y(bbox.x+bbox.width,bbox.y),matrix.y(bbox.x,bbox.y+bbox.height),matrix.y(bbox.x+bbox.width,bbox.y+bbox.height))+"px"))},createItem:function(config){return Ext.create("Ext.draw.Sprite",config)},getRegion:function(){return this.el.getRegion()},addCls:function(sprite,className){sprite&&sprite.el&&sprite.el.addCls(className)},removeCls:function(sprite,className){sprite&&sprite.el&&sprite.el.removeCls(className)},addGradient:function(gradient){var keys,items,iLen,key,item,i,gradients=this.gradientsColl||(this.gradientsColl=Ext.create("Ext.util.MixedCollection")),colors=[],stops=Ext.create("Ext.util.MixedCollection");for(stops.addAll(gradient.stops),stops.sortByKey("ASC",function(a,b){return a=parseInt(a,10),b=parseInt(b,10),a>b?1:a<b?-1:0}),keys=stops.keys,items=stops.items,iLen=keys.length,i=0;i<iLen;i++)key=keys[i],item=items[i],colors.push(key+"% "+item.color);gradients.add(gradient.id,{colors:colors.join(","),angle:gradient.angle})},destroy:function(){var me=this;me.callParent(arguments),me.el&&me.el.remove(),delete me.el}}),Ext.define("Ext.flash.Component",{extend:Ext.Component,alternateClassName:"Ext.FlashComponent",alias:"widget.flash",flashVersion:"9.0.115",backgroundColor:"#ffffff",wmode:"opaque",swfWidth:"100%",swfHeight:"100%",expressInstall:!1,renderTpl:['<div id="{swfId}" role="presentation"></div>'],initComponent:function(){this.callParent(),this.addEvents("success","failure")},beforeRender:function(){this.callParent(),Ext.applyIf(this.renderData,{swfId:this.getSwfId()})},afterRender:function(){var me=this,flashParams=Ext.apply({},me.flashParams),flashVars=Ext.apply({},me.flashVars);me.callParent(),flashParams=Ext.apply({allowScriptAccess:"always",bgcolor:me.backgroundColor,wmode:me.wmode},flashParams),flashVars=Ext.apply({allowedDomain:document.location.hostname},flashVars),new swfobject.embedSWF(me.url,me.getSwfId(),me.swfWidth,me.swfHeight,me.flashVersion,me.expressInstall?me.statics.EXPRESS_INSTALL_URL:void 0,flashVars,flashParams,me.flashAttributes,Ext.bind(me.swfCallback,me))},swfCallback:function(e){var me=this;e.success?(me.swf=Ext.get(e.ref),me.onSuccess(),me.fireEvent("success",me)):(me.onFailure(),me.fireEvent("failure",me))},getSwfId:function(){return this.swfId||(this.swfId="extswf"+this.getAutoId())},onSuccess:function(){this.swf.setStyle("visibility","inherit")},onFailure:Ext.emptyFn,beforeDestroy:function(){var me=this,swf=me.swf;swf&&(swfobject.removeSWF(me.getSwfId()),Ext.destroy(swf),delete me.swf),me.callParent()},statics:{EXPRESS_INSTALL_URL:"http://swfobject.googlecode.com/svn/trunk/swfobject/expressInstall.swf"}}),Ext.define("Ext.form.action.Action",{alternateClassName:"Ext.form.Action",submitEmptyText:!0,constructor:function(config){config&&Ext.apply(this,config);var params=config.params;Ext.isString(params)&&(this.params=Ext.Object.fromQueryString(params))},run:Ext.emptyFn,onFailure:function(response){this.response=response,this.failureType=Ext.form.action.Action.CONNECT_FAILURE,this.form.afterAction(this,!1)},processResponse:function(response){return this.response=response,!response.responseText&&!response.responseXML||(this.result=this.handleResponse(response))},getUrl:function(){return this.url||this.form.url},getMethod:function(){return(this.method||this.form.method||"POST").toUpperCase()},getParams:function(){return Ext.apply({},this.params,this.form.baseParams)},createCallback:function(){var undef,me=this,form=me.form;return{success:me.onSuccess,failure:me.onFailure,scope:me,timeout:1e3*this.timeout||1e3*form.timeout,upload:form.fileUpload?me.onSuccess:undef}},statics:{CLIENT_INVALID:"client",SERVER_INVALID:"server",CONNECT_FAILURE:"connect",LOAD_FAILURE:"load"}}),Ext.define("Ext.form.action.Load",{extend:Ext.form.action.Action,alternateClassName:"Ext.form.Action.Load",alias:"formaction.load",type:"load",run:function(){Ext.Ajax.request(Ext.apply(this.createCallback(),{method:this.getMethod(),url:this.getUrl(),headers:this.headers,params:this.getParams()}))},onSuccess:function(response){var result=this.processResponse(response),form=this.form;return result!==!0&&result.success&&result.data?(form.clearInvalid(),form.setValues(result.data),void form.afterAction(this,!0)):(this.failureType=Ext.form.action.Action.LOAD_FAILURE,void form.afterAction(this,!1))},handleResponse:function(response){var rs,data,reader=this.form.reader;return reader?(rs=reader.read(response),data=rs.records&&rs.records[0]?rs.records[0].data:null,{success:rs.success,data:data}):Ext.decode(response.responseText)}}),Ext.define("Ext.form.action.Submit",{extend:Ext.form.action.Action,alternateClassName:"Ext.form.Action.Submit",alias:"formaction.submit",type:"submit",run:function(){var me=this,form=me.form;me.clientValidation===!1||form.isValid()?me.doSubmit():(me.failureType=Ext.form.action.Action.CLIENT_INVALID,form.afterAction(me,!1))},doSubmit:function(){var formInfo,me=this,ajaxOptions=Ext.apply(me.createCallback(),{url:me.getUrl(),method:me.getMethod(),headers:me.headers}),form=me.form,jsonSubmit=me.jsonSubmit||form.jsonSubmit,paramsProp=jsonSubmit?"jsonData":"params";form.hasUpload()?(formInfo=me.buildForm(),ajaxOptions.form=formInfo.formEl,ajaxOptions.isUpload=!0):ajaxOptions[paramsProp]=me.getParams(jsonSubmit),Ext.Ajax.request(ajaxOptions),formInfo&&me.cleanup(formInfo)},cleanup:function(formInfo){var i,field,formEl=formInfo.formEl,uploadEls=formInfo.uploadEls,uploadFields=formInfo.uploadFields,len=uploadFields.length;for(i=0;i<len;++i)field=uploadFields[i],
field.clearOnSubmit||field.restoreInput(uploadEls[i]);formEl&&Ext.removeNode(formEl)},getParams:function(useModelValues){var falseVal=!1,configParams=this.callParent(),fieldParams=this.form.getValues(falseVal,falseVal,this.submitEmptyText!==falseVal,useModelValues,!0);return Ext.apply({},fieldParams,configParams)},buildForm:function(){var formSpec,formEl,i,field,key,value,v,vLen,el,me=this,fieldsSpec=[],basicForm=me.form,params=me.getParams(),uploadFields=[],uploadEls=[],fields=basicForm.getFields().items,len=fields.length;for(i=0;i<len;++i)field=fields[i],field.isFileUpload()&&uploadFields.push(field);for(key in params)if(params.hasOwnProperty(key))if(value=params[key],Ext.isArray(value))for(vLen=value.length,v=0;v<vLen;v++)fieldsSpec.push(me.getFieldConfig(key,value[v]));else fieldsSpec.push(me.getFieldConfig(key,value));for(formSpec={tag:"form",role:"presentation",action:me.getUrl(),method:me.getMethod(),target:me.target||"_self",style:"display:none",cn:fieldsSpec},uploadFields.length&&(formSpec.encoding=formSpec.enctype="multipart/form-data"),formEl=Ext.DomHelper.append(Ext.getBody(),formSpec),len=uploadFields.length,i=0;i<len;++i)el=uploadFields[i].extractFileInput(),formEl.appendChild(el),uploadEls.push(el);return{formEl:formEl,uploadFields:uploadFields,uploadEls:uploadEls}},getFieldConfig:function(name,value){return{tag:"input",type:"hidden",name:name,value:Ext.String.htmlEncode(value)}},onSuccess:function(response){var form=this.form,success=!0,result=this.processResponse(response);result===!0||result.success||(result.errors&&form.markInvalid(result.errors),this.failureType=Ext.form.action.Action.SERVER_INVALID,success=!1),form.afterAction(this,success)},handleResponse:function(response){var rs,errors,i,len,records,result,form=this.form,errorReader=form.errorReader;if(errorReader){if(rs=errorReader.read(response),records=rs.records,errors=[],records)for(i=0,len=records.length;i<len;i++)errors[i]=records[i].data;errors.length<1&&(errors=null),result={success:rs.success,errors:errors}}else try{result=Ext.decode(response.responseText)}catch(e){result={success:!1,errors:[]}}return result}}),Ext.define("Ext.util.ComponentDragger",{extend:Ext.dd.DragTracker,autoStart:500,constructor:function(comp,config){this.comp=comp,this.initialConstrainTo=config.constrainTo,this.callParent([config])},onStart:function(e){var me=this,comp=me.comp;me.startPosition=comp.getXY(),comp.ghost&&!comp.liveDrag&&(me.proxy=comp.ghost(),me.dragTarget=me.proxy.header.el),(me.constrain||me.constrainDelegate)&&(me.constrainTo=me.calculateConstrainRegion()),comp.beginDrag&&comp.beginDrag()},calculateConstrainRegion:function(){var constrainEl,delegateRegion,elRegion,me=this,comp=me.comp,constrainTo=me.initialConstrainTo,constraintInsets=comp.constraintInsets,dragEl=me.proxy?me.proxy.el:comp.el,shadowSize=!me.constrainDelegate&&dragEl.shadow&&comp.constrainShadow&&!dragEl.shadowDisabled?dragEl.shadow.getShadowSize():0;return constrainTo instanceof Ext.util.Region?constrainTo=constrainTo.copy():(constrainEl=Ext.fly(constrainTo),constrainTo=constrainEl.getViewRegion(),constrainTo.right=constrainTo.left+constrainEl.dom.clientWidth),constraintInsets&&(constraintInsets=Ext.isObject(constraintInsets)?constraintInsets:Ext.Element.parseBox(constraintInsets),constrainTo.adjust(constraintInsets.top,constraintInsets.right,constraintInsets.bottom,constraintInsets.length)),shadowSize&&constrainTo.adjust(shadowSize[0],-shadowSize[1],-shadowSize[2],shadowSize[3]),me.constrainDelegate||(delegateRegion=Ext.fly(me.dragTarget).getRegion(),elRegion=dragEl.getRegion(),constrainTo.adjust(delegateRegion.top-elRegion.top,delegateRegion.right-elRegion.right,delegateRegion.bottom-elRegion.bottom,delegateRegion.left-elRegion.left)),constrainTo},onDrag:function(e){var me=this,comp=me.proxy&&!me.comp.liveDrag?me.proxy:me.comp,offset=me.getOffset(me.constrain||me.constrainDelegate?"dragTarget":null);comp.setPagePosition(me.startPosition[0]+offset[0],me.startPosition[1]+offset[1])},onEnd:function(e){var comp=this.comp;comp.isDestroyed||comp.destroying||(this.proxy&&!comp.liveDrag&&comp.unghost(),comp.endDrag&&comp.endDrag())}}),Ext.define("Ext.window.Window",{extend:Ext.panel.Panel,alternateClassName:"Ext.Window",alias:"widget.window",baseCls:Ext.baseCSSPrefix+"window",resizable:!0,draggable:!0,constrain:!1,constrainHeader:!1,plain:!1,minimizable:!1,maximizable:!1,minHeight:50,minWidth:50,expandOnShow:!0,collapsible:!1,closable:!0,hidden:!0,autoRender:!0,hideMode:"offsets",floating:!0,itemCls:Ext.baseCSSPrefix+"window-item",initialAlphaNum:/^[a-z0-9]/,overlapHeader:!0,ignoreHeaderBorderManagement:!0,alwaysFramed:!0,isRootCfg:{isRoot:!0},isWindow:!0,ariaRole:"dialog",initComponent:function(){var me=this;me.frame=!1,me.callParent(),me.addEvents("resize","maximize","minimize","restore"),me.plain&&me.addClsWithUI("plain"),me.addStateEvents(["maximize","restore","resize","dragend"])},getElConfig:function(){var elConfig,me=this;return elConfig=me.callParent(),elConfig.tabIndex=-1,elConfig},getState:function(){var pos,me=this,state=me.callParent()||{},maximized=!!me.maximized,ghostBox=me.ghostBox;return state.maximized=maximized,pos=maximized?me.restorePos:ghostBox?[ghostBox.x,ghostBox.y]:me.getPosition(),Ext.apply(state,{size:maximized?me.restoreSize:me.getSize(),pos:pos}),state},applyState:function(state){var me=this;state&&(me.maximized=state.maximized,me.maximized?(me.hasSavedRestore=!0,me.restoreSize=state.size,me.restorePos=state.pos):Ext.apply(me,{width:state.size.width,height:state.size.height,x:state.pos[0],y:state.pos[1]}))},onRender:function(ct,position){var me=this;me.callParent(arguments),me.focusEl=me.el,me.maximizable&&me.header.on({scope:me,dblclick:me.toggleMaximize})},afterRender:function(){var keyMap,me=this,header=me.header;me.callParent(),me.maximized&&(me.maximized=!1,me.maximize(),header&&header.removeCls(header.indicateDragCls)),me.closable?(keyMap=me.getKeyMap(),keyMap.on(27,me.onEsc,me)):keyMap=me.keyMap,keyMap&&me.hidden&&keyMap.disable()},initDraggable:function(){this.initSimpleDraggable()},initResizable:function(){this.callParent(arguments),this.maximized&&this.resizer.disable()},onEsc:function(k,e){Ext.FocusManager&&Ext.FocusManager.enabled&&Ext.FocusManager.focusedCmp!==this||(e.stopEvent(),this.close())},beforeDestroy:function(){var me=this;me.rendered&&(delete this.animateTarget,me.hide(),Ext.destroy(me.keyMap)),me.callParent()},addTools:function(){var me=this;me.callParent(),me.minimizable&&me.addTool({type:"minimize",handler:Ext.Function.bind(me.minimize,me,[])}),me.maximizable&&(me.addTool({type:"maximize",handler:Ext.Function.bind(me.maximize,me,[])}),me.addTool({type:"restore",handler:Ext.Function.bind(me.restore,me,[]),hidden:!0}))},getFocusEl:function(){return this.getDefaultFocus()},getDefaultFocus:function(){var result,selector,me=this,defaultComp=me.defaultButton||me.defaultFocus;return void 0!==defaultComp&&(Ext.isNumber(defaultComp)?result=me.query("button")[defaultComp]:Ext.isString(defaultComp)?(selector=defaultComp,selector.match(me.initialAlphaNum)&&(result=me.down("#"+selector)),result||(result=me.down(selector))):defaultComp.focus&&(result=defaultComp)),result||me.el},onFocus:function(){var focusDescendant,me=this;Ext.FocusManager&&Ext.FocusManager.enabled||(focusDescendant=me.getDefaultFocus())===me?me.callParent(arguments):focusDescendant.focus()},onShow:function(){var me=this;me.callParent(arguments),me.expandOnShow&&me.expand(!1),me.syncMonitorWindowResize(),me.keyMap&&me.keyMap.enable()},doClose:function(){var me=this;me.hidden?(me.fireEvent("close",me),"destroy"==me.closeAction&&this.destroy()):me.hide(me.animateTarget,me.doClose,me)},afterHide:function(){var me=this;me.syncMonitorWindowResize(),me.keyMap&&me.keyMap.disable(),me.callParent(arguments)},onWindowResize:function(){var sizeModel,me=this;me.maximized?me.fitContainer():(sizeModel=me.getSizeModel(),(sizeModel.width.natural||sizeModel.height.natural)&&me.updateLayout(),me.doConstrain())},minimize:function(){return this.fireEvent("minimize",this),this},resumeHeaderLayout:function(changed){this.header.resumeLayouts(changed?this.isRootCfg:null)},afterCollapse:function(){var me=this,header=me.header,tools=me.tools;header&&me.maximizable&&(header.suspendLayouts(),tools.maximize.hide(),tools.restore.hide(),this.resumeHeaderLayout(!0)),me.resizer&&me.resizer.disable(),me.callParent(arguments)},afterExpand:function(){var changed,me=this,header=me.header,tools=me.tools;header&&(header.suspendLayouts(),me.maximized?(tools.restore.show(),changed=!0):me.maximizable&&(tools.maximize.show(),changed=!0),this.resumeHeaderLayout(changed)),me.resizer&&me.resizer.enable(),me.callParent(arguments)},maximize:function(animate){var restore,changed,me=this,header=me.header,tools=me.tools,width=me.width,height=me.height;return me.maximized||(me.expand(!1),me.hasSavedRestore||(restore=me.restoreSize={width:Ext.isNumber(width)?width:null,height:Ext.isNumber(height)?height:null},me.restorePos=me.getPosition(!0)),header&&(header.suspendLayouts(),tools.maximize&&(tools.maximize.hide(),changed=!0),tools.restore&&(tools.restore.show(),changed=!0),me.collapseTool&&(me.collapseTool.hide(),changed=!0),me.resumeHeaderLayout(changed)),me.el.disableShadow(),me.dd&&(me.dd.disable(),header&&header.removeCls(header.indicateDragCls)),me.resizer&&me.resizer.disable(),me.el.addCls(Ext.baseCSSPrefix+"window-maximized"),me.container.addCls(Ext.baseCSSPrefix+"window-maximized-ct"),me.syncMonitorWindowResize(),me.fitContainer(animate=animate||me.animateTarget?{callback:function(){me.maximized=!0,me.fireEvent("maximize",me)}}:null),animate||(me.maximized=!0,me.fireEvent("maximize",me))),me},restore:function(animate){var changed,me=this,tools=me.tools,header=me.header,newBox=me.restoreSize;return me.maximized&&(me.hasSavedRestore=null,me.removeCls(Ext.baseCSSPrefix+"window-maximized"),header&&(header.suspendLayouts(),tools.restore&&(tools.restore.hide(),changed=!0),tools.maximize&&(tools.maximize.show(),changed=!0),me.collapseTool&&(me.collapseTool.show(),changed=!0),me.resumeHeaderLayout(changed)),newBox.x=me.restorePos[0],newBox.y=me.restorePos[1],me.setBox(newBox,animate=animate||me.animateTarget?{callback:function(){me.el.enableShadow(!0),me.maximized=!1,me.fireEvent("restore",me)}}:null),me.restorePos=me.restoreSize=null,me.dd&&(me.dd.enable(),header&&header.addCls(header.indicateDragCls)),me.resizer&&me.resizer.enable(),me.container.removeCls(Ext.baseCSSPrefix+"window-maximized-ct"),me.syncMonitorWindowResize(),animate||(me.el.enableShadow(!0),me.maximized=!1,me.fireEvent("restore",me))),me},syncMonitorWindowResize:function(){var me=this,currentlyMonitoring=me._monitoringResize,yes=me.monitorResize||me.constrain||me.constrainHeader||me.maximized,veto=me.hidden||me.destroying||me.isDestroyed;yes&&!veto?currentlyMonitoring||(Ext.EventManager.onWindowResize(me.onWindowResize,me,{delay:1}),me._monitoringResize=!0):currentlyMonitoring&&(Ext.EventManager.removeResizeListener(me.onWindowResize,me),me._monitoringResize=!1)},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()},createGhost:function(){var ghost=this.callParent(arguments);return ghost.xtype="window",ghost}}),Ext.define("Ext.form.Labelable",{isLabelable:!0,autoEl:{tag:"table",cellpadding:0,role:"presentation"},childEls:["labelCell","labelEl","bodyEl","sideErrorCell","errorEl","inputRow"],labelableRenderTpl:['<tr role="presentation" id="{id}-inputRow" <tpl if="inFormLayout">id="{id}"</tpl> class="{inputRowCls}">','<tpl if="labelOnLeft">','<td role="presentation" id="{id}-labelCell" style="{labelCellStyle}" {labelCellAttrs}>',"{beforeLabelTpl}",'<label id="{id}-labelEl" {labelAttrTpl}','<tpl if="inputId && !(boxLabel && !fieldLabel)"> for="{inputId}"</tpl>',' class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>',' unselectable="on"',">","{beforeLabelTextTpl}",'<tpl if="fieldLabel">{fieldLabel}','<tpl if="labelSeparator">','<span role="separator">{labelSeparator}</span>',"</tpl>","</tpl>","{afterLabelTextTpl}","</label>","{afterLabelTpl}","</td>","</tpl>",'<td role="presentation" class="{baseBodyCls} {fieldBodyCls} {extraFieldBodyCls}" id="{id}-bodyEl" colspan="{bodyColspan}" role="presentation">',"{beforeBodyEl}","<tpl if=\"labelAlign=='top'\">","{beforeLabelTpl}",'<div role="presentation" id="{id}-labelCell" style="{labelCellStyle}">','<label id="{id}-labelEl" {labelAttrTpl}<tpl if="inputId"> for="{inputId}"</tpl> class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>',' unselectable="on"',">","{beforeLabelTextTpl}",'<tpl if="fieldLabel">{fieldLabel}','<tpl if="labelSeparator">','<span role="separator">{labelSeparator}</span>',"</tpl>","</tpl>","{afterLabelTextTpl}","</label>","</div>","{afterLabelTpl}","</tpl>","{beforeSubTpl}","{[values.$comp.getSubTplMarkup(values)]}","{afterSubTpl}","<tpl if=\"msgTarget==='side'\">","{afterBodyEl}","</td>","<td role=\"presentation\" id=\"{id}-sideErrorCell\" vAlign=\"{[values.labelAlign==='top' && !values.hideLabel ? 'bottom' : 'middle']}\" style=\"{[values.autoFitErrors ? 'display:none' : '']}\" width=\"{errorIconWidth}\">",'<div role="alert" aria-live="polite" id="{id}-errorEl" class="{errorMsgCls}" style="display:none"></div>',"</td>","<tpl elseif=\"msgTarget=='under'\">",'<div role="alert" aria-live="polite" id="{id}-errorEl" class="{errorMsgClass}" colspan="2" style="display:none"></div>',"{afterBodyEl}","</td>","</tpl>","</tr>",{disableFormats:!0}],activeErrorsTpl:void 0,htmlActiveErrorsTpl:['<tpl if="errors && errors.length">','<ul class="{listCls}">','<tpl if="Ext.enableAria">','<tpl if="fieldLabel"><div>{fieldLabel}</div></tpl>',"</tpl>",'<tpl for="errors"><li>{.}</li></tpl>',"</ul>","</tpl>"],plaintextActiveErrorsTpl:['<tpl if="errors && errors.length">','<tpl if="Ext.enableAria">','<tpl if="fieldLabel">{fieldLabel}\n</tpl>',"</tpl>",'<tpl for="errors"><tpl if="xindex &gt; 1">\n</tpl>{.}</tpl>',"</tpl>"],isFieldLabelable:!0,formItemCls:Ext.baseCSSPrefix+"form-item",labelCls:Ext.baseCSSPrefix+"form-item-label",errorMsgCls:Ext.baseCSSPrefix+"form-error-msg",baseBodyCls:Ext.baseCSSPrefix+"form-item-body",inputRowCls:Ext.baseCSSPrefix+"form-item-input-row",fieldBodyCls:"",clearCls:Ext.baseCSSPrefix+"clear",invalidCls:Ext.baseCSSPrefix+"form-invalid",fieldLabel:void 0,labelAlign:"left",labelWidth:100,labelPad:5,labelSeparator:":",hideLabel:!1,hideEmptyLabel:!0,preventMark:!1,autoFitErrors:!0,msgTarget:"qtip",noWrap:!0,labelableInsertions:["beforeBodyEl","afterBodyEl","beforeLabelTpl","afterLabelTpl","beforeSubTpl","afterSubTpl","beforeLabelTextTpl","afterLabelTextTpl","labelAttrTpl"],labelableRenderProps:["allowBlank","id","labelAlign","fieldBodyCls","extraFieldBodyCls","baseBodyCls","clearCls","labelSeparator","msgTarget","inputRowCls"],initLabelable:function(){var me=this,padding=me.padding;padding&&(me.padding=void 0,me.extraMargins=Ext.Element.parseBox(padding)),me.activeErrorsTpl||("title"==me.msgTarget?me.activeErrorsTpl=me.plaintextActiveErrorsTpl:me.activeErrorsTpl=me.htmlActiveErrorsTpl),me.addCls(Ext.plainTableCls),me.addCls(me.formItemCls),me.lastActiveError="",me.addEvents("errorchange"),me.enableBubble("errorchange")},trimLabelSeparator:function(){var me=this,separator=me.labelSeparator,label=me.fieldLabel||"",lastChar=label.substr(label.length-1);return lastChar===separator?label.slice(0,-1):label},getFieldLabel:function(){return this.trimLabelSeparator()},setFieldLabel:function(label){label=label||"";var me=this,separator=me.labelSeparator,labelEl=me.labelEl;me.fieldLabel=label,me.rendered&&(Ext.isEmpty(label)&&me.hideEmptyLabel?labelEl.parent().setDisplayed("none"):(separator&&(label=me.trimLabelSeparator()+separator),labelEl.update(label),labelEl.parent().setDisplayed("")),me.updateLayout())},getInsertionRenderData:function(data,names){for(var name,value,i=names.length;i--;)name=names[i],value=this[name],value&&"string"!=typeof value&&(value.isTemplate||(value=Ext.XTemplate.getTpl(this,name)),value=value.apply(data)),data[name]=value||"";return data},getLabelableRenderData:function(){var data,tempEl,me=this,topLabel="top"===me.labelAlign;return Ext.form.Labelable.errorIconWidth||(tempEl=Ext.getBody().createChild({style:"position:absolute",cls:Ext.baseCSSPrefix+"form-invalid-icon"}),Ext.form.Labelable.errorIconWidth=tempEl.getWidth()+tempEl.getMargin("l"),tempEl.remove()),data=Ext.copyTo({inFormLayout:me.ownerLayout&&"form"===me.ownerLayout.type,inputId:me.getInputId(),labelOnLeft:!topLabel,hideLabel:!me.hasVisibleLabel(),fieldLabel:me.getFieldLabel(),labelCellStyle:me.getLabelCellStyle(),labelCellAttrs:me.getLabelCellAttrs(),labelCls:me.getLabelCls(),labelStyle:me.getLabelStyle(),bodyColspan:me.getBodyColspan(),externalError:!me.autoFitErrors,errorMsgCls:me.getErrorMsgCls(),errorIconWidth:Ext.form.Labelable.errorIconWidth,boxLabel:me.boxLabel},me,me.labelableRenderProps,!0),me.getInsertionRenderData(data,me.labelableInsertions),data},xhooks:{beforeRender:function(){var me=this;me.setFieldDefaults(me.getHierarchyState().fieldDefaults),me.ownerLayout&&me.addCls(Ext.baseCSSPrefix+me.ownerLayout.type+"-form-item")},onRender:function(){var margins,side,me=this,style={};if(me.extraMargins){margins=me.el.getMargin();for(side in margins)margins.hasOwnProperty(side)&&(style["margin-"+side]=margins[side]+me.extraMargins[side]+"px");me.el.setStyle(style)}}},hasVisibleLabel:function(){return!this.hideLabel&&!(this.hideEmptyLabel&&!this.getFieldLabel())},getLabelWidth:function(){var me=this;return me.hasVisibleLabel()?me.labelWidth+me.labelPad:0},getBodyColspan:function(){var result,me=this;return result="side"!==me.msgTarget||me.autoFitErrors&&!me.hasActiveError()?2:1,"top"===me.labelAlign||me.hasVisibleLabel()||result++,result},getLabelCls:function(){var labelCls=this.labelCls+" "+Ext.dom.Element.unselectableCls,labelClsExtra=this.labelClsExtra;return labelClsExtra?labelCls+" "+labelClsExtra:labelCls},getLabelCellStyle:function(){var me=this,hideLabelCell=me.hideLabel||!me.getFieldLabel()&&me.hideEmptyLabel;return hideLabelCell?"display:none;":""},getErrorMsgCls:function(){var me=this,hideLabelCell=me.hideLabel||!me.fieldLabel&&me.hideEmptyLabel;return me.errorMsgCls+(hideLabelCell||"top"!==me.labelAlign?"":" "+Ext.baseCSSPrefix+"lbl-top-err-icon")},getLabelCellAttrs:function(){var me=this,labelAlign=me.labelAlign,result="";return"top"!==labelAlign&&(result='valign="top" halign="'+labelAlign+'" width="'+(me.labelWidth+me.labelPad)+'"'),result+' class="'+Ext.baseCSSPrefix+'field-label-cell"'},getLabelStyle:function(){var me=this,labelPad=me.labelPad,labelStyle="";return"top"!==me.labelAlign&&(me.labelWidth&&(labelStyle="width:"+me.labelWidth+"px;"),labelPad&&(labelStyle+="margin-right:"+labelPad+"px;")),labelStyle+(me.labelStyle||"")},getSubTplMarkup:function(){return""},getInputId:function(){return""},getActiveError:function(){return this.activeError||""},hasActiveError:function(){return!!this.getActiveError()},setActiveError:function(msg){this.setActiveErrors(msg)},getActiveErrors:function(){return this.activeErrors||[]},setActiveErrors:function(errors){var tpl,me=this;errors=Ext.Array.from(errors),tpl=me.getTpl("activeErrorsTpl"),me.activeErrors=errors,me.activeError=tpl.apply({fieldLabel:me.fieldLabel,errors:errors,listCls:Ext.plainListCls}),me.renderActiveError()},unsetActiveError:function(){delete this.activeError,delete this.activeErrors,this.renderActiveError()},renderActiveError:function(){var me=this,activeError=me.getActiveError(),hasError=!!activeError;activeError!==me.lastActiveError&&(me.fireEvent("errorchange",me,activeError),me.lastActiveError=activeError),!me.rendered||me.isDestroyed||me.preventMark||(me.el[hasError?"addCls":"removeCls"](me.invalidCls),me.errorEl&&(me.errorEl.dom.innerHTML=activeError))},setFieldDefaults:function(defaults){var key;for(key in defaults)this.hasOwnProperty(key)||(this[key]=defaults[key])}}),Ext.define("Ext.form.field.Field",{isFormField:!0,disabled:!1,submitValue:!0,validateOnChange:!0,suspendCheckChange:0,initField:function(){this.addEvents("change","validitychange","dirtychange"),this.initValue()},initValue:function(){var me=this;me.value=me.transformOriginalValue(me.value),me.originalValue=me.lastValue=me.value,me.suspendCheckChange++,me.setValue(me.value),me.suspendCheckChange--},transformOriginalValue:Ext.identityFn,getName:function(){return this.name},getValue:function(){return this.value},setValue:function(value){var me=this;return me.value=value,me.checkChange(),me},isEqual:function(value1,value2){return String(value1)===String(value2)},isEqualAsString:function(value1,value2){return String(Ext.value(value1,""))===String(Ext.value(value2,""))},getSubmitData:function(){var me=this,data=null;return!me.disabled&&me.submitValue&&(data={},data[me.getName()]=""+me.getValue()),data},getModelData:function(includeEmptyText,isSubmitting){var me=this,data=null;return me.disabled||!me.submitValue&&isSubmitting||(data={},data[me.getName()]=me.getValue()),data},reset:function(){var me=this;me.beforeReset(),me.setValue(me.originalValue),me.clearInvalid(),delete me.wasValid},beforeReset:Ext.emptyFn,resetOriginalValue:function(){this.originalValue=this.getValue(),this.checkDirty()},checkChange:function(){var newVal,oldVal,me=this;me.suspendCheckChange||(newVal=me.getValue(),oldVal=me.lastValue,!me.isDestroyed&&me.didValueChange(newVal,oldVal)&&(me.lastValue=newVal,me.fireEvent("change",me,newVal,oldVal),me.onChange(newVal,oldVal)))},didValueChange:function(newVal,oldVal){return!this.isEqual(newVal,oldVal)},onChange:function(newVal,oldVal){this.validateOnChange&&this.validate(),this.checkDirty()},isDirty:function(){var me=this;return!me.disabled&&!me.isEqual(me.getValue(),me.originalValue)},checkDirty:function(){var me=this,isDirty=me.isDirty();isDirty!==me.wasDirty&&(me.fireEvent("dirtychange",me,isDirty),me.onDirtyChange(isDirty),me.wasDirty=isDirty)},onDirtyChange:Ext.emptyFn,getErrors:function(value){return[]},isValid:function(){var me=this;return me.disabled||Ext.isEmpty(me.getErrors())},validate:function(){var me=this,isValid=me.isValid();return isValid!==me.wasValid&&(me.wasValid=isValid,me.fireEvent("validitychange",me,isValid)),isValid},batchChanges:function(fn){try{this.suspendCheckChange++,fn()}catch(e){throw e}finally{this.suspendCheckChange--}this.checkChange()},isFileUpload:function(){return!1},extractFileInput:function(){return null},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn}),Ext.define("Ext.layout.component.field.Field",{extend:Ext.layout.component.Auto,alias:"layout.field",type:"field",naturalSizingProp:"size",beginLayout:function(ownerContext){var me=this,owner=me.owner;me.callParent(arguments),ownerContext.labelStrategy=me.getLabelStrategy(),ownerContext.errorStrategy=me.getErrorStrategy(),ownerContext.labelContext=ownerContext.getEl("labelEl"),ownerContext.bodyCellContext=ownerContext.getEl("bodyEl"),ownerContext.inputContext=ownerContext.getEl("inputEl"),ownerContext.errorContext=ownerContext.getEl("errorEl"),Ext.isIE7m&&Ext.isStrict&&ownerContext.inputContext&&(me.ieInputWidthAdjustment=ownerContext.inputContext.getPaddingInfo().width+ownerContext.inputContext.getBorderInfo().width),ownerContext.labelStrategy.prepare(ownerContext,owner),ownerContext.errorStrategy.prepare(ownerContext,owner)},beginLayoutCycle:function(ownerContext){var width,me=this,owner=me.owner,widthModel=ownerContext.widthModel,ownerNaturalSize=owner[me.naturalSizingProp];me.callParent(arguments),widthModel.shrinkWrap?me.beginLayoutShrinkWrap(ownerContext):widthModel.natural?("number"!=typeof ownerNaturalSize||owner.inputWidth?me.beginLayoutShrinkWrap(ownerContext):me.beginLayoutFixed(ownerContext,width=6.5*ownerNaturalSize+20,"px"),ownerContext.setWidth(width,!1)):me.beginLayoutFixed(ownerContext,"100","%")},beginLayoutFixed:function(ownerContext,width,suffix){var owner=ownerContext.target,inputEl=owner.inputEl,inputWidth=owner.inputWidth;owner.el.setStyle("table-layout","fixed"),owner.bodyEl.setStyle("width",width+suffix),inputEl&&(inputWidth?inputEl.setStyle("width",inputWidth+"px"):inputEl.setStyle("width",owner.stretchInputElFixed?"100%":"")),ownerContext.isFixed=!0},beginLayoutShrinkWrap:function(ownerContext){var owner=ownerContext.target,inputEl=owner.inputEl,inputWidth=owner.inputWidth;inputEl&&inputEl.dom&&(inputEl.dom.removeAttribute("size"),inputWidth?inputEl.setStyle("width",inputWidth+"px"):inputEl.setStyle("width","")),owner.el.setStyle("table-layout","auto"),owner.bodyEl.setStyle("width","")},finishedLayout:function(ownerContext){var owner=this.owner;this.callParent(arguments),ownerContext.labelStrategy.finishedLayout(ownerContext,owner),ownerContext.errorStrategy.finishedLayout(ownerContext,owner)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){return contentHeight},measureContentHeight:function(ownerContext){return ownerContext.el.getHeight()},measureContentWidth:function(ownerContext){return ownerContext.el.getWidth()},measureLabelErrorHeight:function(ownerContext){return ownerContext.labelStrategy.getHeight(ownerContext)+ownerContext.errorStrategy.getHeight(ownerContext)},onFocus:function(){this.getErrorStrategy().onFocus(this.owner)},getLabelStrategy:function(){var me=this,strategies=me.labelStrategies,labelAlign=me.owner.labelAlign;return strategies[labelAlign]||strategies.base},getErrorStrategy:function(){var me=this,owner=me.owner,strategies=me.errorStrategies,msgTarget=owner.msgTarget;return!owner.preventMark&&Ext.isString(msgTarget)?strategies[msgTarget]||strategies.elementId:strategies.none},labelStrategies:function(){var base={prepare:function(ownerContext,owner){var cls=owner.labelCls+"-"+owner.labelAlign,labelEl=owner.labelEl;labelEl&&labelEl.addCls(cls)},getHeight:function(){return 0},finishedLayout:Ext.emptyFn};return{base:base,top:Ext.applyIf({getHeight:function(ownerContext){var labelContext=ownerContext.labelContext,props=labelContext.props,height=props.height;return void 0===height&&(props.height=height=labelContext.el.getHeight()+labelContext.getMarginInfo().height),height}},base),left:base,right:base}}(),errorStrategies:function(){function showTip(owner){var target,tip=Ext.layout.component.field.Field.tip;tip&&tip.isVisible()&&(target=tip.activeTarget,target&&target.el===owner.getActionEl().dom&&tip.toFront(!0))}var iconWidth,applyIf=Ext.applyIf,emptyFn=Ext.emptyFn,iconCls=Ext.baseCSSPrefix+"form-invalid-icon",base={prepare:function(ownerContext,owner){var el=owner.errorEl;el&&el.setDisplayed(!1)},getHeight:function(){return 0},onFocus:emptyFn,finishedLayout:emptyFn};return{none:base,side:applyIf({prepare:function(ownerContext,owner){var tempEl,errorEl=owner.errorEl,sideErrorCell=owner.sideErrorCell,displayError=owner.hasActiveError();iconWidth||(iconWidth=(tempEl=Ext.getBody().createChild({style:"position:absolute",cls:iconCls})).getWidth(),tempEl.remove()),errorEl.addCls(iconCls),errorEl.set({"data-errorqtip":owner.getActiveError()||""}),owner.autoFitErrors?errorEl.setDisplayed(displayError):errorEl.setVisible(displayError),sideErrorCell&&owner.autoFitErrors&&sideErrorCell.setDisplayed(displayError),owner.bodyEl.dom.colSpan=owner.getBodyColspan(),Ext.layout.component.field.Field.initTip()},onFocus:showTip},base),under:applyIf({prepare:function(ownerContext,owner){var errorEl=owner.errorEl,cls=Ext.baseCSSPrefix+"form-invalid-under";errorEl.addCls(cls),errorEl.setDisplayed(owner.hasActiveError())},getHeight:function(ownerContext){var errorContext,props,height=0;return ownerContext.target.hasActiveError()&&(errorContext=ownerContext.errorContext,props=errorContext.props,height=props.height,void 0===height&&(props.height=height=errorContext.el.getHeight())),height}},base),qtip:applyIf({prepare:function(ownerContext,owner){Ext.layout.component.field.Field.initTip(),owner.getActionEl().dom.setAttribute("data-errorqtip",owner.getActiveError()||"")},onFocus:showTip},base),title:applyIf({prepare:function(ownerContext,owner){owner.getActionEl().dom.setAttribute("title",owner.getActiveError()||"")}},base),elementId:applyIf({prepare:function(ownerContext,owner){var targetEl=Ext.fly(owner.msgTarget);targetEl&&(targetEl.dom.innerHTML=owner.getActiveError()||"",targetEl.setDisplayed(owner.hasActiveError()))}},base)}}(),statics:{initTip:function(){var tip=this.tip;tip||(tip=this.tip=Ext.create("Ext.tip.QuickTip",{ui:"form-invalid"}),tip.tagConfig=Ext.apply({},{attribute:"errorqtip"},tip.tagConfig))},destroyTip:function(){var tip=this.tip;tip&&(tip.destroy(),delete this.tip)}}}),Ext.define("Ext.form.field.Base",{extend:Ext.Component,mixins:{labelable:Ext.form.Labelable,field:Ext.form.field.Field},alias:"widget.field",alternateClassName:["Ext.form.Field","Ext.form.BaseField"],fieldSubTpl:['<input id="{id}" type="{type}" role="{role}" {inputAttrTpl}',' size="1"','<tpl if="name"> name="{name}"</tpl>','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','{%if (values.maxLength !== undefined){%} maxlength="{maxLength}"{%}%}','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls} {typeCls} {editableCls} {inputCls}" autocomplete="off"/>',{disableFormats:!0}],subTplInsertions:["inputAttrTpl"],inputType:"text",invalidText:"The value in this field is invalid",fieldCls:Ext.baseCSSPrefix+"form-field",focusCls:"form-focus",dirtyCls:Ext.baseCSSPrefix+"form-dirty",checkChangeEvents:Ext.isIE&&(!document.documentMode||document.documentMode<9)?["change","propertychange","keyup"]:["change","input","textInput","keyup","dragdrop"],checkChangeBuffer:50,componentLayout:"field",readOnly:!1,readOnlyCls:Ext.baseCSSPrefix+"form-readonly",validateOnBlur:!0,hasFocus:!1,baseCls:Ext.baseCSSPrefix+"field",maskOnDisable:!1,stretchInputElFixed:!0,initComponent:function(){var me=this;me.callParent(),me.subTplData=me.subTplData||{},me.addEvents("specialkey","writeablechange"),me.initLabelable(),me.initField(),me.name||(me.name=me.getInputId()),me.readOnly&&me.addCls(me.readOnlyCls),me.addCls(Ext.baseCSSPrefix+"form-type-"+me.inputType)},getInputId:function(){return this.inputId||(this.inputId=this.id+"-inputEl")},getSubTplData:function(){var data,me=this,type=me.inputType,inputId=me.getInputId();return data=Ext.apply({id:inputId,cmpId:me.id,name:me.name||inputId,disabled:me.disabled,readOnly:me.readOnly,value:me.getRawValue(),type:type,fieldCls:me.fieldCls,fieldStyle:me.getFieldStyle(),tabIdx:me.tabIndex,inputCls:me.inputCls,typeCls:Ext.baseCSSPrefix+"form-"+("password"===type?"text":type),role:me.ariaRole},me.subTplData),me.getInsertionRenderData(data,me.subTplInsertions),data},applyRenderSelectors:function(){var me=this;me.callParent(),me.addChildEls("inputEl"),me.inputEl=me.el.getById(me.getInputId())},getSubTplMarkup:function(){return this.getTpl("fieldSubTpl").apply(this.getSubTplData())},initRenderTpl:function(){var me=this;return me.hasOwnProperty("renderTpl")||(me.renderTpl=me.getTpl("labelableRenderTpl")),me.callParent()},initRenderData:function(){return Ext.applyIf(this.callParent(),this.getLabelableRenderData())},setFieldStyle:function(style){var me=this,inputEl=me.inputEl;inputEl&&inputEl.applyStyles(style),me.fieldStyle=style},getFieldStyle:function(){var style=this.fieldStyle;return Ext.isObject(style)?Ext.DomHelper.generateStyles(style,null,!0):style||""},onRender:function(){this.callParent(arguments),this.renderActiveError()},getFocusEl:function(){return this.inputEl},isFileUpload:function(){return"file"===this.inputType},getSubmitData:function(){var val,me=this,data=null;return!me.disabled&&me.submitValue&&(val=me.getSubmitValue(),null!==val&&(data={},data[me.getName()]=val)),data},getSubmitValue:function(){return this.processRawValue(this.getRawValue())},getRawValue:function(){var me=this,v=me.inputEl?me.inputEl.getValue():Ext.value(me.rawValue,"");return me.rawValue=v,v},setRawValue:function(value){var me=this;return value=Ext.value(me.transformRawValue(value),""),
me.rawValue=value,me.inputEl&&(me.inputEl.dom.value=value),value},transformRawValue:Ext.identityFn,valueToRaw:function(value){return""+Ext.value(value,"")},rawToValue:Ext.identityFn,processRawValue:Ext.identityFn,getValue:function(){var me=this,val=me.rawToValue(me.processRawValue(me.getRawValue()));return me.value=val,val},setValue:function(value){var me=this;return me.setRawValue(me.valueToRaw(value)),me.mixins.field.setValue.call(me,value)},onBoxReady:function(){var me=this;me.callParent(),me.setReadOnlyOnBoxReady&&me.setReadOnly(me.readOnly)},onDisable:function(){var me=this,inputEl=me.inputEl;me.callParent(),inputEl&&(inputEl.dom.disabled=!0,me.hasActiveError()&&(me.clearInvalid(),me.needsValidateOnEnable=!0))},onEnable:function(){var me=this,inputEl=me.inputEl;me.callParent(),inputEl&&(inputEl.dom.disabled=!1,me.needsValidateOnEnable&&(delete me.needsValidateOnEnable,me.forceValidation=!0,me.isValid(),delete me.forceValidation))},setReadOnly:function(readOnly){var me=this,inputEl=me.inputEl;readOnly=!!readOnly,me[readOnly?"addCls":"removeCls"](me.readOnlyCls),me.readOnly=readOnly,inputEl?inputEl.dom.readOnly=readOnly:me.rendering&&(me.setReadOnlyOnBoxReady=!0),me.fireEvent("writeablechange",me,readOnly)},fireKey:function(e){e.isSpecialKey()&&this.fireEvent("specialkey",this,new Ext.EventObjectImpl(e))},initEvents:function(){var onChangeTask,onChangeEvent,e,event,me=this,inputEl=me.inputEl,events=me.checkChangeEvents,eLen=events.length;if(inputEl)for(me.mon(inputEl,Ext.EventManager.getKeyEvent(),me.fireKey,me),onChangeTask=new Ext.util.DelayedTask(me.checkChange,me),me.onChangeEvent=onChangeEvent=function(){onChangeTask.delay(me.checkChangeBuffer)},e=0;e<eLen;e++)event=events[e],"propertychange"===event&&(me.usesPropertychange=!0),me.mon(inputEl,event,onChangeEvent);me.callParent()},doComponentLayout:function(){var me=this,inputEl=me.inputEl,usesPropertychange=me.usesPropertychange,ename="propertychange",onChangeEvent=me.onChangeEvent;usesPropertychange&&me.mun(inputEl,ename,onChangeEvent),me.callParent(arguments),usesPropertychange&&me.mon(inputEl,ename,onChangeEvent)},onDirtyChange:function(isDirty){this[isDirty?"addCls":"removeCls"](this.dirtyCls)},isValid:function(){var me=this,disabled=me.disabled,validate=me.forceValidation||!disabled;return validate?me.validateValue(me.processRawValue(me.getRawValue())):disabled},validateValue:function(value){var me=this,errors=me.getErrors(value),isValid=Ext.isEmpty(errors);return me.preventMark||(isValid?me.clearInvalid():me.markInvalid(errors)),isValid},markInvalid:function(errors){var active,me=this,oldMsg=me.getActiveError();me.setActiveErrors(Ext.Array.from(errors)),active=me.getActiveError(),oldMsg!==active&&me.setError(active)},clearInvalid:function(){var me=this,hadError=me.hasActiveError();delete me.needsValidateOnEnable,me.unsetActiveError(),hadError&&me.setError("")},setError:function(active){var prop,me=this,msgTarget=me.msgTarget;me.rendered&&("title"==msgTarget||"qtip"==msgTarget?(me.rendered&&(prop="qtip"==msgTarget?"data-errorqtip":"title"),me.getActionEl().dom.setAttribute(prop,active||"")):me.updateLayout())},renderActiveError:function(){var me=this,hasError=me.hasActiveError();me.inputEl&&me.inputEl[hasError?"addCls":"removeCls"](me.invalidCls+"-field"),me.mixins.labelable.renderActiveError.call(me)},getActionEl:function(){return this.inputEl||this.el}}),Ext.define("Ext.form.field.VTypes",function(){var alpha=/^[a-zA-Z_]+$/,alphanum=/^[a-zA-Z0-9_]+$/,email=/^(")?(?:[^\."])(?:(?:[\.])?(?:[\w\-!#$%&'*+\/=?^_`{|}~]))*\1@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,url=/(((^https?)|(^ftp)):\/\/((([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*)|(localhost|LOCALHOST))\/?)/i;return{singleton:!0,alternateClassName:"Ext.form.VTypes",email:function(v){return email.test(v)},emailText:'This field should be an e-mail address in the format "user@example.com"',emailMask:/[\w.\-@'"!#$%&'*+\/=?^_`{|}~]/i,url:function(v){return url.test(v)},urlText:'This field should be a URL in the format "http://www.example.com"',alpha:function(v){return alpha.test(v)},alphaText:"This field should only contain letters and _",alphaMask:/[a-z_]/i,alphanum:function(v){return alphanum.test(v)},alphanumText:"This field should only contain letters, numbers and _",alphanumMask:/[a-z0-9_]/i}}()),Ext.define("Ext.layout.component.field.Text",{extend:Ext.layout.component.field.Field,alias:"layout.textfield",type:"textfield",setWidthInDom:!0,canGrowWidth:!0,beginLayoutCycle:function(ownerContext){this.callParent(arguments),ownerContext.heightModel.shrinkWrap&&ownerContext.inputContext.el.setStyle("height","")},measureContentWidth:function(ownerContext){var inputEl,value,calcWidth,max,min,me=this,owner=me.owner,width=me.callParent(arguments),inputContext=ownerContext.inputContext;return owner.grow&&me.canGrowWidth&&!ownerContext.state.growHandled&&(inputEl=owner.inputEl,value=Ext.util.Format.htmlEncode(inputEl.dom.value||(owner.hasFocus?"":owner.emptyText)||""),value+=owner.growAppend,calcWidth=inputEl.getTextWidth(value)+inputContext.getFrameInfo().width,max=owner.growMax,min=Math.min(max,width),max=Math.max(owner.growMin,max,min),calcWidth=Ext.Number.constrain(calcWidth,owner.growMin,max),inputContext.setWidth(calcWidth),ownerContext.state.growHandled=!0,inputContext.domBlock(me,"width"),width=NaN),width},publishInnerHeight:function(ownerContext,height){ownerContext.inputContext.setHeight(height-this.measureLabelErrorHeight(ownerContext))},beginLayoutFixed:function(ownerContext,width,suffix){var me=this,ieInputWidthAdjustment=me.ieInputWidthAdjustment;ieInputWidthAdjustment&&(me.adjustIEInputPadding(ownerContext),"px"===suffix&&(width-=ieInputWidthAdjustment)),me.callParent(arguments)},adjustIEInputPadding:function(ownerContext){this.owner.bodyEl.setStyle("padding-right",this.ieInputWidthAdjustment+"px")}}),Ext.define("Ext.form.field.Text",{extend:Ext.form.field.Base,alias:"widget.textfield",alternateClassName:["Ext.form.TextField","Ext.form.Text"],size:20,growMin:30,growMax:800,growAppend:"W",allowBlank:!0,validateBlank:!1,allowOnlyWhitespace:!0,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",blankText:"This field is required",regexText:"",emptyCls:Ext.baseCSSPrefix+"form-empty-field",requiredCls:Ext.baseCSSPrefix+"form-required-field",componentLayout:"textfield",valueContainsPlaceholder:!1,ariaRole:"textbox",initComponent:function(){var me=this;me.allowOnlyWhitespace===!1&&(me.allowBlank=!1),me.callParent(),me.addEvents("autosize","keydown","keyup","keypress"),me.addStateEvents("change"),me.setGrowSizePolicy()},setGrowSizePolicy:function(){this.grow&&(this.shrinkWrap|=1)},initEvents:function(){var me=this,el=me.inputEl;me.callParent(),(me.selectOnFocus||me.emptyText)&&me.mon(el,"mousedown",me.onMouseDown,me),(me.maskRe||me.vtype&&me.disableKeyFilter!==!0&&(me.maskRe=Ext.form.field.VTypes[me.vtype+"Mask"]))&&me.mon(el,"keypress",me.filterKeys,me),me.enableKeyEvents&&me.mon(el,{scope:me,keyup:me.onKeyUp,keydown:me.onKeyDown,keypress:me.onKeyPress})},isEqual:function(value1,value2){return this.isEqualAsString(value1,value2)},onChange:function(newVal,oldVal){this.callParent(arguments),this.autoSize()},getSubTplData:function(){var placeholder,me=this,value=me.getRawValue(),isEmpty=me.emptyText&&value.length<1,maxLength=me.maxLength;return me.enforceMaxLength?maxLength===Number.MAX_VALUE&&(maxLength=void 0):maxLength=void 0,isEmpty&&(Ext.supports.Placeholder?placeholder=me.emptyText:(value=me.emptyText,me.valueContainsPlaceholder=!0)),Ext.apply(me.callParent(),{maxLength:maxLength,readOnly:me.readOnly,placeholder:placeholder,value:value,fieldCls:me.fieldCls+(isEmpty&&(placeholder||value)?" "+me.emptyCls:"")+(me.allowBlank?"":" "+me.requiredCls)})},afterRender:function(){this.autoSize(),this.callParent()},onMouseDown:function(e){var me=this;me.hasFocus||me.mon(me.inputEl,"mouseup",Ext.emptyFn,me,{single:!0,preventDefault:!0})},processRawValue:function(value){var newValue,me=this,stripRe=me.stripCharsRe;return stripRe&&(newValue=value.replace(stripRe,""),newValue!==value&&(me.setRawValue(newValue),value=newValue)),value},onDisable:function(){this.callParent(),Ext.isIE&&(this.inputEl.dom.unselectable="on")},onEnable:function(){this.callParent(),Ext.isIE&&(this.inputEl.dom.unselectable="")},onKeyDown:function(e){this.fireEvent("keydown",this,e)},onKeyUp:function(e){this.fireEvent("keyup",this,e)},onKeyPress:function(e){this.fireEvent("keypress",this,e)},reset:function(){this.callParent(),this.applyEmptyText()},applyEmptyText:function(){var isEmpty,me=this,emptyText=me.emptyText;me.rendered&&emptyText&&(isEmpty=me.getRawValue().length<1&&!me.hasFocus,Ext.supports.Placeholder?me.inputEl.dom.placeholder=emptyText:isEmpty&&(me.setRawValue(emptyText),me.valueContainsPlaceholder=!0),isEmpty&&me.inputEl.addCls(me.emptyCls),me.autoSize())},afterFirstLayout:function(){if(this.callParent(),Ext.isIE&&this.disabled){var el=this.inputEl;el&&(el.dom.unselectable="on")}},beforeFocus:function(){var isEmpty,me=this,inputEl=me.inputEl,emptyText=me.emptyText;me.callParent(arguments),emptyText&&!Ext.supports.Placeholder&&inputEl.dom.value===me.emptyText&&me.valueContainsPlaceholder?(me.setRawValue(""),isEmpty=!0,inputEl.removeCls(me.emptyCls),me.valueContainsPlaceholder=!1):Ext.supports.Placeholder&&inputEl.removeCls(me.emptyCls),(me.selectOnFocus||isEmpty)&&(Ext.isWebKit?(me.inputFocusTask||(me.inputFocusTask=new Ext.util.DelayedTask(me.focusInput,me)),me.inputFocusTask.delay(1)):me.focusInput())},focusInput:function(){var input=this.inputEl;input&&(input=input.dom,input&&input.select())},onFocus:function(){var me=this;me.callParent(arguments),me.emptyText&&me.autoSize()},postBlur:function(){var task=this.inputFocusTask;this.callParent(arguments),this.applyEmptyText(),task&&task.cancel()},filterKeys:function(e){if(!e.ctrlKey||e.altKey){var key=e.getKey(),charCode=String.fromCharCode(e.getCharCode());(Ext.isGecko||Ext.isOpera)&&(e.isNavKeyPress()||key===e.BACKSPACE||key===e.DELETE&&e.button===-1)||(Ext.isGecko||Ext.isOpera||!e.isSpecialKey()||charCode)&&(this.maskRe.test(charCode)||e.stopEvent())}},getState:function(){return this.addPropertyToState(this.callParent(),"value")},applyState:function(state){this.callParent(arguments),state.hasOwnProperty("value")&&this.setValue(state.value)},getRawValue:function(){var me=this,v=me.callParent();return v===me.emptyText&&me.valueContainsPlaceholder&&(v=""),v},setValue:function(value){var me=this,inputEl=me.inputEl;return inputEl&&me.emptyText&&!Ext.isEmpty(value)&&(inputEl.removeCls(me.emptyCls),me.valueContainsPlaceholder=!1),me.callParent(arguments),me.applyEmptyText(),me},getErrors:function(value){var msg,trimmed,isBlank,me=this,errors=me.callParent(arguments),validator=me.validator,vtype=me.vtype,vtypes=Ext.form.field.VTypes,regex=me.regex,format=Ext.String.format;if(value=value||me.processRawValue(me.getRawValue()),Ext.isFunction(validator)&&(msg=validator.call(me,value),msg!==!0&&errors.push(msg)),trimmed=me.allowOnlyWhitespace?value:Ext.String.trim(value),trimmed.length<1||value===me.emptyText&&me.valueContainsPlaceholder){if(me.allowBlank||errors.push(me.blankText),!me.validateBlank)return errors;isBlank=!0}return!isBlank&&value.length<me.minLength&&errors.push(format(me.minLengthText,me.minLength)),value.length>me.maxLength&&errors.push(format(me.maxLengthText,me.maxLength)),vtype&&(vtypes[vtype](value,me)||errors.push(me.vtypeText||vtypes[vtype+"Text"])),regex&&!regex.test(value)&&errors.push(me.regexText||me.invalidText),errors},selectText:function(start,end){var undef,range,me=this,v=me.getRawValue(),doFocus=!0,el=me.inputEl.dom;v.length>0&&(start=start===undef?0:start,end=end===undef?v.length:end,el.setSelectionRange?el.setSelectionRange(start,end):el.createTextRange&&(range=el.createTextRange(),range.moveStart("character",start),range.moveEnd("character",end-v.length),range.select()),doFocus=Ext.isGecko||Ext.isOpera),doFocus&&me.focus()},autoSize:function(){var me=this;me.grow&&me.rendered&&(me.autoSizing=!0,me.updateLayout())},afterComponentLayout:function(){var width,me=this;me.callParent(arguments),me.autoSizing&&(width=me.inputEl.getWidth(),width!==me.lastInputWidth&&(me.fireEvent("autosize",me,width),me.lastInputWidth=width,delete me.autoSizing))},onDestroy:function(){var me=this;me.callParent(),me.inputFocusTask&&(me.inputFocusTask.cancel(),me.inputFocusTask=null)}}),Ext.define("Ext.layout.component.field.TextArea",{extend:Ext.layout.component.field.Text,alias:"layout.textareafield",type:"textareafield",canGrowWidth:!1,naturalSizingProp:"cols",beginLayout:function(ownerContext){this.callParent(arguments),ownerContext.target.inputEl.setStyle("height","")},measureContentHeight:function(ownerContext){var inputContext,inputEl,value,curWidth,calcHeight,me=this,owner=me.owner,height=me.callParent(arguments);return owner.grow&&!ownerContext.state.growHandled&&(inputContext=ownerContext.inputContext,inputEl=owner.inputEl,curWidth=inputEl.getWidth(!0),value=Ext.util.Format.htmlEncode(inputEl.dom.value)||"&#160;",value+=owner.growAppend,value=value.replace(/\n/g,"<br/>"),calcHeight=Ext.util.TextMetrics.measure(inputEl,value,curWidth).height+inputContext.getBorderInfo().height+inputContext.getPaddingInfo().height,calcHeight=Ext.Number.constrain(calcHeight,owner.growMin,owner.growMax),inputContext.setHeight(calcHeight),ownerContext.state.growHandled=!0,inputContext.domBlock(me,"height"),height=NaN),height}}),Ext.define("Ext.form.field.TextArea",{extend:Ext.form.field.Text,alias:["widget.textareafield","widget.textarea"],alternateClassName:"Ext.form.TextArea",fieldSubTpl:['<textarea id="{id}" role="{role}" {inputAttrTpl}','<tpl if="name"> name="{name}"</tpl>','<tpl if="rows"> rows="{rows}" </tpl>','<tpl if="cols"> cols="{cols}" </tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="size"> size="{size}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>',' class="{fieldCls} {typeCls} {inputCls}" ','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' autocomplete="off">\n','<tpl if="value">{[Ext.util.Format.htmlEncode(values.value)]}</tpl>',"</textarea>",{disableFormats:!0}],growMin:60,growMax:1e3,growAppend:"\n-",cols:20,rows:4,enterIsSpecial:!1,preventScrollbars:!1,componentLayout:"textareafield",setGrowSizePolicy:Ext.emptyFn,returnRe:/\r/g,inputCls:Ext.baseCSSPrefix+"form-textarea",getSubTplData:function(){var me=this,fieldStyle=me.getFieldStyle(),ret=me.callParent();return me.grow&&me.preventScrollbars&&(ret.fieldStyle=(fieldStyle||"")+";overflow:hidden;height:"+me.growMin+"px"),Ext.applyIf(ret,{cols:me.cols,rows:me.rows}),ret},afterRender:function(){var me=this;me.callParent(arguments),me.needsMaxCheck=me.enforceMaxLength&&me.maxLength!==Number.MAX_VALUE&&!Ext.supports.TextAreaMaxLength,me.needsMaxCheck&&me.inputEl.on("paste",me.onPaste,me)},transformRawValue:function(value){return this.stripReturns(value)},transformOriginalValue:function(value){return this.stripReturns(value)},getValue:function(){return this.stripReturns(this.callParent())},valueToRaw:function(value){return value=this.stripReturns(value),this.callParent([value])},stripReturns:function(value){return value&&"string"==typeof value&&(value=value.replace(this.returnRe,"")),value},onPaste:function(e){var me=this;me.pasteTask||(me.pasteTask=new Ext.util.DelayedTask(me.pasteCheck,me)),me.pasteTask.delay(1)},pasteCheck:function(){var me=this,value=me.getValue(),max=me.maxLength;value.length>max&&(value=value.substr(0,max),me.setValue(value))},fireKey:function(e){var value,me=this,key=e.getKey();e.isSpecialKey()&&(me.enterIsSpecial||key!==e.ENTER||e.hasModifier())&&me.fireEvent("specialkey",me,e),!me.needsMaxCheck||key===e.BACKSPACE||key===e.DELETE||e.isNavKeyPress()||me.isCutCopyPasteSelectAll(e,key)||(value=me.getValue(),value.length>=me.maxLength&&e.stopEvent())},isCutCopyPasteSelectAll:function(e,key){return!!e.ctrlKey&&(key===e.A||key===e.C||key===e.V||key===e.X)},autoSize:function(){var height,me=this;me.grow&&me.rendered&&(me.updateLayout(),height=me.inputEl.getHeight(),height!==me.lastInputHeight&&(me.fireEvent("autosize",me,height),me.lastInputHeight=height))},beforeDestroy:function(){var task=this.pasteTask;task&&(task.cancel(),this.pasteTask=null),this.callParent()}}),Ext.define("Ext.form.field.Display",{extend:Ext.form.field.Base,alias:"widget.displayfield",alternateClassName:["Ext.form.DisplayField","Ext.form.Display"],ariaRole:"textbox",fieldSubTpl:['<div id="{id}" role="{role}" {inputAttrTpl}','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls}">{value}</div>',{compiled:!0,disableFormats:!0}],readOnly:!0,fieldCls:Ext.baseCSSPrefix+"form-display-field",fieldBodyCls:Ext.baseCSSPrefix+"form-display-field-body",htmlEncode:!1,noWrap:!1,validateOnChange:!1,initEvents:Ext.emptyFn,submitValue:!1,valueToRaw:function(value){return value||0===value?value:""},isDirty:function(){return!1},isValid:function(){return!0},validate:function(){return!0},getRawValue:function(){return this.rawValue},setRawValue:function(value){var me=this;return value=Ext.value(value,""),me.rawValue=value,me.rendered&&(me.inputEl.dom.innerHTML=me.getDisplayValue(),me.updateLayout()),value},getDisplayValue:function(){var display,me=this,value=this.getRawValue();return display=me.renderer?me.renderer.call(me.scope||me,value,me):me.htmlEncode?Ext.util.Format.htmlEncode(value):value},getSubTplData:function(){var ret=this.callParent(arguments);return ret.value=this.getDisplayValue(),ret}}),Ext.define("Ext.layout.container.Anchor",{alias:"layout.anchor",extend:Ext.layout.container.Auto,alternateClassName:"Ext.layout.AnchorLayout",type:"anchor",defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,manageOverflow:!0,beginLayoutCycle:function(ownerContext){var anchorSpec,childContext,childItems,i,length,me=this,dimensions=0;for(me.callParent(arguments),childItems=ownerContext.childItems,length=childItems.length,i=0;i<length&&(childContext=childItems[i],anchorSpec=childContext.target.anchorSpec,!anchorSpec||(childContext.widthModel.calculated&&anchorSpec.right&&(dimensions|=1),childContext.heightModel.calculated&&anchorSpec.bottom&&(dimensions|=2),3!=dimensions));++i);ownerContext.anchorDimensions=dimensions},calculateItems:function(ownerContext,containerSize){var anchorSpec,childContext,childMargins,height,i,width,me=this,childItems=ownerContext.childItems,length=childItems.length,gotHeight=containerSize.gotHeight,gotWidth=containerSize.gotWidth,ownerHeight=containerSize.height,ownerWidth=containerSize.width,knownDimensions=(gotWidth?1:0)|(gotHeight?2:0),anchorDimensions=ownerContext.anchorDimensions;if(!anchorDimensions)return!0;for(i=0;i<length;i++)childContext=childItems[i],childMargins=childContext.getMarginInfo(),anchorSpec=childContext.target.anchorSpec,gotWidth&&childContext.widthModel.calculated&&(width=anchorSpec.right(ownerWidth)-childMargins.width,width=me.adjustWidthAnchor(width,childContext),childContext.setWidth(width)),gotHeight&&childContext.heightModel.calculated&&(height=anchorSpec.bottom(ownerHeight)-childMargins.height,height=me.adjustHeightAnchor(height,childContext),childContext.setHeight(height));return(knownDimensions&anchorDimensions)===anchorDimensions},anchorFactory:{offset:function(delta){return function(v){return v+delta}},ratio:function(ratio){return function(v){return Math.floor(v*ratio)}},standard:function(diff){return function(v){return v-diff}}},parseAnchor:function(a,start,cstart){if(a&&"none"!=a){var delta,factory=this.anchorFactory;if(this.parseAnchorRE.test(a))return factory.standard(cstart-start);if(a.indexOf("%")!=-1)return factory.ratio(.01*parseFloat(a.replace("%","")));if(delta=parseInt(a,10),!isNaN(delta))return factory.offset(delta)}return null},adjustWidthAnchor:function(value,childContext){return value},adjustHeightAnchor:function(value,childContext){return value},configureItem:function(item){var anchorsArray,anchorWidth,anchorHeight,me=this,owner=me.owner,anchor=item.anchor;me.callParent(arguments),item.anchor||!item.items||Ext.isNumber(item.width)||Ext.isIE6&&Ext.isStrict||(item.anchor=anchor=me.defaultAnchor),owner.anchorSize?"number"==typeof owner.anchorSize?anchorWidth=owner.anchorSize:(anchorWidth=owner.anchorSize.width,anchorHeight=owner.anchorSize.height):(anchorWidth=owner.initialConfig.width,anchorHeight=owner.initialConfig.height),anchor&&(anchorsArray=anchor.split(" "),item.anchorSpec={right:me.parseAnchor(anchorsArray[0],item.initialConfig.width,anchorWidth),bottom:me.parseAnchor(anchorsArray[1],item.initialConfig.height,anchorHeight)})},sizePolicy:{$:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},b:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},r:{$:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},b:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}}},getItemSizePolicy:function(item){var sizeModel,anchorSpec=item.anchorSpec,key="$",policy=this.sizePolicy;return anchorSpec&&(sizeModel=this.owner.getSizeModel(),anchorSpec.right&&!sizeModel.width.shrinkWrap&&(policy=policy.r),anchorSpec.bottom&&!sizeModel.height.shrinkWrap&&(key="b")),policy[key]}}),Ext.define("Ext.window.MessageBox",{extend:Ext.window.Window,alias:"widget.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:Ext.baseCSSPrefix+"message-box-info",WARNING:Ext.baseCSSPrefix+"message-box-warning",QUESTION:Ext.baseCSSPrefix+"message-box-question",ERROR:Ext.baseCSSPrefix+"message-box-error",hideMode:"offsets",closeAction:"hide",resizable:!1,title:"&#160;",defaultMinWidth:250,defaultMaxWidth:600,defaultMinHeight:110,defaultMaxHeight:500,minWidth:null,maxWidth:null,minHeight:null,maxHeight:null,constrain:!0,cls:[Ext.baseCSSPrefix+"message-box",Ext.baseCSSPrefix+"hide-offsets"],layout:{type:"vbox",align:"stretch"},shrinkWrapDock:!0,defaultTextHeight:75,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},iconHeight:35,iconWidth:50,ariaRole:"alertdialog",makeButton:function(btnIdx){var btnId=this.buttonIds[btnIdx];return new Ext.button.Button({handler:this.btnCallback,itemId:btnId,scope:this,text:this.buttonText[btnId],minWidth:75})},btnCallback:function(btn){var value,field,me=this;(me.cfg.prompt||me.cfg.multiline)&&(field=me.cfg.multiline?me.textArea:me.textField,value=field.getValue(),field.reset()),me.hide(),me.userCallback(btn.itemId,value,me.cfg)},hide:function(){var me=this,cls=me.cfg.cls;me.progressBar.reset(),cls&&me.removeCls(cls),me.callParent(arguments)},constructor:function(cfg){var me=this;me.callParent(arguments),me.minWidth=me.defaultMinWidth=me.minWidth||me.defaultMinWidth,me.maxWidth=me.defaultMaxWidth=me.maxWidth||me.defaultMaxWidth,me.minHeight=me.defaultMinHeight=me.minHeight||me.defaultMinHeight,me.maxHeight=me.defaultMaxHeight=me.maxHeight||me.defaultMaxHeight},initComponent:function(cfg){var i,button,me=this,baseId=me.id;for(me.title="&#160;",me.topContainer=new Ext.container.Container({layout:"hbox",padding:10,style:{overflow:"hidden"},items:[me.iconComponent=new Ext.Component({width:me.iconWidth,height:me.iconHeight}),me.promptContainer=new Ext.container.Container({flex:1,layout:"anchor",items:[me.msg=new Ext.form.field.Display({id:baseId+"-displayfield",cls:me.baseCls+"-text"}),me.textField=new Ext.form.field.Text({id:baseId+"-textfield",anchor:"100%",enableKeyEvents:!0,listeners:{keydown:me.onPromptKey,scope:me}}),me.textArea=new Ext.form.field.TextArea({id:baseId+"-textarea",anchor:"100%",height:75})]})]}),me.progressBar=new Ext.ProgressBar({id:baseId+"-progressbar",margin:"0 10 10 10"}),me.items=[me.topContainer,me.progressBar],me.msgButtons=[],i=0;i<4;i++)button=me.makeButton(i),me.msgButtons[button.itemId]=button,me.msgButtons.push(button);me.bottomTb=new Ext.toolbar.Toolbar({id:baseId+"-toolbar",ui:"footer",dock:"bottom",layout:{pack:"center"},items:[me.msgButtons[0],me.msgButtons[1],me.msgButtons[2],me.msgButtons[3]]}),me.dockedItems=[me.bottomTb],me.on("close",me.onClose,me),me.callParent()},onClose:function(){var btn=this.header.child("[type=close]");btn.itemId="cancel",this.btnCallback(btn),delete btn.itemId},onPromptKey:function(textField,e){var me=this;e.keyCode!==e.RETURN&&10!==e.keyCode||(me.msgButtons.ok.isVisible()?me.msgButtons.ok.handler.call(me,me.msgButtons.ok):me.msgButtons.yes.isVisible()&&me.msgButtons.yes.handler.call(me,me.msgButtons.yes))},reconfigure:function(cfg){var resizeTracker,width,height,i,textArea,textField,msg,progressBar,msgButtons,me=this,buttons=0,hideToolbar=!0,oldButtonText=me.buttonText,resizer=me.resizer;for(me.updateButtonText(),cfg=cfg||{},me.cfg=cfg,cfg.width&&(width=cfg.width),cfg.height&&(height=cfg.height),me.minWidth=cfg.minWidth||me.defaultMinWidth,me.maxWidth=cfg.maxWidth||me.defaultMaxWidth,me.minHeight=cfg.minHeight||me.defaultMinHeight,me.maxHeight=cfg.maxHeight||me.defaultMaxHeight,resizer&&(resizeTracker=resizer.resizeTracker,resizer.minWidth=resizeTracker.minWidth=me.minWidth,resizer.maxWidth=resizeTracker.maxWidth=me.maxWidth,resizer.minHeight=resizeTracker.minHeight=me.minHeight,resizer.maxHeight=resizeTracker.maxHeight=me.maxHeight),delete me.defaultFocus,cfg.defaultFocus&&(me.defaultFocus=cfg.defaultFocus),me.animateTarget=cfg.animateTarget||void 0,me.modal=cfg.modal!==!1,me.setTitle(cfg.title||""),me.setIconCls(cfg.iconCls||""),Ext.isObject(cfg.buttons)?(me.buttonText=cfg.buttons,buttons=0):(me.buttonText=cfg.buttonText||me.buttonText,buttons=Ext.isNumber(cfg.buttons)?cfg.buttons:0),buttons|=me.updateButtonText(),me.buttonText=oldButtonText,Ext.suspendLayouts(),delete me.width,delete me.height,(width||height)&&(width&&me.setWidth(width),height&&me.setHeight(height)),me.hidden=!1,me.rendered||me.render(Ext.getBody()),me.closable=cfg.closable!==!1&&!cfg.wait,me.header.child("[type=close]").setVisible(me.closable),cfg.title||me.closable||cfg.iconCls?me.header.show():me.header.hide(),me.liveDrag=!cfg.proxyDrag,me.userCallback=Ext.Function.bind(cfg.callback||cfg.fn||Ext.emptyFn,cfg.scope||Ext.global),me.setIcon(cfg.icon,cfg.iconWidth,cfg.iconHeight),msg=me.msg,cfg.msg?(msg.setValue(cfg.msg),msg.show()):msg.hide(),textArea=me.textArea,textField=me.textField,cfg.prompt||cfg.multiline?(me.multiline=cfg.multiline,cfg.multiline?(textArea.setValue(cfg.value),textArea.setHeight(cfg.defaultTextHeight||me.defaultTextHeight),textArea.show(),textField.hide(),me.defaultFocus=textArea):(textField.setValue(cfg.value),textArea.hide(),textField.show(),me.defaultFocus=textField)):(textArea.hide(),textField.hide()),progressBar=me.progressBar,cfg.progress||cfg.wait?(progressBar.show(),me.updateProgress(0,cfg.progressText),cfg.wait===!0&&progressBar.wait(cfg.waitConfig)):progressBar.hide(),msgButtons=me.msgButtons,i=0;i<4;i++)buttons&Math.pow(2,i)?(me.defaultFocus||(me.defaultFocus=msgButtons[i]),msgButtons[i].show(),hideToolbar=!1):msgButtons[i].hide();hideToolbar?me.bottomTb.hide():me.bottomTb.show(),Ext.resumeLayouts(!0)},updateButtonText:function(){var btnId,btn,me=this,buttonText=me.buttonText,buttons=0;for(btnId in buttonText)buttonText.hasOwnProperty(btnId)&&(btn=me.msgButtons[btnId],btn&&(me.cfg&&me.cfg.buttonText&&(buttons|=Math.pow(2,Ext.Array.indexOf(me.buttonIds,btnId))),btn.text!=buttonText[btnId]&&btn.setText(buttonText[btnId])));return buttons},show:function(cfg){var visibleFocusables,me=this;return Ext.AbstractComponent.layoutSuspendCount?(Ext.on({resumelayouts:function(){me.show(cfg)},single:!0}),me):(me.reconfigure(cfg),cfg.cls&&me.addCls(cfg.cls),visibleFocusables=me.query("textfield:not([hidden]),textarea:not([hidden]),button:not([hidden])"),me.preventFocusOnActivate=!visibleFocusables.length,me.hidden=!0,me.callParent(),me)},onShow:function(){this.callParent(arguments),this.center()},updateText:function(text){this.msg.setValue(text)},setIcon:function(icon,width,height){var me=this,iconCmp=me.iconComponent,cls=me.messageIconCls;return cls&&iconCmp.removeCls(cls),icon?(iconCmp.show(),iconCmp.setSize(width||me.iconWidth,height||me.iconHeight),iconCmp.addCls(Ext.baseCSSPrefix+"dlg-icon"),iconCmp.addCls(me.messageIconCls=icon)):(iconCmp.removeCls(Ext.baseCSSPrefix+"dlg-icon"),iconCmp.hide()),me},updateProgress:function(value,progressText,msg){return this.progressBar.updateProgress(value,progressText),msg&&this.updateText(msg),this},onEsc:function(){this.closable!==!1&&this.callParent(arguments)},confirm:function(cfg,msg,fn,scope){return Ext.isString(cfg)&&(cfg={title:cfg,icon:this.QUESTION,msg:msg,buttons:this.YESNO,callback:fn,scope:scope}),this.show(cfg)},prompt:function(cfg,msg,fn,scope,multiline,value){return Ext.isString(cfg)&&(cfg={prompt:!0,title:cfg,minWidth:this.minPromptWidth,msg:msg,buttons:this.OKCANCEL,callback:fn,scope:scope,multiline:multiline,value:value}),this.show(cfg)},wait:function(cfg,title,config){return Ext.isString(cfg)&&(cfg={title:title,msg:cfg,closable:!1,wait:!0,modal:!0,minWidth:this.minProgressWidth,waitConfig:config}),this.show(cfg)},alert:function(cfg,msg,fn,scope){return Ext.isString(cfg)&&(cfg={title:cfg,msg:msg,buttons:this.OK,fn:fn,scope:scope,minWidth:this.minWidth}),this.show(cfg)},progress:function(cfg,msg,progressText){return Ext.isString(cfg)&&(cfg={title:cfg,msg:msg,progress:!0,progressText:progressText}),this.show(cfg)}},function(){Ext.MessageBox=Ext.Msg=new this}),Ext.define("Ext.form.Basic",{extend:Ext.util.Observable,alternateClassName:"Ext.form.BasicForm",constructor:function(owner,config){var reader,me=this;me.owner=owner,me.checkValidityTask=new Ext.util.DelayedTask(me.checkValidity,me),me.checkDirtyTask=new Ext.util.DelayedTask(me.checkDirty,me),me.monitor=new Ext.container.Monitor({selector:"[isFormField]:not([excludeForm])",scope:me,addHandler:me.onFieldAdd,removeHandler:me.onFieldRemove}),me.monitor.bind(owner),Ext.apply(me,config),Ext.isString(me.paramOrder)&&(me.paramOrder=me.paramOrder.split(/[\s,|]/)),reader=me.reader,reader&&!reader.isReader&&("string"==typeof reader&&(reader={type:reader}),me.reader=Ext.createByAlias("reader."+reader.type,reader)),reader=me.errorReader,reader&&!reader.isReader&&("string"==typeof reader&&(reader={type:reader}),me.errorReader=Ext.createByAlias("reader."+reader.type,reader)),me.addEvents("beforeaction","actionfailed","actioncomplete","validitychange","dirtychange"),me.callParent()},initialize:function(){this.initialized=!0,this.onValidityChange(!this.hasInvalidField())},timeout:30,paramsAsHash:!1,waitTitle:"Please Wait...",trackResetOnLoad:!1,wasDirty:!1,destroy:function(){var me=this,mon=me.monitor;mon&&(mon.unbind(),me.monitor=null),me.clearListeners(),me.checkValidityTask.cancel(),me.checkDirtyTask.cancel(),me.isDestroyed=!0},onFieldAdd:function(field){var me=this;me.mon(field,"validitychange",me.checkValidityDelay,me),me.mon(field,"dirtychange",me.checkDirtyDelay,me),me.initialized&&me.checkValidityDelay()},onFieldRemove:function(field){var me=this;me.mun(field,"validitychange",me.checkValidityDelay,me),me.mun(field,"dirtychange",me.checkDirtyDelay,me),me.initialized&&me.checkValidityDelay()},getFields:function(){return this.monitor.getItems()},getBoundItems:function(){var boundItems=this._boundItems;return boundItems&&0!==boundItems.getCount()||(boundItems=this._boundItems=new Ext.util.MixedCollection,boundItems.addAll(this.owner.query("[formBind]"))),boundItems},hasInvalidField:function(){return!!this.getFields().findBy(function(field){var isValid,preventMark=field.preventMark;return field.preventMark=!0,isValid=field.isValid(),field.preventMark=preventMark,!isValid})},isValid:function(){var invalid,me=this;return Ext.suspendLayouts(),invalid=me.getFields().filterBy(function(field){return!field.validate()}),Ext.resumeLayouts(!0),invalid.length<1},checkValidity:function(){var valid,me=this;
me.isDestroyed||(valid=!me.hasInvalidField(),valid!==me.wasValid&&(me.onValidityChange(valid),me.fireEvent("validitychange",me,valid),me.wasValid=valid))},checkValidityDelay:function(){this.checkValidityTask.delay(10)},onValidityChange:function(valid){var items,i,iLen,cmp,boundItems=this.getBoundItems();if(boundItems)for(items=boundItems.items,iLen=items.length,i=0;i<iLen;i++)cmp=items[i],cmp.disabled===valid&&cmp.setDisabled(!valid)},isDirty:function(){return!!this.getFields().findBy(function(f){return f.isDirty()})},checkDirtyDelay:function(){this.checkDirtyTask.delay(10)},checkDirty:function(){var dirty,me=this;me.isDestroyed||(dirty=this.isDirty(),dirty!==this.wasDirty&&(this.fireEvent("dirtychange",this,dirty),this.wasDirty=dirty))},hasUpload:function(){return!!this.getFields().findBy(function(f){return f.isFileUpload()})},doAction:function(action,options){return Ext.isString(action)&&(action=Ext.ClassManager.instantiateByAlias("formaction."+action,Ext.apply({},options,{form:this}))),this.fireEvent("beforeaction",this,action)!==!1&&(this.beforeAction(action),Ext.defer(action.run,100,action)),this},submit:function(options){options=options||{};var action,me=this;return action=options.standardSubmit||me.standardSubmit?"standardsubmit":me.api?"directsubmit":"submit",me.doAction(action,options)},load:function(options){return this.doAction(this.api?"directload":"load",options)},updateRecord:function(record){if(record=record||this._record,!record)return this;for(var name,fields=record.fields.items,values=this.getFieldValues(),obj={},i=0,len=fields.length;i<len;++i)name=fields[i].name,values.hasOwnProperty(name)&&(obj[name]=values[name]);return record.beginEdit(),record.set(obj),record.endEdit(),this},loadRecord:function(record){return this._record=record,this.setValues(record.getData())},getRecord:function(){return this._record},beforeAction:function(action){var f,field,waitMsgTarget,me=this,waitMsg=action.waitMsg,maskCls=Ext.baseCSSPrefix+"mask-loading",fields=me.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)field=fields[f],field.isFormField&&field.syncValue&&field.syncValue();waitMsg&&(waitMsgTarget=me.waitMsgTarget,waitMsgTarget===!0?me.owner.el.mask(waitMsg,maskCls):waitMsgTarget?(waitMsgTarget=me.waitMsgTarget=Ext.get(waitMsgTarget),waitMsgTarget.mask(waitMsg,maskCls)):(me.floatingAncestor=me.owner.up("[floating]"),me.floatingAncestor&&(me.savePreventFocusOnActivate=me.floatingAncestor.preventFocusOnActivate,me.floatingAncestor.preventFocusOnActivate=!0),Ext.MessageBox.wait(waitMsg,action.waitTitle||me.waitTitle)))},afterAction:function(action,success){var me=this;if(action.waitMsg){var messageBox=Ext.MessageBox,waitMsgTarget=me.waitMsgTarget;waitMsgTarget===!0?me.owner.el.unmask():waitMsgTarget?waitMsgTarget.unmask():messageBox.hide()}me.floatingAncestor&&(me.floatingAncestor.preventFocusOnActivate=me.savePreventFocusOnActivate),success?(action.reset&&me.reset(),Ext.callback(action.success,action.scope||action,[me,action]),me.fireEvent("actioncomplete",me,action)):(Ext.callback(action.failure,action.scope||action,[me,action]),me.fireEvent("actionfailed",me,action))},findField:function(id){return this.getFields().findBy(function(f){return f.id===id||f.getName()===id})},markInvalid:function(errors){function mark(fieldId,msg){var field=me.findField(fieldId);field&&field.markInvalid(msg)}var e,eLen,error,value,key,me=this;if(Ext.isArray(errors))for(eLen=errors.length,e=0;e<eLen;e++)error=errors[e],mark(error.id,error.msg);else if(errors instanceof Ext.data.Errors)for(eLen=errors.items.length,e=0;e<eLen;e++)error=errors.items[e],mark(error.field,error.message);else for(key in errors)errors.hasOwnProperty(key)&&(value=errors[key],mark(key,value,errors));return this},setValues:function(values){function setVal(fieldId,val){var field=me.findField(fieldId);field&&(field.setValue(val),me.trackResetOnLoad&&field.resetOriginalValue())}var v,vLen,val,me=this;if(Ext.suspendLayouts(),Ext.isArray(values))for(vLen=values.length,v=0;v<vLen;v++)val=values[v],setVal(val.id,val.value);else Ext.iterate(values,setVal);return Ext.resumeLayouts(!0),this},getValues:function(asString,dirtyOnly,includeEmptyText,useDataValues,isSubmitting){var field,data,val,bucket,name,f,values={},fields=this.getFields().items,fLen=fields.length,isArray=Ext.isArray;for(f=0;f<fLen;f++)if(field=fields[f],(!dirtyOnly||field.isDirty())&&(data=field[useDataValues?"getModelData":"getSubmitData"](includeEmptyText,isSubmitting),Ext.isObject(data)))for(name in data)data.hasOwnProperty(name)&&(val=data[name],includeEmptyText&&""===val&&(val=field.emptyText||""),field.isRadio?values[name]=values[name]||val:values.hasOwnProperty(name)?(bucket=values[name],isArray(bucket)||(bucket=values[name]=[bucket]),isArray(val)?values[name]=bucket.concat(val):bucket.push(val)):values[name]=val);return asString&&(values=Ext.Object.toQueryString(values)),values},getFieldValues:function(dirtyOnly){return this.getValues(!1,dirtyOnly,!1,!0)},clearInvalid:function(){Ext.suspendLayouts();var f,me=this,fields=me.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)fields[f].clearInvalid();return Ext.resumeLayouts(!0),me},reset:function(resetRecord){Ext.suspendLayouts();var f,me=this,fields=me.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)fields[f].reset();return Ext.resumeLayouts(!0),resetRecord===!0&&delete me._record,me},applyToFields:function(obj){var f,fields=this.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)Ext.apply(fields[f],obj);return this},applyIfToFields:function(obj){var f,fields=this.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)Ext.applyIf(fields[f],obj);return this}}),Ext.define("Ext.form.FieldAncestor",{xhooks:{initHierarchyState:function(hierarchyState){this.fieldDefaults&&(hierarchyState.fieldDefaults?hierarchyState.fieldDefaults=Ext.apply(Ext.Object.chain(hierarchyState.fieldDefaults),this.fieldDefaults):hierarchyState.fieldDefaults=this.fieldDefaults)}},initFieldAncestor:function(){var me=this;me.addEvents("fieldvaliditychange","fielderrorchange"),me.monitor=new Ext.container.Monitor({scope:me,selector:"[isFormField]:not([excludeForm])",addHandler:me.onChildFieldAdd,removeHandler:me.onChildFieldRemove}),me.initFieldDefaults()},initMonitor:function(){this.monitor.bind(this)},onChildFieldAdd:function(field){var me=this;me.mon(field,"errorchange",me.handleFieldErrorChange,me),me.mon(field,"validitychange",me.handleFieldValidityChange,me)},onChildFieldRemove:function(field){var me=this;me.mun(field,"errorchange",me.handleFieldErrorChange,me),me.mun(field,"validitychange",me.handleFieldValidityChange,me)},initFieldDefaults:function(){this.fieldDefaults||(this.fieldDefaults={})},handleFieldValidityChange:function(field,isValid){var me=this;field!==me&&(me.fireEvent("fieldvaliditychange",me,field,isValid),me.onFieldValidityChange(field,isValid))},handleFieldErrorChange:function(labelable,activeError){var me=this;labelable!==me&&(me.fireEvent("fielderrorchange",me,labelable,activeError),me.onFieldErrorChange(labelable,activeError))},onFieldValidityChange:Ext.emptyFn,onFieldErrorChange:Ext.emptyFn,beforeDestroy:function(){this.monitor.unbind(),this.callParent()}}),Ext.define("Ext.layout.component.field.FieldContainer",{extend:Ext.layout.component.field.Field,alias:"layout.fieldcontainer",type:"fieldcontainer",waitForOuterHeightInDom:!0,waitForOuterWidthInDom:!0,beginLayout:function(ownerContext){var owner=this.owner;this.callParent(arguments),ownerContext.hasRawContent=!0,owner.bodyEl.setStyle("height",""),owner.containerEl.setStyle("height",""),ownerContext.containerElContext=ownerContext.getEl("containerEl")},measureContentHeight:function(ownerContext){return ownerContext.hasDomProp("containerLayoutDone")?this.callParent(arguments):NaN},measureContentWidth:function(ownerContext){return ownerContext.hasDomProp("containerLayoutDone")?this.callParent(arguments):NaN},publishInnerWidth:function(ownerContext,width){var bodyContext=ownerContext.bodyCellContext,innerWidth=bodyContext.el.getWidth();bodyContext.setWidth(innerWidth,!1),ownerContext.containerElContext.setWidth(innerWidth,!1)},publishInnerHeight:function(ownerContext,height){var bodyContext=ownerContext.bodyCellContext,containerElContext=ownerContext.containerElContext;height-=this.measureLabelErrorHeight(ownerContext),bodyContext.setHeight(height),containerElContext.setHeight(height)}}),Ext.define("Ext.form.FieldContainer",{extend:Ext.container.Container,mixins:{labelable:Ext.form.Labelable,fieldAncestor:Ext.form.FieldAncestor},alias:"widget.fieldcontainer",componentLayout:"fieldcontainer",componentCls:Ext.baseCSSPrefix+"form-fieldcontainer",customOverflowEl:"containerEl",childEls:["containerEl"],combineLabels:!1,labelConnector:", ",combineErrors:!1,maskOnDisable:!1,invalidCls:"",fieldSubTpl:['<div id="{id}-containerEl" class="{containerElCls}" role="presentation">',"{%this.renderContainer(out,values)%}","</div>"],initComponent:function(){var me=this;me.initLabelable(),me.initFieldAncestor(),me.callParent(),me.initMonitor()},getOverflowEl:function(){return this.containerEl},onAdd:function(item){var me=this;item.isLabelable&&Ext.isGecko&&"absolute"===me.layout.type&&!me.hideLabel&&"top"!==me.labelAlign&&(item.x+=me.labelWidth+me.labelPad),me.callParent(arguments),item.isLabelable&&me.combineLabels&&(item.oldHideLabel=item.hideLabel,item.hideLabel=!0),me.updateLabel()},onRemove:function(item,isDestroying){var me=this;me.callParent(arguments),isDestroying||(item.isLabelable&&me.combineLabels&&(item.hideLabel=item.oldHideLabel),me.updateLabel())},initRenderTpl:function(){var me=this;return me.hasOwnProperty("renderTpl")||(me.renderTpl=me.getTpl("labelableRenderTpl")),me.callParent()},initRenderData:function(){var me=this,data=me.callParent();return data.containerElCls=me.containerElCls,Ext.applyIf(data,me.getLabelableRenderData())},getFieldLabel:function(){var label=this.fieldLabel||"";return!label&&this.combineLabels&&(label=Ext.Array.map(this.query("[isFieldLabelable]"),function(field){return field.getFieldLabel()}).join(this.labelConnector)),label},getSubTplData:function(){var ret=this.initRenderData();return Ext.apply(ret,this.subTplData),ret},getSubTplMarkup:function(){var html,me=this,tpl=me.getTpl("fieldSubTpl");return tpl.renderContent||me.setupRenderTpl(tpl),html=tpl.apply(me.getSubTplData())},updateLabel:function(){var me=this,label=me.labelEl;label&&me.setFieldLabel(me.getFieldLabel())},onFieldErrorChange:function(field,activeError){if(this.combineErrors){var me=this,oldError=me.getActiveError(),invalidFields=Ext.Array.filter(me.query("[isFormField]"),function(field){return field.hasActiveError()}),newErrors=me.getCombinedErrors(invalidFields);newErrors?me.setActiveErrors(newErrors):me.unsetActiveError(),oldError!==me.getActiveError()&&me.doComponentLayout()}},getCombinedErrors:function(invalidFields){var f,field,activeErrors,a,aLen,error,label,errors=[],fLen=invalidFields.length;for(f=0;f<fLen;f++)for(field=invalidFields[f],activeErrors=field.getActiveErrors(),aLen=activeErrors.length,a=0;a<aLen;a++)error=activeErrors[a],label=field.getFieldLabel(),errors.push((label?label+": ":"")+error);return errors},getTargetEl:function(){return this.containerEl},applyTargetCls:function(targetCls){var containerElCls=this.containerElCls;this.containerElCls=containerElCls?containerElCls+" "+targetCls:targetCls}}),Ext.define("Ext.layout.container.CheckboxGroup",{extend:Ext.layout.container.Container,alias:["layout.checkboxgroup"],autoFlex:!0,type:"checkboxgroup",createsInnerCt:!0,childEls:["innerCt"],renderTpl:['<table id="{ownerId}-innerCt" class="'+Ext.plainTableCls+'" cellpadding="0"','role="presentation" style="{tableStyle}">','<tbody role="presentation"><tr role="presentation">','<tpl for="columns">','<td class="{parent.colCls}" valign="top" style="{style}" role="presentation">',"{% this.renderColumn(out,parent,xindex-1) %}","</td>","</tpl>","</tr></tbody></table>"],lastOwnerItemsGeneration:null,beginLayout:function(ownerContext){var columns,numCols,i,width,cwidth,me=this,totalFlex=0,flexedCols=0,autoFlex=me.autoFlex,innerCtStyle=me.innerCt.dom.style;if(me.callParent(arguments),columns=me.columnNodes,ownerContext.innerCtContext=ownerContext.getEl("innerCt",me),ownerContext.widthModel.shrinkWrap)innerCtStyle.tableLayout="auto",innerCtStyle.width="";else{if(numCols=columns.length,me.columnsArray){for(i=0;i<numCols;i++)width=me.owner.columns[i],width<1&&(totalFlex+=width,flexedCols++);for(i=0;i<numCols;i++)width=me.owner.columns[i],cwidth=width<1?width/totalFlex*100+"%":width+"px",columns[i].style.width=cwidth}else for(i=0;i<numCols;i++)cwidth=autoFlex?1/numCols*100+"%":"",columns[i].style.width=cwidth,flexedCols++;flexedCols?flexedCols<numCols?(innerCtStyle.tableLayout="fixed",innerCtStyle.width="100%"):(innerCtStyle.tableLayout="auto",autoFlex?innerCtStyle.width="100%":innerCtStyle.width=""):(innerCtStyle.tableLayout="fixed",innerCtStyle.width="")}},cacheElements:function(){var me=this;me.callParent(),me.rowEl=me.innerCt.down("tr"),me.columnNodes=me.rowEl.dom.childNodes},calculate:function(ownerContext){var targetContext,widthShrinkWrap,heightShrinkWrap,shrinkWrap,table,targetPadding,me=this;ownerContext.getDomProp("containerChildrenSizeDone")?(targetContext=ownerContext.innerCtContext,widthShrinkWrap=ownerContext.widthModel.shrinkWrap,heightShrinkWrap=ownerContext.heightModel.shrinkWrap,shrinkWrap=heightShrinkWrap||widthShrinkWrap,table=targetContext.el.dom,targetPadding=shrinkWrap&&targetContext.getPaddingInfo(),widthShrinkWrap&&ownerContext.setContentWidth(table.offsetWidth+targetPadding.width,!0),heightShrinkWrap&&ownerContext.setContentHeight(table.offsetHeight+targetPadding.height,!0)):me.done=!1},doRenderColumn:function(out,renderData,columnIndex){var item,itemIndex,rowCount,increment,tree,me=renderData.$layout,owner=me.owner,columnCount=renderData.columnCount,items=owner.items.items,itemCount=items.length;for(owner.vertical?(rowCount=Math.ceil(itemCount/columnCount),itemIndex=columnIndex*rowCount,itemCount=Math.min(itemCount,itemIndex+rowCount),increment=1):(itemIndex=columnIndex,increment=columnCount);itemIndex<itemCount;itemIndex+=increment)item=items[itemIndex],me.configureItem(item),tree=item.getRenderTree(),Ext.DomHelper.generateMarkup(tree,out)},getColumnCount:function(){var me=this,owner=me.owner,ownerColumns=owner.columns;return me.columnsArray?ownerColumns.length:Ext.isNumber(ownerColumns)?ownerColumns:owner.items.length},getItemSizePolicy:function(item){return this.autoSizePolicy},getRenderData:function(){var i,width,column,cwidth,me=this,data=me.callParent(),owner=me.owner,columns=me.getColumnCount(),autoFlex=me.autoFlex,totalFlex=0,flexedCols=0;if(me.columnsArray)for(i=0;i<columns;i++)width=me.owner.columns[i],width<1&&(totalFlex+=width,flexedCols++);for(data.colCls=owner.groupCls,data.columnCount=columns,data.columns=[],i=0;i<columns;i++)column=data.columns[i]={},me.columnsArray?(width=me.owner.columns[i],cwidth=width<1?width/totalFlex*100+"%":width+"px",column.style="width:"+cwidth):(column.style="width:"+1/columns*100+"%",flexedCols++);return data.tableStyle=flexedCols?flexedCols<columns?"table-layout:fixed;width:100%":autoFlex?"table-layout:auto;width:100%":"table-layout:auto;":"table-layout:fixed;",data},initLayout:function(){var me=this,owner=me.owner;me.columnsArray=Ext.isArray(owner.columns),me.autoColumns=!owner.columns||"auto"===owner.columns,me.vertical=owner.vertical,me.callParent()},isValidParent:function(){return!0},setupRenderTpl:function(renderTpl){this.callParent(arguments),renderTpl.renderColumn=this.doRenderColumn},renderChildren:function(){var me=this,generation=me.owner.items.generation;me.lastOwnerItemsGeneration!==generation&&(me.lastOwnerItemsGeneration=generation,me.renderItems(me.getLayoutItems()))},renderItems:function(items){var i,item,rowCount,columnCount,rowIndex,columnIndex,me=this,itemCount=items.length;if(itemCount){for(Ext.suspendLayouts(),me.autoColumns&&me.addMissingColumns(itemCount),columnCount=me.columnNodes.length,rowCount=Math.ceil(itemCount/columnCount),i=0;i<itemCount;i++)item=items[i],rowIndex=me.getRenderRowIndex(i,rowCount,columnCount),columnIndex=me.getRenderColumnIndex(i,rowCount,columnCount),item.rendered?me.isItemAtPosition(item,rowIndex,columnIndex)||me.moveItem(item,rowIndex,columnIndex):me.renderItem(item,rowIndex,columnIndex);me.autoColumns&&me.removeExceedingColumns(itemCount),Ext.resumeLayouts(!0)}},isItemAtPosition:function(item,rowIndex,columnIndex){return item.el.dom===this.getNodeAt(rowIndex,columnIndex)},getRenderColumnIndex:function(itemIndex,rowCount,columnCount){return this.vertical?Math.floor(itemIndex/rowCount):itemIndex%columnCount},getRenderRowIndex:function(itemIndex,rowCount,columnCount){var me=this;return me.vertical?itemIndex%rowCount:Math.floor(itemIndex/columnCount)},getNodeAt:function(rowIndex,columnIndex){return this.columnNodes[columnIndex].childNodes[rowIndex]},addMissingColumns:function(itemsCount){var missingColumnsCount,row,cls,i,me=this,existingColumnsCount=me.columnNodes.length;if(existingColumnsCount<itemsCount)for(missingColumnsCount=itemsCount-existingColumnsCount,row=me.rowEl,cls=me.owner.groupCls,i=0;i<missingColumnsCount;i++)row.createChild({cls:cls,tag:"td",vAlign:"top",role:"presentation"})},removeExceedingColumns:function(itemsCount){var exceedingColumnsCount,row,i,me=this,existingColumnsCount=me.columnNodes.length;if(existingColumnsCount>itemsCount)for(exceedingColumnsCount=existingColumnsCount-itemsCount,row=me.rowEl,i=0;i<exceedingColumnsCount;i++)row.last().remove()},renderItem:function(item,rowIndex,columnIndex){var me=this;me.configureItem(item),item.render(Ext.get(me.columnNodes[columnIndex]),rowIndex),me.afterRenderItem(item)},moveItem:function(item,rowIndex,columnIndex){var me=this,column=me.columnNodes[columnIndex],targetNode=column.childNodes[rowIndex];column.insertBefore(item.el.dom,targetNode||null)}}),Ext.define("Ext.form.CheckboxManager",{extend:Ext.util.MixedCollection,singleton:!0,getByName:function(name,formId){return this.filterBy(function(item){return item.name==name&&item.getFormId()==formId})}}),Ext.define("Ext.form.field.Checkbox",{extend:Ext.form.field.Base,alias:["widget.checkboxfield","widget.checkbox"],alternateClassName:"Ext.form.Checkbox",componentLayout:"field",stretchInputElFixed:!1,childEls:["boxLabelEl"],fieldSubTpl:['<div class="{wrapInnerCls} {noBoxLabelCls}" role="presentation">','<tpl if="labelAlignedBefore">',"{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>",'<input type="button" id="{id}" role="{role}" {inputAttrTpl}','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls} {typeCls} {inputCls} {childElCls} {afterLabelCls}" autocomplete="off" hidefocus="true" />','<tpl if="boxLabel && !labelAlignedBefore">',"{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>","</div>",{disableFormats:!0,compiled:!0}],subTplInsertions:["beforeBoxLabelTpl","afterBoxLabelTpl","beforeBoxLabelTextTpl","afterBoxLabelTextTpl","boxLabelAttrTpl","inputAttrTpl"],isCheckbox:!0,focusCls:"form-checkbox-focus",extraFieldBodyCls:Ext.baseCSSPrefix+"form-cb-wrap",checked:!1,checkedCls:Ext.baseCSSPrefix+"form-cb-checked",boxLabelCls:Ext.baseCSSPrefix+"form-cb-label",boxLabelAlign:"after",afterLabelCls:Ext.baseCSSPrefix+"form-cb-after",wrapInnerCls:Ext.baseCSSPrefix+"form-cb-wrap-inner",noBoxLabelCls:Ext.baseCSSPrefix+"form-cb-wrap-inner-no-box-label",inputValue:"on",checkChangeEvents:[],inputType:"checkbox",ariaRole:"checkbox",onRe:/^on$/i,inputCls:Ext.baseCSSPrefix+"form-cb",initComponent:function(){var me=this,value=me.value;void 0!==value&&(me.checked=me.isChecked(value,me.inputValue)),me.callParent(arguments),me.getManager().add(me)},initValue:function(){var me=this,checked=!!me.checked;me.originalValue=me.lastValue=checked,me.setValue(checked)},getElConfig:function(){var me=this;return me.isChecked(me.rawValue,me.inputValue)&&me.addCls(me.checkedCls),me.callParent()},getSubTplData:function(){var me=this,boxLabel=me.boxLabel,boxLabelAlign=me.boxLabelAlign,labelAlignedBefore=boxLabel&&"before"===boxLabelAlign;return Ext.apply(me.callParent(),{disabled:me.readOnly||me.disabled,wrapInnerCls:me.wrapInnerCls,boxLabel:boxLabel,boxLabelCls:me.boxLabelCls,boxLabelAlign:boxLabelAlign,labelAlignedBefore:labelAlignedBefore,afterLabelCls:labelAlignedBefore?me.afterLabelCls:"",noBoxLabelCls:boxLabel?"":me.noBoxLabelCls,role:me.ariaRole})},initEvents:function(){var me=this;me.callParent(),me.mon(me.inputEl,"click",me.onBoxClick,me)},setBoxLabel:function(boxLabel){var me=this;me.boxLabel=boxLabel,me.rendered&&me.boxLabelEl.update(boxLabel)},onBoxClick:function(e){var me=this;me.disabled||me.readOnly||this.setValue(!this.checked)},getRawValue:function(){return this.checked},getValue:function(){return this.checked},getSubmitValue:function(){var unchecked=this.uncheckedValue,uncheckedVal=Ext.isDefined(unchecked)?unchecked:null;return this.checked?this.inputValue:uncheckedVal},isChecked:function(rawValue,inputValue){return rawValue===!0||"true"===rawValue||"1"===rawValue||1===rawValue||((Ext.isString(rawValue)||Ext.isNumber(rawValue))&&inputValue?rawValue==inputValue:this.onRe.test(rawValue))},setRawValue:function(value){var me=this,inputEl=me.inputEl,checked=me.isChecked(value,me.inputValue);return inputEl&&me[checked?"addCls":"removeCls"](me.checkedCls),me.checked=me.rawValue=checked,checked},setValue:function(checked){var boxes,i,len,box,me=this;if(Ext.isArray(checked))for(boxes=me.getManager().getByName(me.name,me.getFormId()).items,len=boxes.length,i=0;i<len;++i)box=boxes[i],box.setValue(Ext.Array.contains(checked,box.inputValue));else me.callParent(arguments);return me},valueToRaw:function(value){return value},onChange:function(newVal,oldVal){var me=this,handler=me.handler;handler&&handler.call(me.scope||me,me,newVal),me.callParent(arguments)},resetOriginalValue:function(fromBoxInGroup){var boxes,box,len,i,me=this;if(!fromBoxInGroup)for(boxes=me.getManager().getByName(me.name,me.getFormId()).items,len=boxes.length,i=0;i<len;++i)box=boxes[i],box!==me&&boxes[i].resetOriginalValue(!0);me.callParent()},beforeDestroy:function(){this.callParent(),this.getManager().removeAtKey(this.id)},getManager:function(){return Ext.form.CheckboxManager},onEnable:function(){var me=this,inputEl=me.inputEl;me.callParent(),inputEl&&(inputEl.dom.disabled=me.readOnly)},setReadOnly:function(readOnly){var me=this,inputEl=me.inputEl;inputEl&&(inputEl.dom.disabled=!!readOnly||me.disabled),me.callParent(arguments)},getFormId:function(){var form,me=this;return me.formId||(form=me.up("form"),form&&(me.formId=form.id)),me.formId}}),Ext.define("Ext.form.CheckboxGroup",{extend:Ext.form.FieldContainer,mixins:{field:Ext.form.field.Field},alias:"widget.checkboxgroup",columns:"auto",vertical:!1,allowBlank:!0,blankText:"You must select at least one item in this group",defaultType:"checkboxfield",groupCls:Ext.baseCSSPrefix+"form-check-group",extraFieldBodyCls:Ext.baseCSSPrefix+"form-checkboxgroup-body",layout:"checkboxgroup",componentCls:Ext.baseCSSPrefix+"form-checkboxgroup",ariaRole:"group",initComponent:function(){var me=this;me.callParent(),me.initField()},initValue:function(){var me=this,valueCfg=me.value;me.originalValue=me.lastValue=valueCfg||me.getValue(),valueCfg&&me.setValue(valueCfg)},onAdd:function(item){var items,len,i,me=this;if(item.isCheckbox)me.mon(item,"change",me.checkChange,me);else if(item.isContainer)for(items=item.items.items,i=0,len=items.length;i<len;i++)me.onAdd(items[i]);me.callParent(arguments)},onRemove:function(item){var items,len,i,me=this;if(item.isCheckbox)me.mun(item,"change",me.checkChange,me);else if(item.isContainer)for(items=item.items.items,i=0,len=items.length;i<len;i++)me.onRemove(items[i]);me.callParent(arguments)},isEqual:function(value1,value2){var toQueryString=Ext.Object.toQueryString;return toQueryString(value1)===toQueryString(value2)},getErrors:function(){var errors=[];return!this.allowBlank&&Ext.isEmpty(this.getChecked())&&errors.push(this.blankText),errors},getBoxes:function(query){return this.query("[isCheckbox]"+(query||""))},eachBox:function(fn,scope){Ext.Array.forEach(this.getBoxes(),fn,scope||this)},getChecked:function(){return this.getBoxes("[checked]")},isDirty:function(){var b,boxes=this.getBoxes(),bLen=boxes.length;for(b=0;b<bLen;b++)if(boxes[b].isDirty())return!0},setReadOnly:function(readOnly){var b,boxes=this.getBoxes(),bLen=boxes.length;for(b=0;b<bLen;b++)boxes[b].setReadOnly(readOnly);this.readOnly=readOnly},reset:function(){var me=this,hadError=me.hasActiveError(),preventMark=me.preventMark;me.preventMark=!0,me.batchChanges(function(){var b,boxes=me.getBoxes(),bLen=boxes.length;for(b=0;b<bLen;b++)boxes[b].reset()}),me.preventMark=preventMark,me.unsetActiveError(),hadError&&me.updateLayout()},resetOriginalValue:function(){var b,me=this,boxes=me.getBoxes(),bLen=boxes.length;for(b=0;b<bLen;b++)boxes[b].resetOriginalValue();me.originalValue=me.getValue(),me.checkDirty()},setValue:function(value){var b,box,name,cbValue,me=this,boxes=me.getBoxes(),bLen=boxes.length;return me.batchChanges(function(){for(b=0;b<bLen;b++)box=boxes[b],name=box.getName(),cbValue=!1,value&&value.hasOwnProperty(name)&&(cbValue=Ext.isArray(value[name])?Ext.Array.contains(value[name],box.inputValue):value[name]),box.setValue(cbValue)}),me},getValue:function(){var b,box,name,inputValue,bucket,values={},boxes=this.getBoxes(),bLen=boxes.length;for(b=0;b<bLen;b++)box=boxes[b],name=box.getName(),inputValue=box.inputValue,box.getValue()&&(values.hasOwnProperty(name)?(bucket=values[name],Ext.isArray(bucket)||(bucket=values[name]=[bucket]),bucket.push(inputValue)):values[name]=inputValue);return values},getSubmitData:function(){return null},getModelData:function(){return null},validate:function(){var errors,isValid,wasValid,me=this;return me.disabled?isValid=!0:(errors=me.getErrors(),isValid=Ext.isEmpty(errors),wasValid=me.wasValid,isValid?me.unsetActiveError():me.setActiveError(errors)),isValid!==wasValid&&(me.wasValid=isValid,me.fireEvent("validitychange",me,isValid),me.updateLayout()),isValid}},function(){this.borrow(Ext.form.field.Base,["markInvalid","clearInvalid","setError"])}),Ext.define("Ext.form.FieldSet",{extend:Ext.container.Container,mixins:{fieldAncestor:Ext.form.FieldAncestor},alias:"widget.fieldset",collapsed:!1,toggleOnTitleClick:!0,baseCls:Ext.baseCSSPrefix+"fieldset",layout:"anchor",componentLayout:"fieldset",ariaRole:null,autoEl:"fieldset",childEls:["body"],renderTpl:["{%this.renderLegend(out,values);%}",'<div id="{id}-body" class="{baseCls}-body {bodyTargetCls}" role="presentation"<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values);%}","</div>"],stateEvents:["collapse","expand"],maskOnDisable:!1,beforeDestroy:function(){var me=this,legend=me.legend;legend&&(delete legend.ownerCt,legend.destroy(),me.legend=null),me.callParent()},initComponent:function(){var me=this,baseCls=me.baseCls;me.initFieldAncestor(),me.callParent(),me.layout.managePadding=me.layout.manageOverflow=!1,me.addEvents("beforeexpand","beforecollapse","expand","collapse"),me.collapsed&&(me.addCls(baseCls+"-collapsed"),me.collapse()),(me.title||me.checkboxToggle||me.collapsible)&&(me.addTitleClasses(),me.legend=Ext.widget(me.createLegendCt())),me.initMonitor()},initPadding:function(targetEl){var bodyPadding,me=this,body=me.getProtoBody(),padding=me.padding;void 0!==padding&&((Ext.isIEQuirks||Ext.isIE8m)&&(padding=me.parseBox(padding),bodyPadding=Ext.Element.parseBox(0),bodyPadding.top=padding.top,padding.top=0,body.setStyle("padding",me.unitizeBox(bodyPadding))),targetEl.setStyle("padding",me.unitizeBox(padding)))},getProtoBody:function(){var me=this,body=me.protoBody;return body||(me.protoBody=body=new Ext.util.ProtoElement({styleProp:"bodyStyle",styleIsText:!0})),body},initRenderData:function(){var me=this,data=me.callParent();return data.bodyTargetCls=me.bodyTargetCls,me.protoBody.writeTo(data),delete me.protoBody,data},getState:function(){var state=this.callParent();return state=this.addPropertyToState(state,"collapsed")},afterCollapse:Ext.emptyFn,afterExpand:Ext.emptyFn,collapsedHorizontal:function(){return!0},collapsedVertical:function(){return!0},createLegendCt:function(){var me=this,items=[],legend={xtype:"container",baseCls:me.baseCls+"-header",id:me.id+"-legend",autoEl:"legend",ariaRole:null,ariaLabelledBy:"."+me.baseCls+"-header-text",items:items,ownerCt:me,shrinkWrap:!0,ownerLayout:me.componentLayout};return me.checkboxToggle?items.push(me.createCheckboxCmp()):me.collapsible&&items.push(me.createToggleCmp()),items.push(me.createTitleCmp()),legend},createTitleCmp:function(){var me=this,cfg={xtype:"component",html:me.title,cls:me.baseCls+"-header-text",id:me.id+"-legendTitle"};return me.collapsible&&me.toggleOnTitleClick&&(cfg.listeners={click:{element:"el",scope:me,fn:me.toggle}},cfg.cls+=" "+me.baseCls+"-header-text-collapsible"),me.titleCmp=Ext.widget(cfg)},createCheckboxCmp:function(){var me=this,suffix="-checkbox";return me.checkboxCmp=Ext.widget({xtype:"checkbox",hideEmptyLabel:!0,name:me.checkboxName||me.id+suffix,cls:me.baseCls+"-header"+suffix,id:me.id+"-legendChk",checked:!me.collapsed,msgTarget:"none",listeners:{change:me.onCheckChange,scope:me}}),me.checkboxCmp},createToggleCmp:function(){var me=this;return me.toggleCmp=Ext.widget({xtype:"tool",height:15,width:15,type:"toggle",handler:me.toggle,id:me.id+"-legendToggle",scope:me}),me.toggleCmp},doRenderLegend:function(out,renderData){var tree,me=renderData.$comp,legend=me.legend;legend&&(legend.ownerLayout.configureItem(legend),tree=legend.getRenderTree(),Ext.DomHelper.generateMarkup(tree,out))},finishRender:function(){var legend=this.legend;this.callParent(),legend&&legend.finishRender()},getCollapsed:function(){return!!this.collapsed&&"top"},getCollapsedDockedItems:function(){var legend=this.legend;return legend?[legend]:[]},setTitle:function(title){var me=this,legend=me.legend;me.baseCls;return me.title=title,me.rendered?(legend||(me.legend=legend=Ext.widget(me.createLegendCt()),me.addTitleClasses(),legend.ownerLayout.configureItem(legend),legend.render(me.el,0)),me.titleCmp.update(title)):legend?me.titleCmp.update(title):(me.addTitleClasses(),me.legend=Ext.widget(me.createLegendCt())),me},addTitleClasses:function(){var me=this,title=me.title,baseCls=me.baseCls;title&&me.addCls(baseCls+"-with-title"),(title||me.checkboxToggle||me.collapsible)&&me.addCls(baseCls+"-with-legend")},applyTargetCls:function(targetCls){this.bodyTargetCls=targetCls},getTargetEl:function(){return this.body||this.frameBody||this.el},getDefaultContentTarget:function(){return this.body},expand:function(){return this.setExpanded(!0)},collapse:function(){return this.setExpanded(!1)},setExpanded:function(expanded){var me=this,checkboxCmp=me.checkboxCmp,operation=expanded?"expand":"collapse";return me.rendered&&me.fireEvent("before"+operation,me)===!1||(expanded=!!expanded,checkboxCmp&&checkboxCmp.setValue(expanded),expanded?me.removeCls(me.baseCls+"-collapsed"):me.addCls(me.baseCls+"-collapsed"),me.collapsed=!expanded,expanded?delete me.getHierarchyState().collapsed:me.getHierarchyState().collapsed=!0,me.rendered&&(me.updateLayout({isRoot:!1}),me.fireEvent(operation,me))),me},getRefItems:function(deep){var refItems=this.callParent(arguments),legend=this.legend;return legend&&(refItems.unshift(legend),deep&&refItems.unshift.apply(refItems,legend.getRefItems(!0))),refItems},toggle:function(){this.setExpanded(!!this.collapsed)},onCheckChange:function(cmp,checked){this.setExpanded(checked)},setupRenderTpl:function(renderTpl){
this.callParent(arguments),renderTpl.renderLegend=this.doRenderLegend}}),Ext.define("Ext.form.Label",{extend:Ext.Component,alias:"widget.label",autoEl:"label",maskOnDisable:!1,getElConfig:function(){var me=this;return me.html=me.text?Ext.util.Format.htmlEncode(me.text):me.html||"",Ext.apply(me.callParent(),{htmlFor:me.forId||""})},setText:function(text,encode){var me=this;return encode=encode!==!1,encode?(me.text=text,delete me.html):(me.html=text,delete me.text),me.rendered&&(me.el.dom.innerHTML=encode!==!1?Ext.util.Format.htmlEncode(text):text,me.updateLayout()),me}}),Ext.define("Ext.form.Panel",{extend:Ext.panel.Panel,mixins:{fieldAncestor:Ext.form.FieldAncestor},alias:"widget.form",alternateClassName:["Ext.FormPanel","Ext.form.FormPanel"],layout:"anchor",ariaRole:"form",basicFormConfigs:["api","baseParams","errorReader","jsonSubmit","method","paramOrder","paramsAsHash","reader","standardSubmit","timeout","trackResetOnLoad","url","waitMsgTarget","waitTitle"],initComponent:function(){var me=this;me.frame&&(me.border=!1),me.initFieldAncestor(),me.callParent(),me.relayEvents(me.form,["beforeaction","actionfailed","actioncomplete","validitychange","dirtychange"]),me.pollForChanges&&me.startPolling(me.pollInterval||500)},initItems:function(){this.callParent(),this.initMonitor(),this.form=this.createForm()},afterFirstLayout:function(){this.callParent(arguments),this.form.initialize()},createForm:function(){for(var prop,cfg={},props=this.basicFormConfigs,len=props.length,i=0;i<len;++i)prop=props[i],cfg[prop]=this[prop];return new Ext.form.Basic(this,cfg)},getForm:function(){return this.form},loadRecord:function(record){return this.getForm().loadRecord(record)},getRecord:function(){return this.getForm().getRecord()},updateRecord:function(record){return this.getForm().updateRecord(record)},getValues:function(asString,dirtyOnly,includeEmptyText,useDataValues){return this.getForm().getValues(asString,dirtyOnly,includeEmptyText,useDataValues)},isDirty:function(){return this.form.isDirty()},isValid:function(){return this.form.isValid()},hasInvalidField:function(){return this.form.hasInvalidField()},beforeDestroy:function(){this.stopPolling(),this.form.destroy(),this.callParent()},load:function(options){this.form.load(options)},submit:function(options){this.form.submit(options)},startPolling:function(interval){this.stopPolling();var task=new Ext.util.TaskRunner(interval);task.start({interval:0,run:this.checkChange,scope:this}),this.pollTask=task},stopPolling:function(){var task=this.pollTask;task&&(task.stopAll(),delete this.pollTask)},checkChange:function(){var f,fields=this.form.getFields().items,fLen=fields.length;for(f=0;f<fLen;f++)fields[f].checkChange()}}),Ext.define("Ext.form.RadioManager",{extend:Ext.util.MixedCollection,singleton:!0,getByName:function(name,formId){return this.filterBy(function(item){return item.name==name&&item.getFormId()==formId})},getWithValue:function(name,value,formId){return this.filterBy(function(item){return item.name==name&&item.inputValue==value&&item.getFormId()==formId})},getChecked:function(name,formId){return this.findBy(function(item){return item.name==name&&item.checked&&item.getFormId()==formId})}}),Ext.define("Ext.form.field.Radio",{extend:Ext.form.field.Checkbox,alias:["widget.radiofield","widget.radio"],alternateClassName:"Ext.form.Radio",isRadio:!0,focusCls:"form-radio-focus",inputType:"radio",ariaRole:"radio",formId:null,getGroupValue:function(){var selected=this.getManager().getChecked(this.name,this.getFormId());return selected?selected.inputValue:null},onBoxClick:function(e){var me=this;me.disabled||me.readOnly||this.setValue(!0)},onRemoved:function(){this.callParent(arguments),this.formId=null},setValue:function(v){var active,me=this;return Ext.isBoolean(v)?me.callParent(arguments):(active=me.getManager().getWithValue(me.name,v,me.getFormId()).getAt(0),active&&active.setValue(!0)),me},getSubmitValue:function(){return this.checked?this.inputValue:null},getModelData:function(){var o=this.callParent(arguments);return o&&(o[this.getName()]=this.getSubmitValue()),o},onChange:function(newVal,oldVal){var r,rLen,radio,radios,me=this;if(me.callParent(arguments),newVal)for(radios=me.getManager().getByName(me.name,me.getFormId()).items,rLen=radios.length,r=0;r<rLen;r++)radio=radios[r],radio!==me&&radio.setValue(!1)},getManager:function(){return Ext.form.RadioManager}}),Ext.define("Ext.form.RadioGroup",{extend:Ext.form.CheckboxGroup,alias:"widget.radiogroup",allowBlank:!0,blankText:"You must select one item in this group",defaultType:"radiofield",groupCls:Ext.baseCSSPrefix+"form-radio-group",ariaRole:"radiogroup",getBoxes:function(query){return this.query("[isRadio]"+(query||""))},checkChange:function(){var value=this.getValue(),key=Ext.Object.getKeys(value)[0];Ext.isArray(value[key])||this.callParent(arguments)},setValue:function(value){var cbValue,first,formId,radios,i,len,name;if(Ext.isObject(value))for(name in value)if(value.hasOwnProperty(name))for(cbValue=value[name],first=this.items.first(),formId=first?first.getFormId():null,radios=Ext.form.RadioManager.getWithValue(name,cbValue,formId).items,len=radios.length,i=0;i<len;++i)radios[i].setValue(!0);return this}}),Ext.define("Ext.form.action.DirectLoad",{extend:Ext.form.action.Load,alternateClassName:"Ext.form.Action.DirectLoad",alias:"formaction.directload",type:"directload",run:function(){var method,args,me=this,form=me.form,api=form.api,fn=api.load;"function"!=typeof fn&&(api.load=fn=Ext.direct.Manager.parseMethod(fn)),method=fn.directCfg.method,args=method.getArgs(me.getParams(),form.paramOrder,form.paramsAsHash),args.push(me.onComplete,me),fn.apply(window,args)},processResponse:function(result){return this.result=result},onComplete:function(data,response){data?this.onSuccess(data):this.onFailure(null)}}),Ext.define("Ext.form.action.DirectSubmit",{extend:Ext.form.action.Submit,alternateClassName:"Ext.form.Action.DirectSubmit",alias:"formaction.directsubmit",type:"directsubmit",doSubmit:function(){var options,me=this,form=me.form,api=form.api,fn=api.submit,callback=Ext.Function.bind(me.onComplete,me),formInfo=me.buildForm();"function"!=typeof fn&&(api.submit=fn=Ext.direct.Manager.parseMethod(fn),me.cleanup(formInfo)),(me.timeout||form.timeout)&&(options={timeout:1e3*me.timeout||1e3*form.timeout}),fn.call(window,formInfo.formEl,callback,me,options),me.cleanup(formInfo)},processResponse:function(result){return this.result=result},onComplete:function(data,response){data?this.onSuccess(data):this.onFailure(null)}}),Ext.define("Ext.form.action.StandardSubmit",{extend:Ext.form.action.Submit,alias:"formaction.standardsubmit",doSubmit:function(){var formInfo=this.buildForm();formInfo.formEl.submit(),this.cleanup(formInfo)}}),Ext.define("Ext.layout.component.field.Trigger",{alias:"layout.triggerfield",extend:Ext.layout.component.field.Field,type:"triggerfield",setWidthInDom:!0,borderWidths:{},beginLayout:function(ownerContext){var flags,me=this,owner=me.owner;ownerContext.triggerWrap=ownerContext.getEl("triggerWrap"),me.callParent(arguments),flags=owner.getTriggerStateFlags(),flags!=owner.lastTriggerStateFlags&&(owner.lastTriggerStateFlags=flags,me.updateEditState())},beginLayoutCycle:function(ownerContext){this.callParent(arguments),ownerContext.widthModel.shrinkWrap&&!this.owner.inputWidth&&ownerContext.inputContext.el.setStyle("width","")},beginLayoutFixed:function(ownerContext,width,suffix){var me=this,owner=ownerContext.target,ieInputWidthAdjustment=me.ieInputWidthAdjustment||0,inputWidth="100%",triggerWrap=owner.triggerWrap;me.callParent(arguments),owner.inputCell.setStyle("width","100%"),ieInputWidthAdjustment&&(me.adjustIEInputPadding(ownerContext),"px"===suffix&&(inputWidth=owner.inputWidth?owner.inputWidth-me.getExtraWidth(ownerContext):width-ieInputWidthAdjustment-me.getExtraWidth(ownerContext),inputWidth+="px")),owner.inputEl.setStyle("width",inputWidth),inputWidth=owner.inputWidth,inputWidth?triggerWrap.setStyle("width",inputWidth+ieInputWidthAdjustment+"px"):triggerWrap.setStyle("width",width+suffix),triggerWrap.setStyle("table-layout","fixed")},adjustIEInputPadding:function(ownerContext){this.owner.inputCell.setStyle("padding-right",this.ieInputWidthAdjustment+"px")},getExtraWidth:function(ownerContext){var me=this,owner=me.owner,borderWidths=me.borderWidths,ui=owner.ui+owner.triggerEl.getCount();return ui in borderWidths||(borderWidths[ui]=ownerContext.triggerWrap.getBorderInfo().width),borderWidths[ui]+owner.getTriggerWidth()},beginLayoutShrinkWrap:function(ownerContext){var owner=ownerContext.target,emptyString="",inputWidth=owner.inputWidth,triggerWrap=owner.triggerWrap;this.callParent(arguments),inputWidth?(triggerWrap.setStyle("width",inputWidth+"px"),inputWidth=inputWidth-this.getExtraWidth(ownerContext)+"px",owner.inputEl.setStyle("width",inputWidth),owner.inputCell.setStyle("width",inputWidth)):(owner.inputCell.setStyle("width",emptyString),owner.inputEl.setStyle("width",emptyString),triggerWrap.setStyle("width",emptyString),triggerWrap.setStyle("table-layout","auto"))},getTextWidth:function(){var value,me=this,owner=me.owner,inputEl=owner.inputEl;return value=(inputEl.dom.value||(owner.hasFocus?"":owner.emptyText)||"")+owner.growAppend,inputEl.getTextWidth(value)},publishOwnerWidth:function(ownerContext,width){var owner=this.owner;this.callParent(arguments),owner.grow||owner.inputWidth||(width-=this.getExtraWidth(ownerContext),"top"!=owner.labelAlign&&(width-=owner.getLabelWidth()),ownerContext.inputContext.setWidth(width))},publishInnerHeight:function(ownerContext,height){ownerContext.inputContext.setHeight(height-this.measureLabelErrorHeight(ownerContext))},measureContentWidth:function(ownerContext){var calcWidth,max,min,me=this,owner=me.owner,width=me.callParent(arguments),inputContext=ownerContext.inputContext;return owner.grow&&!ownerContext.state.growHandled?(calcWidth=me.getTextWidth()+ownerContext.inputContext.getFrameInfo().width,max=owner.growMax,min=Math.min(max,width),max=Math.max(owner.growMin,max,min),calcWidth=Ext.Number.constrain(calcWidth,owner.growMin,max),inputContext.setWidth(calcWidth),ownerContext.state.growHandled=!0,inputContext.domBlock(me,"width"),width=NaN):owner.inputWidth||(width-=me.getExtraWidth(ownerContext)),width},updateEditState:function(){var displayed,readOnly,me=this,owner=me.owner,inputEl=owner.inputEl,noeditCls=Ext.baseCSSPrefix+"trigger-noedit";me.owner.readOnly?(inputEl.addCls(noeditCls),readOnly=!0,displayed=!1):(me.owner.editable?(inputEl.removeCls(noeditCls),readOnly=!1):(inputEl.addCls(noeditCls),readOnly=!0),displayed=!me.owner.hideTrigger),owner.triggerCell.setDisplayed(displayed),inputEl.dom.readOnly=readOnly}}),Ext.define("Ext.form.field.Trigger",{extend:Ext.form.field.Text,alias:["widget.triggerfield","widget.trigger"],alternateClassName:["Ext.form.TriggerField","Ext.form.TwinTriggerField","Ext.form.Trigger"],childEls:[{name:"triggerCell",select:"."+Ext.baseCSSPrefix+"trigger-cell"},{name:"triggerEl",select:"."+Ext.baseCSSPrefix+"form-trigger"},"triggerWrap","inputCell"],triggerBaseCls:Ext.baseCSSPrefix+"form-trigger",triggerWrapCls:Ext.baseCSSPrefix+"form-trigger-wrap",triggerNoEditCls:Ext.baseCSSPrefix+"trigger-noedit",hideTrigger:!1,editable:!0,readOnly:!1,repeatTriggerClick:!1,autoSize:Ext.emptyFn,monitorTab:!0,mimicing:!1,triggerIndexRe:/trigger-index-(\d+)/,extraTriggerCls:"",componentLayout:"triggerfield",initComponent:function(){this.wrapFocusCls=this.triggerWrapCls+"-focus",this.callParent(arguments)},getSubTplMarkup:function(values){var me=this,childElCls=values.childElCls,field=me.callParent(arguments);return['<table id="',me.id,'-triggerWrap" class="',Ext.baseCSSPrefix,"form-trigger-wrap",childElCls,'" cellpadding="0" cellspacing="0" role="presentation">','<tbody role="presentation">','<tr role="presentation">','<td id="',me.id,'-inputCell" class="',Ext.baseCSSPrefix,"form-trigger-input-cell",childElCls,'" role="presentation">',field,"</td>",me.getTriggerMarkup(),"</tr>","</tbody>","</table>"].join("")},getSubTplData:function(){var me=this,data=me.callParent(),readOnly=me.readOnly===!0,editable=me.editable!==!1;return Ext.apply(data,{editableCls:readOnly||!editable?" "+me.triggerNoEditCls:"",readOnly:!editable||readOnly})},getLabelableRenderData:function(){var me=this,triggerWrapCls=me.triggerWrapCls,result=me.callParent(arguments);return Ext.applyIf(result,{triggerWrapCls:triggerWrapCls,triggerMarkup:me.getTriggerMarkup()})},getTriggerMarkup:function(){var triggerCls,me=this,i=0,hideTrigger=me.readOnly||me.hideTrigger,triggerBaseCls=me.triggerBaseCls,triggerConfigs=[],unselectableCls=Ext.dom.Element.unselectableCls,style="width:"+me.triggerWidth+"px;"+(hideTrigger?"display:none;":""),cls=me.extraTriggerCls+" "+Ext.baseCSSPrefix+"trigger-cell "+unselectableCls;for(me.trigger1Cls||(me.trigger1Cls=me.triggerCls),i=0;(triggerCls=me["trigger"+(i+1)+"Cls"])||i<1;i++)triggerConfigs.push({tag:"td",role:"presentation",valign:"top",cls:cls,style:style,cn:{cls:[Ext.baseCSSPrefix+"trigger-index-"+i,triggerBaseCls,triggerCls].join(" "),role:"presentation"}});return triggerConfigs[0].cn.cls+=" "+triggerBaseCls+"-first",Ext.DomHelper.markup(triggerConfigs)},disableCheck:function(){return!this.disabled},beforeRender:function(){var tempEl,me=this,triggerBaseCls=me.triggerBaseCls;me.triggerWidth||(tempEl=Ext.getBody().createChild({role:"presentation",style:"position: absolute;",cls:Ext.baseCSSPrefix+"form-trigger"}),Ext.form.field.Trigger.prototype.triggerWidth=tempEl.getWidth(),tempEl.remove()),me.callParent(),triggerBaseCls!=Ext.baseCSSPrefix+"form-trigger"&&me.addChildEls({name:"triggerEl",select:"."+triggerBaseCls}),me.lastTriggerStateFlags=me.getTriggerStateFlags()},onRender:function(){var me=this;me.callParent(arguments),me.doc=Ext.getDoc(),me.initTrigger()},getTriggerWidth:function(){var me=this,totalTriggerWidth=0;return!me.triggerWrap||me.hideTrigger||me.readOnly||(totalTriggerWidth=me.triggerEl.getCount()*me.triggerWidth),totalTriggerWidth},setHideTrigger:function(hideTrigger){hideTrigger!=this.hideTrigger&&(this.hideTrigger=hideTrigger,this.updateLayout())},setEditable:function(editable){editable!=this.editable&&(this.editable=editable,this.updateLayout())},setReadOnly:function(readOnly){var me=this,old=me.readOnly;me.callParent(arguments),readOnly!=old&&me.updateLayout()},initTrigger:function(){var els,len,el,i,idx,cls,me=this,triggerWrap=me.triggerWrap,triggerEl=me.triggerEl,disableCheck=me.disableCheck;for(me.repeatTriggerClick?me.triggerRepeater=new Ext.util.ClickRepeater(triggerWrap,{preventDefault:!0,handler:me.onTriggerWrapClick,listeners:{mouseup:me.onTriggerWrapMouseup,scope:me},scope:me}):me.mon(triggerWrap,{click:me.onTriggerWrapClick,mouseup:me.onTriggerWrapMouseup,scope:me}),triggerEl.setVisibilityMode(Ext.Element.DISPLAY),triggerEl.addClsOnOver(me.triggerBaseCls+"-over",disableCheck,me),els=triggerEl.elements,len=els.length,i=0;i<len;i++)el=els[i],idx=i+1,cls=me["trigger"+idx+"Cls"],cls&&(el.addClsOnOver(cls+"-over",disableCheck,me),el.addClsOnClick(cls+"-click",disableCheck,me));triggerEl.addClsOnClick(me.triggerBaseCls+"-click",disableCheck,me)},onDestroy:function(){var me=this;Ext.destroyMembers(me,"triggerRepeater","triggerWrap","triggerEl"),delete me.doc,me.callParent()},onFocus:function(){var me=this;me.callParent(arguments),me.mimicing||(me.bodyEl.addCls(me.wrapFocusCls),me.mimicing=!0,me.mon(me.doc,"mousedown",me.mimicBlur,me,{delay:10}),me.monitorTab&&me.on("specialkey",me.checkTab,me))},checkTab:function(me,e){this.ignoreMonitorTab||e.getKey()!=e.TAB||this.triggerBlur()},getTriggerStateFlags:function(){var me=this,state=0;return me.readOnly&&(state+=1),me.editable&&(state+=2),me.hideTrigger&&(state+=4),state},onBlur:function(){var me=this;me.blurTask;me.blurring&&me.triggerBlur()},mimicBlur:function(e){this.isDestroyed||this.bodyEl.contains(e.target)||!this.validateBlur(e)||this.triggerBlur(e)},triggerBlur:function(e){var me=this;me.mimicing=!1,me.mun(me.doc,"mousedown",me.mimicBlur,me),me.monitorTab&&me.inputEl&&me.un("specialkey",me.checkTab,me),Ext.form.field.Trigger.superclass.onBlur.call(me,e),me.bodyEl&&me.bodyEl.removeCls(me.wrapFocusCls)},validateBlur:function(e){return!0},onTriggerWrapClick:function(){var targetEl,match,triggerClickMethod,event,me=this;event=arguments[me.triggerRepeater?1:0],!event||me.readOnly||me.disabled||(targetEl=event.getTarget("."+me.triggerBaseCls,null),match=targetEl&&targetEl.className.match(me.triggerIndexRe),match&&(triggerClickMethod=me["onTrigger"+(parseInt(match[1],10)+1)+"Click"]||me.onTriggerClick,triggerClickMethod&&triggerClickMethod.call(me,event)))},onTriggerWrapMouseup:Ext.emptyFn,onTriggerClick:Ext.emptyFn}),Ext.define("Ext.form.field.Picker",{extend:Ext.form.field.Trigger,alias:"widget.pickerfield",alternateClassName:"Ext.form.Picker",matchFieldWidth:!0,pickerAlign:"tl-bl?",openCls:Ext.baseCSSPrefix+"pickerfield-open",editable:!0,initComponent:function(){this.callParent(),this.addEvents("expand","collapse","select")},initEvents:function(){var me=this;me.callParent(),me.keyNav=new Ext.util.KeyNav(me.inputEl,{down:me.onDownArrow,esc:{handler:me.onEsc,scope:me,defaultEventAction:!1},scope:me,forceKeyDown:!0}),me.editable||me.mon(me.inputEl,"click",me.onTriggerClick,me),Ext.isGecko&&me.inputEl.dom.setAttribute("autocomplete","off")},onEsc:function(e){Ext.isIE&&e.preventDefault(),this.isExpanded&&(this.collapse(),e.stopEvent())},onDownArrow:function(e){this.isExpanded||this.onTriggerClick()},expand:function(){var bodyEl,picker,collapseIf,me=this;!me.rendered||me.isExpanded||me.isDestroyed||(me.expanding=!0,bodyEl=me.bodyEl,picker=me.getPicker(),collapseIf=me.collapseIf,picker.show(),me.isExpanded=!0,me.alignPicker(),bodyEl.addCls(me.openCls),me.mon(Ext.getDoc(),{mousewheel:collapseIf,mousedown:collapseIf,scope:me}),Ext.EventManager.onWindowResize(me.alignPicker,me),me.fireEvent("expand",me),me.onExpand(),delete me.expanding)},onExpand:Ext.emptyFn,alignPicker:function(){var me=this,picker=me.getPicker();me.isExpanded&&(me.matchFieldWidth&&picker.setWidth(me.bodyEl.getWidth()),picker.isFloating()&&me.doAlign())},doAlign:function(){var isAbove,me=this,picker=me.picker,aboveSfx="-above";me.picker.alignTo(me.triggerWrap,me.pickerAlign,me.pickerOffset),isAbove=picker.el.getY()<me.inputEl.getY(),me.bodyEl[isAbove?"addCls":"removeCls"](me.openCls+aboveSfx),picker[isAbove?"addCls":"removeCls"](picker.baseCls+aboveSfx)},collapse:function(){if(this.isExpanded&&!this.isDestroyed){var me=this,openCls=me.openCls,picker=me.picker,doc=Ext.getDoc(),collapseIf=me.collapseIf,aboveSfx="-above";picker.hide(),me.isExpanded=!1,me.bodyEl.removeCls([openCls,openCls+aboveSfx]),picker.el.removeCls(picker.baseCls+aboveSfx),doc.un("mousewheel",collapseIf,me),doc.un("mousedown",collapseIf,me),Ext.EventManager.removeResizeListener(me.alignPicker,me),me.fireEvent("collapse",me),me.onCollapse()}},onCollapse:Ext.emptyFn,collapseIf:function(e){var me=this;me.isDestroyed||e.within(me.bodyEl,!1,!0)||e.within(me.picker.el,!1,!0)||me.isEventWithinPickerLoadMask(e)||me.collapse()},getPicker:function(){var me=this;return me.picker||(me.picker=me.createPicker())},createPicker:Ext.emptyFn,onTriggerClick:function(){var me=this;me.readOnly||me.disabled||(me.isExpanded?me.collapse():me.expand(),me.inputEl.focus())},triggerBlur:function(){var picker=this.picker;this.callParent(arguments),picker&&picker.isVisible()&&picker.hide()},mimicBlur:function(e){var me=this,picker=me.picker;picker&&(e.within(picker.el,!1,!0)||me.isEventWithinPickerLoadMask(e))||me.callParent(arguments)},onDestroy:function(){var me=this,picker=me.picker;Ext.EventManager.removeResizeListener(me.alignPicker,me),Ext.destroy(me.keyNav),picker&&(delete picker.pickerField,picker.destroy()),me.callParent()},isEventWithinPickerLoadMask:function(e){var loadMask=this.picker.loadMask;return!!loadMask&&(e.within(loadMask.maskEl,!1,!0)||e.within(loadMask.el,!1,!0))}}),Ext.define("Ext.selection.Model",{extend:Ext.util.Observable,alternateClassName:"Ext.AbstractSelectionModel",mixins:{bindable:Ext.util.Bindable},allowDeselect:void 0,toggleOnClick:!0,selected:null,pruneRemoved:!0,suspendChange:0,constructor:function(cfg){var me=this;cfg=cfg||{},Ext.apply(me,cfg),me.addEvents("selectionchange","focuschange"),me.modes={SINGLE:!0,SIMPLE:!0,MULTI:!0},me.setSelectionMode(cfg.mode||me.mode),me.selected=new Ext.util.MixedCollection(null,me.getSelectionId),me.callParent(arguments)},bindStore:function(store,initial){var me=this;me.mixins.bindable.bindStore.apply(me,arguments),me.store&&!initial&&me.refresh()},getStoreListeners:function(){var me=this;return{add:me.onStoreAdd,clear:me.onStoreClear,bulkremove:me.onStoreRemove,update:me.onStoreUpdate,load:me.onStoreLoad,idchanged:me.onModelIdChanged,refresh:me.onStoreRefresh}},suspendChanges:function(){++this.suspendChange},resumeChanges:function(){this.suspendChange&&--this.suspendChange},selectAll:function(suppressEvent){var me=this,selections=me.store.getRange(),i=0,len=selections.length,start=me.getSelection().length;for(me.suspendChanges();i<len;i++)me.doSelect(selections[i],!0,suppressEvent);me.resumeChanges(),suppressEvent||me.maybeFireSelectionChange(me.getSelection().length!==start)},deselectAll:function(suppressEvent){var i,l,rec,me=this,selections=me.getSelection(),selIndexes={},store=me.store,start=selections.length;for(i=0,l=selections.length;i<l;i++)rec=selections[i],selIndexes[rec.internalId]=store.indexOf(rec);selections=Ext.Array.sort(selections,function(r1,r2){var idx1=selIndexes[r1.internalId],idx2=selIndexes[r2.internalId];return idx1<idx2?-1:1}),me.suspendChanges(),me.doDeselect(selections,suppressEvent),me.resumeChanges(),suppressEvent||me.maybeFireSelectionChange(me.getSelection().length!==start)},selectWithEvent:function(record,e){var toDeselect,i,item,me=this,isSelected=me.isSelected(record),shift=e.shiftKey,ctrl=e.ctrlKey,start=me.selectionStart,selected=me.getSelection(),len=selected.length,allowDeselect=me.allowDeselect;switch(me.selectionMode){case"MULTI":if(shift&&start)me.selectRange(start,record,ctrl);else if(ctrl&&isSelected)me.doDeselect(record,!1);else if(ctrl)me.doSelect(record,!0,!1);else if(isSelected&&!shift&&!ctrl&&len>1){for(toDeselect=[],i=0;i<len;++i)item=selected[i],item!==record&&toDeselect.push(item);me.doDeselect(toDeselect)}else isSelected||me.doSelect(record,!1);break;case"SIMPLE":isSelected?me.doDeselect(record):me.doSelect(record,!0);break;case"SINGLE":allowDeselect&&!ctrl&&(allowDeselect=me.toggleOnClick),allowDeselect&&isSelected?me.doDeselect(record):me.doSelect(record,!1)}shift||(me.isSelected(record)?me.selectionStart=record:me.selectionStart=null)},afterKeyNavigate:function(e,record){var recIdx,fromIdx,me=this,isSelected=me.isSelected(record),from=me.selectionStart&&me.isSelected(me.lastFocused)?me.selectionStart:me.selectionStart=me.lastFocused,key=e.getCharCode(),isSpace=key===e.SPACE,direction=key===e.UP||key===e.PAGE_UP?"up":key===e.DOWN||key===e.DOWN?"down":null;switch(me.selectionMode){case"MULTI":isSpace?e.shiftKey?me.selectRange(from,record,e.ctrlKey):isSelected?(me.doDeselect(record,e.ctrlKey),me.setLastFocused(null),me.setLastFocused(record)):me.doSelect(record,e.ctrlKey):e.shiftKey&&from?(fromIdx=me.store.indexOf(from),recIdx=me.store.indexOf(record),"up"===direction&&fromIdx<=recIdx?me.deselectRange(me.lastFocused,recIdx+1):"down"===direction&&fromIdx>=recIdx?me.deselectRange(me.lastFocused,recIdx-1):from!==record&&me.selectRange(from,record,e.ctrlKey),me.lastSelected=record,me.setLastFocused(record)):e.ctrlKey&&isSelected?me.setLastFocused(record):e.ctrlKey?me.setLastFocused(record):me.doSelect(record,!1);break;case"SIMPLE":isSelected?me.doDeselect(record):me.doSelect(record,!0);break;case"SINGLE":isSpace?isSelected?(me.doDeselect(record),me.setLastFocused(record)):me.doSelect(record):e.ctrlKey?me.setLastFocused(record):me.allowDeselect&&isSelected?me.doDeselect(record):me.doSelect(record,!1)}e.shiftKey||me.isSelected(record)&&(me.selectionStart=record)},selectRange:function(startRow,endRow,keepExisting){var result,i,len,toSelect,toDeselect,idx,rec,me=this,store=me.store,selected=me.selected.items;if(!me.isLocked()){for(result=me.normalizeRowRange(startRow,endRow),startRow=result[0],endRow=result[1],toSelect=[],i=startRow;i<=endRow;i++)me.isSelected(store.getAt(i))||toSelect.push(store.getAt(i));if(!keepExisting){for(toDeselect=[],me.suspendChanges(),i=0,len=selected.length;i<len;++i)rec=selected[i],idx=store.indexOf(rec),(idx<startRow||idx>endRow)&&toDeselect.push(rec);for(i=0,len=toDeselect.length;i<len;++i)me.doDeselect(toDeselect[i]);me.resumeChanges()}me.doMultiSelect(toSelect,!0)}},deselectRange:function(startRow,endRow){var result,i,toDeselect,record,me=this,store=me.store;if(!me.isLocked()){for(result=me.normalizeRowRange(startRow,endRow),startRow=result[0],endRow=result[1],toDeselect=[],i=startRow;i<=endRow;i++)record=store.getAt(i),me.isSelected(record)&&toDeselect.push(record);me.doDeselect(toDeselect)}},normalizeRowRange:function(startRow,endRow){var tmp,store=this.store;return Ext.isNumber(startRow)||(startRow=store.indexOf(startRow)),startRow=Math.max(0,startRow),Ext.isNumber(endRow)||(endRow=store.indexOf(endRow)),endRow=Math.min(endRow,store.getCount()-1),startRow>endRow&&(tmp=endRow,endRow=startRow,startRow=tmp),[startRow,endRow]},onModelIdChanged:function(store,model,oldId,newId,oldInternalId){this.selected.updateKey(oldInternalId,newId)},select:function(records,keepExisting,suppressEvent){Ext.isDefined(records)&&this.doSelect(records,keepExisting,suppressEvent)},deselect:function(records,suppressEvent){this.doDeselect(records,suppressEvent)},doSelect:function(records,keepExisting,suppressEvent){var record,me=this;if(!me.locked&&me.store){if("number"==typeof records){if(record=me.store.getAt(records),!record)return;records=[record]}"SINGLE"==me.selectionMode&&records?(record=records.length?records[0]:records,me.doSingleSelect(record,suppressEvent)):me.doMultiSelect(records,keepExisting,suppressEvent)}},doMultiSelect:function(records,keepExisting,suppressEvent){var result,i,len,record,commit,me=this,selected=me.selected,change=!1;if(!me.locked){if(records=Ext.isArray(records)?records:[records],len=records.length,!keepExisting&&selected.getCount()>0&&(result=me.deselectDuringSelect(records,selected.getRange(),suppressEvent),result[0]))return void me.maybeFireSelectionChange(result[1]>0&&!suppressEvent);for(commit=function(){selected.add(record),change=!0},i=0;i<len;i++)record=records[i],me.isSelected(record)||(me.lastSelected=record,me.onSelectChange(record,!0,suppressEvent,commit));me.preventFocus||me.setLastFocused(record,suppressEvent),me.maybeFireSelectionChange(change&&!suppressEvent)}},deselectDuringSelect:function(toSelect,selected,suppressEvent){var item,i,me=this,len=selected.length,changed=0,failed=!1;for(me.suspendChanges(),i=0;i<len;++i)item=selected[i],Ext.Array.contains(toSelect,item)||(me.doDeselect(item,suppressEvent)?++changed:failed=!0);return me.resumeChanges(),[failed,changed]},doDeselect:function(records,suppressEvent){var len,record,commit,me=this,selected=me.selected,i=0,attempted=0,accepted=0;if(me.locked||!me.store)return!1;if("number"==typeof records){if(record=me.store.getAt(records),!record)return!1;records=[record]}else Ext.isArray(records)||(records=[records]);for(commit=function(){++accepted,selected.remove(record)},len=records.length,me.suspendChanges();i<len;i++)record=records[i],me.isSelected(record)&&(me.lastSelected===record&&(me.lastSelected=selected.last(),me.lastFocused===record&&me.setLastFocused(null)),++attempted,me.onSelectChange(record,!1,suppressEvent,commit));return me.resumeChanges(),me.maybeFireSelectionChange(accepted>0&&!suppressEvent),accepted===attempted},doSingleSelect:function(record,suppressEvent){var commit,me=this,changed=!1,selected=me.selected;if(!me.locked&&!me.isSelected(record)){if(selected.getCount()){if(me.suspendChanges(),!me.doDeselect(me.lastSelected,suppressEvent))return void me.resumeChanges();me.resumeChanges()}commit=function(){selected.add(record),me.lastSelected=record,changed=!0},me.onSelectChange(record,!0,suppressEvent,commit),changed&&(suppressEvent||me.preventFocus||me.setLastFocused(record),me.maybeFireSelectionChange(!suppressEvent))}},setLastFocused:function(record,supressFocus){var me=this,recordBeforeLast=me.lastFocused;record!==recordBeforeLast&&(me.lastFocused=record,me.onLastFocusChanged(recordBeforeLast,record,supressFocus))},isFocused:function(record){return record===this.getLastFocused()},maybeFireSelectionChange:function(fireEvent){var me=this;fireEvent&&!me.suspendChange&&me.fireEvent("selectionchange",me,me.getSelection())},getLastSelected:function(){return this.lastSelected},getLastFocused:function(){return this.lastFocused},getSelection:function(){return this.selected.getRange()},getSelectionMode:function(){return this.selectionMode},setSelectionMode:function(selMode){selMode=selMode?selMode.toUpperCase():"SINGLE",this.selectionMode=this.modes[selMode]?selMode:"SINGLE"},isLocked:function(){return this.locked},setLocked:function(locked){this.locked=!!locked},isRangeSelected:function(startRow,endRow){var i,result,me=this,store=me.store;for(result=me.normalizeRowRange(startRow,endRow),startRow=result[0],endRow=result[1],i=startRow;i<=endRow;i++)if(!me.isSelected(store.getAt(i)))return!1;return!0},isSelected:function(record){return record=Ext.isNumber(record)?this.store.getAt(record):record,this.selected.contains(record)},hasSelection:function(){return this.selected.getCount()>0},getSelectionId:function(record){return record.internalId},pruneIf:function(){var i,item,me=this,selected=me.selected,toRemove=[],len=selected.length;if(me.pruneRemoved){for(i=0;i<len;i++)item=selected.getAt(i),this.storeHasSelected(item)||toRemove.push(item);if(toRemove.length){for(i=0,len=toRemove.length;i<len;i++)selected.remove(toRemove[i]);me.maybeFireSelectionChange(!0)}}},storeHasSelected:function(record){var records,len,id,i,store=this.store;if(record.hasId()&&store.getById(record.getId()))return!0;for(records=store.data.items,len=records.length,id=record.internalId,i=0;i<len;++i)if(id===records[i].internalId)return!0;return!1},refresh:function(){var rec,selection,change,me=this,store=me.store,toBeSelected=[],toBeReAdded=[],oldSelections=me.getSelection(),len=oldSelections.length,i=0,lastFocused=me.getLastFocused();if(store){for(;i<len&&(selection=oldSelections[i],store.indexOf(selection)!==-1?toBeSelected.push(selection):me.pruneRemoved||(rec=store.getById(selection.getId()),rec?toBeSelected.push(rec):toBeReAdded.push(selection)),"SINGLE"!==me.mode||!toBeReAdded.length);i++);me.selected.getCount()!=toBeSelected.length+toBeReAdded.length&&(change=!0),me.clearSelections(),store.indexOf(lastFocused)!==-1&&me.setLastFocused(lastFocused,!0),toBeSelected.length&&me.doSelect(toBeSelected,!1,!0),toBeReAdded.length&&(me.selected.addAll(toBeReAdded),me.lastSelected||(me.lastSelected=toBeReAdded[toBeReAdded.length-1])),me.maybeFireSelectionChange(change)}},clearSelections:function(){this.selected.clear(),this.lastSelected=null,this.setLastFocused(null)},onStoreAdd:Ext.emptyFn,onStoreClear:function(){this.selected.getCount()>0&&(this.clearSelections(),this.maybeFireSelectionChange(!0))},onStoreRemove:function(store,records,indexes,isMove){var me=this;me.selectionStart&&Ext.Array.contains(records,me.selectionStart)&&(me.selectionStart=null),isMove||me.locked||!me.pruneRemoved||me.deselectDeletedRecords(records)},deselectDeletedRecords:function(records){var i,record,me=this,selected=me.selected,length=records.length,removed=0;for(i=0;i<length;i++)record=records[i],selected.remove(record)&&(me.lastSelected==record&&(me.lastSelected=null),me.getLastFocused()==record&&me.setLastFocused(null),++removed);removed&&me.maybeFireSelectionChange(!0)},getCount:function(){return this.selected.getCount()},onUpdate:Ext.emptyFn,destroy:function(){this.clearListeners()},onStoreUpdate:Ext.emptyFn,onStoreRefresh:Ext.emptyFn,onStoreLoad:Ext.emptyFn,onSelectChange:function(record,isSelected,suppressEvent,commitFn){
var me=this,eventName=isSelected?"select":"deselect";(suppressEvent||me.fireEvent("before"+eventName,me,record))!==!1&&commitFn()!==!1&&(suppressEvent||me.fireEvent(eventName,me,record))},onLastFocusChanged:function(oldFocused,newFocused){this.fireEvent("focuschange",this,oldFocused,newFocused)},onEditorKey:Ext.emptyFn,beforeViewRender:function(view){this.views=this.views||[],this.views.push(view),this.bindStore(view.getStore(),!0)},bindComponent:Ext.emptyFn}),Ext.define("Ext.selection.DataViewModel",{extend:Ext.selection.Model,deselectOnContainerClick:!0,enableKeyNav:!0,constructor:function(cfg){this.addEvents("beforedeselect","beforeselect","deselect","select"),this.callParent(arguments)},bindComponent:function(view){var me=this,eventListeners={refresh:me.refresh,scope:me};me.view=view,me.bindStore(view.getStore()),eventListeners[view.triggerEvent]=me.onItemClick,eventListeners[view.triggerCtEvent]=me.onContainerClick,view.on(eventListeners),me.enableKeyNav&&me.initKeyNav(view)},onUpdate:function(record){var view=this.view;view&&this.isSelected(record)&&view.onItemSelect(record)},onItemClick:function(view,record,item,index,e){this.selectWithEvent(record,e)},onContainerClick:function(){this.deselectOnContainerClick&&this.deselectAll()},initKeyNav:function(view){var me=this;return view.rendered?(view.el.set({tabIndex:-1}),void(me.keyNav=new Ext.util.KeyNav({target:view.el,ignoreInputFields:!0,down:Ext.pass(me.onNavKey,[1],me),right:Ext.pass(me.onNavKey,[1],me),left:Ext.pass(me.onNavKey,[-1],me),up:Ext.pass(me.onNavKey,[-1],me),scope:me}))):void view.on({render:Ext.Function.bind(me.initKeyNav,me,[view]),single:!0})},onNavKey:function(step){step=step||1;var idx,me=this,view=me.view,selected=me.getSelection()[0],numRecords=me.view.store.getCount();idx=selected?view.indexOf(view.getNode(selected))+step:0,idx<0?idx=numRecords-1:idx>=numRecords&&(idx=0),me.select(idx)},onSelectChange:function(record,isSelected,suppressEvent,commitFn){var me=this,view=me.view,eventName=isSelected?"select":"deselect";(suppressEvent||me.fireEvent("before"+eventName,me,record))!==!1&&commitFn()!==!1&&(view&&(isSelected?view.onItemSelect(record):view.onItemDeselect(record)),suppressEvent||me.fireEvent(eventName,me,record))},onLastFocusChanged:function(oldFocus,newFocus,suppressFocus){var view=this.view;view&&!suppressFocus&&newFocus&&(view.focusNode(newFocus),this.fireEvent("focuschange",this,oldFocus,newFocus))},destroy:function(){Ext.destroy(this.keyNav),this.callParent()}}),Ext.define("Ext.view.AbstractView",{extend:Ext.Component,mixins:{bindable:Ext.util.Bindable},inheritableStatics:{getRecord:function(node){return this.getBoundView(node).getRecord(node)},getBoundView:function(node){return Ext.getCmp(node.boundView)}},deferInitialRefresh:!0,itemCls:Ext.baseCSSPrefix+"dataview-item",loadingText:"Loading...",loadMask:!0,loadingUseMsg:!0,selectedItemCls:Ext.baseCSSPrefix+"item-selected",emptyText:"",deferEmptyText:!0,trackOver:!1,blockRefresh:!1,preserveScrollOnRefresh:!1,ariaRole:"listbox",itemAriaRole:"option",last:!1,triggerEvent:"itemclick",triggerCtEvent:"containerclick",addCmpEvents:function(){},initComponent:function(){var me=this,itemTpl=(Ext.isDefined,me.itemTpl),memberFn={};itemTpl&&(Ext.isArray(itemTpl)?itemTpl=itemTpl.join(""):Ext.isObject(itemTpl)&&(memberFn=Ext.apply(memberFn,itemTpl.initialConfig),itemTpl=itemTpl.html),me.itemSelector||(me.itemSelector="."+me.itemCls),itemTpl=Ext.String.format('<tpl for="."><div class="{0}" role="{2}">{1}</div></tpl>',me.itemCls,itemTpl,me.itemAriaRole),me.tpl=new Ext.XTemplate(itemTpl,memberFn)),me.callParent(),me.tpl=me.getTpl("tpl"),me.overItemCls&&(me.trackOver=!0),me.addEvents("beforerefresh","refresh","viewready","itemupdate","itemadd","itemremove"),me.addCmpEvents(),me.store=Ext.data.StoreManager.lookup(me.store||"ext-empty-store"),me.dataSource||(me.dataSource=me.store),me.bindStore(me.dataSource,!0,"dataSource"),me.all||(me.all=new Ext.CompositeElementLite),me.scrollState={top:0,left:0},me.on({scroll:me.onViewScroll,element:"el",scope:me})},onRender:function(){var me=this,mask=me.loadMask,maskStore=me.getMaskStore(),cfg={target:me,msg:me.loadingText,msgCls:me.loadingCls,useMsg:me.loadingUseMsg,store:maskStore};me.callParent(arguments),mask&&!maskStore.proxy.isSynchronous&&(Ext.isObject(mask)&&(cfg=Ext.apply(cfg,mask)),me.loadMask=new Ext.LoadMask(cfg),me.loadMask.on({scope:me,beforeshow:me.onMaskBeforeShow,hide:me.onMaskHide}))},finishRender:function(){var me=this;me.callParent(arguments),me.up("[collapsed],[hidden]")||me.doFirstRefresh(me.dataSource)},onBoxReady:function(){var me=this;me.callParent(arguments),me.firstRefreshDone||me.doFirstRefresh(me.dataSource)},getMaskStore:function(){return this.store},onMaskBeforeShow:function(){var me=this,loadingHeight=me.loadingHeight;loadingHeight&&loadingHeight>me.getHeight()&&(me.hasLoadingHeight=!0,me.oldMinHeight=me.minHeight,me.minHeight=loadingHeight,me.updateLayout())},onMaskHide:function(){var me=this;!me.destroying&&me.hasLoadingHeight&&(me.minHeight=me.oldMinHeight,me.updateLayout(),delete me.hasLoadingHeight)},beforeRender:function(){this.callParent(arguments),this.getSelectionModel().beforeViewRender(this)},afterRender:function(){this.callParent(arguments),this.getSelectionModel().bindComponent(this)},getSelectionModel:function(){var me=this,mode="SINGLE";return me.simpleSelect?mode="SIMPLE":me.multiSelect&&(mode="MULTI"),me.selModel&&me.selModel.events||(me.selModel=new Ext.selection.DataViewModel(Ext.apply({allowDeselect:me.allowDeselect,mode:mode},me.selModel))),me.selModel.hasRelaySetup||(me.relayEvents(me.selModel,["selectionchange","beforeselect","beforedeselect","select","deselect","focuschange"]),me.selModel.hasRelaySetup=!0),me.disableSelection&&(me.selModel.locked=!0),me.selModel},refresh:function(){var targetEl,targetParent,oldDisplay,nextSibling,dom,records,me=this;me.rendered&&!me.isDestroyed&&(me.hasListeners.beforerefresh&&me.fireEvent("beforerefresh",me)===!1||(targetEl=me.getTargetEl(),records=me.getViewRange(),dom=targetEl.dom,me.preserveScrollOnRefresh||(targetParent=dom.parentNode,oldDisplay=dom.style.display,dom.style.display="none",nextSibling=dom.nextSibling,targetParent.removeChild(dom)),me.refreshCounter?me.clearViewEl():(me.fixedNodes=targetEl.dom.childNodes.length,me.refreshCounter=1),me.tpl.append(targetEl,me.collectData(records,me.all.startIndex)),records.length<1?(this.store.loading||me.deferEmptyText&&!me.hasFirstRefresh||Ext.core.DomHelper.insertHtml("beforeEnd",targetEl.dom,me.emptyText),me.all.clear()):(me.collectNodes(targetEl.dom),me.updateIndexes(0)),me.hasFirstRefresh&&(me.refreshSelmodelOnRefresh!==!1?me.selModel.refresh():me.selModel.pruneIf()),me.hasFirstRefresh=!0,me.preserveScrollOnRefresh||(targetParent.insertBefore(dom,nextSibling),dom.style.display=oldDisplay),this.refreshSize(),me.fireEvent("refresh",me),me.viewReady||(me.viewReady=!0,me.fireEvent("viewready",me))))},collectNodes:function(targetEl){this.all.fill(Ext.query(this.getItemSelector(),Ext.getDom(targetEl)),this.all.startIndex)},getViewRange:function(){return this.dataSource.getRange()},refreshSize:function(){var sizeModel=this.getSizeModel();(sizeModel.height.shrinkWrap||sizeModel.width.shrinkWrap)&&this.updateLayout()},clearViewEl:function(){var me=this,el=me.getTargetEl();if(me.fixedNodes)for(;el.dom.childNodes[me.fixedNodes];)el.dom.removeChild(el.dom.childNodes[me.fixedNodes]);else el.update("");me.refreshCounter++},onViewScroll:Ext.emptyFn,onIdChanged:Ext.emptyFn,saveScrollState:function(){if(this.rendered){var dom=this.el.dom,state=this.scrollState;state.left=dom.scrollLeft,state.top=dom.scrollTop}},restoreScrollState:function(){if(this.rendered){var dom=this.el.dom,state=this.scrollState;dom.scrollLeft=state.left,dom.scrollTop=state.top}},prepareData:function(data,index,record){var associatedData,attr,hasCopied;if(record){associatedData=record.getAssociatedData();for(attr in associatedData)associatedData.hasOwnProperty(attr)&&(hasCopied||(data=Ext.Object.chain(data),hasCopied=!0),data[attr]=associatedData[attr])}return data},collectData:function(records,startIndex){for(var record,data=[],i=0,len=records.length;i<len;i++)record=records[i],data[i]=this.prepareData(record.data,startIndex+i,record);return data},bufferRender:function(records,index){var me=this,div=me.renderBuffer||(me.renderBuffer=document.createElement("div"));return me.tpl.overwrite(div,me.collectData(records,index)),Ext.DomQuery.select(me.getItemSelector(),div)},getNodeContainer:function(){return this.getTargetEl()},onUpdate:function(ds,record){var index,node,me=this;if(me.viewReady&&(index=me.dataSource.indexOf(record),index>-1&&(node=me.bufferRender([record],index)[0],me.getNode(record))))return me.all.replaceElement(index,node,!0),me.updateIndexes(index,index),me.selModel.onUpdate(record),me.hasListeners.itemupdate&&me.fireEvent("itemupdate",record,index,node),node},onAdd:function(store,records,index){var nodes,me=this;me.rendered&&(0===me.all.getCount()?(me.refresh(),nodes=me.all.slice()):(nodes=me.doAdd(records,index),me.refreshSelmodelOnRefresh!==!1&&me.selModel.refresh(),me.updateIndexes(index),me.refreshSize()),me.hasListeners.itemadd&&me.fireEvent("itemadd",records,index,nodes))},doAdd:function(records,index){var i,l,nodeContainer,fragment,me=this,nodes=me.bufferRender(records,index,!0),all=me.all,count=all.getCount();if(0===count){for(nodeContainer=this.getNodeContainer(),fragment=document.createDocumentFragment(),i=0,l=nodes.length;i<l;i++)fragment.appendChild(nodes[i]);nodeContainer.appendChild(fragment)}else index<count?0===index?all.item(index).insertSibling(nodes,"before",!0):all.item(index-1).insertSibling(nodes,"after",!0):all.last().insertSibling(nodes,"after",!0);return all.insert(index,nodes),nodes},onRemove:function(ds,records,indexes){var i,record,index,me=this,fireItemRemove=me.hasListeners.itemremove;if(me.all.getCount()){if(0===me.dataSource.getCount()){if(fireItemRemove)for(i=indexes.length-1;i>=0;--i)me.fireEvent("itemremove",records[i],indexes[i]);me.refresh()}else{for(i=indexes.length-1;i>=0;--i)record=records[i],index=indexes[i],me.doRemove(record,index),fireItemRemove&&me.fireEvent("itemremove",record,index);me.updateIndexes(indexes[0])}this.refreshSize()}},doRemove:function(record,index){this.all.removeElement(index,!0)},refreshNode:function(index){this.onUpdate(this.dataSource,this.dataSource.getAt(index))},updateIndexes:function(startIndex,endIndex){var i,nodes=this.all.elements,records=this.getViewRange();for(startIndex=startIndex||0,endIndex=endIndex||(0===endIndex?0:nodes.length-1),i=startIndex;i<=endIndex;i++)nodes[i].viewIndex=i,nodes[i].viewRecordId=records[i].internalId,nodes[i].boundView||(nodes[i].boundView=this.id)},getStore:function(){return this.store},bindStore:function(store,initial,propName){var me=this;me.mixins.bindable.bindStore.apply(me,arguments),initial||me.getSelectionModel().bindStore(store),me.componentLayoutCounter&&me.doFirstRefresh(store)},doFirstRefresh:function(store){var me=this;me.firstRefreshDone=!0,store&&!store.loading&&(me.deferInitialRefresh?me.applyFirstRefresh():me.refresh())},applyFirstRefresh:function(){var me=this;me.isDestroyed||(me.up("[isCollapsingOrExpanding]")?Ext.Function.defer(me.applyFirstRefresh,100,me):Ext.Function.defer(function(){me.isDestroyed||me.refresh()},1))},onUnbindStore:function(store){this.setMaskBind(null)},onBindStore:function(store,initial,propName){this.setMaskBind(store),initial||"store"!==propName||this.bindStore(store,!1,"dataSource")},setMaskBind:function(store){var mask=this.loadMask;mask&&mask.bindStore&&mask.bindStore(store)},getStoreListeners:function(){var me=this;return{idchanged:me.onIdChanged,refresh:me.onDataRefresh,add:me.onAdd,bulkremove:me.onRemove,update:me.onUpdate,clear:me.refresh}},onDataRefresh:function(){this.refreshView()},refreshView:function(){var me=this,blockedByAncestor=!me.firstRefreshDone&&(!me.rendered||me.up("[collapsed],[isCollapsingOrExpanding],[hidden]"));blockedByAncestor?me.deferInitialRefresh=!1:me.blockRefresh!==!0&&(me.firstRefreshDone=!0,me.refresh())},findItemByChild:function(node){return Ext.fly(node).findParent(this.getItemSelector(),this.getTargetEl())},findTargetByEvent:function(e){return e.getTarget(this.getItemSelector(),this.getTargetEl())},getSelectedNodes:function(){for(var nodes=[],records=this.selModel.getSelection(),ln=records.length,i=0;i<ln;i++)nodes.push(this.getNode(records[i]));return nodes},getRecords:function(nodes){for(var records=[],i=0,len=nodes.length,data=this.dataSource.data;i<len;i++)records[records.length]=data.getByKey(nodes[i].viewRecordId);return records},getRecord:function(node){return this.dataSource.data.getByKey(Ext.getDom(node).viewRecordId)},isSelected:function(node){var r=this.getRecord(node);return this.selModel.isSelected(r)},select:function(records,keepExisting,suppressEvent){this.selModel.select(records,keepExisting,suppressEvent)},deselect:function(records,suppressEvent){this.selModel.deselect(records,suppressEvent)},getNode:function(nodeInfo){return!nodeInfo&&0!==nodeInfo||!this.rendered?null:Ext.isString(nodeInfo)?document.getElementById(nodeInfo):Ext.isNumber(nodeInfo)?this.all.elements[nodeInfo]:nodeInfo.isModel?this.getNodeByRecord(nodeInfo):nodeInfo},getNodeByRecord:function(record){for(var ns=this.all.elements,ln=ns.length,i=0;i<ln;i++)if(ns[i].viewRecordId===record.internalId)return ns[i];return null},getNodes:function(start,end){var all=this.all;return void 0===end?end=all.getCount():end++,all.slice(start||0,end)},indexOf:function(node){return node=this.getNode(node),node||0===node?Ext.isNumber(node.viewIndex)?node.viewIndex:this.all.indexOf(node):-1},onDestroy:function(){var me=this;me.all.clear(),me.callParent(),me.bindStore(null),me.selModel.destroy()},onItemSelect:function(record){var node=this.getNode(record);node&&Ext.fly(node).addCls(this.selectedItemCls)},onItemDeselect:function(record){var node=this.getNode(record);node&&Ext.fly(node).removeCls(this.selectedItemCls)},getItemSelector:function(){return this.itemSelector}},function(){Ext.deprecate("extjs","4.0",function(){Ext.view.AbstractView.override({getSelectionCount:function(){return Ext.global.console&&Ext.global.console.warn("DataView: getSelectionCount will be removed, please interact with the Ext.selection.DataViewModel"),this.selModel.getSelection().length},getSelectedRecords:function(){return Ext.global.console&&Ext.global.console.warn("DataView: getSelectedRecords will be removed, please interact with the Ext.selection.DataViewModel"),this.selModel.getSelection()},select:function(records,keepExisting,supressEvents){Ext.global.console&&Ext.global.console.warn("DataView: select will be removed, please access select through a DataView's SelectionModel, ie: view.getSelectionModel().select()");var sm=this.getSelectionModel();return sm.select.apply(sm,arguments)},clearSelections:function(){Ext.global.console&&Ext.global.console.warn("DataView: clearSelections will be removed, please access deselectAll through DataView's SelectionModel, ie: view.getSelectionModel().deselectAll()");var sm=this.getSelectionModel();return sm.deselectAll()}})})}),Ext.define("Ext.view.View",{extend:Ext.view.AbstractView,alternateClassName:"Ext.DataView",alias:"widget.dataview",deferHighlight:Ext.isIE7m?100:0,mouseOverOutBuffer:20,inputTagRe:/^textarea$|^input$/i,inheritableStatics:{EventMap:{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut",mouseenter:"MouseEnter",mouseleave:"MouseLeave",keydown:"KeyDown",focus:"Focus"}},initComponent:function(){var me=this;me.callParent(),me.mouseOverOutBuffer?(me.handleMouseOver=Ext.Function.createBuffered(me.handleMouseOver,me.mouseOverOutBuffer,me),me.handleMouseOut=Ext.Function.createBuffered(me.handleMouseOut,me.mouseOverOutBuffer,me),me.lastMouseOverEvent=new Ext.EventObjectImpl,me.lastMouseOutEvent=new Ext.EventObjectImpl):me.deferHighlight&&(me.setHighlightedItem=Ext.Function.createBuffered(me.setHighlightedItem,me.deferHighlight,me))},addCmpEvents:function(){this.addEvents("beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","beforeitemkeydown","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","itemkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","beforecontainerkeydown","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","containerkeydown","selectionchange","beforeselect","beforedeselect","select","deselect","focuschange","highlightitem","unhighlightitem")},getFocusEl:function(){return this.getTargetEl()},afterRender:function(){var me=this,buffer=me.mouseOverOutBuffer;me.callParent(),me.mon(me.getTargetEl(),{scope:me,freezeEvent:!0,click:me.handleEvent,mousedown:me.handleEvent,mouseup:me.handleEvent,dblclick:me.handleEvent,contextmenu:me.handleEvent,keydown:me.handleEvent,mouseover:buffer?me.onMouseOver:me.handleMouseOver,mouseout:buffer?me.onMouseOut:me.handleMouseOut})},onMouseOver:function(e){var me=this;me.lastMouseOverEvent.setEvent(e.browserEvent,!0),me.handleMouseOver(me.lastMouseOverEvent)},onMouseOut:function(e){var me=this;me._mouseOutPending||(me._mouseOutPending=!0,me.lastMouseOutEvent.setEvent(e.browserEvent,!0),me.handleMouseOut(me.lastMouseOutEvent))},handleMouseOver:function(e){var me=this,itemSelector=me.dataRowSelector||me.itemSelector,item=e.getTarget(itemSelector);me.isDestroyed||(item?me.mouseOverItem!==item&&me.el.contains(item)&&(me.mouseOverItem=e.item=item,e.newType="mouseenter",me.handleEvent(e)):(e.item=e.newType=null,me.handleEvent(e)))},handleMouseOut:function(e){var sourceView,me=this,itemSelector=me.dataRowSelector||me.itemSelector,item=e.getTarget(itemSelector);me.isDestroyed||(me._mouseOutPending=!1,item?e.getRelatedTarget(itemSelector)!==item&&me.mouseOverItem===item&&(sourceView=me.self.getBoundView(item),e.item=item,e.newType="mouseleave",sourceView.handleEvent(e),sourceView.mouseOverItem=null):(e.item=e.newType=null,me.handleEvent(e))),e.newType=e.item=null},handleEvent:function(e){var me=this,key="keydown"==e.type&&e.getKey();me.processUIEvent(e)!==!1&&me.processSpecialEvent(e),key===e.SPACE&&(me.inputTagRe.test(e.getTarget().tagName)||e.stopEvent())},processItemEvent:Ext.emptyFn,processContainerEvent:Ext.emptyFn,processSpecialEvent:Ext.emptyFn,processUIEvent:function(e){if(Ext.getBody().isAncestor(e.target)){var index,record,sm,me=this,item=e.getTarget(me.dataRowSelector||me.itemSelector,me.getTargetEl()),map=me.statics().EventMap,type=e.type,newType=e.type;if(e.newType&&(newType=e.newType,item=e.item),item||"keydown"!=type||(sm=me.getSelectionModel(),record=sm.lastFocused||sm.getLastSelected(),record&&(item=me.getNode(record,!0))),item){if(record||(record=me.getRecord(item)),index=me.indexInStore?me.indexInStore(record):me.indexOf(item),!record||me.processItemEvent(record,item,index,e)===!1)return!1;if(me["onBeforeItem"+map[newType]](record,item,index,e)===!1||me.fireEvent("beforeitem"+newType,me,record,item,index,e)===!1||me["onItem"+map[newType]](record,item,index,e)===!1)return!1;me.fireEvent("item"+newType,me,record,item,index,e)}else{if(me.processContainerEvent(e)===!1||me["onBeforeContainer"+map[type]](e)===!1||me.fireEvent("beforecontainer"+type,me,e)===!1||me["onContainer"+map[type]](e)===!1)return!1;me.fireEvent("container"+type,me,e)}return!0}},onItemMouseEnter:function(record,item,index,e){this.trackOver&&this.highlightItem(item)},onItemMouseLeave:function(record,item,index,e){this.trackOver&&this.clearHighlight()},onItemMouseDown:Ext.emptyFn,onItemMouseUp:Ext.emptyFn,onItemFocus:Ext.emptyFn,onItemClick:Ext.emptyFn,onItemDblClick:Ext.emptyFn,onItemContextMenu:Ext.emptyFn,onItemKeyDown:Ext.emptyFn,onBeforeItemMouseDown:Ext.emptyFn,onBeforeItemMouseUp:Ext.emptyFn,onBeforeItemFocus:Ext.emptyFn,onBeforeItemMouseEnter:Ext.emptyFn,onBeforeItemMouseLeave:Ext.emptyFn,onBeforeItemClick:Ext.emptyFn,onBeforeItemDblClick:Ext.emptyFn,onBeforeItemContextMenu:Ext.emptyFn,onBeforeItemKeyDown:Ext.emptyFn,onContainerMouseDown:Ext.emptyFn,onContainerMouseUp:Ext.emptyFn,onContainerMouseOver:Ext.emptyFn,onContainerMouseOut:Ext.emptyFn,onContainerClick:Ext.emptyFn,onContainerDblClick:Ext.emptyFn,onContainerContextMenu:Ext.emptyFn,onContainerKeyDown:Ext.emptyFn,onBeforeContainerMouseDown:Ext.emptyFn,onBeforeContainerMouseUp:Ext.emptyFn,onBeforeContainerMouseOver:Ext.emptyFn,onBeforeContainerMouseOut:Ext.emptyFn,onBeforeContainerClick:Ext.emptyFn,onBeforeContainerDblClick:Ext.emptyFn,onBeforeContainerContextMenu:Ext.emptyFn,onBeforeContainerKeyDown:Ext.emptyFn,setHighlightedItem:function(item){var previous,me=this,highlighted=me.highlightedItem,overItemCls=me.overItemCls,beforeOverItemCls=me.beforeOverItemCls;highlighted!=item&&(highlighted&&(Ext.fly(highlighted).removeCls(overItemCls),previous=highlighted.previousSibling,beforeOverItemCls&&previous&&Ext.fly(previous).removeCls(beforeOverItemCls),me.fireEvent("unhighlightitem",me,highlighted)),me.highlightedItem=item,item&&(Ext.fly(item).addCls(me.overItemCls),previous=item.previousSibling,beforeOverItemCls&&previous&&Ext.fly(previous).addCls(beforeOverItemCls),me.fireEvent("highlightitem",me,item)))},highlightItem:function(item){this.setHighlightedItem(item)},clearHighlight:function(){this.setHighlightedItem(void 0)},onUpdate:function(store,record){var node,newNode,highlighted,me=this;me.viewReady&&(node=me.getNode(record),newNode=me.callParent(arguments),highlighted=me.highlightedItem,highlighted&&highlighted===node&&(delete me.highlightedItem,newNode&&me.highlightItem(newNode)))},refresh:function(){this.clearHighlight(),this.callParent(arguments)},focusNode:function(rec){var nodeRegion,me=this,node=me.getNode(rec,!0),el=me.el,adjustmentY=0,adjustmentX=0,elRegion=el.getRegion();elRegion.bottom=elRegion.top+el.dom.clientHeight,elRegion.right=elRegion.left+el.dom.clientWidth,node&&(nodeRegion=Ext.fly(node).getRegion(),nodeRegion.top<elRegion.top?adjustmentY=nodeRegion.top-elRegion.top:nodeRegion.bottom>elRegion.bottom&&(adjustmentY=nodeRegion.bottom-elRegion.bottom),nodeRegion.left<elRegion.left?adjustmentX=nodeRegion.left-elRegion.left:nodeRegion.right>elRegion.right&&(adjustmentX=nodeRegion.right-elRegion.right),(adjustmentX||adjustmentY)&&me.scrollBy(adjustmentX,adjustmentY,!1),el.focus())},bindStore:function(store,initial,propertyName){var dataSource=this[propertyName];dataSource&&dataSource.isFeatureStore?store.isFeatureStore?(this.bindStoreListeners(store),dataSource.bindStore(dataSource.store)):dataSource.bindStore(store):this.callParent(arguments)}}),Ext.define("Ext.layout.component.BoundList",{extend:Ext.layout.component.Auto,alias:"layout.boundlist",type:"component",beginLayout:function(ownerContext){var me=this,owner=me.owner,toolbar=owner.pagingToolbar;me.callParent(arguments),owner.floating&&(ownerContext.savedXY=owner.getXY(),owner.setXY([0,-9999])),toolbar&&(ownerContext.toolbarContext=ownerContext.context.getCmp(toolbar)),ownerContext.listContext=ownerContext.getEl("listEl")},beginLayoutCycle:function(ownerContext){var owner=this.owner;this.callParent(arguments),ownerContext.heightModel.auto&&(owner.el.setHeight("auto"),owner.listEl.setHeight("auto"))},getLayoutItems:function(){var toolbar=this.owner.pagingToolbar;return toolbar?[toolbar]:[]},isValidParent:function(){return!0},finishedLayout:function(ownerContext){var xy=ownerContext.savedXY;this.callParent(arguments),xy&&this.owner.setXY(xy)},measureContentWidth:function(ownerContext){return this.owner.listEl.getWidth()},measureContentHeight:function(ownerContext){return this.owner.listEl.getHeight()},publishInnerHeight:function(ownerContext,height){var toolbar=ownerContext.toolbarContext,toolbarHeight=0;toolbar&&(toolbarHeight=toolbar.getProp("height")),void 0===toolbarHeight?this.done=!1:ownerContext.listContext.setHeight(height-ownerContext.getFrameInfo().height-toolbarHeight)},calculateOwnerHeightFromContentHeight:function(ownerContext){var height=this.callParent(arguments),toolbar=ownerContext.toolbarContext;return toolbar&&(height+=toolbar.getProp("height")),height}}),Ext.define("Ext.toolbar.TextItem",{extend:Ext.toolbar.Item,alias:"widget.tbtext",alternateClassName:"Ext.Toolbar.TextItem",text:"",renderTpl:"{text}",baseCls:Ext.baseCSSPrefix+"toolbar-text",ariaRole:null,beforeRender:function(){var me=this;me.callParent(),Ext.apply(me.renderData,{text:me.text})},setText:function(text){var me=this;me.text=text,me.rendered&&(me.el.update(text),me.updateLayout())}}),Ext.define("Ext.form.field.Spinner",{extend:Ext.form.field.Trigger,alias:"widget.spinnerfield",alternateClassName:"Ext.form.Spinner",trigger1Cls:Ext.baseCSSPrefix+"form-spinner-up",trigger2Cls:Ext.baseCSSPrefix+"form-spinner-down",spinUpEnabled:!0,spinDownEnabled:!0,keyNavEnabled:!0,mouseWheelEnabled:!0,repeatTriggerClick:!0,onSpinUp:Ext.emptyFn,onSpinDown:Ext.emptyFn,ariaRole:"spinbutton",triggerTpl:'<td style="{triggerStyle}" class="{triggerCls}" role="presentation"><div class="'+Ext.baseCSSPrefix+"trigger-index-0 "+Ext.baseCSSPrefix+"form-trigger "+Ext.baseCSSPrefix+'form-spinner-up {spinnerUpCls} {childElCls}" role="presentation"></div><div class="'+Ext.baseCSSPrefix+"trigger-index-1 "+Ext.baseCSSPrefix+"form-trigger "+Ext.baseCSSPrefix+'form-spinner-down {spinnerDownCls} {childElCls}" role="presentation"></div></td></tr>',initComponent:function(){this.callParent(),this.addEvents("spin","spinup","spindown")},onRender:function(){var triggers,me=this;me.callParent(arguments),triggers=me.triggerEl,me.spinUpEl=triggers.item(0),me.spinDownEl=triggers.item(1),me.triggerCell=me.spinUpEl.parent(),me.keyNavEnabled&&(me.spinnerKeyNav=new Ext.util.KeyNav(me.inputEl,{scope:me,up:me.spinUp,down:me.spinDown})),me.mouseWheelEnabled&&me.mon(me.bodyEl,"mousewheel",me.onMouseWheel,me)},getSubTplMarkup:function(values){var me=this,childElCls=values.childElCls,field=Ext.form.field.Base.prototype.getSubTplMarkup.apply(me,arguments);return'<table id="'+me.id+'-triggerWrap" class="'+Ext.baseCSSPrefix+"form-trigger-wrap"+childElCls+'" cellpadding="0" cellspacing="0" role="presentation"><tbody role="presentation"><tr role="presentation"><td id="'+me.id+'-inputCell" class="'+Ext.baseCSSPrefix+"form-trigger-input-cell"+childElCls+'" role="presentation">'+field+"</td>"+me.getTriggerMarkup()+"</tbody></table>"},getTriggerMarkup:function(){return this.getTpl("triggerTpl").apply(this.getTriggerData())},getTriggerData:function(){var me=this,hideTrigger=me.readOnly||me.hideTrigger;return{triggerCls:Ext.baseCSSPrefix+"trigger-cell",triggerStyle:hideTrigger?"display:none":"",spinnerUpCls:me.spinUpEnabled?"":me.trigger1Cls+"-disabled",spinnerDownCls:me.spinDownEnabled?"":me.trigger2Cls+"-disabled"}},getTriggerWidth:function(){var me=this,totalTriggerWidth=0;return!me.triggerWrap||me.hideTrigger||me.readOnly||(totalTriggerWidth=me.triggerWidth),totalTriggerWidth},onTrigger1Click:function(){this.spinUp()},onTrigger2Click:function(){this.spinDown()},onTriggerWrapMouseup:function(){this.inputEl.focus()},spinUp:function(){var me=this;me.spinUpEnabled&&!me.disabled&&(me.fireEvent("spin",me,"up"),me.fireEvent("spinup",me),me.onSpinUp())},spinDown:function(){var me=this;me.spinDownEnabled&&!me.disabled&&(me.fireEvent("spin",me,"down"),me.fireEvent("spindown",me),me.onSpinDown())},setSpinUpEnabled:function(enabled){var me=this,wasEnabled=me.spinUpEnabled;me.spinUpEnabled=enabled,wasEnabled!==enabled&&me.rendered&&me.spinUpEl[enabled?"removeCls":"addCls"](me.trigger1Cls+"-disabled")},setSpinDownEnabled:function(enabled){var me=this,wasEnabled=me.spinDownEnabled;me.spinDownEnabled=enabled,wasEnabled!==enabled&&me.rendered&&me.spinDownEl[enabled?"removeCls":"addCls"](me.trigger2Cls+"-disabled")},onMouseWheel:function(e){var delta,me=this;me.hasFocus&&(delta=e.getWheelDelta(),delta>0?me.spinUp():delta<0&&me.spinDown(),e.stopEvent())},onDestroy:function(){Ext.destroyMembers(this,"spinnerKeyNav","spinUpEl","spinDownEl"),this.callParent()}}),Ext.define("Ext.form.field.Number",{extend:Ext.form.field.Spinner,alias:"widget.numberfield",alternateClassName:["Ext.form.NumberField","Ext.form.Number"],allowExponential:!0,allowDecimals:!0,decimalSeparator:null,submitLocaleSeparator:!0,decimalPrecision:2,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,step:1,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",negativeText:"The value cannot be negative",baseChars:"0123456789",autoStripChars:!1,initComponent:function(){var me=this;null===me.decimalSeparator&&(me.decimalSeparator=Ext.util.Format.decimalSeparator),me.callParent(),me.setMinValue(me.minValue),me.setMaxValue(me.maxValue)},getErrors:function(value){var num,me=this,errors=me.callParent(arguments),format=Ext.String.format;return value=Ext.isDefined(value)?value:this.processRawValue(this.getRawValue()),value.length<1?errors:(value=String(value).replace(me.decimalSeparator,"."),isNaN(value)&&errors.push(format(me.nanText,value)),num=me.parseValue(value),0===me.minValue&&num<0?errors.push(this.negativeText):num<me.minValue&&errors.push(format(me.minText,me.minValue)),num>me.maxValue&&errors.push(format(me.maxText,me.maxValue)),errors)},rawToValue:function(rawValue){var value=this.fixPrecision(this.parseValue(rawValue));return null===value&&(value=rawValue||null),value},valueToRaw:function(value){var me=this,decimalSeparator=me.decimalSeparator;return value=me.parseValue(value),value=me.fixPrecision(value),value=Ext.isNumber(value)?value:parseFloat(String(value).replace(decimalSeparator,".")),value=isNaN(value)?"":String(value).replace(".",decimalSeparator)},getSubmitValue:function(){var me=this,value=me.callParent();return me.submitLocaleSeparator||(value=value.replace(me.decimalSeparator,".")),value},onChange:function(){this.toggleSpinners(),this.callParent(arguments)},toggleSpinners:function(){var enabled,me=this,value=me.getValue(),valueIsNull=null===value;(me.spinUpEnabled||me.spinUpDisabledByToggle)&&(enabled=valueIsNull||value<me.maxValue,me.setSpinUpEnabled(enabled,!0)),(me.spinDownEnabled||me.spinDownDisabledByToggle)&&(enabled=valueIsNull||value>me.minValue,me.setSpinDownEnabled(enabled,!0))},setMinValue:function(value){var allowed,me=this;me.minValue=Ext.Number.from(value,Number.NEGATIVE_INFINITY),me.toggleSpinners(),me.disableKeyFilter!==!0&&(allowed=me.baseChars+"",me.allowExponential?allowed+=me.decimalSeparator+"e+-":(me.allowDecimals&&(allowed+=me.decimalSeparator),me.minValue<0&&(allowed+="-")),allowed=Ext.String.escapeRegex(allowed),me.maskRe=new RegExp("["+allowed+"]"),me.autoStripChars&&(me.stripCharsRe=new RegExp("[^"+allowed+"]","gi")))},setMaxValue:function(value){this.maxValue=Ext.Number.from(value,Number.MAX_VALUE),this.toggleSpinners()},parseValue:function(value){return value=parseFloat(String(value).replace(this.decimalSeparator,".")),isNaN(value)?null:value},fixPrecision:function(value){var me=this,nan=isNaN(value),precision=me.decimalPrecision;return nan||!value?nan?"":value:((!me.allowDecimals||precision<=0)&&(precision=0),parseFloat(Ext.Number.toFixed(parseFloat(value),precision)))},beforeBlur:function(){var me=this,v=me.parseValue(me.getRawValue());Ext.isEmpty(v)||me.setValue(v)},setSpinUpEnabled:function(enabled,internal){this.callParent(arguments),internal?this.spinUpDisabledByToggle=!enabled:delete this.spinUpDisabledByToggle},onSpinUp:function(){var me=this;me.readOnly||me.setSpinValue(Ext.Number.constrain(me.getValue()+me.step,me.minValue,me.maxValue))},setSpinDownEnabled:function(enabled,internal){this.callParent(arguments),internal?this.spinDownDisabledByToggle=!enabled:delete this.spinDownDisabledByToggle},onSpinDown:function(){var me=this;me.readOnly||me.setSpinValue(Ext.Number.constrain(me.getValue()-me.step,me.minValue,me.maxValue));
},setSpinValue:function(value){var me=this;me.enforceMaxLength&&me.fixPrecision(value).toString().length>me.maxLength||me.setValue(value)}}),Ext.define("Ext.toolbar.Paging",{extend:Ext.toolbar.Toolbar,alias:"widget.pagingtoolbar",alternateClassName:"Ext.PagingToolbar",mixins:{bindable:Ext.util.Bindable},displayInfo:!1,prependButtons:!1,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",inputItemWidth:30,getPagingItems:function(){var me=this;return[{itemId:"first",tooltip:me.firstText,overflowText:me.firstText,iconCls:Ext.baseCSSPrefix+"tbar-page-first",disabled:!0,handler:me.moveFirst,scope:me},{itemId:"prev",tooltip:me.prevText,overflowText:me.prevText,iconCls:Ext.baseCSSPrefix+"tbar-page-prev",disabled:!0,handler:me.movePrevious,scope:me},"-",me.beforePageText,{xtype:"numberfield",itemId:"inputItem",name:"inputItem",cls:Ext.baseCSSPrefix+"tbar-page-number",allowDecimals:!1,minValue:1,hideTrigger:!0,enableKeyEvents:!0,keyNavEnabled:!1,selectOnFocus:!0,submitValue:!1,isFormField:!1,width:me.inputItemWidth,margins:"-1 2 3 2",listeners:{scope:me,keydown:me.onPagingKeyDown,blur:me.onPagingBlur}},{xtype:"tbtext",itemId:"afterTextItem",text:Ext.String.format(me.afterPageText,1)},"-",{itemId:"next",tooltip:me.nextText,overflowText:me.nextText,iconCls:Ext.baseCSSPrefix+"tbar-page-next",disabled:!0,handler:me.moveNext,scope:me},{itemId:"last",tooltip:me.lastText,overflowText:me.lastText,iconCls:Ext.baseCSSPrefix+"tbar-page-last",disabled:!0,handler:me.moveLast,scope:me},"-",{itemId:"refresh",tooltip:me.refreshText,overflowText:me.refreshText,iconCls:Ext.baseCSSPrefix+"tbar-loading",disabled:me.store.isLoading(),handler:me.doRefresh,scope:me}]},initComponent:function(){var pagingItems,me=this,userItems=me.items||me.buttons||[];me.bindStore(me.store||"ext-empty-store",!0),pagingItems=me.getPagingItems(),me.prependButtons?me.items=userItems.concat(pagingItems):me.items=pagingItems.concat(userItems),delete me.buttons,me.displayInfo&&(me.items.push("->"),me.items.push({xtype:"tbtext",itemId:"displayItem"})),me.callParent(),me.addEvents("change","beforechange")},beforeRender:function(){this.callParent(arguments),this.store.isLoading()||this.onLoad()},updateInfo:function(){var count,msg,me=this,displayItem=me.child("#displayItem"),store=me.store,pageData=me.getPageData();displayItem&&(count=store.getCount(),msg=0===count?me.emptyMsg:Ext.String.format(me.displayMsg,pageData.fromRecord,pageData.toRecord,pageData.total),displayItem.setText(msg))},onLoad:function(){var pageData,currPage,pageCount,afterText,count,isEmpty,item,me=this;if(count=me.store.getCount(),isEmpty=0===count)currPage=0,pageCount=0,afterText=Ext.String.format(me.afterPageText,0);else{if(pageData=me.getPageData(),currPage=pageData.currentPage,pageCount=pageData.pageCount,currPage>pageCount)return void me.store.loadPage(pageCount);afterText=Ext.String.format(me.afterPageText,isNaN(pageCount)?1:pageCount)}Ext.suspendLayouts(),item=me.child("#afterTextItem"),item&&item.setText(afterText),item=me.getInputItem(),item&&item.setDisabled(isEmpty).setValue(currPage),me.setChildDisabled("#first",1===currPage||isEmpty),me.setChildDisabled("#prev",1===currPage||isEmpty),me.setChildDisabled("#next",currPage===pageCount||isEmpty),me.setChildDisabled("#last",currPage===pageCount||isEmpty),me.setChildDisabled("#refresh",!1),me.updateInfo(),Ext.resumeLayouts(!0),me.fireEvent("change",me,pageData)},setChildDisabled:function(selector,disabled){var item=this.child(selector);item&&item.setDisabled(disabled)},getPageData:function(){var store=this.store,totalCount=store.getTotalCount();return{total:totalCount,currentPage:store.currentPage,pageCount:Math.ceil(totalCount/store.pageSize),fromRecord:(store.currentPage-1)*store.pageSize+1,toRecord:Math.min(store.currentPage*store.pageSize,totalCount)}},onLoadError:function(){this.setChildDisabled("#refresh",!1)},getInputItem:function(){return this.child("#inputItem")},readPageFromInput:function(pageData){var v,inputItem=this.getInputItem(),pageNum=!1;return inputItem&&(v=inputItem.getValue(),pageNum=parseInt(v,10),!v||isNaN(pageNum))?(inputItem.setValue(pageData.currentPage),!1):pageNum},onPagingBlur:function(e){var curPage,inputItem=this.getInputItem();inputItem&&(curPage=this.getPageData().currentPage,inputItem.setValue(curPage))},onPagingKeyDown:function(field,e){this.processKeyEvent(field,e)},processKeyEvent:function(field,e){var pageNum,me=this,k=e.getKey(),pageData=me.getPageData(),increment=e.shiftKey?10:1;k==e.RETURN?(e.stopEvent(),pageNum=me.readPageFromInput(pageData),pageNum!==!1&&(pageNum=Math.min(Math.max(1,pageNum),pageData.pageCount),pageNum!==pageData.currentPage&&me.fireEvent("beforechange",me,pageNum)!==!1&&me.store.loadPage(pageNum))):k==e.HOME||k==e.END?(e.stopEvent(),pageNum=k==e.HOME?1:pageData.pageCount,field.setValue(pageNum)):k!=e.UP&&k!=e.PAGE_UP&&k!=e.DOWN&&k!=e.PAGE_DOWN||(e.stopEvent(),pageNum=me.readPageFromInput(pageData),pageNum&&(k!=e.DOWN&&k!=e.PAGE_DOWN||(increment*=-1),pageNum+=increment,pageNum>=1&&pageNum<=pageData.pageCount&&field.setValue(pageNum)))},beforeLoad:function(){this.setChildDisabled("#refresh",!0)},moveFirst:function(){return this.fireEvent("beforechange",this,1)!==!1&&(this.store.loadPage(1),!0)},movePrevious:function(){var me=this,store=me.store,prev=store.currentPage-1;return prev>0&&me.fireEvent("beforechange",me,prev)!==!1&&(store.previousPage(),!0)},moveNext:function(){var me=this,store=me.store,total=me.getPageData().pageCount,next=store.currentPage+1;return next<=total&&me.fireEvent("beforechange",me,next)!==!1&&(store.nextPage(),!0)},moveLast:function(){var me=this,last=me.getPageData().pageCount;return me.fireEvent("beforechange",me,last)!==!1&&(me.store.loadPage(last),!0)},doRefresh:function(){var me=this,store=me.store,current=store.currentPage;return me.fireEvent("beforechange",me,current)!==!1&&(store.loadPage(current),!0)},getStoreListeners:function(){return{beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError}},unbind:function(store){this.bindStore(null)},bind:function(store){this.bindStore(store)},onDestroy:function(){this.unbind(),this.callParent()}}),Ext.define("Ext.view.BoundList",{extend:Ext.view.View,alias:"widget.boundlist",alternateClassName:"Ext.BoundList",mixins:{queryable:Ext.Queryable},pageSize:0,baseCls:Ext.baseCSSPrefix+"boundlist",itemCls:Ext.baseCSSPrefix+"boundlist-item",listItemCls:"",shadow:!1,trackOver:!0,refreshed:0,deferInitialRefresh:!1,componentLayout:"boundlist",childEls:["listEl"],renderTpl:['<div id="{id}-listEl" role="presentation" class="{baseCls}-list-ct ',Ext.dom.Element.unselectableCls,'" style="overflow:auto"></div>',"{%","var me=values.$comp, pagingToolbar=me.pagingToolbar;","if (pagingToolbar) {","pagingToolbar.ownerLayout = me.componentLayout;","Ext.DomHelper.generateMarkup(pagingToolbar.getRenderTree(), out);","}","%}",{disableFormats:!0}],initComponent:function(){var me=this,baseCls=me.baseCls,itemCls=me.itemCls;me.selectedItemCls=baseCls+"-selected",me.trackOver&&(me.overItemCls=baseCls+"-item-over"),me.itemSelector="."+itemCls,me.floating&&me.addCls(baseCls+"-floating"),me.tpl?me.tpl.isTemplate||(me.tpl=new Ext.XTemplate(me.tpl)):me.tpl=new Ext.XTemplate('<ul class="'+Ext.plainListCls+'"><tpl for=".">','<li role="option" unselectable="on" class="'+itemCls+'">'+me.getInnerTpl(me.displayField)+"</li>","</tpl></ul>"),me.pageSize&&(me.pagingToolbar=me.createPagingToolbar()),me.callParent()},beforeRender:function(){var me=this;me.callParent(arguments),me.up("menu")&&me.addCls(Ext.baseCSSPrefix+"menu")},getRefOwner:function(){return this.pickerField||this.callParent()},getRefItems:function(){return this.pagingToolbar?[this.pagingToolbar]:[]},createPagingToolbar:function(){return Ext.widget("pagingtoolbar",{id:this.id+"-paging-toolbar",pageSize:this.pageSize,store:this.dataSource,border:!1,ownerCt:this,ownerLayout:this.getComponentLayout()})},finishRenderChildren:function(){var toolbar=this.pagingToolbar;this.callParent(arguments),toolbar&&toolbar.finishRender()},refresh:function(){var me=this,tpl=me.tpl,toolbar=me.pagingToolbar,rendered=me.rendered;tpl.field=me.pickerField,tpl.store=me.store,me.callParent(),tpl.field=tpl.store=null,rendered&&toolbar&&toolbar.rendered&&!me.preserveScrollOnRefresh&&me.el.appendChild(toolbar.el),rendered&&Ext.isIE6&&Ext.isStrict&&me.listEl.repaint()},bindStore:function(store,initial){var toolbar=this.pagingToolbar;this.callParent(arguments),toolbar&&toolbar.bindStore(store,initial)},getTargetEl:function(){return this.listEl||this.el},getInnerTpl:function(displayField){return"{"+displayField+"}"},onDestroy:function(){Ext.destroyMembers(this,"pagingToolbar","listEl"),this.callParent()}}),Ext.define("Ext.view.BoundListKeyNav",{extend:Ext.util.KeyNav,constructor:function(el,config){var me=this;me.boundList=config.boundList,me.callParent([el,Ext.apply({},config,me.defaultHandlers)])},defaultHandlers:{up:function(){var me=this,boundList=me.boundList,allItems=boundList.all,oldItem=boundList.highlightedItem,oldItemIdx=oldItem?boundList.indexOf(oldItem):-1,newItemIdx=oldItemIdx>0?oldItemIdx-1:allItems.getCount()-1;me.highlightAt(newItemIdx)},down:function(){var me=this,boundList=me.boundList,allItems=boundList.all,oldItem=boundList.highlightedItem,oldItemIdx=oldItem?boundList.indexOf(oldItem):-1,newItemIdx=oldItemIdx<allItems.getCount()-1?oldItemIdx+1:0;me.highlightAt(newItemIdx)},pageup:function(){},pagedown:function(){},home:function(){this.highlightAt(0)},end:function(){var me=this;me.highlightAt(me.boundList.all.getCount()-1)},enter:function(e){this.selectHighlighted(e)}},highlightAt:function(index){var boundList=this.boundList,item=boundList.all.item(index);item&&(item=item.dom,boundList.highlightItem(item),boundList.getTargetEl().scrollChildIntoView(item,!1))},selectHighlighted:function(e){var highlighted,highlightedRec,boundList=this.boundList,selModel=boundList.getSelectionModel();highlighted=boundList.highlightedItem,highlighted&&(highlightedRec=boundList.getRecord(highlighted),e.getKey()!==e.ENTER&&selModel.isSelected(highlightedRec)||selModel.selectWithEvent(highlightedRec,e))}}),Ext.define("Ext.layout.component.field.ComboBox",{extend:Ext.layout.component.field.Trigger,alias:"layout.combobox",type:"combobox",startingWidth:null,getTextWidth:function(){for(var ln,item,width,me=this,owner=me.owner,store=owner.store,field=owner.displayField,storeLn=store.data.length,value="",i=0,n=0;i<storeLn;i++)item=store.getAt(i).data[field],ln=item.length,ln>n&&(n=ln,value=item);return width=Math.max(me.callParent(arguments),owner.inputEl.getTextWidth(value+owner.growAppend)),me.startingWidth&&!owner.removingRecords||(me.startingWidth=width,width<owner.growMin&&(owner.defaultListConfig.minWidth=owner.growMin),owner.removingRecords=!1),width<me.startingWidth?me.startingWidth:width}}),Ext.define("Ext.form.field.ComboBox",{extend:Ext.form.field.Picker,alternateClassName:"Ext.form.ComboBox",alias:["widget.combobox","widget.combo"],mixins:{bindable:Ext.util.Bindable},componentLayout:"combobox",triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",hiddenName:"",hiddenDataCls:Ext.baseCSSPrefix+"hide-display "+Ext.baseCSSPrefix+"form-data-hidden",ariaRole:"combobox",fieldSubTpl:['<div class="{hiddenDataCls}" role="presentation"></div>','<input id="{id}" type="{type}" role="{role}" {inputAttrTpl} class="{fieldCls} {typeCls} {editableCls}" autocomplete="off"','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="name"> name="{name}"</tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="size"> size="{size}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',"/>",{compiled:!0,disableFormats:!0}],getSubTplData:function(){var me=this;return Ext.applyIf(me.subTplData,{hiddenDataCls:me.hiddenDataCls}),me.callParent(arguments)},afterRender:function(){var me=this;me.callParent(arguments),me.setHiddenValue(me.value)},multiSelect:!1,delimiter:", ",displayField:"text",triggerAction:"all",allQuery:"",queryParam:"query",queryMode:"remote",queryCaching:!0,pageSize:0,anyMatch:!1,caseSensitive:!1,autoSelect:!0,typeAhead:!1,typeAheadDelay:250,selectOnTab:!0,forceSelection:!1,growToLongestValue:!0,clearFilterOnBlur:!0,defaultListConfig:{loadingHeight:70,minWidth:70,maxHeight:300,shadow:"sides"},transformInPlace:!0,ignoreSelection:0,removingRecords:null,resizeComboToGrow:function(){var me=this;return me.grow&&me.growToLongestValue},initComponent:function(){var transformSelect,isLocalMode,me=this,isDefined=Ext.isDefined,store=me.store,transform=me.transform,displayTpl=me.displayTpl;Ext.applyIf(me.renderSelectors,{hiddenDataEl:"."+me.hiddenDataCls.split(" ").join(".")}),me.addEvents("beforequery","select","beforeselect","beforedeselect"),transform&&(transformSelect=Ext.getDom(transform),transformSelect&&(me.store||(store=Ext.Array.map(Ext.Array.from(transformSelect.options),function(option){return[option.value,option.text]})),me.name||(me.name=transformSelect.name),"value"in me||(me.value=transformSelect.value))),me.bindStore(store||"ext-empty-store",!0),store=me.store,store.autoCreated&&(me.queryMode="local",me.valueField=me.displayField="field1",store.expanded||(me.displayField="field2")),isDefined(me.valueField)||(me.valueField=me.displayField),isLocalMode="local"===me.queryMode,isDefined(me.queryDelay)||(me.queryDelay=isLocalMode?10:500),isDefined(me.minChars)||(me.minChars=isLocalMode?0:4),displayTpl?displayTpl.isTemplate||(me.displayTpl=new Ext.XTemplate(displayTpl)):me.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : values["'+me.displayField+'"]]}<tpl if="xindex < xcount">'+me.delimiter+"</tpl></tpl>"),me.callParent(),me.doQueryTask=new Ext.util.DelayedTask(me.doRawQuery,me),me.store.getCount()>0&&me.setValue(me.value),transformSelect&&(me.transformInPlace&&(me.render(transformSelect.parentNode,transformSelect),delete me.renderTo),Ext.removeNode(transformSelect))},getStore:function(){return this.store},beforeBlur:function(){var me=this,filter=me.queryFilter;me.doQueryTask.cancel(),me.assertValue(),filter&&!filter.disabled&&"local"===me.queryMode&&me.clearFilterOnBlur&&(filter.disabled=!0,me.store.filter())},onFocus:function(){var me=this,filter=me.queryFilter;me.callParent(arguments),!me.duringTriggerClick&&"all"!==me.triggerAction&&filter&&filter.disabled&&"local"===me.queryMode&&me.clearFilterOnBlur&&(delete me.lastQuery,me.doRawQuery())},assertValue:function(){var rec,currentValue,me=this,value=me.getRawValue();me.forceSelection&&(me.multiSelect?value!==me.getDisplayValue()&&me.setValue(me.lastSelection):(rec=me.findRecordByDisplay(value),rec?(currentValue=me.value,me.findRecordByValue(currentValue)||me.select(rec,!0)):me.setValue(me.lastSelection))),me.collapse()},onTypeAhead:function(){var newValue,len,selStart,me=this,displayField=me.displayField,record=me.store.findRecord(displayField,me.getRawValue()),boundList=me.getPicker();record&&(newValue=record.get(displayField),len=newValue.length,selStart=me.getRawValue().length,boundList.highlightItem(boundList.getNode(record)),0!==selStart&&selStart!==len&&(me.setRawValue(newValue),me.selectText(selStart,newValue.length)))},resetToDefault:Ext.emptyFn,beforeReset:function(){var filter=this.queryFilter;this.callParent(),filter&&!filter.disabled&&(filter.disabled=!0,this.store.filter())},onUnbindStore:function(store){var me=this,picker=me.picker,filter=me.queryFilter;filter&&me.store.removeFilter(filter),!store&&picker&&picker.bindStore(null)},onBindStore:function(store,initial){var picker=this.picker;initial||this.resetToDefault(),picker&&picker.bindStore(store)},getStoreListeners:function(){var me=this;return{beforeload:me.onBeforeLoad,clear:me.onClear,datachanged:me.onDataChanged,load:me.onLoad,exception:me.onException,remove:me.onRemove}},onBeforeLoad:function(){++this.ignoreSelection},onDataChanged:function(){var me=this;me.resizeComboToGrow()&&me.updateLayout()},onClear:function(){var me=this;me.resizeComboToGrow()&&(me.removingRecords=!0,me.onDataChanged())},onRemove:function(){var me=this;me.resizeComboToGrow()&&(me.removingRecords=!0)},onException:function(){this.ignoreSelection>0&&--this.ignoreSelection,this.collapse()},onLoad:function(store,records,success){var me=this;me.ignoreSelection>0&&--me.ignoreSelection,success&&!store.lastOptions.rawQuery&&(null==me.value&&me.store.getCount()?me.doAutoSelect():me.setValue(me.value))},doRawQuery:function(){this.doQuery(this.getRawValue(),!1,!0)},doQuery:function(queryString,forceAll,rawQuery){var me=this,queryPlan=me.beforeQuery({query:queryString||"",rawQuery:rawQuery,forceAll:forceAll,combo:me,cancel:!1});return queryPlan!==!1&&!queryPlan.cancel&&(me.queryCaching&&queryPlan.query===me.lastQuery?(me.expand(),"local"===me.queryMode&&me.doAutoSelect()):(me.lastQuery=queryPlan.query,"local"===me.queryMode?me.doLocalQuery(queryPlan):me.doRemoteQuery(queryPlan)),!0)},beforeQuery:function(queryPlan){var me=this;return me.fireEvent("beforequery",queryPlan)===!1?queryPlan.cancel=!0:queryPlan.cancel||queryPlan.query.length<me.minChars&&!queryPlan.forceAll&&(queryPlan.cancel=!0),queryPlan},doLocalQuery:function(queryPlan){var me=this,queryString=queryPlan.query;me.queryFilter||(me.queryFilter=new Ext.util.Filter({id:me.id+"-query-filter",anyMatch:me.anyMatch,caseSensitive:me.caseSensitive,root:"data",property:me.displayField}),me.store.addFilter(me.queryFilter,!1)),queryString||!queryPlan.forceAll?(me.queryFilter.disabled=!1,me.queryFilter.setValue(me.enableRegEx?new RegExp(queryString):queryString)):me.queryFilter.disabled=!0,me.store.filter(),me.store.getCount()?me.expand():me.collapse(),me.afterQuery(queryPlan)},doRemoteQuery:function(queryPlan){var me=this,loadCallback=function(){me.afterQuery(queryPlan)};me.expand(),me.pageSize?me.loadPage(1,{rawQuery:queryPlan.rawQuery,callback:loadCallback}):me.store.load({params:me.getParams(queryPlan.query),rawQuery:queryPlan.rawQuery,callback:loadCallback})},afterQuery:function(queryPlan){var me=this;me.store.getCount()&&(me.typeAhead&&me.doTypeAhead(),me.getRawValue()!==me.getDisplayValue()&&(me.ignoreSelection++,me.picker.getSelectionModel().deselectAll(),me.ignoreSelection--),queryPlan.rawQuery?(me.syncSelection(),me.picker&&!me.picker.getSelectionModel().hasSelection()&&me.doAutoSelect()):me.doAutoSelect())},loadPage:function(pageNum,options){this.store.loadPage(pageNum,Ext.apply({params:this.getParams(this.lastQuery)},options))},onPageChange:function(toolbar,newPage){return this.loadPage(newPage),!1},getParams:function(queryString){var params={},param=this.queryParam;return param&&(params[param]=queryString),params},doAutoSelect:function(){var lastSelected,itemNode,me=this,picker=me.picker;picker&&me.autoSelect&&me.store.getCount()>0&&(lastSelected=picker.getSelectionModel().lastSelected,itemNode=picker.getNode(lastSelected||0),itemNode&&(picker.highlightItem(itemNode),picker.listEl.scrollChildIntoView(itemNode,!1)))},doTypeAhead:function(){var me=this;me.typeAheadTask||(me.typeAheadTask=new Ext.util.DelayedTask(me.onTypeAhead,me)),me.lastKey!=Ext.EventObject.BACKSPACE&&me.lastKey!=Ext.EventObject.DELETE&&me.typeAheadTask.delay(me.typeAheadDelay)},onTriggerClick:function(){var me=this;me.duringTriggerClick=!0,me.readOnly||me.disabled||(me.isExpanded?me.collapse():(me.onFocus({}),"all"===me.triggerAction?me.doQuery(me.allQuery,!0):"last"===me.triggerAction?me.doQuery(me.lastQuery,!0):me.doQuery(me.getRawValue(),!1,!0)),me.inputEl.focus()),delete me.duringTriggerClick},onPaste:function(){var me=this;me.readOnly||me.disabled||!me.editable||me.doQueryTask.delay(me.queryDelay)},onKeyUp:function(e,t){var me=this,key=e.getKey();me.readOnly||me.disabled||!me.editable||(me.lastKey=key,e.isSpecialKey()&&key!=e.BACKSPACE&&key!=e.DELETE||me.doQueryTask.delay(me.queryDelay)),me.enableKeyEvents&&me.callParent(arguments)},initEvents:function(){var me=this;me.callParent(),me.enableKeyEvents||me.mon(me.inputEl,"keyup",me.onKeyUp,me),me.mon(me.inputEl,"paste",me.onPaste,me)},onDestroy:function(){var me=this;me.typeAheadTask&&(me.typeAheadTask.cancel(),me.typeAheadTask=null),Ext.destroy(me.listKeyNav),me.bindStore(null),me.callParent()},onAdded:function(){var me=this;me.callParent(arguments),me.picker&&(me.picker.ownerCt=me.up("[floating]"),me.picker.registerWithOwnerCt())},createPicker:function(){var picker,me=this,pickerCfg=Ext.apply({xtype:"boundlist",pickerField:me,selModel:{mode:me.multiSelect?"SIMPLE":"SINGLE"},floating:!0,hidden:!0,store:me.store,displayField:me.displayField,focusOnToFront:!1,pageSize:me.pageSize,tpl:me.tpl},me.listConfig,me.defaultListConfig);return picker=me.picker=Ext.widget(pickerCfg),me.pageSize&&picker.pagingToolbar.on("beforechange",me.onPageChange,me),me.mon(picker,{itemclick:me.onItemClick,refresh:me.onListRefresh,scope:me}),me.mon(picker.getSelectionModel(),{beforeselect:me.onBeforeSelect,beforedeselect:me.onBeforeDeselect,selectionchange:me.onListSelectionChange,scope:me}),picker},alignPicker:function(){var me=this,picker=me.getPicker(),heightAbove=me.getPosition()[1]-Ext.getBody().getScroll().top,heightBelow=Ext.Element.getViewHeight()-heightAbove-me.getHeight(),space=Math.max(heightAbove,heightBelow);picker.height&&(delete picker.height,picker.updateLayout()),picker.getHeight()>space-5&&picker.setHeight(space-5),me.callParent()},onListRefresh:function(){this.expanding||this.alignPicker(),this.syncSelection()},onItemClick:function(picker,record){var me=this,selection=me.picker.getSelectionModel().getSelection(),valueField=me.valueField;!me.multiSelect&&selection.length&&record.get(valueField)===selection[0].get(valueField)&&(me.displayTplData=[record.data],me.setRawValue(me.getDisplayValue()),me.collapse())},onBeforeSelect:function(list,record){return this.fireEvent("beforeselect",this,record,record.index)},onBeforeDeselect:function(list,record){return this.fireEvent("beforedeselect",this,record,record.index)},onListSelectionChange:function(list,selectedRecords){var me=this,isMulti=me.multiSelect,hasRecords=selectedRecords.length>0;!me.ignoreSelection&&me.isExpanded&&(isMulti||Ext.defer(me.collapse,1,me),(isMulti||hasRecords)&&me.setValue(selectedRecords,!1),hasRecords&&me.fireEvent("select",me,selectedRecords),me.inputEl.focus())},onExpand:function(){var me=this,keyNav=me.listKeyNav,selectOnTab=me.selectOnTab,picker=me.getPicker();keyNav?keyNav.enable():keyNav=me.listKeyNav=new Ext.view.BoundListKeyNav(me.inputEl,{boundList:picker,forceKeyDown:!0,tab:function(e){return selectOnTab&&(this.selectHighlighted(e),me.triggerBlur()),!0},enter:function(e){var selModel=picker.getSelectionModel(),count=selModel.getCount();this.selectHighlighted(e),me.multiSelect||count!==selModel.getCount()||me.collapse()}}),selectOnTab&&(me.ignoreMonitorTab=!0),Ext.defer(keyNav.enable,1,keyNav),me.inputEl.focus()},onCollapse:function(){var me=this,keyNav=me.listKeyNav;keyNav&&(keyNav.disable(),me.ignoreMonitorTab=!1)},select:function(r,assert){var fireSelect,me=this,picker=me.picker;r&&r.isModel&&assert===!0&&picker&&(fireSelect=!picker.getSelectionModel().isSelected(r)),me.setValue(r,!0),fireSelect&&me.fireEvent("select",me,r)},findRecord:function(field,value){var ds=this.store,idx=ds.findExact(field,value);return idx!==-1&&ds.getAt(idx)},findRecordByValue:function(value){return this.findRecord(this.valueField,value)},findRecordByDisplay:function(value){return this.findRecord(this.displayField,value)},setValue:function(value,doSelect){var i,len,record,dataObj,me=this,valueNotFoundText=me.valueNotFoundText,inputEl=me.inputEl,matchedRecords=[],displayTplData=[],processedValue=[];if(me.store.loading)return me.value=value,me.setHiddenValue(me.value),me;for(value=Ext.Array.from(value),i=0,len=value.length;i<len;i++)record=value[i],record&&record.isModel||(record=me.findRecordByValue(record)),record?(matchedRecords.push(record),displayTplData.push(record.data),processedValue.push(record.get(me.valueField))):me.forceSelection?Ext.isDefined(valueNotFoundText)&&displayTplData.push(valueNotFoundText):(processedValue.push(value[i]),dataObj={},dataObj[me.displayField]=value[i],displayTplData.push(dataObj));return me.setHiddenValue(processedValue),me.value=me.multiSelect?processedValue:processedValue[0],Ext.isDefined(me.value)||(me.value=null),me.displayTplData=displayTplData,me.lastSelection=me.valueModels=matchedRecords,inputEl&&me.emptyText&&!Ext.isEmpty(value)&&inputEl.removeCls(me.emptyCls),me.setRawValue(me.getDisplayValue()),me.checkChange(),doSelect!==!1&&me.syncSelection(),me.applyEmptyText(),me},setHiddenValue:function(values){var i,dom,childNodes,input,valueCount,childrenCount,me=this,name=me.hiddenName;if(me.hiddenDataEl&&name){for(values=Ext.Array.from(values),dom=me.hiddenDataEl.dom,childNodes=dom.childNodes,input=childNodes[0],valueCount=values.length,childrenCount=childNodes.length,!input&&valueCount>0&&(me.hiddenDataEl.update(Ext.DomHelper.markup({tag:"input",type:"hidden",name:name})),childrenCount=1,input=dom.firstChild);childrenCount>valueCount;)dom.removeChild(childNodes[0]),--childrenCount;for(;childrenCount<valueCount;)dom.appendChild(input.cloneNode(!0)),++childrenCount;for(i=0;i<valueCount;i++)childNodes[i].value=values[i]}},getDisplayValue:function(){return this.displayTpl.apply(this.displayTplData)},getValue:function(){var me=this,picker=me.picker,rawValue=me.getRawValue(),value=me.value;return me.getDisplayValue()!==rawValue&&(value=rawValue,me.value=me.displayTplData=me.valueModels=null,picker&&(me.ignoreSelection++,picker.getSelectionModel().deselectAll(),me.ignoreSelection--)),value},getSubmitValue:function(){var value=this.getValue();return Ext.isEmpty(value)&&(value=""),value},isEqual:function(v1,v2){var i,len,fromArray=Ext.Array.from;if(v1=fromArray(v1),v2=fromArray(v2),len=v1.length,len!==v2.length)return!1;for(i=0;i<len;i++)if(v2[i]!==v1[i])return!1;return!0},clearValue:function(){this.setValue([])},syncSelection:function(){var selection,selModel,v,value,me=this,picker=me.picker,values=me.valueModels||[],vLen=values.length;if(picker){for(selection=[],v=0;v<vLen;v++)value=values[v],value&&value.isModel&&me.store.indexOf(value)>=0&&selection.push(value);me.ignoreSelection++,selModel=picker.getSelectionModel(),selModel.deselectAll(),selection.length&&selModel.select(selection,void 0,!0),me.ignoreSelection--}},onEditorTab:function(e){var keyNav=this.listKeyNav;this.selectOnTab&&keyNav&&keyNav.selectHighlighted(e)}}),Ext.define("Ext.picker.Month",{extend:Ext.Component,alias:"widget.monthpicker",alternateClassName:"Ext.MonthPicker",childEls:["bodyEl","prevEl","nextEl","buttonsEl","monthEl","yearEl"],renderTpl:['<div id="{id}-bodyEl" class="{baseCls}-body">','<div id="{id}-monthEl" class="{baseCls}-months">','<tpl for="months">','<div class="{parent.baseCls}-item {parent.baseCls}-month">','<a style="{parent.monthStyle}" role="button" hidefocus="on" class="{parent.baseCls}-item-inner" href="#">{.}</a>',"</div>","</tpl>","</div>",'<div id="{id}-yearEl" class="{baseCls}-years">','<div class="{baseCls}-yearnav">','<div class="{baseCls}-yearnav-button-ct">','<a id="{id}-prevEl" class="{baseCls}-yearnav-button {baseCls}-yearnav-prev" href="#" hidefocus="on" role="button"></a>',"</div>",'<div class="{baseCls}-yearnav-button-ct">','<a id="{id}-nextEl" class="{baseCls}-yearnav-button {baseCls}-yearnav-next" href="#" hidefocus="on" role="button"></a>',"</div>","</div>",'<tpl for="years">','<div class="{parent.baseCls}-item {parent.baseCls}-year">','<a hidefocus="on" class="{parent.baseCls}-item-inner" role="button" href="#">{.}</a>',"</div>","</tpl>","</div>",'<div class="'+Ext.baseCSSPrefix+'clear"></div>','<tpl if="showButtons">','<div id="{id}-buttonsEl" class="{baseCls}-buttons">{%',"var me=values.$comp, okBtn=me.okBtn, cancelBtn=me.cancelBtn;","okBtn.ownerLayout = cancelBtn.ownerLayout = me.componentLayout;","okBtn.ownerCt = cancelBtn.ownerCt = me;","Ext.DomHelper.generateMarkup(okBtn.getRenderTree(), out);","Ext.DomHelper.generateMarkup(cancelBtn.getRenderTree(), out);","%}</div>","</tpl>","</div>"],okText:"OK",cancelText:"Cancel",baseCls:Ext.baseCSSPrefix+"monthpicker",showButtons:!0,measureWidth:35,measureMaxHeight:20,smallCls:Ext.baseCSSPrefix+"monthpicker-small",totalYears:10,yearOffset:5,monthOffset:6,initComponent:function(){var me=this;me.selectedCls=me.baseCls+"-selected",me.addEvents("cancelclick","monthclick","monthdblclick","okclick","select","yearclick","yeardblclick"),me.small&&me.addCls(me.smallCls),me.setValue(me.value),me.activeYear=me.getYear((new Date).getFullYear()-4,-4),me.showButtons&&(me.okBtn=new Ext.button.Button({text:me.okText,handler:me.onOkClick,scope:me}),me.cancelBtn=new Ext.button.Button({text:me.cancelText,handler:me.onCancelClick,scope:me})),this.callParent()},beforeRender:function(){var me=this,i=0,months=[],shortName=Ext.Date.getShortMonthName,monthLen=me.monthOffset,margin=me.monthMargin,style="";for(me.padding&&!me.width&&me.cacheWidth(),me.callParent();i<monthLen;++i)months.push(shortName(i),shortName(i+monthLen));Ext.isDefined(margin)&&(style="margin: 0 "+margin+"px;"),Ext.apply(me.renderData,{months:months,years:me.getYears(),showButtons:me.showButtons,monthStyle:style})},cacheWidth:function(){var me=this,padding=me.parseBox(me.padding),widthEl=Ext.getBody().createChild({cls:me.baseCls+" "+me.borderBoxCls,style:"position:absolute;top:-1000px;left:-1000px;",html:"&nbsp;"});me.self.prototype.width=widthEl.getWidth()+padding.left+padding.right,widthEl.remove()},afterRender:function(){var me=this,body=me.bodyEl;me.buttonsEl;me.callParent(),me.mon(body,"click",me.onBodyClick,me),me.mon(body,"dblclick",me.onBodyClick,me),me.years=body.select("."+me.baseCls+"-year a"),me.months=body.select("."+me.baseCls+"-month a"),me.backRepeater=new Ext.util.ClickRepeater(me.prevEl,{handler:Ext.Function.bind(me.adjustYear,me,[-me.totalYears])}),me.prevEl.addClsOnOver(me.baseCls+"-yearnav-prev-over"),me.nextRepeater=new Ext.util.ClickRepeater(me.nextEl,{handler:Ext.Function.bind(me.adjustYear,me,[me.totalYears])}),me.nextEl.addClsOnOver(me.baseCls+"-yearnav-next-over"),me.updateBody(),Ext.isDefined(me.monthMargin)||(Ext.picker.Month.prototype.monthMargin=me.calculateMonthMargin())},calculateMonthMargin:function(){for(var me=this,months=(me.monthEl,me.months),first=months.first(),itemMargin=first.getMargin("l");itemMargin&&me.getLargest()>me.measureMaxHeight;)--itemMargin,months.setStyle("margin","0 "+itemMargin+"px");return itemMargin},getLargest:function(months){var largest=0;return this.months.each(function(item){var h=item.getHeight();h>largest&&(largest=h)}),largest},setValue:function(value){var year,me=this,active=me.activeYear;me.monthOffset;return value?Ext.isDate(value)?me.value=[value.getMonth(),value.getFullYear()]:me.value=[value[0],value[1]]:me.value=[null,null],me.rendered&&(year=me.value[1],null!==year&&(year<active||year>active+me.yearOffset)&&(me.activeYear=year-me.yearOffset+1),me.updateBody()),me},getValue:function(){return this.value},hasSelection:function(){var value=this.value;return null!==value[0]&&null!==value[1]},getYears:function(){for(var me=this,offset=me.yearOffset,start=me.activeYear,end=start+offset,i=start,years=[];i<end;++i)years.push(i,i+offset);return years},updateBody:function(){var year,yearItems,y,yLen,el,me=this,years=me.years,months=me.months,yearNumbers=me.getYears(),cls=me.selectedCls,value=me.getYear(null),month=me.value[0],monthOffset=me.monthOffset;if(me.rendered){for(years.removeCls(cls),months.removeCls(cls),yearItems=years.elements,yLen=yearItems.length,y=0;y<yLen;y++)el=Ext.fly(yearItems[y]),year=yearNumbers[y],el.dom.innerHTML=year,year==value&&el.addCls(cls);null!==month&&(month=month<monthOffset?2*month:2*(month-monthOffset)+1,
months.item(month).addCls(cls))}},getYear:function(defaultValue,offset){var year=this.value[1];return offset=offset||0,null===year?defaultValue:year+offset},onBodyClick:function(e,t){var me=this,isDouble="dblclick"==e.type;e.getTarget("."+me.baseCls+"-month")?(e.stopEvent(),me.onMonthClick(t,isDouble)):e.getTarget("."+me.baseCls+"-year")&&(e.stopEvent(),me.onYearClick(t,isDouble))},adjustYear:function(offset){"number"!=typeof offset&&(offset=this.totalYears),this.activeYear+=offset,this.updateBody()},onOkClick:function(){this.fireEvent("okclick",this,this.value)},onCancelClick:function(){this.fireEvent("cancelclick",this)},onMonthClick:function(target,isDouble){var me=this;me.value[0]=me.resolveOffset(me.months.indexOf(target),me.monthOffset),me.updateBody(),me.fireEvent("month"+(isDouble?"dbl":"")+"click",me,me.value),me.fireEvent("select",me,me.value)},onYearClick:function(target,isDouble){var me=this;me.value[1]=me.activeYear+me.resolveOffset(me.years.indexOf(target),me.yearOffset),me.updateBody(),me.fireEvent("year"+(isDouble?"dbl":"")+"click",me,me.value),me.fireEvent("select",me,me.value)},resolveOffset:function(index,offset){return index%2===0?index/2:offset+Math.floor(index/2)},beforeDestroy:function(){var me=this;me.years=me.months=null,Ext.destroyMembers(me,"backRepeater","nextRepeater","okBtn","cancelBtn"),me.callParent()},finishRenderChildren:function(){var me=this;this.callParent(arguments),this.showButtons&&(me.okBtn.finishRender(),me.cancelBtn.finishRender())},onDestroy:function(){Ext.destroyMembers(this,"okBtn","cancelBtn"),this.callParent()}}),Ext.define("Ext.picker.Date",{extend:Ext.Component,alias:"widget.datepicker",alternateClassName:"Ext.DatePicker",childEls:["innerEl","eventEl","prevEl","nextEl","middleBtnEl","footerEl"],border:!0,renderTpl:['<div id="{id}-innerEl" role="grid">','<div role="presentation" class="{baseCls}-header">','<a id="{id}-prevEl" class="{baseCls}-prev {baseCls}-arrow" href="#" role="button" title="{prevText}" hidefocus="on" ></a>','<div class="{baseCls}-month" id="{id}-middleBtnEl">{%this.renderMonthBtn(values, out)%}</div>','<a id="{id}-nextEl" class="{baseCls}-next {baseCls}-arrow" href="#" role="button" title="{nextText}" hidefocus="on" ></a>',"</div>",'<table id="{id}-eventEl" class="{baseCls}-inner" cellspacing="0" role="grid">','<thead role="presentation"><tr role="row">','<tpl for="dayNames">','<th role="columnheader" class="{parent.baseCls}-column-header" title="{.}">','<div class="{parent.baseCls}-column-header-inner">{.:this.firstInitial}</div>',"</th>","</tpl>","</tr></thead>",'<tbody role="presentation"><tr role="row">','<tpl for="days">',"{#:this.isEndOfWeek}",'<td role="gridcell" id="{[Ext.id()]}">','<a role="button" hidefocus="on" class="{parent.baseCls}-date" href="#"></a>',"</td>","</tpl>","</tr></tbody>","</table>",'<tpl if="showToday">','<div id="{id}-footerEl" role="presentation" class="{baseCls}-footer">{%this.renderTodayBtn(values, out)%}</div>',"</tpl>","</div>",{firstInitial:function(value){return Ext.picker.Date.prototype.getDayInitial(value)},isEndOfWeek:function(value){value--;var end=value%7===0&&0!==value;return end?'</tr><tr role="row">':""},renderTodayBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.todayBtn.getRenderTree(),out)},renderMonthBtn:function(values,out){Ext.DomHelper.generateMarkup(values.$comp.monthBtn.getRenderTree(),out)}}],todayText:"Today",ariaTitle:"Date Picker: {0}",ariaTitleDateFormat:"F d, Y",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",disabledDaysText:"Disabled",disabledDatesText:"Disabled",nextText:"Next Month (Control+Right)",prevText:"Previous Month (Control+Left)",monthYearText:"Choose a month (Control+Up/Down to move years)",monthYearFormat:"F Y",startDay:0,showToday:!0,disableAnim:!1,baseCls:Ext.baseCSSPrefix+"datepicker",longDayFormat:"F d, Y",focusOnShow:!1,focusOnSelect:!0,initHour:12,numDays:42,initComponent:function(){var me=this,clearTime=Ext.Date.clearTime;me.selectedCls=me.baseCls+"-selected",me.disabledCellCls=me.baseCls+"-disabled",me.prevCls=me.baseCls+"-prevday",me.activeCls=me.baseCls+"-active",me.cellCls=me.baseCls+"-cell",me.nextCls=me.baseCls+"-prevday",me.todayCls=me.baseCls+"-today",me.format||(me.format=Ext.Date.defaultFormat),me.dayNames||(me.dayNames=Ext.Date.dayNames),me.dayNames=me.dayNames.slice(me.startDay).concat(me.dayNames.slice(0,me.startDay)),me.callParent(),me.value=me.value?clearTime(me.value,!0):clearTime(new Date),me.addEvents("select"),me.initDisabledDays()},beforeRender:function(){var me=this,days=new Array(me.numDays),today=Ext.Date.format(new Date,me.format);me.up("menu")&&me.addCls(Ext.baseCSSPrefix+"menu"),me.padding&&!me.width&&me.cacheWidth(),me.monthBtn=new Ext.button.Split({ownerCt:me,ownerLayout:me.getComponentLayout(),text:"",tooltip:me.monthYearText,listeners:{click:me.doShowMonthPicker,arrowclick:me.doShowMonthPicker,scope:me}}),me.showToday&&(me.todayBtn=new Ext.button.Button({ownerCt:me,ownerLayout:me.getComponentLayout(),text:Ext.String.format(me.todayText,today),tooltip:Ext.String.format(me.todayTip,today),tooltipType:"title",handler:me.selectToday,scope:me})),me.callParent(),Ext.applyIf(me,{renderData:{}}),Ext.apply(me.renderData,{dayNames:me.dayNames,showToday:me.showToday,prevText:me.prevText,nextText:me.nextText,days:days}),me.protoEl.unselectable()},cacheWidth:function(){var me=this,padding=me.parseBox(me.padding),widthEl=Ext.getBody().createChild({cls:me.baseCls+" "+me.borderBoxCls,style:"position:absolute;top:-1000px;left:-1000px;"});me.self.prototype.width=widthEl.getWidth()+padding.left+padding.right,widthEl.remove()},finishRenderChildren:function(){var me=this;me.callParent(),me.monthBtn.finishRender(),me.showToday&&me.todayBtn.finishRender()},onRender:function(container,position){var me=this;me.callParent(arguments),me.cells=me.eventEl.select("tbody td"),me.textNodes=me.eventEl.query("tbody td a"),me.mon(me.eventEl,{scope:me,mousewheel:me.handleMouseWheel,click:{fn:me.handleDateClick,delegate:"a."+me.baseCls+"-date"}})},initEvents:function(){var me=this,eDate=Ext.Date,day=eDate.DAY;me.callParent(),me.prevRepeater=new Ext.util.ClickRepeater(me.prevEl,{handler:me.showPrevMonth,scope:me,preventDefault:!0,stopDefault:!0}),me.nextRepeater=new Ext.util.ClickRepeater(me.nextEl,{handler:me.showNextMonth,scope:me,preventDefault:!0,stopDefault:!0}),me.keyNav=new Ext.util.KeyNav(me.eventEl,Ext.apply({scope:me,left:function(e){e.ctrlKey?me.showPrevMonth():me.update(eDate.add(me.activeDate,day,-1))},right:function(e){e.ctrlKey?me.showNextMonth():me.update(eDate.add(me.activeDate,day,1))},up:function(e){e.ctrlKey?me.showNextYear():me.update(eDate.add(me.activeDate,day,-7))},down:function(e){e.ctrlKey?me.showPrevYear():me.update(eDate.add(me.activeDate,day,7))},pageUp:function(e){e.altKey?me.showPrevYear():me.showPrevMonth()},pageDown:function(e){e.altKey?me.showNextYear():me.showNextMonth()},tab:function(e){return me.doCancelFieldFocus=!0,me.handleTabClick(e),delete me.doCancelFieldFocus,!0},enter:function(e){return e.stopPropagation(),!0},home:function(e){me.update(eDate.getFirstDateOfMonth(me.activeDate))},end:function(e){me.update(eDate.getLastDateOfMonth(me.activeDate))}},me.keyNavConfig)),me.showToday&&(me.todayKeyListener=me.eventEl.addKeyListener(Ext.EventObject.SPACE,me.selectToday,me)),me.update(me.value)},handleTabClick:function(e){var me=this,t=me.getSelectedDate(me.activeDate),handler=me.handler;me.disabled||!t.dateValue||Ext.fly(t.parentNode).hasCls(me.disabledCellCls)||(me.doCancelFocus=me.focusOnSelect===!1,me.setValue(new Date(t.dateValue)),delete me.doCancelFocus,me.fireEvent("select",me,me.value),handler&&handler.call(me.scope||me,me,me.value),me.onSelect())},getSelectedDate:function(date){var c,cell,me=this,t=date.getTime(),cells=me.cells,cls=me.selectedCls,cellItems=cells.elements,cLen=cellItems.length;for(cells.removeCls(cls),c=0;c<cLen;c++)if(cell=Ext.fly(cellItems[c]),cell.dom.firstChild.dateValue==t)return cell.dom.firstChild;return null},initDisabledDays:function(){var len,d,dLen,dI,me=this,dd=me.disabledDates,re="(?:";if(!me.disabledDatesRE&&dd){for(len=dd.length-1,dLen=dd.length,d=0;d<dLen;d++)dI=dd[d],re+=Ext.isDate(dI)?"^"+Ext.String.escapeRegex(Ext.Date.dateFormat(dI,me.format))+"$":dI,d!=len&&(re+="|");me.disabledDatesRE=new RegExp(re+")")}},setDisabledDates:function(dd){var me=this;return Ext.isArray(dd)?(me.disabledDates=dd,me.disabledDatesRE=null):me.disabledDatesRE=dd,me.initDisabledDays(),me.update(me.value,!0),me},setDisabledDays:function(dd){return this.disabledDays=dd,this.update(this.value,!0)},setMinDate:function(dt){return this.minDate=dt,this.update(this.value,!0)},setMaxDate:function(dt){return this.maxDate=dt,this.update(this.value,!0)},setValue:function(value){return this.value=Ext.Date.clearTime(value,!0),this.update(this.value)},getValue:function(){return this.value},getDayInitial:function(value){return value.substr(0,1)},focus:function(){this.update(this.activeDate)},onEnable:function(){this.callParent(),this.setDisabledStatus(!1),this.update(this.activeDate)},onDisable:function(){this.callParent(),this.setDisabledStatus(!0)},setDisabledStatus:function(disabled){var me=this;me.keyNav.setDisabled(disabled),me.prevRepeater.setDisabled(disabled),me.nextRepeater.setDisabled(disabled),me.showToday&&(me.todayKeyListener.setDisabled(disabled),me.todayBtn.setDisabled(disabled))},getActive:function(){return this.activeDate||this.value},runAnimation:function(isHide){var picker=this.monthPicker,options={duration:200,callback:function(){isHide?picker.hide():picker.show()}};isHide?picker.el.slideOut("t",options):picker.el.slideIn("t",options)},hideMonthPicker:function(animate){var me=this,picker=me.monthPicker;return picker&&(me.shouldAnimate(animate)?me.runAnimation(!0):picker.hide()),me},doShowMonthPicker:function(){this.showMonthPicker()},showMonthPicker:function(animate){var picker,me=this,el=me.el;return me.rendered&&!me.disabled&&(picker=me.createMonthPicker(),picker.setValue(me.getActive()),picker.setSize(el.getSize()),picker.setPosition(-el.getBorderWidth("l"),-el.getBorderWidth("t")),me.shouldAnimate(animate)?me.runAnimation(!1):picker.show()),me},shouldAnimate:function(animate){return Ext.isDefined(animate)?animate:!this.disableAnim},createMonthPicker:function(){var me=this,picker=me.monthPicker;return picker||(me.monthPicker=picker=new Ext.picker.Month({renderTo:me.el,floating:!0,padding:me.padding,shadow:!1,small:me.showToday===!1,listeners:{scope:me,cancelclick:me.onCancelClick,okclick:me.onOkClick,yeardblclick:me.onOkClick,monthdblclick:me.onOkClick}}),me.disableAnim||picker.el.setStyle("display","none"),me.on("beforehide",Ext.Function.bind(me.hideMonthPicker,me,[!1]))),picker},onOkClick:function(picker,value){var me=this,month=value[0],year=value[1],date=new Date(year,month,me.getActive().getDate());date.getMonth()!==month&&(date=Ext.Date.getLastDateOfMonth(new Date(year,month,1))),me.setValue(date),me.hideMonthPicker()},onCancelClick:function(){this.selectedUpdate(this.activeDate),this.hideMonthPicker()},showPrevMonth:function(e){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1))},showNextMonth:function(e){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.MONTH,1))},showPrevYear:function(){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.YEAR,-1))},showNextYear:function(){return this.setValue(Ext.Date.add(this.activeDate,Ext.Date.YEAR,1))},handleMouseWheel:function(e){if(e.stopEvent(),!this.disabled){var delta=e.getWheelDelta();delta>0?this.showPrevMonth():delta<0&&this.showNextMonth()}},handleDateClick:function(e,t){var me=this,handler=me.handler;e.stopEvent(),me.disabled||!t.dateValue||Ext.fly(t.parentNode).hasCls(me.disabledCellCls)||(me.doCancelFocus=me.focusOnSelect===!1,me.setValue(new Date(t.dateValue)),delete me.doCancelFocus,me.fireEvent("select",me,me.value),handler&&handler.call(me.scope||me,me,me.value),me.onSelect())},onSelect:function(){this.hideOnSelect&&this.hide()},selectToday:function(){var me=this,btn=me.todayBtn,handler=me.handler;return btn&&!btn.disabled&&(me.setValue(Ext.Date.clearTime(new Date)),me.fireEvent("select",me,me.value),handler&&handler.call(me.scope||me,me,me.value),me.onSelect()),me},selectedUpdate:function(date){var c,cell,me=this,t=date.getTime(),cells=me.cells,cls=me.selectedCls,cellItems=cells.elements,cLen=cellItems.length;for(cells.removeCls(cls),c=0;c<cLen;c++)if(cell=Ext.fly(cellItems[c]),cell.dom.firstChild.dateValue==t){me.fireEvent("highlightitem",me,cell),cell.addCls(cls),me.isVisible()&&!me.doCancelFocus&&Ext.fly(cell.dom.firstChild).focus(50);break}},fullUpdate:function(date){var prevStart,current,disableToday,tempDate,setCellClass,html,cls,formatValue,value,me=this,cells=me.cells.elements,textNodes=me.textNodes,disabledCls=me.disabledCellCls,eDate=Ext.Date,i=0,extraDays=0,visible=me.isVisible(),newDate=+eDate.clearTime(date,!0),today=+eDate.clearTime(new Date),min=me.minDate?eDate.clearTime(me.minDate,!0):Number.NEGATIVE_INFINITY,max=me.maxDate?eDate.clearTime(me.maxDate,!0):Number.POSITIVE_INFINITY,ddMatch=me.disabledDatesRE,ddText=me.disabledDatesText,ddays=!!me.disabledDays&&me.disabledDays.join(""),ddaysText=me.disabledDaysText,format=me.format,days=eDate.getDaysInMonth(date),firstOfMonth=eDate.getFirstDateOfMonth(date),startingPos=firstOfMonth.getDay()-me.startDay,previousMonth=eDate.add(date,eDate.MONTH,-1),longDayFormat=me.longDayFormat;for(startingPos<0&&(startingPos+=7),days+=startingPos,prevStart=eDate.getDaysInMonth(previousMonth)-startingPos,current=new Date(previousMonth.getFullYear(),previousMonth.getMonth(),prevStart,me.initHour),me.showToday&&(tempDate=eDate.clearTime(new Date),disableToday=tempDate<min||tempDate>max||ddMatch&&format&&ddMatch.test(eDate.dateFormat(tempDate,format))||ddays&&ddays.indexOf(tempDate.getDay())!=-1,me.disabled||(me.todayBtn.setDisabled(disableToday),me.todayKeyListener.setDisabled(disableToday))),setCellClass=function(cell,cls){value=+eDate.clearTime(current,!0),cell.title=eDate.format(current,longDayFormat),cell.firstChild.dateValue=value,value==today&&(cls+=" "+me.todayCls,cell.title=me.todayText,me.todayElSpan=Ext.DomHelper.append(cell.firstChild,{tag:"span",cls:Ext.baseCSSPrefix+"hide-clip",html:me.todayText},!0)),value==newDate&&(cls+=" "+me.selectedCls,me.fireEvent("highlightitem",me,cell),visible&&me.floating&&Ext.fly(cell.firstChild).focus(50)),value<min?(cls+=" "+disabledCls,cell.title=me.minText):value>max?(cls+=" "+disabledCls,cell.title=me.maxText):ddays&&ddays.indexOf(current.getDay())!==-1?(cell.title=ddaysText,cls+=" "+disabledCls):ddMatch&&format&&(formatValue=eDate.dateFormat(current,format),ddMatch.test(formatValue)&&(cell.title=ddText.replace("%0",formatValue),cls+=" "+disabledCls)),cell.className=cls+" "+me.cellCls};i<me.numDays;++i)i<startingPos?(html=++prevStart,cls=me.prevCls):i>=days?(html=++extraDays,cls=me.nextCls):(html=i-startingPos+1,cls=me.activeCls),textNodes[i].innerHTML=html,current.setDate(current.getDate()+1),setCellClass(cells[i],cls);me.monthBtn.setText(Ext.Date.format(date,me.monthYearFormat))},update:function(date,forceRefresh){var me=this,active=me.activeDate;return me.rendered&&(me.activeDate=date,!forceRefresh&&active&&me.el&&active.getMonth()==date.getMonth()&&active.getFullYear()==date.getFullYear()?me.selectedUpdate(date,active):me.fullUpdate(date,active)),me},beforeDestroy:function(){var me=this;me.rendered&&(Ext.destroy(me.todayKeyListener,me.keyNav,me.monthPicker,me.monthBtn,me.nextRepeater,me.prevRepeater,me.todayBtn),delete me.textNodes,delete me.cells.elements),me.callParent()},onShow:function(){this.callParent(arguments),this.focusOnShow&&this.focus()}}),Ext.define("Ext.form.field.Date",{extend:Ext.form.field.Picker,alias:"widget.datefield",alternateClassName:["Ext.form.DateField","Ext.form.Date"],format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",showToday:!0,useStrict:void 0,initTime:"12",initTimeFormat:"H",matchFieldWidth:!1,startDay:0,initComponent:function(){var min,max,me=this,isString=Ext.isString;min=me.minValue,max=me.maxValue,isString(min)&&(me.minValue=me.parseDate(min)),isString(max)&&(me.maxValue=me.parseDate(max)),me.disabledDatesRE=null,me.initDisabledDays(),me.callParent()},initValue:function(){var me=this,value=me.value;Ext.isString(value)&&(me.value=me.rawToValue(value)),me.callParent()},initDisabledDays:function(){if(this.disabledDates){var d,date,dd=this.disabledDates,len=dd.length-1,re="(?:",dLen=dd.length;for(d=0;d<dLen;d++)date=dd[d],re+=Ext.isDate(date)?"^"+Ext.String.escapeRegex(date.dateFormat(this.format))+"$":date,d!==len&&(re+="|");this.disabledDatesRE=new RegExp(re+")")}},setDisabledDates:function(dd){var me=this,picker=me.picker;me.disabledDates=dd,me.initDisabledDays(),picker&&picker.setDisabledDates(me.disabledDatesRE)},setDisabledDays:function(dd){var picker=this.picker;this.disabledDays=dd,picker&&picker.setDisabledDays(dd)},setMinValue:function(dt){var me=this,picker=me.picker,minValue=Ext.isString(dt)?me.parseDate(dt):dt;me.minValue=minValue,picker&&(picker.minText=Ext.String.format(me.minText,me.formatDate(me.minValue)),picker.setMinDate(minValue))},setMaxValue:function(dt){var me=this,picker=me.picker,maxValue=Ext.isString(dt)?me.parseDate(dt):dt;me.maxValue=maxValue,picker&&(picker.maxText=Ext.String.format(me.maxText,me.formatDate(me.maxValue)),picker.setMaxDate(maxValue))},getErrors:function(value){var svalue,fvalue,day,time,me=this,format=Ext.String.format,clearTime=Ext.Date.clearTime,errors=me.callParent(arguments),disabledDays=me.disabledDays,disabledDatesRE=me.disabledDatesRE,minValue=me.minValue,maxValue=me.maxValue,len=disabledDays?disabledDays.length:0,i=0;if(value=me.formatDate(value||me.processRawValue(me.getRawValue())),null===value||value.length<1)return errors;if(svalue=value,value=me.parseDate(value),!value)return errors.push(format(me.invalidText,svalue,Ext.Date.unescapeFormat(me.format))),errors;if(time=value.getTime(),minValue&&time<clearTime(minValue).getTime()&&errors.push(format(me.minText,me.formatDate(minValue))),maxValue&&time>clearTime(maxValue).getTime()&&errors.push(format(me.maxText,me.formatDate(maxValue))),disabledDays)for(day=value.getDay();i<len;i++)if(day===disabledDays[i]){errors.push(me.disabledDaysText);break}return fvalue=me.formatDate(value),disabledDatesRE&&disabledDatesRE.test(fvalue)&&errors.push(format(me.disabledDatesText,fvalue)),errors},rawToValue:function(rawValue){return this.parseDate(rawValue)||rawValue||null},valueToRaw:function(value){return this.formatDate(this.parseDate(value))},safeParse:function(value,format){var parsedDate,me=this,utilDate=Ext.Date,result=null,strict=me.useStrict;return utilDate.formatContainsHourInfo(format)?result=utilDate.parse(value,format,strict):(parsedDate=utilDate.parse(value+" "+me.initTime,format+" "+me.initTimeFormat,strict),parsedDate&&(result=utilDate.clearTime(parsedDate))),result},getSubmitValue:function(){var format=this.submitFormat||this.format,value=this.getValue();return value?Ext.Date.format(value,format):""},parseDate:function(value){if(!value||Ext.isDate(value))return value;var len,me=this,val=me.safeParse(value,me.format),altFormats=me.altFormats,altFormatsArray=me.altFormatsArray,i=0;if(!val&&altFormats)for(altFormatsArray=altFormatsArray||altFormats.split("|"),len=altFormatsArray.length;i<len&&!val;++i)val=me.safeParse(value,altFormatsArray[i]);return val},formatDate:function(date){return Ext.isDate(date)?Ext.Date.dateFormat(date,this.format):date},createPicker:function(){var me=this,format=Ext.String.format;return new Ext.picker.Date({pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,minDate:me.minValue,maxDate:me.maxValue,disabledDatesRE:me.disabledDatesRE,disabledDatesText:me.disabledDatesText,disabledDays:me.disabledDays,disabledDaysText:me.disabledDaysText,format:me.format,showToday:me.showToday,startDay:me.startDay,minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),listeners:{scope:me,select:me.onSelect},keyNavConfig:{esc:function(){me.collapse()}}})},onDownArrow:function(e){this.callParent(arguments),this.isExpanded&&this.getPicker().focus()},onSelect:function(m,d){var me=this;me.setValue(d),me.fireEvent("select",me,d),me.collapse()},onExpand:function(){var value=this.getValue();this.picker.setValue(Ext.isDate(value)?value:new Date)},onCollapse:function(){this.focus(!1,60)},beforeBlur:function(){var me=this,v=me.parseDate(me.getRawValue()),focusTask=me.focusTask;focusTask&&focusTask.cancel(),v&&me.setValue(v)}}),Ext.define("Ext.form.field.FileButton",{extend:Ext.button.Button,alias:"widget.filebutton",childEls:["btnEl","btnWrap","btnInnerEl","btnIconEl","fileInputEl"],inputCls:Ext.baseCSSPrefix+"form-file-input",cls:Ext.baseCSSPrefix+"form-file-btn",preventDefault:!1,renderTpl:['<span id="{id}-btnWrap" role="presentation" class="{baseCls}-wrap','<tpl if="splitCls"> {splitCls}</tpl>','{childElCls}" unselectable="on">','<span id="{id}-btnEl" class="{baseCls}-button" role="button">','<span id="{id}-btnInnerEl" class="{baseCls}-inner {innerCls}','{childElCls}" unselectable="on">',"{text}","</span>",'<span role="presentation" id="{id}-btnIconEl" class="{baseCls}-icon-el {iconCls}','{childElCls} {glyphCls}" unselectable="on" style="','<tpl if="iconUrl">background-image:url({iconUrl});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl><tpl if="iconCls || iconUrl">&#160;</tpl>',"</span>","</span>","</span>",'<input id="{id}-fileInputEl" class="{childElCls} {inputCls}" type="file" size="1" name="{inputName}" role="{role}">'],getTemplateArgs:function(){var args=this.callParent();return args.inputCls=this.inputCls,args.inputName=this.inputName,args},afterRender:function(){var me=this;me.callParent(arguments),me.fileInputEl.on("change",me.fireChange,me)},fireChange:function(e){this.fireEvent("change",this,e,this.fileInputEl.dom.value)},createFileInput:function(isTemporary){var me=this;me.fileInputEl=me.el.createChild({name:me.inputName,id:isTemporary?void 0:me.id+"-fileInputEl",cls:me.inputCls,tag:"input",type:"file",size:1}),me.fileInputEl.on("change",me.fireChange,me)},reset:function(remove){remove&&this.fileInputEl.remove(),this.createFileInput(!remove)},restoreInput:function(el){this.fileInputEl.remove(),el=Ext.get(el),this.el.appendChild(el),this.fileInputEl=el},onDisable:function(){this.callParent(),this.fileInputEl.dom.disabled=!0},onEnable:function(){this.callParent(),this.fileInputEl.dom.disabled=!1}}),Ext.define("Ext.form.field.File",{extend:Ext.form.field.Trigger,alias:["widget.filefield","widget.fileuploadfield"],alternateClassName:["Ext.form.FileUploadField","Ext.ux.form.FileUploadField","Ext.form.File"],buttonText:"Browse...",buttonOnly:!1,buttonMargin:3,clearOnSubmit:!0,extraFieldBodyCls:Ext.baseCSSPrefix+"form-file-wrap",readOnly:!0,submitValue:!1,triggerNoEditCls:"",componentLayout:"triggerfield",childEls:["browseButtonWrap"],onRender:function(){var inputEl,me=this,id=me.id;me.callParent(arguments),inputEl=me.inputEl,inputEl.dom.name="",me.button=new Ext.form.field.FileButton(Ext.apply({renderTo:id+"-browseButtonWrap",ownerCt:me,ownerLayout:me.componentLayout,id:id+"-button",ui:me.ui,disabled:me.disabled,text:me.buttonText,style:me.buttonOnly?"":me.getButtonMarginProp()+me.buttonMargin+"px",inputName:me.getName(),listeners:{scope:me,change:me.onFileChange}},me.buttonConfig)),me.fileInputEl=me.button.fileInputEl,me.buttonOnly&&me.inputCell.setDisplayed(!1),me.browseButtonWrap.dom.style.width=me.browseButtonWrap.dom.lastChild.offsetWidth+me.button.getEl().getMargin("lr")+"px",Ext.isIE&&me.button.getEl().repaint()},getTriggerMarkup:function(){return'<td id="'+this.id+'-browseButtonWrap" role="presentation"></td>'},onFileChange:function(button,e,value){this.duringFileSelect=!0,Ext.form.field.File.superclass.setValue.call(this,value),delete this.duringFileSelect},didValueChange:function(){return!!this.duringFileSelect},setValue:Ext.emptyFn,reset:function(){var me=this,clear=me.clearOnSubmit;me.rendered&&(me.button.reset(clear),me.fileInputEl=me.button.fileInputEl,clear&&(me.inputEl.dom.value="",Ext.form.field.File.superclass.setValue.call(this,null))),me.callParent()},onShow:function(){this.callParent(),this.button.updateLayout()},onDisable:function(){this.callParent(),this.button.disable()},onEnable:function(){this.callParent(),this.button.enable()},isFileUpload:function(){return!0},extractFileInput:function(){var fileInput,me=this;return me.rendered?(fileInput=me.button.fileInputEl.dom,me.reset()):(fileInput=document.createElement("input"),fileInput.type="file",fileInput.className=Ext.baseCSSPrefix+"hide-display",fileInput.name=me.getName()),fileInput},restoreInput:function(el){if(this.rendered){var button=this.button;button.restoreInput(el),this.fileInputEl=button.fileInputEl}},onDestroy:function(){Ext.destroyMembers(this,"button"),delete this.fileInputEl,this.callParent()},getButtonMarginProp:function(){return"margin-left:"}}),Ext.define("Ext.form.field.Hidden",{extend:Ext.form.field.Base,alias:["widget.hiddenfield","widget.hidden"],alternateClassName:"Ext.form.Hidden",inputType:"hidden",hideLabel:!0,hidden:!0,ariaRole:"presentation",initComponent:function(){this.formItemCls+="-hidden",this.callParent()},isEqual:function(value1,value2){return this.isEqualAsString(value1,value2)},initEvents:Ext.emptyFn,setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn,markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn}),Ext.define("Ext.picker.Color",{extend:Ext.Component,alias:"widget.colorpicker",alternateClassName:"Ext.ColorPalette",componentCls:Ext.baseCSSPrefix+"color-picker",selectedCls:Ext.baseCSSPrefix+"color-picker-selected",itemCls:Ext.baseCSSPrefix+"color-picker-item",value:null,clickEvent:"click",allowReselect:!1,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,renderTpl:['<tpl for="colors">','<a href="#" role="button" class="color-{.} {parent.itemCls}" hidefocus="on">','<span class="{parent.itemCls}-inner" style="background:#{.}">&#160;</span>',"</a>","</tpl>"],initComponent:function(){var me=this;me.callParent(arguments),me.addEvents("select"),me.handler&&me.on("select",me.handler,me.scope,!0)},initRenderData:function(){var me=this;return Ext.apply(me.callParent(),{itemCls:me.itemCls,colors:me.colors})},onRender:function(){var me=this,clickEvent=me.clickEvent;me.callParent(arguments),me.mon(me.el,clickEvent,me.handleClick,me,{delegate:"a"}),"click"!=clickEvent&&me.mon(me.el,"click",Ext.emptyFn,me,{delegate:"a",stopEvent:!0})},afterRender:function(){var value,me=this;me.callParent(arguments),me.value&&(value=me.value,me.value=null,me.select(value,!0))},handleClick:function(event,target){var color,me=this;event.stopEvent(),me.disabled||(color=target.className.match(me.colorRe)[1],me.select(color.toUpperCase()))},select:function(color,suppressEvent){var el,me=this,selectedCls=me.selectedCls,value=me.value;return color=color.replace("#",""),me.rendered?void((color!=value||me.allowReselect)&&(el=me.el,me.value&&el.down("a.color-"+value).removeCls(selectedCls),el.down("a.color-"+color).addCls(selectedCls),me.value=color,suppressEvent!==!0&&me.fireEvent("select",me,color))):void(me.value=color)},clear:function(){var el,me=this,value=me.value;value&&me.rendered&&(el=me.el.down("a.color-"+value),el.removeCls(me.selectedCls)),me.value=null},getValue:function(){return this.value||null}}),Ext.define("Ext.layout.component.field.HtmlEditor",{extend:Ext.layout.component.field.FieldContainer,alias:["layout.htmleditor"],type:"htmleditor",naturalHeight:150,naturalWidth:300,beginLayout:function(ownerContext){var dom,owner=this.owner;Ext.isGecko&&(dom=owner.textareaEl.dom,this.lastValue=dom.value,dom.value=""),this.callParent(arguments),ownerContext.toolbarContext=ownerContext.context.getCmp(owner.toolbar),ownerContext.inputCmpContext=ownerContext.context.getCmp(owner.inputCmp),ownerContext.textAreaContext=ownerContext.getEl("textareaEl"),ownerContext.iframeContext=ownerContext.getEl("iframeEl")},beginLayoutCycle:function(ownerContext){var me=this,widthModel=ownerContext.widthModel,heightModel=ownerContext.heightModel,owner=me.owner,iframeEl=owner.iframeEl,textareaEl=owner.textareaEl;me.callParent(arguments),widthModel.shrinkWrap?(iframeEl.setStyle("width",""),textareaEl.setStyle("width","")):widthModel.natural&&ownerContext.bodyCellContext.setWidth(me.naturalWidth),(heightModel.natural||heightModel.shrinkWrap)&&(iframeEl.setHeight(me.naturalHeight),textareaEl.setHeight(me.naturalHeight))},finishedLayout:function(){var owner=this.owner;this.callParent(arguments),Ext.isIE9m&&Ext.isIEQuirks&&owner.el.repaint(),Ext.isGecko&&(owner.textareaEl.dom.value=this.lastValue)},publishOwnerWidth:function(ownerContext,width){this.callParent(arguments),width-=ownerContext.inputCmpContext.getBorderInfo().width,ownerContext.textAreaContext.setWidth(width),ownerContext.iframeContext.setWidth(width)},publishInnerWidth:function(ownerContext,width){var border=ownerContext.inputCmpContext.getBorderInfo().width,ieBug=Ext.isStrict&&Ext.isIE8m,natural=ownerContext.widthModel.natural;this.callParent(arguments),width=ownerContext.bodyCellContext.props.width-border,natural?(ieBug&&(width-=2),ownerContext.textAreaContext.setWidth(width),ownerContext.iframeContext.setWidth(width)):ieBug&&ownerContext.textAreaContext.setWidth(width)},publishInnerHeight:function(ownerContext,height){var toolbarHeight=ownerContext.toolbarContext.getProp("height");this.owner.sourceEditMode;this.callParent(arguments),height=ownerContext.bodyCellContext.props.height,void 0!==toolbarHeight?(height-=toolbarHeight+ownerContext.inputCmpContext.getFrameInfo().height,Ext.isIE8&&Ext.isStrict?height-=2:Ext.isIEQuirks&&(Ext.isIE8||Ext.isIE9)&&(height-=4),ownerContext.iframeContext.setHeight(height),ownerContext.textAreaContext.setHeight(height)):this.done=!1}}),Ext.define("Ext.form.field.HtmlEditor",{extend:Ext.form.FieldContainer,mixins:{field:Ext.form.field.Field},alias:"widget.htmleditor",alternateClassName:"Ext.form.HtmlEditor",componentLayout:"htmleditor",componentTpl:["{beforeTextAreaTpl}",'<textarea id="{id}-textareaEl" name="{name}" tabIndex="-1" {inputAttrTpl}',' class="{textareaCls}" autocomplete="off">',"{[Ext.util.Format.htmlEncode(values.value)]}","</textarea>","{afterTextAreaTpl}","{beforeIFrameTpl}",'<iframe id="{id}-iframeEl" name="{iframeName}" frameBorder="0" {iframeAttrTpl}',' src="{iframeSrc}" class="{iframeCls}"></iframe>',"{afterIFrameTpl}",{disableFormats:!0}],stretchInputElFixed:!0,subTplInsertions:["beforeTextAreaTpl","afterTextAreaTpl","beforeIFrameTpl","afterIFrameTpl","iframeAttrTpl","inputAttrTpl"],enableFormat:!0,enableFontSize:!0,enableColors:!0,enableAlignments:!0,enableLists:!0,enableSourceEdit:!0,enableLinks:!0,enableFont:!0,createLinkText:"Please enter the URL for the link:",defaultLinkValue:"http://",fontFamilies:["Arial","Courier New","Tahoma","Times New Roman","Verdana"],defaultValue:Ext.isOpera||Ext.isIE6?"&#160;":"&#8203;",extraFieldBodyCls:Ext.baseCSSPrefix+"html-editor-wrap",initialized:!1,activated:!1,sourceEditMode:!1,iframePad:3,hideMode:"offsets",maskOnDisable:!0,
containerElCls:Ext.baseCSSPrefix+"html-editor-container",reStripQuotes:/^['"]*|['"]*$/g,initComponent:function(){var me=this;me.addEvents("initialize","activate","beforesync","beforepush","sync","push","editmodechange"),me.items=[me.createToolbar(),me.createInputCmp()],me.layout={type:"vbox",align:"stretch"},me.callParent(arguments),me.initField()},createInputCmp:function(){return this.inputCmp=Ext.widget(this.getInputCmpCfg()),this.inputCmp},getInputCmpCfg:function(){var me=this,id=me.id+"-inputCmp",data={id:id,name:me.name,textareaCls:Ext.baseCSSPrefix+"hidden",value:me.value,iframeName:Ext.id(),iframeSrc:Ext.SSL_SECURE_URL,iframeCls:Ext.baseCSSPrefix+"htmleditor-iframe"};return me.getInsertionRenderData(data,me.subTplInsertions),{flex:1,xtype:"component",tpl:me.getTpl("componentTpl"),childEls:["iframeEl","textareaEl"],id:id,cls:Ext.baseCSSPrefix+"html-editor-input",data:data}},createToolbar:function(){return this.toolbar=Ext.widget(this.getToolbarCfg()),this.toolbar},getToolbarCfg:function(){function btn(id,toggle,handler){return{itemId:id,cls:baseCSSPrefix+"btn-icon",iconCls:baseCSSPrefix+"edit-"+id,enableToggle:toggle!==!1,scope:me,handler:handler||me.relayBtnCmd,clickEvent:"mousedown",tooltip:tipsEnabled?me.buttonTips[id]||undef:undef,overflowText:me.buttonTips[id].title||undef,tabIndex:-1}}var i,fontSelectItem,undef,me=this,items=[],tipsEnabled=Ext.quickTipsActive&&Ext.tip.QuickTipManager.isEnabled(),baseCSSPrefix=Ext.baseCSSPrefix;for(me.enableFont&&!Ext.isSafari2&&(fontSelectItem=Ext.widget("component",{itemId:"fontSelect",renderTpl:['<select id="{id}-selectEl" class="'+baseCSSPrefix+'font-select">',"</select>"],childEls:["selectEl"],afterRender:function(){me.fontSelect=this.selectEl,Ext.Component.prototype.afterRender.apply(this,arguments)},onDisable:function(){var selectEl=this.selectEl;selectEl&&(selectEl.dom.disabled=!0),Ext.Component.prototype.onDisable.apply(this,arguments)},onEnable:function(){var selectEl=this.selectEl;selectEl&&(selectEl.dom.disabled=!1),Ext.Component.prototype.onEnable.apply(this,arguments)},listeners:{change:function(){me.win.focus(),me.relayCmd("fontName",me.fontSelect.dom.value),me.deferFocus()},element:"selectEl"}}),items.push(fontSelectItem,"-")),me.enableFormat&&items.push(btn("bold"),btn("italic"),btn("underline")),me.enableFontSize&&items.push("-",btn("increasefontsize",!1,me.adjustFont),btn("decreasefontsize",!1,me.adjustFont)),me.enableColors&&items.push("-",{itemId:"forecolor",cls:baseCSSPrefix+"btn-icon",iconCls:baseCSSPrefix+"edit-forecolor",overflowText:me.buttonTips.forecolor.title,tooltip:tipsEnabled?me.buttonTips.forecolor||undef:undef,tabIndex:-1,menu:Ext.widget("menu",{plain:!0,items:[{xtype:"colorpicker",allowReselect:!0,focus:Ext.emptyFn,value:"000000",plain:!0,clickEvent:"mousedown",handler:function(cp,color){me.relayCmd("forecolor",Ext.isWebKit||Ext.isIE?"#"+color:color),this.up("menu").hide()}}]})},{itemId:"backcolor",cls:baseCSSPrefix+"btn-icon",iconCls:baseCSSPrefix+"edit-backcolor",overflowText:me.buttonTips.backcolor.title,tooltip:tipsEnabled?me.buttonTips.backcolor||undef:undef,tabIndex:-1,menu:Ext.widget("menu",{plain:!0,items:[{xtype:"colorpicker",focus:Ext.emptyFn,value:"FFFFFF",plain:!0,allowReselect:!0,clickEvent:"mousedown",handler:function(cp,color){Ext.isGecko?(me.execCmd("useCSS",!1),me.execCmd("hilitecolor","#"+color),me.execCmd("useCSS",!0),me.deferFocus()):me.relayCmd(Ext.isOpera?"hilitecolor":"backcolor",Ext.isWebKit||Ext.isIE||Ext.isOpera?"#"+color:color),this.up("menu").hide()}}]})}),me.enableAlignments&&items.push("-",btn("justifyleft"),btn("justifycenter"),btn("justifyright")),Ext.isSafari2||(me.enableLinks&&items.push("-",btn("createlink",!1,me.createLink)),me.enableLists&&items.push("-",btn("insertorderedlist"),btn("insertunorderedlist")),me.enableSourceEdit&&items.push("-",btn("sourceedit",!0,function(btn){me.toggleSourceEdit(!me.sourceEditMode)}))),i=0;i<items.length;i++)"sourceedit"!==items[i].itemId&&(items[i].disabled=!0);return{xtype:"toolbar",defaultButtonUI:me.defaultButtonUI,cls:Ext.baseCSSPrefix+"html-editor-tb",enableOverflow:!0,items:items,listeners:{click:function(e){e.preventDefault()},element:"el"}}},getMaskTarget:function(){return Ext.isGecko?this.inputCmp.el:this.bodyEl},setReadOnly:function(readOnly){var body,me=this,textareaEl=me.textareaEl,iframeEl=me.iframeEl;me.readOnly=readOnly,textareaEl&&(textareaEl.dom.readOnly=readOnly),me.initialized&&(body=me.getEditorBody(),Ext.isIE?(iframeEl.setDisplayed(!1),body.contentEditable=!readOnly,iframeEl.setDisplayed(!0)):me.setDesignMode(!readOnly),body&&(body.style.cursor=readOnly?"default":"text"),me.disableItems(readOnly))},getDocMarkup:function(){var me=this,h=me.iframeEl.getHeight()-2*me.iframePad,oldIE=Ext.isIE8m;return Ext.String.format((oldIE?"":"<!DOCTYPE html>")+'<html><head><style type="text/css">'+(Ext.isOpera?"p{margin:0}":"")+"body{border:0;margin:0;padding:{0}px;direction:"+(me.rtl?"rtl;":"ltr;")+(oldIE?Ext.emptyString:"min-")+"height:{1}px;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;cursor:text;background-color:white;"+(Ext.isIE?"":"font-size:12px;font-family:{2}")+"}</style></head><body></body></html>",me.iframePad,h,me.defaultFont)},getEditorBody:function(){var doc=this.getDoc();return doc.body||doc.documentElement},getDoc:function(){return this.iframeEl.dom.contentDocument||this.getWin().document},getWin:function(){return this.iframeEl.dom.contentWindow||window.frames[this.iframeEl.dom.name]},initDefaultFont:function(){var fonts,font,select,option,i,len,lower,me=this,selIdx=0;if(!me.defaultFont){for(font=me.textareaEl.getStyle("font-family"),font=Ext.String.capitalize(font.split(",")[0]),fonts=Ext.Array.clone(me.fontFamilies),Ext.Array.include(fonts,font),fonts.sort(),me.defaultFont=font,select=me.down("#fontSelect").selectEl.dom,i=0,len=fonts.length;i<len;++i)font=fonts[i],lower=font.toLowerCase(),option=new Option(font,lower),font==me.defaultFont&&(selIdx=i),option.style.fontFamily=lower,Ext.isIE?select.add(option):select.options.add(option);select.options[selIdx].selected=!0}},isEqual:function(value1,value2){return this.isEqualAsString(value1,value2)},afterRender:function(){var me=this,inputCmp=me.inputCmp;me.callParent(arguments),me.iframeEl=inputCmp.iframeEl,me.textareaEl=inputCmp.textareaEl,me.inputEl=me.iframeEl,me.enableFont&&me.initDefaultFont(),me.monitorTask=Ext.TaskManager.start({run:me.checkDesignMode,scope:me,interval:100})},initFrameDoc:function(){var doc,task,me=this;Ext.TaskManager.stop(me.monitorTask),doc=me.getDoc(),me.win=me.getWin(),doc.open(),doc.write(me.getDocMarkup()),doc.close(),task={run:function(){var doc=me.getDoc();(doc.body||"complete"===doc.readyState)&&(Ext.TaskManager.stop(task),me.setDesignMode(!0),Ext.defer(me.initEditor,10,me))},interval:10,duration:1e4,scope:me},Ext.TaskManager.start(task)},checkDesignMode:function(){var me=this,doc=me.getDoc();!doc||doc.editorInitialized&&"on"===me.getDesignMode()||me.initFrameDoc()},setDesignMode:function(mode){var me=this,doc=me.getDoc();doc&&(me.readOnly&&(mode=!1),doc.designMode=/on|true/i.test(String(mode).toLowerCase())?"on":"off")},getDesignMode:function(){var doc=this.getDoc();return doc?String(doc.designMode).toLowerCase():""},disableItems:function(disabled){var i,item,items=this.getToolbar().items.items,iLen=items.length;for(i=0;i<iLen;i++)item=items[i],"sourceedit"!==item.getItemId()&&item.setDisabled(disabled)},toggleSourceEdit:function(sourceEditMode){var me=this,iframe=me.iframeEl,textarea=me.textareaEl,hiddenCls=Ext.baseCSSPrefix+"hidden",btn=me.getToolbar().getComponent("sourceedit");Ext.isBoolean(sourceEditMode)||(sourceEditMode=!me.sourceEditMode),me.sourceEditMode=sourceEditMode,btn.pressed!==sourceEditMode&&btn.toggle(sourceEditMode),sourceEditMode?(me.disableItems(!0),me.syncValue(),iframe.addCls(hiddenCls),textarea.removeCls(hiddenCls),textarea.dom.removeAttribute("tabIndex"),textarea.focus(),me.inputEl=textarea):(me.initialized&&me.disableItems(me.readOnly),me.pushValue(),iframe.removeCls(hiddenCls),textarea.addCls(hiddenCls),textarea.dom.setAttribute("tabIndex",-1),me.deferFocus(),me.inputEl=iframe),me.fireEvent("editmodechange",me,sourceEditMode),me.updateLayout()},createLink:function(){var url=prompt(this.createLinkText,this.defaultLinkValue);url&&"http://"!==url&&this.relayCmd("createlink",url)},clearInvalid:Ext.emptyFn,setValue:function(value){var me=this,textarea=me.textareaEl;me.inputCmp;return null!==value&&void 0!==value||(value=""),textarea&&(textarea.dom.value=value),me.pushValue(),!me.rendered&&me.inputCmp&&(me.inputCmp.data.value=value),me.mixins.field.setValue.call(me,value),me},cleanHtml:function(html){return html=String(html),Ext.isWebKit&&(html=html.replace(/\sclass="(?:Apple-style-span|Apple-tab-span|khtml-block-placeholder)"/gi,"")),html.charCodeAt(0)===parseInt(this.defaultValue.replace(/\D/g,""),10)&&(html=html.substring(1)),html},syncValue:function(){var body,changed,html,bodyStyle,match,textElDom,me=this;me.initialized&&(body=me.getEditorBody(),html=body.innerHTML,textElDom=me.textareaEl.dom,Ext.isWebKit&&(bodyStyle=body.getAttribute("style"),match=bodyStyle.match(/text-align:(.*?);/i),match&&match[1]&&(html='<div style="'+match[0]+'">'+html+"</div>")),html=me.cleanHtml(html),me.fireEvent("beforesync",me,html)!==!1&&(Ext.isGecko&&""===textElDom.value&&"<br>"===html&&(html=""),textElDom.value!==html&&(textElDom.value=html,changed=!0),me.fireEvent("sync",me,html),changed&&me.checkChange()))},getValue:function(){var value,me=this;return me.sourceEditMode||me.syncValue(),value=me.rendered?me.textareaEl.dom.value:me.value,me.value=value,value},pushValue:function(){var v,me=this;me.initialized&&(v=me.textareaEl.dom.value||"",!me.activated&&v.length<1&&(v=me.defaultValue),me.fireEvent("beforepush",me,v)!==!1&&(me.getEditorBody().innerHTML=v,Ext.isGecko&&(me.setDesignMode(!1),me.setDesignMode(!0)),me.fireEvent("push",me,v)))},deferFocus:function(){this.focus(!1,!0)},getFocusEl:function(){var me=this,win=me.win;return win&&!me.sourceEditMode?win:me.textareaEl},focus:function(selectText,delay){var value,focusEl,me=this;return delay?(me.focusTask||(me.focusTask=new Ext.util.DelayedTask(me.focus)),me.focusTask.delay(Ext.isNumber(delay)?delay:10,null,me,[selectText,!1])):(selectText&&(me.textareaEl&&me.textareaEl.dom&&(value=me.textareaEl.dom.value),value&&value.length&&me.execCmd("selectall",!0)),focusEl=me.getFocusEl(),focusEl&&focusEl.focus&&focusEl.focus()),me},initEditor:function(){try{var doc,fn,me=this,dbody=me.getEditorBody(),ss=me.textareaEl.getStyles("font-size","font-family","background-image","background-repeat","background-color","color");if(ss["background-attachment"]="fixed",dbody.bgProperties="fixed",Ext.DomHelper.applyStyles(dbody,ss),doc=me.getDoc())try{Ext.EventManager.removeAll(doc)}catch(e){}fn=Ext.Function.bind(me.onEditorEvent,me),Ext.EventManager.on(doc,{mousedown:fn,dblclick:fn,click:fn,keyup:fn,buffer:100}),fn=me.onRelayedEvent,Ext.EventManager.on(doc,{mousedown:fn,mousemove:fn,mouseup:fn,click:fn,dblclick:fn,scope:me}),Ext.isGecko&&Ext.EventManager.on(doc,"keypress",me.applyCommand,me),me.fixKeys&&Ext.EventManager.on(doc,"keydown",me.fixKeys,me),me.fixKeysAfter&&Ext.EventManager.on(doc,"keyup",me.fixKeysAfter,me),Ext.isIE9&&Ext.isStrict&&Ext.EventManager.on(doc.documentElement,"focus",me.focus,me),(Ext.isIE8m||Ext.isIE9&&!Ext.isStrict)&&(Ext.EventManager.on(doc,"focusout",function(){me.savedSelection="None"!==doc.selection.type?doc.selection.createRange():null},me),Ext.EventManager.on(doc,"focusin",function(){me.savedSelection&&me.savedSelection.select()},me)),Ext.EventManager.onWindowUnload(me.beforeDestroy,me),doc.editorInitialized=!0,me.initialized=!0,me.pushValue(),me.setReadOnly(me.readOnly),me.fireEvent("initialize",me)}catch(ex){}},beforeDestroy:function(){var doc,prop,me=this,monitorTask=me.monitorTask;if(monitorTask&&Ext.TaskManager.stop(monitorTask),me.rendered){Ext.EventManager.removeUnloadListener(me.beforeDestroy,me);try{if(doc=me.getDoc()){Ext.EventManager.removeAll(Ext.fly(doc));for(prop in doc)doc.hasOwnProperty&&doc.hasOwnProperty(prop)&&delete doc[prop]}}catch(e){}me.iframeEl.remove(),delete me.iframeEl,delete me.textareaEl,delete me.toolbar,delete me.inputCmp}me.callParent()},onRelayedEvent:function(event){var iframeEl=this.iframeEl,iframeXY=Ext.Element.getTrueXY(iframeEl),originalEventXY=event.getXY(),eventXY=Ext.EventManager.getPageXY(event.browserEvent);event.xy=[iframeXY[0]+eventXY[0],iframeXY[1]+eventXY[1]],event.injectEvent(iframeEl),event.xy=originalEventXY},onFirstFocus:function(){var selection,range,me=this;if(me.activated=!0,me.disableItems(me.readOnly),Ext.isGecko){me.win.focus(),selection=me.win.getSelection(),selection.focusNode&&!me.getValue().length&&(range=selection.getRangeAt(0),range.selectNodeContents(me.getEditorBody()),range.collapse(!0),me.deferFocus());try{me.execCmd("useCSS",!0),me.execCmd("styleWithCSS",!1)}catch(e){}}me.fireEvent("activate",me)},adjustFont:function(btn){var isSafari,adjust="increasefontsize"===btn.getItemId()?1:-1,size=this.getDoc().queryCommandValue("FontSize")||"2",isPxSize=Ext.isString(size)&&size.indexOf("px")!==-1;size=parseInt(size,10),isPxSize?(size=size<=10?1+adjust:size<=13?2+adjust:size<=16?3+adjust:size<=18?4+adjust:size<=24?5+adjust:6+adjust,size=Ext.Number.constrain(size,1,6)):(isSafari=Ext.isSafari,isSafari&&(adjust*=2),size=Math.max(1,size+adjust)+(isSafari?"px":0)),this.relayCmd("FontSize",size)},onEditorEvent:function(e){this.updateToolbar()},updateToolbar:function(){function updateButtons(){var state;for(i=0,l=arguments.length,name;i<l;i++){name=arguments[i];try{state=doc.queryCommandState(name)}catch(e){state=!1}btns[name].toggle(state)}}var i,l,btns,doc,name,queriedName,fontSelect,toolbarSubmenus,me=this;if(!me.readOnly){if(!me.activated)return void me.onFirstFocus();for(btns=me.getToolbar().items.map,doc=me.getDoc(),me.enableFont&&!Ext.isSafari2&&(queriedName=doc.queryCommandValue("fontName"),name=(queriedName?queriedName.split(",")[0].replace(me.reStripQuotes,""):me.defaultFont).toLowerCase(),fontSelect=me.fontSelect.dom,name===fontSelect.value&&name==queriedName||(fontSelect.value=name)),me.enableFormat&&updateButtons("bold","italic","underline"),me.enableAlignments&&updateButtons("justifyleft","justifycenter","justifyright"),!Ext.isSafari2&&me.enableLists&&updateButtons("insertorderedlist","insertunorderedlist"),toolbarSubmenus=me.toolbar.query("menu"),i=0;i<toolbarSubmenus.length;i++)toolbarSubmenus[i].hide();me.syncValue()}},relayBtnCmd:function(btn){this.relayCmd(btn.getItemId())},relayCmd:function(cmd,value){Ext.defer(function(){var me=this;this.isDestroyed||(me.win.focus(),me.execCmd(cmd,value),me.updateToolbar())},10,this)},execCmd:function(cmd,value){var me=this,doc=me.getDoc();doc.execCommand(cmd,!1,void 0==value?null:value),me.syncValue()},applyCommand:function(e){if(e.ctrlKey){var cmd,me=this,c=e.getCharCode();if(c>0){switch(c=String.fromCharCode(c)){case"b":cmd="bold";break;case"i":cmd="italic";break;case"u":cmd="underline"}cmd&&(me.win.focus(),me.execCmd(cmd),me.deferFocus(),e.preventDefault())}}},insertAtCursor:function(text){var range,me=this;me.activated&&(me.win.focus(),Ext.isIE?(range=me.getDoc().selection.createRange(),range&&(range.pasteHTML(text),me.syncValue(),me.deferFocus())):(me.execCmd("InsertHTML",text),me.deferFocus()))},fixKeys:function(){return Ext.isIE?function(e){var range,target,me=this,k=e.getKey(),doc=me.getDoc(),readOnly=me.readOnly;k===e.TAB?(e.stopEvent(),readOnly||(range=doc.selection.createRange(),range&&(range.collapse&&(range.collapse(!0),range.pasteHTML("&#160;&#160;&#160;&#160;")),me.deferFocus()))):k===e.ENTER&&(readOnly||(range=doc.selection.createRange(),range&&(target=range.parentElement(),target&&"li"===target.tagName.toLowerCase()||(e.stopEvent(),range.pasteHTML("<br />"),range.collapse(!1),range.select()))))}:Ext.isOpera?function(e){var me=this,k=e.getKey(),readOnly=me.readOnly;k===e.TAB&&(e.stopEvent(),readOnly||(me.win.focus(),me.execCmd("InsertHTML","&#160;&#160;&#160;&#160;"),me.deferFocus()))}:null}(),fixKeysAfter:function(){return Ext.isIE?function(e){var innerHTML,me=this,k=e.getKey(),doc=me.getDoc(),readOnly=me.readOnly;readOnly||k!==e.BACKSPACE&&k!==e.DELETE||(innerHTML=doc.body.innerHTML,"<p>&nbsp;</p>"!==innerHTML&&"<P>&nbsp;</P>"!==innerHTML||(doc.body.innerHTML=""))}:null}(),getToolbar:function(){return this.toolbar},buttonTips:{bold:{title:"Bold (Ctrl+B)",text:"Make the selected text bold.",cls:Ext.baseCSSPrefix+"html-editor-tip"},italic:{title:"Italic (Ctrl+I)",text:"Make the selected text italic.",cls:Ext.baseCSSPrefix+"html-editor-tip"},underline:{title:"Underline (Ctrl+U)",text:"Underline the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},increasefontsize:{title:"Grow Text",text:"Increase the font size.",cls:Ext.baseCSSPrefix+"html-editor-tip"},decreasefontsize:{title:"Shrink Text",text:"Decrease the font size.",cls:Ext.baseCSSPrefix+"html-editor-tip"},backcolor:{title:"Text Highlight Color",text:"Change the background color of the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},forecolor:{title:"Font Color",text:"Change the color of the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyleft:{title:"Align Text Left",text:"Align text to the left.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifycenter:{title:"Center Text",text:"Center text in the editor.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyright:{title:"Align Text Right",text:"Align text to the right.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertunorderedlist:{title:"Bullet List",text:"Start a bulleted list.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertorderedlist:{title:"Numbered List",text:"Start a numbered list.",cls:Ext.baseCSSPrefix+"html-editor-tip"},createlink:{title:"Hyperlink",text:"Make the selected text a hyperlink.",cls:Ext.baseCSSPrefix+"html-editor-tip"},sourceedit:{title:"Source Edit",text:"Switch to source editing mode.",cls:Ext.baseCSSPrefix+"html-editor-tip"}}}),Ext.define("Ext.picker.Time",{extend:Ext.view.BoundList,alias:"widget.timepicker",increment:15,format:"g:i A",displayField:"disp",initDate:[2008,0,1],componentCls:Ext.baseCSSPrefix+"timepicker",loadMask:!1,initComponent:function(){var me=this,dateUtil=Ext.Date,clearTime=dateUtil.clearTime,initDate=me.initDate;me.absMin=clearTime(new Date(initDate[0],initDate[1],initDate[2])),me.absMax=dateUtil.add(clearTime(new Date(initDate[0],initDate[1],initDate[2])),"mi",1439),me.store=me.createStore(),me.store.addFilter(me.rangeFilter=new Ext.util.Filter({id:"time-picker-filter"}),!1),me.updateList(),me.callParent()},setMinValue:function(value){this.minValue=value,this.updateList()},setMaxValue:function(value){this.maxValue=value,this.updateList()},normalizeDate:function(date){var initDate=this.initDate;return date.setFullYear(initDate[0],initDate[1],initDate[2]),date},updateList:function(){var me=this,min=me.normalizeDate(me.minValue||me.absMin),max=me.normalizeDate(me.maxValue||me.absMax);me.rangeFilter.setFilterFn(function(record){var date=record.get("date");return date>=min&&date<=max}),me.store.filter()},createStore:function(){for(var me=this,utilDate=Ext.Date,times=[],min=me.absMin,max=me.absMax;min<=max;)times.push({disp:utilDate.dateFormat(min,me.format),date:min}),min=utilDate.add(min,"mi",me.increment);return new Ext.data.Store({fields:["disp","date"],data:times})},focusNode:function(rec){return!1}}),Ext.define("Ext.form.field.Time",{extend:Ext.form.field.ComboBox,alias:"widget.timefield",alternateClassName:["Ext.form.TimeField","Ext.form.Time"],triggerCls:Ext.baseCSSPrefix+"form-time-trigger",minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,pickerMaxHeight:300,selectOnTab:!0,snapToIncrement:!1,initDate:"1/1/2008",initDateParts:[2008,0,1],initDateFormat:"j/n/Y",ignoreSelection:0,queryMode:"local",displayField:"disp",valueField:"date",initComponent:function(){var me=this,min=me.minValue,max=me.maxValue;min&&me.setMinValue(min),max&&me.setMaxValue(max),me.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : this.formatDate(values["'+me.displayField+'"])]}<tpl if="xindex < xcount">'+me.delimiter+"</tpl></tpl>",{formatDate:Ext.Function.bind(me.formatDate,me)}),this.callParent()},transformOriginalValue:function(value){return Ext.isDefined(value)?this.rawToValue(value)||value||null:value},isEqual:function(v1,v2){var i,len,fromArray=Ext.Array.from,isEqual=Ext.Date.isEqual;if(v1=fromArray(v1),v2=fromArray(v2),len=v1.length,len!==v2.length)return!1;for(i=0;i<len;i++)if(!isEqual(v2[i],v1[i]))return!1;return!0},setMinValue:function(value){var me=this,picker=me.picker;me.setLimit(value,!0),picker&&picker.setMinValue(me.minValue)},setMaxValue:function(value){var me=this,picker=me.picker;me.setLimit(value,!1),picker&&picker.setMaxValue(me.maxValue)},setLimit:function(value,isMin){var d,val,me=this;Ext.isString(value)?d=me.parseDate(value):Ext.isDate(value)&&(d=value),d?(val=me.getInitDate(),val.setHours(d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())):val=null,me[isMin?"minValue":"maxValue"]=val},getInitDate:function(hours,minutes){var parts=this.initDateParts;return new Date(parts[0],parts[1],parts[2],hours||0,minutes||0,0,0)},valueToRaw:function(value){return this.formatDate(this.parseDate(value))},getErrors:function(value){var i,len,date,item,me=this,format=Ext.String.format,errors=me.callParent(arguments),minValue=me.minValue,maxValue=me.maxValue,data=me.displayTplData,raw=me.getRawValue();if(data&&data.length>0)for(i=0,len=data.length;i<len;i++)item=data[i],item=item.date||item.disp,date=me.parseDate(item),date?(minValue&&date<minValue&&errors.push(format(me.minText,me.formatDate(minValue))),maxValue&&date>maxValue&&errors.push(format(me.maxText,me.formatDate(maxValue)))):errors.push(format(me.invalidText,item,Ext.Date.unescapeFormat(me.format)));else raw.length&&!me.parseDate(raw)&&errors.push(format(me.invalidText,raw,Ext.Date.unescapeFormat(me.format)));return errors},formatDate:function(items){var i,len,formatted=[];for(items=Ext.Array.from(items),i=0,len=items.length;i<len;i++)formatted.push(Ext.form.field.Date.prototype.formatDate.call(this,items[i]));return formatted.join(this.delimiter)},parseDate:function(value){var len,me=this,val=value,altFormats=me.altFormats,altFormatsArray=me.altFormatsArray,i=0;if(value&&!Ext.isDate(value)&&(val=me.safeParse(value,me.format),!val&&altFormats))for(altFormatsArray=altFormatsArray||altFormats.split("|"),len=altFormatsArray.length;i<len&&!val;++i)val=me.safeParse(value,altFormatsArray[i]);return val&&me.snapToIncrement&&(val=new Date(Ext.Number.snap(val.getTime(),60*me.increment*1e3))),val},safeParse:function(value,format){var parsedDate,me=this,utilDate=Ext.Date,result=null;return utilDate.formatContainsDateInfo(format)?result=utilDate.parse(value,format):(parsedDate=utilDate.parse(me.initDate+" "+value,me.initDateFormat+" "+format),parsedDate&&(result=parsedDate)),result},getSubmitValue:function(){var me=this,format=me.submitFormat||me.format,value=me.getValue();return value?Ext.Date.format(value,format):null},createPicker:function(){var picker,me=this;return me.listConfig=Ext.apply({xtype:"timepicker",selModel:{mode:me.multiSelect?"SIMPLE":"SINGLE"},cls:void 0,minValue:me.minValue,maxValue:me.maxValue,increment:me.increment,format:me.format,maxHeight:me.pickerMaxHeight},me.listConfig),picker=me.callParent(),me.bindStore(picker.store),picker},onItemClick:function(picker,record){var me=this,selected=picker.getSelectionModel().getSelection();!me.multiSelect&&selected.length&&selected.length>0&&(selected=selected[0],selected&&Ext.Date.isEqual(record.get("date"),selected.get("date"))&&me.collapse())},syncSelection:function(){var selModel,value,values,i,len,item,data,d,dLen,rec,me=this,picker=me.picker,isEqual=Ext.Date.isEqual,toSelect=[];if(picker){if(picker.clearHighlight(),value=me.getValue(),selModel=picker.getSelectionModel(),me.ignoreSelection++,null===value)selModel.deselectAll();else for(values=Ext.Array.from(value),data=picker.store.data.items,dLen=data.length,i=0,len=values.length;i<len;i++)if(item=values[i],Ext.isDate(item)){for(d=0;d<dLen&&(rec=data[d],!isEqual(rec.get("date"),item)||(toSelect.push(rec),me.multiSelect));d++);selModel.select(toSelect)}me.ignoreSelection--}},postBlur:function(){var me=this,val=me.getValue();me.callParent(arguments),me.validateValue(val)&&me.setValue(val)},findRecordByValue:function(value){return"string"==typeof value&&(value=this.parseDate(value)),this.callParent([value])},rawToValue:function(item){var items,values,i,len,me=this;if(me.multiSelect){for(values=[],items=Ext.Array.from(item),i=0,len=items.length;i<len;i++)values.push(me.parseDate(items[i]));return values}return me.parseDate(item)},setValue:function(v){return this.getPicker(),Ext.isDate(v)&&(v=this.getInitDate(v.getHours(),v.getMinutes())),this.callParent([v])},getValue:function(){return this.rawToValue(this.callParent(arguments))}}),Ext.define("Ext.grid.CellContext",{isCellContext:!0,constructor:function(view){this.view=view},isEqual:function(other){return!!other&&(this.record===other.record&&this.columnHeader===other.columnHeader)},setPosition:function(row,col){var me=this;return 1===arguments.length&&(row.view&&(me.view=row.view),col=row.column,row=row.row),me.setRow(row),me.setColumn(col),me},setRow:function(row){var me=this;void 0!==row&&("number"==typeof row?(me.row=Math.max(Math.min(row,me.view.dataSource.getCount()-1),0),me.record=me.view.dataSource.getAt(row)):row.isModel?(me.record=row,me.row=me.view.indexOf(row)):row.tagName&&(me.record=me.view.getRecord(row),me.row=me.view.indexOf(me.record)))},setColumn:function(col){var me=this,mgr=me.view.ownerCt.getColumnManager();void 0!==col&&("number"==typeof col?(me.column=col,me.columnHeader=mgr.getHeaderAtIndex(col)):col.isHeader&&(me.columnHeader=col,me.column=mgr.getHeaderIndex(col)))}}),Ext.define("Ext.grid.CellEditor",{extend:Ext.Editor,constructor:function(config){config=Ext.apply({},config),config.field&&(config.field.monitorTab=!1),this.callParent([config])},onShow:function(){var me=this,innerCell=me.boundEl.first();innerCell&&(me.isForTree&&(innerCell=innerCell.child(me.treeNodeSelector)),innerCell.hide()),me.callParent(arguments)},onHide:function(){var me=this,innerCell=me.boundEl.first();innerCell&&(me.isForTree&&(innerCell=innerCell.child(me.treeNodeSelector)),innerCell.show()),me.callParent(arguments)},afterRender:function(){var me=this,field=me.field;me.callParent(arguments),field.isCheckbox&&field.mon(field.inputEl,{mousedown:me.onCheckBoxMouseDown,click:me.onCheckBoxClick,scope:me})},onCheckBoxMouseDown:function(){this.completeEdit=Ext.emptyFn},onCheckBoxClick:function(){delete this.completeEdit,this.field.focus(!1,10)},realign:function(autoSize){var xOffset,me=this,boundEl=me.boundEl,innerCell=boundEl.first(),innerCellTextNode=innerCell.dom.firstChild,width=boundEl.getWidth(),offsets=Ext.Array.clone(me.offsets),grid=me.grid,v="",isEmpty=!innerCellTextNode||3===innerCellTextNode.nodeType&&!Ext.String.trim(v=innerCellTextNode.data).length;me.isForTree&&(xOffset=me.getTreeNodeOffset(innerCell),width-=Math.abs(xOffset),offsets[0]+=xOffset),grid.columnLines&&(width-=boundEl.getBorderWidth("rl")),autoSize===!0&&me.field.setWidth(width),isEmpty&&(innerCell.dom.innerHTML="X"),me.alignTo(innerCell,me.alignment,offsets),isEmpty&&(innerCell.dom.firstChild.data=v)},getTreeNodeOffset:function(innerCell){return innerCell.child(this.treeNodeSelector).getOffsetsTo(innerCell)[0]},onEditorTab:function(e){var field=this.field;field.onEditorTab&&field.onEditorTab(e)},onFieldBlur:function(){this.callParent(arguments),this.selectSameEditor=!1},alignment:"l-l",hideEl:!1,cls:Ext.baseCSSPrefix+"small-editor "+Ext.baseCSSPrefix+"grid-editor "+Ext.baseCSSPrefix+"grid-cell-editor",treeNodeSelector:"."+Ext.baseCSSPrefix+"tree-node-text",shim:!1,shadow:!1}),Ext.define("Ext.grid.ColumnComponentLayout",{extend:Ext.layout.component.Auto,alias:"layout.columncomponent",type:"columncomponent",setWidthInDom:!0,beginLayout:function(ownerContext){this.callParent(arguments),ownerContext.titleContext=ownerContext.getEl("titleEl"),ownerContext.triggerContext=ownerContext.getEl("triggerEl")},beginLayoutCycle:function(ownerContext){var owner=this.owner;this.callParent(arguments),ownerContext.widthModel.shrinkWrap&&owner.el.setWidth(""),owner.titleEl.setStyle({paddingTop:"",paddingBottom:""})},publishInnerHeight:function(ownerContext,outerHeight){if(outerHeight){var textHeight,titleHeight,pt,pb,me=this,owner=me.owner,innerHeight=outerHeight-ownerContext.getBorderInfo().height,availableHeight=innerHeight;if(!owner.noWrap&&!ownerContext.hasDomProp("width"))return void(me.done=!1);ownerContext.hasRawContent?(titleHeight=availableHeight,textHeight=owner.textEl.getHeight(),textHeight&&(availableHeight-=textHeight,availableHeight>0&&(pt=Math.floor(availableHeight/2),pb=availableHeight-pt,ownerContext.titleContext.setProp("padding-top",pt),ownerContext.titleContext.setProp("padding-bottom",pb)))):(titleHeight=owner.titleEl.getHeight(),ownerContext.setProp("innerHeight",innerHeight-titleHeight,!1)),(Ext.isIE6||Ext.isIEQuirks)&&ownerContext.triggerContext&&ownerContext.triggerContext.setHeight(titleHeight)}},measureContentHeight:function(ownerContext){return ownerContext.el.dom.offsetHeight},publishOwnerHeight:function(ownerContext,contentHeight){this.callParent(arguments),(Ext.isIE6||Ext.isIEQuirks)&&ownerContext.triggerContext&&ownerContext.triggerContext.setHeight(contentHeight)},publishInnerWidth:function(ownerContext,outerWidth){ownerContext.hasRawContent||ownerContext.setProp("innerWidth",outerWidth-ownerContext.getBorderInfo().width,!1)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){var result=this.callParent(arguments);return ownerContext.hasRawContent?result:this.owner.noWrap||ownerContext.hasDomProp("width")?contentHeight+this.owner.titleEl.getHeight()+ownerContext.getBorderInfo().height:null},calculateOwnerWidthFromContentWidth:function(ownerContext,contentWidth){var inner,owner=this.owner,padWidth=ownerContext.getPaddingInfo().width,triggerOffset=this.getTriggerOffset(owner,ownerContext);return inner=owner.isGroupHeader?contentWidth:Math.max(contentWidth,owner.textEl.getWidth()+ownerContext.titleContext.getPaddingInfo().width),inner+padWidth+triggerOffset},getTriggerOffset:function(owner,ownerContext){var width=0;return ownerContext.widthModel.shrinkWrap&&!owner.menuDisabled&&0===owner.query(">:not([hidden])").length&&(width=owner.self.triggerElWidth),width}}),Ext.define("Ext.grid.ColumnLayout",{extend:Ext.layout.container.HBox,alias:"layout.gridcolumn",type:"gridcolumn",reserveOffset:!1,firstHeaderCls:Ext.baseCSSPrefix+"column-header-first",lastHeaderCls:Ext.baseCSSPrefix+"column-header-last",initLayout:function(){var me=this;void 0===me.scrollbarWidth&&(me.self.prototype.scrollbarWidth=Ext.getScrollbarSize().width),me.grid=this.owner.up("[scrollerOwner]"),me.callParent()},beginLayout:function(ownerContext){var i,item,me=this,owner=me.owner,grid=me.grid,view=grid.view,items=me.getVisibleItems(),len=items.length,firstCls=me.firstHeaderCls,lastCls=me.lastHeaderCls,removeCls=[firstCls,lastCls];for(grid.lockable&&(view=owner.up("tablepanel")===view.normalGrid?view.normalGrid.getView():null),i=0;i<len;i++)item=items[i],item.removeCls(removeCls),0===i&&item.addCls(firstCls),i===len-1&&item.addCls(lastCls);me.callParent(arguments),!owner.isColumn&&me.scrollbarWidth&&!grid.collapsed&&view&&view.rendered&&(ownerContext.viewTable=view.body.dom)&&(ownerContext.viewContext=ownerContext.context.getCmp(view))},roundFlex:function(width){return Math.floor(width)},calculate:function(ownerContext){this.callParent(arguments),ownerContext.state.parallelDone&&ownerContext.setProp("columnWidthsDone",!0),
ownerContext.viewContext&&(ownerContext.state.tableHeight=ownerContext.viewTable.offsetHeight)},completeLayout:function(ownerContext){var me=this,owner=me.owner,state=ownerContext.state;me.callParent(arguments),!ownerContext.flexedItems.length&&!state.flexesCalculated&&owner.forceFit&&me.convertWidthsToFlexes(ownerContext)?(me.cacheFlexes(ownerContext),ownerContext.invalidate({state:{flexesCalculated:!0}})):ownerContext.setProp("columnWidthsDone",!0)},convertWidthsToFlexes:function(ownerContext){var childItems,len,i,childContext,item,me=this,totalWidth=0,calculated=me.sizeModels.calculated;for(childItems=ownerContext.childItems,len=childItems.length,i=0;i<len;i++)childContext=childItems[i],item=childContext.target,totalWidth+=childContext.props.width,item.fixed||item.resizable===!1||(item.flex=ownerContext.childItems[i].flex=childContext.props.width,item.width=null,childContext.widthModel=calculated);return totalWidth!==ownerContext.props.width},getContainerSize:function(ownerContext){var result,viewHeight,me=this,viewContext=ownerContext.viewContext;return me.owner.isColumn?result=me.getColumnContainerSize(ownerContext):(result=me.callParent(arguments),viewContext&&!viewContext.heightModel.shrinkWrap&&viewContext.target.componentLayout.ownerContext&&(viewHeight=viewContext.getProp("height"),isNaN(viewHeight)?me.done=!1:ownerContext.state.tableHeight>viewHeight&&(result.width-=me.scrollbarWidth,ownerContext.state.parallelDone=!1,viewContext.invalidate()))),result},getColumnContainerSize:function(ownerContext){var gotWidth,gotHeight,width,height,padding=ownerContext.paddingContext.getPaddingInfo(),got=0,needed=0;return ownerContext.widthModel.shrinkWrap||(++needed,width=ownerContext.getProp("innerWidth"),gotWidth="number"==typeof width,gotWidth&&(++got,width-=padding.width,width<0&&(width=0))),ownerContext.heightModel.shrinkWrap||(++needed,height=ownerContext.getProp("innerHeight"),gotHeight="number"==typeof height,gotHeight&&(++got,height-=padding.height,height<0&&(height=0))),{width:width,height:height,needed:needed,got:got,gotAll:got==needed,gotWidth:gotWidth,gotHeight:gotHeight}},publishInnerCtSize:function(ownerContext){var view,me=this,size=ownerContext.state.boxPlan.targetSize,cw=ownerContext.peek("contentWidth");return me.owner.tooNarrow=ownerContext.state.boxPlan.tooNarrow,null==cw||me.owner.isColumn||(size.width=cw,view=me.owner.ownerCt.view,view.scrollFlags.y&&(size.width+=me.scrollbarWidth)),me.callParent(arguments)}}),Ext.define("Ext.grid.ColumnManager",{alternateClassName:["Ext.grid.ColumnModel"],columns:null,constructor:function(visibleOnly,headerCt,secondHeaderCt){this.headerCt=headerCt,secondHeaderCt&&(this.secondHeaderCt=secondHeaderCt),this.visibleOnly=!!visibleOnly},getColumns:function(){return this.columns||this.cacheColumns(),this.columns},getHeaderIndex:function(header){return header.isGroupHeader&&(header=this.getHeaderColumns(header)[0]),Ext.Array.indexOf(this.getColumns(),header)},getHeaderAtIndex:function(index){var columns=this.getColumns(),col=columns[index];return col||null},getPreviousSibling:function(header){var index=this.getHeaderIndex(header),col=null;return index>0&&(col=this.getColumns()[index-1]),col},getNextSibling:function(header){var col,index=this.getHeaderIndex(header);return index!==-1&&(col=this.getColumns()[index+1]),col||null},getFirst:function(){var columns=this.getColumns();return columns.length>0?columns[0]:null},getLast:function(){var columns=this.getColumns(),len=columns.length;return len>0?columns[len-1]:null},getHeaderById:function(id){var i,header,columns=this.getColumns(),len=columns.length;for(i=0;i<len;++i)if(header=columns[i],header.getItemId()===id)return header;return null},getVisibleHeaderClosestToIndex:function(index){var result=this.getHeaderAtIndex(index);return result&&result.hidden&&(result=result.next(":not([hidden])")||result.prev(":not([hidden])")),result},cacheColumns:function(){var columns=this.getHeaderColumns(this.headerCt),second=this.secondHeaderCt;second&&(columns=columns.concat(this.getHeaderColumns(second))),this.columns=columns},getHeaderColumns:function(header){var result=this.visibleOnly?header.getVisibleGridColumns():header.getGridColumns();return Ext.Array.clone(result)},invalidate:function(){var root=this.rootColumns;this.columns=null,root&&root.invalidate()},destroy:function(){this.columns=this.rootColumns=null}},function(){this.createAlias("indexOf","getHeaderIndex")}),Ext.define("Ext.layout.container.Fit",{extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.FitLayout",alias:"layout.fit",itemCls:Ext.baseCSSPrefix+"fit-item",targetCls:Ext.baseCSSPrefix+"layout-fit",type:"fit",defaultMargins:{top:0,right:0,bottom:0,left:0},manageMargins:!0,sizePolicies:{0:{readsWidth:1,readsHeight:1,setsWidth:0,setsHeight:0},1:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},2:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},3:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(item,ownerSizeModel){var sizeModel=ownerSizeModel||this.owner.getSizeModel(),mode=(sizeModel.width.shrinkWrap?0:1)|(sizeModel.height.shrinkWrap?0:2);return this.sizePolicies[mode]},beginLayoutCycle:function(ownerContext,firstCycle){var c,childItems,i,item,length,margins,minHeight,minWidth,style,undef,me=this,resetHeight=me.lastHeightModel&&me.lastHeightModel.calculated,resetWidth=me.lastWidthModel&&me.lastWidthModel.calculated,resetSizes=resetWidth||resetHeight,maxChildMinHeight=0,maxChildMinWidth=0;for(me.callParent(arguments),resetSizes&&"TD"!=ownerContext.targetContext.el.dom.tagName.toUpperCase()&&(resetSizes=resetWidth=resetHeight=!1),childItems=ownerContext.childItems,length=childItems.length,i=0;i<length;++i)item=childItems[i],firstCycle&&(c=item.target,minHeight=c.minHeight,minWidth=c.minWidth,(minWidth||minHeight)&&(margins=item.marginInfo||item.getMarginInfo(),minHeight+=margins.height,minWidth+=margins.height,maxChildMinHeight<minHeight&&(maxChildMinHeight=minHeight),maxChildMinWidth<minWidth&&(maxChildMinWidth=minWidth))),resetSizes&&(style=item.el.dom.style,resetHeight&&(style.height=""),resetWidth&&(style.width=""));firstCycle&&(ownerContext.maxChildMinHeight=maxChildMinHeight,ownerContext.maxChildMinWidth=maxChildMinWidth),c=ownerContext.target,ownerContext.overflowX=!ownerContext.widthModel.shrinkWrap&&ownerContext.maxChildMinWidth&&c.scrollFlags.x||undef,ownerContext.overflowY=!ownerContext.heightModel.shrinkWrap&&ownerContext.maxChildMinHeight&&c.scrollFlags.y||undef},calculate:function(ownerContext){var scrollbars,scrollbarSize,padding,i,contentWidth,contentHeight,me=this,childItems=ownerContext.childItems,length=childItems.length,containerSize=me.getContainerSize(ownerContext),info={length:length,ownerContext:ownerContext,targetSize:containerSize},shrinkWrapWidth=ownerContext.widthModel.shrinkWrap,shrinkWrapHeight=ownerContext.heightModel.shrinkWrap,overflowX=ownerContext.overflowX,overflowY=ownerContext.overflowY;for((overflowX||overflowY)&&(scrollbars=me.getScrollbarsNeeded(overflowX&&containerSize.width,overflowY&&containerSize.height,ownerContext.maxChildMinWidth,ownerContext.maxChildMinHeight),scrollbars&&(scrollbarSize=Ext.getScrollbarSize(),1&scrollbars&&(containerSize.height-=scrollbarSize.height),2&scrollbars&&(containerSize.width-=scrollbarSize.width))),i=0;i<length;++i)info.index=i,me.fitItem(childItems[i],info);(shrinkWrapHeight||shrinkWrapWidth)&&(padding=ownerContext.targetContext.getPaddingInfo(),shrinkWrapWidth&&(overflowY&&!containerSize.gotHeight?me.done=!1:(contentWidth=info.contentWidth+padding.width,2&scrollbars&&(contentWidth+=scrollbarSize.width),ownerContext.setContentWidth(contentWidth)||(me.done=!1))),shrinkWrapHeight&&(overflowX&&!containerSize.gotWidth?me.done=!1:(contentHeight=info.contentHeight+padding.height,1&scrollbars&&(contentHeight+=scrollbarSize.height),ownerContext.setContentHeight(contentHeight)||(me.done=!1))))},fitItem:function(itemContext,info){var me=this;return itemContext.invalid?void(me.done=!1):(info.margins=itemContext.getMarginInfo(),info.needed=info.got=0,me.fitItemWidth(itemContext,info),me.fitItemHeight(itemContext,info),void(info.got!=info.needed&&(me.done=!1)))},fitItemWidth:function(itemContext,info){var contentWidth,width;info.ownerContext.widthModel.shrinkWrap?(width=itemContext.getProp("width")+info.margins.width,contentWidth=info.contentWidth,void 0===contentWidth?info.contentWidth=width:info.contentWidth=Math.max(contentWidth,width)):itemContext.widthModel.calculated&&(++info.needed,info.targetSize.gotWidth&&(++info.got,this.setItemWidth(itemContext,info))),this.positionItemX(itemContext,info)},fitItemHeight:function(itemContext,info){var contentHeight,height;info.ownerContext.heightModel.shrinkWrap?(height=itemContext.getProp("height")+info.margins.height,contentHeight=info.contentHeight,void 0===contentHeight?info.contentHeight=height:info.contentHeight=Math.max(contentHeight,height)):itemContext.heightModel.calculated&&(++info.needed,info.targetSize.gotHeight&&(++info.got,this.setItemHeight(itemContext,info))),this.positionItemY(itemContext,info)},positionItemX:function(itemContext,info){var margins=info.margins;(info.index||margins.left)&&itemContext.setProp("x",margins.left),margins.width&&itemContext.setProp("margin-right",margins.width)},positionItemY:function(itemContext,info){var margins=info.margins;(info.index||margins.top)&&itemContext.setProp("y",margins.top),margins.height&&itemContext.setProp("margin-bottom",margins.height)},setItemHeight:function(itemContext,info){itemContext.setHeight(info.targetSize.height-info.margins.height)},setItemWidth:function(itemContext,info){itemContext.setWidth(info.targetSize.width-info.margins.width)}}),Ext.define("Ext.panel.Table",{extend:Ext.panel.Panel,alias:"widget.tablepanel",extraBaseCls:Ext.baseCSSPrefix+"grid",extraBodyCls:Ext.baseCSSPrefix+"grid-body",layout:"fit",hasView:!1,viewType:null,selType:"rowmodel",scroll:!0,deferRowRender:!0,sortableColumns:!0,enableLocking:!1,scrollerOwner:!0,enableColumnMove:!0,sealedColumns:!1,enableColumnResize:!0,rowLines:!0,colLinesCls:Ext.baseCSSPrefix+"grid-with-col-lines",rowLinesCls:Ext.baseCSSPrefix+"grid-with-row-lines",noRowLinesCls:Ext.baseCSSPrefix+"grid-no-row-lines",hiddenHeaderCtCls:Ext.baseCSSPrefix+"grid-header-ct-hidden",hiddenHeaderCls:Ext.baseCSSPrefix+"grid-header-hidden",resizeMarkerCls:Ext.baseCSSPrefix+"grid-resize-marker",emptyCls:Ext.baseCSSPrefix+"grid-empty",initComponent:function(){var view,i,len,columns,me=this,headerCtCfg=me.columns||me.colModel,store=me.store=Ext.data.StoreManager.lookup(me.store||"ext-empty-store");if(me.columnLines&&me.addBodyCls(me.colLinesCls),me.addBodyCls(me.rowLines?me.rowLinesCls:me.noRowLinesCls),me.addBodyCls(me.extraBodyCls),headerCtCfg.isRootHeader?(me.headerCt=headerCtCfg,me.headerCt.forceFit=!!me.forceFit,me.columnManager=headerCtCfg.columnManager,me.visibleColumnManager=headerCtCfg.visibleColumnManager):me.enableLocking||me.hasLockedColumns(headerCtCfg)?(me.self.mixin("lockable",Ext.grid.locking.Lockable),me.injectLockable()):(Ext.isArray(headerCtCfg)&&(headerCtCfg={items:headerCtCfg}),Ext.apply(headerCtCfg,{grid:me,forceFit:me.forceFit,sortable:me.sortableColumns,enableColumnMove:me.enableColumnMove,enableColumnResize:me.enableColumnResize,sealed:me.sealedColumns}),Ext.isDefined(me.enableColumnHide)&&(headerCtCfg.enableColumnHide=me.enableColumnHide),me.headerCt||(me.headerCt=new Ext.grid.header.Container(headerCtCfg))),me.columns=columns=me.headerCt.getGridColumns(),me.scrollTask=new Ext.util.DelayedTask(me.syncHorizontalScroll,me),me.addEvents("reconfigure","viewready"),me.cls=me.cls||" "+me.extraBaseCls,delete me.autoScroll,!me.hasView){if(store.buffered&&!store.remoteSort)for(i=0,len=columns.length;i<len;i++)columns[i].sortable=!1;me.hideHeaders&&(me.headerCt.height=0,me.headerCt.hiddenHeaders=!0,me.headerCt.addCls(me.hiddenHeaderCtCls),me.addCls(me.hiddenHeaderCls),Ext.isIEQuirks&&(me.headerCt.style={display:"none"})),me.relayHeaderCtEvents(me.headerCt),me.features=me.features||[],Ext.isArray(me.features)||(me.features=[me.features]),me.dockedItems=[].concat(me.dockedItems||[]),me.dockedItems.unshift(me.headerCt),me.viewConfig=me.viewConfig||{},view=me.getView(),me.items=[view],me.hasView=!0,me.hideHeaders||view.on({scroll:{fn:me.onHorizontalScroll,element:"el",scope:me}}),me.bindStore(store,!0),me.mon(view,{viewready:me.onViewReady,refresh:me.onRestoreHorzScroll,scope:me})}me.relayEvents(me.view,["beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown","beforeitemkeydown","itemkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermousedown","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","beforecontainerkeydown","containermouseup","containermousedown","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","containerkeydown","selectionchange","beforeselect","select","beforedeselect","deselect"]),me.callParent(arguments),me.addStateEvents(["columnresize","columnmove","columnhide","columnshow","sortchange","filterchange","groupchange"]),!me.lockable&&me.headerCt&&me.headerCt.on("afterlayout",me.onRestoreHorzScroll,me)},hasLockedColumns:function(columns){var i,len,column;for(Ext.isObject(columns)&&(columns=columns.items),i=0,len=columns.length;i<len;i++)if(column=columns[i],!column.processed&&column.locked)return!0},relayHeaderCtEvents:function(headerCt){this.relayEvents(headerCt,["columnresize","columnmove","columnhide","columnshow","columnschanged","sortchange","headerclick","headercontextmenu","headertriggerclick"])},getState:function(){var me=this,state=me.callParent(),storeState=me.store.getState();return state=me.addPropertyToState(state,"columns",me.headerCt.getColumnsState()),storeState&&(state.storeState=storeState),state},applyState:function(state){var me=this,sorter=state.sort,storeState=state.storeState,store=me.store,columns=state.columns;delete state.columns,me.callParent(arguments),columns&&me.headerCt.applyColumnsState(columns),sorter?store.remoteSort?store.sort({property:sorter.property,direction:sorter.direction,root:sorter.root},null,!1):store.sort(sorter.property,sorter.direction):storeState&&store.applyState(storeState)},getStore:function(){return this.store},getView:function(){var sm,me=this;return me.view||(sm=me.getSelectionModel(),Ext.widget(Ext.apply({grid:me,deferInitialRefresh:me.deferRowRender!==!1,trackOver:me.trackMouseOver!==!1,scroll:me.scroll,xtype:me.viewType,store:me.store,headerCt:me.headerCt,columnLines:me.columnLines,rowLines:me.rowLines,selModel:sm,features:me.features,panel:me,emptyText:me.emptyText||""},me.viewConfig)),me.view.emptyText&&(me.view.emptyText='<div class="'+me.emptyCls+'">'+me.view.emptyText+"</div>"),me.view.getComponentLayout().headerCt=me.headerCt,me.mon(me.view,{uievent:me.processEvent,scope:me}),sm.view=me.view,me.headerCt.view=me.view),me.view},getColumnManager:function(){return this.columnManager},getVisibleColumnManager:function(){return this.visibleColumnManager},getTopLevelColumnManager:function(){var ownerLock=this.ownerLockable;return ownerLock?ownerLock.getColumnManager():this.getColumnManager()},getTopLevelVisibleColumnManager:function(){var ownerLock=this.ownerLockable;return ownerLock?ownerLock.getVisibleColumnManager():this.getVisibleColumnManager()},setAutoScroll:Ext.emptyFn,processEvent:function(type,view,cell,recordIndex,cellIndex,e,record,row){var header,me=this;if(cellIndex!==-1)return header=me.getColumnManager().getHeaderAtIndex(cellIndex),header.processEvent.apply(header,arguments)},determineScrollbars:function(){},invalidateScroller:function(){},scrollByDeltaY:function(yDelta,animate){this.getView().scrollBy(0,yDelta,animate)},scrollByDeltaX:function(xDelta,animate){this.getView().scrollBy(xDelta,0,animate)},afterCollapse:function(){this.saveScrollPos(),this.callParent(arguments)},afterExpand:function(){this.callParent(arguments),this.restoreScrollPos()},saveScrollPos:Ext.emptyFn,restoreScrollPos:Ext.emptyFn,onHeaderResize:function(){this.delayScroll()},onHeaderMove:function(headerCt,header,colsToMove,fromIdx,toIdx){var me=this;me.optimizedColumnMove===!1?me.view.refresh():me.view.moveColumn(fromIdx,toIdx,colsToMove),me.delayScroll()},onHeaderHide:function(headerCt,header){this.view.refresh(),this.delayScroll()},onHeaderShow:function(headerCt,header){this.view.refresh(),this.delayScroll()},onHeadersChanged:function(headerCt,header){var me=this;me.rendered&&!me.reconfiguring&&(me.view.refresh(),me.delayScroll())},delayScroll:function(){var target=this.getScrollTarget().el;target&&this.scrollTask.delay(10,null,null,[target.dom.scrollLeft])},onViewReady:function(){this.fireEvent("viewready",this)},onRestoreHorzScroll:function(){var left=this.scrollLeftPos;left&&this.syncHorizontalScroll(left,!0)},getScrollerOwner:function(){var rootCmp=this;return this.scrollerOwner||(rootCmp=this.up("[scrollerOwner]")),rootCmp},getLhsMarker:function(){var me=this;return me.lhsMarker||(me.lhsMarker=Ext.DomHelper.append(me.el,{role:"presentation",cls:me.resizeMarkerCls},!0))},getRhsMarker:function(){var me=this;return me.rhsMarker||(me.rhsMarker=Ext.DomHelper.append(me.el,{role:"presentation",cls:me.resizeMarkerCls},!0))},getSelectionModel:function(){var applyMode,mode,type,me=this,selModel=me.selModel;return selModel||(selModel={},applyMode=!0),selModel.events||(type=selModel.selType||me.selType,applyMode=!selModel.mode,selModel=me.selModel=Ext.create("selection."+type,selModel)),me.simpleSelect?mode="SIMPLE":me.multiSelect&&(mode="MULTI"),Ext.applyIf(selModel,{allowDeselect:me.allowDeselect}),mode&&applyMode&&selModel.setSelectionMode(mode),selModel.hasRelaySetup||(me.relayEvents(selModel,["selectionchange","beforeselect","beforedeselect","select","deselect"]),selModel.hasRelaySetup=!0),me.disableSelection&&(selModel.locked=!0),selModel},getScrollTarget:function(){var owner=this.getScrollerOwner(),items=owner.query("tableview");return items[1]||items[0]},onHorizontalScroll:function(event,target){this.syncHorizontalScroll(target.scrollLeft)},syncHorizontalScroll:function(left,setBody){var scrollTarget,me=this;setBody=setBody===!0,me.rendered&&(setBody||left!==me.scrollLeftPos)&&(setBody&&(scrollTarget=me.getScrollTarget(),scrollTarget.el.dom.scrollLeft=left),me.headerCt.el.dom.scrollLeft=left,me.scrollLeftPos=left)},onStoreLoad:Ext.emptyFn,getEditorParent:function(){return this.body},bindStore:function(store,initial){var bufferedRenderer,me=this,view=me.getView(),bufferedStore=store&&store.buffered;me.store=store,bufferedRenderer=me.findPlugin("bufferedrenderer"),bufferedRenderer?(me.verticalScroller=bufferedRenderer,bufferedRenderer.store&&bufferedRenderer.bindStore(store)):bufferedStore&&(me.verticalScroller=bufferedRenderer=me.addPlugin(Ext.apply({ptype:"bufferedrenderer"},me.initialConfig.verticalScroller))),view.store!==store&&view.bindStore(store,!1),me.mon(store,{load:me.onStoreLoad,scope:me}),me.storeRelayers=me.relayEvents(store,["filterchange","groupchange"]),bufferedRenderer&&(me.invalidateScrollerOnRefresh=!1),void 0!==me.invalidateScrollerOnRefresh&&(view.preserveScrollOnRefresh=!me.invalidateScrollerOnRefresh)},unbindStore:function(){var me=this,store=me.store;store&&(me.store=null,me.mun(store,{load:me.onStoreLoad,scope:me}),Ext.destroy(me.storeRelayers))},reconfigure:function(store,columns){var originalDeferinitialRefresh,me=this,view=me.getView(),oldStore=me.store,headerCt=me.headerCt,oldColumns=headerCt?headerCt.items.getRange():me.columns;columns&&(columns=Ext.Array.slice(columns)),me.reconfiguring=!0,me.fireEvent("beforereconfigure",me,store,columns,oldStore,oldColumns),me.lockable?me.reconfigureLockable(store,columns):(Ext.suspendLayouts(),columns&&(delete me.scrollLeftPos,headerCt.removeAll(),headerCt.add(columns)),store&&(store=Ext.StoreManager.lookup(store))!==oldStore?(me.store&&me.unbindStore(),originalDeferinitialRefresh=view.deferInitialRefresh,view.deferInitialRefresh=!1,me.bindStore(store),view.deferInitialRefresh=originalDeferinitialRefresh):me.getView().refresh(),headerCt.setSortState(),Ext.resumeLayouts(!0)),me.fireEvent("reconfigure",me,store,columns,oldStore,oldColumns),delete me.reconfiguring},beforeDestroy:function(){var task=this.scrollTask;task&&(task.cancel(),this.scrollTask=null),this.callParent()},onDestroy:function(){var me=this;me.lockable&&me.destroyLockable(),me.callParent(),me.columns=me.storeRelayers=me.columnManager=me.visibleColumnManager=null},destroy:function(){var me=this;me.callParent(),me.isDestroyed&&(me.view=me.selModel=me.headerCt=null)}}),Ext.define("Ext.util.CSS",function(){var CSS,rules=null,doc=document,camelRe=/(-[a-z])/gi,camelFn=function(m,a){return a.charAt(1).toUpperCase()};return{singleton:!0,rules:rules,initialized:!1,constructor:function(){CSS=this},createStyleSheet:function(cssText,id){var ss,head=doc.getElementsByTagName("head")[0],styleEl=doc.createElement("style");if(styleEl.setAttribute("type","text/css"),id&&styleEl.setAttribute("id",id),Ext.isIE)head.appendChild(styleEl),ss=styleEl.styleSheet,ss.cssText=cssText;else{try{styleEl.appendChild(doc.createTextNode(cssText))}catch(e){styleEl.cssText=cssText}head.appendChild(styleEl),ss=styleEl.styleSheet?styleEl.styleSheet:styleEl.sheet||doc.styleSheets[doc.styleSheets.length-1]}return CSS.cacheStyleSheet(ss),ss},removeStyleSheet:function(id){var existing=doc.getElementById(id);existing&&existing.parentNode.removeChild(existing)},swapStyleSheet:function(id,url){var ss;CSS.removeStyleSheet(id),ss=doc.createElement("link"),ss.setAttribute("rel","stylesheet"),ss.setAttribute("type","text/css"),ss.setAttribute("id",id),ss.setAttribute("href",url),doc.getElementsByTagName("head")[0].appendChild(ss)},refreshCache:function(){return CSS.getRules(!0)},cacheStyleSheet:function(ss){rules||(rules=CSS.rules={});try{var rule,j,ssRules=ss.cssRules||ss.rules,i=ssRules.length-1,imports=ss.imports,len=imports?imports.length:0;for(j=0;j<len;++j)CSS.cacheStyleSheet(imports[j]);for(;i>=0;--i)rule=ssRules[i],rule.styleSheet&&CSS.cacheStyleSheet(rule.styleSheet),CSS.cacheRule(rule,ss)}catch(e){}},cacheRule:function(cssRule,styleSheet){if(cssRule.styleSheet)return CSS.cacheStyleSheet(cssRule.styleSheet);var selectorCount,j,selectorText=cssRule.selectorText;if(selectorText)for(selectorText=selectorText.split(","),selectorCount=selectorText.length,j=0;j<selectorCount;j++)rules[Ext.String.trim(selectorText[j]).toLowerCase()]={parentStyleSheet:styleSheet,cssRule:cssRule}},getRules:function(refreshCache){var selector,result={};(null===rules||refreshCache)&&CSS.refreshCache();for(selector in rules)result[selector]=rules[selector].cssRule;return result},refreshCache:function(){var ds=doc.styleSheets,i=0,len=ds.length;for(rules=CSS.rules={};i<len;i++)try{ds[i].disabled||CSS.cacheStyleSheet(ds[i])}catch(e){}},getRule:function(selector,refreshCache,rawCache){var i,result;if(rules&&!refreshCache||CSS.refreshCache(),!Ext.isArray(selector))return result=rules[selector.toLowerCase()],result&&!rawCache&&(result=result.cssRule),result||null;for(i=0;i<selector.length;i++)if(rules[selector[i]])return rawCache?rules[selector[i].toLowerCase()]:rules[selector[i].toLowerCase()].cssRule;return null},createRule:function(styleSheet,selector,cssText){var result,ruleSet=styleSheet.cssRules||styleSheet.rules,index=ruleSet.length;return styleSheet.insertRule?styleSheet.insertRule(selector+"{"+cssText+"}",index):styleSheet.addRule(selector,cssText||" "),CSS.cacheRule(result=ruleSet[index],styleSheet),result},updateRule:function(selector,property,value){var rule,i,styles;if(Ext.isArray(selector)){for(i=0;i<selector.length;i++)if(CSS.updateRule(selector[i],property,value))return!0}else if(rule=CSS.getRule(selector)){if(2==arguments.length){styles=Ext.Element.parseStyles(property);for(property in styles)rule.style[property.replace(camelRe,camelFn)]=styles[property]}else rule.style[property.replace(camelRe,camelFn)]=value;return!0}return!1},deleteRule:function(selector){var styleSheet,index,rule=CSS.getRule(selector,!1,!0);rule&&(styleSheet=rule.parentStyleSheet,index=Ext.Array.indexOf(styleSheet.cssRules||styleSheet.rules,rule.cssRule),styleSheet.deleteRule?styleSheet.deleteRule(index):styleSheet.removeRule(index),delete rules[selector])}}}),Ext.define("Ext.view.TableLayout",{extend:Ext.layout.component.Auto,alias:["layout.tableview"],type:"tableview",beginLayout:function(ownerContext){var me=this,otherSide=me.owner.lockingPartner,owner=me.owner;me.callParent(arguments),otherSide&&(me.lockedGrid=me.owner.up("[lockable]"),me.lockedGrid.needsRowHeightSync=!0,ownerContext.lockingPartner||(ownerContext.lockingPartner=ownerContext.context.getItem(otherSide,otherSide.el),ownerContext.lockingPartner&&!ownerContext.lockingPartner.lockingPartner&&(ownerContext.lockingPartner.lockingPartner=ownerContext))),ownerContext.headerContext=ownerContext.context.getCmp(me.headerCt),me.owner.body.dom&&(ownerContext.bodyContext=ownerContext.getEl(me.owner.body)),Ext.isWebKit&&owner.el.select(owner.getBodySelector()).setStyle("table-layout","auto")},calculate:function(ownerContext){var emptyEl,me=this,lockingPartner=me.lockingPartner,owner=me.owner,contentHeight=0;if(ownerContext.headerContext.hasProp("columnWidthsDone")){if(!me.setColumnWidths(ownerContext))return void(me.done=!1);ownerContext.state.columnWidthsSynced=!0,ownerContext.bodyContext&&(emptyEl=me.owner.el.down("."+owner.ownerCt.emptyCls,!0),emptyEl?contentHeight=emptyEl.offsetHeight:(contentHeight=ownerContext.bodyContext.el.dom.offsetHeight,ownerContext.bodyContext.setHeight(contentHeight,!1)),ownerContext.headerContext.state.boxPlan.tooNarrow&&ownerContext.ownerCtContext.sizeModel.height.shrinkWrap&&(contentHeight+=Ext.getScrollbarSize().height),ownerContext.setProp("contentHeight",contentHeight)),lockingPartner&&!lockingPartner.state.columnWidthsSynced?me.done=!1:me.callParent(arguments)}else me.done=!1},measureContentHeight:function(ownerContext){var lockingPartner=ownerContext.lockingPartner;if(!ownerContext.bodyContext||ownerContext.state.columnWidthsSynced&&(!lockingPartner||lockingPartner.state.columnWidthsSynced))return this.callParent(arguments)},setColumnWidths:function(ownerContext){var column,childContext,colWidth,me=this,owner=me.owner,context=ownerContext.context,columns=me.headerCt.getVisibleGridColumns(),i=0,len=columns.length,tableWidth=0,columnLineWidth=0,isContentBox=!Ext.isBorderBox;for(context&&(context.currentLayout=me),i=0;i<len;i++){if(column=columns[i],childContext=context.getCmp(column),colWidth=childContext.props.width,isNaN(colWidth))return childContext.getProp("width"),!1;tableWidth+=colWidth,isContentBox&&owner.columnLines&&(columnLineWidth||(columnLineWidth=context.getCmp(column).borderInfo.width||1),colWidth-=columnLineWidth),owner.body.select(owner.getColumnSizerSelector(column)).setWidth(colWidth)}return owner.el.select(owner.getBodySelector()).setWidth(tableWidth),!0},finishedLayout:function(){var me=this,owner=me.owner;me.callParent(arguments),Ext.isWebKit&&owner.el.select(owner.getBodySelector()).setStyle("table-layout",""),owner.refreshCounter&&me.lockedGrid&&me.lockedGrid.syncRowHeight&&me.lockedGrid.needsRowHeightSync&&(me.lockedGrid.syncRowHeights(),me.lockedGrid.needsRowHeightSync=!1)}}),Ext.define("Ext.view.NodeCache",{constructor:function(view){this.view=view,this.clear(),this.el=new Ext.dom.AbstractElement.Fly},clear:function(removeDom){var i,el,me=this,elements=this.elements;if(removeDom)for(i in elements)el=elements[i],el.parentNode.removeChild(el);me.elements={},me.count=me.startIndex=0,me.endIndex=-1},fill:function(newElements,startIndex){var i,me=this,elements=me.elements={},len=newElements.length;for(startIndex||(startIndex=0),i=0;i<len;i++)elements[startIndex+i]=newElements[i];return me.startIndex=startIndex,me.endIndex=startIndex+len-1,me.count=len,this},insert:function(insertPoint,nodes){var i,me=this,elements=me.elements,nodeCount=nodes.length;if(me.count){if(insertPoint<me.count)for(i=me.endIndex+nodeCount;i>=insertPoint+nodeCount;i--)elements[i]=elements[i-nodeCount],elements[i].setAttribute("data-recordIndex",i);me.endIndex=me.endIndex+nodeCount}else me.startIndex=insertPoint,me.endIndex=insertPoint+nodeCount-1;for(i=0;i<nodeCount;i++,insertPoint++)elements[insertPoint]=nodes[i],elements[insertPoint].setAttribute("data-recordIndex",insertPoint);me.count+=nodeCount},item:function(index,asDom){var el=this.elements[index],result=null;return el&&(result=asDom?this.elements[index]:this.el.attach(this.elements[index])),result},first:function(asDom){return this.item(this.startIndex,asDom)},last:function(asDom){return this.item(this.endIndex,asDom)},getCount:function(){return this.count},slice:function(start,end){var i,elements=this.elements,result=[];for(end=arguments.length<2?this.endIndex:Math.min(this.endIndex,end-1),i=start||this.startIndex;i<=end;i++)result.push(elements[i]);return result},replaceElement:function(el,replacement,domReplace){var elements=this.elements,index="number"==typeof el?el:this.indexOf(el);return index>-1&&(replacement=Ext.getDom(replacement),domReplace&&(el=elements[index],el.parentNode.insertBefore(replacement,el),Ext.removeNode(el),replacement.setAttribute("data-recordIndex",index)),this.elements[index]=replacement),this},indexOf:function(el){var index,elements=this.elements;for(el=Ext.getDom(el),index=this.startIndex;index<=this.endIndex;index++)if(elements[index]===el)return index;return-1},removeRange:function(start,end,removeDom){var el,i,removeCount,fromPos,me=this,elements=me.elements;for(end=void 0===end?me.count:Math.min(me.endIndex+1,end+1),start||(start=0),removeCount=end-start,i=start,fromPos=end;i<me.endIndex;i++,fromPos++)removeDom&&i<end&&Ext.removeNode(elements[i]),fromPos<=me.endIndex?(el=elements[i]=elements[fromPos],el.setAttribute("data-recordIndex",i)):delete elements[i];me.count-=removeCount,me.endIndex-=removeCount},removeElement:function(keys,removeDom){var inKeys,key,el,deleteCount,index,fromIndex,me=this,elements=me.elements,keyIndex=0;if(Ext.isArray(keys)){for(inKeys=keys,keys=[],deleteCount=inKeys.length,keyIndex=0;keyIndex<deleteCount;keyIndex++)key=inKeys[keyIndex],"number"!=typeof key&&(key=me.indexOf(key)),key>=me.startIndex&&key<=me.endIndex&&(keys[keys.length]=key);Ext.Array.sort(keys),deleteCount=keys.length}else{if(keys<me.startIndex||keys>me.endIndex)return;deleteCount=1,keys=[keys]}for(index=fromIndex=keys[0],keyIndex=0;index<=me.endIndex;index++,fromIndex++)keyIndex<deleteCount&&index===keys[keyIndex]&&(fromIndex++,keyIndex++,removeDom&&Ext.removeNode(elements[index])),fromIndex<=me.endIndex&&fromIndex>=me.startIndex?(el=elements[index]=elements[fromIndex],el.setAttribute("data-recordIndex",index)):delete elements[index];me.endIndex-=deleteCount,me.count-=deleteCount},scroll:function(newRecords,direction,removeCount){var i,el,removeEnd,newNodes,me=this,elements=me.elements,recCount=newRecords.length,nodeContainer=me.view.getNodeContainer(),frag=document.createDocumentFragment();if(direction==-1){for(i=me.endIndex-removeCount+1;i<=me.endIndex;i++)el=elements[i],delete elements[i],el.parentNode.removeChild(el);for(me.endIndex-=removeCount,newNodes=me.view.bufferRender(newRecords,me.startIndex-=recCount),i=0;i<recCount;i++)elements[me.startIndex+i]=newNodes[i],frag.appendChild(newNodes[i]);nodeContainer.insertBefore(frag,nodeContainer.firstChild)}else{for(removeEnd=me.startIndex+removeCount,i=me.startIndex;i<removeEnd;i++)el=elements[i],delete elements[i],el.parentNode.removeChild(el);for(me.startIndex=i,newNodes=me.view.bufferRender(newRecords,me.endIndex+1),
i=0;i<recCount;i++)elements[me.endIndex+=1]=newNodes[i],frag.appendChild(newNodes[i]);nodeContainer.appendChild(frag)}me.count=me.endIndex-me.startIndex+1}}),Ext.define("Ext.view.Table",{extend:Ext.view.View,alias:"widget.tableview",componentLayout:"tableview",baseCls:Ext.baseCSSPrefix+"grid-view",unselectableCls:Ext.baseCSSPrefix+"unselectable",firstCls:Ext.baseCSSPrefix+"grid-cell-first",lastCls:Ext.baseCSSPrefix+"grid-cell-last",headerRowSelector:"tr."+Ext.baseCSSPrefix+"grid-header-row",selectedItemCls:Ext.baseCSSPrefix+"grid-row-selected",beforeSelectedItemCls:Ext.baseCSSPrefix+"grid-row-before-selected",selectedCellCls:Ext.baseCSSPrefix+"grid-cell-selected",focusedItemCls:Ext.baseCSSPrefix+"grid-row-focused",beforeFocusedItemCls:Ext.baseCSSPrefix+"grid-row-before-focused",tableFocusedFirstCls:Ext.baseCSSPrefix+"grid-table-focused-first",tableSelectedFirstCls:Ext.baseCSSPrefix+"grid-table-selected-first",tableOverFirstCls:Ext.baseCSSPrefix+"grid-table-over-first",overItemCls:Ext.baseCSSPrefix+"grid-row-over",beforeOverItemCls:Ext.baseCSSPrefix+"grid-row-before-over",altRowCls:Ext.baseCSSPrefix+"grid-row-alt",dirtyCls:Ext.baseCSSPrefix+"grid-dirty-cell",rowClsRe:new RegExp("(?:^|\\s*)"+Ext.baseCSSPrefix+"grid-row-(first|last|alt)(?:\\s+|$)","g"),cellRe:new RegExp(Ext.baseCSSPrefix+"grid-cell-headerId-([^\\s]+)(?:\\s|$)",""),positionBody:!0,trackOver:!0,getRowClass:null,stripeRows:!0,markDirty:!0,ariaRole:"grid",tpl:"{%values.view.tableTpl.applyOut(values, out)%}",tableTpl:["{%",'var view=values.view,tableCls="'+Ext.baseCSSPrefix+'" + view.id + "-table '+Ext.baseCSSPrefix+'grid-table";',"%}",'<table id="{view.id}-table" class="{[tableCls]}" border="0" cellspacing="0" cellpadding="0" style="{tableStyle}" {ariaTableAttr}>',"{[view.renderColumnSizer(out)]}","{[view.renderTHead(values, out)]}","{[view.renderTFoot(values, out)]}",'<tbody id="{view.id}-body" {ariaTbodyAttr}>',"{%","view.renderRows(values.rows, values.viewStartIndex, out);","%}","</tbody>","</table>",{priority:0}],rowTpl:["{%",'var dataRowCls = values.recordIndex === -1 ? "" : " '+Ext.baseCSSPrefix+'grid-data-row";',"%}",'<tr {[values.rowId ? ("id=\\"" + values.rowId + "\\"") : ""]} ','data-boundView="{view.id}" ','data-recordId="{record.internalId}" ','data-recordIndex="{recordIndex}" ','class="{[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]}{[dataRowCls]}" ','{rowAttr:attributes} tabIndex="-1" {ariaRowAttr}>','<tpl for="columns">{%',"parent.view.renderCell(values, parent.record, parent.recordIndex, parent.rowIndex, xindex - 1, out, parent)","%}","</tpl>","</tr>",{priority:0}],cellTpl:['<td class="{tdCls}" {tdAttr} {[Ext.aria ? "id=\\"" + Ext.id() + "\\"" : ""]} {ariaCellAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner {innerCls}"','style="text-align:{align};<tpl if="style">{style}</tpl>" {ariaCellInnerAttr}>{value}</div>',"</td>",{priority:0}],refreshSelmodelOnRefresh:!1,tableValues:{},rowValues:{itemClasses:[],rowClasses:[]},cellValues:{classes:[Ext.baseCSSPrefix+"grid-cell "+Ext.baseCSSPrefix+"grid-td"]},renderBuffer:document.createElement("div"),constructor:function(config){config.grid.isTree&&(config.baseCls=Ext.baseCSSPrefix+"tree-view"),this.callParent([config])},initComponent:function(){var me=this,scroll=me.scroll;this.addEvents("beforecellclick","cellclick","beforecelldblclick","celldblclick","beforecellcontextmenu","cellcontextmenu","beforecellmousedown","cellmousedown","beforecellmouseup","cellmouseup","beforecellkeydown","cellkeydown"),me.body=new Ext.dom.Element.Fly,me.body.id=me.id+"gridBody",me.autoScroll=void 0,me.trackOver||(me.overItemCls=null,me.beforeOverItemCls=null),scroll===!0||"both"===scroll?me.autoScroll=!0:"horizontal"===scroll?me.overflowX="auto":"vertical"===scroll&&(me.overflowY="auto"),me.selModel.view=me.headerCt.view=me,me.grid.view=me,me.initFeatures(me.grid),delete me.grid,me.itemSelector=me.getItemSelector(),me.all=new Ext.view.NodeCache(me),me.callParent()},getVisibleColumnManager:function(){var owner=this.ownerCt,lock=owner.ownerLockable;return lock?lock.getVisibleColumnManager():owner.getVisibleColumnManager()},moveColumn:function(fromIdx,toIdx,colsToMove){var i,j,rows,len,tr,cells,tables,me=this,fragment=colsToMove>1?document.createDocumentFragment():void 0,destinationCellIdx=toIdx,colCount=me.getGridColumns().length,lastIndex=colCount-1,doFirstLastClasses=(me.firstCls||me.lastCls)&&(0===toIdx||toIdx==colCount||0===fromIdx||fromIdx==lastIndex);if(me.rendered&&toIdx!==fromIdx){for(rows=me.el.query(me.getDataRowSelector()),toIdx>fromIdx&&fragment&&(destinationCellIdx-=colsToMove),i=0,len=rows.length;i<len;i++){if(tr=rows[i],cells=tr.childNodes,doFirstLastClasses){if(1===cells.length){Ext.fly(cells[0]).addCls(me.firstCls),Ext.fly(cells[0]).addCls(me.lastCls);continue}0===fromIdx?(Ext.fly(cells[0]).removeCls(me.firstCls),Ext.fly(cells[1]).addCls(me.firstCls)):fromIdx===lastIndex&&(Ext.fly(cells[lastIndex]).removeCls(me.lastCls),Ext.fly(cells[lastIndex-1]).addCls(me.lastCls)),0===toIdx?(Ext.fly(cells[0]).removeCls(me.firstCls),Ext.fly(cells[fromIdx]).addCls(me.firstCls)):toIdx===colCount&&(Ext.fly(cells[lastIndex]).removeCls(me.lastCls),Ext.fly(cells[fromIdx]).addCls(me.lastCls))}if(fragment){for(j=0;j<colsToMove;j++)fragment.appendChild(cells[fromIdx]);tr.insertBefore(fragment,cells[destinationCellIdx]||null)}else tr.insertBefore(cells[fromIdx],cells[destinationCellIdx]||null)}for(tables=me.el.query(me.getBodySelector()),i=0,len=tables.length;i<len;i++)if(tr=tables[i],fragment){for(j=0;j<colsToMove;j++)fragment.appendChild(tr.childNodes[fromIdx]);tr.insertBefore(fragment,tr.childNodes[destinationCellIdx]||null)}else tr.insertBefore(tr.childNodes[fromIdx],tr.childNodes[destinationCellIdx]||null)}},scrollToTop:Ext.emptyFn,addElListener:function(eventName,fn,scope){this.mon(this,eventName,fn,scope,{element:"el"})},getGridColumns:function(){return this.ownerCt.getVisibleColumnManager().getColumns()},getHeaderAtIndex:function(index){return this.ownerCt.getVisibleColumnManager().getHeaderAtIndex(index)},getCell:function(record,column){var row=this.getNode(record,!0);return Ext.fly(row).down(column.getCellSelector())},getFeature:function(id){var features=this.featuresMC;if(features)return features.get(id)},findFeature:function(ftype){if(this.features)return Ext.Array.findBy(this.features,function(feature){if(feature.ftype===ftype)return!0})},initFeatures:function(grid){var i,features,feature,len,me=this;for(me.tableTpl=Ext.XTemplate.getTpl(this,"tableTpl"),me.rowTpl=Ext.XTemplate.getTpl(this,"rowTpl"),me.cellTpl=Ext.XTemplate.getTpl(this,"cellTpl"),me.featuresMC=new Ext.util.MixedCollection,features=me.features=me.constructFeatures(),len=features?features.length:0,i=0;i<len;i++)feature=features[i],feature.view=me,feature.grid=grid,me.featuresMC.add(feature),feature.init(grid)},renderTHead:function(values,out){var len,i,headers=values.view.headerFns;if(headers)for(i=0,len=headers.length;i<len;++i)headers[i].call(this,values,out)},addHeaderFn:function(){var headers=this.headerFns;headers||(headers=this.headerFns=[]),headers.push(fn)},renderTFoot:function(values,out){var len,i,footers=values.view.footerFns;if(footers)for(i=0,len=footers.length;i<len;++i)footers[i].call(this,values,out)},addFooterFn:function(fn){var footers=this.footerFns;footers||(footers=this.footerFns=[]),footers.push(fn)},addTableTpl:function(newTpl){return this.addTpl("tableTpl",newTpl)},addRowTpl:function(newTpl){return this.addTpl("rowTpl",newTpl)},addCellTpl:function(newTpl){return this.addTpl("cellTpl",newTpl)},addTpl:function(which,newTpl){var tpl,prevTpl,me=this;for(newTpl=Ext.Object.chain(newTpl),newTpl.isTemplate||(newTpl.applyOut=me.tplApplyOut),tpl=me[which];newTpl.priority<tpl.priority;tpl=tpl.nextTpl)prevTpl=tpl;return prevTpl?prevTpl.nextTpl=newTpl:me[which]=newTpl,newTpl.nextTpl=tpl,newTpl},tplApplyOut:function(values,out){this.before&&this.before(values,out)===!1||(this.nextTpl.applyOut(values,out),this.after&&this.after(values,out))},constructFeatures:function(){var feature,result,len,me=this,features=me.features,i=0;if(features)for(result=[],len=features.length;i<len;i++)feature=features[i],feature.isFeature||(feature=Ext.create("feature."+feature.ftype,feature)),result[i]=feature;return result},beforeRender:function(){var me=this;me.callParent(),me.enableTextSelection||me.protoEl.unselectable()},onViewScroll:function(e,t){this.ignoreScroll||(this.callParent(arguments),this.fireEvent("bodyscroll",e,t))},createRowElement:function(record,index){var me=this,div=me.renderBuffer;return me.tpl.overwrite(div,me.collectData([record],index)),Ext.fly(div).down(me.getNodeContainerSelector(),!0).firstChild},bufferRender:function(records,index){var me=this,div=me.renderBuffer;return me.tpl.overwrite(div,me.collectData(records,index)),Ext.Array.toArray(Ext.fly(div).down(me.getNodeContainerSelector(),!0).childNodes)},collectData:function(records,startIndex){return this.rowValues.view=this,{view:this,rows:records,viewStartIndex:startIndex,tableStyle:this.bufferedRenderer?"position:absolute;top:"+this.bufferedRenderer.bodyTop:""}},collectNodes:function(targetEl){this.all.fill(this.getNodeContainer().childNodes,this.all.startIndex)},refreshSize:function(){var grid,me=this,bodySelector=me.getBodySelector();bodySelector&&me.body.attach(me.el.child(bodySelector,!0)),me.hasLoadingHeight||(grid=me.up("tablepanel"),Ext.suspendLayouts(),me.callParent(),grid.updateLayout(),Ext.resumeLayouts(!0))},statics:{getBoundView:function(node){return Ext.getCmp(node.getAttribute("data-boundView"))}},getRecord:function(node){var recordIndex,me=this;if(!me.store.isDestroyed)return node=me.getNode(node),node?!me.hasActiveGrouping()&&(recordIndex=node.getAttribute("data-recordIndex"),recordIndex&&(recordIndex=parseInt(recordIndex,10),recordIndex>-1))?me.store.data.getAt(recordIndex):me.store.getByInternalId(node.getAttribute("data-recordId")):void 0},indexOf:function(node){return node=this.getNode(node,!1),node||0===node?this.all.indexOf(node):-1},indexInStore:function(node){if(node=node.isCollapsedPlaceholder?this.getNode(node):this.getNode(node,!1),!node&&0!==node)return-1;var recordIndex=node.getAttribute("data-recordIndex");return recordIndex?parseInt(recordIndex,10):this.dataSource.indexOf(this.getRecord(node))},renderRows:function(rows,viewStartIndex,out){var i,rowValues=this.rowValues,rowCount=rows.length;for(rowValues.view=this,rowValues.columns=this.ownerCt.getVisibleColumnManager().getColumns(),i=0;i<rowCount;i++,viewStartIndex++)rowValues.itemClasses.length=rowValues.rowClasses.length=0,this.renderRow(rows[i],viewStartIndex,out);rowValues.view=rowValues.columns=rowValues.record=null},renderColumnSizer:function(out){var i,column,width,columns=this.getGridColumns(),len=columns.length;for(i=0;i<len;i++)column=columns[i],width=column.hidden?0:column.lastBox?column.lastBox.width:Ext.grid.header.Container.prototype.defaultWidth,out.push('<colgroup role="presentation"><col role="presentation" class="',columns[i].getCellId(),'" style="width:'+width+'px"></colgroup>')},renderRow:function(record,rowIdx,out){var cls,me=this,isMetadataRecord=rowIdx===-1,selModel=me.selModel,rowValues=me.rowValues,itemClasses=rowValues.itemClasses,rowClasses=rowValues.rowClasses,rowTpl=me.rowTpl;return rowValues.record=record,rowValues.recordId=record.internalId,rowValues.recordIndex=me.store.indexOf(record),rowValues.rowIndex=rowIdx,rowValues.rowId=me.getRowId(record),rowValues.itemCls=rowValues.rowCls="",rowValues.columns||(rowValues.columns=me.ownerCt.getVisibleColumnManager().getColumns()),itemClasses.length=rowClasses.length=0,isMetadataRecord||(itemClasses[0]=Ext.baseCSSPrefix+"grid-row",!me.ownerCt.disableSelection&&selModel.isRowSelected&&(selModel.isRowSelected(record)&&itemClasses.push(me.selectedItemCls),me.rowValues.recordIndex<me.store.getTotalCount()-1&&selModel.isRowSelected(me.rowValues.recordIndex+1)&&!me.isRowStyleFirst(rowIdx+1)&&rowClasses.push(me.beforeSelectedItemCls)),me.stripeRows&&rowIdx%2!==0&&rowClasses.push(me.altRowCls),me.getRowClass&&(cls=me.getRowClass(record,rowIdx,null,me.dataSource),cls&&rowClasses.push(cls))),out?void rowTpl.applyOut(rowValues,out):rowTpl.apply(rowValues)},renderCell:function(column,record,recordIndex,rowIndex,columnIndex,out){var fullIndex,value,clsInsertPoint,me=this,selModel=me.selModel,cellValues=me.cellValues,classes=cellValues.classes,fieldValue=record.data[column.dataIndex],cellTpl=me.cellTpl;cellValues.record=record,cellValues.column=column,cellValues.recordIndex=recordIndex,cellValues.rowIndex=rowIndex,cellValues.columnIndex=columnIndex,cellValues.cellIndex=columnIndex,cellValues.align=column.align,cellValues.tdCls=column.tdCls,cellValues.innerCls=column.innerCls,cellValues.style=cellValues.tdAttr="",cellValues.unselectableAttr=me.enableTextSelection?"":'unselectable="on"',column.renderer&&column.renderer.call?(fullIndex=me.ownerCt.columnManager.getHeaderIndex(column),value=column.renderer.call(column.scope||me.ownerCt,fieldValue,cellValues,record,recordIndex,fullIndex,me.dataSource,me),cellValues.css&&(record.cssWarning=!0,cellValues.tdCls+=" "+cellValues.css,delete cellValues.css)):value=fieldValue,cellValues.value=null==value||""===value?"&#160;":value,classes[1]=column.getCellId(),clsInsertPoint=2,column.tdCls&&(classes[clsInsertPoint++]=column.tdCls),me.markDirty&&record.isModified(column.dataIndex)&&(classes[clsInsertPoint++]=me.dirtyCls),column.isFirstVisible&&(classes[clsInsertPoint++]=me.firstCls),column.isLastVisible&&(classes[clsInsertPoint++]=me.lastCls),me.enableTextSelection||(classes[clsInsertPoint++]=me.unselectableCls),cellValues.tdCls&&(classes[clsInsertPoint++]=cellValues.tdCls),selModel&&selModel.isCellModel&&selModel.isCellSelected(me,recordIndex,columnIndex)&&(classes[clsInsertPoint++]=me.selectedCellCls),classes.length=clsInsertPoint,cellValues.tdCls=classes.join(" "),cellTpl.applyOut(cellValues,out),cellValues.column=null},getNode:function(nodeInfo,dataRow){var fly,result=this.callParent(arguments);if(result&&result.tagName)if(dataRow){if(!(fly=Ext.fly(result)).is(this.dataRowSelector))return fly.down(this.dataRowSelector,!0)}else if(dataRow===!1&&!(fly=Ext.fly(result)).is(this.itemSelector))return fly.up(this.itemSelector,null,!0);return result},getRowId:function(record){return this.id+"-record-"+record.internalId},constructRowId:function(internalId){return this.id+"-record-"+internalId},getNodeById:function(id,dataRow){return id=this.constructRowId(id),this.retrieveNode(id,dataRow)},getNodeByRecord:function(record,dataRow){var id=this.getRowId(record);return this.retrieveNode(id,dataRow)},retrieveNode:function(id,dataRow){var fly,result=this.el.getById(id,!0),itemSelector=this.itemSelector;return dataRow===!1&&result&&!(fly=Ext.fly(result)).is(itemSelector)?fly.up(itemSelector,null,!0):result},updateIndexes:Ext.emptyFn,bodySelector:"table",nodeContainerSelector:"tbody",itemSelector:"tr."+Ext.baseCSSPrefix+"grid-row",dataRowSelector:"tr."+Ext.baseCSSPrefix+"grid-data-row",cellSelector:"td."+Ext.baseCSSPrefix+"grid-cell",sizerSelector:"col."+Ext.baseCSSPrefix+"grid-cell-headerId",innerSelector:"div."+Ext.baseCSSPrefix+"grid-cell-inner",getNodeContainer:function(){return this.el.down(this.nodeContainerSelector,!0)},getBodySelector:function(){return this.bodySelector+"."+Ext.baseCSSPrefix+this.id+"-table"},getNodeContainerSelector:function(){return this.nodeContainerSelector},getColumnSizerSelector:function(header){return this.sizerSelector+"-"+header.getItemId()},getItemSelector:function(){return this.itemSelector},getDataRowSelector:function(){return this.dataRowSelector},getCellSelector:function(header){return header?header.getCellSelector():this.cellSelector},getCellInnerSelector:function(header){return this.getCellSelector(header)+" "+this.innerSelector},addRowCls:function(rowInfo,cls){var row=this.getNode(rowInfo,!1);row&&Ext.fly(row).addCls(cls)},removeRowCls:function(rowInfo,cls){var row=this.getNode(rowInfo,!1);row&&Ext.fly(row).removeCls(cls)},setHighlightedItem:function(item){var me=this,highlighted=me.highlightedItem;highlighted&&me.el.isAncestor(highlighted)&&me.isRowStyleFirst(highlighted)&&me.toggleRowTableCls(highlighted,me.tableOverFirstCls,!1),item=me.getNode(item,!1),item&&me.isRowStyleFirst(item)&&me.toggleRowTableCls(item,me.tableOverFirstCls,!0),me.callParent(arguments)},onRowSelect:function(rowIdx){var me=this,beforeSelectedItemCls=me.beforeSelectedItemCls;me.addRowCls(rowIdx,me.selectedItemCls),me.isRowStyleFirst(rowIdx)?(me.toggleRowTableCls(rowIdx,me.tableSelectedFirstCls,!0),rowIdx>0&&me.removeRowCls(rowIdx-1,beforeSelectedItemCls)):me.addRowCls(rowIdx-1,beforeSelectedItemCls)},onRowDeselect:function(rowIdx){var me=this;me.removeRowCls(rowIdx,[me.selectedItemCls,me.focusedItemCls]),me.isRowStyleFirst(rowIdx)?me.toggleRowTableCls(rowIdx,[me.tableFocusedFirstCls,me.tableSelectedFirstCls],!1):me.removeRowCls(rowIdx-1,[me.beforeFocusedItemCls,me.beforeSelectedItemCls])},onCellSelect:function(position){var cell=this.getCellByPosition(position);cell&&cell.addCls(this.selectedCellCls)},onCellDeselect:function(position){var cell=this.getCellByPosition(position,!0);cell&&Ext.fly(cell).removeCls(this.selectedCellCls)},getCellByPosition:function(position,returnDom){if(position){var row=this.getNode(position.row,!0),header=this.ownerCt.getColumnManager().getHeaderAtIndex(position.column);if(header&&row)return Ext.fly(row).down(this.getCellSelector(header),returnDom)}return!1},getFocusEl:function(){return this.focusEl},onRowFocus:function(rowIdx,highlight,supressFocus){var me=this;highlight?(me.addRowCls(rowIdx,me.focusedItemCls),me.isRowStyleFirst(rowIdx)?me.toggleRowTableCls(rowIdx,me.tableFocusedFirstCls,!0):me.addRowCls(rowIdx-1,me.beforeFocusedItemCls),supressFocus||me.focusRow(rowIdx)):(me.removeRowCls(rowIdx,me.focusedItemCls),me.isRowStyleFirst(rowIdx)?me.toggleRowTableCls(rowIdx,me.tableFocusedFirstCls,!1):me.removeRowCls(rowIdx-1,me.beforeFocusedItemCls)),!Ext.isIE6&&!Ext.isIE7||me.ownerCt.rowLines||me.repaintRow(rowIdx)},focusRow:function(row,delay){var record,me=this,focusTask=me.getFocusTask();return delay?void focusTask.delay(Ext.isNumber(delay)?delay:10,me.focusRow,me,[row,!1]):(focusTask.cancel(),void(me.isVisible(!0)&&(row=me.getNode(row,!0))&&(me.scrollRowIntoView(row),record=me.getRecord(row),me.selModel.setLastFocused(record),me.doFocus(row),me.fireEvent("rowfocus",record,row,me.indexInStore(row)))))},scrollRowIntoView:function(row){row=this.getNode(row,!0),row&&Ext.fly(row).scrollIntoView(this.el,!1)},focusCell:function(position,delay){var cell,me=this,focusTask=me.getFocusTask();return delay?void focusTask.delay(Ext.isNumber(delay)?delay:10,me.focusCell,me,[position,!1]):(focusTask.cancel(),void(me.isVisible(!0)&&(cell=me.getCellByPosition(position))&&(me.scrollCellIntoView(cell),me.doFocus(me.getNode(position.row)),me.fireEvent("cellfocus",position.record,cell,position))))},doFocus:function(rowDom){var scrollLeft,me=this,saveScroll=Ext.isIE;saveScroll&&(scrollLeft=me.el.getScrollLeft(),me.ignoreScroll=!0),(me.focusEl=Ext.get(rowDom)).focus(),saveScroll&&(me.el.setScrollLeft(scrollLeft),me.ignoreScroll=!1)},scrollCellIntoView:function(cell){null!=cell.row&&null!=cell.column&&(cell=this.getCellByPosition(cell)),cell&&Ext.fly(cell).scrollIntoView(this.el,!0)},scrollByDelta:function(delta,dir){dir=dir||"scrollTop";var elDom=this.el.dom;elDom[dir]=elDom[dir]+=delta},isDataRow:function(row){return Ext.fly(row).hasCls(Ext.baseCSSPrefix+"grid-data-row")},syncRowHeights:function(firstRow,secondRow){firstRow=Ext.get(firstRow),secondRow=Ext.get(secondRow),firstRow.dom.style.height=secondRow.dom.style.height="";var me=this,rowTpl=me.rowTpl,firstRowHeight=firstRow.dom.offsetHeight,secondRowHeight=secondRow.dom.offsetHeight;if(firstRowHeight!==secondRowHeight){for(;rowTpl&&(!rowTpl.syncRowHeights||rowTpl.syncRowHeights(firstRow,secondRow)!==!1);)rowTpl=rowTpl.nextTpl;firstRowHeight=firstRow.dom.offsetHeight,secondRowHeight=secondRow.dom.offsetHeight,firstRowHeight!==secondRowHeight&&(firstRow=firstRow.down("[data-recordId]")||firstRow,secondRow=secondRow.down("[data-recordId]")||secondRow,firstRow&&secondRow&&(firstRow.dom.style.height=secondRow.dom.style.height="",firstRowHeight=firstRow.dom.offsetHeight,secondRowHeight=secondRow.dom.offsetHeight,firstRowHeight>secondRowHeight?(firstRow.setHeight(firstRowHeight),secondRow.setHeight(firstRowHeight)):secondRowHeight>firstRowHeight&&(firstRow.setHeight(secondRowHeight),secondRow.setHeight(secondRowHeight))))}},onIdChanged:function(store,rec,oldId,newId,oldInternalId){var rowDom,me=this;me.viewReady&&(rowDom=me.getNodeById(oldInternalId),rowDom&&(rowDom.setAttribute("data-recordId",rec.internalId),rowDom.id=me.getRowId(rec)))},onUpdate:function(store,record,operation,changedFieldNames){var index,oldRow,oldRowDom,oldDataRow,newRowDom,newAttrs,attLen,attName,attrIndex,overItemCls,beforeOverItemCls,focusedItemCls,beforeFocusedItemCls,selectedItemCls,beforeSelectedItemCls,columns,me=this,rowTpl=me.rowTpl;if(me.viewReady&&(oldRowDom=me.getNodeByRecord(record,!1))){if(overItemCls=me.overItemCls,beforeOverItemCls=me.beforeOverItemCls,focusedItemCls=me.focusedItemCls,beforeFocusedItemCls=me.beforeFocusedItemCls,selectedItemCls=me.selectedItemCls,beforeSelectedItemCls=me.beforeSelectedItemCls,index=me.indexInStore(record),oldRow=Ext.fly(oldRowDom,"_internal"),newRowDom=me.createRowElement(record,index),oldRow.hasCls(overItemCls)&&Ext.fly(newRowDom).addCls(overItemCls),oldRow.hasCls(beforeOverItemCls)&&Ext.fly(newRowDom).addCls(beforeOverItemCls),oldRow.hasCls(focusedItemCls)&&Ext.fly(newRowDom).addCls(focusedItemCls),oldRow.hasCls(beforeFocusedItemCls)&&Ext.fly(newRowDom).addCls(beforeFocusedItemCls),oldRow.hasCls(selectedItemCls)&&Ext.fly(newRowDom).addCls(selectedItemCls),oldRow.hasCls(beforeSelectedItemCls)&&Ext.fly(newRowDom).addCls(beforeSelectedItemCls),columns=me.ownerCt.getVisibleColumnManager().getColumns(),Ext.isIE9m&&oldRowDom.mergeAttributes)oldRowDom.mergeAttributes(newRowDom,!0);else for(newAttrs=newRowDom.attributes,attLen=newAttrs.length,attrIndex=0;attrIndex<attLen;attrIndex++)attName=newAttrs[attrIndex].name,"id"!==attName&&oldRowDom.setAttribute(attName,newAttrs[attrIndex].value);for(columns.length&&(oldDataRow=me.getNode(oldRowDom,!0))&&me.updateColumns(record,oldDataRow,me.getNode(newRowDom,!0),columns,changedFieldNames);rowTpl&&(!rowTpl.syncContent||rowTpl.syncContent(oldRowDom,newRowDom)!==!1);)rowTpl=rowTpl.nextTpl;me.fireEvent("itemupdate",record,index,oldRowDom),me.refreshSize()}},updateColumns:function(record,oldRowDom,newRowDom,columns,changedFieldNames){var newAttrs,attLen,attName,attrIndex,colIndex,column,oldCell,newCell,row,me=this,colCount=columns.length,editingPlugin=me.editingPlugin||me.lockingPartner&&me.ownerCt.ownerLockable.view.editingPlugin,isEditing=editingPlugin&&editingPlugin.editing,cellSelector=me.getCellSelector();if(oldRowDom.mergeAttributes)oldRowDom.mergeAttributes(newRowDom,!0);else for(newAttrs=newRowDom.attributes,attLen=newAttrs.length,attrIndex=0;attrIndex<attLen;attrIndex++)attName=newAttrs[attrIndex].name,"id"!==attName&&oldRowDom.setAttribute(attName,newAttrs[attrIndex].value);for(colIndex=0;colIndex<colCount;colIndex++)column=columns[colIndex],me.shouldUpdateCell(record,column,changedFieldNames)&&(cellSelector=me.getCellSelector(column),oldCell=Ext.DomQuery.selectNode(cellSelector,oldRowDom),newCell=Ext.DomQuery.selectNode(cellSelector,newRowDom),isEditing?Ext.fly(oldCell).syncContent(newCell):(row=oldCell.parentNode,row.insertBefore(newCell,oldCell),row.removeChild(oldCell)))},shouldUpdateCell:function(record,column,changedFieldNames){if(column.hasCustomRenderer||!changedFieldNames)return!0;if(changedFieldNames){var i,field,len=changedFieldNames.length;for(i=0;i<len;++i)if(field=changedFieldNames[i],field===column.dataIndex||field===record.idProperty)return!0}return!1},refresh:function(){var me=this;me.callParent(arguments),me.headerCt.setSortState(),me.el&&!me.all.getCount()&&me.headerCt&&me.headerCt.tooNarrow&&me.el.createChild({role:"presentation",style:"position:absolute;height:1px;width:1px;left:"+(me.headerCt.getFullWidth()-1)+"px"}),me.refreshSelection()},refreshSelection:function(){var selected,len,i,me=this,selModel=me.selModel;if(selModel.isRowModel)for(selected=selModel.selected.items,len=selected.length,i=0;i<len;i++)me.onRowSelect(me.indexOf(me.getNode(selected[i])));me.selModel.onLastFocusChanged(null,me.selModel.lastFocused,!0)},processItemEvent:function(record,row,rowIndex,e){if(this.indexInStore(row)!==-1){var cellIndex,i,result,feature,header,me=this,cell=e.getTarget(me.getCellSelector(),row),map=me.statics().EventMap,selModel=me.getSelectionModel(),type=e.type,features=me.features,len=features.length;if("keydown"==type&&!cell&&selModel.getCurrentPosition&&(cell=me.getCellByPosition(selModel.getCurrentPosition(),!0)),cell){if(!cell.parentNode)return!1;header=me.getHeaderByCell(cell),cellIndex=me.ownerCt.getColumnManager().getHeaderIndex(header)}else cellIndex=-1;if(result=me.fireEvent("uievent",type,me,cell,rowIndex,cellIndex,e,record,row),(result===!1||me.callParent(arguments)===!1)&&selModel.onVetoUIEvent)return selModel.onVetoUIEvent(type,me,cell,rowIndex,cellIndex,e,record,row),!1;for(i=0;i<len;++i)if(feature=features[i],feature.wrapsItem&&feature.vetoEvent(record,row,rowIndex,e)===!1)return me.processSpecialEvent(e),!1;return"mouseover"==type||"mouseout"==type||(!cell||!(me["onBeforeCell"+map[type]](cell,cellIndex,record,row,rowIndex,e)===!1||me.fireEvent("beforecell"+type,me,cell,cellIndex,record,row,rowIndex,e)===!1||me["onCell"+map[type]](cell,cellIndex,record,row,rowIndex,e)===!1||me.fireEvent("cell"+type,me,cell,cellIndex,record,row,rowIndex,e)===!1))}return this.processSpecialEvent(e),!1},processSpecialEvent:function(e){var i,feature,prefix,featureTarget,beforeArgs,args,me=this,features=me.features,ln=features.length,type=e.type,panel=me.ownerCt;if(me.callParent(arguments),"mouseover"!=type&&"mouseout"!=type){for(i=0;i<ln;i++)if(feature=features[i],feature.hasFeatureEvent&&(featureTarget=e.getTarget(feature.eventSelector,me.getTargetEl()),featureTarget&&(prefix=feature.eventPrefix,beforeArgs=feature.getFireEventArgs("before"+prefix+type,me,featureTarget,e),args=feature.getFireEventArgs(prefix+type,me,featureTarget,e),me.fireEvent.apply(me,beforeArgs)===!1||panel.fireEvent.apply(panel,beforeArgs)===!1||me.fireEvent.apply(me,args)===!1||panel.fireEvent.apply(panel,args)===!1)))return!1;return!0}},onCellMouseDown:Ext.emptyFn,onCellMouseUp:Ext.emptyFn,onCellClick:Ext.emptyFn,onCellDblClick:Ext.emptyFn,onCellContextMenu:Ext.emptyFn,onCellKeyDown:Ext.emptyFn,onBeforeCellMouseDown:Ext.emptyFn,onBeforeCellMouseUp:Ext.emptyFn,onBeforeCellClick:Ext.emptyFn,onBeforeCellDblClick:Ext.emptyFn,onBeforeCellContextMenu:Ext.emptyFn,onBeforeCellKeyDown:Ext.emptyFn,expandToFit:function(header){this.autoSizeColumn(header)},autoSizeColumn:function(header){if(Ext.isNumber(header)&&(header=this.getGridColumns[header]),header){if(header.isGroupHeader)return void header.autoSize();delete header.flex,header.setWidth(this.getMaxContentWidth(header))}},getMaxContentWidth:function(header){var maxWidth,me=this,cells=me.el.query(header.getCellInnerSelector()),originalWidth=header.getWidth(),i=0,ln=cells.length,columnSizer=me.body.select(me.getColumnSizerSelector(header)),max=Math.max,widthAdjust=0;for(ln>0&&(Ext.supports.ScrollWidthInlinePaddingBug&&(widthAdjust+=me.getCellPaddingAfter(cells[0])),me.columnLines&&(widthAdjust+=Ext.fly(cells[0].parentNode).getBorderWidth("lr"))),columnSizer.setWidth(1),header.titleEl.setStyle("text-overflow","clip"),maxWidth=header.textEl.dom.offsetWidth+header.titleEl.getPadding("lr"),header.titleEl.setStyle("text-overflow","");i<ln;i++)maxWidth=max(maxWidth,cells[i].scrollWidth);return maxWidth+=widthAdjust,maxWidth=max(maxWidth,40),columnSizer.setWidth(originalWidth),maxWidth},getPositionByEvent:function(e){var me=this,cellNode=e.getTarget(me.cellSelector),rowNode=e.getTarget(me.itemSelector),record=me.getRecord(rowNode),header=me.getHeaderByCell(cellNode);return me.getPosition(record,header)},getHeaderByCell:function(cell){if(cell){var match=cell.className.match(this.cellRe);if(match&&match[1])return this.ownerCt.getVisibleColumnManager().getHeaderById(match[1])}return!1},walkCells:function(pos,direction,e,preventWrap,verifierFn,scope){if(!pos)return!1;var me=this,row=pos.row,column=pos.column,rowCount=me.dataSource.getCount(),allCols=me.ownerCt.getColumnManager(),visible=me.ownerCt.getVisibleColumnManager(),firstIndex=allCols.getHeaderIndex(visible.getFirst()),lastIndex=allCols.getHeaderIndex(visible.getLast()),newRow=row,newColumn=column,activeHeader=allCols.getHeaderAtIndex(column);if(!activeHeader||activeHeader.hidden||!rowCount)return!1;switch(e=e||{},direction=direction.toLowerCase()){case"right":if(column===lastIndex){if(preventWrap||row===rowCount-1)return!1;e.ctrlKey||(newRow=me.walkRows(row,1),newRow!==row&&(newColumn=firstIndex))}else newColumn=e.ctrlKey?lastIndex:allCols.getHeaderIndex(visible.getNextSibling(activeHeader));break;case"left":if(column===firstIndex){if(preventWrap||0===row)return!1;e.ctrlKey||(newRow=me.walkRows(row,-1),newRow!==row&&(newColumn=lastIndex))}else newColumn=e.ctrlKey?firstIndex:allCols.getHeaderIndex(visible.getPreviousSibling(activeHeader));break;case"up":if(0===row)return!1;newRow=e.ctrlKey?me.walkRows(-1,1):me.walkRows(row,-1);break;case"down":if(row===rowCount-1)return!1;newRow=e.ctrlKey?me.walkRows(rowCount,-1):me.walkRows(row,1)}return(!verifierFn||verifierFn.call(scope||me,{row:newRow,column:newColumn})===!0)&&(newColumn=allCols.getHeaderAtIndex(newColumn),new Ext.grid.CellContext(me).setPosition(newRow,newColumn))},walkRows:function(startRow,distance){var node,me=this,moved=0,lastValid=startRow,last=(me.dataSource.buffered?me.dataSource.getTotalCount():me.dataSource.getCount())-1,limit=distance<0?0:last,increment=limit?1:-1,result=startRow;do{if(limit?result>=limit:result<=0)return lastValid||limit;result+=increment,(node=Ext.fly(me.getNode(result,!0)))&&node.isVisible(!0)&&(moved+=increment,lastValid=result)}while(moved!==distance);return result},walkRecs:function(startRec,distance){var node,rec,me=this,moved=0,lastValid=startRec,last=(me.store.buffered?me.store.getTotalCount():me.store.getCount())-1,limit=distance<0?0:last,increment=limit?1:-1,testIndex=me.store.indexOf(startRec);do{if(limit?testIndex>=limit:testIndex<=0)return lastValid;testIndex+=increment,rec=me.store.getAt(testIndex),(node=Ext.fly(me.getNodeByRecord(rec,!0)))&&node.isVisible(!0)&&(moved+=increment,lastValid=rec)}while(moved!==distance);return lastValid},getFirstVisibleRowIndex:function(){var me=this,count=me.dataSource.buffered?me.dataSource.getTotalCount():me.dataSource.getCount(),result=me.indexOf(me.all.first())-1;do if(result+=1,result===count)return;while(!Ext.fly(me.getNode(result,!0)).isVisible(!0));return result},getLastVisibleRowIndex:function(){var me=this,result=me.indexOf(me.all.last());do if(result-=1,result===-1)return;while(!Ext.fly(me.getNode(result,!0)).isVisible(!0));return result},getHeaderCt:function(){return this.headerCt},getPosition:function(record,header){return new Ext.grid.CellContext(this).setPosition(record,header)},beforeDestroy:function(){var me=this;me.rendered&&me.el.removeAllListeners(),me.callParent(arguments)},onDestroy:function(){var len,i,me=this,features=me.featuresMC;if(features)for(i=0,len=features.getCount();i<len;++i)features.getAt(i).destroy();me.featuresMC=null,this.callParent(arguments)},onAdd:function(ds,records,index){var nextIndex,isNextRowSelected,isNextRowFocused,me=this,selModel=me.selModel;me.callParent(arguments),me.doStripeRows(index),me.rendered&&selModel.isRowModel&&!records[0].isCollapsedPlaceholder&&(nextIndex=index+records.length,isNextRowSelected=selModel.isRowSelected(nextIndex),isNextRowFocused=me.indexOf(selModel.lastFocused)===nextIndex,(isNextRowSelected||isNextRowFocused)&&me.onRowDeselect(index),isNextRowSelected&&me.onRowSelect(nextIndex),
selModel.isRowSelected(index)&&me.onRowSelect(index)),me.selModel.onLastFocusChanged(null,me.selModel.lastFocused,!0)},onRemove:function(ds,records,indexes){var index,record,me=this,selModel=me.selModel,len=indexes.length,i=0,delta=0;if(me.callParent(arguments),me.doStripeRows(indexes[0]),me.rendered&&selModel.isRowModel&&!records[0].isCollapsedPlaceholder)for(;i<len;i++,delta++)index=indexes[i]-delta,record=me.store.getAt(index),me.onRowDeselect(index),selModel.isRowSelected(record)&&me.getNode(record)&&me.onRowSelect(index);selModel.onLastFocusChanged(null,selModel.lastFocused,!0)},doStripeRows:function(startRow,endRow){var rows,rowsLn,i,row,me=this;if(me.rendered&&me.stripeRows)for(rows=me.getNodes(startRow,endRow),i=0,rowsLn=rows.length;i<rowsLn;i++)row=rows[i],row.className=row.className.replace(me.rowClsRe," "),startRow++,startRow%2===0&&(row.className+=" "+me.altRowCls)},repaintRow:function(rowIdx){var tds,i,node=this.getNode(rowIdx);if(node)for(tds=node.childNodes,i=tds.length;i--;)tds[i].className=tds[i].className},getRowStyleTableEl:function(item){var me=this;return item.tagName||(item=this.getNode(item)),(me.hasActiveGrouping()?Ext.fly(item):this.el).down("table."+Ext.baseCSSPrefix+"grid-table")},toggleRowTableCls:function(item,cls,enabled){var table,root,me=this;item.tagName||(item=this.getNode(item)),root=me.isGrouping?Ext.fly(item):this.el,root&&(table=root.down("table."+Ext.baseCSSPrefix+"grid-table")),table&&table[enabled?"addCls":"removeCls"](cls)},isRowStyleFirst:function(item){var index,me=this;return item!==-1&&(item.tagName?index=me.indexOf(item):(index=item,item=this.getNode(item)),!index||me.hasActiveGrouping()&&item&&Ext.fly(item).hasCls(Ext.baseCSSPrefix+"grid-group-row"))},hasActiveGrouping:function(){return this.isGrouping&&this.store.isGrouped()},getCellPaddingAfter:function(cell){return Ext.fly(cell).getPadding("r")},hasVerticalScroll:function(){var first,me=this;return!(me.ownerCt.isLocked||!me.scrollFlags.y)&&(first=me.el.down("table"),!!first&&this.getHeight()<first.getHeight())}}),Ext.define("Ext.grid.View",{extend:Ext.view.Table,alias:"widget.gridview",stripeRows:!0,autoScroll:!0}),Ext.define("Ext.grid.Panel",{extend:Ext.panel.Table,alias:["widget.gridpanel","widget.grid"],alternateClassName:["Ext.list.ListView","Ext.ListView","Ext.grid.GridPanel"],viewType:"gridview",lockable:!1,rowLines:!0}),Ext.define("Ext.grid.plugin.BufferedRendererTableView",{override:"Ext.view.Table",onAdd:function(store,records,index){var me=this,bufferedRenderer=me.bufferedRenderer,rows=me.all;me.rendered&&bufferedRenderer&&rows.getCount()+records.length>bufferedRenderer.viewSize?index<rows.startIndex+bufferedRenderer.viewSize&&index+records.length>rows.startIndex?me.refreshView():bufferedRenderer.stretchView(me,bufferedRenderer.getScrollHeight()):me.callParent([store,records,index])},onRemove:function(store,records,indices){var storeSize,all,startIndex,me=this,bufferedRenderer=me.bufferedRenderer;me.callParent([store,records,indices]),me.rendered&&bufferedRenderer&&(storeSize=me.dataSource.getCount(),all=me.all,storeSize>all.getCount()?(startIndex=all.startIndex,bufferedRenderer.renderRange(startIndex,Math.min(startIndex+bufferedRenderer.viewSize,storeSize)-1)):bufferedRenderer.stretchView(me,bufferedRenderer.getScrollHeight()))},onDataRefresh:function(){var me=this;me.bufferedRenderer&&(me.all.clear(),me.bufferedRenderer.onStoreClear()),me.callParent()}}),Ext.define("Ext.grid.RowEditorButtons",{extend:Ext.container.Container,alias:"widget.roweditorbuttons",frame:!0,shrinkWrap:!0,position:"bottom",constructor:function(config){var me=this,rowEditor=config.rowEditor,cssPrefix=Ext.baseCSSPrefix,plugin=rowEditor.editingPlugin;config=Ext.apply({baseCls:cssPrefix+"grid-row-editor-buttons",defaults:{xtype:"button",ui:rowEditor.buttonUI,scope:plugin,flex:1,minWidth:Ext.panel.Panel.prototype.minButtonWidth},items:[{cls:cssPrefix+"row-editor-update-button",itemId:"update",handler:plugin.completeEdit,text:rowEditor.saveBtnText,disabled:rowEditor.updateButtonDisabled},{cls:cssPrefix+"row-editor-cancel-button",handler:plugin.cancelEdit,text:rowEditor.cancelBtnText}]},config),me.callParent([config]),me.addClsWithUI(me.position)},setButtonPosition:function(position){var me=this,rowEditor=this.rowEditor,rowEditorHeight=rowEditor.getHeight(),rowEditorBody=rowEditor.body,bottom="",top="";me.removeClsWithUI(me.position),me.position=position,me.addClsWithUI(position),"top"===position?bottom=rowEditorHeight-rowEditorBody.getBorderWidth("t")+"px":top=rowEditorHeight-rowEditorBody.getBorderWidth("b")+"px",me.el.setStyle({top:top,bottom:bottom})},getFramingInfoCls:function(){return this.baseCls+"-"+this.ui+"-"+this.position},getFrameInfo:function(){var frameInfo=this.callParent();return frameInfo.top=!0,frameInfo}}),Ext.define("Ext.grid.RowEditor",{extend:Ext.form.Panel,alias:"widget.roweditor",saveBtnText:"Update",cancelBtnText:"Cancel",errorsText:"Errors",dirtyText:"You need to commit or cancel your changes",lastScrollLeft:0,lastScrollTop:0,border:!1,errorCls:Ext.baseCSSPrefix+"grid-row-editor-errors-item",buttonUI:"default",hideMode:"offsets",initComponent:function(){var form,me=this,grid=me.editingPlugin.grid,Container=Ext.container.Container;me.cls=Ext.baseCSSPrefix+"grid-editor "+Ext.baseCSSPrefix+"grid-row-editor",me.layout={type:"hbox",align:"middle"},me.lockable=grid.lockable,me.lockable?me.items=[me.lockedColumnContainer=new Container({id:grid.id+"-locked-editor-cells",layout:{type:"hbox",align:"middle"},margin:"0 1 0 0"}),me.normalColumnContainer=new Container({flex:1,id:grid.id+"-normal-editor-cells",layout:{type:"hbox",align:"middle"}})]:me.lockedColumnContainer=me.normalColumnContainer=me,me.callParent(arguments),me.fields&&(me.addFieldsForColumn(me.fields,!0),me.insertColumnEditor(me.fields),delete me.fields),me.mon(me.hierarchyEventSource,{scope:me,show:me.repositionIfVisible}),form=me.getForm(),form.trackResetOnLoad=!0,form.on("validitychange",me.onValidityChange,me)},onGridResize:function(){var me=this,clientWidth=me.getClientWidth(),grid=me.editingPlugin.grid,gridBody=grid.body,btns=me.getFloatingButtons();me.setLocalX(gridBody.getOffsetsTo(grid)[0]+gridBody.getBorderWidth("l")-grid.el.getBorderWidth("l")),me.setWidth(clientWidth),btns.setLocalX((clientWidth-btns.getWidth())/2)},syncAllFieldWidths:function(){var me=this;Ext.Array.each(me.query("[isEditorComponent]"),function(editorComponent){editorComponent.column.isVisible()&&me.onColumnShow(editorComponent.column)},me)},syncFieldWidth:function(column){var width,field=column.getEditor();field._marginWidth=field._marginWidth||field.el.getMargin("lr"),width=column.getWidth()-field._marginWidth,field.setWidth(width),"displayfield"===field.xtype&&(field.inputWidth=width)},onValidityChange:function(form,valid){var me=this;me.errorSummary&&me.isVisible()&&me[valid?"hideToolTip":"showToolTip"](),me.updateButton(valid),me.isValid=valid},updateButton:function(valid){var buttons=this.floatingButtons;buttons?buttons.child("#update").setDisabled(!valid):this.updateButtonDisabled=!valid},afterRender:function(){var me=this,plugin=me.editingPlugin,grid=plugin.grid,view=grid.lockable?grid.normalGrid.view:grid.view;me.callParent(arguments),me.scrollingView=view,me.scrollingViewEl=view.el,view.mon(me.scrollingViewEl,"scroll",me.onViewScroll,me),me.mon(me.el,{click:Ext.emptyFn,stopPropagation:!0}),me.mon(grid,{resize:me.onGridResize,scope:me}),me.el.swallowEvent(["keypress","keydown"]),me.fieldScroller=me.normalColumnContainer.layout.innerCt,me.fieldScroller.dom.style.overflow="hidden",me.fieldScroller.on({scroll:me.onFieldContainerScroll,scope:me}),me.initKeyNav(),me.mon(plugin.view,{beforerefresh:me.onBeforeViewRefresh,refresh:me.onViewRefresh,itemremove:me.onViewItemRemove,scope:me}),me.preventReposition=!0,me.syncAllFieldWidths(),delete me.preventReposition},initKeyNav:function(){var me=this,plugin=me.editingPlugin;me.keyNav=new Ext.util.KeyNav(me.el,{enter:plugin.onEnterKey,esc:plugin.onEscKey,scope:plugin})},onBeforeViewRefresh:function(view){var me=this,viewDom=view.el.dom;me.el.dom.parentNode===viewDom&&viewDom.removeChild(me.el.dom)},onViewRefresh:function(view){var row,me=this,context=me.context;context&&(row=view.getNode(context.record,!0))?(context.row=row,me.reposition(),me.tooltip&&me.tooltip.isVisible()&&me.tooltip.setTarget(context.row)):me.editingPlugin.cancelEdit()},onViewItemRemove:function(record,index){var context=this.context;context&&record===context.record&&this.editingPlugin.cancelEdit()},onViewScroll:function(){var row,me=this,viewEl=me.editingPlugin.view.el,scrollingViewEl=me.scrollingViewEl,scrollTop=scrollingViewEl.dom.scrollTop,scrollLeft=scrollingViewEl.getScrollLeft(),scrollLeftChanged=scrollLeft!==me.lastScrollLeft,scrollTopChanged=scrollTop!==me.lastScrollTop;me.lastScrollTop=scrollTop,me.lastScrollLeft=scrollLeft,me.isVisible()&&(row=Ext.getDom(me.context.row.id),row&&viewEl.contains(row)?scrollTopChanged&&(me.context.row=row,me.reposition(null,!0),(me.tooltip&&me.tooltip.isVisible()||me.hiddenTip)&&me.repositionTip(),me.syncEditorClip()):me.setLocalY(-400)),me.rendered&&scrollLeftChanged&&me.syncFieldsHorizontalScroll()},syncFieldsHorizontalScroll:function(){this.fieldScroller.setScrollLeft(this.lastScrollLeft)},onFieldContainerScroll:function(){this.scrollingViewEl.setScrollLeft(this.fieldScroller.getScrollLeft())},onColumnResize:function(column,width){var me=this;me.rendered&&!me.editingPlugin.reconfiguring&&(me.onGridResize(),me.onViewScroll(),column.isGroupHeader||(me.syncFieldWidth(column),me.repositionIfVisible()))},onColumnHide:function(column){this.editingPlugin.reconfiguring||column.isGroupHeader||(column.getEditor().hide(),this.repositionIfVisible())},onColumnShow:function(column){var me=this;me.rendered&&!me.editingPlugin.reconfiguring&&!column.isGroupHeader&&column.getEditor&&(column.getEditor().show(),me.syncFieldWidth(column),me.preventReposition||this.repositionIfVisible())},onColumnMove:function(column,fromIdx,toIdx){var i,len,field,fieldIdx,me=this,incr=1,fieldContainer=column.isLocked()?me.lockedColumnContainer:me.normalColumnContainer;if(column.isGroupHeader){for(Ext.suspendLayouts(),column=column.getGridColumns(),toIdx>fromIdx&&(toIdx--,incr=0),this.addFieldsForColumn(column),i=0,len=column.length;i<len;i++,fromIdx+=incr,toIdx+=incr)field=column[i].getEditor(),fieldIdx=fieldContainer.items.indexOf(field),fieldIdx===-1?fieldContainer.insert(toIdx,field):fieldIdx!=toIdx&&fieldContainer.move(fromIdx,toIdx);Ext.resumeLayouts(!0)}else toIdx>fromIdx&&toIdx--,this.addFieldsForColumn(column),field=column.getEditor(),fieldIdx=fieldContainer.items.indexOf(field),fieldIdx===-1?fieldContainer.insert(toIdx,field):fieldIdx!=toIdx&&fieldContainer.move(fromIdx,toIdx)},onColumnAdd:function(column){column.isGroupHeader&&(column=column.getGridColumns()),this.addFieldsForColumn(column),this.insertColumnEditor(column),this.preventReposition=!1},insertColumnEditor:function(column){var fieldContainer,len,i,me=this,plugin=me.editingPlugin,grid=plugin.grid,lockable=grid.lockable;if(Ext.isArray(column))for(i=0,len=column.length;i<len;i++)me.insertColumnEditor(column[i]);else column.getEditor&&(column.isLocked()?(fieldContainer=me.lockedColumnContainer,grid=grid.lockedGrid):(fieldContainer=me.normalColumnContainer,lockable&&(grid=grid.normalGrid)),fieldContainer.insert(grid.getColumnManager().getHeaderIndex(column),column.getEditor()))},onColumnRemove:function(ct,column){column=column.isGroupHeader?column.getGridColumns():column,this.removeColumnEditor(column)},removeColumnEditor:function(column,destroy){var field,len,i,me=this;if(Ext.isArray(column))for(i=0,len=column.length;i<len;i++)me.removeColumnEditor(column[i]);else column.hasEditor()&&column.field.isComponent&&(field=column.getEditor(),field&&(destroy||column.isDestroyed?field.destroy():field.ownerCt&&field.ownerCt.remove(field,!1)))},onColumnReplace:function(map,fieldId,column,oldColumn){this.onColumnRemove(oldColumn.ownerCt,oldColumn)},getFloatingButtons:function(){var me=this,btns=me.floatingButtons;return btns||(me.floatingButtons=btns=new Ext.grid.RowEditorButtons({rowEditor:me})),btns},repositionIfVisible:function(c){var me=this,view=me.view;(!c||c!=me&&c.el.isAncestor(view.el))&&me.isVisible()&&view.isVisible(!0)&&me.reposition()},getRefOwner:function(){return this.editingPlugin.grid},getRefItems:function(deep){var result,me=this;return me.lockable?(result=me.lockedColumnContainer.getRefItems(deep),result.push.apply(result,me.normalColumnContainer.getRefItems(deep))):result=me.callParent(arguments),result.push.apply(result,me.getFloatingButtons().getRefItems(deep)),result},reposition:function(animateConfig,fromScrollHandler){var rowTop,localY,deltaY,afterPosition,me=this,context=me.context,row=context&&Ext.get(context.row),yOffset=0;row&&Ext.isElement(row.dom)&&(deltaY=me.syncButtonPosition(me.getScrollDelta()),me.editingPlugin.grid.rowLines||(yOffset=-parseInt(row.first().getStyle("border-bottom-width"),10)),rowTop=me.calculateLocalRowTop(row),localY=me.calculateEditorTop(rowTop)+yOffset,fromScrollHandler||(afterPosition=function(){deltaY&&me.scrollingViewEl.scrollBy(0,deltaY,!0),me.focusContextCell()}),me.syncEditorClip(),animateConfig?me.animate(Ext.applyIf({to:{top:localY},duration:animateConfig.duration||125,callback:afterPosition},animateConfig)):(me.setLocalY(localY),afterPosition&&afterPosition()))},getScrollDelta:function(){var me=this,scrollingViewDom=me.scrollingViewEl.dom,context=me.context,body=me.body,deltaY=0;return context&&(deltaY=Ext.fly(context.row).getOffsetsTo(scrollingViewDom)[1]-body.getBorderPadding().beforeY,deltaY>0&&(deltaY=Math.max(deltaY+me.getHeight()+me.floatingButtons.getHeight()-scrollingViewDom.clientHeight-body.getBorderWidth("b"),0))),deltaY},calculateLocalRowTop:function(row){var grid=this.editingPlugin.grid;return Ext.fly(row).getOffsetsTo(grid)[1]-grid.el.getBorderWidth("t")+this.lastScrollTop},calculateEditorTop:function(rowTop){return rowTop-this.body.getBorderPadding().beforeY-this.lastScrollTop},getClientWidth:function(){var result,me=this,grid=me.editingPlugin.grid;return result=me.lockable?grid.lockedGrid.getWidth()+grid.normalGrid.view.el.dom.clientWidth-1:grid.view.el.dom.clientWidth},getEditor:function(fieldInfo){var me=this;return Ext.isNumber(fieldInfo)?me.query("[isEditorComponent]")[fieldInfo]:fieldInfo.isHeader&&!fieldInfo.isGroupHeader?fieldInfo.getEditor():void 0},addFieldsForColumn:function(column,initial){var i,length,field,me=this;if(Ext.isArray(column))for(i=0,length=column.length;i<length;i++)me.addFieldsForColumn(column[i],initial);else column.getEditor&&(field=column.getEditor(null,me.getDefaultFieldCfg()),"right"===column.align&&(field.fieldStyle="text-align:right"),"actioncolumn"===column.xtype&&(field.fieldCls+=" "+Ext.baseCSSPrefix+"form-action-col-field"),me.isVisible()&&me.context&&(field.is("displayfield")?me.renderColumnData(field,me.context.record,column):(field.suspendEvents(),field.setValue(me.context.record.get(column.dataIndex)),field.resumeEvents())),column.hidden?me.onColumnHide(column):column.rendered&&!initial&&me.onColumnShow(column))},getDefaultFieldCfg:function(){return{xtype:"displayfield",getModelData:function(){return null}}},loadRecord:function(record){var i,displayFields,isValid,me=this,form=me.getForm(),fields=form.getFields(),items=fields.items,length=items.length;for(i=0;i<length;i++)items[i].suspendEvents();for(form.loadRecord(record),i=0;i<length;i++)items[i].resumeEvents();for(isValid=form.isValid(),me.errorSummary&&(isValid?me.hideToolTip():me.showToolTip()),me.updateButton(isValid),displayFields=me.query(">displayfield"),length=displayFields.length,i=0;i<length;i++)me.renderColumnData(displayFields[i],record)},renderColumnData:function(field,record,activeColumn){var metaData,rowIdx,colIdx,me=this,grid=me.editingPlugin.grid,headerCt=grid.headerCt,view=me.scrollingView,store=view.dataSource,column=activeColumn||field.column,value=record.get(column.dataIndex),renderer=column.editRenderer||column.renderer;renderer&&(metaData={tdCls:"",style:""},rowIdx=store.indexOf(record),colIdx=headerCt.getHeaderIndex(column),value=renderer.call(column.scope||headerCt.ownerCt,value,metaData,record,rowIdx,colIdx,store,view)),field.setRawValue(value),field.resetOriginalValue()},beforeEdit:function(){var scrollDelta,me=this;if(me.isVisible()&&me.errorSummary&&!me.autoCancel&&me.isDirty())return scrollDelta=me.getScrollDelta(),scrollDelta&&me.scrollingViewEl.scrollBy(0,scrollDelta,!0),me.showToolTip(),!1},startEdit:function(record,columnHeader){var me=this,editingPlugin=me.editingPlugin,grid=editingPlugin.grid,context=me.context=editingPlugin.context;me.rendered?me.syncFieldsHorizontalScroll():(me.width=me.getClientWidth(),me.render(grid.el,grid.el.dom.firstChild),me.getFloatingButtons().render(me.el),me.onViewScroll()),context.grid.getSelectionModel().select(record),me.isVisible()?me.reposition(!0):me.show(),me.onGridResize(),me.loadRecord(record)},syncButtonPosition:function(scrollDelta){var me=this,floatingButtons=me.getFloatingButtons(),scrollingViewElDom=me.scrollingViewEl.dom,overflow=this.getScrollDelta()-(scrollingViewElDom.scrollHeight-scrollingViewElDom.scrollTop-scrollingViewElDom.clientHeight);return overflow>0?(me._buttonsOnTop||(floatingButtons.setButtonPosition("top"),me._buttonsOnTop=!0),scrollDelta=0):me._buttonsOnTop!==!1&&(floatingButtons.setButtonPosition("bottom"),me._buttonsOnTop=!1),scrollDelta},syncEditorClip:function(){var btnHeight,me=this,overflow=me.getScrollDelta();overflow?(me.isOverflowing=!0,btnHeight=me.floatingButtons.getHeight(),overflow>0?me.clipBottom(Math.max(me.getHeight()-overflow+btnHeight,-btnHeight)):overflow<0&&(overflow=Math.abs(overflow),me.clipTop(Math.max(overflow,0)))):me.isOverflowing&&(me.clearClip(),me.isOverflowing=!1)},focusContextCell:function(){var field,column=this.context.column;column.isDestroyed||(field=this.getEditor(column),field&&field.focus&&field.focus())},cancelEdit:function(){var i,me=this,form=me.getForm(),fields=form.getFields(),items=fields.items,length=items.length;for(me.hide(),form.clearInvalid(),i=0;i<length;i++)items[i].suspendEvents();for(form.reset(),i=0;i<length;i++)items[i].resumeEvents()},completeEdit:function(){var me=this,form=me.getForm();return!!form.isValid()&&(form.updateRecord(me.context.record),me.hide(),!0)},onShow:function(){var me=this;me.callParent(arguments),me.needsSyncFieldWidths&&(me.suspendLayouts(),me.syncAllFieldWidths(),me.resumeLayouts(!0)),delete me.needsSyncFieldWidths,me.reposition()},onHide:function(){var me=this;me.callParent(arguments),me.tooltip&&me.hideToolTip(),me.context&&(me.context.view.focusRow(me.context.record),me.context=null)},isDirty:function(){var me=this,form=me.getForm();return form.isDirty()},getToolTip:function(){return this.tooltip||(this.tooltip=new Ext.tip.ToolTip({cls:Ext.baseCSSPrefix+"grid-row-editor-errors",title:this.errorsText,autoHide:!1,closable:!0,closeAction:"disable",anchor:"left",anchorToTarget:!1}))},hideToolTip:function(){var me=this,tip=me.getToolTip();tip.rendered&&tip.disable(),me.hiddenTip=!1},showToolTip:function(){var me=this,tip=me.getToolTip();tip.showAt([0,0]),tip.update(me.getErrors()),me.repositionTip(),tip.enable()},repositionTip:function(){var me=this,tip=me.getToolTip(),context=me.context,row=Ext.get(context.row),viewEl=me.scrollingViewEl,viewHeight=viewEl.dom.clientHeight,viewTop=me.lastScrollTop,viewBottom=viewTop+viewHeight,rowHeight=row.getHeight(),rowTop=row.getOffsetsTo(me.context.view.body)[1],rowBottom=rowTop+rowHeight;rowBottom>viewTop&&rowTop<viewBottom?(tip.showAt(tip.getAlignToXY(viewEl,"tl-tr",[15,row.getOffsetsTo(viewEl)[1]])),me.hiddenTip=!1):(tip.hide(),me.hiddenTip=!0)},getErrors:function(){var i,me=this,errors=[],fields=me.query(">[isFormField]"),length=fields.length;for(i=0;i<length;i++)errors=errors.concat(Ext.Array.map(fields[i].getErrors(),me.createErrorListItem));return errors.length||me.autoCancel||!me.isDirty()||(errors[0]=me.createErrorListItem(me.dirtyText)),'<ul class="'+Ext.plainListCls+'">'+errors.join("")+"</ul>"},createErrorListItem:function(e){return'<li class="'+this.errorCls+'">'+e+"</li>"},beforeDestroy:function(){Ext.destroy(this.floatingButtons,this.tooltip),this.callParent()},clipBottom:function(value){this.el.setStyle("clip","rect(-1000px auto "+value+"px auto)")},clipTop:function(value){this.el.setStyle("clip","rect("+value+"px auto 1000px auto)")},clearClip:function(el){this.el.setStyle("clip",Ext.isIE8m||Ext.isIEQuirks?"rect(-1000px auto 1000px auto)":"auto")}}),Ext.define("Ext.view.DropZone",{extend:Ext.dd.DropZone,indicatorCls:Ext.baseCSSPrefix+"grid-drop-indicator",indicatorHtml:['<div class="',Ext.baseCSSPrefix,'grid-drop-indicator-left" role="presentation"></div>','<div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-right" role="presentation"></div>'].join(""),constructor:function(config){var me=this;Ext.apply(me,config),me.ddGroup||(me.ddGroup="view-dd-zone-"+me.view.id),me.callParent([me.view.el])},fireViewEvent:function(){var result,me=this;return me.lock(),result=me.view.fireEvent.apply(me.view,arguments),me.unlock(),result},getTargetFromEvent:function(e){var mouseY,nodeList,testNode,i,len,box,node=e.getTarget(this.view.getItemSelector());if(!node)for(mouseY=e.getPageY(),i=0,nodeList=this.view.getNodes(),len=nodeList.length;i<len;i++)if(testNode=nodeList[i],box=Ext.fly(testNode).getBox(),mouseY<=box.bottom)return testNode;return node},getIndicator:function(){var me=this;return me.indicator||(me.indicator=new Ext.Component({ariaRole:"presentation",html:me.indicatorHtml,cls:me.indicatorCls,ownerCt:me.view,floating:!0,shadow:!1})),me.indicator},getPosition:function(e,node){var pos,y=e.getXY()[1],region=Ext.fly(node).getRegion();return pos=region.bottom-y>=(region.bottom-region.top)/2?"before":"after"},containsRecordAtOffset:function(records,record,offset){if(!record)return!1;var view=this.view,recordIndex=view.indexOf(record),nodeBefore=view.getNode(recordIndex+offset,!0),recordBefore=nodeBefore?view.getRecord(nodeBefore):null;return recordBefore&&Ext.Array.contains(records,recordBefore)},positionIndicator:function(node,data,e){var indicatorY,me=this,view=me.view,pos=me.getPosition(e,node),overRecord=view.getRecord(node),draggingRecords=data.records;Ext.Array.contains(draggingRecords,overRecord)||("before"!=pos||me.containsRecordAtOffset(draggingRecords,overRecord,-1))&&("after"!=pos||me.containsRecordAtOffset(draggingRecords,overRecord,1))?me.invalidateDrop():(me.valid=!0,me.overRecord==overRecord&&me.currentPosition==pos||(indicatorY=Ext.fly(node).getY()-view.el.getY()-1,"after"==pos&&(indicatorY+=Ext.fly(node).getHeight()),me.getIndicator().setWidth(Ext.fly(view.el).getWidth()).showAt(0,indicatorY),me.overRecord=overRecord,me.currentPosition=pos))},invalidateDrop:function(){this.valid&&(this.valid=!1,this.getIndicator().hide())},onNodeOver:function(node,dragZone,e,data){var me=this;return Ext.Array.contains(data.records,me.view.getRecord(node))||me.positionIndicator(node,data,e),me.valid?me.dropAllowed:me.dropNotAllowed},notifyOut:function(node,dragZone,e,data){var me=this;me.callParent(arguments),me.overRecord=me.currentPosition=null,me.valid=!1,me.indicator&&me.indicator.hide()},onContainerOver:function(dd,e,data){var me=this,view=me.view,count=view.dataSource.getCount();return count?me.positionIndicator(view.all.last(),data,e):(me.overRecord=me.currentPosition=null,me.getIndicator().setWidth(Ext.fly(view.el).getWidth()).showAt(0,0),me.valid=!0),me.dropAllowed},onContainerDrop:function(dd,e,data){return this.onNodeDrop(dd,null,e,data)},onNodeDrop:function(targetNode,dragZone,e,data){var me=this,dropHandled=!1,dropHandlers={wait:!1,processDrop:function(){me.invalidateDrop(),me.handleNodeDrop(data,me.overRecord,me.currentPosition),dropHandled=!0,me.fireViewEvent("drop",targetNode,data,me.overRecord,me.currentPosition)},cancelDrop:function(){me.invalidateDrop(),dropHandled=!0}},performOperation=!1;if(me.valid){if(performOperation=me.fireViewEvent("beforedrop",targetNode,data,me.overRecord,me.currentPosition,dropHandlers),dropHandlers.wait)return;performOperation!==!1&&(dropHandled||dropHandlers.processDrop())}return performOperation},destroy:function(){Ext.destroy(this.indicator),delete this.indicator,this.callParent()}}),Ext.define("Ext.grid.ViewDropZone",{extend:Ext.view.DropZone,indicatorHtml:'<div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-left" role="presentation"></div><div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-right" role="presentation"></div>',indicatorCls:Ext.baseCSSPrefix+"grid-drop-indicator",handleNodeDrop:function(data,record,position){var index,records,i,len,view=this.view,store=view.getStore();if(data.copy)for(records=data.records,data.records=[],i=0,len=records.length;i<len;i++)data.records.push(records[i].copy());else data.view.store.remove(data.records,data.view===view);record&&position?(index=store.indexOf(record),"before"!==position&&index++,store.insert(index,data.records)):store.add(data.records),view.getSelectionModel().select(data.records)}}),Ext.define("Ext.grid.plugin.HeaderResizer",{extend:Ext.AbstractPlugin,alias:"plugin.gridheaderresizer",disabled:!1,config:{dynamic:!1},colHeaderCls:Ext.baseCSSPrefix+"column-header",minColWidth:40,maxColWidth:1e3,wResizeCursor:"col-resize",eResizeCursor:"col-resize",init:function(headerCt){this.headerCt=headerCt,headerCt.on("render",this.afterHeaderRender,this,{single:!0})},destroy:function(){var tracker=this.tracker;tracker&&(delete tracker.onBeforeStart,delete tracker.onStart,delete tracker.onDrag,delete tracker.onEnd,tracker.destroy(),this.tracker=null)},afterHeaderRender:function(){var headerCt=this.headerCt,el=headerCt.el;headerCt.mon(el,"mousemove",this.onHeaderCtMouseMove,this),this.tracker=new Ext.dd.DragTracker({disabled:this.disabled,onBeforeStart:Ext.Function.bind(this.onBeforeStart,this),onStart:Ext.Function.bind(this.onStart,this),onDrag:Ext.Function.bind(this.onDrag,this),onEnd:Ext.Function.bind(this.onEnd,this),tolerance:3,autoStart:300,el:el})},onHeaderCtMouseMove:function(e,t){var prevSiblings,headerEl,overHeader,resizeHeader,resizeHeaderOwnerGrid,ownerGrid,me=this;me.headerCt.dragging?me.activeHd&&(me.activeHd.el.dom.style.cursor="",delete me.activeHd):(headerEl=e.getTarget("."+me.colHeaderCls,3,!0),headerEl&&(overHeader=Ext.getCmp(headerEl.id),overHeader.isOnLeftEdge(e)?(resizeHeader=overHeader.previousNode("gridcolumn:not([hidden]):not([isGroupHeader])"),resizeHeader&&(ownerGrid=me.headerCt.up("tablepanel"),resizeHeaderOwnerGrid=resizeHeader.up("tablepanel"),resizeHeaderOwnerGrid===ownerGrid||ownerGrid.ownerCt.isXType("tablepanel")&&ownerGrid.ownerCt.view.lockedGrid===resizeHeaderOwnerGrid||(resizeHeader=null))):resizeHeader=overHeader.isOnRightEdge(e)?overHeader:null,resizeHeader?(resizeHeader.isGroupHeader&&(prevSiblings=resizeHeader.getGridColumns(),resizeHeader=prevSiblings[prevSiblings.length-1]),!resizeHeader||resizeHeader.fixed||resizeHeader.resizable===!1||me.disabled||(me.activeHd=resizeHeader,overHeader.el.dom.style.cursor=me.eResizeCursor,overHeader.triggerEl&&(overHeader.triggerEl.dom.style.cursor=me.eResizeCursor))):(overHeader.el.dom.style.cursor="",overHeader.triggerEl&&(overHeader.triggerEl.dom.style.cursor=""),me.activeHd=null)))},onBeforeStart:function(e){return this.dragHd=this.activeHd,this.dragHd&&!this.headerCt.dragging?(this.tracker.constrainTo=this.getConstrainRegion(),!0):(this.headerCt.dragging=!1,!1)},getConstrainRegion:function(){var nextHd,lockedGrid,me=this,dragHdEl=me.dragHd.el,rightAdjust=0;return me.headerCt.forceFit?(nextHd=me.dragHd.nextNode("gridcolumn:not([hidden]):not([isGroupHeader])"),nextHd&&(me.headerInSameGrid(nextHd)||(nextHd=null),rightAdjust=nextHd.getWidth()-me.minColWidth)):rightAdjust=(lockedGrid=me.dragHd.up("tablepanel")).isLocked?me.dragHd.up("[scrollerOwner]").getWidth()-lockedGrid.getWidth()-30:me.maxColWidth-dragHdEl.getWidth(),me.adjustConstrainRegion(dragHdEl.getRegion(),0,rightAdjust,0,me.minColWidth)},onStart:function(e){var x,y,gridSection,markerOwner,lhsMarker,rhsMarker,markerHeight,me=this,dragHd=me.dragHd,width=dragHd.el.getWidth(),headerCt=dragHd.getOwnerHeaderCt();me.headerCt.dragging=!0,me.origWidth=width,me.dynamic||(gridSection=markerOwner=headerCt.up("tablepanel"),gridSection.ownerLockable&&(markerOwner=gridSection.ownerLockable),x=me.getLeftMarkerX(markerOwner),lhsMarker=markerOwner.getLhsMarker(),rhsMarker=markerOwner.getRhsMarker(),markerHeight=gridSection.body.getHeight()+headerCt.getHeight(),y=headerCt.getOffsetsTo(markerOwner)[1],lhsMarker.setLocalY(y),rhsMarker.setLocalY(y),lhsMarker.setHeight(markerHeight),rhsMarker.setHeight(markerHeight),me.setMarkerX(lhsMarker,x),me.setMarkerX(rhsMarker,x+width))},onDrag:function(e){var markerOwner,me=this;me.dynamic?me.doResize():(markerOwner=this.headerCt.up("tablepanel"),markerOwner.ownerLockable&&(markerOwner=markerOwner.ownerLockable),this.setMarkerX(this.getMovingMarker(markerOwner),this.calculateDragX(markerOwner)))},getMovingMarker:function(markerOwner){return markerOwner.getRhsMarker()},onEnd:function(e){if(this.headerCt.dragging=!1,this.dragHd){if(!this.dynamic){var markerOwner=this.headerCt.up("tablepanel");markerOwner.ownerLockable&&(markerOwner=markerOwner.ownerLockable),this.setMarkerX(markerOwner.getLhsMarker(),-9999),this.setMarkerX(markerOwner.getRhsMarker(),-9999)}this.doResize()}},doResize:function(){var nextHd,offset,me=this,dragHd=me.dragHd;dragHd&&(offset=me.tracker.getOffset("point"),dragHd.flex&&delete dragHd.flex,Ext.suspendLayouts(),me.adjustColumnWidth(offset[0]),me.headerCt.forceFit&&(nextHd=dragHd.nextNode("gridcolumn:not([hidden]):not([isGroupHeader])"),nextHd&&!me.headerInSameGrid(nextHd)&&(nextHd=null),nextHd&&(delete nextHd.flex,nextHd.setWidth(nextHd.getWidth()-offset[0]))),Ext.resumeLayouts(!0))},headerInSameGrid:function(header){var grid=this.dragHd.up("tablepanel");return!!header.up(grid)},disable:function(){this.disabled=!0,this.tracker&&this.tracker.disable()},enable:function(){this.disabled=!1,this.tracker&&this.tracker.enable()},calculateDragX:function(markerOwner){return this.tracker.getXY("point")[0]-markerOwner.getX()-markerOwner.el.getBorderWidth("l")},getLeftMarkerX:function(markerOwner){return this.dragHd.getX()-markerOwner.getX()-markerOwner.el.getBorderWidth("l")-1},setMarkerX:function(marker,x){marker.setLocalX(x)},adjustConstrainRegion:function(region,t,r,b,l){return region.adjust(t,r,b,l)},adjustColumnWidth:function(offsetX){this.dragHd.setWidth(this.origWidth+offsetX)}}),Ext.define("Ext.grid.header.DragZone",{extend:Ext.dd.DragZone,colHeaderSelector:"."+Ext.baseCSSPrefix+"column-header",colInnerSelector:"."+Ext.baseCSSPrefix+"column-header-inner",maxProxyWidth:120,constructor:function(headerCt){var me=this;me.headerCt=headerCt,me.ddGroup=me.getDDGroup(),me.autoGroup=!0,me.callParent([headerCt.el]),me.proxy.el.addCls(Ext.baseCSSPrefix+"grid-col-dd")},getDDGroup:function(){return"header-dd-zone-"+this.headerCt.up("[scrollerOwner]").id},getDragData:function(e){if(e.getTarget(this.colInnerSelector)){var headerCmp,ddel,header=e.getTarget(this.colHeaderSelector);if(header&&(headerCmp=Ext.getCmp(header.id),!this.headerCt.dragging&&headerCmp.draggable&&!headerCmp.isOnLeftEdge(e)&&!headerCmp.isOnRightEdge(e)))return ddel=document.createElement("div"),ddel.role="presentation",ddel.innerHTML=Ext.getCmp(header.id).text,{ddel:ddel,header:headerCmp}}return!1},onBeforeDrag:function(){return!(this.headerCt.dragging||this.disabled)},onInitDrag:function(){this.headerCt.dragging=!0,this.callParent(arguments)},onDragDrop:function(){this.headerCt.dragging=!1,this.callParent(arguments)},afterRepair:function(){this.callParent(),this.headerCt.dragging=!1},getRepairXY:function(){return this.dragData.header.el.getXY()},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1}}),Ext.define("Ext.grid.header.DropZone",{extend:Ext.dd.DropZone,colHeaderCls:Ext.baseCSSPrefix+"column-header",proxyOffsets:[-4,-9],constructor:function(headerCt){
var me=this;me.headerCt=headerCt,me.ddGroup=me.getDDGroup(),me.autoGroup=!0,me.callParent([headerCt.el])},getDDGroup:function(){return"header-dd-zone-"+this.headerCt.up("[scrollerOwner]").id},getTargetFromEvent:function(e){return e.getTarget("."+this.colHeaderCls)},getTopIndicator:function(){return this.topIndicator||(this.self.prototype.topIndicator=Ext.DomHelper.append(Ext.getBody(),{role:"presentation",cls:"col-move-top",html:"&#160;"},!0),this.self.prototype.indicatorXOffset=Math.floor((this.topIndicator.dom.offsetWidth+1)/2)),this.topIndicator},getBottomIndicator:function(){return this.bottomIndicator||(this.self.prototype.bottomIndicator=Ext.DomHelper.append(Ext.getBody(),{role:"presentation",cls:"col-move-bottom",html:"&#160;"},!0)),this.bottomIndicator},getLocation:function(e,t){var pos,x=e.getXY()[0],region=Ext.fly(t).getRegion();return pos=region.right-x<=(region.right-region.left)/2?"after":"before",{pos:pos,header:Ext.getCmp(t.id),node:t}},positionIndicator:function(data,node,e){var nextHd,prevHd,topIndicator,bottomIndicator,topAnchor,bottomAnchor,topXY,bottomXY,headerCtEl,minX,maxX,allDropZones,ln,i,dropZone,me=this,dragHeader=data.header,dropLocation=me.getLocation(e,node),targetHeader=dropLocation.header,pos=dropLocation.pos;if(targetHeader!==me.lastTargetHeader||pos!==me.lastDropPos){if(nextHd=dragHeader.nextSibling("gridcolumn:not([hidden])"),prevHd=dragHeader.previousSibling("gridcolumn:not([hidden])"),me.lastTargetHeader=targetHeader,me.lastDropPos=pos,!targetHeader.draggable&&"before"===pos&&0===targetHeader.getIndex())return!1;if(data.dropLocation=dropLocation,dragHeader!==targetHeader&&("before"===pos&&nextHd!==targetHeader||"after"===pos&&prevHd!==targetHeader)&&!targetHeader.isDescendantOf(dragHeader)){for(allDropZones=Ext.dd.DragDropManager.getRelated(me),ln=allDropZones.length,i=0;i<ln;i++)dropZone=allDropZones[i],dropZone!==me&&dropZone.invalidateDrop&&dropZone.invalidateDrop();me.valid=!0,topIndicator=me.getTopIndicator(),bottomIndicator=me.getBottomIndicator(),"before"===pos?(topAnchor="bc-tl",bottomAnchor="tc-bl"):(topAnchor="bc-tr",bottomAnchor="tc-br"),topXY=topIndicator.getAlignToXY(targetHeader.el,topAnchor),bottomXY=bottomIndicator.getAlignToXY(targetHeader.el,bottomAnchor),headerCtEl=me.headerCt.el,minX=headerCtEl.getX()-me.indicatorXOffset,maxX=headerCtEl.getX()+headerCtEl.getWidth(),topXY[0]=Ext.Number.constrain(topXY[0],minX,maxX),bottomXY[0]=Ext.Number.constrain(bottomXY[0],minX,maxX),topIndicator.setXY(topXY),bottomIndicator.setXY(bottomXY),topIndicator.show(),bottomIndicator.show()}else me.invalidateDrop()}},invalidateDrop:function(){this.valid=!1,this.hideIndicators()},onNodeOver:function(node,dragZone,e,data){var doPosition,to,fromPanel,toPanel,me=this,from=data.header;return data.header.el.dom===node?doPosition=!1:(data.isLock=data.isUnlock=!1,to=me.getLocation(e,node).header,doPosition=from.ownerCt===to.ownerCt,doPosition||from.ownerCt.sealed||to.ownerCt.sealed||(doPosition=!0,fromPanel=from.up("tablepanel"),toPanel=to.up("tablepanel"),data.isLock=toPanel.isLocked&&!fromPanel.isLocked,data.isUnlock=!toPanel.isLocked&&fromPanel.isLocked,(data.isUnlock&&from.lockable===!1||data.isLock&&!from.isLockable())&&(doPosition=!1))),doPosition?me.positionIndicator(data,node,e):me.valid=!1,me.valid?me.dropAllowed:me.dropNotAllowed},hideIndicators:function(){var me=this;me.getTopIndicator().hide(),me.getBottomIndicator().hide(),me.lastTargetHeader=me.lastDropPos=null},onNodeOut:function(){this.hideIndicators()},onNodeDrop:function(node,dragZone,e,data){if(this.valid){var scrollerOwner,savedWidth,dragHeader=data.header,dropLocation=data.dropLocation,targetHeader=dropLocation.header,fromCt=dragHeader.ownerCt,localFromIdx=fromCt.items.indexOf(dragHeader),toCt=targetHeader.ownerCt,localToIdx=toCt.items.indexOf(targetHeader),headerCt=this.headerCt,columns=headerCt.visibleColumnManager,fromIdx=columns.getHeaderIndex(dragHeader),toIdx=columns.getHeaderIndex(targetHeader),colsToMove=dragHeader.isGroupHeader?dragHeader.query(":not([hidden]):not([isGroupHeader])").length:1,sameCt=fromCt===toCt;if("after"===dropLocation.pos&&(localToIdx++,toIdx+=targetHeader.isGroupHeader?targetHeader.query(":not([hidden]):not([isGroupHeader])").length:1),data.isLock)scrollerOwner=fromCt.up("[scrollerOwner]"),scrollerOwner.lock(dragHeader,localToIdx,toCt);else if(data.isUnlock)scrollerOwner=fromCt.up("[scrollerOwner]"),scrollerOwner.unlock(dragHeader,localToIdx,toCt);else{if(this.invalidateDrop(),savedWidth=dragHeader.getWidth(),sameCt&&(localToIdx>localFromIdx&&(localToIdx-=1),localToIdx===localFromIdx))return void headerCt.onHeaderMoved(dragHeader,colsToMove,fromIdx,toIdx);Ext.suspendLayouts(),dragHeader.dropMoving=!0,sameCt?toCt.move(localFromIdx,localToIdx):(fromCt.remove(dragHeader,!1),toCt.insert(localToIdx,dragHeader)),delete dragHeader.dropMoving,toCt.isGroupHeader?sameCt||(dragHeader.savedFlex=dragHeader.flex,delete dragHeader.flex,dragHeader.width=savedWidth):dragHeader.savedFlex&&(dragHeader.flex=dragHeader.savedFlex,delete dragHeader.width),headerCt.purgeCache(),Ext.resumeLayouts(!0),headerCt.onHeaderMoved(dragHeader,colsToMove,fromIdx,toIdx)}}}}),Ext.define("Ext.grid.plugin.HeaderReorderer",{extend:Ext.AbstractPlugin,alias:"plugin.gridheaderreorderer",init:function(headerCt){this.headerCt=headerCt,headerCt.on({render:this.onHeaderCtRender,single:!0,scope:this})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},onHeaderCtRender:function(){var me=this;me.dragZone=new Ext.grid.header.DragZone(me.headerCt),me.dropZone=new Ext.grid.header.DropZone(me.headerCt),me.disabled&&me.dragZone.disable()},enable:function(){this.disabled=!1,this.dragZone&&this.dragZone.enable()},disable:function(){this.disabled=!0,this.dragZone&&this.dragZone.disable()}}),Ext.define("Ext.grid.header.Container",{extend:Ext.container.Container,border:!0,alias:"widget.headercontainer",baseCls:Ext.baseCSSPrefix+"grid-header-ct",dock:"top",weight:100,defaultType:"gridcolumn",detachOnRemove:!1,defaultWidth:100,sortAscText:"Sort Ascending",sortDescText:"Sort Descending",sortClearText:"Clear Sort",columnsText:"Columns",headerOpenCls:Ext.baseCSSPrefix+"column-header-open",menuSortAscCls:Ext.baseCSSPrefix+"hmenu-sort-asc",menuSortDescCls:Ext.baseCSSPrefix+"hmenu-sort-desc",menuColsIcon:Ext.baseCSSPrefix+"cols-icon",triStateSort:!1,ddLock:!1,dragging:!1,sortable:!0,enableColumnHide:!0,initComponent:function(){var me=this;me.headerCounter=0,me.plugins=me.plugins||[],me.isColumn||(me.enableColumnResize&&(me.resizer=new Ext.grid.plugin.HeaderResizer,me.plugins.push(me.resizer)),me.enableColumnMove&&(me.reorderer=new Ext.grid.plugin.HeaderReorderer,me.plugins.push(me.reorderer))),me.isColumn&&!me.isGroupHeader?me.items&&0!==me.items.length||(me.isContainer=!1,me.layout={type:"container",calculate:Ext.emptyFn}):(me.layout=Ext.apply({type:"gridcolumn",align:"stretch"},me.initialConfig.layout),me.isGroupHeader?(me.visibleColumnManager=new Ext.grid.ColumnManager((!0),me),me.columnManager=new Ext.grid.ColumnManager((!1),me)):(me.isRootHeader=!0,me.columnManager=new Ext.grid.ColumnManager((!1),me),me.visibleColumnManager=new Ext.grid.ColumnManager((!0),me),me.grid&&(me.grid.columnManager=me.columnManager,me.grid.visibleColumnManager=me.visibleColumnManager))),me.defaults=me.defaults||{},Ext.applyIf(me.defaults,{triStateSort:me.triStateSort,sortable:me.sortable}),me.menuTask=new Ext.util.DelayedTask(me.updateMenuDisabledState,me),me.callParent(),me.addEvents("columnresize","headerclick","headercontextmenu","headertriggerclick","columnmove","columnhide","columnshow","columnschanged","sortchange","menucreate")},isLayoutRoot:function(){return!this.hiddenHeaders&&this.callParent()},getOwnerHeaderCt:function(){var me=this;return me.isRootHeader?me:me.up("[isRootHeader]")},onDestroy:function(){var me=this;me.menu&&me.menu.un("hide",me.onMenuHide,me),me.menuTask.cancel(),me.callParent(),Ext.destroy(me.resizer,me.reorderer,me.visibleColumnManager,me.columnManager,me.menu),me.columnManager=me.visibleColumnManager=null},applyColumnsState:function(columns){if(columns&&columns.length){var c,col,columnState,index,me=this,items=me.items.items,count=items.length,i=0,length=columns.length;for(c=0;c<length;c++)for(columnState=columns[c],index=count;index--;)if(col=items[index],col.getStateId&&col.getStateId()==columnState.id){i!==index&&me.moveHeader(index,i),col.applyColumnState&&col.applyColumnState(columnState),++i;break}}},getColumnsState:function(){var state,me=this,columns=[];return me.items.each(function(col){state=col.getColumnState&&col.getColumnState(),state&&columns.push(state)}),columns},onAdd:function(c){var me=this;c.headerId||(c.headerId=c.initialConfig.id||Ext.id(null,"header-")),c.getStateId()||(c.stateId=c.initialConfig.id||"h"+ ++me.headerCounter),me.callParent(arguments),me.onColumnsChanged(),me.checkMoveNotify(c)},onMove:function(c,fromIdx,toIdx){var me=this;me.callParent(arguments),me.onColumnsChanged(),c.dropMoving||(me.checkMoveNotify(c),me.fireEvent("columnmove",me,c,fromIdx,toIdx))},onRemove:function(c){var me=this,ownerCt=me.ownerCt;me.callParent(arguments),me.destroying||(me.onColumnsChanged(),me.checkMoveNotify(c),me.isGroupHeader&&!me.items.getCount()&&ownerCt&&(me.detachComponent(c),Ext.suspendLayouts(),ownerCt.remove(me),Ext.resumeLayouts(!0)))},checkMoveNotify:function(c){var owner,root;c.isGroupHeader||(root=this.getOwnerHeaderCt(),root&&(owner=root.ownerCt,owner&&owner.onHeadersChanged(root,c)))},onShow:function(){this.callParent(arguments),this.onColumnsChanged()},onColumnsChanged:function(){var headerCt=this;this.purgeHeaderCtCache(headerCt),headerCt&&headerCt.rendered&&headerCt.fireEvent("columnschanged",headerCt)},applyDefaults:function(config){var ret;return config&&!config.isComponent&&"rownumberer"==config.xtype?ret=config:(ret=this.callParent(arguments),config.isGroupHeader||"width"in ret||ret.flex||(ret.width=this.defaultWidth)),ret},setSortState:function(){var hd,store=this.up("[store]").store,first=store.getFirstSorter();first?(hd=this.down("gridcolumn[dataIndex="+first.property+"]"),hd&&hd.setSortState(first.direction,!1,!0)):this.clearOtherSortStates(null)},getHeaderMenu:function(){var item,menu=this.getMenu();return menu&&(item=menu.child("#columnItem"))?item.menu:null},onHeaderVisibilityChange:function(header,visible){var item,me=this,menu=me.getHeaderMenu();me.purgeHeaderCtCache(header.ownerCt),menu&&(item=me.getMenuItemForHeader(menu,header),item&&item.setChecked(visible,!0),menu.isVisible()&&me.menuTask.delay(50))},updateMenuDisabledState:function(menu){var i,item,checkItem,method,me=this,columns=me.query(":not([hidden])"),len=columns.length;for(menu||(menu=me.getMenu()),i=0;i<len;++i)item=columns[i],checkItem=me.getMenuItemForHeader(menu,item),checkItem&&(method=item.isHideable()?"enable":"disable",checkItem.menu&&(method+="CheckChange"),checkItem[method]())},getMenuItemForHeader:function(menu,header){return header?menu.down("menucheckitem[headerId="+header.id+"]"):null},onHeaderShow:function(header){var me=this,gridSection=me.ownerCt;me.forceFit&&delete me.flex,me.onHeaderVisibilityChange(header,!0),header.isGroupHeader||gridSection&&gridSection.onHeaderShow(me,header),me.fireEvent("columnshow",me,header),me.fireEvent("columnschanged",this)},onHeaderHide:function(header){var me=this,gridSection=me.ownerCt;me.onHeaderVisibilityChange(header,!1),header.isGroupHeader||gridSection&&gridSection.onHeaderHide(me,header),me.fireEvent("columnhide",me,header),me.fireEvent("columnschanged",this)},tempLock:function(){this.ddLock=!0,Ext.Function.defer(function(){this.ddLock=!1},200,this)},onHeaderResize:function(header,w,suppressFocus){var me=this,view=me.view,gridSection=me.ownerCt;view&&view.body.dom&&(me.tempLock(),gridSection&&gridSection.onHeaderResize(me,header,w)),me.fireEvent("columnresize",this,header,w)},onHeaderClick:function(header,e,t){header.fireEvent("headerclick",this,header,e,t),this.fireEvent("headerclick",this,header,e,t)},onHeaderContextMenu:function(header,e,t){header.fireEvent("headercontextmenu",this,header,e,t),this.fireEvent("headercontextmenu",this,header,e,t)},onHeaderTriggerClick:function(header,e,t){var me=this;header.fireEvent("headertriggerclick",me,header,e,t)!==!1&&me.fireEvent("headertriggerclick",me,header,e,t)!==!1&&me.showMenuBy(t,header)},showMenuBy:function(t,header){var sortableMth,menu=this.getMenu(),ascItem=menu.down("#ascItem"),descItem=menu.down("#descItem");menu.activeHeader=menu.ownerButton=header,header.setMenuActive(!0),sortableMth=header.sortable?"enable":"disable",ascItem&&ascItem[sortableMth](),descItem&&descItem[sortableMth](),menu.showBy(t)},onMenuHide:function(menu){menu.activeHeader.setMenuActive(!1)},moveHeader:function(fromIdx,toIdx){this.tempLock(),this.onHeaderMoved(this.move(fromIdx,toIdx),1,fromIdx,toIdx)},purgeHeaderCtCache:function(headerCt){for(;headerCt;){if(headerCt.purgeCache(),headerCt.isRootHeader)return;headerCt=headerCt.ownerCt}},purgeCache:function(){var me=this,menu=me.menu,visibleColumnManager=me.visibleColumnManager,columnManager=me.columnManager;me.gridVisibleColumns=me.gridDataColumns=me.hideableColumns=null,visibleColumnManager&&(visibleColumnManager.invalidate(),columnManager.invalidate()),menu&&menu.hidden&&(menu.hide(),menu.destroy(),me.menu=null)},onHeaderMoved:function(header,colsToMove,fromIdx,toIdx){var me=this,gridSection=me.ownerCt;me.rendered&&(gridSection&&gridSection.onHeaderMove&&gridSection.onHeaderMove(me,header,colsToMove,fromIdx,toIdx),me.fireEvent("columnmove",me,header,fromIdx,toIdx))},getMenu:function(){var me=this;return me.menu||(me.menu=new Ext.menu.Menu({hideOnParentHide:!1,items:me.getMenuItems(),listeners:{hide:me.onMenuHide,scope:me}}),me.fireEvent("menucreate",me,me.menu)),me.updateMenuDisabledState(me.menu),me.menu},getMenuItems:function(){var me=this,menuItems=[],hideableColumns=me.enableColumnHide?me.getColumnMenu(me):null;return me.sortable&&(menuItems=[{itemId:"ascItem",text:me.sortAscText,iconCls:me.menuSortAscCls,handler:me.onSortAscClick,scope:me},{itemId:"descItem",text:me.sortDescText,iconCls:me.menuSortDescCls,handler:me.onSortDescClick,scope:me}]),hideableColumns&&hideableColumns.length&&(me.sortable&&menuItems.push("-"),menuItems.push({itemId:"columnItem",text:me.columnsText,iconCls:me.menuColsIcon,menu:hideableColumns,hideOnClick:!1})),menuItems},onSortAscClick:function(){var menu=this.getMenu(),activeHeader=menu.activeHeader;activeHeader.setSortState("ASC")},onSortDescClick:function(){var menu=this.getMenu(),activeHeader=menu.activeHeader;activeHeader.setSortState("DESC")},getColumnMenu:function(headerContainer){for(var item,menuItem,menuItems=[],i=0,items=headerContainer.query(">gridcolumn[hideable]"),itemsLn=items.length;i<itemsLn;i++)item=items[i],menuItem=new Ext.menu.CheckItem({text:item.menuText||item.text,checked:!item.hidden,hideOnClick:!1,headerId:item.id,menu:item.isGroupHeader?this.getColumnMenu(item):void 0,checkHandler:this.onColumnCheckChange,scope:this}),menuItems.push(menuItem),item.on({destroy:Ext.Function.bind(menuItem.destroy,menuItem)});return menuItems},onColumnCheckChange:function(checkItem,checked){var header=Ext.getCmp(checkItem.headerId);header[checked?"show":"hide"]()},getColumnCount:function(){return this.getGridColumns().length},getFullWidth:function(){for(var header,fullWidth=0,headers=this.getVisibleGridColumns(),headersLn=headers.length,i=0;i<headersLn;i++)header=headers[i],fullWidth+=header.getDesiredWidth?header.getDesiredWidth()||0:header.getWidth();return fullWidth},clearOtherSortStates:function(activeHeader){for(var headers=this.getGridColumns(),headersLn=headers.length,i=0;i<headersLn;i++)headers[i]!==activeHeader&&headers[i].setSortState(null,!0)},getVisibleGridColumns:function(){if(this.gridVisibleColumns)return this.gridVisibleColumns;var i,allColumns=this.getGridColumns(),result=[],len=allColumns.length;for(i=0;i<len;i++)allColumns[i].hidden||(result[result.length]=allColumns[i]);return this.gridVisibleColumns=result,result},getGridColumns:function(inResult,hiddenAncestor){if(!inResult&&this.gridDataColumns)return this.gridDataColumns;var items,i,len,item,lastVisibleColumn,me=this,result=inResult||[];if(hiddenAncestor=hiddenAncestor||me.hidden,me.items)for(items=me.items.items,i=0,len=items.length;i<len;i++)item=items[i],item.isGroupHeader?item.getGridColumns(result,hiddenAncestor):(item.hiddenAncestor=hiddenAncestor,result.push(item));if(inResult||(me.gridDataColumns=result),!inResult&&len){for(i=0,len=result.length;i<len;i++)item=result[i],item.isFirstVisible=item.isLastVisible=!1,item.hidden||item.hiddenAncestor||(lastVisibleColumn||(item.isFirstVisible=!0),lastVisibleColumn=item);lastVisibleColumn&&(lastVisibleColumn.isLastVisible=!0)}return result},getHideableColumns:function(){var me=this,result=me.hideableColumns;return result||(result=me.hideableColumns=me.query("[hideable]")),result},getHeaderIndex:function(header){return this.columnManager||(this.columnManager=this.getOwnerHeaderCt().columnManager),this.columnManager.getHeaderIndex(header)},getHeaderAtIndex:function(index){return this.columnManager||(this.columnManager=this.getOwnerHeaderCt().columnManager),this.columnManager.getHeaderAtIndex(index)},getVisibleHeaderClosestToIndex:function(index){return this.visibleColumnManager||(this.visibleColumnManager=this.getOwnerHeaderCt().visibleColumnManager),this.visibleColumnManager.getVisibleHeaderClosestToIndex(index)},applyForceFit:function(header){function getTotalFlex(){for(i=0,len=items.length;i<len;i++)item=items[i],item!==header&&(item.flex=item.flex||item.width||item.getWidth(),totalFlex+=item.flex,item.width=null)}function applyWidth(){var isCurrentHeader;for(i=0,len=items.length;i<len;i++)item=items[i],isCurrentHeader=item===header,useMinWidthForFlex&&!isCurrentHeader?(item.flex=minWidth,item.width=null):isCurrentHeader||(myWidth=item.flex||defaultWidth,item.flex=Math.max(Math.ceil(myWidth/totalFlex*availFlex),minWidth),item.width=null),item.setWidth(item.width||item.flex)}var len,i,item,maxAvailFlexOneColumn,myWidth,me=this,view=me.view,minWidth=Ext.grid.plugin.HeaderResizer.prototype.minColWidth,useMinWidthForFlex=!1,defaultWidth=Ext.grid.header.Container.prototype.defaultWidth,availFlex=me.el.getViewSize().width-(view.el.dom.scrollHeight>view.el.dom.clientHeight?Ext.getScrollbarSize().width:0),totalFlex=0,items=me.getVisibleGridColumns(),hidden=header.hidden;Ext.suspendLayouts(),maxAvailFlexOneColumn=availFlex-(items.length+1)*minWidth,header.flex=null,hidden?(myWidth=header.width||header.savedWidth,header.savedWidth=null):myWidth=view.getMaxContentWidth(header),myWidth>maxAvailFlexOneColumn?(header.width=maxAvailFlexOneColumn,useMinWidthForFlex=!0):(header.width=myWidth,availFlex-=myWidth+defaultWidth,getTotalFlex()),applyWidth(),Ext.resumeLayouts(!0)},autoSizeColumn:function(header){var view=this.view;view&&(view.autoSizeColumn(header),this.forceFit&&this.applyForceFit(header))}}),Ext.define("Ext.grid.column.Column",{extend:Ext.grid.header.Container,alias:"widget.gridcolumn",alternateClassName:"Ext.grid.Column",baseCls:Ext.baseCSSPrefix+"column-header",hoverCls:Ext.baseCSSPrefix+"column-header-over",handleWidth:4,ariaRole:"columnheader",sortState:null,possibleSortStates:["ASC","DESC"],childEls:["titleEl","triggerEl","textEl"],noWrap:!0,renderTpl:['<div id="{id}-titleEl" role="presentation" {tipMarkup}class="',Ext.baseCSSPrefix,"column-header-inner",'<tpl if="empty"> ',Ext.baseCSSPrefix,'column-header-inner-empty</tpl>">','<span id="{id}-textEl" class="',Ext.baseCSSPrefix,"column-header-text",'{childElCls}">',"{text}","</span>",'<tpl if="!menuDisabled">','<div id="{id}-triggerEl" role="presentation" class="',Ext.baseCSSPrefix,"column-header-trigger",'{childElCls}"></div>',"</tpl>","</div>","{%this.renderContainer(out,values)%}"],dataIndex:null,text:"&#160;",menuText:null,emptyCellText:"&#160;",sortable:!0,resizable:!0,hideable:!0,menuDisabled:!1,renderer:!1,editRenderer:!1,align:"left",draggable:!0,tooltipType:"qtip",initDraggable:Ext.emptyFn,tdCls:"",isHeader:!0,isColumn:!0,ascSortCls:Ext.baseCSSPrefix+"column-header-sort-ASC",descSortCls:Ext.baseCSSPrefix+"column-header-sort-DESC",componentLayout:"columncomponent",groupSubHeaderCls:Ext.baseCSSPrefix+"group-sub-header",groupHeaderCls:Ext.baseCSSPrefix+"group-header",clickTargetName:"titleEl",detachOnRemove:!0,initResizable:Ext.emptyFn,initComponent:function(){var renderer,listeners,me=this;null!=me.header&&(me.text=me.header,me.header=null),me.triStateSort||(me.possibleSortStates.length=2),null!=me.columns?(me.isGroupHeader=!0,me.items=me.columns,me.columns=me.flex=me.width=null,me.cls=(me.cls||"")+" "+me.groupHeaderCls,me.sortable=me.resizable=!1,me.align="center"):me.flex&&(me.minWidth=me.minWidth||Ext.grid.plugin.HeaderResizer.prototype.minColWidth),me.addCls(Ext.baseCSSPrefix+"column-header-align-"+me.align),renderer=me.renderer,renderer?("string"==typeof renderer&&(me.renderer=Ext.util.Format[renderer]),me.hasCustomRenderer=!0):me.defaultRenderer&&(me.scope=me,me.renderer=me.defaultRenderer),me.callParent(arguments),listeners={element:me.clickTargetName,click:me.onTitleElClick,contextmenu:me.onTitleElContextMenu,mouseenter:me.onTitleMouseOver,mouseleave:me.onTitleMouseOut,scope:me},me.resizable&&(listeners.dblclick=me.onTitleElDblClick),me.on(listeners)},initItems:function(){var me=this;me.callParent(arguments),me.isGroupHeader&&(me.hasVisibleChildren()||me.hide())},hasVisibleChildren:function(){var i,items=this.items.items,len=items.length;for(i=0;i<len;++i)if(!items[i].hidden)return!0;return!1},onAdd:function(child){var me=this,ownerHeaderCt=me.getOwnerHeaderCt();child.isColumn&&(child.isSubHeader=!0,child.addCls(this.groupSubHeaderCls)),me.hidden&&(ownerHeaderCt?child.hidden||me.show():child.hide()),me.callParent(arguments)},onRemove:function(child){var me=this;child.isSubHeader&&(child.isSubHeader=!1,child.removeCls(me.groupSubHeaderCls)),me.callParent(arguments),me.isGroupHeader&&!me.hasVisibleChildren()&&me.hide()},initRenderData:function(){var me=this,tipMarkup="",tip=me.tooltip,text=me.text,attr="qtip"==me.tooltipType?"data-qtip":"title";return Ext.isEmpty(tip)||(tipMarkup=attr+'="'+tip+'" '),Ext.applyIf(me.callParent(arguments),{text:text,empty:"&#160;"===text||" "===text||""===text,menuDisabled:me.menuDisabled,tipMarkup:tipMarkup})},applyColumnState:function(state){var me=this;me.applyColumnsState(state.columns),null!=state.hidden&&(me.hidden=state.hidden),null!=state.locked&&(me.locked=state.locked),null!=state.sortable&&(me.sortable=state.sortable),null!=state.width?(me.flex=null,me.width=state.width):null!=state.flex&&(me.width=null,me.flex=state.flex)},getColumnState:function(){var i,me=this,items=me.items.items,iLen=items?items.length:0,columns=[],state={id:me.getStateId()};if(me.savePropsToState(["hidden","sortable","locked","flex","width"],state),me.isGroupHeader){for(i=0;i<iLen;i++)columns.push(items[i].getColumnState());columns.length&&(state.columns=columns)}else me.isSubHeader&&me.ownerCt.hidden&&delete me.hidden;return"width"in state&&delete state.flex,state},getStateId:function(){return this.stateId||this.headerId},setText:function(text){this.text=text,this.rendered&&this.textEl.update(text)},getIndex:function(){return!this.isGroupColumn&&this.getOwnerHeaderCt().getHeaderIndex(this)},getVisibleIndex:function(){return!this.isGroupColumn&&Ext.Array.indexOf(this.getOwnerHeaderCt().getVisibleGridColumns(),this)},beforeRender:function(){var me=this,grid=me.up("tablepanel");me.callParent(),!grid||me.sortable&&grid.sortableColumns!==!1||me.groupable||me.lockable||grid.enableColumnHide!==!1&&me.getOwnerHeaderCt().getHideableColumns().length||(me.menuDisabled=!0),me.protoEl.unselectable()},afterRender:function(){var me=this,triggerEl=me.triggerEl;me.callParent(arguments),Ext.isIE8&&Ext.isStrict||me.mon(me.getFocusEl(),{focus:me.onTitleMouseOver,blur:me.onTitleMouseOut,scope:me}),triggerEl&&void 0===me.self.triggerElWidth&&(triggerEl.setStyle("display","block"),me.self.triggerElWidth=triggerEl.getWidth(),triggerEl.setStyle("display","")),me.keyNav=new Ext.util.KeyNav(me.el,{enter:me.onEnterKey,down:me.onDownKey,scope:me})},afterComponentLayout:function(width,height,oldWidth,oldHeight){var me=this,ownerHeaderCt=me.getOwnerHeaderCt();me.callParent(arguments),ownerHeaderCt&&(null!=oldWidth||me.flex)&&width!==oldWidth&&ownerHeaderCt.onHeaderResize(me,width,!0)},onDestroy:function(){var me=this;Ext.destroy(me.textEl,me.keyNav,me.field),me.keyNav=null,me.callParent(arguments)},onTitleMouseOver:function(){this.titleEl.addCls(this.hoverCls)},onTitleMouseOut:function(){this.titleEl.removeCls(this.hoverCls)},onDownKey:function(e){this.triggerEl&&this.onTitleElClick(e,this.triggerEl.dom||this.el.dom)},onEnterKey:function(e){this.onTitleElClick(e,this.el.dom)},onTitleElDblClick:function(e,t){var prev,leafColumns,me=this;if(me.isOnLeftEdge(e))prev=me.previousNode("gridcolumn:not([hidden]):not([isGroupHeader])"),prev&&prev.getOwnerHeaderCt()===me.getOwnerHeaderCt()&&prev.autoSize();else if(me.isOnRightEdge(e)){if(me.isGroupHeader&&e.getPoint().isContainedBy(me.layout.innerCt))return leafColumns=me.query("gridcolumn:not([hidden]):not([isGroupHeader])"),void this.getOwnerHeaderCt().autoSizeColumn(leafColumns[leafColumns.length-1]);me.autoSize()}},autoSize:function(){var leafColumns,numLeaves,i,headerCt,me=this;if(me.isGroupHeader){for(leafColumns=me.query("gridcolumn:not([hidden]):not([isGroupHeader])"),numLeaves=leafColumns.length,headerCt=this.getOwnerHeaderCt(),Ext.suspendLayouts(),i=0;i<numLeaves;i++)headerCt.autoSizeColumn(leafColumns[i]);return void Ext.resumeLayouts(!0)}this.getOwnerHeaderCt().autoSizeColumn(this)},onTitleElClick:function(e,t){var me=this,ownerHeaderCt=me.getOwnerHeaderCt();ownerHeaderCt&&!ownerHeaderCt.ddLock&&(me.triggerEl&&(e.target===me.triggerEl.dom||t===me.triggerEl.dom||e.within(me.triggerEl))?ownerHeaderCt.onHeaderTriggerClick(me,e,t):(e.getKey()||!me.isOnLeftEdge(e)&&!me.isOnRightEdge(e))&&(me.toggleSortState(),ownerHeaderCt.onHeaderClick(me,e,t)))},onTitleElContextMenu:function(e,t){var me=this,ownerHeaderCt=me.getOwnerHeaderCt();ownerHeaderCt&&!ownerHeaderCt.ddLock&&ownerHeaderCt.onHeaderContextMenu(me,e,t)},processEvent:function(type,view,cell,recordIndex,cellIndex,e){return this.fireEvent.apply(this,arguments)},toggleSortState:function(){var idx,nextIdx,me=this;me.sortable&&(idx=Ext.Array.indexOf(me.possibleSortStates,me.sortState),nextIdx=(idx+1)%me.possibleSortStates.length,me.setSortState(me.possibleSortStates[nextIdx]))},doSort:function(state){var tablePanel=this.up("tablepanel"),store=tablePanel.store;tablePanel.ownerLockable&&store.isNodeStore&&(store=tablePanel.ownerLockable.lockedGrid.store),store.sort({property:this.getSortParam(),direction:state})},getSortParam:function(){return this.dataIndex},setSortState:function(state,skipClear,initial){var me=this,ascCls=me.ascSortCls,descCls=me.descSortCls,ownerHeaderCt=me.getOwnerHeaderCt(),oldSortState=me.sortState;if(state=state||null,!me.sorting&&oldSortState!==state&&null!=me.getSortParam()){switch(state&&!initial&&(me.sorting=!0,me.doSort(state),me.sorting=!1),state){case"DESC":me.addCls(descCls),me.removeCls(ascCls);break;case"ASC":me.addCls(ascCls),me.removeCls(descCls);break;default:me.removeCls([ascCls,descCls])}!ownerHeaderCt||me.triStateSort||skipClear||ownerHeaderCt.clearOtherSortStates(me),me.sortState=state,(me.triStateSort||null!=state)&&ownerHeaderCt.fireEvent("sortchange",ownerHeaderCt,me,state)}},isHideable:function(){var result={hideCandidate:this,result:this.hideable};return result.result&&this.ownerCt.bubble(this.hasOtherMenuEnabledChildren,null,[result]),result.result},hasOtherMenuEnabledChildren:function(result){var visibleChildren,count;return this.isXType("headercontainer")?(visibleChildren=this.query(">:not([hidden]):not([menuDisabled])"),count=visibleChildren.length,Ext.Array.contains(visibleChildren,result.hideCandidate)&&count--,!count&&void(result.hideCandidate=this)):(result.result=!1,!1)},isLockable:function(){var result={result:this.lockable!==!1};return result.result&&this.ownerCt.bubble(this.hasMultipleVisibleChildren,null,[result]),result.result},isLocked:function(){return this.locked||!!this.up("[isColumn][locked]","[isRootHeader]")},hasMultipleVisibleChildren:function(result){return this.isXType("headercontainer")?!(this.query(">:not([hidden])").length>1)&&void 0:(result.result=!1,!1)},hide:function(fromOwner){var ownerIsGroup,item,items,len,i,me=this,ownerHeaderCt=me.getOwnerHeaderCt(),owner=me.ownerCt;if(!ownerHeaderCt)return me.callParent(),me;if(me.rendered&&!me.isVisible())return me;if(ownerHeaderCt.forceFit&&(me.visibleSiblingCount=ownerHeaderCt.getVisibleGridColumns().length-1,me.flex&&(me.savedWidth=me.getWidth(),me.flex=null)),ownerIsGroup=owner.isGroupHeader,ownerIsGroup&&!fromOwner&&(items=owner.query(">:not([hidden])"),1===items.length&&items[0]==me))return void me.ownerCt.hide();if(Ext.suspendLayouts(),me.isGroupHeader)for(items=me.items.items,i=0,len=items.length;i<len;i++)item=items[i],item.hidden||item.hide(!0);return me.callParent(),ownerHeaderCt.onHeaderHide(me),Ext.resumeLayouts(!0),me},show:function(fromOwner,fromChild){var items,len,i,item,me=this,ownerHeaderCt=me.getOwnerHeaderCt(),ownerCt=me.ownerCt;if(me.isVisible())return me;if(me.rendered&&ownerHeaderCt.forceFit&&ownerHeaderCt.applyForceFit(me),Ext.suspendLayouts(),me.isSubHeader&&ownerCt.hidden&&ownerCt.show(!1,!0),me.callParent(arguments),me.isGroupHeader&&fromChild!==!0&&!me.query(":not([hidden])").length)for(items=me.items.items,i=0,len=items.length;i<len;i++)item=items[i],item.hidden&&item.show(!0);Ext.resumeLayouts(!0),ownerCt=me.getOwnerHeaderCt(),ownerCt&&ownerCt.onHeaderShow(me)},getDesiredWidth:function(){var me=this;return me.rendered&&me.componentLayout&&me.componentLayout.lastComponentSize?me.componentLayout.lastComponentSize.width:me.flex?me.width:me.width},getCellId:function(){return Ext.baseCSSPrefix+"grid-cell-headerId-"+this.getItemId()},getCellSelector:function(){return"."+this.getCellId()},getCellInnerSelector:function(){return this.getCellSelector()+" ."+Ext.baseCSSPrefix+"grid-cell-inner"},isOnLeftEdge:function(e){return e.getXY()[0]-this.getX()<=this.handleWidth},isOnRightEdge:function(e){return this.getX()+this.getWidth()-e.getXY()[0]<=this.handleWidth},setMenuActive:function(isMenuOpen){this.titleEl[isMenuOpen?"addCls":"removeCls"](this.headerOpenCls)}}),Ext.define("Ext.grid.column.Action",{extend:Ext.grid.column.Column,alias:["widget.actioncolumn"],alternateClassName:"Ext.grid.ActionColumn",actionIdRe:new RegExp(Ext.baseCSSPrefix+"action-col-(\\d+)"),altText:"",menuText:"<i>Actions</i>",sortable:!1,innerCls:Ext.baseCSSPrefix+"grid-cell-inner-action-col",constructor:function(config){var hasGetClass,i,len,me=this,cfg=Ext.apply({},config),items=cfg.items||me.items||[me];for(me.origRenderer=cfg.renderer||me.renderer,me.origScope=cfg.scope||me.scope,me.renderer=me.scope=cfg.renderer=cfg.scope=null,cfg.items=null,me.callParent([cfg]),me.items=items,i=0,len=items.length;i<len;++i)if(items[i].getClass){hasGetClass=!0;break}(me.origRenderer||hasGetClass)&&(me.hasCustomRenderer=!0)},defaultRenderer:function(v,meta,record,rowIdx,colIdx,store,view){var item,ret,disabled,tooltip,me=this,prefix=Ext.baseCSSPrefix,scope=me.origScope||me,items=me.items,len=items.length,i=0;for(ret=Ext.isFunction(me.origRenderer)?me.origRenderer.apply(scope,arguments)||"":"",meta.tdCls+=" "+Ext.baseCSSPrefix+"action-col-cell";i<len;i++)item=items[i],disabled=item.disabled||!!item.isDisabled&&item.isDisabled.call(item.scope||scope,view,rowIdx,colIdx,item,record),tooltip=disabled?null:item.tooltip||(item.getTip?item.getTip.apply(item.scope||scope,arguments):null),item.hasActionConfiguration||(item.stopSelection=me.stopSelection,item.disable=Ext.Function.bind(me.disableAction,me,[i],0),item.enable=Ext.Function.bind(me.enableAction,me,[i],0),item.hasActionConfiguration=!0),ret+='<img role="button" alt="'+(item.altText||me.altText)+'" src="'+(item.icon||Ext.BLANK_IMAGE_URL)+'" class="'+prefix+"action-col-icon "+prefix+"action-col-"+String(i)+" "+(disabled?prefix+"item-disabled":" ")+" "+(Ext.isFunction(item.getClass)?item.getClass.apply(item.scope||scope,arguments):item.iconCls||me.iconCls||"")+'"'+(tooltip?' data-qtip="'+tooltip+'"':"")+" />";
return ret},enableAction:function(index,silent){var me=this;index?Ext.isNumber(index)||(index=Ext.Array.indexOf(me.items,index)):index=0,me.items[index].disabled=!1,me.up("tablepanel").el.select("."+Ext.baseCSSPrefix+"action-col-"+index).removeCls(me.disabledCls),silent||me.fireEvent("enable",me)},disableAction:function(index,silent){var me=this;index?Ext.isNumber(index)||(index=Ext.Array.indexOf(me.items,index)):index=0,me.items[index].disabled=!0,me.up("tablepanel").el.select("."+Ext.baseCSSPrefix+"action-col-"+index).addCls(me.disabledCls),silent||me.fireEvent("disable",me)},destroy:function(){return delete this.items,delete this.renderer,this.callParent(arguments)},processEvent:function(type,view,cell,recordIndex,cellIndex,e,record,row){var match,item,fn,disabled,me=this,target=e.getTarget(),key="keydown"==type&&e.getKey();if(key&&!Ext.fly(target).findParent(view.getCellSelector())&&(target=Ext.fly(cell).down("."+Ext.baseCSSPrefix+"action-col-icon",!0)),target&&(match=target.className.match(me.actionIdRe))&&(item=me.items[parseInt(match[1],10)],disabled=item.disabled||!!item.isDisabled&&item.isDisabled.call(item.scope||me.origScope||me,view,recordIndex,cellIndex,item,record),item&&!disabled))if("click"==type||key==e.ENTER||key==e.SPACE)fn=item.handler||me.handler,fn&&fn.call(item.scope||me.origScope||me,view,recordIndex,cellIndex,item,e,record,row);else if("mousedown"==type&&item.stopSelection!==!1)return!1;return me.callParent(arguments)},cascade:function(fn,scope){fn.call(scope||this,this)},getRefItems:function(){return[]}}),Ext.define("Ext.grid.column.Boolean",{extend:Ext.grid.column.Column,alias:["widget.booleancolumn"],alternateClassName:"Ext.grid.BooleanColumn",trueText:"true",falseText:"false",undefinedText:"&#160;",defaultRenderer:function(value){return void 0===value?this.undefinedText:value&&"false"!==value?this.trueText:this.falseText}}),Ext.define("Ext.grid.column.Check",{extend:Ext.grid.column.Column,alternateClassName:["Ext.ux.CheckColumn","Ext.grid.column.CheckColumn"],alias:"widget.checkcolumn",align:"center",stopSelection:!0,tdCls:Ext.baseCSSPrefix+"grid-cell-checkcolumn",innerCls:Ext.baseCSSPrefix+"grid-cell-inner-checkcolumn",clickTargetName:"el",constructor:function(){this.addEvents("beforecheckchange","checkchange"),this.scope=this,this.callParent(arguments)},processEvent:function(type,view,cell,recordIndex,cellIndex,e,record,row){var me=this,key="keydown"===type&&e.getKey(),mousedown="mousedown"==type;if(me.disabled||!mousedown&&key!=e.ENTER&&key!=e.SPACE)return me.callParent(arguments);var dataIndex=me.dataIndex,checked=!record.get(dataIndex);return me.fireEvent("beforecheckchange",me,recordIndex,checked)!==!1?(record.set(dataIndex,checked),me.fireEvent("checkchange",me,recordIndex,checked),mousedown&&e.stopEvent(),me.stopSelection||view.selModel.selectByPosition({row:recordIndex,column:cellIndex}),!1):!me.stopSelection},onEnable:function(){this.callParent(arguments),this._setDisabled(!1)},onDisable:function(){this._setDisabled(!0)},_setDisabled:function(disabled){var items,me=this,cls=me.disabledCls;items=me.up("tablepanel").el.select(me.getCellSelector()),disabled?items.addCls(cls):items.removeCls(cls)},renderer:function(value,meta){var cssPrefix=Ext.baseCSSPrefix,cls=cssPrefix+"grid-checkcolumn";return this.disabled&&(meta.tdCls+=" "+this.disabledCls),value&&(cls+=" "+cssPrefix+"grid-checkcolumn-checked"),'<img class="'+cls+'" src="'+Ext.BLANK_IMAGE_URL+'"/>'}}),Ext.define("Ext.grid.column.Date",{extend:Ext.grid.column.Column,alias:["widget.datecolumn"],alternateClassName:"Ext.grid.DateColumn",initComponent:function(){this.format||(this.format=Ext.Date.defaultFormat),this.callParent(arguments)},defaultRenderer:function(value){return Ext.util.Format.date(value,this.format)}}),Ext.define("Ext.grid.column.Number",{extend:Ext.grid.column.Column,alias:["widget.numbercolumn"],alternateClassName:"Ext.grid.NumberColumn",format:"0,000.00",defaultRenderer:function(value){return Ext.util.Format.number(value,this.format)}}),Ext.define("Ext.grid.column.RowNumberer",{extend:Ext.grid.column.Column,alternateClassName:"Ext.grid.RowNumberer",alias:"widget.rownumberer",text:"&#160;",width:23,sortable:!1,draggable:!1,autoLock:!0,lockable:!1,align:"right",constructor:function(config){var me=this;me.width=me.width,me.callParent(arguments),me.scope=me},beforeRender:function(){var rowBody=this.up("gridpanel").view.findFeature("rowbody");this.callParent(arguments),rowBody&&1===this.ownerCt.items.indexOf(this)&&(rowBody.colSpanDecrement=rowBody.colSpanDecrement+1,this.rowspan=2)},resizable:!1,hideable:!1,menuDisabled:!0,dataIndex:"",cls:Ext.baseCSSPrefix+"row-numberer",tdCls:Ext.baseCSSPrefix+"grid-cell-row-numberer "+Ext.baseCSSPrefix+"grid-cell-special",innerCls:Ext.baseCSSPrefix+"grid-cell-inner-row-numberer",rowspan:void 0,renderer:function(value,metaData,record,rowIdx,colIdx,dataSource,view){var rowspan=this.rowspan,page=dataSource.currentPage,result=view.store.indexOf(record);return rowspan&&(metaData.tdAttr='rowspan="'+rowspan+'"'),page>1&&(result+=(page-1)*dataSource.pageSize),result+1}}),Ext.define("Ext.grid.column.Template",{extend:Ext.grid.column.Column,alias:["widget.templatecolumn"],alternateClassName:"Ext.grid.TemplateColumn",initComponent:function(){var me=this;me.tpl=!Ext.isPrimitive(me.tpl)&&me.tpl.compile?me.tpl:new Ext.XTemplate(me.tpl),me.hasCustomRenderer=!0,me.callParent(arguments)},defaultRenderer:function(value,meta,record){var data=Ext.apply({},record.data,record.getAssociatedData());return this.tpl.apply(data)}}),Ext.define("Ext.grid.feature.Feature",{extend:Ext.util.Observable,alias:"feature.feature",wrapsItem:!1,isFeature:!0,disabled:!1,hasFeatureEvent:!0,eventPrefix:null,eventSelector:null,view:null,grid:null,constructor:function(config){this.initialConfig=config,this.callParent(arguments)},clone:function(){return new this.self(this.initialConfig)},init:Ext.emptyFn,destroy:function(){this.clearListeners()},getFireEventArgs:function(eventName,view,featureTarget,e){return[eventName,view,featureTarget,e]},vetoEvent:Ext.emptyFn,enable:function(){this.disabled=!1},disable:function(){this.disabled=!0}}),Ext.define("Ext.grid.feature.AbstractSummary",{extend:Ext.grid.feature.Feature,alias:"feature.abstractsummary",summaryRowCls:Ext.baseCSSPrefix+"grid-row-summary",summaryTableCls:Ext.plainTableCls+" "+Ext.baseCSSPrefix+"grid-table",summaryRowSelector:"."+Ext.baseCSSPrefix+"grid-row-summary",summaryRowTpl:{before:function(values,out){if(values.record.isSummary&&this.summaryFeature.showSummaryRow)return this.summaryFeature.outputSummaryRecord(values.record,values,out),!1},priority:1e3},showSummaryRow:!0,init:function(){var me=this;me.view.summaryFeature=me,me.rowTpl=me.view.self.prototype.rowTpl,me.view.addRowTpl(me.summaryRowTpl).summaryFeature=me},toggleSummaryRow:function(visible){this.showSummaryRow=!!visible},outputSummaryRecord:function(summaryRecord,contextValues,out){var i,column,view=contextValues.view,savedRowValues=view.rowValues,columns=contextValues.columns||view.headerCt.getVisibleGridColumns(),colCount=columns.length,values={view:view,record:summaryRecord,rowStyle:"",rowClasses:[this.summaryRowCls],itemClasses:[],recordIndex:-1,rowId:view.getRowId(summaryRecord),columns:columns};for(i=0;i<colCount;i++)column=columns[i],column.savedRenderer=column.renderer,column.summaryRenderer?column.renderer=column.summaryRenderer:column.summaryType||(column.renderer=Ext.emptyFn),column.dataIndex||(column.dataIndex=column.id);for(view.rowValues=values,view.self.prototype.rowTpl.applyOut(values,out),view.rowValues=savedRowValues,i=0;i<colCount;i++)column=columns[i],column.renderer=column.savedRenderer,column.savedRenderer=null},getSummary:function(store,type,field,group){var records=group.records;if(type){if(Ext.isFunction(type))return store.getAggregate(type,null,records,[field]);switch(type){case"count":return records.length;case"min":return store.getMin(records,field);case"max":return store.getMax(records,field);case"sum":return store.getSum(records,field);case"average":return store.getAverage(records,field);default:return""}}},generateSummaryData:function(){var i,group,record,root,summaryRows,hasRemote,convertedSummaryRow,remoteData,me=this,store=me.view.store,groups=store.groups.items,reader=store.proxy.reader,len=groups.length,groupField=me.getGroupField(),data={},lockingPartner=me.lockingPartner;if(me.remoteRoot&&reader.rawData){for(hasRemote=!0,remoteData={},root=reader.root,reader.root=me.remoteRoot,reader.buildExtractors(!0),summaryRows=reader.getRoot(reader.rawData)||[],len=summaryRows.length,reader.convertRecordData||reader.buildExtractors(),i=0;i<len;++i)convertedSummaryRow={},reader.convertRecordData(convertedSummaryRow,summaryRows[i]),remoteData[convertedSummaryRow[groupField]]=convertedSummaryRow;reader.root=root,reader.buildExtractors(!0)}for(i=0;i<len;++i)group=groups[i],hasRemote||group.isDirty()||!group.hasAggregate()?(record=hasRemote?me.populateRemoteRecord(group,remoteData):me.populateRecord(group),lockingPartner&&me.view.ownerCt!==me.view.ownerCt.ownerLockable.normalGrid||group.commit()):record=group.getAggregateRecord(),data[group.key]=record;return data},populateRemoteRecord:function(group,data){var field,record=group.getAggregateRecord(!0),groupData=data[group.key];record.beginEdit();for(field in groupData)groupData.hasOwnProperty(field)&&field!==record.idProperty&&record.set(field,groupData[field]);return record.endEdit(!0),record.commit(!0),record},populateRecord:function(group){var i,column,fieldName,me=this,view=me.grid.ownerLockable?me.grid.ownerLockable.view:me.view,store=me.view.store,record=group.getAggregateRecord(),columns=view.headerCt.getGridColumns(),len=columns.length;for(record.beginEdit(),i=0;i<len;++i)column=columns[i],fieldName=column.dataIndex||column.id,record.set(fieldName,me.getSummary(store,column.summaryType,fieldName,group));return record.endEdit(!0),record.commit(),record}}),Ext.define("Ext.grid.feature.GroupStore",{extend:Ext.util.Observable,isStore:!0,defaultViewSize:100,isFeatureStore:!0,constructor:function(groupingFeature,store){var me=this;me.callParent(),me.groupingFeature=groupingFeature,me.bindStore(store)},bindStore:function(store){var me=this;me.store&&(Ext.destroy(me.storeListeners),me.store=null),store&&(me.storeListeners=store.on({bulkremove:me.onBulkRemove,add:me.onAdd,update:me.onUpdate,refresh:me.onRefresh,clear:me.onClear,scope:me,destroyable:!0}),me.store=store,me.processStore(store))},processStore:function(store){var i,group,groupPlaceholder,me=this,groups=store.getGroups(),groupCount=groups.length,data=me.data,oldGroupCache=me.groupingFeature.groupCache,groupCache=me.groupingFeature.clearGroupCache(),collapseAll=me.groupingFeature.startCollapsed;if(data?data.clear():data=me.data=new Ext.util.MixedCollection((!1),Ext.data.Store.recordIdFn),store.getCount())for(me.groupingFeature.startCollapsed=!1,i=0;i<groupCount;i++)group=groups[i],groupCache[group.name]=group,group.isCollapsed=collapseAll||oldGroupCache[group.name]&&oldGroupCache[group.name].isCollapsed,group.isCollapsed?(group.placeholder=groupPlaceholder=new store.model(null,"group-"+group.name+"-placeholder"),groupPlaceholder.set(store.getGroupField(),group.name),groupPlaceholder.rows=groupPlaceholder.children=group.children,groupPlaceholder.isCollapsedPlaceholder=!0,data.add(groupPlaceholder)):data.insert(me.data.length,group.children)},isCollapsed:function(name){return this.groupingFeature.groupCache[name].isCollapsed},isInCollapsedGroup:function(record){var groupData,store=this.store;return!(!store.isGrouped()||!(groupData=this.groupingFeature.groupCache[record.get(store.getGroupField())]))&&(groupData.isCollapsed||!1)},getCount:function(){return this.data.getCount()},getTotalCount:function(){return this.data.getCount()},rangeCached:function(start,end){return end<this.getCount()},getRange:function(start,end,options){var result=this.data.getRange(start,end);return options&&options.callback&&options.callback.call(options.scope||this,result,start,end,options),result},getAt:function(index){return this.getRange(index,index)[0]},getById:function(id){return this.store.getById(id)},expandGroup:function(group){var startIdx,me=this;"string"==typeof group&&(group=me.groupingFeature.groupCache[group]),group&&group.children.length&&(startIdx=me.indexOf(group.children[0],!0,!0))!==-1&&(group.isCollapsed=!1,me.isExpandingOrCollapsing=1,me.data.removeAt(startIdx),me.fireEvent("bulkremove",me,[me.getGroupPlaceholder(group)],[startIdx]),me.data.insert(startIdx,group.children),me.fireEvent("add",me,group.children,startIdx),me.fireEvent("groupexpand",me,group),me.isExpandingOrCollapsing=0)},collapseGroup:function(group){var startIdx,placeholder,i,j,len,removeIndices,me=this;if("string"==typeof group&&(group=me.groupingFeature.groupCache[group]),group&&(len=group.children.length)&&(startIdx=me.indexOf(group.children[0],!0))!==-1){for(group.isCollapsed=!0,me.isExpandingOrCollapsing=2,me.data.removeRange(startIdx,len),removeIndices=new Array(len),i=0,j=startIdx;i<len;i++,j++)removeIndices[i]=j;me.fireEvent("bulkremove",me,group.children,removeIndices),me.data.insert(startIdx,placeholder=me.getGroupPlaceholder(group)),me.fireEvent("add",me,[placeholder],startIdx),me.fireEvent("groupcollapse",me,group),me.isExpandingOrCollapsing=0}},getGroupPlaceholder:function(group){if(!group.placeholder){var groupPlaceholder=group.placeholder=new this.store.model(null,"group-"+group.name+"-placeholder");groupPlaceholder.set(this.store.getGroupField(),group.name),groupPlaceholder.rows=groupPlaceholder.children=group.children,groupPlaceholder.isCollapsedPlaceholder=!0}return group.placeholder},indexOf:function(record,viewOnly,includeCollapsed){var groups,groupCount,i,group,groupIndex,me=this,result=0;if(record&&(includeCollapsed||!me.isInCollapsedGroup(record)))for(groups=me.store.getGroups(),groupCount=groups.length,i=0;i<groupCount;i++){if(group=groups[i],group.name===this.store.getGroupString(record))return groupIndex=Ext.Array.indexOf(group.children,record),result+groupIndex;result+=viewOnly&&me.isCollapsed(group.name)?1:group.children.length}return-1},indexOfTotal:function(record){return this.store.indexOf(record)},onRefresh:function(store){this.processStore(this.store),this.fireEvent("refresh",this)},onBulkRemove:function(store,records,indices){this.processStore(this.store),this.fireEvent("refresh",this)},onClear:function(store,records,startIndex){this.processStore(this.store),this.fireEvent("clear",this)},onAdd:function(store,records,startIndex){this.processStore(this.store),this.fireEvent("refresh",this)},onUpdate:function(store,record,operation,modifiedFieldNames){var groupInfo,firstRec,lastRec,me=this;if(store.isGrouped()){if(groupInfo=record.group=me.groupingFeature.getRecordGroup(record),modifiedFieldNames&&Ext.Array.contains(modifiedFieldNames,me.groupingFeature.getGroupField()))return me.onRefresh(me.store);groupInfo.isCollapsed?me.fireEvent("update",me,groupInfo.placeholder):(Ext.suspendLayouts(),me.fireEvent("update",me,record,operation,modifiedFieldNames),firstRec=groupInfo.children[0],lastRec=groupInfo.children[groupInfo.children.length-1],firstRec!==record&&(firstRec.group=groupInfo,me.fireEvent("update",me,firstRec,"edit"),delete firstRec.group),lastRec!==record&&lastRec!==firstRec&&me.groupingFeature.showSummaryRow&&(lastRec.group=groupInfo,me.fireEvent("update",me,lastRec,"edit"),delete lastRec.group),Ext.resumeLayouts(!0)),delete record.group}else me.fireEvent("update",me,record,operation,modifiedFieldNames)}}),Ext.define("Ext.grid.feature.Grouping",{extend:Ext.grid.feature.Feature,mixins:{summary:Ext.grid.feature.AbstractSummary},alias:"feature.grouping",eventPrefix:"group",groupCls:Ext.baseCSSPrefix+"grid-group-hd",eventSelector:"."+Ext.baseCSSPrefix+"grid-group-hd",refreshData:{},groupInfo:{},wrapsItem:!0,groupHeaderTpl:"{columnName}: {name}",depthToIndent:17,collapsedCls:Ext.baseCSSPrefix+"grid-group-collapsed",hdCollapsedCls:Ext.baseCSSPrefix+"grid-group-hd-collapsed",hdNotCollapsibleCls:Ext.baseCSSPrefix+"grid-group-hd-not-collapsible",collapsibleCls:Ext.baseCSSPrefix+"grid-group-hd-collapsible",ctCls:Ext.baseCSSPrefix+"group-hd-container",groupByText:"Group by this field",showGroupsText:"Show in groups",hideGroupedHeader:!1,startCollapsed:!1,enableGroupingMenu:!0,enableNoGroups:!0,collapsible:!0,expandTip:"Click to expand. CTRL key collapses all others",collapseTip:"Click to collapse. CTRL/click collapses all others",showSummaryRow:!1,tableTpl:{before:function(values){this.groupingFeature.disabled||1===values.rows.length&&values.rows[0].isSummary||this.groupingFeature.setup(values.rows,values.view.rowValues)},after:function(values){this.groupingFeature.disabled||1===values.rows.length&&values.rows[0].isSummary||this.groupingFeature.cleanup(values.rows,values.view.rowValues)},priority:200},groupTpl:["{%","var me = this.groupingFeature;","if (me.disabled) {","values.needsWrap = false;","} else {","me.setupRowData(values.record, values.rowIndex, values);","}","%}",'<tpl if="needsWrap">','<tr {[values.isCollapsedGroup ? ("id=\\"" + values.rowId + "\\"") : ""]} data-boundView="{view.id}" data-recordId="{record.internalId:htmlEncode}" data-recordIndex="{[values.isCollapsedGroup ? -1 : values.recordIndex]}" ','class="{[values.itemClasses.join(" ")]} ',Ext.baseCSSPrefix,'grid-wrap-row<tpl if="!summaryRecord"> ',Ext.baseCSSPrefix,'grid-group-row</tpl>" {ariaRowAttr}>','<td class="',Ext.baseCSSPrefix,'group-hd-container" colspan="{columns.length}" {ariaCellAttr}>','<tpl if="isFirstRow">',"{%",'var groupTitleStyle = (!values.view.lockingPartner || (values.view.ownerCt === values.view.ownerCt.ownerLockable.lockedGrid) || (values.view.lockingPartner.headerCt.getVisibleGridColumns().length === 0)) ? "" : "visibility:hidden";',"%}",'<div id="{groupId}" class="',Ext.baseCSSPrefix,'grid-group-hd {collapsibleCls}" tabIndex="0" hidefocus="on" {ariaCellInnerAttr}>','<div class="',Ext.baseCSSPrefix,'grid-group-title" style="{[groupTitleStyle]}" {ariaGroupTitleAttr}>','{[values.groupHeaderTpl.apply(values.groupInfo, parent) || "&#160;"]}',"</div>","</div>","</tpl>",'<tpl if="summaryRecord || !isCollapsedGroup">','<table class="',Ext.baseCSSPrefix,"{view.id}-table ",Ext.baseCSSPrefix,"grid-table",'<tpl if="summaryRecord"> ',Ext.baseCSSPrefix,'grid-table-summary</tpl>"','border="0" cellspacing="0" cellpadding="0" style="width:100%" {ariaSummaryTableAttr}>',"{[values.view.renderColumnSizer(out)]}",'<tpl if="!isCollapsedGroup">',"{%","values.itemClasses.length = 0;","this.nextTpl.applyOut(values, out, parent);","%}","</tpl>",'<tpl if="summaryRecord">',"{%me.outputSummaryRecord(values.summaryRecord, values, out);%}","</tpl>","</table>","</tpl>","</td>","</tr>","<tpl else>","{%this.nextTpl.applyOut(values, out, parent);%}","</tpl>",{priority:200,syncRowHeights:function(firstRow,secondRow){firstRow=Ext.fly(firstRow,"syncDest"),secondRow=Ext.fly(secondRow,"sycSrc");var secondHd,secondSummaryRow,firstHeight,secondHeight,owner=this.owner,firstHd=firstRow.down(owner.eventSelector,!0),firstSummaryRow=firstRow.down(owner.summaryRowSelector,!0);firstHd&&(secondHd=secondRow.down(owner.eventSelector,!0))&&(firstHd.style.height=secondHd.style.height="",(firstHeight=firstHd.offsetHeight)>(secondHeight=secondHd.offsetHeight)?Ext.fly(secondHd).setHeight(firstHeight):secondHeight>firstHeight&&Ext.fly(firstHd).setHeight(secondHeight)),firstSummaryRow&&(secondSummaryRow=secondRow.down(owner.summaryRowSelector,!0))&&(firstSummaryRow.style.height=secondSummaryRow.style.height="",(firstHeight=firstSummaryRow.offsetHeight)>(secondHeight=secondSummaryRow.offsetHeight)?Ext.fly(secondSummaryRow).setHeight(firstHeight):secondHeight>firstHeight&&Ext.fly(firstSummaryRow).setHeight(secondHeight))},syncContent:function(destRow,sourceRow){destRow=Ext.fly(destRow,"syncDest"),sourceRow=Ext.fly(sourceRow,"sycSrc");var owner=this.owner,destHd=destRow.down(owner.eventSelector,!0),sourceHd=sourceRow.down(owner.eventSelector,!0),destSummaryRow=destRow.down(owner.summaryRowSelector,!0),sourceSummaryRow=sourceRow.down(owner.summaryRowSelector,!0);destHd&&sourceHd&&Ext.fly(destHd).syncContent(sourceHd),destSummaryRow&&sourceSummaryRow&&Ext.fly(destSummaryRow).syncContent(sourceSummaryRow)}}],constructor:function(){this.groupCache={},this.callParent(arguments)},init:function(grid){var me=this,view=me.view;view.store.groupField&&(view.isGrouping=!0),me.lockingPartner&&me.lockingPartner.groupCache&&(me.groupCache=me.lockingPartner.groupCache),me.mixins.summary.init.call(me),me.callParent(arguments),view.headerCt.on({columnhide:me.onColumnHideShow,columnshow:me.onColumnHideShow,columnmove:me.onColumnMove,scope:me}),view.addTableTpl(me.tableTpl).groupingFeature=me,view.addRowTpl(Ext.XTemplate.getTpl(me,"groupTpl")).groupingFeature=me,view.preserveScrollOnRefresh=!0,view.store.buffered?me.collapsible=!1:this.lockingPartner&&this.lockingPartner.dataSource?me.dataSource=view.dataSource=this.lockingPartner.dataSource:me.dataSource=view.dataSource=new Ext.grid.feature.GroupStore(me,view.store),me.grid.on({reconfigure:me.onReconfigure}),view.on({afterrender:me.afterViewRender,scope:me,single:!0})},indexOf:function(record){var storeGroups,i,length,storeGroup,myGroup,groupStart,me=this,store=me.view.store,recordIdx=record.isModel?store.indexOf(record):Math.min(Math.max(record,0),store.getCount()-1),nextGroupStart=0,skippedRecords=0;for(storeGroups=store.getGroups(),i=0,length=storeGroups.length;i<length;i++){if(storeGroup=storeGroups[i],myGroup=me.getGroup(storeGroup.name),groupStart=nextGroupStart,nextGroupStart=groupStart+storeGroup.children.length,recordIdx<nextGroupStart)return recordIdx-skippedRecords;myGroup.isCollapsed&&(skippedRecords+=storeGroup.children.length,skippedRecords-=1)}},isInCollapsedGroup:function(record){var groupData,store=this.view.store;return!(!store.isGrouped()||!(groupData=this.getGroup(record)))&&(groupData.isCollapsed||!1)},clearGroupCache:function(){var me=this,groupCache=me.groupCache={};return me.lockingPartner&&(me.lockingPartner.groupCache=groupCache),groupCache},vetoEvent:function(record,row,rowIndex,e){if("mouseover"!==e.type&&"mouseout"!==e.type&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&e.getTarget(this.eventSelector))return!1},enable:function(){var groupToggleMenuItem,me=this,view=me.view,store=view.store;view.isGrouping=!0,me.lastGroupers&&(me.block(),store.group(me.lastGroupers),me.lastGroupers=null,me.unblock()),me.callParent(),groupToggleMenuItem=me.view.headerCt.getMenu().down("#groupToggleMenuItem"),groupToggleMenuItem&&groupToggleMenuItem.setChecked(!0,!0),me.refreshIf()},disable:function(){var groupToggleMenuItem,me=this,view=me.view,store=view.store,lastGroupers=store.groupers.getRange();view.isGrouping=!1,lastGroupers.length&&(me.lastGroupers=lastGroupers,me.block(),store.clearGrouping(),me.unblock()),me.callParent(),groupToggleMenuItem=me.view.headerCt.getMenu().down("#groupToggleMenuItem"),groupToggleMenuItem&&groupToggleMenuItem.setChecked(!1,!0),me.refreshIf()},refreshIf:function(){var ownerCt=this.grid.ownerCt,view=this.view;view.store.remoteGroup||this.blockRefresh||(ownerCt&&ownerCt.lockable?ownerCt.view.refresh():view.refresh())},afterViewRender:function(){var me=this,view=me.view;view.on({scope:me,groupclick:me.onGroupClick}),me.enableGroupingMenu&&me.injectGroupingMenu(),me.pruneGroupedHeader(),me.lastGroupers=me.view.store.groupers.getRange(),me.block(),me.onGroupChange(),me.unblock(),me.disabled&&me.disable()},injectGroupingMenu:function(){var me=this,headerCt=me.view.headerCt;headerCt.showMenuBy=me.showMenuBy,headerCt.getMenuItems=me.getMenuItems()},onColumnHideShow:function(headerOwnerCt,header){var items,len,i,view=this.view,headerCt=view.headerCt,menu=headerCt.getMenu(),groupToggleMenuItem=menu.down("#groupMenuItem"),colCount=this.grid.getVisibleColumnManager().getColumns().length;if(groupToggleMenuItem&&(headerCt.getVisibleGridColumns().length>1?groupToggleMenuItem.enable():groupToggleMenuItem.disable()),view.rendered)for(items=view.el.query("."+this.ctCls),i=0,len=items.length;i<len;++i)items[i].colSpan=colCount},onColumnMove:function(){var groups,groupName,group,firstRec,lastRec,me=this,store=me.view.store;if(store.isGrouped()){groups=me.groupCache;for(groupName in groups)groups.hasOwnProperty(groupName)&&(group=groups[groupName],firstRec=group.children[0],lastRec=group.children[group.children.length-1],store.fireEvent("update",store,firstRec,"edit",null),lastRec!==firstRec&&me.showSummaryRow&&store.fireEvent("update",store,lastRec,"edit",null))}},showMenuBy:function(t,header){var menu=this.getMenu(),groupMenuItem=menu.down("#groupMenuItem"),groupMenuMeth=header.groupable===!1||null==header.dataIndex||this.view.headerCt.getVisibleGridColumns().length<2?"disable":"enable",groupToggleMenuItem=menu.down("#groupToggleMenuItem"),isGrouped=this.view.store.isGrouped();groupMenuItem[groupMenuMeth](),groupToggleMenuItem&&(groupToggleMenuItem.setChecked(isGrouped,!0),groupToggleMenuItem[isGrouped?"enable":"disable"]()),Ext.grid.header.Container.prototype.showMenuBy.apply(this,arguments)},getMenuItems:function(){var me=this,groupByText=me.groupByText,disabled=me.disabled||!me.getGroupField(),showGroupsText=me.showGroupsText,enableNoGroups=me.enableNoGroups,getMenuItems=me.view.headerCt.getMenuItems;return function(){var o=getMenuItems.call(this);return o.push("-",{iconCls:Ext.baseCSSPrefix+"group-by-icon",itemId:"groupMenuItem",text:groupByText,handler:me.onGroupMenuItemClick,scope:me}),enableNoGroups&&o.push({itemId:"groupToggleMenuItem",text:showGroupsText,checked:!disabled,checkHandler:me.onGroupToggleMenuItemClick,scope:me}),o}},onGroupMenuItemClick:function(menuItem,e){var me=this,menu=menuItem.parentMenu,hdr=menu.activeHeader,view=me.view,store=view.store;me.lastGroupers=null,me.block(),me.enable(),store.group(hdr.dataIndex),me.pruneGroupedHeader(),me.unblock(),me.refreshIf()},block:function(fromPartner){this.blockRefresh=this.view.blockRefresh=!0,this.lockingPartner&&!fromPartner&&this.lockingPartner.block(!0)},unblock:function(fromPartner){this.blockRefresh=this.view.blockRefresh=!1,this.lockingPartner&&!fromPartner&&this.lockingPartner.unblock(!0)},onGroupToggleMenuItemClick:function(menuItem,checked){this[checked?"enable":"disable"]()},pruneGroupedHeader:function(){var me=this,header=me.getGroupedHeader();me.hideGroupedHeader&&header&&(Ext.suspendLayouts(),me.prunedHeader&&me.prunedHeader!==header&&me.prunedHeader.show(),me.prunedHeader=header,header.hide(),Ext.resumeLayouts(!0))},getHeaderNode:function(groupName){return Ext.get(this.createGroupId(groupName))},getGroup:function(name){name.isModel&&(name=name.get(this.view.store.getGroupField()));var cache=this.groupCache,item=cache[name];return item||(item=cache[name]={isCollapsed:!1}),item},isExpanded:function(groupName){return!this.getGroup(groupName).isCollapsed},expand:function(groupName,focus){this.doCollapseExpand(!1,groupName,focus)},expandAll:function(){var groupName,me=this,groupCache=me.groupCache,lockingPartner=me.lockingPartner;for(groupName in groupCache)groupCache.hasOwnProperty(groupName)&&(groupCache[groupName].isCollapsed=!1);Ext.suspendLayouts(),me.dataSource.onRefresh(),Ext.resumeLayouts(!0);for(groupName in groupCache)groupCache.hasOwnProperty(groupName)&&(me.afterCollapseExpand(!1,groupName),lockingPartner&&lockingPartner.afterCollapseExpand(!1,groupName))},collapse:function(groupName,focus){this.doCollapseExpand(!0,groupName,focus)},isAllCollapsed:function(){var groupName,me=this,groupCache=me.groupCache;for(groupName in groupCache)if(groupCache.hasOwnProperty(groupName)&&!groupCache[groupName].isCollapsed)return!1;return!0},isAllExpanded:function(){var groupName,me=this,groupCache=me.groupCache;for(groupName in groupCache)if(groupCache.hasOwnProperty(groupName)&&groupCache[groupName].isCollapsed)return!1;return!0},collapseAll:function(){var groupName,me=this,groupCache=me.groupCache,lockingPartner=me.lockingPartner;for(groupName in groupCache)groupCache.hasOwnProperty(groupName)&&(groupCache[groupName].isCollapsed=!0);Ext.suspendLayouts(),me.dataSource.onRefresh(),lockingPartner&&!lockingPartner.isAllCollapsed()&&lockingPartner.collapseAll(),Ext.resumeLayouts(!0);for(groupName in groupCache)groupCache.hasOwnProperty(groupName)&&(me.afterCollapseExpand(!0,groupName),lockingPartner&&lockingPartner.afterCollapseExpand(!0,groupName))},doCollapseExpand:function(collapsed,groupName,focus){var me=this,lockingPartner=me.lockingPartner,group=me.groupCache[groupName];group.isCollapsed!=collapsed&&(Ext.suspendLayouts(),collapsed?me.dataSource.collapseGroup(group):me.dataSource.expandGroup(group),Ext.resumeLayouts(!0),me.afterCollapseExpand(collapsed,groupName,focus),lockingPartner&&lockingPartner.afterCollapseExpand(collapsed,groupName,!1))},afterCollapseExpand:function(collapsed,groupName,focus){var header,me=this,view=me.view;header=Ext.get(this.getHeaderNode(groupName)),view.fireEvent(collapsed?"groupcollapse":"groupexpand",view,header,groupName),focus&&header.up(view.getItemSelector()).scrollIntoView(view.el,null,!0)},onGroupChange:function(){var menuItem,visibleGridColumns,groupingByLastVisibleColumn,me=this,field=me.getGroupField();me.hideGroupedHeader&&(me.lastGroupers&&me.lastGroupers.length&&(menuItem=me.getMenuItem(me.lastGroupers[0].property),menuItem&&menuItem.setChecked(!0)),field&&(visibleGridColumns=me.view.headerCt.getVisibleGridColumns(),groupingByLastVisibleColumn=1===visibleGridColumns.length&&visibleGridColumns[0].dataIndex==field,menuItem=me.getMenuItem(field),menuItem&&!groupingByLastVisibleColumn&&menuItem.setChecked(!1))),me.refreshIf(),me.lastGroupers=me.view.store.groupers.getRange()},getMenuItem:function(dataIndex){var view=this.view,header=view.headerCt.down("gridcolumn[dataIndex="+dataIndex+"]"),menu=view.headerCt.getMenu();return header?menu.down("menuitem[headerId="+header.id+"]"):null},onGroupKey:function(keyCode,event){var me=this,groupName=me.getGroupName(event.target);groupName&&me.onGroupClick(me.view,event.target,groupName,event)},onGroupClick:function(view,rowElement,groupName,e){var g,me=this,groupCache=me.groupCache,groupIsCollapsed=!me.isExpanded(groupName);if(me.collapsible){if(e.ctrlKey){Ext.suspendLayouts();for(g in groupCache)g===groupName?groupIsCollapsed&&me.expand(groupName):me.doCollapseExpand(!0,g,!1);return void Ext.resumeLayouts(!0)}groupIsCollapsed?me.expand(groupName):me.collapse(groupName)}},setupRowData:function(record,idx,rowValues){var grouper,groupName,prev,next,me=this,data=me.refreshData,groupInfo=me.groupInfo,header=data.header,groupField=data.groupField,dataSource=me.view.dataSource;if(rowValues.isCollapsedGroup=!1,rowValues.summaryRecord=null,data.doGrouping){if(grouper=me.view.store.groupers.first(),record.children)return groupName=grouper.getGroupString(record.children[0]),rowValues.isFirstRow=rowValues.isLastRow=!0,rowValues.itemClasses.push(me.hdCollapsedCls),rowValues.isCollapsedGroup=rowValues.needsWrap=!0,rowValues.groupInfo=groupInfo,groupInfo.groupField=groupField,groupInfo.name=groupName,groupInfo.groupValue=record.children[0].get(groupField),groupInfo.columnName=header?header.text:groupField,rowValues.collapsibleCls=me.collapsible?me.collapsibleCls:me.hdNotCollapsibleCls,rowValues.groupId=me.createGroupId(groupName),groupInfo.rows=groupInfo.children=record.children,void(me.showSummaryRow&&(rowValues.summaryRecord=data.summaryData[groupName]));groupName=grouper.getGroupString(record),record.group?(rowValues.isFirstRow=record===record.group.children[0],rowValues.isLastRow=record===record.group.children[record.group.children.length-1]):(rowValues.isFirstRow=0===idx,rowValues.isFirstRow||(prev=dataSource.getAt(idx-1),prev&&(rowValues.isFirstRow=!prev.isEqual(grouper.getGroupString(prev),groupName))),rowValues.isLastRow=idx==dataSource.getTotalCount()-1,rowValues.isLastRow||(next=dataSource.getAt(idx+1),next&&(rowValues.isLastRow=!next.isEqual(grouper.getGroupString(next),groupName)))),rowValues.isFirstRow&&(groupInfo.groupField=groupField,
groupInfo.name=groupName,groupInfo.groupValue=record.get(groupField),groupInfo.columnName=header?header.text:groupField,rowValues.collapsibleCls=me.collapsible?me.collapsibleCls:me.hdNotCollapsibleCls,rowValues.groupId=me.createGroupId(groupName),me.isExpanded(groupName)||(rowValues.itemClasses.push(me.hdCollapsedCls),rowValues.isCollapsedGroup=!0),dataSource.buffered?groupInfo.rows=groupInfo.children=[]:groupInfo.rows=groupInfo.children=me.getRecordGroup(record).children,rowValues.groupInfo=groupInfo),rowValues.isLastRow&&me.showSummaryRow&&(rowValues.summaryRecord=data.summaryData[groupName]),rowValues.needsWrap=rowValues.isFirstRow||rowValues.summaryRecord}},setup:function(rows,rowValues){var me=this,data=me.refreshData,isGrouping=!me.disabled&&me.view.store.isGrouped();me.skippedRows=0,rowValues.view.bufferedRenderer&&(rowValues.view.bufferedRenderer.variableRowHeight=!0),data.groupField=me.getGroupField(),data.header=me.getGroupedHeader(data.groupField),data.doGrouping=isGrouping,rowValues.groupHeaderTpl=Ext.XTemplate.getTpl(me,"groupHeaderTpl"),isGrouping&&me.showSummaryRow&&(data.summaryData=me.generateSummaryData())},cleanup:function(rows,rowValues){var data=this.refreshData;rowValues.groupInfo=rowValues.groupHeaderTpl=rowValues.isFirstRow=null,data.groupField=data.header=null},getGroupName:function(element){var parts,targetEl,row,me=this,view=me.view,eventSelector=me.eventSelector;if(targetEl=Ext.fly(element).findParent(eventSelector),targetEl||(row=Ext.fly(element).findParent(view.itemSelector),row&&(targetEl=row.down(eventSelector,!0))),targetEl&&(parts=targetEl.id.split(view.id+"-hd-"),2===parts.length))return Ext.htmlDecode(parts[1])},getRecordGroup:function(record){var grouper=this.view.store.groupers.first();if(grouper)return this.groupCache[grouper.getGroupString(record)]},createGroupId:function(group){return this.view.id+"-hd-"+Ext.htmlEncode(group)},createGroupCls:function(group){return this.view.id+"-"+Ext.htmlEncode(group)+"-item"},getGroupField:function(){return this.view.store.getGroupField()},getGroupedHeader:function(groupField){var selector,header,me=this,headerCt=me.view.headerCt,partner=me.lockingPartner;return groupField=groupField||this.getGroupField(),groupField&&(selector="[dataIndex="+groupField+"]",header=headerCt.down(selector),!header&&partner&&(header=partner.view.headerCt.down(selector))),header||null},getFireEventArgs:function(type,view,targetEl,e){return[type,view,targetEl,this.getGroupName(targetEl),e]},destroy:function(){var me=this,dataSource=me.dataSource;me.view=me.prunedHeader=me.grid=me.groupCache=me.dataSource=null,me.callParent(),dataSource&&dataSource.bindStore(null)},onReconfigure:function(grid,store,columns,oldStore,oldColumns){var me=grid;store&&store!==oldStore&&(store.buffered!==oldStore.buffered&&Ext.Error.raise("Cannot reconfigure grouping switching between buffered and non-buffered stores"),store.buffered&&(me.bindStore(store),me.dataSource.processStore(store)))}}),Ext.define("Ext.grid.feature.GroupingSummary",{extend:Ext.grid.feature.Grouping,alias:"feature.groupingsummary",showSummaryRow:!0,vetoEvent:function(record,row,rowIndex,e){var result=this.callParent(arguments);return result!==!1&&e.getTarget(this.summaryRowSelector)&&(result=!1),result}}),Ext.define("Ext.grid.feature.RowBody",{extend:Ext.grid.feature.Feature,alias:"feature.rowbody",rowBodyCls:Ext.baseCSSPrefix+"grid-row-body",rowBodyHiddenCls:Ext.baseCSSPrefix+"grid-row-body-hidden",rowBodyTdSelector:"td."+Ext.baseCSSPrefix+"grid-cell-rowbody",eventPrefix:"rowbody",eventSelector:"tr."+Ext.baseCSSPrefix+"grid-rowbody-tr",colSpanDecrement:0,tableTpl:{before:function(values,out){var view=values.view,rowValues=view.rowValues;this.rowBody.setup(values.rows,rowValues)},after:function(values,out){var view=values.view,rowValues=view.rowValues;this.rowBody.cleanup(values.rows,rowValues)},priority:100},extraRowTpl:["{%","values.view.rowBodyFeature.setupRowData(values.record, values.recordIndex, values);","this.nextTpl.applyOut(values, out, parent);","%}",'<tr class="',Ext.baseCSSPrefix,'grid-rowbody-tr {rowBodyCls}" {ariaRowAttr}>','<td class="',Ext.baseCSSPrefix,"grid-cell-rowbody",'" colspan="{rowBodyColspan}" {ariaCellAttr}>','<div class="',Ext.baseCSSPrefix,"grid-rowbody",' {rowBodyDivCls}" {ariaCellInnerAttr}>{rowBody}</div>',"</td>","</tr>",{priority:100,syncRowHeights:function(firstRow,secondRow){var secondRowBody,firstHeight,secondHeight,owner=this.owner,firstRowBody=Ext.fly(firstRow).down(owner.eventSelector,!0);firstRowBody&&(secondRowBody=Ext.fly(secondRow).down(owner.eventSelector,!0))&&((firstHeight=firstRowBody.offsetHeight)>(secondHeight=secondRowBody.offsetHeight)?Ext.fly(secondRowBody).setHeight(firstHeight):secondHeight>firstHeight&&Ext.fly(firstRowBody).setHeight(secondHeight))},syncContent:function(destRow,sourceRow){var sourceRowBody,owner=this.owner,destRowBody=Ext.fly(destRow).down(owner.eventSelector,!0);destRowBody&&(sourceRowBody=Ext.fly(sourceRow).down(owner.eventSelector,!0))&&Ext.fly(destRowBody).syncContent(sourceRowBody)}}],init:function(grid){var me=this,view=me.view;view.rowBodyFeature=me,view.findFeature("rowwrap")||(grid.mon(view,{element:"el",mousedown:me.onMouseDown,scope:me}),me.mon(grid.getStore(),"remove",me.onStoreRemove,me)),view.headerCt.on({columnschanged:me.onColumnsChanged,scope:me}),view.addTableTpl(me.tableTpl).rowBody=me,view.addRowTpl(Ext.XTemplate.getTpl(this,"extraRowTpl")),me.callParent(arguments)},onStoreRemove:function(store,model,index){var node,view=this.view;view.rendered&&(node=view.getNode(index),node&&(node=Ext.fly(node).next(this.eventSelector),node&&node.remove()))},onMouseDown:function(e){var me=this,tableRow=e.getTarget(me.eventSelector);tableRow&&Ext.fly(tableRow=tableRow.previousSibling).is(me.view.getItemSelector())&&(e.target=tableRow,me.view.handleEvent(e))},getSelectedRow:function(view,rowIndex){var selectedRow=view.getNode(rowIndex,!1);return selectedRow?Ext.fly(selectedRow).down(this.eventSelector):null},onColumnsChanged:function(headerCt){var i,items=this.view.el.query(this.rowBodyTdSelector),colspan=headerCt.getVisibleGridColumns().length,len=items.length;for(i=0;i<len;++i)items[i].colSpan=colspan},setupRowData:function(record,rowIndex,rowValues){this.getAdditionalData&&Ext.apply(rowValues,this.getAdditionalData(record.data,rowIndex,record,rowValues))},setup:function(rows,rowValues){rowValues.rowBodyCls=this.rowBodyCls,rowValues.rowBodyColspan=rowValues.view.getGridColumns().length-this.colSpanDecrement},cleanup:function(rows,rowValues){rowValues.rowBodyCls=rowValues.rowBodyColspan=rowValues.rowBody=null}}),Ext.define("Ext.grid.feature.RowWrap",{extend:Ext.grid.feature.Feature,alias:"feature.rowwrap",rowWrapTd:"td."+Ext.baseCSSPrefix+"grid-rowwrap",hasFeatureEvent:!1,tableTpl:{before:function(values,out){values.view.bufferedRenderer&&(values.view.bufferedRenderer.variableRowHeight=!0)},priority:200},wrapTpl:['<tr data-boundView="{view.id}" data-recordId="{record.internalId}" data-recordIndex="{recordIndex}" class="{[values.itemClasses.join(" ")]} ',Ext.baseCSSPrefix,'grid-wrap-row" {ariaRowAttr}>','<td class="',Ext.baseCSSPrefix,"grid-rowwrap ",Ext.baseCSSPrefix,'grid-td" colSpan="{columns.length}" {ariaCellAttr}>','<table class="',Ext.baseCSSPrefix,"{view.id}-table ",Ext.baseCSSPrefix,'grid-table" border="0" cellspacing="0" cellpadding="0" style="width:100%" {ariaCellInnerTableAttr}>',"{[values.view.renderColumnSizer(out)]}","{%","values.itemClasses.length = 0;","this.nextTpl.applyOut(values, out, parent)","%}","</table>","</td>","</tr>",{priority:200}],init:function(grid){var me=this;me.view.addTableTpl(me.tableTpl),me.view.addRowTpl(Ext.XTemplate.getTpl(me,"wrapTpl")),me.view.headerCt.on({columnhide:me.onColumnHideShow,columnshow:me.onColumnHideShow,scope:me})},onColumnHideShow:function(){var i,view=this.view,items=view.el.query(this.rowWrapTd),colspan=view.headerCt.getVisibleGridColumns().length,len=items.length;for(i=0;i<len;++i)items[i].colSpan=colspan}}),Ext.define("Ext.grid.feature.Summary",{extend:Ext.grid.feature.AbstractSummary,alias:"feature.summary",dock:void 0,dockedSummaryCls:Ext.baseCSSPrefix+"docked-summary",panelBodyCls:Ext.baseCSSPrefix+"summary-",scrollPadProperty:"padding-right",init:function(grid){var me=this,view=me.view;me.callParent(arguments),me.dock?(grid.headerCt.on({afterlayout:me.onStoreUpdate,scope:me}),grid.on({beforerender:function(){var tableCls=[me.summaryTableCls];view.columnLines&&(tableCls[tableCls.length]=view.ownerCt.colLinesCls),me.summaryBar=grid.addDocked({childEls:["innerCt"],renderTpl:['<div id="{id}-innerCt" role="presentation">','<table cellPadding="0" cellSpacing="0" class="'+tableCls.join(" ")+'">','<tr class="'+me.summaryRowCls+'"></tr>',"</table>","</div>"],style:"overflow:hidden",itemId:"summaryBar",cls:[me.dockedSummaryCls,me.dockedSummaryCls+"-"+me.dock],xtype:"component",dock:me.dock,weight:1e7})[0]},afterrender:function(){grid.body.addCls(me.panelBodyCls+me.dock),view.mon(view.el,{scroll:me.onViewScroll,scope:me}),me.onStoreUpdate()},single:!0}),grid.headerCt.afterComponentLayout=Ext.Function.createSequence(grid.headerCt.afterComponentLayout,function(){var scrollWidth,width=this.getFullWidth(),innerCt=me.summaryBar.innerCt;view.hasVerticalScroll()&&(scrollWidth=Ext.getScrollbarSize().width,width-=scrollWidth,innerCt.down("table").setStyle(me.scrollPadProperty,scrollWidth+"px")),innerCt.setWidth(width)})):me.view.addFooterFn(me.renderTFoot),grid.on({columnmove:me.onStoreUpdate,scope:me}),view.mon(view.store,{update:me.onStoreUpdate,datachanged:me.onStoreUpdate,scope:me})},renderTFoot:function(values,out){var view=values.view,me=view.findFeature("summary");me.showSummaryRow&&(out.push("<tfoot>"),me.outputSummaryRecord(me.createSummaryRecord(view),values,out),out.push("</tfoot>"))},toggleSummaryRow:function(visible){var me=this,bar=me.summaryBar;me.callParent(arguments),bar&&(bar.setVisible(me.showSummaryRow),me.onViewScroll())},vetoEvent:function(record,row,rowIndex,e){return!e.getTarget(this.summaryRowSelector)},onViewScroll:function(){this.summaryBar.el.dom.scrollLeft=this.view.el.dom.scrollLeft},createSummaryRecord:function(view){var i,column,columns=view.headerCt.getVisibleGridColumns(),info={records:view.store.getRange()},colCount=columns.length,summaryRecord=this.summaryRecord||(this.summaryRecord=new view.store.model(null,view.id+"-summary-record"));for(summaryRecord.beginEdit(),i=0;i<colCount;i++)column=columns[i],column.dataIndex||(column.dataIndex=column.id),summaryRecord.set(column.dataIndex,this.getSummary(view.store,column.summaryType,column.dataIndex,info));return summaryRecord.endEdit(!0),summaryRecord.commit(!0),summaryRecord.isSummary=!0,summaryRecord},onStoreUpdate:function(){var oldRowDom,partner,p,me=this,view=me.view,record=me.createSummaryRecord(view),newRowDom=view.createRowElement(record,-1);view.rendered&&(oldRowDom=me.dock?me.summaryBar.el.down("."+me.summaryRowCls,!0):me.view.getNode(record),oldRowDom&&(p=oldRowDom.parentNode,p.insertBefore(newRowDom,oldRowDom),p.removeChild(oldRowDom),partner=me.lockingPartner,partner&&partner.grid.rendered&&!me.calledFromLockingPartner&&(partner.calledFromLockingPartner=!0,partner.onStoreUpdate(),partner.calledFromLockingPartner=!1)),me.dock&&me.onColumnHeaderLayout())},onColumnHeaderLayout:function(){var column,i,el,view=this.view,columns=view.headerCt.getVisibleGridColumns(),len=columns.length,summaryEl=this.summaryBar.el;for(i=0;i<len;i++)column=columns[i],el=summaryEl.down(view.getCellSelector(column)),el&&(column.hidden?el.setDisplayed(!1):(el.setDisplayed(!0),el.setWidth(column.width||(column.lastBox?column.lastBox.width:100))))}}),Ext.define("Ext.grid.locking.HeaderContainer",{extend:Ext.grid.header.Container,constructor:function(lockable){var events,event,me=this,eventNames=[],lockedGrid=lockable.lockedGrid,normalGrid=lockable.normalGrid;me.lockable=lockable,me.callParent(),lockedGrid.visibleColumnManager.rootColumns=normalGrid.visibleColumnManager.rootColumns=lockable.visibleColumnManager=me.visibleColumnManager=new Ext.grid.ColumnManager((!0),lockedGrid.headerCt,normalGrid.headerCt),lockedGrid.columnManager.rootColumns=normalGrid.columnManager.rootColumns=lockable.columnManager=me.columnManager=new Ext.grid.ColumnManager((!1),lockedGrid.headerCt,normalGrid.headerCt),events=lockedGrid.headerCt.events;for(event in events)events.hasOwnProperty(event)&&eventNames.push(event);me.relayEvents(lockedGrid.headerCt,eventNames),me.relayEvents(normalGrid.headerCt,eventNames)},getRefItems:function(){return this.lockable.lockedGrid.headerCt.getRefItems().concat(this.lockable.normalGrid.headerCt.getRefItems())},getGridColumns:function(){return this.lockable.lockedGrid.headerCt.getGridColumns().concat(this.lockable.normalGrid.headerCt.getGridColumns())},getColumnsState:function(){var me=this,locked=me.lockable.lockedGrid.headerCt.getColumnsState(),normal=me.lockable.normalGrid.headerCt.getColumnsState();return locked.concat(normal)},applyColumnsState:function(columns){var i,existing,lockedDefault,col,me=this,lockedGrid=me.lockable.lockedGrid,lockedHeaderCt=lockedGrid.headerCt,normalHeaderCt=me.lockable.normalGrid.headerCt,lockedCols=Ext.Array.toValueMap(lockedHeaderCt.items.items,"headerId"),normalCols=Ext.Array.toValueMap(normalHeaderCt.items.items,"headerId"),locked=[],normal=[],lockedWidth=1,length=columns.length;for(i=0;i<length;i++)col=columns[i],lockedDefault=lockedCols[col.id],existing=lockedDefault||normalCols[col.id],existing&&(existing.applyColumnState&&existing.applyColumnState(col),void 0===existing.locked&&(existing.locked=!!lockedDefault),existing.locked?(locked.push(existing),existing.hidden||"number"!=typeof existing.width||(lockedWidth+=existing.width)):normal.push(existing));locked.length+normal.length==lockedHeaderCt.items.getCount()+normalHeaderCt.items.getCount()&&(lockedHeaderCt.removeAll(!1),normalHeaderCt.removeAll(!1),lockedHeaderCt.add(locked),normalHeaderCt.add(normal),lockedGrid.setWidth(lockedWidth))}}),Ext.define("Ext.grid.locking.View",{alternateClassName:"Ext.grid.LockingView",mixins:{observable:Ext.util.Observable},isLockingView:!0,eventRelayRe:/^(beforeitem|beforecontainer|item|container|cell|refresh)/,constructor:function(config){var events,event,me=this,eventNames=[],eventRe=me.eventRelayRe,locked=config.locked.getView(),normal=config.normal.getView();Ext.apply(me,{lockedView:locked,normalView:normal,lockedGrid:config.locked,normalGrid:config.normal,panel:config.panel}),me.mixins.observable.constructor.call(me,config),events=locked.events;for(event in events)events.hasOwnProperty(event)&&eventRe.test(event)&&eventNames.push(event);me.relayEvents(locked,eventNames),me.relayEvents(normal,eventNames),normal.on({scope:me,itemmouseleave:me.onItemMouseLeave,itemmouseenter:me.onItemMouseEnter}),locked.on({scope:me,itemmouseleave:me.onItemMouseLeave,itemmouseenter:me.onItemMouseEnter}),me.panel.on({render:me.onPanelRender,scope:me})},onPanelRender:function(){var me=this,mask=me.loadMask,cfg={target:me.panel,msg:me.loadingText,msgCls:me.loadingCls,useMsg:me.loadingUseMsg,store:me.panel.store};me.el=me.panel.body,me.fireEvent("render",me),mask&&(Ext.isObject(mask)&&(cfg=Ext.apply(cfg,mask)),me.loadMask=new Ext.LoadMask(cfg))},getGridColumns:function(){var cols=this.lockedGrid.headerCt.getVisibleGridColumns();return cols.concat(this.normalGrid.headerCt.getVisibleGridColumns())},getEl:function(column){return this.getViewForColumn(column).getEl()},getViewForColumn:function(column){var inLocked,view=this.lockedView;return view.headerCt.cascade(function(col){if(col===column)return inLocked=!0,!1}),inLocked?view:this.normalView},onItemMouseEnter:function(view,record){var item,me=this,locked=me.lockedView,other=me.normalView;view.trackOver&&(view!==locked&&(other=locked),item=other.getNode(record,!1),other.highlightItem(item))},onItemMouseLeave:function(view,record){var me=this,locked=me.lockedView,other=me.normalView;view.trackOver&&(view!==locked&&(other=locked),other.clearHighlight())},relayFn:function(name,args){args=args||[];var view=this.lockedView;view[name].apply(view,args),view=this.normalView,view[name].apply(view,args)},getSelectionModel:function(){return this.panel.getSelectionModel()},getStore:function(){return this.panel.store},getNode:function(nodeInfo,dataRow){return this.normalView.getNode(nodeInfo,dataRow)},getCell:function(record,column){var view=this.getViewForColumn(column),row=view.getNode(record,!0);return Ext.fly(row).down(column.getCellSelector())},indexOf:function(record){var result=this.lockedView.indexOf(record);return result||(result=this.normalView.indexOf(record)),result},focus:function(){var p=this.getSelectionModel().getCurrentPosition(),v=p?p.view:this.normalView;v.focus()},focusRow:function(row){this.normalView.focusRow(row)},focusCell:function(position){position.view.focusCell(position)},isVisible:function(deep){return this.panel.isVisible(deep)},getCellByPosition:function(pos,returnDom){var col=pos.column,lockedSize=this.lockedGrid.getColumnManager().getColumns().length;return col>=lockedSize?(pos=Ext.apply({},pos),pos.column-=lockedSize,this.normalView.getCellByPosition(pos,returnDom)):this.lockedView.getCellByPosition(pos,returnDom)},getRecord:function(node){var result=this.lockedView.getRecord(node);return result||(result=this.normalView.getRecord(node)),result},scrollBy:function(){var normal=this.normalView;normal.scrollBy.apply(normal,arguments)},addElListener:function(eventName,fn,scope){this.relayFn("addElListener",arguments)},refreshNode:function(){this.relayFn("refreshNode",arguments)},refresh:function(){this.relayFn("refresh",arguments)},bindStore:function(){this.relayFn("bindStore",arguments)},addRowCls:function(){this.relayFn("addRowCls",arguments)},removeRowCls:function(){this.relayFn("removeRowCls",arguments)},destroy:function(){var me=this,mask=me.loadMask;me.clearListeners(),mask&&mask.bindStore&&mask.bindStore(null)}}),Ext.define("Ext.grid.locking.Lockable",{alternateClassName:"Ext.grid.Lockable",syncRowHeight:!0,headerCounter:0,scrollDelta:40,lockedGridCls:Ext.baseCSSPrefix+"grid-inner-locked",unlockText:"Unlock",lockText:"Lock",bothCfgCopy:["invalidateScrollerOnRefresh","hideHeaders","enableColumnHide","enableColumnMove","enableColumnResize","sortableColumns","columnLines","rowLines"],normalCfgCopy:["verticalScroller","verticalScrollDock","verticalScrollerType","scroll"],lockedCfgCopy:[],determineXTypeToCreate:function(lockedSide){var typeToCreate,xtypes,xtypesLn,xtype,superxtype,me=this;if(me.subGridXType)typeToCreate=me.subGridXType;else{if(!lockedSide)return"gridpanel";xtypes=this.getXTypes().split("/"),xtypesLn=xtypes.length,xtype=xtypes[xtypesLn-1],superxtype=xtypes[xtypesLn-2],typeToCreate="tablepanel"!==superxtype?superxtype:xtype}return typeToCreate},injectLockable:function(){this.lockable=!0,this.hasView=!0;var allFeatures,allPlugins,lockedGrid,normalGrid,i,columns,lockedHeaderCt,normalHeaderCt,lockedView,normalView,listeners,me=this,scrollbarHeight=Ext.getScrollbarSize().height,store=me.store=Ext.StoreManager.lookup(me.store),selModel=me.getSelectionModel(),loadMask=me.viewConfig&&me.viewConfig.loadMask,bufferedRenderer=me.findPlugin("bufferedrenderer");for(allFeatures=me.constructLockableFeatures(),me.features&&(me.features=null),allPlugins=me.constructLockablePlugins(),me.plugins=allPlugins.topPlugins,lockedGrid=Ext.apply({id:me.id+"-locked",isLocked:!0,ownerLockable:me,xtype:me.determineXTypeToCreate(!0),store:store,scrollerOwner:!1,animate:!1,scroll:!scrollbarHeight&&"vertical",selModel:selModel,border:!1,cls:me.lockedGridCls,isLayoutRoot:function(){return!1},features:allFeatures.lockedFeatures,plugins:allPlugins.lockedPlugins},me.lockedGridConfig),normalGrid=Ext.apply({id:me.id+"-normal",isLocked:!1,ownerLockable:me,xtype:me.determineXTypeToCreate(),store:store,scrollerOwner:!1,selModel:selModel,border:!1,isLayoutRoot:function(){return!1},features:allFeatures.normalFeatures,plugins:allPlugins.normalPlugins},me.normalGridConfig),me.addCls(Ext.baseCSSPrefix+"grid-locked"),Ext.copyTo(normalGrid,me,me.bothCfgCopy,!0),Ext.copyTo(lockedGrid,me,me.bothCfgCopy,!0),Ext.copyTo(normalGrid,me,me.normalCfgCopy,!0),Ext.copyTo(lockedGrid,me,me.lockedCfgCopy,!0),i=0;i<me.normalCfgCopy.length;i++)delete me[me.normalCfgCopy[i]];for(i=0;i<me.lockedCfgCopy.length;i++)delete me[me.lockedCfgCopy[i]];me.addEvents("processcolumns","lockcolumn","unlockcolumn"),me.addStateEvents(["lockcolumn","unlockcolumn"]),columns=me.processColumns(me.columns),lockedGrid.width=columns.lockedWidth+Ext.num(selModel.headerWidth,0)+(columns.locked.items.length?1:0),lockedGrid.columns=columns.locked,normalGrid.columns=columns.normal,normalGrid.flex=1,lockedGrid.viewConfig=me.lockedViewConfig||{},lockedGrid.viewConfig.loadingUseMsg=!1,lockedGrid.viewConfig.loadMask=!1,scrollbarHeight&&(lockedGrid.viewConfig.style="border-bottom:"+scrollbarHeight+"px solid #f6f6f6;"+(lockedGrid.viewConfig.style||"")),normalGrid.viewConfig=me.normalViewConfig||{},normalGrid.viewConfig.loadMask=!1,Ext.applyIf(lockedGrid.viewConfig,me.viewConfig),Ext.applyIf(normalGrid.viewConfig,me.viewConfig),me.lockedGrid=Ext.ComponentManager.create(lockedGrid),me.isTree&&(me.lockedGrid.getView().animate=!1,normalGrid.store=me.lockedGrid.view.store,normalGrid.deferRowRender=!1,normalGrid.viewConfig.stripeRows=me.lockedGrid.view.stripeRows,normalGrid.rowLines=me.lockedGrid.rowLines),lockedView=me.lockedGrid.getView(),normalGrid.viewConfig.lockingPartner=lockedView,me.normalGrid=Ext.ComponentManager.create(normalGrid),lockedView.lockingPartner=normalView=me.normalGrid.getView(),me.view=new Ext.grid.locking.View({loadingText:normalView.loadingText,loadingCls:normalView.loadingCls,loadingUseMsg:normalView.loadingUseMsg,loadMask:void 0===loadMask?me.loadMask:loadMask,locked:me.lockedGrid,normal:me.normalGrid,panel:me}),listeners=bufferedRenderer?{}:{scroll:{fn:me.onLockedViewScroll,element:"el",scope:me}},scrollbarHeight&&(me.lockedGrid.on({afterlayout:me.afterLockedViewLayout,scope:me}),lockedView.getOverflowStyle(),lockedView.scrollFlags.y?me.lockedGrid.headerCt.forceFit=!0:listeners.mousewheel={fn:me.onLockedViewMouseWheel,element:"el",scope:me}),lockedView.on(listeners),listeners=bufferedRenderer?{}:{scroll:{fn:me.onNormalViewScroll,element:"el",scope:me},scope:me},normalView.on(listeners),lockedHeaderCt=me.lockedGrid.headerCt,normalHeaderCt=me.normalGrid.headerCt,me.headerCt=me.view.headerCt=new Ext.grid.locking.HeaderContainer(me),lockedHeaderCt.lockedCt=!0,lockedHeaderCt.lockableInjected=!0,normalHeaderCt.lockableInjected=!0,lockedHeaderCt.on({add:{buffer:1,scope:me,fn:me.onLockedHeaderAdd},columnshow:me.onLockedHeaderShow,columnhide:me.onLockedHeaderHide,sortchange:me.onLockedHeaderSortChange,columnresize:me.onLockedHeaderResize,scope:me}),normalHeaderCt.on({sortchange:me.onNormalHeaderSortChange,scope:me}),me.modifyHeaderCt(),me.items=[me.lockedGrid,me.normalGrid],me.relayHeaderCtEvents(lockedHeaderCt),me.relayHeaderCtEvents(normalHeaderCt),me.storeRelayers=me.relayEvents(store,["filterchange","groupchange"]),me.layout={type:"hbox",align:"stretch"}},getLockingViewConfig:function(){return{xclass:"Ext.grid.locking.View",locked:this.lockedGrid,normal:this.normalGrid,panel:this}},processColumns:function(columns){var i,len,column,cp=new Ext.grid.header.Container,lockedHeaders=[],normalHeaders=[],lockedHeaderCt={itemId:"lockedHeaderCt",stretchMaxPartner:"^^>>#normalHeaderCt",items:lockedHeaders},normalHeaderCt={itemId:"normalHeaderCt",stretchMaxPartner:"^^>>#lockedHeaderCt",items:normalHeaders},result={lockedWidth:0,locked:lockedHeaderCt,normal:normalHeaderCt};for(Ext.isObject(columns)&&(Ext.applyIf(lockedHeaderCt,columns),Ext.applyIf(normalHeaderCt,columns),Ext.apply(cp,columns),columns=columns.items),i=0,len=columns.length;i<len;++i)column=columns[i],column.isComponent||(column=cp.lookupComponent(cp.applyDefaults(column))),column.processed=!0,column.locked||column.autoLock?(column.hidden||(result.lockedWidth+=this.getColumnWidth(column)||cp.defaultWidth),lockedHeaders.push(column)):normalHeaders.push(column),column.headerId||(column.headerId=(column.initialConfig||column).id||"h"+ ++this.headerCounter);return this.fireEvent("processcolumns",this,lockedHeaders,normalHeaders),cp.destroy(),result},getColumnWidth:function(column){var subcols,len,i,result=column.width||0;if(!result&&column.isGroupHeader)for(subcols=column.items.items,len=subcols.length,i=0;i<len;i++)result+=this.getColumnWidth(subcols[i]);return result},afterLockedViewLayout:function(){var me=this,lockedView=me.lockedGrid.getView(),lockedViewEl=lockedView.el.dom,spacerHeight=me.normalGrid.headerCt.tooNarrow?Ext.getScrollbarSize().height:0;lockedView.scrollFlags.x&&lockedViewEl.scrollWidth>lockedViewEl.clientWidth&&(spacerHeight=0),lockedView.el.dom.style.borderBottomWidth=spacerHeight+"px",Ext.isBorderBox||lockedView.el.setHeight(lockedView.lastBox.height)},onLockedViewMouseWheel:function(e){var verticalCanScrollDown,verticalCanScrollUp,me=this,scrollDelta=-me.scrollDelta,deltaY=scrollDelta*e.getWheelDeltas().y,vertScrollerEl=me.lockedGrid.getView().el.dom;me.ignoreMousewheel||(vertScrollerEl&&(verticalCanScrollDown=vertScrollerEl.scrollTop!==vertScrollerEl.scrollHeight-vertScrollerEl.clientHeight,verticalCanScrollUp=0!==vertScrollerEl.scrollTop),(deltaY<0&&verticalCanScrollUp||deltaY>0&&verticalCanScrollDown)&&(e.stopEvent(),vertScrollerEl.scrollTop+=deltaY,me.normalGrid.getView().el.dom.scrollTop=vertScrollerEl.scrollTop,me.onNormalViewScroll()))},onLockedViewScroll:function(){var normalTable,lockedTable,me=this,lockedView=me.lockedGrid.getView(),normalView=me.normalGrid.getView(),normalDom=normalView.el.dom,lockedDom=lockedView.el.dom;normalDom.scrollTop!==lockedDom.scrollTop&&(normalDom.scrollTop=lockedDom.scrollTop,me.store.buffered&&(lockedTable=lockedView.el.child("table",!0),normalTable=normalView.el.child("table",!0),normalTable.style.position="absolute",normalTable.style.top=lockedTable.style.top))},onNormalViewScroll:function(){var normalTable,lockedTable,me=this,lockedView=me.lockedGrid.getView(),normalView=me.normalGrid.getView(),normalDom=normalView.el.dom,lockedDom=lockedView.el.dom;normalDom.scrollTop!==lockedDom.scrollTop&&(lockedDom.scrollTop=normalDom.scrollTop,me.store.buffered&&(lockedTable=lockedView.el.child("table",!0),normalTable=normalView.el.child("table",!0),lockedTable.style.position="absolute",lockedTable.style.top=normalTable.style.top))},syncRowHeights:function(){var i,scrollTop,me=this,lockedView=me.lockedGrid.getView(),normalView=me.normalGrid.getView(),lockedRowEls=lockedView.all.slice(),normalRowEls=normalView.all.slice(),ln=lockedRowEls.length;if(normalRowEls.length===ln){for(i=0;i<ln;i++)normalView.syncRowHeights(lockedRowEls[i],normalRowEls[i]);scrollTop=normalView.el.dom.scrollTop,normalView.el.dom.scrollTop=scrollTop,lockedView.el.dom.scrollTop=scrollTop}},modifyHeaderCt:function(){var me=this;me.lockedGrid.headerCt.getMenuItems=me.getMenuItems(me.lockedGrid.headerCt.getMenuItems,!0),me.normalGrid.headerCt.getMenuItems=me.getMenuItems(me.normalGrid.headerCt.getMenuItems,!1),me.lockedGrid.headerCt.showMenuBy=Ext.Function.createInterceptor(me.lockedGrid.headerCt.showMenuBy,me.showMenuBy),me.normalGrid.headerCt.showMenuBy=Ext.Function.createInterceptor(me.normalGrid.headerCt.showMenuBy,me.showMenuBy)},onUnlockMenuClick:function(){this.unlock()},onLockMenuClick:function(){this.lock()},showMenuBy:function(t,header){var menu=this.getMenu(),unlockItem=menu.down("#unlockItem"),lockItem=menu.down("#lockItem"),sep=unlockItem.prev();header.lockable===!1?(sep.hide(),unlockItem.hide(),lockItem.hide()):(sep.show(),unlockItem.show(),lockItem.show(),unlockItem.initialConfig.disabled||unlockItem.setDisabled(header.lockable===!1),lockItem.initialConfig.disabled||lockItem.setDisabled(!header.isLockable()))},getMenuItems:function(getMenuItems,locked){var me=this,unlockText=me.unlockText,lockText=me.lockText,unlockCls=Ext.baseCSSPrefix+"hmenu-unlock",lockCls=Ext.baseCSSPrefix+"hmenu-lock",unlockHandler=Ext.Function.bind(me.onUnlockMenuClick,me),lockHandler=Ext.Function.bind(me.onLockMenuClick,me);return function(){var o=getMenuItems.call(this);return o.push("-",{itemId:"unlockItem",iconCls:unlockCls,text:unlockText,handler:unlockHandler,disabled:!locked}),o.push({itemId:"lockItem",iconCls:lockCls,text:lockText,handler:lockHandler,disabled:locked}),o}},syncLockedWidth:function(){var me=this,locked=me.lockedGrid,lockedView=locked.view,lockedViewEl=lockedView.el.dom,normal=me.normalGrid,lockedColCount=locked.headerCt.getVisibleGridColumns().length,normalColCount=normal.headerCt.getVisibleGridColumns().length;return Ext.suspendLayouts(),normalColCount?(normal.show(),lockedColCount?(locked.headerCt.forceFit||(delete locked.flex,locked.setWidth(locked.headerCt.getFullWidth())),locked.addCls(me.lockedGridCls),locked.show()):(locked.getView().refresh(),locked.hide()),lockedView.el.setStyle(lockedView.getOverflowStyle()),me.ignoreMousewheel=lockedView.scrollFlags.y):(normal.hide(),lockedViewEl.style.borderBottomWidth="0",locked.flex=1,delete locked.width,locked.removeCls(me.lockedGridCls),locked.show(),lockedView.el.setStyle(normal.view.getOverflowStyle()),me.ignoreMousewheel=!0),Ext.resumeLayouts(!0),[lockedColCount,normalColCount]},onLockedHeaderAdd:function(){this.ignoreAddLockedColumn||this.syncLockedWidth()},onLockedHeaderResize:function(){this.syncLockedWidth()},onLockedHeaderHide:function(){this.syncLockedWidth()},onLockedHeaderShow:function(){this.syncLockedWidth()},onLockedHeaderSortChange:function(headerCt,header,sortState){sortState&&this.normalGrid.headerCt.clearOtherSortStates(null,!0)},onNormalHeaderSortChange:function(headerCt,header,sortState){sortState&&this.lockedGrid.headerCt.clearOtherSortStates(null,!0)},lock:function(activeHd,toIdx,toCt){var refreshFlags,ownerCt,me=this,normalGrid=me.normalGrid,lockedGrid=me.lockedGrid,normalHCt=normalGrid.headerCt;activeHd=activeHd||normalHCt.getMenu().activeHeader,toCt=toCt||lockedGrid.headerCt,ownerCt=activeHd.ownerCt,activeHd.isLockable()&&(activeHd.flex&&(activeHd.width=activeHd.getWidth(),activeHd.flex=null),Ext.suspendLayouts(),ownerCt.remove(activeHd,!1),activeHd.locked=!0,me.ignoreAddLockedColumn=!0,Ext.isDefined(toIdx)?toCt.insert(toIdx,activeHd):toCt.add(activeHd),me.ignoreAddLockedColumn=!1,refreshFlags=me.syncLockedWidth(),refreshFlags[0]&&lockedGrid.getView().refresh(),refreshFlags[1]&&normalGrid.getView().refresh(),Ext.resumeLayouts(!0),me.fireEvent("lockcolumn",me,activeHd))},unlock:function(activeHd,toIdx,toCt){var refreshFlags,me=this,normalGrid=me.normalGrid,lockedGrid=me.lockedGrid,lockedHCt=lockedGrid.headerCt;Ext.isDefined(toIdx)||(toIdx=0),activeHd=activeHd||lockedHCt.getMenu().activeHeader,toCt=toCt||normalGrid.headerCt,Ext.suspendLayouts(),activeHd.ownerCt.remove(activeHd,!1),activeHd.locked=!1,toCt.insert(toIdx,activeHd),refreshFlags=me.syncLockedWidth(),refreshFlags[0]&&lockedGrid.getView().refresh(),refreshFlags[1]&&normalGrid.getView().refresh(),Ext.resumeLayouts(!0),me.fireEvent("unlockcolumn",me,activeHd)},reconfigureLockable:function(store,columns){var me=this,oldStore=me.store,lockedGrid=me.lockedGrid,normalGrid=me.normalGrid;Ext.suspendLayouts(),columns&&(lockedGrid.headerCt.removeAll(),normalGrid.headerCt.removeAll(),columns=me.processColumns(columns),me.ignoreAddLockedColumn=!0,lockedGrid.headerCt.add(columns.locked.items),me.ignoreAddLockedColumn=!1,normalGrid.headerCt.add(columns.normal.items),me.syncLockedWidth()),store&&store!==oldStore?(store=Ext.data.StoreManager.lookup(store),me.store=store,lockedGrid.bindStore(store),normalGrid.bindStore(store)):(lockedGrid.getView().refresh(),normalGrid.getView().refresh()),Ext.resumeLayouts(!0)},constructLockableFeatures:function(){var feature,featureClone,lockedFeatures,normalFeatures,len,features=this.features,i=0;if(features)for(Ext.isArray(features)||(features=[features]),lockedFeatures=[],normalFeatures=[],len=features.length;i<len;i++)switch(feature=features[i],feature.isFeature||(feature=Ext.create("feature."+feature.ftype,feature)),
feature.lockableScope){case"locked":lockedFeatures.push(feature);break;case"normal":normalFeatures.push(feature);break;default:feature.lockableScope="both",lockedFeatures.push(feature),normalFeatures.push(featureClone=feature.clone()),featureClone.lockingPartner=feature,feature.lockingPartner=featureClone}return{normalFeatures:normalFeatures,lockedFeatures:lockedFeatures}},constructLockablePlugins:function(){var plugin,normalPlugin,lockedPlugin,topPlugins,lockedPlugins,normalPlugins,len,lockableScope,pluginCls,plugins=this.plugins,i=0;if(plugins)for(Ext.isArray(plugins)||(plugins=[plugins]),topPlugins=[],lockedPlugins=[],normalPlugins=[],len=plugins.length;i<len;i++)switch(plugin=plugins[i],plugin.init?lockableScope=plugin.lockableScope:(pluginCls=plugin.ptype?Ext.ClassManager.getByAlias("plugin."+plugin.ptype):Ext.ClassManager.get(plugin.xclass),lockableScope=pluginCls.prototype.lockableScope),lockableScope){case"both":lockedPlugins.push(lockedPlugin=plugin.clonePlugin()),normalPlugins.push(normalPlugin=plugin.clonePlugin()),lockedPlugin.lockingPartner=normalPlugin,normalPlugin.lockingPartner=lockedPlugin,Ext.destroy(plugin);break;case"locked":lockedPlugins.push(plugin);break;case"normal":normalPlugins.push(plugin);break;default:topPlugins.push(plugin)}return{topPlugins:topPlugins,normalPlugins:normalPlugins,lockedPlugins:lockedPlugins}},destroyLockable:function(){Ext.destroy(this.view,this.headerCt)}},function(){this.borrow(Ext.AbstractComponent,["constructPlugin"])}),Ext.define("Ext.tree.View",{extend:Ext.view.Table,alias:"widget.treeview",isTreeView:!0,loadingCls:Ext.baseCSSPrefix+"grid-tree-loading",expandedCls:Ext.baseCSSPrefix+"grid-tree-node-expanded",leafCls:Ext.baseCSSPrefix+"grid-tree-node-leaf",expanderSelector:"."+Ext.baseCSSPrefix+"tree-expander",checkboxSelector:"."+Ext.baseCSSPrefix+"tree-checkbox",expanderIconOverCls:Ext.baseCSSPrefix+"tree-expander-over",nodeAnimWrapCls:Ext.baseCSSPrefix+"tree-animator-wrap",ariaRole:"tree",blockRefresh:!0,loadMask:!1,rootVisible:!0,deferInitialRefresh:!1,expandDuration:250,collapseDuration:250,toggleOnDblClick:!0,stripeRows:!1,uiFields:["expanded","loaded","checked","expandable","leaf","icon","iconCls","loading","qtip","qtitle"],treeRowTpl:["{%","this.processRowValues(values);","this.nextTpl.applyOut(values, out, parent);","%}",{priority:10,processRowValues:function(rowValues){var record=rowValues.record,view=rowValues.view;rowValues.rowAttr={},rowValues.rowAttr["data-qtip"]=record.get("qtip")||"",rowValues.rowAttr["data-qtitle"]=record.get("qtitle")||"",record.isExpanded()&&rowValues.rowClasses.push(view.expandedCls),record.isLeaf()&&rowValues.rowClasses.push(view.leafCls),record.isLoading()&&rowValues.rowClasses.push(view.loadingCls)}}],initComponent:function(){var me=this,treeStore=me.panel.getStore(),store=me.store;void 0===me.initialConfig.animate&&(me.animate=Ext.enableFx),store&&store!==treeStore||(me.store=store=new Ext.data.NodeStore({treeStore:treeStore,recursive:!0,rootVisible:me.rootVisible})),me.node&&me.setRootNode(me.node),me.animQueue={},me.animWraps={},me.addEvents("afteritemexpand","afteritemcollapse","nodedragover"),me.callParent(arguments),me.addRowTpl(Ext.XTemplate.getTpl(me,"treeRowTpl"))},onBeforeFill:function(treeStore,fillRoot){this.store.suspendEvents()},onFillComplete:function(treeStore,fillRoot,newNodes){var me=this,store=me.store,start=store.indexOf(newNodes[0]);store.resumeEvents(),fillRoot.triggerUIUpdate(),newNodes.length&&start!==-1&&(me.onAdd(me.store,newNodes,start),me.refreshPartner())},onBeforeSort:function(){this.store.suspendEvents()},onSort:function(o){o.isStore&&(this.store.resumeEvents(),this.refresh(),this.refreshPartner())},refreshPartner:function(){var partner=this.lockingPartner;partner&&partner.refresh()},getMaskStore:function(){return this.panel.getStore()},afterRender:function(){var me=this;me.callParent(arguments),me.el.on({scope:me,delegate:me.expanderSelector,mouseover:me.onExpanderMouseOver,mouseout:me.onExpanderMouseOut,click:{delegate:me.checkboxSelector,fn:me.onCheckboxChange,scope:me}})},afterComponentLayout:function(){this.callParent(arguments);var stretcher=this.stretcher;stretcher&&stretcher.setWidth(this.getWidth()-Ext.getScrollbarSize().width)},processUIEvent:function(e){return!e.getTarget("."+this.nodeAnimWrapCls,this.el)&&this.callParent(arguments)},onClear:function(){this.store.removeAll()},setRootNode:function(node){var me=this;me.store.setNode(node),me.node=node},onCheckboxChange:function(e,t){var me=this,item=e.getTarget(me.getItemSelector(),me.getTargetEl());item&&me.onCheckChange(me.getRecord(item))},onCheckChange:function(record){var checked=record.get("checked");Ext.isBoolean(checked)&&(checked=!checked,record.set("checked",checked),this.fireEvent("checkchange",record,checked))},getChecked:function(){var checked=[];return this.node.cascadeBy(function(rec){rec.get("checked")&&checked.push(rec)}),checked},isItemChecked:function(rec){return rec.get("checked")},createAnimWrap:function(record,index){var tmpEl,nodeEl,me=this,node=me.getNode(record),columnSizer=[];return me.renderColumnSizer(columnSizer),nodeEl=Ext.get(node),tmpEl=nodeEl.insertSibling({role:"presentation",tag:"tr",html:['<td colspan="'+me.panel.headerCt.getColumnCount()+'" role="presentation">','<div class="'+me.nodeAnimWrapCls+'" role="presentation">','<table class="'+Ext.baseCSSPrefix+me.id+"-table "+Ext.baseCSSPrefix+'grid-table" style="border:0" cellspacing="0" cellpadding="0" role="presentation">',columnSizer.join(""),"<tbody></tbody></table>","</div>","</td>"].join("")},"after"),{record:record,node:node,el:tmpEl,expanding:!1,collapsing:!1,animating:!1,animateEl:tmpEl.down("div"),targetEl:tmpEl.down("tbody")}},getAnimWrap:function(parent,bubble){if(!this.animate)return null;var wraps=this.animWraps,wrap=wraps[parent.internalId];if(bubble!==!1)for(;!wrap&&parent;)parent=parent.parentNode,parent&&(wrap=wraps[parent.internalId]);return wrap},doAdd:function(records,index){var relativeIndex,targetEl,children,len,me=this,nodes=me.bufferRender(records,index,!0),record=records[0],parent=record.parentNode,all=me.all,animWrap=me.getAnimWrap(parent);return animWrap&&animWrap.expanding?(parent=animWrap.record,targetEl=animWrap.targetEl,children=targetEl.dom.childNodes,len=children.length,relativeIndex=index-me.indexInStore(parent)-1,!len||relativeIndex>=len?targetEl.appendChild(nodes):Ext.fly(children[relativeIndex]).insertSibling(nodes,"before",!0),all.insert(index,nodes),void(animWrap.isAnimating&&me.onExpand(parent))):me.callParent(arguments)},onRemove:function(ds,records,indexes){var empty,i,me=this;if(me.viewReady){if(empty=0===me.store.getCount())me.refresh();else for(i=indexes.length-1;i>=0;--i)me.doRemove(records[i],indexes[i]);if(me.hasListeners.itemremove)for(i=indexes.length-1;i>=0;--i)me.fireEvent("itemremove",records[i],indexes[i])}},doRemove:function(record,index){var me=this,all=me.all,animWrap=me.getAnimWrap(record),item=all.item(index),node=item?item.dom:null;return node&&animWrap&&animWrap.collapsing?(animWrap.targetEl.dom.insertBefore(node,animWrap.targetEl.dom.firstChild),void all.removeElement(index)):me.callParent(arguments)},onBeforeExpand:function(parent,records,index){var animWrap,me=this;me.rendered&&me.all.getCount()&&me.animate&&me.getNode(parent)&&(animWrap=me.getAnimWrap(parent,!1),animWrap?animWrap.collapsing&&animWrap.targetEl.select(me.itemSelector).remove():(animWrap=me.animWraps[parent.internalId]=me.createAnimWrap(parent),animWrap.animateEl.setHeight(0)),animWrap.expanding=!0,animWrap.collapsing=!1)},onExpand:function(parent){var animWrap,animateEl,targetEl,me=this,queue=me.animQueue,id=parent.getId(),node=me.getNode(parent),index=node?me.indexOf(node):-1,fromHeight=Ext.isIEQuirks?1:0;if(me.singleExpand&&me.ensureSingleExpand(parent),index!==-1){if(animWrap=me.getAnimWrap(parent,!1),!animWrap)return me.refreshSelection(),parent.isExpandingOrCollapsing=!1,me.fireEvent("afteritemexpand",parent,index,node),void me.refreshSize();animateEl=animWrap.animateEl,targetEl=animWrap.targetEl,animateEl.stopAnimation(),queue[id]=!0,animateEl.dom.style.height=fromHeight+"px",animateEl.animate({from:{height:fromHeight},to:{height:targetEl.getHeight()},duration:me.expandDuration,listeners:{afteranimate:function(){var items=targetEl.query(me.itemSelector);items.length&&animWrap.el.insertSibling(items,"before",!0),animWrap.el.remove(),me.refreshSize(),delete me.animWraps[animWrap.record.internalId],delete queue[id]}},callback:function(){me.refreshSelection(),parent.isExpandingOrCollapsing=!1,me.fireEvent("afteritemexpand",parent,index,node)}}),animWrap.isAnimating=!0}},onBeforeCollapse:function(parent,records,index,callback,scope){var animWrap,me=this;me.rendered&&me.all.getCount()&&(me.animate?Ext.Array.contains(parent.stores,me.store)&&(animWrap=me.getAnimWrap(parent),animWrap?animWrap.expanding&&animWrap.targetEl.select(this.itemSelector).remove():animWrap=me.animWraps[parent.internalId]=me.createAnimWrap(parent,index),animWrap.expanding=!1,animWrap.collapsing=!0,animWrap.callback=callback,animWrap.scope=scope):(me.onCollapseCallback=callback,me.onCollapseScope=scope),me.onRowDeselect(me.indexOf(parent.firstChild)))},onCollapse:function(parent){var animateEl,me=this,queue=me.animQueue,id=parent.getId(),node=me.getNode(parent),index=node?me.indexOf(node):-1,animWrap=me.getAnimWrap(parent);if(me.all.getCount()&&Ext.Array.contains(parent.stores,me.store)){if(!animWrap)return me.refreshSelection(),parent.isExpandingOrCollapsing=!1,me.fireEvent("afteritemcollapse",parent,index,node),me.refreshSize(),Ext.callback(me.onCollapseCallback,me.onCollapseScope),void(me.onCollapseCallback=me.onCollapseScope=null);animateEl=animWrap.animateEl,queue[id]=!0,animateEl.stopAnimation(),animateEl.animate({to:{height:Ext.isIEQuirks?1:0},duration:me.collapseDuration,listeners:{afteranimate:function(){animWrap.el.remove(),me.refreshSize(),delete me.animWraps[animWrap.record.internalId],delete queue[id]}},callback:function(){me.refreshSelection(),parent.isExpandingOrCollapsing=!1,me.fireEvent("afteritemcollapse",parent,index,node),Ext.callback(animWrap.callback,animWrap.scope),animWrap.callback=animWrap.scope=null}}),animWrap.isAnimating=!0}},isAnimating:function(node){return!!this.animQueue[node.getId()]},expand:function(record,deep,callback,scope){var result,me=this,doAnimate=!!me.animate;if(!doAnimate||!record.isExpandingOrCollapsing)return record.isLeaf()||(record.isExpandingOrCollapsing=doAnimate),Ext.suspendLayouts(),result=record.expand(deep,callback,scope),Ext.resumeLayouts(!0),result},collapse:function(record,deep,callback,scope){var me=this,doAnimate=!!me.animate;if(!doAnimate||!record.isExpandingOrCollapsing)return record.isLeaf()||(record.isExpandingOrCollapsing=doAnimate),record.collapse(deep,callback,scope)},toggle:function(record,deep,callback,scope){record.isExpanded()?this.collapse(record,deep,callback,scope):this.expand(record,deep,callback,scope)},onItemDblClick:function(record,item,index){var me=this,editingPlugin=me.editingPlugin;me.callParent(arguments),!me.toggleOnDblClick||!record.isExpandable()||editingPlugin&&2===editingPlugin.clicksToEdit||me.toggle(record)},onBeforeItemMouseDown:function(record,item,index,e){return!e.getTarget(this.expanderSelector,item)&&this.callParent(arguments)},onItemClick:function(record,item,index,e){return e.getTarget(this.expanderSelector,item)&&record.isExpandable()?(this.toggle(record,e.ctrlKey),!1):this.callParent(arguments)},onExpanderMouseOver:function(e,t){e.getTarget(this.cellSelector,10,!0).addCls(this.expanderIconOverCls)},onExpanderMouseOut:function(e,t){e.getTarget(this.cellSelector,10,!0).removeCls(this.expanderIconOverCls)},getStoreListeners:function(){var me=this,listeners=me.callParent(arguments);return Ext.apply(listeners,{beforeexpand:me.onBeforeExpand,expand:me.onExpand,beforecollapse:me.onBeforeCollapse,collapse:me.onCollapse,write:me.onStoreWrite,datachanged:me.onStoreDataChanged})},onBindStore:function(){var me=this,treeStore=me.getTreeStore();me.callParent(arguments),me.mon(treeStore,{scope:me,beforefill:me.onBeforeFill,fillcomplete:me.onFillComplete}),treeStore.remoteSort||me.mon(treeStore,{scope:me,beforesort:me.onBeforeSort,sort:me.onSort})},onUnbindStore:function(){var me=this,treeStore=me.getTreeStore();me.callParent(arguments),me.mun(treeStore,{scope:me,beforefill:me.onBeforeFill,fillcomplete:me.onFillComplete}),treeStore.remoteSort||me.mun(treeStore,{scope:me,beforesort:me.onBeforeSort,sort:me.onSort})},getTreeStore:function(){return this.panel.store},ensureSingleExpand:function(node){var parent=node.parentNode;parent&&parent.eachChild(function(child){child!==node&&child.isExpanded()&&child.collapse()})},shouldUpdateCell:function(record,column,changedFieldNames){if(changedFieldNames)for(var i=0,len=changedFieldNames.length;i<len;++i)if(Ext.Array.contains(this.uiFields,changedFieldNames[i]))return!0;return this.callParent(arguments)},onStoreWrite:function(store,operation){var treeStore=this.panel.store;treeStore.fireEvent("write",treeStore,operation)},onStoreDataChanged:function(store,operation){var treeStore=this.panel.store;treeStore.fireEvent("datachanged",treeStore)}}),Ext.define("Ext.grid.plugin.BufferedRendererTreeView",{override:"Ext.tree.View",onRemove:function(store,records,indices){var me=this;me.rendered&&me.bufferedRenderer?me.refreshView():me.callParent([store,records,indices])}}),Ext.define("Ext.grid.plugin.BufferedRenderer",{extend:Ext.AbstractPlugin,alias:"plugin.bufferedrenderer",lockableScope:"both",percentageFromEdge:.35,variableRowHeight:!1,numFromEdge:8,trailingBufferZone:10,leadingBufferZone:20,synchronousRender:!0,scrollToLoadBuffer:200,viewSize:0,rowHeight:21,position:0,lastScrollDirection:1,bodyTop:0,init:function(grid){var me=this,view=grid.view,viewListeners={scroll:{fn:me.onViewScroll,element:"el",scope:me},boxready:me.onViewResize,resize:me.onViewResize,refresh:me.onViewRefresh,scope:me,destroyable:!0};!me.variableRowHeight&&grid.ownerLockable&&(grid.ownerLockable.syncRowHeight=!1),(grid.isTree||grid.ownerLockable&&grid.ownerLockable.isTree)&&(view.blockRefresh=!1,view.loadMask=!0),view.positionBody&&(viewListeners.refresh=me.onViewRefresh),me.grid=grid,me.view=view,view.bufferedRenderer=me,view.preserveScrollOnRefresh=!0,me.bindStore(view.dataSource),view.getViewRange=function(){return me.getViewRange()},me.position=0,me.gridListeners=grid.on("reconfigure",me.onReconfigure,me),me.viewListeners=view.on(viewListeners)},bindStore:function(store){var me=this;me.store&&me.unbindStore(),me.storeListeners=store.on({scope:me,clear:me.onStoreClear,destroyable:!0}),me.store=store,me.view.componentLayout.layoutCount&&me.onViewResize(me.view,0,me.view.getHeight())},onReconfigure:function(grid,store){store&&store!==this.store&&this.bindStore(store)},unbindStore:function(){this.storeListeners.destroy(),this.store=null},onStoreClear:function(){var me=this;me.view.rendered&&!me.store.isDestroyed&&(0!==me.scrollTop&&(me.ignoreNextScrollEvent=!0,me.view.el.dom.scrollTop=0),me.bodyTop=me.scrollTop=me.position=me.scrollHeight=0,me.lastScrollDirection=me.scrollOffset=null,delete me.rowHeight)},onViewRefresh:function(){var scrollHeight,me=this,view=me.view,oldScrollHeight=me.scrollHeight;view.all.getCount()&&delete me.rowHeight,scrollHeight=me.getScrollHeight(),oldScrollHeight&&scrollHeight==oldScrollHeight||me.stretchView(view,scrollHeight),me.scrollTop!==view.el.dom.scrollTop?me.onViewScroll():(me.setBodyTop(me.bodyTop),view.all.getCount()&&(me.viewSize=0,me.onViewResize(view,null,view.getHeight())))},onViewResize:function(view,width,height,oldWidth,oldHeight){if(!oldHeight||height!==oldHeight){var newViewSize,me=this;newViewSize=Math.ceil(height/me.rowHeight)+me.trailingBufferZone+me.leadingBufferZone,me.viewSize=me.setViewSize(newViewSize)}},stretchView:function(view,scrollRange){var me=this,recordCount=me.store.buffered?me.store.getTotalCount():me.store.getCount();if(me.stretcher)me.stretcher.dom.style.marginTop=scrollRange-1+"px";else{var el=view.el;view.refreshCounter&&view.fixedNodes++,recordCount&&me.view.all.endIndex===recordCount-1&&(scrollRange=me.bodyTop+view.body.dom.offsetHeight),this.stretcher=el.createChild({style:{width:"1px",height:"1px",marginTop:scrollRange-1+"px",left:0,position:"absolute"}},el.dom.firstChild)}},setViewSize:function(viewSize){if(viewSize!==this.viewSize){this.scrollTop=this.view.el.dom.scrollTop;var start,end,me=this,store=me.store,elCount=me.view.all.getCount(),lockingPartner=me.lockingPartner;me.viewSize=store.viewSize=viewSize,elCount&&(start=me.view.all.startIndex,end=Math.min(start+viewSize-1,(store.buffered?store.getTotalCount():store.getCount())-1),lockingPartner&&lockingPartner.disable(),me.renderRange(start,end),lockingPartner&&lockingPartner.enable())}return viewSize},getViewRange:function(){var me=this,rows=me.view.all,store=me.store;return store.data.getCount()?store.getRange(rows.startIndex,rows.startIndex+(me.viewSize||store.defaultViewSize)-1):[]},scrollTo:function(recordIdx,doSelect,callback,scope){var startIdx,endIdx,targetRec,targetRow,tableTop,groupingFeature,group,record,me=this,view=me.view,viewDom=view.el.dom,store=me.store,total=store.buffered?store.getTotalCount():store.getCount();(groupingFeature=view.dataSource.groupingFeature)&&groupingFeature.collapsible!==!1?(recordIdx=Math.min(Math.max(recordIdx,0),view.store.getCount()-1),record=view.store.getAt(recordIdx),recordIdx=groupingFeature.indexOf(recordIdx),group=groupingFeature.getGroup(record),group.isCollapsed&&(groupingFeature.expand(group.name),total=store.buffered?store.getTotalCount():store.getCount())):recordIdx=Math.min(Math.max(recordIdx,0),total-1),startIdx=Math.max(Math.min(recordIdx-(me.leadingBufferZone+me.trailingBufferZone)/2,total-me.viewSize+1),0),tableTop=startIdx*me.rowHeight,endIdx=Math.min(startIdx+me.viewSize-1,total-1),store.getRange(startIdx,endIdx,{callback:function(range,start,end){me.renderRange(start,end,!0),targetRec=store.data.getRange(recordIdx,recordIdx)[0],targetRow=view.getNode(targetRec,!1),view.body.dom.style.top=tableTop+"px",me.position=me.scrollTop=viewDom.scrollTop=tableTop=Math.min(Math.max(0,tableTop-view.body.getOffsetsTo(targetRow)[1]),viewDom.scrollHeight-viewDom.clientHeight),Ext.isIE&&(viewDom.scrollTop=tableTop),doSelect&&view.selModel.select(targetRec),callback&&callback.call(scope||me,recordIdx,targetRec)}})},onViewScroll:function(e,t){var vscrollDistance,scrollDirection,me=this,store=me.store,totalCount=store.buffered?store.getTotalCount():store.getCount(),scrollTop=me.scrollTop=me.view.el.dom.scrollTop,scrollHandled=!1;return me.ignoreNextScrollEvent?void(me.ignoreNextScrollEvent=!1):(me.disabled||totalCount<me.viewSize||(vscrollDistance=scrollTop-me.position,scrollDirection=vscrollDistance>0?1:-1,(Math.abs(vscrollDistance)>=20||scrollDirection!==me.lastScrollDirection)&&(me.lastScrollDirection=scrollDirection,me.handleViewScroll(me.lastScrollDirection),scrollHandled=!0)),void(scrollHandled||me.lockingPartner&&me.lockingPartner.scrollTop!==scrollTop&&(me.lockingPartner.view.el.dom.scrollTop=scrollTop)))},handleViewScroll:function(direction){var requestStart,requestEnd,me=this,rows=me.view.all,store=me.store,viewSize=me.viewSize,totalCount=store.buffered?store.getTotalCount():store.getCount();return direction==-1?rows.startIndex&&me.getFirstVisibleRowIndex()-rows.startIndex<me.numFromEdge&&(requestStart=Math.max(0,me.getLastVisibleRowIndex()+me.trailingBufferZone-viewSize)):rows.endIndex<totalCount-1&&rows.endIndex-me.getLastVisibleRowIndex()<me.numFromEdge&&(requestStart=Math.max(0,me.getFirstVisibleRowIndex()-me.trailingBufferZone)),null!=requestStart&&(requestEnd=Math.min(requestStart+viewSize-1,totalCount-1),requestStart!==rows.startIndex||requestEnd!==rows.endIndex)?void me.renderRange(requestStart,requestEnd):void(me.lockingPartner&&me.lockingPartner.view.el&&me.lockingPartner.scrollTop!==me.scrollTop&&(me.lockingPartner.view.el.dom.scrollTop=me.scrollTop))},renderRange:function(start,end,forceSynchronous){var me=this,rows=me.view.all,store=me.store;start===rows.startIndex&&end===rows.endIndex||(store.rangeCached(start,end)?(me.cancelLoad(),me.synchronousRender||forceSynchronous?me.onRangeFetched(null,start,end):(me.renderTask||(me.renderTask=new Ext.util.DelayedTask(me.onRangeFetched,me,null,(!1))),me.renderTask.delay(1,null,null,[null,start,end]))):me.attemptLoad(start,end))},onRangeFetched:function(range,start,end,fromLockingPartner){var oldStart,removeCount,top,me=this,view=me.view,rows=view.all,increment=0,calculatedTop=start*me.rowHeight,lockingPartner=me.lockingPartner;view.isDestroyed||(range||(range=me.store.getRange(start,end)))&&((start>rows.endIndex||end<rows.startIndex)&&(rows.clear(!0),top=calculatedTop),rows.getCount()?end>rows.endIndex?(removeCount=Math.max(start-rows.startIndex,0),me.variableRowHeight&&(increment=rows.item(rows.startIndex+removeCount,!0).offsetTop),rows.scroll(Ext.Array.slice(range,rows.endIndex+1-start),1,removeCount,start,end),top=me.variableRowHeight?me.bodyTop+increment:calculatedTop):(removeCount=Math.max(rows.endIndex-end,0),oldStart=rows.startIndex,rows.scroll(Ext.Array.slice(range,0,rows.startIndex-start),-1,removeCount,start,end),top=me.variableRowHeight?me.bodyTop-rows.item(oldStart,!0).offsetTop:calculatedTop):view.doAdd(range,start),me.position=me.scrollTop,view.positionBody&&me.setBodyTop(top,calculatedTop),!lockingPartner||lockingPartner.disabled||fromLockingPartner||(lockingPartner.onRangeFetched(range,start,end,!0),lockingPartner.scrollTop!==me.scrollTop&&(lockingPartner.view.el.dom.scrollTop=me.scrollTop)))},setBodyTop:function(bodyTop,calculatedTop){var delta,me=this,view=me.view,store=me.store,body=view.body.dom;bodyTop=Math.floor(bodyTop),void 0!==calculatedTop&&(delta=bodyTop-calculatedTop,bodyTop=calculatedTop),body.style.position="absolute",body.style.top=(me.bodyTop=bodyTop)+"px",delta&&(me.scrollTop=me.position=view.el.dom.scrollTop-=delta),view.all.endIndex===(store.buffered?store.getTotalCount():store.getCount())-1&&me.stretchView(view,me.bodyTop+body.offsetHeight)},getFirstVisibleRowIndex:function(startRow,endRow,viewportTop,viewportBottom){var target,targetTop,me=this,view=me.view,rows=view.all,elements=rows.elements,clientHeight=view.el.dom.clientHeight;if(rows.getCount()&&me.variableRowHeight){if(arguments.length)target=startRow+Math.floor((endRow-startRow)/2);else{if(startRow=rows.startIndex,endRow=rows.endIndex,viewportTop=me.scrollTop,viewportBottom=viewportTop+clientHeight,me.bodyTop>viewportBottom||me.bodyTop+view.body.getHeight()<viewportTop)return Math.floor(me.scrollTop/me.rowHeight);target=startRow+Math.min(me.numFromEdge+(me.lastScrollDirection==-1?me.leadingBufferZone:me.trailingBufferZone),Math.floor((endRow-startRow)/2))}if(targetTop=me.bodyTop+elements[target].offsetTop,targetTop+elements[target].offsetHeight<viewportTop)return me.getFirstVisibleRowIndex(target+1,endRow,viewportTop,viewportBottom);if(targetTop<=viewportTop)return target;if(target!==startRow)return me.getFirstVisibleRowIndex(startRow,target-1,viewportTop,viewportBottom)}return Math.floor(me.scrollTop/me.rowHeight)},getLastVisibleRowIndex:function(startRow,endRow,viewportTop,viewportBottom){var target,targetTop,targetBottom,me=this,view=me.view,rows=view.all,elements=rows.elements,clientHeight=view.el.dom.clientHeight;if(rows.getCount()&&me.variableRowHeight){if(arguments.length)target=startRow+Math.floor((endRow-startRow)/2);else{if(startRow=rows.startIndex,endRow=rows.endIndex,viewportTop=me.scrollTop,viewportBottom=viewportTop+clientHeight,me.bodyTop>viewportBottom||me.bodyTop+view.body.getHeight()<viewportTop)return Math.floor(me.scrollTop/me.rowHeight)+Math.ceil(clientHeight/me.rowHeight);target=endRow-Math.min(me.numFromEdge+(1==me.lastScrollDirection?me.leadingBufferZone:me.trailingBufferZone),Math.floor((endRow-startRow)/2))}if(targetTop=me.bodyTop+elements[target].offsetTop,targetTop>viewportBottom)return me.getLastVisibleRowIndex(startRow,target-1,viewportTop,viewportBottom);if(targetBottom=targetTop+elements[target].offsetHeight,targetBottom>=viewportBottom)return target;if(target!==endRow)return me.getLastVisibleRowIndex(target+1,endRow,viewportTop,viewportBottom)}return me.getFirstVisibleRowIndex()+Math.ceil(clientHeight/me.rowHeight)},getScrollHeight:function(){var me=this,view=me.view,store=me.store,doCalcHeight=!me.hasOwnProperty("rowHeight"),storeCount=me.store.getCount();return storeCount?(doCalcHeight&&view.all.getCount()&&(me.rowHeight=Math.floor(view.body.getHeight()/view.all.getCount())),this.scrollHeight=Math.floor((store.buffered?store.getTotalCount():store.getCount())*me.rowHeight)):0},attemptLoad:function(start,end){var me=this;me.scrollToLoadBuffer?(me.loadTask||(me.loadTask=new Ext.util.DelayedTask(me.doAttemptLoad,me,[])),me.loadTask.delay(me.scrollToLoadBuffer,me.doAttemptLoad,me,[start,end])):me.store.getRange(start,end,{callback:me.onRangeFetched,scope:me,fireEvent:!1})},cancelLoad:function(){this.loadTask&&this.loadTask.cancel()},doAttemptLoad:function(start,end){this.store.getRange(start,end,{callback:this.onRangeFetched,scope:this,fireEvent:!1})},destroy:function(){var me=this,view=me.view;view&&view.el&&view.el.un("scroll",me.onViewScroll,me),Ext.destroy(me.viewListeners,me.storeListeners,me.gridListeners)}}),Ext.define("Ext.grid.plugin.Editing",{alias:"editing.editing",extend:Ext.AbstractPlugin,mixins:{observable:Ext.util.Observable},clicksToEdit:2,triggerEvent:void 0,relayedEvents:["beforeedit","edit","validateedit","canceledit"],defaultFieldXType:"textfield",editStyle:"",constructor:function(config){var me=this;me.addEvents("beforeedit","edit","validateedit","canceledit"),me.callParent(arguments),me.mixins.observable.constructor.call(me),me.on("edit",function(editor,e){me.fireEvent("afteredit",editor,e)})},init:function(grid){var me=this;me.grid=grid,me.view=grid.view,me.initEvents(),me.mon(grid,{beforereconfigure:me.onBeforeReconfigure,reconfigure:me.onReconfigure,scope:me,beforerender:{fn:me.onReconfigure,single:!0,scope:me}}),grid.relayEvents(me,me.relayedEvents),me.grid.ownerLockable&&me.grid.ownerLockable.relayEvents(me,me.relayedEvents),grid.isEditable=!0,grid.editingPlugin=grid.view.editingPlugin=me},onBeforeReconfigure:function(){this.reconfiguring=!0},onReconfigure:function(){this.initFieldAccessors(this.grid.getTopLevelColumnManager().getColumns()),delete this.reconfiguring},destroy:function(){var me=this,grid=me.grid;Ext.destroy(me.keyNav),me.clearListeners(),grid&&(grid.editingPlugin=grid.view.editingPlugin=me.grid=me.view=me.editor=me.keyNav=null)},getEditStyle:function(){return this.editStyle},initFieldAccessors:function(columns){columns.isGroupHeader?columns=columns.getGridColumns():Ext.isArray(columns)||(columns=[columns]);var c,column,me=this,cLen=columns.length;for(c=0;c<cLen;c++)column=columns[c],column.getEditor||(column.getEditor=function(record,defaultField){return me.getColumnField(this,defaultField)}),column.hasEditor||(column.hasEditor=function(){return me.hasColumnField(this)}),column.setEditor||(column.setEditor=function(field){me.setColumnField(this,field)})},removeFieldAccessors:function(columns){columns.isGroupHeader?columns=columns.getGridColumns():Ext.isArray(columns)||(columns=[columns]);var c,column,cLen=columns.length;for(c=0;c<cLen;c++)column=columns[c],column.getEditor=column.hasEditor=column.setEditor=null},getColumnField:function(columnHeader,defaultField){var field=columnHeader.field;return field&&field.isFormField||(field=columnHeader.field=this.createColumnField(columnHeader,defaultField)),field},hasColumnField:function(columnHeader){return!!columnHeader.field},setColumnField:function(columnHeader,field){columnHeader.field=field,columnHeader.field=this.createColumnField(columnHeader)},createColumnField:function(columnHeader,defaultField){var field=columnHeader.field;return!field&&columnHeader.editor&&(field=columnHeader.editor,columnHeader.editor=null),!field&&defaultField&&(field=defaultField),field&&(field.isComponent?(field.column=columnHeader,field.isEditorComponent=!0):(field=Ext.isString(field)?{name:columnHeader.dataIndex,xtype:field,column:columnHeader,isEditorComponent:!0}:Ext.apply({name:columnHeader.dataIndex,column:columnHeader,isEditorComponent:!0},field),field=Ext.ComponentManager.create(field,this.defaultFieldXType)),columnHeader.field=field),field},initEvents:function(){var me=this;me.initEditTriggers(),me.initLockableEvents(),me.initCancelTriggers()},initCancelTriggers:Ext.emptyFn,initEditTriggers:function(){var me=this,view=me.view;"cellfocus"==me.triggerEvent?me.mon(view,"cellfocus",me.onCellFocus,me):"rowfocus"==me.triggerEvent?me.mon(view,"rowfocus",me.onRowFocus,me):(view.getSelectionModel().isCellModel&&(view.onCellFocus=Ext.Function.bind(me.beforeViewCellFocus,me)),me.mon(view,me.triggerEvent||"cell"+(1===me.clicksToEdit?"click":"dblclick"),me.onCellClick,me)),me.initAddRemoveHeaderEvents(),view.on("render",me.initKeyNavHeaderEvents,me,{single:!0})},initLockableEvents:function(){var me=this,grid=me.grid.ownerLockable;grid&&grid.on({lockcolumn:me.onColumnLockUnlock,unlockcolumn:me.onColumnLockUnlock,scope:me})},beforeViewCellFocus:function(position){!this.view.selModel.keyNavigation&&this.editing&&this.isCellEditable&&this.isCellEditable(position.row,position.columnHeader)||this.view.focusCell.apply(this.view,arguments)},onRowFocus:function(record,row,rowIdx){this.startEdit(row,0)},onCellFocus:function(record,cell,position){this.startEdit(position.row,position.column)},onCellClick:function(view,cell,colIdx,record,row,rowIdx,e){var expanderSelector=view.expanderSelector,columnHeader=view.ownerCt.getColumnManager().getHeaderAtIndex(colIdx),editor=columnHeader.getEditor(record);(editor&&!expanderSelector||!e.getTarget(expanderSelector))&&this.startEdit(record,columnHeader)},initAddRemoveHeaderEvents:function(){var me=this;me.mon(me.grid.headerCt,{scope:me,add:me.onColumnAdd,remove:me.onColumnRemove,columnmove:me.onColumnMove})},initKeyNavHeaderEvents:function(){var me=this;me.keyNav=Ext.create("Ext.util.KeyNav",me.view.el,{enter:me.onEnterKey,esc:me.onEscKey,scope:me})},onColumnAdd:function(ct,column){this.initFieldAccessors(column)},onColumnRemove:function(ct,column){this.removeFieldAccessors(column)},onColumnMove:function(headerCt,column,fromIdx,toIdx){this.initFieldAccessors(column)},onColumnLockUnlock:function(view,column){this.initFieldAccessors(column)},onEnterKey:function(e){var record,pos,columnHeader,me=this,grid=me.grid,selModel=grid.getSelectionModel();selModel.getCurrentPosition&&(pos=selModel.getCurrentPosition())?(record=pos.record,columnHeader=pos.columnHeader):(record=selModel.getLastSelected(),columnHeader=grid.getColumnManager().getHeaderAtIndex(0)),record&&columnHeader&&me.startEdit(record,columnHeader)},onEscKey:function(e){return this.cancelEdit()},beforeEdit:Ext.emptyFn,startEdit:function(record,columnHeader){var context,me=this,layoutView=me.grid.lockable?me.grid:me.view;return layoutView.componentLayoutCounter?!(me.grid.collapsed||!me.grid.view.isVisible(!0))&&(context=me.getEditingContext(record,columnHeader),null!=context&&(!(!me.preventBeforeCheck&&(me.beforeEdit(context)===!1||me.fireEvent("beforeedit",me,context)===!1||context.cancel))&&context)):(layoutView.on({boxready:Ext.Function.bind(me.startEdit,me,[record,columnHeader]),single:!0}),!1)},getEditingContext:function(record,columnHeader){var view,gridRow,rowIdx,colIdx,me=this,grid=me.grid,colMgr=grid.getColumnManager();if(Ext.isNumber(columnHeader)&&(columnHeader=colMgr.getHeaderAtIndex(columnHeader)),columnHeader.hidden&&(columnHeader=columnHeader.next(":not([hidden])")||columnHeader.prev(":not([hidden])")),columnHeader&&(view=columnHeader.getOwnerHeaderCt().view,gridRow=view.getNode(record,!0),gridRow&&(colIdx=colMgr.getHeaderIndex(columnHeader),Ext.isNumber(record)?(rowIdx=record,record=view.getRecord(gridRow)):rowIdx=view.indexOf(gridRow),record)))return{grid:grid,view:view,store:view.dataSource,record:record,field:columnHeader.dataIndex,
value:record.get(columnHeader.dataIndex),row:gridRow,column:columnHeader,rowIdx:rowIdx,colIdx:colIdx}},cancelEdit:function(){var me=this;me.editing=!1,me.fireEvent("canceledit",me,me.context)},completeEdit:function(){var me=this;me.editing&&me.validateEdit()&&me.fireEvent("edit",me,me.context),me.context=null,me.editing=!1},validateEdit:function(){var me=this,context=me.context;return me.fireEvent("validateedit",me,context)!==!1&&!context.cancel}}),Ext.define("Ext.grid.plugin.CellEditing",{alias:"plugin.cellediting",extend:Ext.grid.plugin.Editing,lockableScope:"both",init:function(grid){var me=this,lockingPartner=me.lockingPartner;me.callParent(arguments),lockingPartner?lockingPartner.editors?me.editors=lockingPartner.editors:me.editors=lockingPartner.editors=new Ext.util.MixedCollection((!1),function(editor){return editor.editorId}):me.editors=new Ext.util.MixedCollection((!1),function(editor){return editor.editorId})},onReconfigure:function(grid,store,columns){columns&&this.editors.clear(),this.callParent()},destroy:function(){var me=this;me.editors&&(me.editors.each(Ext.destroy,Ext),me.editors.clear()),me.callParent(arguments)},onBodyScroll:function(){var me=this,ed=me.getActiveEditor(),scroll=me.view.el.getScroll();ed&&ed.editing&&ed.editingPlugin===me&&(scroll.top!==me.scroll.top?ed.field&&(ed.field.triggerBlur?ed.field.triggerBlur():ed.field.blur()):ed.realign()),me.scroll=scroll},initCancelTriggers:function(){var me=this,grid=me.grid,view=grid.view;me.mon(view,"bodyscroll",me.onBodyScroll,me),me.mon(grid,{columnresize:me.cancelEdit,columnmove:me.cancelEdit,scope:me})},isCellEditable:function(record,columnHeader){var me=this,context=me.getEditingContext(record,columnHeader);if(me.grid.view.isVisible(!0)&&context&&(columnHeader=context.column,record=context.record,columnHeader&&me.getEditor(record,columnHeader)))return!0},startEdit:function(record,columnHeader,context){var isEditorEditing,isFieldEditable,ed,me=this;return!(!context&&(me.preventBeforeCheck=!0,context=me.callParent(arguments),delete me.preventBeforeCheck,context===!1))&&(context&&me.grid.view.isVisible(!0)?(record=context.record,columnHeader=context.column,isFieldEditable=columnHeader&&columnHeader.getEditor(record)&&!(me.beforeEdit(context)===!1||me.fireEvent("beforeedit",me,context)===!1||context.cancel),isFieldEditable&&(ed=me.getEditor(record,columnHeader),isEditorEditing=ed.editing),me.completeEdit(),!!isFieldEditable&&(me.context=context,context.originalValue=context.value=record.get(columnHeader.dataIndex),me.grid.view.cancelFocus(),me.view.scrollCellIntoView(me.getCell(record,columnHeader)),!!ed&&(Ext.isIE&&isEditorEditing&&(ed.selectSameEditor=!0),me.showEditor(ed,context,context.value),!0))):void 0)},showEditor:function(ed,context,value){var me=this,record=context.record,columnHeader=context.column,sm=me.grid.getSelectionModel(),preventFocus=sm.preventFocus,selection=sm.getCurrentPosition();return columnHeader.up(me.view.ownerCt)?(me.setEditingContext(context),me.setActiveEditor(ed),me.setActiveRecord(record),me.setActiveColumn(columnHeader),selection&&sm.isCellSelected(me.view,record,columnHeader)||(sm.preventFocus=!0,sm.selectByPosition({row:record,column:columnHeader,view:me.view}),sm.preventFocus=preventFocus),Ext.isIE&&"click"===Ext.EventObject.type?Ext.Function.defer(ed.startEdit,1,ed,[me.getCell(record,columnHeader),value,context]):ed.startEdit(me.getCell(record,columnHeader),value,context),me.editing=!0,void(me.scroll=me.view.el.getScroll())):me.lockingPartner.showEditor(ed,me.lockingPartner.getEditingContext(selection.record,selection.columnHeader),value)},completeEdit:function(){var activeEd=this.getActiveEditor();activeEd&&(activeEd.completeEdit(),this.editing=!1)},setEditingContext:function(context){this.context=context,this.lockingPartner&&(this.lockingPartner.context=context)},setActiveEditor:function(ed){this.activeEditor=ed,this.lockingPartner&&(this.lockingPartner.activeEditor=ed)},getActiveEditor:function(){return this.activeEditor},setActiveColumn:function(column){this.activeColumn=column,this.lockingPartner&&(this.lockingPartner.activeColumn=column)},getActiveColumn:function(){return this.activeColumn},setActiveRecord:function(record){this.activeRecord=record,this.lockingPartner&&(this.lockingPartner.activeRecord=record)},getActiveRecord:function(){return this.activeRecord},getEditor:function(record,column){var me=this,editors=me.editors,editorId=column.getItemId(),editor=editors.getByKey(editorId),editorOwner=me.grid.ownerLockable||me.grid;if(!editor){if(editor=column.getEditor(record),!editor)return!1;editor instanceof Ext.grid.CellEditor?editor.floating=!0:editor=new Ext.grid.CellEditor({floating:!0,editorId:editorId,field:editor}),editor.field.excludeForm=!0,editorOwner.add(editor),editor.on({scope:me,specialkey:me.onSpecialKey,complete:me.onEditComplete,canceledit:me.cancelEdit}),column.on("removed",me.cancelActiveEdit,me),editors.add(editor)}return column.isTreeColumn&&(editor.isForTree=column.isTreeColumn,editor.addCls(Ext.baseCSSPrefix+"tree-cell-editor")),editor.grid=me.grid,editor.editingPlugin=me,editor},cancelActiveEdit:function(column){var context=this.context;context&&context.column===column&&this.cancelEdit()},setColumnField:function(column,field){var ed=this.editors.getByKey(column.getItemId());Ext.destroy(ed,column.field),this.editors.removeAtKey(column.getItemId()),this.callParent(arguments)},getCell:function(record,column){return this.grid.getView().getCell(record,column)},onSpecialKey:function(ed,field,e){var sm;if(e.getKey()===e.TAB&&(e.stopEvent(),ed&&ed.onEditorTab(e),sm=ed.up("tablepanel").getSelectionModel(),sm.onEditorTab))return sm.onEditorTab(ed.editingPlugin,e)},onEditComplete:function(ed,value,startValue){var record,me=this,activeColumn=me.getActiveColumn(),context=me.context;if(activeColumn){if(record=context.record,me.setActiveEditor(null),me.setActiveColumn(null),me.setActiveRecord(null),context.value=value,!me.validateEdit())return void(me.editing=!1);record.isEqual(value,startValue)||record.set(activeColumn.dataIndex,value),context.view.focusRow(context.rowIdx,100),me.fireEvent("edit",me,context),me.editing=!1}},cancelEdit:function(){var me=this,context=me.context,activeEd=me.getActiveEditor();return me.setActiveEditor(null),me.setActiveColumn(null),me.setActiveRecord(null),!activeEd||(activeEd.field&&(me.context.value="editedValue"in activeEd?activeEd.editedValue:activeEd.getValue(),activeEd.cancelEdit()),context.view.focusRow(context.rowIdx,100),void me.callParent(arguments))},startEditByPosition:function(position){var index,cm=this.grid.getColumnManager();return position.isCellContext||(position=new Ext.grid.CellContext(this.view).setPosition(position)),index=cm.getHeaderIndex(position.columnHeader),position.setColumn(cm.getVisibleHeaderClosestToIndex(index)),this.startEdit(position.record,position.columnHeader)}}),Ext.define("Ext.grid.plugin.DivRenderer",{alias:"plugin.divrenderer",extend:Ext.AbstractPlugin,tableTpl:['<div id="{view.id}-table" class="',Ext.baseCSSPrefix,"{view.id}-table ",Ext.baseCSSPrefix,'grid-table" style="{tableStyle}" {ariaTableAttr}>',"{%","values.view.renderRows(values.rows, values.viewStartIndex, out);","%}","</div>",{priority:0}],rowTpl:["{%",'var dataRowCls = values.recordIndex === -1 ? "" : " '+Ext.baseCSSPrefix+'grid-data-row";',"%}",'<dl {[values.rowId ? ("id=\\"" + values.rowId + "\\"") : ""]} ','data-boundView="{view.id}" ','data-recordId="{record.internalId}" ','data-recordIndex="{recordIndex}" ','class="{[values.itemClasses.join(" ")]} {[values.rowClasses.join(" ")]}{[dataRowCls]}" ','style="position:relative" ',"{rowAttr:attributes} {ariaRowAttr}>",'<tpl for="columns">{%',"parent.view.renderCell(values, parent.record, parent.recordIndex, xindex - 1, out, parent)","%}","</tpl>","</dl>",{priority:0}],cellTpl:['<dt class="{tdCls}" {tdAttr} data-cellIndex="{cellIndex}" {ariaCellAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner"','style="text-align:{align};<tpl if="style">{style}</tpl>" {ariaCellInnerAttr}>{value}</div>',"</dt>",{priority:0}],selectors:{bodySelector:"div",nodeContainerSelector:"div",itemSelector:"dl."+Ext.baseCSSPrefix+"grid-row",dataRowSelector:"dl."+Ext.baseCSSPrefix+"grid-data-row",cellSelector:"dt."+Ext.baseCSSPrefix+"grid-cell",innerSelector:"div."+Ext.baseCSSPrefix+"grid-cell-inner",getNodeContainerSelector:function(){return this.getBodySelector()},getNodeContainer:function(){return this.el.getById(this.id+"-table",!0)}},init:function(grid){var view=grid.getView();view.tableTpl=Ext.XTemplate.getTpl(this,"tableTpl"),view.rowTpl=Ext.XTemplate.getTpl(this,"rowTpl"),view.cellTpl=Ext.XTemplate.getTpl(this,"cellTpl"),Ext.apply(view,this.selectors)}}),Ext.define("Ext.grid.plugin.DragDrop",{extend:Ext.AbstractPlugin,alias:"plugin.gridviewdragdrop",dragText:"{0} selected row{1}",ddGroup:"GridDD",enableDrop:!0,enableDrag:!0,containerScroll:!1,init:function(view){view.on("render",this.onViewRender,this,{single:!0})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},enable:function(){var me=this;me.dragZone&&me.dragZone.unlock(),me.dropZone&&me.dropZone.unlock(),me.callParent()},disable:function(){var me=this;me.dragZone&&me.dragZone.lock(),me.dropZone&&me.dropZone.lock(),me.callParent()},onViewRender:function(view){var scrollEl,me=this;me.enableDrag&&(me.containerScroll&&(scrollEl=view.getEl()),me.dragZone=new Ext.view.DragZone({view:view,ddGroup:me.dragGroup||me.ddGroup,dragText:me.dragText,containerScroll:me.containerScroll,scrollEl:scrollEl})),me.enableDrop&&(me.dropZone=new Ext.grid.ViewDropZone({view:view,ddGroup:me.dropGroup||me.ddGroup}))}}),Ext.define("Ext.grid.plugin.RowEditing",{extend:Ext.grid.plugin.Editing,alias:"plugin.rowediting",lockableScope:"top",editStyle:"row",autoCancel:!0,errorSummary:!0,constructor:function(){var me=this;me.callParent(arguments),me.clicksToMoveEditor||(me.clicksToMoveEditor=me.clicksToEdit),me.autoCancel=!!me.autoCancel},destroy:function(){Ext.destroy(this.editor),this.callParent(arguments)},onBeforeReconfigure:function(){this.callParent(arguments),this.cancelEdit()},onReconfigure:function(grid,store,columns){var ed=this.editor;this.callParent(arguments),columns&&ed&&ed.rendered&&(ed.needsSyncFieldWidths=!0)},startEdit:function(record,columnHeader){var context,me=this,editor=me.getEditor();return Ext.isEmpty(columnHeader)&&(columnHeader=me.grid.getTopLevelVisibleColumnManager().getHeaderAtIndex(0)),!(editor.beforeEdit()===!1||!(context=me.callParent([record,columnHeader])))&&(me.context=context,me.lockingPartner&&me.lockingPartner.cancelEdit(),editor.startEdit(context.record,context.column,context),me.editing=!0,!0)},cancelEdit:function(){var me=this;return!me.editing||(me.getContextFieldValues(),me.getEditor().cancelEdit(),void me.callParent(arguments))},completeEdit:function(){var me=this;me.editing&&me.validateEdit()&&(me.editing=!1,me.fireEvent("edit",me,me.context))},onEnterKey:function(){this.getEditor().getForm().isValid()&&this.completeEdit()},validateEdit:function(){return this.getContextFieldValues(),this.editing=this.callParent(arguments)&&this.getEditor().completeEdit(),this.editing},getEditor:function(){var me=this;return me.editor||(me.editor=me.initEditor()),me.editor},getContextFieldValues:function(){var i,name,item,editor=this.editor,context=this.context,record=context.record,newValues={},originalValues={},editors=editor.query(">[isFormField]"),len=editors.length;for(i=0;i<len;i++)item=editors[i],name=item.name,newValues[name]=item.getValue(),originalValues[name]=record.get(name);Ext.apply(context,{newValues:newValues,originalValues:originalValues})},initEditor:function(){return new Ext.grid.RowEditor(this.initEditorConfig())},initEditorConfig:function(){var b,item,me=this,grid=me.grid,view=me.view,headerCt=grid.headerCt,btns=["saveBtnText","cancelBtnText","errorsText","dirtyText"],bLen=btns.length,cfg={autoCancel:me.autoCancel,errorSummary:me.errorSummary,fields:headerCt.getGridColumns(),hidden:!0,view:view,editingPlugin:me};for(b=0;b<bLen;b++)item=btns[b],Ext.isDefined(me[item])&&(cfg[item]=me[item]);return cfg},initEditTriggers:function(){var me=this,view=me.view,moveEditorEvent=1===me.clicksToMoveEditor?"click":"dblclick";me.callParent(arguments),me.clicksToMoveEditor!==me.clicksToEdit&&me.mon(view,"cell"+moveEditorEvent,me.moveEditorByClick,me),view.on({render:function(){me.mon(me.grid.headerCt,{scope:me,columnresize:me.onColumnResize,columnhide:me.onColumnHide,columnshow:me.onColumnShow})},single:!0})},startEditByClick:function(){var me=this;me.editing&&me.clicksToMoveEditor!==me.clicksToEdit||me.callParent(arguments)},moveEditorByClick:function(){var me=this;me.editing&&me.superclass.onCellClick.apply(me,arguments)},onColumnAdd:function(ct,column){if(column.isHeader){var editor,me=this;me.initFieldAccessors(column),editor=me.editor,editor&&editor.onColumnAdd(column)}},onColumnRemove:function(ct,column){if(column.isHeader){var me=this,editor=me.getEditor();editor&&editor.onColumnRemove(ct,column),me.removeFieldAccessors(column)}},onColumnResize:function(ct,column,width){if(column.isHeader){var me=this,editor=me.getEditor();editor&&editor.onColumnResize(column,width)}},onColumnHide:function(ct,column){var me=this,editor=me.getEditor();editor&&editor.onColumnHide(column)},onColumnShow:function(ct,column){var me=this,editor=me.getEditor();editor&&editor.onColumnShow(column)},onColumnMove:function(ct,column,fromIdx,toIdx){var me=this,editor=me.getEditor();me.initFieldAccessors(column),editor&&editor.onColumnMove(column,fromIdx,toIdx)},setColumnField:function(column,field){var me=this,editor=me.getEditor();editor&&editor.removeColumnEditor(column,!0),me.callParent(arguments),editor&&editor.insertColumnEditor(column)},createColumnField:function(column,defaultField){var def,editor=this.editor;return editor&&(def=editor.getDefaultFieldCfg()),this.callParent([column,defaultField||def])}}),Ext.define("Ext.grid.plugin.RowExpander",{extend:Ext.AbstractPlugin,lockableScope:"normal",alias:"plugin.rowexpander",rowBodyTpl:null,expandOnEnter:!0,expandOnDblClick:!0,selectRowOnExpand:!1,rowBodyTrSelector:"."+Ext.baseCSSPrefix+"grid-rowbody-tr",rowBodyHiddenCls:Ext.baseCSSPrefix+"grid-row-body-hidden",rowCollapsedCls:Ext.baseCSSPrefix+"grid-row-collapsed",addCollapsedCls:{before:function(values,out){var me=this.rowExpander;me.recordsExpanded[values.record.internalId]||values.itemClasses.push(me.rowCollapsedCls)},priority:500},setCmp:function(grid){var rowBodyTpl,features,me=this;me.callParent(arguments),me.recordsExpanded={},me.rowBodyTpl=Ext.XTemplate.getTpl(me,"rowBodyTpl"),rowBodyTpl=this.rowBodyTpl,features=[{ftype:"rowbody",lockableScope:"normal",recordsExpanded:me.recordsExpanded,rowBodyHiddenCls:me.rowBodyHiddenCls,rowCollapsedCls:me.rowCollapsedCls,setupRowData:me.getRowBodyFeatureData,setup:me.setup,getRowBodyContents:function(record){return rowBodyTpl.applyTemplate(record.getData())}},{ftype:"rowwrap",lockableScope:"normal"}],grid.features?grid.features=Ext.Array.push(features,grid.features):grid.features=features},init:function(grid){var view,lockedView,me=this,reconfigurable=grid;grid.lockable&&(grid=grid.lockedGrid),me.callParent(arguments),me.grid=grid,view=me.view=grid.getView(),me.addExpander(),me.bindView(view),view.addRowTpl(me.addCollapsedCls).rowExpander=me,grid.ownerLockable&&(reconfigurable=grid.ownerLockable,reconfigurable.syncRowHeight=!1,lockedView=reconfigurable.lockedGrid.getView(),me.bindView(lockedView),lockedView.addRowTpl(me.addCollapsedCls).rowExpander=me,reconfigurable.mon(reconfigurable,"columnschanged",me.refreshRowHeights,me),reconfigurable.mon(reconfigurable.store,"datachanged",me.refreshRowHeights,me)),reconfigurable.on("beforereconfigure",me.beforeReconfigure,me),grid.ownerLockable&&!grid.rowLines&&view.on("rowfocus",me.refreshRowHeights,me)},beforeReconfigure:function(grid,store,columns,oldStore,oldColumns){var expander=this.getHeaderConfig();expander.locked=!0,columns.unshift(expander)},addExpander:function(){var me=this,expanderGrid=me.grid,expanderHeader=me.getHeaderConfig();expanderGrid.ownerLockable&&(expanderGrid=expanderGrid.ownerLockable.lockedGrid,expanderGrid.width+=expanderHeader.width),expanderGrid.headerCt.insert(0,expanderHeader),expanderGrid.getSelectionModel().injectCheckbox=1},getRowBodyFeatureData:function(record,idx,rowValues){var me=this;me.self.prototype.setupRowData.apply(me,arguments),rowValues.rowBody=me.getRowBodyContents(record),rowValues.rowBodyCls=me.recordsExpanded[record.internalId]?"":me.rowBodyHiddenCls},setup:function(rows,rowValues){var me=this;me.self.prototype.setup.apply(me,arguments),me.grid.ownerLockable||(rowValues.rowBodyColspan-=1)},bindView:function(view){this.expandOnEnter&&view.on("itemkeydown",this.onKeyDown,this),this.expandOnDblClick&&view.on("itemdblclick",this.onDblClick,this)},onKeyDown:function(view,record,row,rowIdx,e){if(e.getKey()==e.ENTER)for(var ds=view.store,sels=view.getSelectionModel().getSelection(),ln=sels.length,i=0;i<ln;i++)rowIdx=ds.indexOf(sels[i]),this.toggleRow(rowIdx,sels[i])},onDblClick:function(view,record,row,rowIdx,e){this.toggleRow(rowIdx,record)},toggleRow:function(rowIdx,record){var ownerLock,rowHeight,fireView,me=this,view=me.view,rowNode=view.getNode(rowIdx),row=Ext.fly(rowNode,"_rowExpander"),nextBd=row.down(me.rowBodyTrSelector,!0),isCollapsed=row.hasCls(me.rowCollapsedCls),addOrRemoveCls=isCollapsed?"removeCls":"addCls";Ext.suspendLayouts(),row[addOrRemoveCls](me.rowCollapsedCls),Ext.fly(nextBd)[addOrRemoveCls](me.rowBodyHiddenCls),me.recordsExpanded[record.internalId]=isCollapsed,view.refreshSize(),me.grid.ownerLockable?(ownerLock=me.grid.ownerLockable,fireView=ownerLock.getView(),view=ownerLock.lockedGrid.view,rowHeight=row.getHeight(),row.setHeight(isCollapsed?rowHeight:""),row=Ext.fly(view.getNode(rowIdx),"_rowExpander"),row.setHeight(isCollapsed?rowHeight:""),row[addOrRemoveCls](me.rowCollapsedCls),view.refreshSize()):fireView=view,fireView.fireEvent(isCollapsed?"expandbody":"collapsebody",row.dom,record,nextBd),Ext.resumeLayouts(!0)},refreshRowHeights:function(){Ext.globalEvents.on({idle:this.doRefreshRowHeights,scope:this,single:!0})},doRefreshRowHeights:function(){var key,record,normalRow,lockedRow,lockedHeight,normalHeight,me=this,recordsExpanded=me.recordsExpanded,lockedView=me.grid.ownerLockable.lockedGrid.view,normalView=me.grid.ownerLockable.normalGrid.view;for(key in recordsExpanded)recordsExpanded.hasOwnProperty(key)&&(record=this.view.store.data.get(key),lockedRow=lockedView.getNode(record,!1),normalRow=normalView.getNode(record,!1),lockedRow.style.height=normalRow.style.height="",lockedHeight=lockedRow.offsetHeight,normalHeight=normalRow.offsetHeight,normalHeight>lockedHeight?lockedRow.style.height=normalHeight+"px":lockedHeight>normalHeight&&(normalRow.style.height=lockedHeight+"px"))},getHeaderConfig:function(){var me=this;return{width:24,lockable:!1,sortable:!1,resizable:!1,draggable:!1,hideable:!1,menuDisabled:!0,tdCls:Ext.baseCSSPrefix+"grid-cell-special",innerCls:Ext.baseCSSPrefix+"grid-cell-inner-row-expander",renderer:function(value,metadata){return me.grid.ownerLockable||(metadata.tdAttr+=' rowspan="2"'),'<div class="'+Ext.baseCSSPrefix+'grid-row-expander" role="presentation"></div>'},processEvent:function(type,view,cell,rowIndex,cellIndex,e,record){if("mousedown"==type&&e.getTarget("."+Ext.baseCSSPrefix+"grid-row-expander"))return me.toggleRow(rowIndex,record),me.selectRowOnExpand}}}}),Ext.define("Ext.grid.property.Grid",{extend:Ext.grid.Panel,alias:"widget.propertygrid",alternateClassName:"Ext.grid.PropertyGrid",valueField:"value",nameField:"name",inferTypes:!0,enableColumnMove:!1,columnLines:!0,stripeRows:!1,trackMouseOver:!1,clicksToEdit:1,enableHdMenu:!1,gridCls:Ext.baseCSSPrefix+"property-grid",initComponent:function(){var me=this;me.source=me.source||{},me.addCls(me.gridCls),me.plugins=me.plugins||[],me.plugins.push(new Ext.grid.plugin.CellEditing({clicksToEdit:me.clicksToEdit,startEdit:function(record,column){return this.self.prototype.startEdit.call(this,record,me.valueColumn)}})),me.selModel={selType:"cellmodel",onCellSelect:function(position){return position.columnHeader=me.valueColumn,position.column=me.valueColumn.getVisibleIndex(),this.self.prototype.onCellSelect.call(this,position)}},me.sourceConfig=Ext.apply({},me.sourceConfig),me.store||(me.propStore=me.store=new Ext.grid.property.Store(me,me.source)),me.configure(me.sourceConfig),me.sortableColumns&&me.store.sort("name","ASC"),me.columns=new Ext.grid.property.HeaderContainer(me,me.store),me.addEvents("beforepropertychange","propertychange"),me.callParent(),me.getView().walkCells=this.walkCells,me.editors={date:new Ext.grid.CellEditor({field:new Ext.form.field.Date({selectOnFocus:!0})}),string:new Ext.grid.CellEditor({field:new Ext.form.field.Text({selectOnFocus:!0})}),number:new Ext.grid.CellEditor({field:new Ext.form.field.Number({selectOnFocus:!0})}),boolean:new Ext.grid.CellEditor({field:new Ext.form.field.ComboBox({editable:!1,store:[[!0,me.headerCt.trueText],[!1,me.headerCt.falseText]]})})},me.store.on("update",me.onUpdate,me)},configure:function(config){var name,value,rec,type,me=this,store=me.store,i=0,len=me.store.getCount(),nameField=me.nameField,valueField=me.valueField;if(me.configureLegacy(config),me.inferTypes)for(;i<len;++i)rec=store.getAt(i),name=rec.get(nameField),me.getConfig(name,"type")||(value=rec.get(valueField),type=Ext.isDate(value)?"date":Ext.isNumber(value)?"number":Ext.isBoolean(value)?"boolean":"string",me.setConfig(name,"type",type))},getConfig:function(fieldName,key,defaultValue){var out,config=this.sourceConfig[fieldName];return config&&(out=config[key]),out||defaultValue},setConfig:function(fieldName,key,value){var sourceCfg=this.sourceConfig,o=sourceCfg[fieldName];return o?o.__copied||(o=Ext.apply({__copied:!0},o),sourceCfg[fieldName]=o):o=sourceCfg[fieldName]={__copied:!0},o[key]=value,value},configureLegacy:function(config){var me=this;me.copyLegacyObject(config,me.customRenderers,"renderer"),me.copyLegacyObject(config,me.customEditors,"editor"),me.copyLegacyObject(config,me.propertyNames,"displayName")},copyLegacyObject:function(config,o,keyName){var key;for(key in o)o.hasOwnProperty(key)&&(config[key]||(config[key]={}),config[key][keyName]=o[key])},onUpdate:function(store,record,operation){var v,oldValue,me=this;me.rendered&&operation==Ext.data.Model.EDIT&&(v=record.get(me.valueField),oldValue=record.modified.value,me.fireEvent("beforepropertychange",me.source,record.getId(),v,oldValue)!==!1?(me.source&&(me.source[record.getId()]=v),record.commit(),me.fireEvent("propertychange",me.source,record.getId(),v,oldValue)):record.reject())},walkCells:function(pos,direction,e,preventWrap,verifierFn,scope){var me=this,valueColumn=me.ownerCt.valueColumn;return"left"==direction?direction="up":"right"==direction&&(direction="down"),pos=Ext.view.Table.prototype.walkCells.call(me,pos,direction,e,preventWrap,verifierFn,scope),pos.columnHeader=valueColumn,pos.column=valueColumn.getVisibleIndex(),pos},getCellEditor:function(record,column){var me=this,propName=record.get(me.nameField),val=record.get(me.valueField),editor=me.getConfig(propName,"editor"),type=me.getConfig(propName,"type"),editors=me.editors;if(editor)editor instanceof Ext.grid.CellEditor||(editor instanceof Ext.form.field.Base||(editor=Ext.ComponentManager.create(editor,"textfield")),editor=me.setConfig(propName,"editor",new Ext.grid.CellEditor({field:editor})));else if(type)switch(type){case"date":editor=editors.date;break;case"number":editor=editors.number;break;case"boolean":editor=me.editors.boolean;break;default:editor=editors.string}else editor=Ext.isDate(val)?editors.date:Ext.isNumber(val)?editors.number:Ext.isBoolean(val)?editors.boolean:editors.string;return editor.editorId=propName,editor},beforeDestroy:function(){var me=this;me.callParent(),me.destroyEditors(me.editors),me.destroyEditors(me.customEditors),delete me.source},destroyEditors:function(editors){for(var ed in editors)editors.hasOwnProperty(ed)&&Ext.destroy(editors[ed])},setSource:function(source,sourceConfig){var me=this;me.source=source,void 0!==sourceConfig&&(me.sourceConfig=Ext.apply({},sourceConfig),me.configure(me.sourceConfig)),me.propStore.setSource(source)},getSource:function(){return this.propStore.getSource()},setProperty:function(prop,value,create){this.propStore.setValue(prop,value,create)},removeProperty:function(prop){this.propStore.remove(prop)}}),Ext.define("Ext.grid.property.HeaderContainer",{extend:Ext.grid.header.Container,alternateClassName:"Ext.grid.PropertyColumnModel",nameWidth:115,nameText:"Name",valueText:"Value",dateFormat:"m/j/Y",trueText:"true",falseText:"false",nameColumnCls:Ext.baseCSSPrefix+"grid-property-name",nameColumnInnerCls:Ext.baseCSSPrefix+"grid-cell-inner-property-name",constructor:function(grid,store){var me=this;me.grid=grid,me.store=store,me.callParent([{isRootHeader:!0,enableColumnResize:Ext.isDefined(grid.enableColumnResize)?grid.enableColumnResize:me.enableColumnResize,enableColumnMove:Ext.isDefined(grid.enableColumnMove)?grid.enableColumnMove:me.enableColumnMove,items:[{header:me.nameText,width:grid.nameColumnWidth||me.nameWidth,sortable:grid.sortableColumns,dataIndex:grid.nameField,renderer:Ext.Function.bind(me.renderProp,me),itemId:grid.nameField,menuDisabled:!0,tdCls:me.nameColumnCls,innerCls:me.nameColumnInnerCls},{header:me.valueText,renderer:Ext.Function.bind(me.renderCell,me),getEditor:Ext.Function.bind(me.getCellEditor,me),sortable:grid.sortableColumns,flex:1,fixed:!0,dataIndex:grid.valueField,itemId:grid.valueField,menuDisabled:!0}]}]),me.grid.valueColumn=me.items.items[1]},getCellEditor:function(record){return this.grid.getCellEditor(record,this)},renderProp:function(v){return this.getPropertyName(v)},renderCell:function(val,meta,rec){var me=this,grid=me.grid,renderer=grid.getConfig(rec.get(grid.nameField),"renderer"),result=val;return renderer?renderer.apply(me,arguments):(Ext.isDate(val)?result=me.renderDate(val):Ext.isBoolean(val)&&(result=me.renderBool(val)),Ext.util.Format.htmlEncode(result))},renderDate:Ext.util.Format.date,renderBool:function(bVal){return this[bVal?"trueText":"falseText"]},getPropertyName:function(name){return this.grid.getConfig(name,"displayName",name)}}),Ext.define("Ext.grid.property.Property",{extend:Ext.data.Model,alternateClassName:"Ext.PropGridProperty",fields:[{name:"name",type:"string"},{name:"value"}],idProperty:"name"}),Ext.define("Ext.grid.property.Store",{extend:Ext.data.Store,alternateClassName:"Ext.grid.PropertyStore",sortOnLoad:!1,constructor:function(grid,source){var me=this;me.grid=grid,me.source=source,me.callParent([{data:source,model:Ext.grid.property.Property,proxy:me.getProxy()}])},getProxy:function(){return this.proxy||(Ext.grid.property.Store.prototype.proxy=new Ext.data.proxy.Memory({model:Ext.grid.property.Property,reader:this.getReader()})),this.proxy},getReader:function(){return this.reader||(Ext.grid.property.Store.prototype.reader=new Ext.data.reader.Reader({model:Ext.grid.property.Property,buildExtractors:Ext.emptyFn,read:function(dataObject){return this.readRecords(dataObject)},readRecords:function(dataObject){var val,propName,result={records:[],success:!0};for(propName in dataObject)dataObject.hasOwnProperty(propName)&&(val=dataObject[propName],this.isEditableValue(val)&&result.records.push(new Ext.grid.property.Property({name:propName,value:val},propName)));return result.total=result.count=result.records.length,new Ext.data.ResultSet(result)},isEditableValue:function(val){return Ext.isPrimitive(val)||Ext.isDate(val)||null===val}})),this.reader},setSource:function(dataObject){var me=this;me.source=dataObject,me.suspendEvents(),me.removeAll(),me.proxy.data=dataObject,me.load(),me.resumeEvents(),me.fireEvent("datachanged",me),me.fireEvent("refresh",me)},getProperty:function(row){return Ext.isNumber(row)?this.getAt(row):this.getById(row)},setValue:function(prop,value,create){var me=this,rec=me.getRec(prop);rec?(rec.set("value",value),me.source[prop]=value):create&&(me.source[prop]=value,rec=new Ext.grid.property.Property({name:prop,value:value},prop),me.add(rec))},remove:function(prop){var rec=this.getRec(prop);rec&&(this.callParent([rec]),delete this.source[prop])},getRec:function(prop){return this.getById(prop)},getSource:function(){return this.source}}),Ext.define("Ext.layout.ClassList",function(){var splitWords=Ext.String.splitWords,toMap=Ext.Array.toMap;return{dirty:!1,constructor:function(owner){this.owner=owner,this.map=toMap(this.classes=splitWords(owner.el.className))},add:function(cls){var me=this;me.map[cls]||(me.map[cls]=!0,me.classes.push(cls),me.dirty||(me.dirty=!0,me.owner.markDirty()))},addMany:function(classes){Ext.each(splitWords(classes),this.add,this)},contains:function(cls){return this.map[cls]},flush:function(){this.owner.el.className=this.classes.join(" "),this.dirty=!1},remove:function(cls){var me=this;me.map[cls]&&(delete me.map[cls],me.classes=Ext.Array.filter(me.classes,function(c){return c!=cls}),me.dirty||(me.dirty=!0,me.owner.markDirty()))},removeMany:function(classes){var me=this,remove=toMap(splitWords(classes));me.classes=Ext.Array.filter(me.classes,function(c){return!remove[c]||(delete me.map[c],me.dirty||(me.dirty=!0,me.owner.markDirty()),!1)})}}}()),Ext.define("Ext.util.Queue",{constructor:function(){this.clear()},add:function(obj){var me=this,key=me.getKey(obj);return me.map[key]||(++me.length,me.items.push(obj),me.map[key]=obj),obj},clear:function(){var me=this,items=me.items;return me.items=[],me.map={},me.length=0,items},contains:function(obj){var key=this.getKey(obj);return this.map.hasOwnProperty(key)},getCount:function(){return this.length},getKey:function(obj){return obj.id},remove:function(obj){var index,me=this,key=me.getKey(obj),items=me.items;return me.map[key]&&(index=Ext.Array.indexOf(items,obj),Ext.Array.erase(items,index,1),delete me.map[key],--me.length),obj}}),Ext.define("Ext.layout.ContextItem",{heightModel:null,widthModel:null,sizeModel:null,optOut:!1,ownerSizePolicy:null,boxChildren:null,boxParent:null,isBorderBoxValue:null,children:[],dirty:null,dirtyCount:0,hasRawContent:!0,isContextItem:!0,isTopLevel:!1,consumersContentHeight:0,consumersContentWidth:0,consumersContainerHeight:0,consumersContainerWidth:0,consumersHeight:0,consumersWidth:0,ownerCtContext:null,remainingChildDimensions:0,props:null,state:null,wrapsComponent:!1,constructor:function(config){var el,lastBox,ownerCt,ownerCtContext,props,sizeModel,target,lastWidth,lastHeight,sameWidth,sameHeight,widthModel,heightModel,optOut,me=this,sizeModels=Ext.layout.SizeModel.sizeModels,configured=sizeModels.configured,shrinkWrap=sizeModels.shrinkWrap;Ext.apply(me,config),el=me.el,me.id=el.id,me.flushedProps={},me.props=props={},me.styles={},target=me.target,target.isComponent?(me.wrapsComponent=!0,me.framing=target.frameSize||null,me.isComponentChild=target.ownerLayout&&target.ownerLayout.isComponentLayout,lastBox=target.lastBox,ownerCt=target.ownerCt,ownerCt&&(ownerCtContext=ownerCt.el&&me.context.items[ownerCt.el.id])&&(me.ownerCtContext=ownerCtContext),me.sizeModel=sizeModel=target.getSizeModel(ownerCtContext&&ownerCtContext.widthModel.pairsByHeightOrdinal[ownerCtContext.heightModel.ordinal]),me.widthModel=widthModel=sizeModel.width,me.heightModel=heightModel=sizeModel.height,lastBox&&lastBox.invalid===!1&&(sameWidth=target.width===(lastWidth=lastBox.width),sameHeight=target.height===(lastHeight=lastBox.height),widthModel===shrinkWrap&&heightModel===shrinkWrap?optOut=!0:widthModel===configured&&sameWidth&&(optOut=heightModel===shrinkWrap||heightModel===configured&&sameHeight),optOut&&(me.optOut=!0,props.width=lastWidth,props.height=lastHeight))):lastBox=el.lastBox,me.lastBox=lastBox},init:function(full,options){var children,i,n,ownerCt,sizeModel,target,newHeightModel,newWidthModel,me=this,oldProps=me.props,oldDirty=me.dirty,ownerCtContext=me.ownerCtContext,ownerLayout=me.target.ownerLayout,firstTime=!me.state,ret=full||firstTime,oldHeightModel=me.heightModel,oldWidthModel=me.widthModel,remainingCount=0;
if(me.dirty=me.invalid=!1,me.props={},me.remainingChildDimensions=0,me.boxChildren&&(me.boxChildren.length=0),firstTime||(me.clearAllBlocks("blocks"),me.clearAllBlocks("domBlocks")),!me.wrapsComponent)return ret;if(target=me.target,me.state={},firstTime)target.beforeLayout&&target.beforeLayout!==Ext.emptyFn&&target.beforeLayout(),!ownerCtContext&&(ownerCt=target.ownerCt)&&(ownerCtContext=me.context.items[ownerCt.el.id]),ownerCtContext?(me.ownerCtContext=ownerCtContext,me.isBoxParent=target.ownerLayout.isItemBoxParent(me)):me.isTopLevel=!0,me.frameBodyContext=me.getEl("frameBody");else for(ownerCtContext=me.ownerCtContext,me.isTopLevel=!ownerCtContext,children=me.children,i=0,n=children.length;i<n;++i)children[i].init(!0);return me.hasRawContent=!(target.isContainer&&target.items.items.length>0),full?(me.widthModel=me.heightModel=null,sizeModel=target.getSizeModel(ownerCtContext&&ownerCtContext.widthModel.pairsByHeightOrdinal[ownerCtContext.heightModel.ordinal]),firstTime&&(me.sizeModel=sizeModel),me.widthModel=sizeModel.width,me.heightModel=sizeModel.height,ownerCtContext&&!me.isComponentChild&&(ownerCtContext.remainingChildDimensions+=2)):oldProps&&(me.recoverProp("x",oldProps,oldDirty),me.recoverProp("y",oldProps,oldDirty),me.widthModel.calculated?me.recoverProp("width",oldProps,oldDirty):"width"in oldProps&&++remainingCount,me.heightModel.calculated?me.recoverProp("height",oldProps,oldDirty):"height"in oldProps&&++remainingCount,ownerCtContext&&!me.isComponentChild&&(ownerCtContext.remainingChildDimensions+=remainingCount)),oldProps&&ownerLayout&&ownerLayout.manageMargins&&(me.recoverProp("margin-top",oldProps,oldDirty),me.recoverProp("margin-right",oldProps,oldDirty),me.recoverProp("margin-bottom",oldProps,oldDirty),me.recoverProp("margin-left",oldProps,oldDirty)),options&&(newHeightModel=options.heightModel,newWidthModel=options.widthModel,newWidthModel&&newHeightModel&&oldWidthModel&&oldHeightModel&&oldWidthModel.shrinkWrap&&oldHeightModel.shrinkWrap&&newWidthModel.constrainedMax&&newHeightModel.constrainedMin&&(newHeightModel=null),newWidthModel&&(me.widthModel=newWidthModel),newHeightModel&&(me.heightModel=newHeightModel),options.state&&Ext.apply(me.state,options.state)),ret},initContinue:function(full){var boxParent,me=this,ownerCtContext=me.ownerCtContext,comp=me.target,widthModel=me.widthModel,hierarchyState=comp.getHierarchyState();return widthModel.fixed?hierarchyState.inShrinkWrapTable=!1:delete hierarchyState.inShrinkWrapTable,full&&(ownerCtContext&&widthModel.shrinkWrap?(boxParent=ownerCtContext.isBoxParent?ownerCtContext:ownerCtContext.boxParent,boxParent&&boxParent.addBoxChild(me)):widthModel.natural&&(me.boxParent=ownerCtContext)),full},initDone:function(containerLayoutDone){var me=this,props=me.props,state=me.state;0===me.remainingChildDimensions&&(props.containerChildrenSizeDone=!0),containerLayoutDone&&(props.containerLayoutDone=!0),me.boxChildren&&me.boxChildren.length&&me.widthModel.shrinkWrap&&(me.el.setWidth(1e4),state.blocks=(state.blocks||0)+1)},initAnimation:function(){var me=this,target=me.target,ownerCtContext=me.ownerCtContext;ownerCtContext&&ownerCtContext.isTopLevel?me.animatePolicy=target.ownerLayout.getAnimatePolicy(me):!ownerCtContext&&target.isCollapsingOrExpanding&&target.animCollapse&&(me.animatePolicy=target.componentLayout.getAnimatePolicy(me)),me.animatePolicy&&me.context.queueAnimation(me)},addCls:function(newCls){this.getClassList().addMany(newCls)},removeCls:function(removeCls){this.getClassList().removeMany(removeCls)},addBlock:function(name,layout,propName){var me=this,collection=me[name]||(me[name]={}),blockedLayouts=collection[propName]||(collection[propName]={});blockedLayouts[layout.id]||(blockedLayouts[layout.id]=layout,++layout.blockCount,++me.context.blockCount)},addBoxChild:function(boxChildItem){var children,me=this,widthModel=boxChildItem.widthModel;boxChildItem.boxParent=this,boxChildItem.measuresBox=widthModel.shrinkWrap?boxChildItem.hasRawContent:widthModel.natural,boxChildItem.measuresBox&&(children=me.boxChildren,children?children.push(boxChildItem):me.boxChildren=[boxChildItem])},addPositionStyles:function(styles,props){var x=props.x,y=props.y,count=0;return void 0!==x&&(styles.left=x+"px",++count),void 0!==y&&(styles.top=y+"px",++count),count},addTrigger:function(propName,inDom){var me=this,name=inDom?"domTriggers":"triggers",collection=me[name]||(me[name]={}),context=me.context,layout=context.currentLayout,triggers=collection[propName]||(collection[propName]={});triggers[layout.id]||(triggers[layout.id]=layout,++layout.triggerCount,triggers=context.triggers[inDom?"dom":"data"],(triggers[layout.id]||(triggers[layout.id]=[])).push({item:this,prop:propName}),void 0!==me.props[propName]&&(inDom&&me.dirty&&propName in me.dirty||++layout.firedTriggers))},boxChildMeasured:function(){var me=this,state=me.state,count=state.boxesMeasured=(state.boxesMeasured||0)+1;count==me.boxChildren.length&&(state.clearBoxWidth=1,++me.context.progressCount,me.markDirty())},borderNames:["border-top-width","border-right-width","border-bottom-width","border-left-width"],marginNames:["margin-top","margin-right","margin-bottom","margin-left"],paddingNames:["padding-top","padding-right","padding-bottom","padding-left"],trblNames:["top","right","bottom","left"],cacheMissHandlers:{borderInfo:function(me){var info=me.getStyles(me.borderNames,me.trblNames);return info.width=info.left+info.right,info.height=info.top+info.bottom,info},marginInfo:function(me){var info=me.getStyles(me.marginNames,me.trblNames);return info.width=info.left+info.right,info.height=info.top+info.bottom,info},paddingInfo:function(me){var item=me.frameBodyContext||me,info=item.getStyles(me.paddingNames,me.trblNames);return info.width=info.left+info.right,info.height=info.top+info.bottom,info}},checkCache:function(entry){return this.cacheMissHandlers[entry](this)},clearAllBlocks:function(name){var propName,collection=this[name];if(collection)for(propName in collection)this.clearBlocks(name,propName)},clearBlocks:function(name,propName){var context,layout,layoutId,collection=this[name],blockedLayouts=collection&&collection[propName];if(blockedLayouts){delete collection[propName],context=this.context;for(layoutId in blockedLayouts)layout=blockedLayouts[layoutId],--context.blockCount,--layout.blockCount||layout.pending||layout.done||context.queueLayout(layout)}},block:function(layout,propName){this.addBlock("blocks",layout,propName)},domBlock:function(layout,propName){this.addBlock("domBlocks",layout,propName)},fireTriggers:function(name,propName){var layout,layoutId,collection=this[name],triggers=collection&&collection[propName],context=this.context;if(triggers)for(layoutId in triggers)layout=triggers[layoutId],++layout.firedTriggers,layout.done||layout.blockCount||layout.pending||context.queueLayout(layout)},flush:function(){var me=this,dirty=me.dirty,state=me.state,targetEl=me.el;me.dirtyCount=0,me.classList&&me.classList.dirty&&me.classList.flush(),"attributes"in me&&(targetEl.set(me.attributes),delete me.attributes),"innerHTML"in me&&(targetEl.innerHTML=me.innerHTML,delete me.innerHTML),state&&state.clearBoxWidth&&(state.clearBoxWidth=0,me.el.setStyle("width",null),--state.blocks||me.context.queueItemLayouts(me)),dirty&&(delete me.dirty,me.writeProps(dirty,!0))},flushAnimations:function(){var target,targetAnim,duration,animateProps,anim,changeCount,j,propsLen,propName,oldValue,newValue,me=this,animateFrom=me.previousSize;if(animateFrom){for(target=me.target,targetAnim=target.layout&&target.layout.animate,targetAnim&&(duration=Ext.isNumber(targetAnim)?targetAnim:targetAnim.duration),animateProps=Ext.Object.getKeys(me.animatePolicy),anim=Ext.apply({},{from:{},to:{},duration:duration||Ext.fx.Anim.prototype.duration},targetAnim),changeCount=0,j=0,propsLen=animateProps.length;j<propsLen;j++)propName=animateProps[j],oldValue=animateFrom[propName],newValue=me.peek(propName),oldValue!=newValue&&(propName=me.translateProps[propName]||propName,anim.from[propName]=oldValue,anim.to[propName]=newValue,++changeCount);changeCount&&(1===me.isCollapsingOrExpanding?target.componentLayout.undoLayout(me):me.writeProps(anim.from),me.el.animate(anim),Ext.fx.Manager.getFxQueue(me.el.id)[0].on({afteranimate:function(){1===me.isCollapsingOrExpanding?(target.componentLayout.redoLayout(me),target.afterCollapse(!0)):2===me.isCollapsingOrExpanding&&target.afterExpand(!0)}}))}},getBorderInfo:function(){var me=this,info=me.borderInfo;return info||(me.borderInfo=info=me.checkCache("borderInfo")),info},getClassList:function(){return this.classList||(this.classList=new Ext.layout.ClassList(this))},getEl:function(nameOrEl,owner){var src,el,elContext,me=this;if(nameOrEl){if(nameOrEl.dom)el=nameOrEl;else if(src=me.target,owner&&(src=owner),el=src[nameOrEl],"function"==typeof el&&(el=el.call(src),el===me.el))return this;el&&(elContext=me.context.getEl(me,el))}return elContext||null},getFrameInfo:function(){var framing,border,me=this,info=me.frameInfo;return info||(framing=me.framing,border=me.getBorderInfo(),me.frameInfo=info=framing?{top:framing.top+border.top,right:framing.right+border.right,bottom:framing.bottom+border.bottom,left:framing.left+border.left,width:framing.width+border.width,height:framing.height+border.height}:border),info},getMarginInfo:function(){var comp,manageMargins,margins,ownerLayout,ownerLayoutId,me=this,info=me.marginInfo;return info||(me.wrapsComponent?(comp=me.target,ownerLayout=comp.ownerLayout,ownerLayoutId=ownerLayout?ownerLayout.id:null,manageMargins=ownerLayout&&ownerLayout.manageMargins,info=comp.margin$,info&&info.ownerId!==ownerLayoutId&&(info=null),info||(info=me.parseMargins(comp,comp.margin)||me.checkCache("marginInfo"),manageMargins&&(margins=me.parseMargins(comp,comp.margins,ownerLayout.defaultMargins),margins&&(info={top:info.top+margins.top,right:info.right+margins.right,bottom:info.bottom+margins.bottom,left:info.left+margins.left}),me.setProp("margin-top",0),me.setProp("margin-right",0),me.setProp("margin-bottom",0),me.setProp("margin-left",0)),info.ownerId=ownerLayoutId,comp.margin$=info),info.width=info.left+info.right,info.height=info.top+info.bottom):info=me.checkCache("marginInfo"),me.marginInfo=info),info},clearMarginCache:function(){delete this.marginInfo,delete this.target.margin$},getPaddingInfo:function(){var me=this,info=me.paddingInfo;return info||(me.paddingInfo=info=me.checkCache("paddingInfo")),info},getProp:function(propName){var me=this,result=me.props[propName];return me.addTrigger(propName),result},getDomProp:function(propName){var me=this,result=me.dirty&&propName in me.dirty?void 0:me.props[propName];return me.addTrigger(propName,!0),result},getStyle:function(styleName){var info,value,me=this,styles=me.styles;return styleName in styles?value=styles[styleName]:(info=me.styleInfo[styleName],value=me.el.getStyle(styleName),info&&info.parseInt&&(value=parseInt(value,10)||0),styles[styleName]=value),value},getStyles:function(styleNames,altNames){var i,missing,missingAltNames,name,info,styleInfo,styles,value,me=this,styleCache=me.styles,values={},hits=0,n=styleNames.length;for(altNames=altNames||styleNames,i=0;i<n;++i)name=styleNames[i],name in styleCache?(values[altNames[i]]=styleCache[name],++hits,i&&1==hits&&(missing=styleNames.slice(0,i),missingAltNames=altNames.slice(0,i))):hits&&((missing||(missing=[])).push(name),(missingAltNames||(missingAltNames=[])).push(altNames[i]));if(hits<n)for(missing=missing||styleNames,missingAltNames=missingAltNames||altNames,styleInfo=me.styleInfo,styles=me.el.getStyle(missing),i=missing.length;i--;)name=missing[i],info=styleInfo[name],value=styles[name],info&&info.parseInt&&(value=parseInt(value,10)||0),values[missingAltNames[i]]=value,styleCache[name]=value;return values},hasProp:function(propName){return null!=this.getProp(propName)},hasDomProp:function(propName){return null!=this.getDomProp(propName)},invalidate:function(options){this.context.queueInvalidate(this,options)},markDirty:function(){1==++this.dirtyCount&&this.context.queueFlush(this)},onBoxMeasured:function(){var boxParent=this.boxParent,state=this.state;boxParent&&boxParent.widthModel.shrinkWrap&&!state.boxMeasured&&this.measuresBox&&(state.boxMeasured=1,boxParent.boxChildMeasured())},parseMargins:function(comp,margins,defaultMargins){margins===!0&&(margins=5);var ret,type=typeof margins;return"string"==type||"number"==type?ret=comp.parseBox(margins):(margins||defaultMargins)&&(ret={top:0,right:0,bottom:0,left:0},defaultMargins&&Ext.apply(ret,this.parseMargins(comp,defaultMargins)),margins&&(margins=Ext.apply(ret,comp.parseBox(margins)))),ret},peek:function(propName){return this.props[propName]},recoverProp:function(propName,oldProps,oldDirty){var dirty,me=this,props=me.props;propName in oldProps&&(props[propName]=oldProps[propName],oldDirty&&propName in oldDirty&&(dirty=me.dirty||(me.dirty={}),dirty[propName]=oldDirty[propName]))},redo:function(deep){var items,len,i,me=this;if(me.revertProps(me.props),deep&&me.wrapsComponent){if(me.childItems)for(i=0,items=me.childItems,len=items.length;i<len;i++)items[i].redo(deep);for(i=0,items=me.children,len=items.length;i<len;i++)items[i].redo()}},removeEl:function(nameOrEl,owner){var src,el,me=this;if(nameOrEl){if(nameOrEl.dom)el=nameOrEl;else if(src=me.target,owner&&(src=owner),el=src[nameOrEl],"function"==typeof el&&(el=el.call(src),el===me.el))return this;el&&me.context.removeEl(me,el)}},revertProps:function(props){var name,flushed=this.flushedProps,reverted={};for(name in props)flushed.hasOwnProperty(name)&&(reverted[name]=props[name]);this.writeProps(reverted)},setAttribute:function(name,value){var me=this;me.attributes||(me.attributes={}),me.attributes[name]=value,me.markDirty()},setBox:function(box){var me=this;"left"in box&&me.setProp("x",box.left),"top"in box&&me.setProp("y",box.top),me.setSize(box.width,box.height)},setContentHeight:function(height,measured){return!measured&&this.hasRawContent?1:this.setProp("contentHeight",height)},setContentWidth:function(width,measured){return!measured&&this.hasRawContent?1:this.setProp("contentWidth",width)},setContentSize:function(width,height,measured){return this.setContentWidth(width,measured)+this.setContentHeight(height,measured)==2},setProp:function(propName,value,dirty){var borderBox,info,me=this,valueType=typeof value;return"undefined"==valueType||"number"===valueType&&isNaN(value)?0:me.props[propName]===value?1:(me.props[propName]=value,++me.context.progressCount,dirty===!1?(me.fireTriggers("domTriggers",propName),me.clearBlocks("domBlocks",propName)):(info=me.styleInfo[propName],info&&(me.dirty||(me.dirty={}),"width"!=propName&&"height"!=propName||(borderBox=me.isBorderBoxValue,null===borderBox&&(me.isBorderBoxValue=borderBox=!!me.el.isBorderBox()),borderBox||(me.borderInfo||me.getBorderInfo(),me.paddingInfo||me.getPaddingInfo())),me.dirty[propName]=value,me.markDirty())),me.fireTriggers("triggers",propName),me.clearBlocks("blocks",propName),1)},setHeight:function(height,dirty){var frameBody,frameInfo,min,oldHeight,rem,me=this,comp=me.target,ownerCtContext=me.ownerCtContext;if(height<0&&(height=0),me.wrapsComponent){if(min=me.collapsedVert?0:comp.minHeight||0,height=Ext.Number.constrain(height,min,comp.maxHeight),oldHeight=me.props.height,!me.setProp("height",height,dirty))return NaN;ownerCtContext&&!me.isComponentChild&&isNaN(oldHeight)&&(rem=--ownerCtContext.remainingChildDimensions,rem||ownerCtContext.setProp("containerChildrenSizeDone",!0)),frameBody=me.frameBodyContext,frameBody&&(frameInfo=me.getFrameInfo(),frameBody.setHeight(height-frameInfo.height,dirty))}else if(!me.setProp("height",height,dirty))return NaN;return height},setWidth:function(width,dirty){var frameBody,frameInfo,min,oldWidth,rem,me=this,comp=me.target,ownerCtContext=me.ownerCtContext;if(width<0&&(width=0),me.wrapsComponent){if(min=me.collapsedHorz?0:comp.minWidth||0,width=Ext.Number.constrain(width,min,comp.maxWidth),oldWidth=me.props.width,!me.setProp("width",width,dirty))return NaN;ownerCtContext&&!me.isComponentChild&&isNaN(oldWidth)&&(rem=--ownerCtContext.remainingChildDimensions,rem||ownerCtContext.setProp("containerChildrenSizeDone",!0)),frameBody=me.frameBodyContext,frameBody&&(frameInfo=me.getFrameInfo(),frameBody.setWidth(width-frameInfo.width,dirty))}else if(!me.setProp("width",width,dirty))return NaN;return width},setSize:function(width,height,dirty){this.setWidth(width,dirty),this.setHeight(height,dirty)},translateProps:{x:"left",y:"top"},undo:function(deep){var items,len,i,me=this;if(me.revertProps(me.lastBox),deep&&me.wrapsComponent){if(me.childItems)for(i=0,items=me.childItems,len=items.length;i<len;i++)items[i].undo(deep);for(i=0,items=me.children,len=items.length;i<len;i++)items[i].undo()}},unsetProp:function(propName){var dirty=this.dirty;delete this.props[propName],dirty&&delete dirty[propName]},writeProps:function(dirtyProps,flushing){if(dirtyProps&&"object"==typeof dirtyProps){var info,propName,numericValue,hasWidth,hasHeight,isAbsolute,scrollbarSize,style,targetEl,me=this,el=me.el,styles={},styleCount=0,styleInfo=me.styleInfo,width=dirtyProps.width,height=dirtyProps.height,isBorderBox=me.isBorderBoxValue,target=me.target,max=Math.max,paddingWidth=0,paddingHeight=0;"displayed"in dirtyProps&&el.setDisplayed(dirtyProps.displayed);for(propName in dirtyProps)flushing&&(me.fireTriggers("domTriggers",propName),me.clearBlocks("domBlocks",propName),me.flushedProps[propName]=1),info=styleInfo[propName],info&&info.dom&&(info.suffix&&(numericValue=parseInt(dirtyProps[propName],10))?styles[propName]=numericValue+info.suffix:styles[propName]=dirtyProps[propName],++styleCount);("x"in dirtyProps||"y"in dirtyProps)&&(target.isComponent?target.setPosition(dirtyProps.x,dirtyProps.y):styleCount+=me.addPositionStyles(styles,dirtyProps)),!isBorderBox&&(width>0||height>0)&&(me.frameBodyContext||(paddingWidth=me.paddingInfo.width,paddingHeight=me.paddingInfo.height),width&&(width=max(parseInt(width,10)-(me.borderInfo.width+paddingWidth),0),styles.width=width+"px",++styleCount),height&&(height=max(parseInt(height,10)-(me.borderInfo.height+paddingHeight),0),styles.height=height+"px",++styleCount)),me.wrapsComponent&&Ext.isIE9&&Ext.isStrict&&((hasWidth=void 0!==width&&me.hasOverflowY)||(hasHeight=void 0!==height&&me.hasOverflowX))&&(isAbsolute=me.isAbsolute,void 0===isAbsolute&&(isAbsolute=!1,targetEl=me.target.getTargetEl(),style=targetEl.getStyle("position"),"absolute"==style&&(style=targetEl.getStyle("box-sizing"),isAbsolute="border-box"==style),me.isAbsolute=isAbsolute),isAbsolute&&(scrollbarSize=Ext.getScrollbarSize(),hasWidth&&(width=parseInt(width,10)+scrollbarSize.width,styles.width=width+"px",++styleCount),hasHeight&&(height=parseInt(height,10)+scrollbarSize.height,styles.height=height+"px",++styleCount))),styleCount&&el.setStyle(styles)}}},function(){var px={dom:!0,parseInt:!0,suffix:"px"},isDom={dom:!0},faux={dom:!1};this.prototype.styleInfo={containerChildrenSizeDone:faux,containerLayoutDone:faux,displayed:faux,done:faux,x:faux,y:faux,columnWidthsDone:faux,left:px,top:px,right:px,bottom:px,width:px,height:px,"border-top-width":px,"border-right-width":px,"border-bottom-width":px,"border-left-width":px,"margin-top":px,"margin-right":px,"margin-bottom":px,"margin-left":px,"padding-top":px,"padding-right":px,"padding-bottom":px,"padding-left":px,"line-height":isDom,display:isDom}}),Ext.define("Ext.layout.Context",{remainingLayouts:0,state:0,constructor:function(config){var me=this;Ext.apply(me,config),me.items={},me.layouts={},me.blockCount=0,me.cycleCount=0,me.flushCount=0,me.calcCount=0,me.animateQueue=me.newQueue(),me.completionQueue=me.newQueue(),me.finalizeQueue=me.newQueue(),me.finishQueue=me.newQueue(),me.flushQueue=me.newQueue(),me.invalidateData={},me.layoutQueue=me.newQueue(),me.invalidQueue=[],me.triggers={data:{},dom:{}}},callLayout:function(layout,methodName){this.currentLayout=layout,layout[methodName](this.getCmp(layout.owner))},cancelComponent:function(comp,isChild,isDestroying){var i,k,klen,items,layout,newQueue,oldQueue,entry,temp,ownerCtContext,me=this,components=comp,isArray=!comp.isComponent,length=isArray?components.length:1;for(i=0;i<length;++i){if(isArray&&(comp=components[i]),isDestroying&&comp.ownerCt&&(ownerCtContext=this.items[comp.ownerCt.el.id],ownerCtContext&&Ext.Array.remove(ownerCtContext.childItems,me.getCmp(comp))),!isChild&&(oldQueue=me.invalidQueue,klen=oldQueue.length))for(me.invalidQueue=newQueue=[],k=0;k<klen;++k)entry=oldQueue[k],temp=entry.item.target,temp==comp||temp.isDescendant(comp)||newQueue.push(entry);layout=comp.componentLayout,me.cancelLayout(layout),layout.getLayoutItems&&(items=layout.getLayoutItems(),items.length&&me.cancelComponent(items,!0)),comp.isContainer&&!comp.collapsed&&(layout=comp.layout,me.cancelLayout(layout),items=layout.getVisibleItems(),items.length&&me.cancelComponent(items,!0))}},cancelLayout:function(layout){var me=this;me.completionQueue.remove(layout),me.finalizeQueue.remove(layout),me.finishQueue.remove(layout),me.layoutQueue.remove(layout),layout.running&&me.layoutDone(layout),layout.ownerContext=null},clearTriggers:function(layout,inDom){var i,item,trigger,id=layout.id,collection=this.triggers[inDom?"dom":"data"],triggers=collection&&collection[id],length=triggers&&triggers.length||0;for(i=0;i<length;++i)trigger=triggers[i],item=trigger.item,collection=inDom?item.domTriggers:item.triggers,delete collection[trigger.prop][id]},flush:function(){var i,me=this,items=me.flushQueue.clear(),length=items.length;if(length)for(++me.flushCount,i=0;i<length;++i)items[i].flush()},flushAnimations:function(){var i,me=this,items=me.animateQueue.clear(),len=items.length;if(len){for(i=0;i<len;i++)items[i].target.animate!==!1&&items[i].flushAnimations();Ext.fx.Manager.runner()}},flushInvalidates:function(){var comp,components,entry,i,me=this,queue=me.invalidQueue,length=queue&&queue.length;if(me.invalidQueue=[],length){for(components=[],i=0;i<length;++i)comp=(entry=queue[i]).item.target,comp.container.isDetachedBody||(components.push(comp),entry.options&&(me.invalidateData[comp.id]=entry.options));me.invalidate(components,null)}},flushLayouts:function(queueName,methodName,dontClear){var i,layout,me=this,layouts=dontClear?me[queueName].items:me[queueName].clear(),length=layouts.length;if(length){for(i=0;i<length;++i)layout=layouts[i],layout.running||me.callLayout(layout,methodName);me.currentLayout=null}},getCmp:function(cmp){return this.getItem(cmp,cmp.el)},getEl:function(parent,el){var item=this.getItem(el,el);return item.parent||(item.parent=parent,parent.children.length?parent.children.push(item):parent.children=[item]),item},getItem:function(target,el){var id=el.id,items=this.items,item=items[id]||(items[id]=new Ext.layout.ContextItem({context:this,target:target,el:el}));return item},handleFailure:function(){var layout,key,layouts=this.layouts;Ext.failedLayouts=(Ext.failedLayouts||0)+1;for(key in layouts)layout=layouts[key],layouts.hasOwnProperty(key)&&(layout.running=!1,layout.ownerContext=null)},invalidate:function(components,full){var containerLayoutDone,firstTime,i,comp,item,items,length,componentLayout,layout,invalidateOptions,token,me=this,isArray=!components.isComponent;for(i=0,length=isArray?components.length:1;i<length;++i)comp=isArray?components[i]:components,comp.rendered&&!comp.hidden&&(item=me.getCmp(comp),componentLayout=comp.componentLayout,firstTime=!componentLayout.ownerContext,layout=comp.isContainer&&!comp.collapsed?comp.layout:null,invalidateOptions=me.invalidateData[item.id],delete me.invalidateData[item.id],token=item.init(full,invalidateOptions),invalidateOptions&&me.processInvalidate(invalidateOptions,item,"before"),componentLayout.beforeLayoutCycle&&componentLayout.beforeLayoutCycle(item),layout&&layout.beforeLayoutCycle&&layout.beforeLayoutCycle(item),token=item.initContinue(token),containerLayoutDone=!0,componentLayout.getLayoutItems&&(componentLayout.renderChildren(),items=componentLayout.getLayoutItems(),items.length&&me.invalidate(items,!0)),layout&&(containerLayoutDone=!1,layout.renderChildren(),items=layout.getVisibleItems(),items.length&&me.invalidate(items,!0)),item.initDone(containerLayoutDone),me.resetLayout(componentLayout,item,firstTime),layout&&me.resetLayout(layout,item,firstTime),item.initAnimation(),invalidateOptions&&me.processInvalidate(invalidateOptions,item,"after"));me.currentLayout=null},layoutDone:function(layout){var ownerContext=layout.ownerContext;layout.running=!1,layout.isComponentLayout?(ownerContext.measuresBox&&ownerContext.onBoxMeasured(),ownerContext.setProp("done",!0)):ownerContext.setProp("containerLayoutDone",!0),--this.remainingLayouts,++this.progressCount},newQueue:function(){return new Ext.util.Queue},processInvalidate:function(options,item,name){if(options[name]){var me=this,currentLayout=me.currentLayout;me.currentLayout=options.layout||null,options[name](item,options),me.currentLayout=currentLayout}},queueAnimation:function(item){this.animateQueue.add(item)},queueCompletion:function(layout){this.completionQueue.add(layout)},queueFinalize:function(layout){this.finalizeQueue.add(layout)},queueFlush:function(item){this.flushQueue.add(item)},chainFns:function(oldOptions,newOptions,funcName){var me=this,oldLayout=oldOptions.layout,newLayout=newOptions.layout,oldFn=oldOptions[funcName],newFn=newOptions[funcName];return function(contextItem){var prev=me.currentLayout;oldFn&&(me.currentLayout=oldLayout,oldFn.call(oldOptions.scope||oldOptions,contextItem,oldOptions)),me.currentLayout=newLayout,newFn.call(newOptions.scope||newOptions,contextItem,newOptions),me.currentLayout=prev}},queueInvalidate:function(item,options){var comp,old,oldComp,oldOptions,oldState,me=this,newQueue=[],oldQueue=me.invalidQueue,index=oldQueue.length;for(item.isComponent?item=me.getCmp(comp=item):comp=item.target,item.invalid=!0;index--;){if(old=oldQueue[index],oldComp=old.item.target,comp.isDescendant(oldComp))return;if(oldComp==comp)return void((oldOptions=old.options)?options&&(options.widthModel&&(oldOptions.widthModel=options.widthModel),options.heightModel&&(oldOptions.heightModel=options.heightModel),(oldState=oldOptions.state)?options.state&&Ext.apply(oldState,options.state):oldOptions.state=options.state,options.before&&(oldOptions.before=me.chainFns(oldOptions,options,"before")),options.after&&(oldOptions.after=me.chainFns(oldOptions,options,"after"))):old.options=options);oldComp.isDescendant(comp)||newQueue.push(old)}newQueue.push({item:item,options:options}),me.invalidQueue=newQueue},queueItemLayouts:function(item){var comp=item.isComponent?item:item.target,layout=comp.componentLayout;layout.pending||layout.invalid||layout.done||this.queueLayout(layout),layout=comp.layout,!layout||layout.pending||layout.invalid||layout.done||this.queueLayout(layout)},queueLayout:function(layout){this.layoutQueue.add(layout),layout.pending=!0},removeEl:function(parent,el){var id=el.id,children=parent.children,items=this.items;children&&Ext.Array.remove(children,items[id]),delete items[id]},resetLayout:function(layout,ownerContext,firstTime){var me=this;me.currentLayout=layout,layout.done=!1,layout.pending=!0,layout.firedTriggers=0,me.layoutQueue.add(layout),firstTime?(me.layouts[layout.id]=layout,layout.running=!0,layout.finishedLayout&&me.finishQueue.add(layout),++me.remainingLayouts,++layout.layoutCount,layout.ownerContext=ownerContext,layout.beginCount=0,layout.blockCount=0,layout.calcCount=0,layout.triggerCount=0,layout.initialized||layout.initLayout(),layout.beginLayout(ownerContext)):(++layout.beginCount,layout.running||(++me.remainingLayouts,layout.running=!0,layout.isComponentLayout&&ownerContext.unsetProp("done"),me.completionQueue.remove(layout),me.finalizeQueue.remove(layout))),layout.beginLayoutCycle(ownerContext,firstTime)},run:function(){var me=this,flushed=!1,watchDog=100;for(me.flushInvalidates(),me.state=1,me.totalCount=me.layoutQueue.getCount(),me.flush();(me.remainingLayouts||me.invalidQueue.length)&&watchDog--;){if(me.invalidQueue.length&&me.flushInvalidates(),me.runCycle())flushed=!1;else if(flushed){if(!me.invalidQueue.length){me.state=2;break}}else me.flush(),flushed=!0,me.flushLayouts("completionQueue","completeLayout");me.remainingLayouts||me.invalidQueue.length||(me.flush(),me.flushLayouts("completionQueue","completeLayout"),me.flushLayouts("finalizeQueue","finalizeLayout"))}return me.runComplete()},runComplete:function(){var me=this;return me.state=2,me.remainingLayouts?(me.handleFailure(),!1):(me.flush(),me.flushLayouts("finishQueue","finishedLayout",!0),me.flushLayouts("finishQueue","notifyOwner"),me.flush(),me.flushAnimations(),!0)},runCycle:function(){var i,me=this,layouts=me.layoutQueue.clear(),length=layouts.length;for(++me.cycleCount,me.progressCount=0,i=0;i<length;++i)me.runLayout(me.currentLayout=layouts[i]);return me.currentLayout=null,me.progressCount>0},runLayout:function(layout){var me=this,ownerContext=me.getCmp(layout.owner);layout.pending=!1,ownerContext.state.blocks||(layout.done=!0,++layout.calcCount,++me.calcCount,layout.calculate(ownerContext),layout.done?(me.layoutDone(layout),layout.completeLayout&&me.queueCompletion(layout),layout.finalizeLayout&&me.queueFinalize(layout)):layout.pending||layout.invalid||layout.blockCount+layout.triggerCount-layout.firedTriggers||me.queueLayout(layout))},setItemSize:function(item,width,height){var contextItem,i,items=item,len=1;for(item.isComposite?(items=item.elements,len=items.length,item=items[0]):item.dom||item.el||(len=items.length,item=items[0]),i=0;i<len;)contextItem=this.get(item),contextItem.setSize(width,height),item=items[++i]}}),Ext.define("Ext.layout.component.Body",{alias:["layout.body"],extend:Ext.layout.component.Auto,type:"body",beginLayout:function(ownerContext){this.callParent(arguments),ownerContext.bodyContext=ownerContext.getEl("body")},beginLayoutCycle:function(ownerContext,firstCycle){var me=this,lastWidthModel=me.lastWidthModel,lastHeightModel=me.lastHeightModel,body=me.owner.body;me.callParent(arguments),lastWidthModel&&lastWidthModel.fixed&&ownerContext.widthModel.shrinkWrap&&body.setWidth(null),lastHeightModel&&lastHeightModel.fixed&&ownerContext.heightModel.shrinkWrap&&body.setHeight(null)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){var height=this.callParent(arguments);return ownerContext.targetContext!=ownerContext&&(height+=ownerContext.getPaddingInfo().height),height},calculateOwnerWidthFromContentWidth:function(ownerContext,contentWidth){var width=this.callParent(arguments);return ownerContext.targetContext!=ownerContext&&(width+=ownerContext.getPaddingInfo().width),width},measureContentWidth:function(ownerContext){return ownerContext.bodyContext.setWidth(ownerContext.bodyContext.el.dom.offsetWidth,!1)},measureContentHeight:function(ownerContext){return ownerContext.bodyContext.setHeight(ownerContext.bodyContext.el.dom.offsetHeight,!1)},publishInnerHeight:function(ownerContext,height){var innerHeight=height-ownerContext.getFrameInfo().height,targetContext=ownerContext.targetContext;return targetContext!=ownerContext&&(innerHeight-=ownerContext.getPaddingInfo().height),ownerContext.bodyContext.setHeight(innerHeight,!ownerContext.heightModel.natural)},publishInnerWidth:function(ownerContext,width){var innerWidth=width-ownerContext.getFrameInfo().width,targetContext=ownerContext.targetContext;targetContext!=ownerContext&&(innerWidth-=ownerContext.getPaddingInfo().width),ownerContext.bodyContext.setWidth(innerWidth,!ownerContext.widthModel.natural)}}),Ext.define("Ext.layout.component.FieldSet",{extend:Ext.layout.component.Body,alias:["layout.fieldset"],type:"fieldset",defaultCollapsedWidth:100,beforeLayoutCycle:function(ownerContext){ownerContext.target.collapsed&&(ownerContext.heightModel=this.sizeModels.shrinkWrap)},beginLayoutCycle:function(ownerContext){var lastSize,target=ownerContext.target;this.callParent(arguments),target.collapsed&&(ownerContext.setContentHeight(0),ownerContext.restoreMinHeight=target.minHeight,delete target.minHeight,ownerContext.widthModel.shrinkWrap&&(lastSize=target.lastComponentSize,
ownerContext.setContentWidth(lastSize&&lastSize.contentWidth||this.defaultCollapsedWidth)))},finishedLayout:function(ownerContext){var owner=this.owner,restore=ownerContext.restoreMinHeight;this.callParent(arguments),restore&&(owner.minHeight=restore)},calculateOwnerHeightFromContentHeight:function(ownerContext,contentHeight){var border=ownerContext.getBorderInfo(),legend=ownerContext.target.legend;return ownerContext.getProp("contentHeight")+ownerContext.getPaddingInfo().height+(Ext.isIEQuirks||Ext.isIE8m?ownerContext.bodyContext.getPaddingInfo().top:0)+(legend?legend.getHeight():border.top)+border.bottom},publishInnerHeight:function(ownerContext,height){var legend=ownerContext.target.legend;legend&&(height-=legend.getHeight()),this.callParent([ownerContext,height])},getLayoutItems:function(){var legend=this.owner.legend;return legend?[legend]:[]}}),Ext.define("Ext.layout.component.field.Slider",{alias:["layout.sliderfield"],extend:Ext.layout.component.field.Field,type:"sliderfield",beginLayout:function(ownerContext){this.callParent(arguments),ownerContext.endElContext=ownerContext.getEl("endEl"),ownerContext.innerElContext=ownerContext.getEl("innerEl"),ownerContext.bodyElContext=ownerContext.getEl("bodyEl")},publishInnerHeight:function(ownerContext,height){var endElPad,inputPad,innerHeight=height-this.measureLabelErrorHeight(ownerContext);this.owner.vertical?(endElPad=ownerContext.endElContext.getPaddingInfo(),inputPad=ownerContext.inputContext.getPaddingInfo(),ownerContext.innerElContext.setHeight(innerHeight-inputPad.height-endElPad.height)):ownerContext.bodyElContext.setHeight(innerHeight)},publishInnerWidth:function(ownerContext,width){if(!this.owner.vertical){var endElPad=ownerContext.endElContext.getPaddingInfo(),inputPad=ownerContext.inputContext.getPaddingInfo();ownerContext.innerElContext.setWidth(width-inputPad.left-endElPad.right-ownerContext.labelContext.getProp("width"))}},beginLayoutFixed:function(ownerContext,width,suffix){var me=this,ieInputWidthAdjustment=me.ieInputWidthAdjustment;ieInputWidthAdjustment&&me.owner.bodyEl.setStyle("padding-right",ieInputWidthAdjustment+"px"),me.callParent(arguments)}}),Ext.define("Ext.layout.container.Absolute",{alias:"layout.absolute",extend:Ext.layout.container.Anchor,alternateClassName:"Ext.layout.AbsoluteLayout",targetCls:Ext.baseCSSPrefix+"abs-layout-ct",itemCls:Ext.baseCSSPrefix+"abs-layout-item",ignoreOnContentChange:!0,type:"absolute",adjustWidthAnchor:function(value,childContext){var padding=this.targetPadding,x=childContext.getStyle("left");return value-x+padding.left},adjustHeightAnchor:function(value,childContext){var padding=this.targetPadding,y=childContext.getStyle("top");return value-y+padding.top},isItemLayoutRoot:function(item){return this.ignoreOnContentChange||this.callParent(arguments)},isItemShrinkWrap:function(item){return!0},beginLayout:function(ownerContext){var me=this,target=me.getTarget();me.callParent(arguments),target.dom!==document.body&&target.position(),me.targetPadding=ownerContext.targetContext.getPaddingInfo()},isItemBoxParent:function(itemContext){return!0},onContentChange:function(){return!this.ignoreOnContentChange&&this.callParent(arguments)},calculateContentSize:function(ownerContext,dimensions){var targetPadding,child,childContext,height,i,margins,width,me=this,containerDimensions=(dimensions||0)|((ownerContext.widthModel.shrinkWrap?1:0)|(ownerContext.heightModel.shrinkWrap?2:0)),calcWidth=1&containerDimensions||void 0,calcHeight=2&containerDimensions||void 0,childItems=ownerContext.childItems,length=childItems.length,contentHeight=0,contentWidth=0,needed=0,props=ownerContext.props;if(calcWidth&&(isNaN(props.contentWidth)?++needed:calcWidth=void 0),calcHeight&&(isNaN(props.contentHeight)?++needed:calcHeight=void 0),needed){for(i=0;i<length;++i)if(childContext=childItems[i],child=childContext.target,height=calcHeight&&childContext.getProp("height"),width=calcWidth&&childContext.getProp("width"),margins=childContext.getMarginInfo(),height+=margins.bottom,width+=margins.right,contentHeight=Math.max(contentHeight,(child.y||0)+height),contentWidth=Math.max(contentWidth,(child.x||0)+width),isNaN(contentHeight)&&isNaN(contentWidth))return void(me.done=!1);(calcWidth||calcHeight)&&(targetPadding=ownerContext.targetContext.getPaddingInfo()),calcWidth&&!ownerContext.setContentWidth(contentWidth+targetPadding.width)&&(me.done=!1),calcHeight&&!ownerContext.setContentHeight(contentHeight+targetPadding.height)&&(me.done=!1)}}}),Ext.define("Ext.layout.container.Accordion",{extend:Ext.layout.container.VBox,alias:["layout.accordion"],alternateClassName:"Ext.layout.AccordionLayout",targetCls:Ext.baseCSSPrefix+"accordion-layout-ct",itemCls:[Ext.baseCSSPrefix+"box-item",Ext.baseCSSPrefix+"accordion-item"],align:"stretch",fill:!0,titleCollapse:!0,hideCollapseTool:!1,collapseFirst:void 0,animate:!0,activeOnTop:!1,multi:!1,defaultAnimatePolicy:{y:!0,height:!0},constructor:function(){var me=this;me.callParent(arguments),!me.multi&&me.animate?me.animatePolicy=Ext.apply({},me.defaultAnimatePolicy):me.animatePolicy=null},beforeRenderItems:function(items){for(var comp,me=this,ln=items.length,i=0,owner=me.owner,collapseFirst=me.collapseFirst,hasCollapseFirst=Ext.isDefined(collapseFirst),expandedItem=me.getExpanded(!0)[0],multi=me.multi;i<ln;i++)comp=items[i],comp.rendered||(multi&&comp.collapsible===!1||(comp.collapsible=!0),comp.collapsible&&(hasCollapseFirst&&(comp.collapseFirst=collapseFirst),me.hideCollapseTool?(comp.hideCollapseTool=me.hideCollapseTool,comp.titleCollapse=!0):me.titleCollapse&&void 0===comp.titleCollapse&&(comp.titleCollapse=me.titleCollapse)),delete comp.hideHeader,delete comp.width,comp.title=comp.title||"&#160;",comp.addBodyCls(Ext.baseCSSPrefix+"accordion-body"),multi||(expandedItem?comp.collapsed=expandedItem!==comp:comp.hasOwnProperty("collapsed")&&comp.collapsed===!1?expandedItem=comp:comp.collapsed=!0,owner.mon(comp,"show",me.onComponentShow,me)),comp.headerOverCls=Ext.baseCSSPrefix+"accordion-hd-over");me.processing||multi||(expandedItem?me.activeOnTop&&(expandedItem.collapsed=!1,me.configureItem(expandedItem),owner.items.indexOf(expandedItem)>0&&owner.insert(0,expandedItem)):ln&&(items[0].collapsed=!1))},getItemsRenderTree:function(items){return this.beforeRenderItems(items),this.callParent(arguments)},renderItems:function(items,target){this.beforeRenderItems(items),this.callParent(arguments)},configureItem:function(item){this.callParent(arguments),item.animCollapse=item.border=!1,this.fill&&(item.flex=1)},beginLayout:function(ownerContext){this.callParent(arguments),this.updatePanelClasses(ownerContext)},updatePanelClasses:function(ownerContext){var i,child,header,children=ownerContext.visibleItems,ln=children.length,siblingCollapsed=!0;for(i=0;i<ln;i++)child=children[i],header=child.header,header.addCls(Ext.baseCSSPrefix+"accordion-hd"),siblingCollapsed?header.removeCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded"):header.addCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded"),i+1==ln&&child.collapsed?header.addCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed"):header.removeCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed"),siblingCollapsed=child.collapsed},onBeforeComponentExpand:function(toExpand){var expanded,previousValue,me=this,owner=me.owner,multi=me.multi,moveToTop=(me.animate,!multi&&!me.animate&&me.activeOnTop);me.processing||(me.processing=!0,previousValue=owner.deferLayouts,owner.deferLayouts=!0,multi||(expanded=me.getExpanded()[0],expanded&&expanded!==toExpand&&expanded.collapse()),moveToTop&&(Ext.suspendLayouts(),owner.insert(0,toExpand),Ext.resumeLayouts()),owner.deferLayouts=previousValue,me.processing=!1)},onBeforeComponentCollapse:function(comp){var toExpand,expanded,previousValue,me=this,owner=me.owner;return 1!==me.owner.items.getCount()&&void(me.processing||(me.processing=!0,previousValue=owner.deferLayouts,owner.deferLayouts=!0,toExpand=comp.next()||comp.prev(),me.multi?(expanded=me.getExpanded(),1===expanded.length&&toExpand.expand()):toExpand&&toExpand.expand(),owner.deferLayouts=previousValue,me.processing=!1))},onComponentShow:function(comp){this.onBeforeComponentExpand(comp)},onRemove:function(panel,isDestroying){var item,me=this;me.callParent(arguments),me.owner.destroying||me.multi||panel.collapsed||(item=me.owner.items.first(),item&&item.expand())},getExpanded:function(explicitCheck){for(var add,item,items=this.owner.items.items,len=items.length,i=0,out=[];i<len;++i)item=items[i],item.hidden||(add=explicitCheck?item.hasOwnProperty("collapsed")&&item.collapsed===!1:!item.collapsed,add&&out.push(item));return out}}),Ext.define("Ext.resizer.Splitter",{extend:Ext.Component,alias:"widget.splitter",childEls:["collapseEl"],renderTpl:['<tpl if="collapsible===true">','<div id="{id}-collapseEl" role="presentation" class="',Ext.baseCSSPrefix,"collapse-el ",Ext.baseCSSPrefix,'layout-split-{collapseDir}{childElCls}">&#160;',"</div>","</tpl>"],baseCls:Ext.baseCSSPrefix+"splitter",collapsedClsInternal:Ext.baseCSSPrefix+"splitter-collapsed",canResize:!0,collapsible:!1,collapseOnDblClick:!0,defaultSplitMin:40,defaultSplitMax:1e3,collapseTarget:"next",horizontal:!1,vertical:!1,size:5,ariaRole:"separator",getTrackerConfig:function(){return{xclass:"Ext.resizer.SplitterTracker",el:this.el,splitter:this}},beforeRender:function(){var me=this,target=me.getCollapseTarget();me.callParent(),target.collapsed&&me.addCls(me.collapsedClsInternal),me.canResize||me.addCls(me.baseCls+"-noresize"),Ext.applyIf(me.renderData,{collapseDir:me.getCollapseDirection(),collapsible:me.collapsible||target.collapsible}),me.protoEl.unselectable()},onRender:function(){var collapseEl,me=this;me.callParent(arguments),me.performCollapse!==!1&&(me.renderData.collapsible&&me.mon(me.collapseEl,"click",me.toggleTargetCmp,me),me.collapseOnDblClick&&me.mon(me.el,"dblclick",me.toggleTargetCmp,me)),me.mon(me.getCollapseTarget(),{collapse:me.onTargetCollapse,expand:me.onTargetExpand,beforeexpand:me.onBeforeTargetExpand,beforecollapse:me.onBeforeTargetCollapse,scope:me}),me.canResize&&(me.tracker=Ext.create(me.getTrackerConfig()),me.relayEvents(me.tracker,["beforedragstart","dragstart","dragend"])),collapseEl=me.collapseEl,collapseEl&&(collapseEl.lastCollapseDirCls=me.collapseDirProps[me.collapseDirection].cls)},getCollapseDirection:function(){var collapseTarget,idx,items,type,me=this,dir=me.collapseDirection;return dir||(collapseTarget=me.collapseTarget,collapseTarget.isComponent&&(dir=collapseTarget.collapseDirection),dir||(type=me.ownerCt.layout.type,collapseTarget.isComponent?(items=me.ownerCt.items,idx=Number(items.indexOf(collapseTarget)===items.indexOf(me)-1)<<1|Number("hbox"===type)):idx=Number("prev"===me.collapseTarget)<<1|Number("hbox"===type),dir=["bottom","right","top","left"][idx]),me.collapseDirection=dir),me.setOrientation("top"===dir||"bottom"===dir?"horizontal":"vertical"),dir},getCollapseTarget:function(){var me=this;return me.collapseTarget.isComponent?me.collapseTarget:"prev"===me.collapseTarget?me.previousSibling():me.nextSibling()},setCollapseEl:function(display){var el=this.collapseEl;el&&el.setDisplayed(display)},onBeforeTargetExpand:function(target){this.setCollapseEl("none")},onBeforeTargetCollapse:function(){this.setCollapseEl("none")},onTargetCollapse:function(target){this.el.addCls([this.collapsedClsInternal,this.collapsedCls]),this.setCollapseEl("")},onTargetExpand:function(target){this.el.removeCls([this.collapsedClsInternal,this.collapsedCls]),this.setCollapseEl("")},collapseDirProps:{top:{cls:Ext.baseCSSPrefix+"layout-split-top"},right:{cls:Ext.baseCSSPrefix+"layout-split-right"},bottom:{cls:Ext.baseCSSPrefix+"layout-split-bottom"},left:{cls:Ext.baseCSSPrefix+"layout-split-left"}},orientationProps:{horizontal:{opposite:"vertical",fixedAxis:"height",stretchedAxis:"width"},vertical:{opposite:"horizontal",fixedAxis:"width",stretchedAxis:"height"}},applyCollapseDirection:function(){var cls,me=this,collapseEl=me.collapseEl,collapseDirProps=me.collapseDirProps[me.collapseDirection];collapseEl&&(cls=collapseEl.lastCollapseDirCls,cls&&collapseEl.removeCls(cls),collapseEl.addCls(collapseEl.lastCollapseDirCls=collapseDirProps.cls))},applyOrientation:function(){var me=this,orientation=me.orientation,orientationProps=me.orientationProps[orientation],defaultSize=me.size,fixedSizeProp=orientationProps.fixedAxis,stretchSizeProp=orientationProps.stretchedAxis,cls=me.baseCls+"-";me[orientation]=!0,me[orientationProps.opposite]=!1,me.hasOwnProperty(fixedSizeProp)&&"100%"!==me[fixedSizeProp]||(me[fixedSizeProp]=defaultSize),me.hasOwnProperty(stretchSizeProp)&&me[stretchSizeProp]!==defaultSize||(me[stretchSizeProp]="100%"),me.removeCls(cls+orientationProps.opposite),me.addCls(cls+orientation)},setOrientation:function(orientation){var me=this;me.orientation!==orientation&&(me.orientation=orientation,me.applyOrientation())},updateOrientation:function(){delete this.collapseDirection,this.getCollapseDirection(),this.applyCollapseDirection()},toggleTargetCmp:function(e,t){var toggle,cmp=this.getCollapseTarget(),placeholder=cmp.placeholder;Ext.isFunction(cmp.expand)&&Ext.isFunction(cmp.collapse)&&(toggle=!(!placeholder||placeholder.hidden)||!cmp.hidden,toggle&&(cmp.collapsed?cmp.expand():cmp.collapseDirection?cmp.collapse():cmp.collapse(this.renderData.collapseDir)))},setSize:function(){var me=this;me.callParent(arguments),Ext.isIE&&me.el&&me.el.repaint()},beforeDestroy:function(){Ext.destroy(this.tracker),this.callParent()}}),Ext.define("Ext.resizer.BorderSplitter",{extend:Ext.resizer.Splitter,alias:"widget.bordersplitter",collapseTarget:null,getTrackerConfig:function(){var trackerConfig=this.callParent();return trackerConfig.xclass="Ext.resizer.BorderSplitterTracker",trackerConfig}}),Ext.define("Ext.layout.container.Border",{extend:Ext.layout.container.Container,alias:"layout.border",alternateClassName:"Ext.layout.BorderLayout",targetCls:Ext.baseCSSPrefix+"border-layout-ct",itemCls:[Ext.baseCSSPrefix+"border-item",Ext.baseCSSPrefix+"box-item"],type:"border",isBorderLayout:!0,padding:void 0,percentageRe:/(\d+)%/,horzPositionProp:"left",padOnContainerProp:"left",padNotOnContainerProp:"right",axisProps:{horz:{borderBegin:"west",borderEnd:"east",horizontal:!0,posProp:"x",sizeProp:"width",sizePropCap:"Width"},vert:{borderBegin:"north",borderEnd:"south",horizontal:!1,posProp:"y",sizeProp:"height",sizePropCap:"Height"}},centerRegion:null,manageMargins:!0,panelCollapseAnimate:!0,panelCollapseMode:"placeholder",regionWeights:{north:20,south:10,center:0,west:-10,east:-20},beginAxis:function(ownerContext,regions,name){var center,i,childContext,centerFlex,comp,region,match,size,type,target,placeholder,me=this,props=me.axisProps[name],isVert=!props.horizontal,sizeProp=props.sizeProp,totalFlex=0,childItems=ownerContext.childItems,length=childItems.length;for(i=0;i<length;++i)if(childContext=childItems[i],comp=childContext.target,childContext.layoutPos={},comp.region){if(childContext.region=region=comp.region,childContext.isCenter=comp.isCenter,childContext.isHorz=comp.isHorz,childContext.isVert=comp.isVert,childContext.weight=comp.weight||me.regionWeights[region]||0,regions[comp.id]=childContext,comp.isCenter){center=childContext,centerFlex=comp.flex,ownerContext.centerRegion=center;continue}if(isVert!==childContext.isVert)continue;childContext.reverseWeighting=region==props.borderEnd,size=comp[sizeProp],type=typeof size,comp.collapsed||("string"==type&&(match=me.percentageRe.exec(size))?childContext.percentage=parseInt(match[1],10):comp.flex&&(totalFlex+=childContext.flex=comp.flex))}return center&&(target=center.target,(placeholder=target.placeholderFor)?centerFlex||isVert!==placeholder.collapsedVertical()||(centerFlex=0,center.collapseAxis=name):target.collapsed&&isVert===target.collapsedVertical()&&(centerFlex=0,center.collapseAxis=name)),null==centerFlex&&(centerFlex=1),totalFlex+=centerFlex,Ext.apply({before:isVert?"top":"left",totalFlex:totalFlex},props)},beginLayout:function(ownerContext){var childContext,item,length,i,regions,collapseTarget,doShow,hidden,region,me=this,items=me.getLayoutItems(),pad=me.padding,type=typeof pad,padOnContainer=!1;for(pad?"string"!=type&&"number"!=type||(pad=Ext.util.Format.parseBox(pad)):(pad=ownerContext.getEl("getTargetEl").getPaddingInfo(),padOnContainer=!0),ownerContext.outerPad=pad,ownerContext.padOnContainer=padOnContainer,i=0,length=items.length;i<length;++i)item=items[i],collapseTarget=me.getSplitterTarget(item),collapseTarget&&(doShow=void 0,hidden=!!item.hidden,collapseTarget.split?hidden!==collapseTarget.hidden&&(doShow=!collapseTarget.hidden):collapseTarget.isCollapsingOrExpanding&&(doShow=!!collapseTarget.collapsed),doShow?item.show():doShow===!1&&item.hide());for(me.callParent(arguments),items=ownerContext.childItems,length=items.length,regions={},ownerContext.borderAxisHorz=me.beginAxis(ownerContext,regions,"horz"),ownerContext.borderAxisVert=me.beginAxis(ownerContext,regions,"vert"),i=0;i<length;++i)childContext=items[i],collapseTarget=me.getSplitterTarget(childContext.target),collapseTarget&&(region=regions[collapseTarget.id],region||(region=ownerContext.getEl(collapseTarget.el,me),region.region=collapseTarget.region),childContext.collapseTarget=collapseTarget=region,childContext.weight=collapseTarget.weight,childContext.reverseWeighting=collapseTarget.reverseWeighting,collapseTarget.splitter=childContext,childContext.isHorz=collapseTarget.isHorz,childContext.isVert=collapseTarget.isVert);me.sortWeightedItems(items,"reverseWeighting"),me.setupSplitterNeighbors(items)},calculate:function(ownerContext){var i,childContext,childMargins,size,horzPercentTotal,vertPercentTotal,me=this,containerSize=me.getContainerSize(ownerContext),childItems=ownerContext.childItems,length=childItems.length,horz=ownerContext.borderAxisHorz,vert=ownerContext.borderAxisVert,pad=ownerContext.outerPad,padOnContainer=ownerContext.padOnContainer;for(horz.begin=pad[me.padOnContainerProp],vert.begin=pad.top,horzPercentTotal=horz.end=horz.flexSpace=containerSize.width+(padOnContainer?pad[me.padOnContainerProp]:-pad[me.padNotOnContainerProp]),vertPercentTotal=vert.end=vert.flexSpace=containerSize.height+(padOnContainer?pad.top:-pad.bottom),i=0;i<length;++i)childContext=childItems[i],childMargins=childContext.getMarginInfo(),(childContext.isHorz||childContext.isCenter)&&(horz.addUnflexed(childMargins.width),horzPercentTotal-=childMargins.width),(childContext.isVert||childContext.isCenter)&&(vert.addUnflexed(childMargins.height),vertPercentTotal-=childMargins.height),childContext.flex||childContext.percentage||(childContext.isHorz||childContext.isCenter&&"horz"===childContext.collapseAxis?(size=childContext.getProp("width"),horz.addUnflexed(size),childContext.collapseTarget&&(horzPercentTotal-=size)):(childContext.isVert||childContext.isCenter&&"vert"===childContext.collapseAxis)&&(size=childContext.getProp("height"),vert.addUnflexed(size),childContext.collapseTarget&&(vertPercentTotal-=size)));for(i=0;i<length;++i)childContext=childItems[i],childMargins=childContext.getMarginInfo(),childContext.percentage&&(childContext.isHorz?(size=Math.ceil(horzPercentTotal*childContext.percentage/100),size=childContext.setWidth(size),horz.addUnflexed(size)):childContext.isVert&&(size=Math.ceil(vertPercentTotal*childContext.percentage/100),size=childContext.setHeight(size),vert.addUnflexed(size)));for(i=0;i<length;++i)childContext=childItems[i],childContext.isCenter||(me.calculateChildAxis(childContext,horz),me.calculateChildAxis(childContext,vert));me.finishAxis(ownerContext,vert)+me.finishAxis(ownerContext,horz)<2?me.done=!1:me.finishPositions(childItems)},calculateChildAxis:function(childContext,axis){var region,isBegin,flex,pos,size,collapseTarget=childContext.collapseTarget,setSizeMethod="set"+axis.sizePropCap,sizeProp=axis.sizeProp,childMarginSize=childContext.getMarginInfo()[sizeProp];collapseTarget?region=collapseTarget.region:(region=childContext.region,flex=childContext.flex),isBegin=region==axis.borderBegin,isBegin||region==axis.borderEnd?(flex?(size=Math.ceil(axis.flexSpace*(flex/axis.totalFlex)),size=childContext[setSizeMethod](size)):size=childContext.percentage?childContext.peek(sizeProp):childContext.getProp(sizeProp),size+=childMarginSize,isBegin?(pos=axis.begin,axis.begin+=size):axis.end=pos=axis.end-size):(childContext[setSizeMethod](axis.end-axis.begin-childMarginSize),pos=axis.begin),childContext.layoutPos[axis.posProp]=pos},finishAxis:function(ownerContext,axis){var size=axis.end-axis.begin,center=ownerContext.centerRegion;return center&&(center["set"+axis.sizePropCap](size-center.getMarginInfo()[axis.sizeProp]),center.layoutPos[axis.posProp]=axis.begin),Ext.isNumber(size)?1:0},finishPositions:function(childItems){var index,childContext,length=childItems.length,marginProp=this.horzPositionProp;for(index=0;index<length;++index)childContext=childItems[index],childContext.setProp("x",childContext.layoutPos.x+childContext.marginInfo[marginProp]),childContext.setProp("y",childContext.layoutPos.y+childContext.marginInfo.top)},getLayoutItems:function(){for(var ownerItem,placeholderFor,owner=this.owner,ownerItems=owner&&owner.items&&owner.items.items||[],length=ownerItems.length,items=[],i=0;i<length;i++)ownerItem=ownerItems[i],placeholderFor=ownerItem.placeholderFor,!ownerItem.hidden&&(ownerItem.floated&&2!==ownerItem.isCollapsingOrExpanding||placeholderFor&&2===placeholderFor.isCollapsingOrExpanding)||items.push(ownerItem);return items},getPlaceholder:function(comp){return comp.getPlaceholder&&comp.getPlaceholder()},getSplitterTarget:function(splitter){var collapseTarget=splitter.collapseTarget;return collapseTarget&&collapseTarget.collapsed?collapseTarget.placeholder||collapseTarget:collapseTarget},isItemBoxParent:function(itemContext){return!0},isItemShrinkWrap:function(item){return!0},insertSplitter:function(item,index,hidden,splitterCfg){var region=item.region,splitter=Ext.apply({xtype:"bordersplitter",collapseTarget:item,id:item.id+"-splitter",hidden:hidden,canResize:item.splitterResize!==!1,splitterFor:item},splitterCfg),at=index+("south"===region||"east"===region?0:1);"mini"===item.collapseMode&&(splitter.collapsedCls=item.collapsedCls),item.splitter=this.owner.add(at,splitter)},onAdd:function(item,index){var split,hidden,cfg,me=this,placeholderFor=item.placeholderFor,region=item.region;me.callParent(arguments),region?(Ext.apply(item,me.regionFlags[region]),item.initBorderRegion&&item.initBorderRegion(),"center"===region?me.centerRegion=item:(split=item.split,hidden=!!item.hidden,"object"==typeof split&&(cfg=split,split=!0),!item.isHorz&&!item.isVert||!split&&"mini"!=item.collapseMode||me.insertSplitter(item,index,hidden||!split,cfg)),item.hasOwnProperty("collapseMode")||(item.collapseMode=me.panelCollapseMode),item.hasOwnProperty("animCollapse")||("placeholder"!==item.collapseMode?item.animCollapse=!1:item.animCollapse=me.panelCollapseAnimate)):placeholderFor&&(Ext.apply(item,me.regionFlags[placeholderFor.region]),item.region=placeholderFor.region,item.weight=placeholderFor.weight)},onDestroy:function(){this.centerRegion=null,this.callParent()},onRemove:function(comp,isDestroying){var el,me=this,region=comp.region,splitter=comp.splitter,owner=me.owner,destroying=owner.destroying;region&&(comp.isCenter&&(me.centerRegion=null),delete comp.isCenter,delete comp.isHorz,delete comp.isVert,splitter&&!owner.destroying&&owner.doRemove(splitter,!0),delete comp.splitter),me.callParent(arguments),destroying||isDestroying||!comp.rendered||(el=comp.getEl(),el.setStyle("top",""),el.setStyle(me.horzPositionProp,""))},regionMeta:{center:{splitterDelta:0},north:{splitterDelta:1},south:{splitterDelta:-1},west:{splitterDelta:1},east:{splitterDelta:-1}},regionFlags:{center:{isCenter:!0,isHorz:!1,isVert:!1},north:{isCenter:!1,isHorz:!1,isVert:!0,collapseDirection:"top"},south:{isCenter:!1,isHorz:!1,isVert:!0,collapseDirection:"bottom"},west:{isCenter:!1,isHorz:!0,isVert:!1,collapseDirection:"left"},east:{isCenter:!1,isHorz:!0,isVert:!1,collapseDirection:"right"}},setupSplitterNeighbors:function(items){var i,j,center,count,edge,comp,region,splitter,touched,edgeRegions={},length=items.length,touchedRegions=this.touchedRegions;for(i=0;i<length;++i)if(comp=items[i].target,region=comp.region,comp.isCenter)center=comp;else if(region){for(touched=touchedRegions[region],j=0,count=touched.length;j<count;++j)edge=edgeRegions[touched[j]],edge&&edge.neighbors.push(comp);splitter=comp.placeholderFor?comp.placeholderFor.splitter:comp.splitter,splitter&&(splitter.neighbors=[]),edgeRegions[region]=splitter}if(center)for(touched=touchedRegions.center,j=0,count=touched.length;j<count;++j)edge=edgeRegions[touched[j]],edge&&edge.neighbors.push(center)},touchedRegions:{center:["north","south","east","west"],north:["north","east","west"],south:["south","east","west"],east:["east","north","south"],west:["west","north","south"]},sizePolicies:{vert:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},horz:{readsWidth:1,readsHeight:0,setsWidth:0,setsHeight:1},flexAll:{readsWidth:0,readsHeight:0,setsWidth:1,setsHeight:1}},getItemSizePolicy:function(item){var collapseTarget,size,policy,placeholderFor,me=this,policies=this.sizePolicies;return item.isCenter?(placeholderFor=item.placeholderFor,placeholderFor?placeholderFor.collapsedVertical()?policies.vert:policies.horz:item.collapsed?item.collapsedVertical()?policies.vert:policies.horz:policies.flexAll):(collapseTarget=item.collapseTarget,collapseTarget?collapseTarget.isVert?policies.vert:policies.horz:item.region?(item.isVert?(size=item.height,policy=policies.vert):(size=item.width,policy=policies.horz),item.flex||"string"==typeof size&&me.percentageRe.test(size)?policies.flexAll:policy):me.autoSizePolicy)}},function(){var methods={addUnflexed:function(px){this.flexSpace=Math.max(this.flexSpace-px,0)}},props=this.prototype.axisProps;Ext.apply(props.horz,methods),Ext.apply(props.vert,methods)}),Ext.define("Ext.layout.container.Card",{extend:Ext.layout.container.Fit,alternateClassName:"Ext.layout.CardLayout",alias:"layout.card",type:"card",hideInactive:!0,deferredRender:!1,getRenderTree:function(){var me=this,activeItem=me.getActiveItem();if(activeItem){if(activeItem.hasListeners.beforeactivate&&activeItem.fireEvent("beforeactivate",activeItem)===!1?activeItem=me.activeItem=me.owner.activeItem=null:activeItem.hasListeners.activate&&activeItem.on({boxready:function(){activeItem.fireEvent("activate",activeItem)},single:!0}),!me.deferredRender)return me.callParent(arguments);if(activeItem)return me.getItemsRenderTree([activeItem])}},renderChildren:function(){var me=this,active=me.getActiveItem();me.deferredRender?active&&me.renderItems([active],me.getRenderTarget()):me.callParent()},isValidParent:function(item,target,position){var itemEl=item.el?item.el.dom:Ext.getDom(item);return itemEl&&itemEl.parentNode===(target.dom||target)||!1},getActiveItem:function(){var me=this,result=me.parseActiveItem(me.activeItem||me.owner&&me.owner.activeItem);return result&&me.owner.items.indexOf(result)!=-1?me.activeItem=result:me.activeItem=null,me.activeItem},parseActiveItem:function(item){return item&&item.isComponent?item:"number"==typeof item||void 0===item?this.getLayoutItems()[item||0]:this.owner.getComponent(item)},configureItem:function(item){item===this.getActiveItem()?item.hidden=!1:item.hidden=!0,this.callParent(arguments)},onRemove:function(component){this.callParent(arguments),component===this.activeItem&&(this.activeItem=null)},getAnimation:function(newCard,owner){var newAnim=(newCard||{}).cardSwitchAnimation;return newAnim!==!1&&(newAnim||owner.cardSwitchAnimation)},getNext:function(){var wrap=arguments[0],items=this.getLayoutItems(),index=Ext.Array.indexOf(items,this.activeItem);return items[index+1]||!!wrap&&items[0]},next:function(){var anim=arguments[0],wrap=arguments[1];return this.setActiveItem(this.getNext(wrap),anim)},getPrev:function(){var wrap=arguments[0],items=this.getLayoutItems(),index=Ext.Array.indexOf(items,this.activeItem);return items[index-1]||!!wrap&&items[items.length-1]},prev:function(){var anim=arguments[0],wrap=arguments[1];return this.setActiveItem(this.getPrev(wrap),anim)},setActiveItem:function(newCard){var newIndex,me=this,owner=me.owner,oldCard=me.activeItem,rendered=owner.rendered;return newCard=me.parseActiveItem(newCard),newIndex=owner.items.indexOf(newCard),newIndex==-1&&(newIndex=owner.items.items.length,Ext.suspendLayouts(),newCard=owner.add(newCard),Ext.resumeLayouts()),!(!newCard||oldCard==newCard)&&(newCard.fireEvent("beforeactivate",newCard,oldCard)!==!1&&((!oldCard||oldCard.fireEvent("beforedeactivate",oldCard,newCard)!==!1)&&(rendered?(Ext.suspendLayouts(),newCard.rendered||me.renderItem(newCard,me.getRenderTarget(),owner.items.length),oldCard&&(me.hideInactive&&(oldCard.hide(),oldCard.hiddenByLayout=!0),oldCard.fireEvent("deactivate",oldCard,newCard)),newCard.hidden&&newCard.show(),newCard.hidden||(me.activeItem=newCard),Ext.resumeLayouts(!0)):me.activeItem=newCard,newCard.fireEvent("activate",newCard,oldCard),me.activeItem)))}}),Ext.define("Ext.layout.container.Column",{extend:Ext.layout.container.Auto,alias:["layout.column"],alternateClassName:"Ext.layout.ColumnLayout",type:"column",itemCls:Ext.baseCSSPrefix+"column",targetCls:Ext.baseCSSPrefix+"column-layout-ct",columnWidthSizePolicy:{readsWidth:0,readsHeight:1,setsWidth:1,setsHeight:0},createsInnerCt:!0,manageOverflow:!0,isItemShrinkWrap:function(ownerContext){return!0},getItemSizePolicy:function(item,ownerSizeModel){return item.columnWidth&&(ownerSizeModel||(ownerSizeModel=this.owner.getSizeModel()),!ownerSizeModel.width.shrinkWrap)?this.columnWidthSizePolicy:this.autoSizePolicy},calculateItems:function(ownerContext,containerSize){var blocked,availableWidth,i,itemContext,itemMarginWidth,itemWidth,me=this,targetContext=ownerContext.targetContext,items=ownerContext.childItems,len=items.length,contentWidth=0,gotWidth=containerSize.gotWidth;if(gotWidth===!1)targetContext.domBlock(me,"width"),blocked=!0;else{if(!gotWidth)return!0;availableWidth=containerSize.width}for(i=0;i<len;++i)itemContext=items[i],itemMarginWidth=itemContext.getMarginInfo().width,itemContext.widthModel.calculated||(itemWidth=itemContext.getProp("width"),"number"!=typeof itemWidth&&(itemContext.block(me,"width"),blocked=!0),contentWidth+=itemWidth+itemMarginWidth);if(!blocked){for(availableWidth=availableWidth<contentWidth?0:availableWidth-contentWidth,i=0;i<len;++i)itemContext=items[i],itemContext.widthModel.calculated&&(itemMarginWidth=itemContext.marginInfo.width,itemWidth=itemContext.target.columnWidth,itemWidth=Math.floor(itemWidth*availableWidth)-itemMarginWidth,itemWidth=itemContext.setWidth(itemWidth),contentWidth+=itemWidth+itemMarginWidth);ownerContext.setContentWidth(contentWidth+ownerContext.paddingContext.getPaddingInfo().width)}return!blocked},setCtSizeIfNeeded:function(ownerContext,containerSize){var me=this,padding=ownerContext.paddingContext.getPaddingInfo();me.callParent(arguments),(Ext.isIEQuirks||Ext.isIE7m)&&me.isShrinkWrapTpl&&padding.right&&ownerContext.outerCtContext.setProp("width",containerSize.width+padding.left)}}),Ext.define("Ext.layout.container.Form",{alias:"layout.form",extend:Ext.layout.container.Container,alternateClassName:"Ext.layout.FormLayout",tableCls:Ext.baseCSSPrefix+"form-layout-table",type:"form",createsInnerCt:!0,manageOverflow:!0,lastOverflowAdjust:{width:0,height:0},childEls:["formTable"],padRow:'<tr role="presentation"><td class="'+Ext.baseCSSPrefix+'form-item-pad" colspan="3" role="presentation"></td></tr>',renderTpl:['<table id="{ownerId}-formTable" class="{tableCls}" style="width:100%" cellpadding="0" role="presentation">',"{%this.renderBody(out,values)%}","</table>","{%this.renderPadder(out,values)%}"],getRenderData:function(){var data=this.callParent();return data.tableCls=this.tableCls,data},calculate:function(ownerContext){var tableWidth,childItems,length,me=this,containerSize=me.getContainerSize(ownerContext,!0),i=0,shrinkwrapHeight=ownerContext.sizeModel.height.shrinkWrap;
if(shrinkwrapHeight&&(ownerContext.hasDomProp("containerChildrenSizeDone")?ownerContext.setProp("contentHeight",me.formTable.dom.offsetHeight+ownerContext.targetContext.getPaddingInfo().height):me.done=!1),containerSize.gotWidth)for(tableWidth=me.formTable.dom.offsetWidth,childItems=ownerContext.childItems,length=childItems.length;i<length;++i)childItems[i].setWidth(tableWidth,!1);else me.done=!1},getRenderTarget:function(){return this.formTable},getRenderTree:function(){var i,len,me=this,result=me.callParent(arguments);for(i=0,len=result.length;i<len;i++)result[i]=me.transformItemRenderTree(result[i]);return result},transformItemRenderTree:function(item){return item.tag&&"table"==item.tag?(item.tag="tbody",item.role="presentation",delete item.cellspacing,delete item.cellpadding,Ext.isIE6&&(item.cn=this.padRow),item):{tag:"tbody",role:"presentation",cn:{tag:"tr",role:"presentation",cn:{tag:"td",role:"presentation",colspan:3,style:"width:100%",cn:item}}}},isValidParent:function(item,target,position){return!0},isItemShrinkWrap:function(item){return 2&(item.shrinkWrap===!0?3:item.shrinkWrap||0)},getItemSizePolicy:function(item){return{setsWidth:1,setsHeight:0}},beginLayoutCycle:function(ownerContext,firstCycle){var padEl=this.overflowPadderEl;padEl&&padEl.setStyle("display","none"),ownerContext.state.overflowAdjust||(ownerContext.state.overflowAdjust=this.lastOverflowAdjust)},calculateOverflow:function(ownerContext,containerSize,dimensions){var padWidth,padHeight,padElContext,padding,scrollRangeFlags,scrollbarSize,contentW,contentH,ownerW,ownerH,scrollbars,xauto,yauto,me=this,targetContext=ownerContext.targetContext,manageOverflow=me.manageOverflow,state=ownerContext.state,overflowAdjust=state.overflowAdjust;!manageOverflow||state.secondPass||me.reserveScrollbar||(xauto="auto"===me.getOverflowXStyle(ownerContext),yauto="auto"===me.getOverflowYStyle(ownerContext),containerSize.gotWidth||(xauto=!1),containerSize.gotHeight||(yauto=!1),(xauto||yauto)&&(scrollbarSize=Ext.getScrollbarSize(),contentW=ownerContext.peek("contentWidth"),contentH=ownerContext.peek("contentHeight"),padding=targetContext.getPaddingInfo(),contentW-=padding.width,contentH-=padding.height,ownerW=containerSize.width,ownerH=containerSize.height,scrollbars=me.getScrollbarsNeeded(ownerW,ownerH,contentW,contentH),state.overflowState=scrollbars,"number"==typeof dimensions&&(scrollbars&=~dimensions),overflowAdjust={width:xauto&&2&scrollbars?scrollbarSize.width:0,height:yauto&&1&scrollbars?scrollbarSize.height:0},overflowAdjust.width===me.lastOverflowAdjust.width&&overflowAdjust.height===me.lastOverflowAdjust.height||(me.done=!1,ownerContext.invalidate({state:{overflowAdjust:overflowAdjust,overflowState:state.overflowState,secondPass:!0}})))),me.done&&(padElContext=ownerContext.padElContext||(ownerContext.padElContext=ownerContext.getEl("overflowPadderEl",me)),padElContext&&(scrollbars=state.overflowState,padWidth=ownerContext.peek("contentWidth"),padHeight=1,scrollbars?(padding=targetContext.getPaddingInfo(),scrollRangeFlags=me.scrollRangeFlags,2&scrollbars&&1&scrollRangeFlags&&(padHeight+=padding.bottom),1&scrollbars&&4&scrollRangeFlags&&(padWidth+=padding.right),padElContext.setProp("display",""),padElContext.setSize(padWidth,padHeight)):padElContext.setProp("display","none")))},completeLayout:function(ownerContext){this.lastOverflowAdjust=ownerContext.state.overflowAdjust},doRenderPadder:function(out,renderData){var me=renderData.$layout,owner=me.owner,scrollRangeFlags=me.getScrollRangeFlags();me.manageOverflow&&5&scrollRangeFlags&&(out.push('<div id="',owner.id,'-overflowPadderEl" role="presentation"','style="font-size: 1px; height: 1px; margin-top: -1px; position: relative; z-index: -99999'),out.push('"></div>'),me.scrollRangeFlags=scrollRangeFlags)},getContainerSize:function(ownerContext,inDom,ignoreOverflow){var gotWidth,gotHeight,width,height,targetContext=ownerContext.targetContext,frameInfo=targetContext.getFrameInfo(),padding=targetContext.getPaddingInfo(),got=0,needed=0,overflowAdjust=ignoreOverflow?null:ownerContext.state.overflowAdjust;return ownerContext.widthModel.shrinkWrap||(++needed,width=inDom?targetContext.getDomProp("width"):targetContext.getProp("width"),gotWidth="number"==typeof width,gotWidth&&(++got,width-=frameInfo.width+padding.width,overflowAdjust&&(width-=overflowAdjust.width))),ownerContext.heightModel.shrinkWrap||(++needed,height=inDom?targetContext.getDomProp("height"):targetContext.getProp("height"),gotHeight="number"==typeof height,gotHeight&&(++got,height-=frameInfo.height+padding.height,overflowAdjust&&(height-=overflowAdjust.height))),{width:width,height:height,needed:needed,got:got,gotAll:got==needed,gotWidth:gotWidth,gotHeight:gotHeight}},getOverflowXStyle:function(ownerContext){var me=this;return me.overflowXStyle||(me.overflowXStyle=me.owner.scrollFlags.overflowX||ownerContext.targetContext.getStyle("overflow-x"))},getOverflowYStyle:function(ownerContext){var me=this;return me.overflowYStyle||(me.overflowYStyle=me.owner.scrollFlags.overflowY||ownerContext.targetContext.getStyle("overflow-y"))},getScrollRangeFlags:function(){var flags=-1;return function(){if(flags<0){var div=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"border-box",role:"presentation",style:{width:"100px",height:"100px",padding:"10px",overflow:"auto"},children:[{role:"presentation",style:{border:"1px solid red",width:"150px",height:"150px",margin:"0 5px 5px 0"}}]}),scrollHeight=div.dom.scrollHeight,scrollWidth=div.dom.scrollWidth,heightFlags={175:0,165:1,170:2,160:3},widthFlags={175:0,165:4,170:8,160:12};flags=(heightFlags[scrollHeight]||0)|(widthFlags[scrollWidth]||0),div.remove()}return flags}}(),initLayout:function(){var me=this,scrollbarWidth=Ext.getScrollbarSize().width;me.callParent(),scrollbarWidth&&me.manageOverflow&&!me.hasOwnProperty("lastOverflowAdjust")&&(me.owner.scrollFlags.y||me.reserveScrollbar)&&(me.lastOverflowAdjust={width:scrollbarWidth,height:0})},setupRenderTpl:function(renderTpl){this.callParent(arguments),renderTpl.renderPadder=this.doRenderPadder}}),Ext.define("Ext.menu.Item",{extend:Ext.Component,alias:"widget.menuitem",alternateClassName:"Ext.menu.TextItem",isMenuItem:!0,mixins:{queryable:Ext.Queryable},activeCls:Ext.baseCSSPrefix+"menu-item-active",ariaRole:"menuitem",canActivate:!0,clickHideDelay:0,destroyMenu:!0,disabledCls:Ext.baseCSSPrefix+"menu-item-disabled",hideOnClick:!0,menuAlign:"tl-tr?",menuExpandDelay:200,menuHideDelay:200,tooltipType:"qtip",arrowCls:Ext.baseCSSPrefix+"menu-item-arrow",baseIconCls:Ext.baseCSSPrefix+"menu-item-icon",textCls:Ext.baseCSSPrefix+"menu-item-text",indentCls:Ext.baseCSSPrefix+"menu-item-indent",indentNoSeparatorCls:Ext.baseCSSPrefix+"menu-item-indent-no-separator",indentRightIconCls:Ext.baseCSSPrefix+"menu-item-indent-right-icon",indentRightArrowCls:Ext.baseCSSPrefix+"menu-item-indent-right-arrow",linkCls:Ext.baseCSSPrefix+"menu-item-link",childEls:["itemEl","iconEl","textEl","arrowEl"],renderTpl:['<tpl if="plain">',"{text}","<tpl else>",'<a id="{id}-itemEl"',' class="{linkCls} {indentCls}{childElCls}"',' href="{href}" role="presentation" ','<tpl if="hrefTarget"> target="{hrefTarget}"</tpl>',' hidefocus="true"',' unselectable="on"','<tpl if="tabIndex">',' tabIndex="{tabIndex}"',"</tpl>",">",'<span id="{id}-textEl" class="{textCls}{childElCls}" unselectable="on">{text}</span>','<tpl if="hasIcon">','<div role="presentation" id="{id}-iconEl" class="{baseIconCls}','{[values.rightIcon ? "-right" : ""]} {iconCls}','{childElCls} {glyphCls}" style="<tpl if="icon">background-image:url({icon});</tpl>','<tpl if="glyph && glyphFontFamily">font-family:{glyphFontFamily};</tpl>">','<tpl if="glyph">&#{glyph};</tpl>',"</div>","</tpl>",'<tpl if="showCheckbox">','<div role="presentation" id="{id}-checkEl" class="{baseIconCls}','{[(values.hasIcon && !values.rightIcon) ? "-right" : ""]} ','{groupCls} {checkboxCls}{childElCls}">',"</div>","</tpl>",'<tpl if="hasMenu">','<div role="presentation" id="{id}-arrowEl" class="{arrowCls}{childElCls}"></div>',"</tpl>","</a>","</tpl>"],maskOnDisable:!1,iconAlign:"left",activate:function(skipCheck){var me=this;(skipCheck||!me.activated&&me.canActivate&&me.rendered&&!me.isDisabled()&&me.isVisible())&&(me.plain||me.el.addCls(me.activeCls),me.focus(!1,!0),me.activated=!0,me.hasListeners.activate&&me.fireEvent("activate",me))},getFocusEl:function(){return this.itemEl},deactivate:function(){var parent,me=this;me.activated&&(parent=me.up(""),me.plain||me.el.removeCls(me.activeCls),parent&&parent.focus(!1,!0),me.hideMenu(),me.activated=!1,me.hasListeners.deactivate&&me.fireEvent("deactivate",me))},deferHideMenu:function(){this.menu.isVisible()&&this.menu.hide()},cancelDeferHide:function(){clearTimeout(this.hideMenuTimer)},deferHideParentMenus:function(){var ancestor;Ext.menu.Manager.hideAll(),Ext.Element.getActiveElement()||(ancestor=this.up(":not([hidden])"),ancestor&&ancestor.focus())},expandMenu:function(delay){var me=this;me.menu&&(me.cancelDeferHide(),0===delay?me.doExpandMenu():(clearTimeout(me.expandMenuTimer),me.expandMenuTimer=Ext.defer(me.doExpandMenu,Ext.isNumber(delay)?delay:me.menuExpandDelay,me)))},doExpandMenu:function(){var me=this,menu=me.menu;!me.activated||menu.rendered&&menu.isVisible()||(me.parentMenu.activeChild=menu,menu.parentItem=me,menu.parentMenu=me.parentMenu,menu.showBy(me,me.menuAlign))},getRefItems:function(deep){var items,menu=this.menu;return menu&&(items=menu.getRefItems(deep),items.unshift(menu)),items||[]},hideMenu:function(delay){var me=this;me.menu&&(clearTimeout(me.expandMenuTimer),me.hideMenuTimer=Ext.defer(me.deferHideMenu,Ext.isNumber(delay)?delay:me.menuHideDelay,me))},initComponent:function(){var menu,me=this,prefix=Ext.baseCSSPrefix,cls=[prefix+"menu-item"];me.addEvents("activate","click","deactivate","textchange","iconchange"),me.plain&&cls.push(prefix+"menu-item-plain"),me.cls&&cls.push(me.cls),me.cls=cls.join(" "),me.menu&&(menu=me.menu,delete me.menu,me.setMenu(menu)),me.callParent(arguments)},onClick:function(e){var me=this,clickHideDelay=me.clickHideDelay;me.href||e.stopEvent(),me.disabled||(me.hideOnClick&&(clickHideDelay?me.deferHideParentMenusTimer=Ext.defer(me.deferHideParentMenus,clickHideDelay,me):me.deferHideParentMenus()),Ext.callback(me.handler,me.scope||me,[me,e]),me.fireEvent("click",me,e),me.hideOnClick||me.focus())},onRemoved:function(){var me=this;me.activated&&me.parentMenu.activeItem===me&&me.parentMenu.deactivateActiveItem(),me.callParent(arguments),me.parentMenu=me.ownerButton=null},beforeDestroy:function(){var me=this;me.rendered&&me.clearTip(),me.callParent()},onDestroy:function(){var me=this;clearTimeout(me.expandMenuTimer),me.cancelDeferHide(),clearTimeout(me.deferHideParentMenusTimer),me.setMenu(null),me.callParent(arguments)},beforeRender:function(){var glyphParts,me=this,glyph=me.glyph,glyphFontFamily=Ext._glyphFontFamily,hasIcon=!!(me.icon||me.iconCls||glyph),hasMenu=!!me.menu,rightIcon="right"===me.iconAlign&&!hasMenu,isCheckItem=me.isMenuCheckItem,indentCls=[],ownerCt=me.ownerCt,isOwnerPlain=ownerCt.plain;me.callParent(),hasIcon&&hasMenu&&me.showCheckbox&&(hasIcon=!1),"string"==typeof glyph&&(glyphParts=glyph.split("@"),glyph=glyphParts[0],glyphFontFamily=glyphParts[1]),(!isOwnerPlain||hasIcon&&!rightIcon||isCheckItem)&&(ownerCt.showSeparator&&!isOwnerPlain?indentCls.push(me.indentCls):indentCls.push(me.indentNoSeparatorCls)),hasMenu?indentCls.push(me.indentRightArrowCls):hasIcon&&(rightIcon||isCheckItem)&&indentCls.push(me.indentRightIconCls),Ext.applyIf(me.renderData,{href:me.href||"#",hrefTarget:me.hrefTarget,icon:me.icon,iconCls:me.iconCls,glyph:glyph,glyphCls:glyph?Ext.baseCSSPrefix+"menu-item-glyph":void 0,glyphFontFamily:glyphFontFamily,hasIcon:hasIcon,hasMenu:hasMenu,indent:!isOwnerPlain||hasIcon||isCheckItem,isCheckItem:isCheckItem,rightIcon:rightIcon,plain:me.plain,text:me.text,arrowCls:me.arrowCls,baseIconCls:me.baseIconCls,textCls:me.textCls,indentCls:indentCls.join(" "),linkCls:me.linkCls,groupCls:me.group?me.groupCls:"",tabIndex:me.tabIndex})},onRender:function(){var me=this;me.callParent(arguments),me.tooltip&&me.setTooltip(me.tooltip,!0)},setMenu:function(menu,destroyMenu){var me=this,oldMenu=me.menu,arrowEl=me.arrowEl;oldMenu&&(delete oldMenu.parentItem,delete oldMenu.parentMenu,delete oldMenu.ownerItem,(destroyMenu===!0||destroyMenu!==!1&&me.destroyMenu)&&Ext.destroy(oldMenu)),menu?(me.menu=Ext.menu.Manager.get(menu),me.menu.ownerItem=me):me.menu=null,me.rendered&&!me.destroying&&arrowEl&&arrowEl[me.menu?"addCls":"removeCls"](me.arrowCls)},setHandler:function(fn,scope){this.handler=fn||null,this.scope=scope},setIcon:function(icon){var iconEl=this.iconEl,oldIcon=this.icon;iconEl&&(iconEl.src=icon||Ext.BLANK_IMAGE_URL),this.icon=icon,this.fireEvent("iconchange",this,oldIcon,icon)},setIconCls:function(iconCls){var me=this,iconEl=me.iconEl,oldCls=me.iconCls;iconEl&&(me.iconCls&&iconEl.removeCls(me.iconCls),iconCls&&iconEl.addCls(iconCls)),me.iconCls=iconCls,me.fireEvent("iconchange",me,oldCls,iconCls)},setText:function(text){var me=this,el=me.textEl||me.el,oldText=me.text;me.text=text,me.rendered&&(el.update(text||""),me.ownerCt.updateLayout()),me.fireEvent("textchange",me,oldText,text)},getTipAttr:function(){return"qtip"==this.tooltipType?"data-qtip":"title"},clearTip:function(){Ext.quickTipsActive&&Ext.isObject(this.tooltip)&&Ext.tip.QuickTipManager.unregister(this.itemEl)},setTooltip:function(tooltip,initial){var me=this;return me.rendered?(initial||me.clearTip(),Ext.quickTipsActive&&Ext.isObject(tooltip)?(Ext.tip.QuickTipManager.register(Ext.apply({target:me.itemEl.id},tooltip)),me.tooltip=tooltip):me.itemEl.dom.setAttribute(me.getTipAttr(),tooltip)):me.tooltip=tooltip,me}}),Ext.define("Ext.menu.CheckItem",{extend:Ext.menu.Item,alias:"widget.menucheckitem",checkedCls:Ext.baseCSSPrefix+"menu-item-checked",uncheckedCls:Ext.baseCSSPrefix+"menu-item-unchecked",groupCls:Ext.baseCSSPrefix+"menu-group-icon",hideOnClick:!1,checkChangeDisabled:!1,ariaRole:"menuitemcheckbox",childEls:["itemEl","iconEl","textEl","checkEl"],showCheckbox:!0,isMenuCheckItem:!0,checkboxCls:Ext.baseCSSPrefix+"menu-item-checkbox",initComponent:function(){var me=this;me.checked=!!me.checked,me.addEvents("beforecheckchange","checkchange"),me.callParent(arguments),Ext.menu.Manager.registerCheckable(me),me.group&&me.initialConfig.hideOnClick!==!1&&(me.hideOnClick=!0)},beforeRender:function(){var me=this;me.callParent(),Ext.apply(me.renderData,{checkboxCls:me.checkboxCls,showCheckbox:me.showCheckbox})},afterRender:function(){var me=this;me.callParent(),me.checked=!me.checked,me.setChecked(!me.checked,!0),me.checkChangeDisabled&&me.disableCheckChange()},disableCheckChange:function(){var me=this,checkEl=me.checkEl;checkEl&&checkEl.addCls(me.disabledCls),Ext.isIE10p||Ext.isIE9&&Ext.isStrict||!me.rendered||me.el.repaint(),me.checkChangeDisabled=!0},enableCheckChange:function(){var me=this,checkEl=me.checkEl;checkEl&&checkEl.removeCls(me.disabledCls),me.checkChangeDisabled=!1},onClick:function(e){var me=this;me.disabled||me.checkChangeDisabled||me.checked&&me.group||me.setChecked(!me.checked),this.callParent([e])},onDestroy:function(){Ext.menu.Manager.unregisterCheckable(this),this.callParent(arguments)},setChecked:function(checked,suppressEvents){var me=this,checkedCls=me.checkedCls,uncheckedCls=me.uncheckedCls,el=me.el;me.checked===checked||!suppressEvents&&me.fireEvent("beforecheckchange",me,checked)===!1||(el&&(checked?(el.addCls(checkedCls),el.removeCls(uncheckedCls)):(el.addCls(uncheckedCls),el.removeCls(checkedCls))),me.checked=checked,Ext.menu.Manager.onCheckChange(me,checked),suppressEvents||(Ext.callback(me.checkHandler,me.scope||me,[me,checked]),me.fireEvent("checkchange",me,checked)))}}),Ext.define("Ext.menu.KeyNav",{extend:Ext.util.KeyNav,constructor:function(config){var me=this;me.menu=config.target,me.callParent([Ext.apply({down:me.down,enter:me.enter,esc:me.escape,left:me.left,right:me.right,space:me.enter,tab:me.tab,up:me.up},config)])},down:function(e){var me=this,fi=me.menu.focusedItem;return!(!fi||e.getKey()!=Ext.EventObject.DOWN||!me.isWhitelisted(fi))||void me.focusNextItem(1)},enter:function(e){var menu=this.menu,focused=menu.focusedItem;if(menu.activeItem)menu.onClick(e);else if(focused&&focused.isFormField)return!0},escape:function(e){Ext.menu.Manager.hideAll()},focusNextItem:function(step){for(var item,menu=this.menu,items=menu.items,focusedItem=menu.focusedItem,startIdx=focusedItem?items.indexOf(focusedItem):-1,idx=startIdx+step,len=items.length,count=0;count<len&&idx!==startIdx;){if(idx<0?idx=len-1:idx>=len&&(idx=0),item=items.getAt(idx),menu.canActivateItem(item)){menu.setActiveItem(item);break}idx+=step,++count}},isWhitelisted:function(item){return Ext.FocusManager.isWhitelisted(item)},left:function(e){var menu=this.menu,fi=menu.focusedItem;return!(!fi||!this.isWhitelisted(fi))||(menu.hide(),void(menu.parentMenu&&menu.parentMenu.focus()))},right:function(e){var am,menu=this.menu,fi=menu.focusedItem,ai=menu.activeItem;return!(!fi||!this.isWhitelisted(fi))||void(ai&&(am=menu.activeItem.menu,am&&(ai.expandMenu(0),am.setActiveItem(am.child(":focusable")))))},tab:function(e){var me=this;e.shiftKey?me.up(e):me.down(e)},up:function(e){var me=this,fi=me.menu.focusedItem;return!(!fi||e.getKey()!=Ext.EventObject.UP||!me.isWhitelisted(fi))||void me.focusNextItem(-1)}}),Ext.define("Ext.menu.Separator",{extend:Ext.menu.Item,alias:"widget.menuseparator",canActivate:!1,focusable:!1,hideOnClick:!1,plain:!0,separatorCls:Ext.baseCSSPrefix+"menu-item-separator",text:"&#160;",ariaRole:"separator",beforeRender:function(ct,pos){var me=this;me.callParent(),me.addCls(me.separatorCls)}}),Ext.define("Ext.menu.Menu",{extend:Ext.panel.Panel,alias:"widget.menu",enableKeyNav:!0,allowOtherMenus:!1,ariaRole:"menu",floating:!0,constrain:!0,hidden:!0,hideMode:"visibility",ignoreParentClicks:!1,isMenu:!0,showSeparator:!0,minWidth:void 0,defaultMinWidth:120,initComponent:function(){var me=this,prefix=Ext.baseCSSPrefix,cls=[prefix+"menu"],bodyCls=me.bodyCls?[me.bodyCls]:[],isFloating=me.floating!==!1;me.addEvents("click","mouseenter","mouseleave","mouseover"),Ext.menu.Manager.register(me),me.plain&&cls.push(prefix+"menu-plain"),me.cls=cls.join(" "),bodyCls.push(prefix+"menu-body",Ext.dom.Element.unselectableCls),me.bodyCls=bodyCls.join(" "),me.layout||(me.layout={type:"vbox",align:"stretchmax",overflowHandler:"Scroller"}),isFloating?void 0===me.minWidth&&(me.minWidth=me.defaultMinWidth):(me.hidden=!!me.initialConfig.hidden,me.constrain=!1),me.callParent(arguments)},registerWithOwnerCt:function(){this.floating&&(this.ownerCt=null,Ext.WindowManager.register(this))},initHierarchyEvents:Ext.emptyFn,isVisible:function(){return this.callParent()},getHierarchyState:function(){var result=this.callParent();return result.hidden=this.hidden,result},beforeRender:function(){this.callParent(arguments),this.getSizeModel().width.shrinkWrap||(this.layout.align="stretch")},onBoxReady:function(){var me=this;me.callParent(arguments),me.showSeparator&&(me.iconSepEl=me.layout.getElementTarget().insertFirst({role:"presentation",cls:Ext.baseCSSPrefix+"menu-icon-separator",html:"&#160;"})),me.mon(me.el,{click:me.onClick,mouseover:me.onMouseOver,scope:me}),me.mouseMonitor=me.el.monitorMouseLeave(100,me.onMouseLeave,me),me.enableKeyNav&&(me.keyNav=new Ext.menu.KeyNav({target:me,keyMap:me.getKeyMap()}))},getRefOwner:function(){return this.parentMenu||this.ownerButton||this.callParent(arguments)},canActivateItem:function(item){return item&&!item.isDisabled()&&item.isVisible()&&(item.canActivate||!item.isMenuItem)},deactivateActiveItem:function(andBlurFocusedItem){var me=this,activeItem=me.activeItem,focusedItem=me.focusedItem;activeItem&&(activeItem.deactivate(),activeItem.activated||delete me.activeItem),focusedItem&&andBlurFocusedItem&&(focusedItem.blur(),delete me.focusedItem)},getFocusEl:function(){return this.focusedItem||this.el},hide:function(){this.deactivateActiveItem(!0),this.callParent(arguments)},getItemFromEvent:function(e){for(var me=this,renderTarget=me.layout.getRenderTarget().dom,toEl=e.getTarget();toEl.parentNode!==renderTarget;)if(toEl=toEl.parentNode,!toEl)return;return Ext.getCmp(toEl.id)},lookupComponent:function(cmp){var me=this;return"string"==typeof cmp?cmp=me.lookupItemFromString(cmp):Ext.isObject(cmp)&&(cmp=me.lookupItemFromObject(cmp)),cmp.minWidth=cmp.minWidth||me.minWidth,cmp},lookupItemFromObject:function(cmp){var cls,me=this,prefix=Ext.baseCSSPrefix;return cmp.isComponent||(cmp=cmp.xtype?Ext.ComponentManager.create(cmp,cmp.xtype):Ext.create("Ext.menu."+(Ext.isBoolean(cmp.checked)?"Check":"")+"Item",cmp)),cmp.isMenuItem&&(cmp.parentMenu=me),cmp.isMenuItem||cmp.dock||(cls=[prefix+"menu-item-cmp"],me.plain||cmp.indent===!1&&"no-icon"!==cmp.iconCls||cls.push(prefix+"menu-item-indent"),cmp.rendered?cmp.el.addCls(cls):cmp.cls=(cmp.cls||"")+" "+cls.join(" ")),cmp},lookupItemFromString:function(cmp){return"separator"==cmp||"-"==cmp?new Ext.menu.Separator:new Ext.menu.Item({canActivate:!1,hideOnClick:!1,plain:!0,text:cmp})},onClick:function(e){var item,me=this;return me.disabled?void e.stopEvent():(item="click"===e.type?me.getItemFromEvent(e):me.activeItem,item&&item.isMenuItem&&(item.menu&&me.ignoreParentClicks?e.stopEvent():item.onClick(e)),item&&!item.disabled||(item=void 0),void me.fireEvent("click",me,item,e))},onDestroy:function(){var me=this;Ext.menu.Manager.unregister(me),me.parentMenu=me.ownerButton=null,me.rendered&&(me.el.un(me.mouseMonitor),Ext.destroy(me.keyNav),me.keyNav=null),me.callParent(arguments)},onMouseLeave:function(e){var me=this;me.deactivateActiveItem(),me.disabled||me.fireEvent("mouseleave",me,e)},onMouseOver:function(e){var me=this,fromEl=e.getRelatedTarget(),mouseEnter=!me.el.contains(fromEl),item=me.getItemFromEvent(e),parentMenu=me.parentMenu,parentItem=me.parentItem;mouseEnter&&parentMenu&&(parentMenu.setActiveItem(parentItem),parentItem.cancelDeferHide(),parentMenu.mouseMonitor.mouseenter()),me.disabled||(item&&!item.activated&&(me.setActiveItem(item),item.activated&&item.expandMenu&&item.expandMenu()),mouseEnter&&me.fireEvent("mouseenter",me,e),me.fireEvent("mouseover",me,item,e))},setActiveItem:function(item){var me=this;item&&item!=me.activeItem&&(me.deactivateActiveItem(),me.canActivateItem(item)&&(item.activate?(item.activate(!0),item.activated&&(me.activeItem=item,me.focusedItem=item)):(item.focus(),me.focusedItem=item)))},showBy:function(cmp,pos,off){var me=this;return me.callParent(arguments),me.hidden||me.setVerticalPosition(),me},beforeShow:function(){var viewHeight,me=this;me.floating&&(me.savedMaxHeight=me.maxHeight,viewHeight=me.container.getViewSize().height,me.maxHeight=Math.min(me.maxHeight||viewHeight,viewHeight)),me.callParent(arguments)},afterShow:function(){var me=this;me.callParent(arguments),me.floating&&(me.maxHeight=me.savedMaxHeight)},setVerticalPosition:function(){var max,me=this,y=me.getY(),returnY=y,height=me.getHeight(),viewportHeight=Ext.Element.getViewportHeight().height,parentEl=me.el.parent(),viewHeight=parentEl.getViewSize().height,normalY=y-parentEl.getScroll().top;parentEl=null,me.floating&&(max=me.maxHeight?me.maxHeight:viewHeight-normalY,height>viewHeight?returnY=y-normalY:max<height?returnY=y-(height-max):y+height>viewportHeight&&(returnY=viewportHeight-height)),me.setY(returnY)}}),Ext.define("Ext.menu.ColorPicker",{extend:Ext.menu.Menu,alias:"widget.colormenu",hideOnClick:!0,pickerId:null,initComponent:function(){var me=this,cfg=Ext.apply({},me.initialConfig);delete cfg.listeners,Ext.apply(me,{plain:!0,showSeparator:!1,bodyPadding:0,items:Ext.applyIf({cls:Ext.baseCSSPrefix+"menu-color-item",margin:0,id:me.pickerId,xtype:"colorpicker"},cfg)}),me.callParent(arguments),me.picker=me.down("colorpicker"),me.relayEvents(me.picker,["select"]),me.hideOnClick&&me.on("select",me.hidePickerOnSelect,me)},hidePickerOnSelect:function(){Ext.menu.Manager.hideAll()}}),Ext.define("Ext.menu.DatePicker",{extend:Ext.menu.Menu,alias:"widget.datemenu",hideOnClick:!0,pickerId:null,initComponent:function(){var me=this,cfg=Ext.apply({},me.initialConfig);delete cfg.listeners,Ext.apply(me,{showSeparator:!1,plain:!0,bodyPadding:0,items:Ext.applyIf({cls:Ext.baseCSSPrefix+"menu-date-item",margin:0,border:!1,id:me.pickerId,xtype:"datepicker"},cfg)}),me.callParent(arguments),me.picker=me.down("datepicker"),me.relayEvents(me.picker,["select"]),me.hideOnClick&&me.on("select",me.hidePickerOnSelect,me)},hidePickerOnSelect:function(){Ext.menu.Manager.hideAll()}}),Ext.define("Ext.panel.Tool",{extend:Ext.Component,alias:"widget.tool",isTool:!0,baseCls:Ext.baseCSSPrefix+"tool",disabledCls:Ext.baseCSSPrefix+"tool-disabled",toolPressedCls:Ext.baseCSSPrefix+"tool-pressed",toolOverCls:Ext.baseCSSPrefix+"tool-over",ariaRole:"button",childEls:["toolEl"],renderTpl:['<img id="{id}-toolEl" src="{blank}" class="{baseCls}-img {baseCls}-{type}{childElCls}" role="presentation"/>'],toolOwner:null,tooltipType:"qtip",stopEvent:!0,height:15,width:15,initComponent:function(){var me=this;me.addEvents("click"),me.type=me.type||me.id,Ext.applyIf(me.renderData,{baseCls:me.baseCls,blank:Ext.BLANK_IMAGE_URL,type:me.type}),me.tooltip=me.tooltip||me.qtip,me.callParent()},afterRender:function(){var attr,me=this;me.callParent(arguments),me.el.on({click:me.onClick,mousedown:me.onMouseDown,mouseover:me.onMouseOver,mouseout:me.onMouseOut,scope:me}),me.tooltip&&(Ext.quickTipsActive&&Ext.isObject(me.tooltip)?Ext.tip.QuickTipManager.register(Ext.apply({target:me.id},me.tooltip)):(attr="qtip"==me.tooltipType?"data-qtip":"title",me.el.dom.setAttribute(attr,me.tooltip)))},getFocusEl:function(){return this.el},setType:function(type){var me=this,oldType=me.type;return me.type=type,me.rendered?(oldType&&me.toolEl.removeCls(me.baseCls+"-"+oldType),me.toolEl.addCls(me.baseCls+"-"+type)):me.renderData.type=type,me},onClick:function(e,target){var me=this;return!me.disabled&&(me.el.removeCls(me.toolPressedCls),me.el.removeCls(me.toolOverCls),me.stopEvent!==!1&&e.stopEvent(),me.handler?Ext.callback(me.handler,me.scope||me,[e,target,me.ownerCt,me]):me.callback&&Ext.callback(me.callback,me.scope||me,[me.toolOwner||me.ownerCt,me,e]),me.fireEvent("click",me,e),!0)},onDestroy:function(){var me=this;Ext.quickTipsActive&&Ext.isObject(me.tooltip)&&Ext.tip.QuickTipManager.unregister(me.id),me.keyMap&&me.keyMap.destroy(),me.callParent()},onMouseDown:function(){return!this.disabled&&void this.el.addCls(this.toolPressedCls)},onMouseOver:function(){return!this.disabled&&void this.el.addCls(this.toolOverCls)},onMouseOut:function(){this.el.removeCls(this.toolOverCls)}}),Ext.define("Ext.resizer.SplitterTracker",{extend:Ext.dd.DragTracker,enabled:!0,overlayCls:Ext.baseCSSPrefix+"resizable-overlay",createDragOverlay:function(){var overlay;overlay=this.overlay=Ext.getBody().createChild({role:"presentation",cls:this.overlayCls,html:"&#160;"}),overlay.unselectable(),overlay.setSize(Ext.Element.getViewWidth(!0),Ext.Element.getViewHeight(!0)),overlay.show()},getPrevCmp:function(){var splitter=this.getSplitter();return splitter.previousSibling(":not([hidden])")},getNextCmp:function(){var splitter=this.getSplitter();return splitter.nextSibling(":not([hidden])")},onBeforeStart:function(e){var box,me=this,prevCmp=me.getPrevCmp(),nextCmp=me.getNextCmp(),collapseEl=me.getSplitter().collapseEl,target=e.getTarget();return!(!prevCmp||!nextCmp)&&((!collapseEl||target!==me.getSplitter().collapseEl.dom)&&(!nextCmp.collapsed&&!prevCmp.collapsed&&(me.prevBox=prevCmp.getEl().getBox(),me.nextBox=nextCmp.getEl().getBox(),me.constrainTo=box=me.calculateConstrainRegion(),!!box&&box)))},onStart:function(e){var splitter=this.getSplitter();this.createDragOverlay(),splitter.addCls(splitter.baseCls+"-active")},calculateConstrainRegion:function(){var prevConstrainRegion,nextConstrainRegion,constrainOptions,me=this,splitter=me.getSplitter(),splitWidth=splitter.getWidth(),defaultMin=splitter.defaultSplitMin,orient=splitter.orientation,prevBox=me.prevBox,prevCmp=me.getPrevCmp(),nextBox=me.nextBox,nextCmp=me.getNextCmp();return"vertical"===orient?(constrainOptions={prevCmp:prevCmp,nextCmp:nextCmp,prevBox:prevBox,nextBox:nextBox,defaultMin:defaultMin,splitWidth:splitWidth},prevConstrainRegion=new Ext.util.Region(prevBox.y,me.getVertPrevConstrainRight(constrainOptions),prevBox.bottom,me.getVertPrevConstrainLeft(constrainOptions)),nextConstrainRegion=new Ext.util.Region(nextBox.y,me.getVertNextConstrainRight(constrainOptions),nextBox.bottom,me.getVertNextConstrainLeft(constrainOptions))):(prevConstrainRegion=new Ext.util.Region(prevBox.y+(prevCmp.minHeight||defaultMin),prevBox.right,(prevCmp.maxHeight?prevBox.y+prevCmp.maxHeight:nextBox.bottom-(nextCmp.minHeight||defaultMin))+splitWidth,prevBox.x),nextConstrainRegion=new Ext.util.Region((nextCmp.maxHeight?nextBox.bottom-nextCmp.maxHeight:prevBox.y+(prevCmp.minHeight||defaultMin))-splitWidth,nextBox.right,nextBox.bottom-(nextCmp.minHeight||defaultMin),nextBox.x)),prevConstrainRegion.intersect(nextConstrainRegion)},performResize:function(e,offset){for(var item,size,me=this,splitter=me.getSplitter(),orient=splitter.orientation,prevCmp=me.getPrevCmp(),nextCmp=me.getNextCmp(),owner=splitter.ownerCt,flexedSiblings=owner.query(">[flex]"),len=flexedSiblings.length,vertical="vertical"===orient,i=0,dimension=vertical?"width":"height",totalFlex=0;i<len;i++)item=flexedSiblings[i],size=vertical?item.getWidth():item.getHeight(),totalFlex+=size,item.flex=size;offset=vertical?offset[0]:offset[1],prevCmp&&(size=me.prevBox[dimension]+offset,prevCmp.flex?prevCmp.flex=size:prevCmp[dimension]=size),nextCmp&&(size=me.nextBox[dimension]-offset,nextCmp.flex?nextCmp.flex=size:nextCmp[dimension]=size),owner.updateLayout()},endDrag:function(){var me=this;me.overlay&&(me.overlay.remove(),delete me.overlay),me.callParent(arguments)},onEnd:function(e){var me=this,splitter=me.getSplitter();splitter.removeCls(splitter.baseCls+"-active"),me.performResize(e,me.getResizeOffset())},onDrag:function(e){var me=this,offset=me.getOffset("dragTarget"),splitter=me.getSplitter(),splitEl=splitter.getEl(),orient=splitter.orientation;"vertical"===orient?splitEl.setX(me.startRegion.left+offset[0]):splitEl.setY(me.startRegion.top+offset[1])},getSplitter:function(){return this.splitter},getVertPrevConstrainRight:function(o){return(o.prevCmp.maxWidth?o.prevBox.x+o.prevCmp.maxWidth:o.nextBox.right-(o.nextCmp.minWidth||o.defaultMin))+o.splitWidth},getVertPrevConstrainLeft:function(o){return o.prevBox.x+(o.prevCmp.minWidth||o.defaultMin)},getVertNextConstrainRight:function(o){return o.nextBox.right-(o.nextCmp.minWidth||o.defaultMin)},getVertNextConstrainLeft:function(o){return(o.nextCmp.maxWidth?o.nextBox.right-o.nextCmp.maxWidth:o.prevBox.x+(o.prevBox.minWidth||o.defaultMin))-o.splitWidth},getResizeOffset:function(){return this.getOffset("dragTarget")}}),Ext.define("Ext.resizer.BorderSplitterTracker",{extend:Ext.resizer.SplitterTracker,getPrevCmp:null,getNextCmp:null,calculateConstrainRegion:function(){var i,neighbor,minRange,maxRange,maxGrowth,maxShrink,targetSize,me=this,splitter=me.splitter,collapseTarget=splitter.collapseTarget,defaultSplitMin=splitter.defaultSplitMin,sizePropCap=splitter.vertical?"Width":"Height",minSizeProp="min"+sizePropCap,maxSizeProp="max"+sizePropCap,getSizeMethod="get"+sizePropCap,neighbors=splitter.neighbors,length=neighbors.length,box=collapseTarget.el.getBox(),left=box.x,top=box.y,right=box.right,bottom=box.bottom,size=splitter.vertical?right-left:bottom-top;for(minRange=(collapseTarget[minSizeProp]||Math.min(size,defaultSplitMin))-size,maxRange=collapseTarget[maxSizeProp],maxRange?maxRange-=size:maxRange=1e9,targetSize=size,i=0;i<length;++i)neighbor=neighbors[i],size=neighbor[getSizeMethod](),maxGrowth=size-neighbor[maxSizeProp],maxShrink=size-(neighbor[minSizeProp]||Math.min(size,defaultSplitMin)),isNaN(maxGrowth)||minRange<maxGrowth&&(minRange=maxGrowth),maxRange>maxShrink&&(maxRange=maxShrink);return maxRange-minRange<2?null:(box=new Ext.util.Region(top,right,bottom,left),me.constraintAdjusters[me.getCollapseDirection()](box,minRange,maxRange,splitter),
me.dragInfo={minRange:minRange,maxRange:maxRange,targetSize:targetSize},box)},constraintAdjusters:{left:function(box,minRange,maxRange,splitter){box[0]=box.x=box.left=box.right+minRange,box.right+=maxRange+splitter.getWidth()},top:function(box,minRange,maxRange,splitter){box[1]=box.y=box.top=box.bottom+minRange,box.bottom+=maxRange+splitter.getHeight()},bottom:function(box,minRange,maxRange,splitter){box.bottom=box.top-minRange,box.top-=maxRange+splitter.getHeight()},right:function(box,minRange,maxRange,splitter){box.right=box.left-minRange,box[0]=box.x=box.left=box.x-maxRange+splitter.getWidth()}},onBeforeStart:function(e){var i,neighbor,me=this,splitter=me.splitter,collapseTarget=splitter.collapseTarget,neighbors=splitter.neighbors,collapseEl=me.getSplitter().collapseEl,target=e.getTarget(),length=neighbors.length;if(collapseEl&&target===splitter.collapseEl.dom)return!1;if(collapseTarget.collapsed)return!1;for(i=0;i<length;++i)if(neighbor=neighbors[i],neighbor.collapsed&&neighbor.isHorz===collapseTarget.isHorz)return!1;return!!(me.constrainTo=me.calculateConstrainRegion())},performResize:function(e,offset){var owner,me=this,splitter=me.splitter,collapseDirection=splitter.getCollapseDirection(),collapseTarget=splitter.collapseTarget,adjusters=me.splitAdjusters[splitter.vertical?"horz":"vert"],delta=offset[adjusters.index],dragInfo=me.dragInfo;"right"!=collapseDirection&&"bottom"!=collapseDirection||(delta=-delta),delta=Math.min(Math.max(dragInfo.minRange,delta),dragInfo.maxRange),delta&&((owner=splitter.ownerCt).suspendLayouts(),adjusters.adjustTarget(collapseTarget,dragInfo.targetSize,delta),owner.resumeLayouts(!0))},splitAdjusters:{horz:{index:0,adjustTarget:function(target,size,delta){target.flex=null,target.setSize(size+delta)}},vert:{index:1,adjustTarget:function(target,targetSize,delta){target.flex=null,target.setSize(void 0,targetSize+delta)}}},getCollapseDirection:function(){return this.splitter.getCollapseDirection()}}),Ext.define("Ext.resizer.Handle",{extend:Ext.Component,handleCls:"",baseHandleCls:Ext.baseCSSPrefix+"resizable-handle",region:"",ariaRole:"presentation",beforeRender:function(){var me=this;me.callParent(),me.protoEl.unselectable(),me.addCls(me.baseHandleCls,me.baseHandleCls+"-"+me.region,me.handleCls)}}),Ext.define("Ext.resizer.ResizeTracker",{extend:Ext.dd.DragTracker,dynamic:!0,preserveRatio:!1,constrainTo:null,proxyCls:Ext.baseCSSPrefix+"resizable-proxy",constructor:function(config){var widthRatio,heightRatio,throttledResizeFn,me=this;config.el||(config.target.isComponent?me.el=config.target.getEl():me.el=config.target),this.callParent(arguments),me.preserveRatio&&me.minWidth&&me.minHeight&&(widthRatio=me.minWidth/me.el.getWidth(),heightRatio=me.minHeight/me.el.getHeight(),heightRatio>widthRatio?me.minWidth=me.el.getWidth()*heightRatio:me.minHeight=me.el.getHeight()*widthRatio),me.throttle&&(throttledResizeFn=Ext.Function.createThrottled(function(){Ext.resizer.ResizeTracker.prototype.resize.apply(me,arguments)},me.throttle),me.resize=function(box,direction,atEnd){atEnd?Ext.resizer.ResizeTracker.prototype.resize.apply(me,arguments):throttledResizeFn.apply(null,arguments)})},onBeforeStart:function(e){this.startBox=this.target.getBox()},getDynamicTarget:function(){var me=this,target=me.target;return me.dynamic?target:(me.proxy||(me.proxy=me.createProxy(target)),me.proxy.show(),me.proxy)},createProxy:function(target){var proxy,cls=this.proxyCls;return proxy=target.isComponent?target.getProxy().addCls(cls):target.createProxy({tag:"div",role:"presentation",cls:cls,id:target.id+"-rzproxy"},Ext.getBody()),proxy.removeCls(Ext.baseCSSPrefix+"proxy-el"),proxy},onStart:function(e){this.activeResizeHandle=Ext.get(this.getDragTarget().id),this.dynamic||this.resize(this.startBox,{horizontal:"none",vertical:"none"})},onDrag:function(e){(this.dynamic||this.proxy)&&this.updateDimensions(e)},updateDimensions:function(e,atEnd){var ratio,snappedWidth,snappedHeight,dragRatio,oppositeCorner,axis,newBox,newHeight,newWidth,me=this,region=me.activeResizeHandle.region,offset=me.getOffset(me.constrainTo?"dragTarget":null),box=me.startBox,widthAdjust=0,heightAdjust=0,adjustX=0,adjustY=0,horizDir=offset[0]<0?"right":"left",vertDir=offset[1]<0?"down":"up";switch(region=me.convertRegionName(region)){case"south":heightAdjust=offset[1],axis=2;break;case"north":heightAdjust=-offset[1],adjustY=-heightAdjust,axis=2;break;case"east":widthAdjust=offset[0],axis=1;break;case"west":widthAdjust=-offset[0],adjustX=-widthAdjust,axis=1;break;case"northeast":heightAdjust=-offset[1],adjustY=-heightAdjust,widthAdjust=offset[0],oppositeCorner=[box.x,box.y+box.height],axis=3;break;case"southeast":heightAdjust=offset[1],widthAdjust=offset[0],oppositeCorner=[box.x,box.y],axis=3;break;case"southwest":widthAdjust=-offset[0],adjustX=-widthAdjust,heightAdjust=offset[1],oppositeCorner=[box.x+box.width,box.y],axis=3;break;case"northwest":heightAdjust=-offset[1],adjustY=-heightAdjust,widthAdjust=-offset[0],adjustX=-widthAdjust,oppositeCorner=[box.x+box.width,box.y+box.height],axis=3}if(newBox={width:box.width+widthAdjust,height:box.height+heightAdjust,x:box.x+adjustX,y:box.y+adjustY},snappedWidth=Ext.Number.snap(newBox.width,me.widthIncrement),snappedHeight=Ext.Number.snap(newBox.height,me.heightIncrement),snappedWidth!=newBox.width||snappedHeight!=newBox.height){switch(region){case"northeast":newBox.y-=snappedHeight-newBox.height;break;case"north":newBox.y-=snappedHeight-newBox.height;break;case"southwest":newBox.x-=snappedWidth-newBox.width;break;case"west":newBox.x-=snappedWidth-newBox.width;break;case"northwest":newBox.x-=snappedWidth-newBox.width,newBox.y-=snappedHeight-newBox.height}newBox.width=snappedWidth,newBox.height=snappedHeight}newBox.width<me.minWidth||newBox.width>me.maxWidth?(newBox.width=Ext.Number.constrain(newBox.width,me.minWidth,me.maxWidth),adjustX&&(newBox.x=box.x+(box.width-newBox.width))):me.lastX=newBox.x,newBox.height<me.minHeight||newBox.height>me.maxHeight?(newBox.height=Ext.Number.constrain(newBox.height,me.minHeight,me.maxHeight),adjustY&&(newBox.y=box.y+(box.height-newBox.height))):me.lastY=newBox.y,(me.preserveRatio||e.shiftKey)&&(ratio=me.startBox.width/me.startBox.height,newHeight=Math.min(Math.max(me.minHeight,newBox.width/ratio),me.maxHeight),newWidth=Math.min(Math.max(me.minWidth,newBox.height*ratio),me.maxWidth),1==axis?newBox.height=newHeight:2==axis?newBox.width=newWidth:(dragRatio=Math.abs(oppositeCorner[0]-this.lastXY[0])/Math.abs(oppositeCorner[1]-this.lastXY[1]),dragRatio>ratio?newBox.height=newHeight:newBox.width=newWidth,"northeast"==region?newBox.y=box.y-(newBox.height-box.height):"northwest"==region?(newBox.y=box.y-(newBox.height-box.height),newBox.x=box.x-(newBox.width-box.width)):"southwest"==region&&(newBox.x=box.x-(newBox.width-box.width)))),0===heightAdjust&&(vertDir="none"),0===widthAdjust&&(horizDir="none"),me.resize(newBox,{horizontal:horizDir,vertical:vertDir},atEnd)},getResizeTarget:function(atEnd){return atEnd?this.target:this.getDynamicTarget()},resize:function(box,direction,atEnd){var me=this,target=me.getResizeTarget(atEnd);target.setBox(box),me.originalTarget&&(me.dynamic||atEnd)&&me.originalTarget.setBox(box)},onEnd:function(e){this.updateDimensions(e,!0),this.proxy&&this.proxy.hide()},convertRegionName:function(name){return name}}),Ext.define("Ext.resizer.Resizer",{mixins:{observable:Ext.util.Observable},alternateClassName:"Ext.Resizable",handleCls:Ext.baseCSSPrefix+"resizable-handle",pinnedCls:Ext.baseCSSPrefix+"resizable-pinned",overCls:Ext.baseCSSPrefix+"resizable-over",wrapCls:Ext.baseCSSPrefix+"resizable-wrap",delimiterRe:/(?:\s*[,;]\s*)|\s+/,dynamic:!0,handles:"s e se",height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:20,minWidth:20,maxHeight:1e4,maxWidth:1e4,pinned:!1,preserveRatio:!1,transparent:!1,possiblePositions:{n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"},ariaRole:"presentation",constructor:function(config){var target,targetEl,tag,handleCls,possibles,len,pos,eastWestStyle,style,box,targetBaseCls,me=this,handles=me.handles,i=0,handleEls=[],unselectableCls=Ext.dom.Element.unselectableCls;for(me.addEvents("beforeresize","resizedrag","resize"),(Ext.isString(config)||Ext.isElement(config)||config.dom)&&(target=config,config=arguments[1]||{},config.target=target),me.mixins.observable.constructor.call(me,config),target=me.target,target?target.isComponent?(target.addClsWithUI("resizable"),me.el=target.getEl(),target.minWidth&&(me.minWidth=target.minWidth),target.minHeight&&(me.minHeight=target.minHeight),target.maxWidth&&(me.maxWidth=target.maxWidth),target.maxHeight&&(me.maxHeight=target.maxHeight),target.floating&&(me.hasOwnProperty("handles")||(me.handles="n ne e se s sw w nw"))):me.el=me.target=Ext.get(target):me.target=me.el=Ext.get(me.el),tag=me.el.dom.tagName.toUpperCase(),"TEXTAREA"!=tag&&"IMG"!=tag&&"TABLE"!=tag||(me.originalTarget=me.target,targetEl=me.el,box=targetEl.getBox(),me.target=me.el=me.el.wrap({role:"presentation",cls:me.wrapCls,id:me.el.id+"-rzwrap",style:targetEl.getStyles("margin-top","margin-bottom")}),me.el.setPositioning(targetEl.getPositioning()),targetEl.clearPositioning(),me.el.setBox(box),targetEl.setStyle("position","absolute")),me.el.position(),me.pinned&&me.el.addCls(me.pinnedCls),me.resizeTracker=new Ext.resizer.ResizeTracker({disabled:me.disabled,target:me.target,constrainTo:me.constrainTo,overCls:me.overCls,throttle:me.throttle,originalTarget:me.originalTarget,delegate:"."+me.handleCls,dynamic:me.dynamic,preserveRatio:me.preserveRatio,heightIncrement:me.heightIncrement,widthIncrement:me.widthIncrement,minHeight:me.minHeight,maxHeight:me.maxHeight,minWidth:me.minWidth,maxWidth:me.maxWidth}),me.resizeTracker.on({mousedown:me.onBeforeResize,drag:me.onResize,dragend:me.onResizeEnd,scope:me}),"all"==me.handles&&(me.handles="n s e w ne nw se sw"),handles=me.handles=me.handles.split(me.delimiterRe),possibles=me.possiblePositions,len=handles.length,handleCls=me.handleCls+" "+me.handleCls+"-{0}",me.target.isComponent&&(targetBaseCls=me.target.baseCls,handleCls+=" "+targetBaseCls+"-handle "+targetBaseCls+"-handle-{0}",Ext.supports.CSS3BorderRadius&&(handleCls+=" "+targetBaseCls+"-handle-{0}-br")),eastWestStyle=Ext.isIE6?' style="height:'+me.el.getHeight()+'px"':"";i<len;i++)handles[i]&&possibles[handles[i]]&&(pos=possibles[handles[i]],style="east"===pos||"west"===pos?eastWestStyle:"",handleEls.push('<div id="',me.el.id,"-",pos,'-handle"',' class="',Ext.String.format(handleCls,pos)," ",unselectableCls,'"',' unselectable="on" role="presentation"',style,"></div>"));for(Ext.DomHelper.append(me.el,handleEls.join("")),i=0;i<len;i++)handles[i]&&possibles[handles[i]]&&(pos=possibles[handles[i]],me[pos]=me.el.getById(me.el.id+"-"+pos+"-handle"),me[pos].region=pos,me.transparent&&me[pos].setOpacity(0));Ext.isNumber(me.width)&&(me.width=Ext.Number.constrain(me.width,me.minWidth,me.maxWidth)),Ext.isNumber(me.height)&&(me.height=Ext.Number.constrain(me.height,me.minHeight,me.maxHeight)),null===me.width&&null===me.height||(me.originalTarget&&(me.originalTarget.setWidth(me.width),me.originalTarget.setHeight(me.height)),me.resizeTo(me.width,me.height)),me.forceHandlesHeight()},disable:function(){this.resizeTracker.disable()},enable:function(){this.resizeTracker.enable()},onBeforeResize:function(tracker,e){var box=this.el.getBox();return this.fireEvent("beforeresize",this,box.width,box.height,e)},onResize:function(tracker,e){var me=this,box=me.el.getBox();return me.forceHandlesHeight(),me.fireEvent("resizedrag",me,box.width,box.height,e)},onResizeEnd:function(tracker,e){var me=this,box=me.el.getBox();return me.forceHandlesHeight(),me.fireEvent("resize",me,box.width,box.height,e)},resizeTo:function(width,height){var me=this;me.target.setSize(width,height),me.fireEvent("resize",me,width,height,null)},getEl:function(){return this.el},getTarget:function(){return this.target},destroy:function(){var i,handle,me=this,handles=me.handles,len=handles.length,positions=me.possiblePositions;for(me.resizeTracker.destroy(),i=0;i<len;i++)(handle=me[positions[handles[i]]])&&handle.remove()},forceHandlesHeight:function(){var handle,me=this;Ext.isIE6&&(handle=me.east,handle&&handle.setHeight(me.el.getHeight()),handle=me.west,handle&&handle.setHeight(me.el.getHeight()),me.el.repaint())}}),Ext.define("Ext.selection.CellModel",{extend:Ext.selection.Model,alias:"selection.cellmodel",isCellModel:!0,enableKeyNav:!0,preventWrap:!1,noSelection:{row:-1,column:-1},constructor:function(){this.addEvents("deselect","select"),this.callParent(arguments)},bindComponent:function(view){var me=this,grid=view.ownerCt;me.primaryView=view,me.views=me.views||[],me.views.push(view),me.bindStore(view.getStore(),!0),view.on({cellclick:me.onCellClick,refresh:me.onViewRefresh,scope:me}),grid.optimizedColumnMove!==!1&&grid.on("columnmove",me.onColumnMove,me),me.enableKeyNav&&me.initKeyNav(view)},initKeyNav:function(view){var me=this;return view.rendered?(view.el.set({tabIndex:-1}),void(me.keyNav=new Ext.util.KeyNav({target:view.el,ignoreInputFields:!0,up:me.onKeyUp,down:me.onKeyDown,right:me.onKeyRight,left:me.onKeyLeft,tab:me.onKeyTab,scope:me}))):void view.on("render",Ext.Function.bind(me.initKeyNav,me,[view],0),me,{single:!0})},getHeaderCt:function(){var selection=this.getCurrentPosition(),view=selection?selection.view:this.primaryView;return view.headerCt},onKeyUp:function(e){this.doMove("up",e)},onKeyDown:function(e){this.doMove("down",e)},onKeyLeft:function(e){this.doMove("left",e)},onKeyRight:function(e){this.doMove("right",e)},doMove:function(direction,e){this.keyNavigation=!0,this.move(direction,e),this.keyNavigation=!1},select:function(pos,keepExisting,suppressEvent){var row,me=this,oldPos=me.getCurrentPosition(),store=me.view.store;(pos||0===pos)&&(pos.isModel?(row=store.indexOf(pos),pos=row!==-1?{row:row,column:oldPos?oldPos.column:0}:null):"number"==typeof pos&&(pos={row:pos,column:0})),pos?me.selectByPosition(pos,suppressEvent):me.deselect()},deselect:function(record,suppressEvent){this.selectByPosition(null,suppressEvent)},move:function(dir,e){var newPos,me=this,pos=me.getCurrentPosition();if(pos&&(newPos=pos.view.walkCells(pos,dir,e,me.preventWrap)))return me.setCurrentPosition(newPos)},getCurrentPosition:function(){return this.selecting?this.nextSelection:this.selection},setCurrentPosition:function(pos,suppressEvent,preventCheck){var me=this,last=me.selection;if(me.lastSelection=last,pos&&(pos=pos.isCellContext?pos:new Ext.grid.CellContext(me.primaryView).setPosition(pos)),!preventCheck&&last&&(pos&&pos.record===last.record&&pos.columnHeader===last.columnHeader&&pos.view===last.view?pos=null:me.onCellDeselect(me.selection,suppressEvent)),pos)return me.nextSelection=pos,me.selecting=!0,me.onCellSelect(me.nextSelection,suppressEvent),me.selecting=!1,me.selection=pos},isCellSelected:function(view,row,column){var testPos,me=this,pos=me.getCurrentPosition();if(pos&&pos.view===view)return testPos=new Ext.grid.CellContext(view).setPosition({row:row,column:column}),testPos.record===pos.record&&testPos.columnHeader===pos.columnHeader},onStoreRemove:function(store,records,indexes){var me=this,pos=me.getCurrentPosition();me.callParent(arguments),pos&&store.getCount()&&store.indexOf(pos.record)!==-1?me.setCurrentPosition({row:pos.record,column:pos.columnHeader},!0,!0):me.selection=null},onStoreAdd:function(){var me=this,pos=me.getCurrentPosition();me.callParent(arguments),pos?me.setCurrentPosition({row:pos.record,column:pos.columnHeader},!0,!0):me.selection=null},onCellClick:function(view,cell,cellIndex,record,row,recordIndex,e){var newPos;recordIndex!==-1&&(newPos=new Ext.grid.CellContext(view).setPosition({view:view,row:row,column:view.ownerCt.getColumnManager().getHeaderAtIndex(cellIndex)}),this.setCurrentPosition(newPos))},onCellSelect:function(position,supressEvent){position&&void 0!==position.row&&position.row>-1&&this.doSelect(position.record,!1,supressEvent)},onCellDeselect:function(position,supressEvent){position&&void 0!==position.row&&this.doDeselect(position.record,supressEvent)},onSelectChange:function(record,isSelected,suppressEvent,commitFn){var pos,eventName,view,me=this;isSelected?(pos=me.nextSelection,eventName="select"):(pos=me.lastSelection||me.noSelection,eventName="deselect"),view=pos.view||me.primaryView,(suppressEvent||me.fireEvent("before"+eventName,me,record,pos.row,pos.column))!==!1&&commitFn()!==!1&&(isSelected?(me.preventFocus||view.focusCell(pos,!0),view.onCellSelect(pos)):(view.onCellDeselect(pos),delete me.selection),suppressEvent||me.fireEvent(eventName,me,record,pos.row,pos.column))},onKeyTab:function(e,t){var editingPlugin,me=this,pos=me.getCurrentPosition();pos&&(editingPlugin=pos.view.editingPlugin,editingPlugin&&me.wasEditing?me.onEditorTab(editingPlugin,e):me.move(e.shiftKey?"left":"right",e))},onEditorTab:function(editingPlugin,e){var me=this,direction=e.shiftKey?"left":"right",position=me.move(direction,e);position&&(editingPlugin.startEdit(position.record,position.columnHeader)?me.wasEditing=!1:(position.view.scrollCellIntoView(position),me.wasEditing=!0))},refresh:function(){var selRowIdx,pos=this.getCurrentPosition();pos&&(selRowIdx=this.store.indexOf(this.selected.last()))!==-1&&(pos.row=selRowIdx)},onColumnMove:function(headerCt,header,fromIdx,toIdx){var grid=headerCt.up("tablepanel");grid&&this.onViewRefresh(grid.view)},onUpdate:function(record){var pos,me=this;me.isSelected(record)&&(pos=me.selecting?me.nextSelection:me.selection,me.view.onCellSelect(pos))},onViewRefresh:function(view){var newPos,record,columnHeader,me=this,pos=me.getCurrentPosition(),headerCt=view.headerCt;pos&&pos.view===view&&(record=pos.record,columnHeader=pos.columnHeader,columnHeader.isDescendantOf(headerCt)||(columnHeader=headerCt.queryById(columnHeader.id)||headerCt.down('[text="'+columnHeader.text+'"]')||headerCt.down('[dataIndex="'+columnHeader.dataIndex+'"]')),pos.record?columnHeader&&view.store.indexOfId(record.getId())!==-1&&(newPos=new Ext.grid.CellContext(view).setPosition({row:record,column:columnHeader}),me.setCurrentPosition(newPos)):me.selection=null)},selectByPosition:function(position,suppressEvent){this.setCurrentPosition(position,suppressEvent)}}),Ext.define("Ext.selection.RowModel",{extend:Ext.selection.Model,alias:"selection.rowmodel",deltaScroll:5,enableKeyNav:!0,ignoreRightMouseSelection:!1,isRowModel:!0,constructor:function(){this.addEvents("beforedeselect","beforeselect","deselect","select"),this.views=[],this.callParent(arguments)},bindComponent:function(view){var me=this;view.on({itemcontextmenu:me.onRowClick,itemclick:me.onRowClick,scope:me}),me.enableKeyNav&&me.initKeyNav(view)},initKeyNav:function(view){var me=this;return view.rendered?(view.el.set({tabIndex:-1}),void(me.keyNav=new Ext.util.KeyNav({target:view,ignoreInputFields:!0,eventName:"itemkeydown",processEvent:function(view,record,node,index,event){return event.record=record,event.recordIndex=index,event},up:me.onKeyUp,down:me.onKeyDown,right:me.onKeyRight,left:me.onKeyLeft,pageDown:me.onKeyPageDown,pageUp:me.onKeyPageUp,home:me.onKeyHome,end:me.onKeyEnd,space:me.onKeySpace,enter:me.onKeyEnter,scope:me}))):void view.on("render",Ext.Function.bind(me.initKeyNav,me,[view],0),me,{single:!0})},onUpdate:function(record){var index,me=this,view=me.view;view&&me.isSelected(record)&&(index=view.indexOf(record),view.onRowSelect(index),record===me.lastFocused&&view.onRowFocus(index,!0))},getRowsVisible:function(){var rowHeight,gridViewHeight,rowsVisible=!1,view=this.views[0],firstRow=view.all.first();return firstRow&&(rowHeight=firstRow.getHeight(),gridViewHeight=view.el.getHeight(),rowsVisible=Math.floor(gridViewHeight/rowHeight)),rowsVisible},onKeyEnd:function(e){var me=this,view=me.views[0];view.bufferedRenderer?view.bufferedRenderer.scrollTo(me.store.getCount()-1,!1,function(newIdx,newRecord){me.afterKeyNavigate(e,newRecord)}):me.afterKeyNavigate(e,view.getRecord(view.all.getCount()-1))},onKeyHome:function(e){var me=this,view=me.views[0];view.bufferedRenderer?view.bufferedRenderer.scrollTo(0,!1,function(newIdx,newRecord){me.afterKeyNavigate(e,newRecord)}):me.afterKeyNavigate(e,view.getRecord(0))},onKeyPageUp:function(e){var newIdx,newRecord,me=this,view=me.views[0],rowsVisible=me.getRowsVisible();rowsVisible&&(view.bufferedRenderer?(newIdx=Math.max(e.recordIndex-rowsVisible,0),(me.lastKeyEvent||(me.lastKeyEvent=new Ext.EventObjectImpl)).setEvent(e.browserEvent),view.bufferedRenderer.scrollTo(newIdx,!1,me.afterBufferedScrollTo,me)):(newRecord=view.walkRecs(e.record,-rowsVisible),me.afterKeyNavigate(e,newRecord)))},onKeyPageDown:function(e){var newIdx,newRecord,me=this,view=me.views[0],rowsVisible=me.getRowsVisible();rowsVisible&&(view.bufferedRenderer?(newIdx=Math.min(e.recordIndex+rowsVisible,me.store.getCount()-1),(me.lastKeyEvent||(me.lastKeyEvent=new Ext.EventObjectImpl)).setEvent(e.browserEvent),view.bufferedRenderer.scrollTo(newIdx,!1,me.afterBufferedScrollTo,me)):(newRecord=view.walkRecs(e.record,rowsVisible),me.afterKeyNavigate(e,newRecord)))},onKeySpace:function(e){var record=this.lastFocused;record&&this.afterKeyNavigate(e,record)},onKeyEnter:Ext.emptyFn,onKeyUp:function(e){var newRecord=this.views[0].walkRecs(e.record,-1);newRecord&&this.afterKeyNavigate(e,newRecord)},onKeyDown:function(e){var newRecord=e.record.isExpandingOrCollapsing?null:this.views[0].walkRecs(e.record,1);newRecord&&this.afterKeyNavigate(e,newRecord)},afterBufferedScrollTo:function(newIdx,newRecord){this.afterKeyNavigate(this.lastKeyEvent,newRecord)},scrollByDeltaX:function(delta){var view=this.views[0],section=view.up(),hScroll=section.horizontalScroller;hScroll&&hScroll.scrollByDeltaX(delta)},onKeyLeft:function(e){this.scrollByDeltaX(-this.deltaScroll)},onKeyRight:function(e){this.scrollByDeltaX(this.deltaScroll)},onRowClick:function(view,record,item,index,e){var me=this;if(index!==-1){if(!me.allowRightMouseSelection(e))return;me.processSelection(view,record,item,index,e)}},processSelection:function(view,record,item,index,e){this.selectWithEvent(record,e)},allowRightMouseSelection:function(e){var disallow=this.ignoreRightMouseSelection&&0!==e.button;return disallow&&(disallow=this.hasSelection()),!disallow},onSelectChange:function(record,isSelected,suppressEvent,commitFn){var me=this,views=me.views,viewsLn=views.length,rowIdx=views[0].indexOf(record),eventName=isSelected?"select":"deselect",i=0;if((suppressEvent||me.fireEvent("before"+eventName,me,record,rowIdx))!==!1&&commitFn()!==!1){for(;i<viewsLn;i++)isSelected?views[i].onRowSelect(rowIdx,suppressEvent):views[i].onRowDeselect(rowIdx,suppressEvent);suppressEvent||me.fireEvent(eventName,me,record,rowIdx)}},onLastFocusChanged:function(oldFocused,newFocused,supressFocus){var rowIdx,views=this.views,viewsLn=views.length,i=0;if(oldFocused&&(rowIdx=views[0].indexOf(oldFocused),rowIdx!=-1))for(;i<viewsLn;i++)views[i].onRowFocus(rowIdx,!1,!0);if(newFocused&&(rowIdx=views[0].indexOf(newFocused),rowIdx!=-1))for(i=0;i<viewsLn;i++)views[i].onRowFocus(rowIdx,!0,supressFocus);this.callParent(arguments)},onEditorTab:function(editingPlugin,e){var lastPos,me=this,view=editingPlugin.context.view,record=editingPlugin.getActiveRecord(),header=editingPlugin.getActiveColumn(),position=view.getPosition(record,header),direction=e.shiftKey?"left":"right";do if(lastPos=position,position=view.walkCells(position,direction,e,me.preventWrap),lastPos&&lastPos.isEqual(position))return;while(position&&(!position.columnHeader.getEditor(record)||!editingPlugin.startEditByPosition(position)))},getCurrentPosition:function(){var firstSelection=this.selected.getAt(0);if(firstSelection)return new Ext.grid.CellContext(this.view).setPosition(this.store.indexOf(firstSelection),0)},selectByPosition:function(position){var context=new Ext.grid.CellContext(this.view);context.setPosition(position.row,position.column),this.select(context.record)},selectNext:function(keepExisting,suppressEvent){var success,me=this,store=me.store,selection=me.getSelection(),record=selection[selection.length-1],index=me.views[0].indexOf(record)+1;return index===store.getCount()||0===index?success=!1:(me.doSelect(index,keepExisting,suppressEvent),success=!0),success},selectPrevious:function(keepExisting,suppressEvent){var success,me=this,selection=me.getSelection(),record=selection[0],index=me.views[0].indexOf(record)-1;return index<0?success=!1:(me.doSelect(index,keepExisting,suppressEvent),success=!0),success},isRowSelected:function(record){return this.isSelected(record)},isCellSelected:function(view,record,columnHeader){return this.isSelected(record)}}),Ext.define("Ext.selection.TreeModel",{extend:Ext.selection.RowModel,alias:"selection.treemodel",constructor:function(config){this.callParent(arguments),this.pruneRemoved&&(this.pruneRemoved=!1,this.pruneRemovedNodes=!0)},bindStore:function(store,initial){var me=this;me.callParent(arguments),me.pruneRemovedNodes&&me.view.mon(me.treeStore,{remove:me.onNodeRemove,scope:me})},onNodeRemove:function(parent,node,isMove){isMove||this.deselectDeletedRecords([node])},onKeyRight:function(e,t){this.navExpand(e,t)},navExpand:function(e,t){var focused=this.getLastFocused(),view=this.view;focused&&(focused.isExpanded()?this.onKeyDown(e,t):focused.isExpandable()&&(view.isTreeView||(view=view.lockingPartner),view.expand(focused)))},onKeyLeft:function(e,t){this.navCollapse(e,t)},navCollapse:function(e,t){var parentNode,me=this,focused=this.getLastFocused(),view=this.view;focused&&(parentNode=focused.parentNode,focused.isExpanded()?(view.isTreeView||(view=view.lockingPartner),view.collapse(focused)):parentNode&&!parentNode.isRoot()&&(e.shiftKey?(me.selectRange(parentNode,focused,e.ctrlKey,"up"),me.setLastFocused(parentNode)):e.ctrlKey?me.setLastFocused(parentNode):me.select(parentNode)))},onKeySpace:function(e,t){null!=e.record.data.checked?this.toggleCheck(e):this.callParent(arguments)},onKeyEnter:function(e,t){null!=e.record.data.checked?this.toggleCheck(e):this.callParent(arguments)},toggleCheck:function(e){var view=this.view,selected=this.getLastSelected();e.stopEvent(),selected&&(view.isTreeView||(view=view.lockingPartner),view.onCheckChange(selected))}}),Ext.define("Ext.slider.Thumb",{topZIndex:1e4,constructor:function(config){var me=this;Ext.apply(me,config||{},{cls:Ext.baseCSSPrefix+"slider-thumb",constrain:!1}),me.callParent([config])},render:function(){var me=this;me.el=me.slider.innerEl.insertFirst(me.getElConfig()),me.onRender()},onRender:function(){this.disabled&&this.disable(),this.initEvents()},getElConfig:function(){var me=this,slider=me.slider,style={};return style[slider.vertical?"bottom":slider.horizontalProp]=slider.calculateThumbPosition(slider.normalizeValue(me.value))+"%",{style:style,id:this.id,cls:this.cls,role:"presentation"}},move:function(v,animate){var to,from,me=this,el=me.el,slider=me.slider,styleProp=slider.vertical?"bottom":slider.horizontalProp;v+="%",animate?(to={},to[styleProp]=v,Ext.supports.GetPositionPercentage||(from={},from[styleProp]=el.dom.style[styleProp]),new Ext.fx.Anim({target:el,duration:350,from:from,to:to})):el.dom.style[styleProp]=v},bringToFront:function(){this.el.setStyle("zIndex",this.topZIndex)},sendToBack:function(){this.el.setStyle("zIndex","")},enable:function(){var me=this;me.disabled=!1,me.el&&me.el.removeCls(me.slider.disabledCls)},disable:function(){var me=this;me.disabled=!0,me.el&&me.el.addCls(me.slider.disabledCls)},initEvents:function(){var me=this,el=me.el;me.tracker=new Ext.dd.DragTracker({onBeforeStart:Ext.Function.bind(me.onBeforeDragStart,me),onStart:Ext.Function.bind(me.onDragStart,me),onDrag:Ext.Function.bind(me.onDrag,me),onEnd:Ext.Function.bind(me.onDragEnd,me),tolerance:3,autoStart:300,overCls:Ext.baseCSSPrefix+"slider-thumb-over"}),me.tracker.initEl(el)},onBeforeDragStart:function(e){return!this.disabled&&(this.slider.promoteThumb(this),!0)},onDragStart:function(e){var me=this,slider=me.slider;slider.onDragStart(me,e),me.el.addCls(Ext.baseCSSPrefix+"slider-thumb-drag"),me.dragging=me.slider.dragging=!0,me.dragStartValue=me.value,slider.fireEvent("dragstart",slider,e,me)},onDrag:function(e){var above,below,me=this,slider=me.slider,index=me.index,newValue=me.getValueFromTracker();void 0!==newValue&&(me.constrain&&(above=slider.thumbs[index+1],below=slider.thumbs[index-1],void 0!==below&&newValue<=below.value&&(newValue=below.value),void 0!==above&&newValue>=above.value&&(newValue=above.value)),slider.setValue(index,newValue,!1),slider.fireEvent("drag",slider,e,me))},getValueFromTracker:function(){var slider=this.slider,trackPoint=slider.getTrackpoint(this.tracker.getXY());if(void 0!==trackPoint)return slider.reversePixelValue(trackPoint)},onDragEnd:function(e){var me=this,slider=me.slider,value=me.value;slider.onDragEnd(me,e),me.el.removeCls(Ext.baseCSSPrefix+"slider-thumb-drag"),me.dragging=slider.dragging=!1,slider.fireEvent("dragend",slider,e),me.dragStartValue!=value&&slider.fireEvent("changecomplete",slider,value,me)},destroy:function(){Ext.destroy(this.tracker)}}),Ext.define("Ext.slider.Tip",{extend:Ext.tip.Tip,minWidth:10,alias:"widget.slidertip",offsets:null,align:null,position:"",defaultVerticalPosition:"left",defaultHorizontalPosition:"top",isSliderTip:!0,init:function(slider){var align,offsets,me=this;switch(me.position||(me.position=slider.vertical?me.defaultVerticalPosition:me.defaultHorizontalPosition),me.position){case"top":offsets=[0,-10],align="b-t?";break;case"bottom":offsets=[0,10],align="t-b?";break;case"left":offsets=[-10,0],align="r-l?";break;case"right":offsets=[10,0],align="l-r?"}me.align||(me.align=align),me.offsets||(me.offsets=offsets),slider.on({scope:me,dragstart:me.onSlide,drag:me.onSlide,dragend:me.hide,destroy:me.destroy})},onSlide:function(slider,e,thumb){var me=this;me.show(),me.update(me.getText(thumb)),me.el.alignTo(thumb.el,me.align,me.offsets)},getText:function(thumb){return String(thumb.value)}}),Ext.define("Ext.slider.Multi",{extend:Ext.form.field.Base,alias:"widget.multislider",alternateClassName:"Ext.slider.MultiSlider",childEls:["endEl","innerEl"],fieldSubTpl:['<div id="{id}" role="{role}" {inputAttrTpl} class="'+Ext.baseCSSPrefix+"slider {fieldCls} {vertical}",'{childElCls}"','<tpl if="tabIdx != null"> tabIndex="{tabIdx}"</tpl>','<tpl if="isVertical"> aria-orientation="vertical"<tpl else> aria-orientation="horizontal"</tpl>',">",'<div id="{cmpId}-endEl" class="'+Ext.baseCSSPrefix+'slider-end" role="presentation">','<div id="{cmpId}-innerEl" class="'+Ext.baseCSSPrefix+'slider-inner" role="presentation">',"{%this.renderThumbs(out, values)%}","</div>","</div>","</div>",{renderThumbs:function(out,values){for(var thumb,thumbConfig,me=values.$comp,i=0,thumbs=me.thumbs,len=thumbs.length;i<len;i++)thumb=thumbs[i],thumbConfig=thumb.getElConfig(),thumbConfig.id=me.id+"-thumb-"+i,Ext.DomHelper.generateMarkup(thumbConfig,out)},disableFormats:!0}],horizontalProp:"left",vertical:!1,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:!0,animate:!0,dragging:!1,constrainThumbs:!0,componentLayout:"sliderfield",useTips:!0,tipText:null,ariaRole:"slider",initValue:function(){var me=this,extValue=Ext.value,values=extValue(me.values,[extValue(me.value,extValue(me.minValue,0))]),i=0,len=values.length;for(me.originalValue=values;i<len;i++)me.addThumb(values[i])},initComponent:function(){var tipPlug,hasTip,p,pLen,plugins,me=this;if(me.thumbs=[],me.keyIncrement=Math.max(me.increment,me.keyIncrement),me.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend"),me.callParent(),me.useTips){for(tipPlug=Ext.isObject(me.useTips)?Ext.apply({},me.useTips):me.tipText?{getText:me.tipText}:{},plugins=me.plugins=me.plugins||[],pLen=plugins.length,p=0;p<pLen;p++)if(plugins[p].isSliderTip){hasTip=!0;break}hasTip||me.plugins.push(new Ext.slider.Tip(tipPlug))}},addThumb:function(value){var me=this,thumb=new Ext.slider.Thumb({ownerCt:me,ownerLayout:me.getComponentLayout(),value:value,slider:me,index:me.thumbs.length,constrain:me.constrainThumbs,disabled:!!me.readOnly
});return me.thumbs.push(thumb),me.rendered&&thumb.render(),thumb},promoteThumb:function(topThumb){var thumb,i,thumbs=this.thumbs,ln=thumbs.length;for(i=0;i<ln;i++)thumb=thumbs[i],thumb==topThumb?thumb.bringToFront():thumb.sendToBack()},getSubTplData:function(){var me=this;return Ext.apply(me.callParent(),{$comp:me,isVertical:me.vertical,vertical:me.vertical?Ext.baseCSSPrefix+"slider-vert":Ext.baseCSSPrefix+"slider-horz",minValue:me.minValue,maxValue:me.maxValue,value:me.value,tabIdx:me.tabIndex,childElCls:""})},onRender:function(){var thumb,me=this,thumbs=me.thumbs,len=thumbs.length,i=0;for(me.callParent(arguments),i=0;i<len;i++)thumb=thumbs[i],thumb.el=me.el.getById(me.id+"-thumb-"+i),thumb.onRender()},initEvents:function(){var me=this;me.mon(me.el,{scope:me,mousedown:me.onMouseDown,keydown:me.onKeyDown})},onDragStart:Ext.emptyFn,onDragEnd:Ext.emptyFn,getTrackpoint:function(xy){var trackLength,result,positionProperty,me=this,vertical=me.vertical,sliderTrack=me.innerEl;return vertical?(positionProperty="top",trackLength=sliderTrack.getHeight()):(positionProperty=me.horizontalProp,trackLength=sliderTrack.getWidth()),xy=me.transformTrackPoints(sliderTrack.translatePoints(xy)),result=Ext.Number.constrain(xy[positionProperty],0,trackLength),vertical?trackLength-result:result},transformTrackPoints:Ext.identityFn,onMouseDown:function(e){var trackPoint,me=this,thumbClicked=!1,i=0,thumbs=me.thumbs,len=thumbs.length;if(!me.disabled){for(;i<len;i++)thumbClicked=thumbClicked||e.target==thumbs[i].el.dom;me.clickToChange&&!thumbClicked&&(trackPoint=me.getTrackpoint(e.getXY()),void 0!==trackPoint&&me.onClickChange(trackPoint)),me.focus()}},onClickChange:function(trackPoint){var thumb,index,me=this;thumb=me.getNearest(trackPoint),thumb.disabled||(index=thumb.index,me.setValue(index,Ext.util.Format.round(me.reversePixelValue(trackPoint),me.decimalPrecision),void 0,!0))},getNearest:function(trackPoint){for(var thumb,value,dist,me=this,clickValue=me.reversePixelValue(trackPoint),nearestDistance=me.getRange()+5,nearest=null,thumbs=me.thumbs,i=0,len=thumbs.length;i<len;i++)thumb=me.thumbs[i],value=thumb.value,dist=Math.abs(value-clickValue),Math.abs(dist<=nearestDistance)&&(nearest=thumb,nearestDistance=dist);return nearest},onKeyDown:function(e){var k,val,me=this;if(me.disabled||1!==me.thumbs.length)return void e.preventDefault();switch(k=e.getKey()){case e.UP:case e.RIGHT:e.stopEvent(),val=e.ctrlKey?me.maxValue:me.getValue(0)+me.keyIncrement,me.setValue(0,val,void 0,!0);break;case e.DOWN:case e.LEFT:e.stopEvent(),val=e.ctrlKey?me.minValue:me.getValue(0)-me.keyIncrement,me.setValue(0,val,void 0,!0);break;default:e.preventDefault()}},normalizeValue:function(v){var me=this,snapFn=me.zeroBasedSnapping?"snap":"snapInRange";return v=Ext.Number[snapFn](v,me.increment,me.minValue,me.maxValue),v=Ext.util.Format.round(v,me.decimalPrecision),v=Ext.Number.constrain(v,me.minValue,me.maxValue)},setMinValue:function(val){var thumb,i,me=this,thumbs=me.thumbs,len=thumbs.length;for(me.minValue=val,i=0;i<len;++i)thumb=thumbs[i],thumb.value<val&&me.setValue(i,val,!1);me.syncThumbs()},setMaxValue:function(val){var thumb,i,me=this,thumbs=me.thumbs,len=thumbs.length;for(me.maxValue=val,i=0;i<len;++i)thumb=thumbs[i],thumb.value>val&&me.setValue(i,val,!1);me.syncThumbs()},setValue:function(index,value,animate,changeComplete){var thumb,len,i,values,me=this,thumbs=me.thumbs;if(Ext.isArray(index)){for(values=index,animate=value,i=0,len=values.length;i<len;++i)thumb=thumbs[i],thumb&&me.setValue(i,values[i],animate);return me}return thumb=me.thumbs[index],value=me.normalizeValue(value),value!==thumb.value&&me.fireEvent("beforechange",me,value,thumb.value,thumb)!==!1&&(thumb.value=value,me.rendered&&(thumb.move(me.calculateThumbPosition(value),Ext.isDefined(animate)?animate!==!1:me.animate),me.fireEvent("change",me,value,thumb),me.checkDirty(),changeComplete&&me.fireEvent("changecomplete",me,value,thumb))),me},calculateThumbPosition:function(v){var me=this,minValue=me.minValue,pos=(v-minValue)/me.getRange()*100;return isNaN(pos)&&(pos=minValue),pos},getRatio:function(){var me=this,innerEl=me.innerEl,trackLength=me.vertical?innerEl.getHeight():innerEl.getWidth(),valueRange=me.getRange();return 0===valueRange?trackLength:trackLength/valueRange},getRange:function(){return this.maxValue-this.minValue},reversePixelValue:function(pos){return this.minValue+pos/this.getRatio()},reversePercentageValue:function(pos){return this.minValue+this.getRange()*(pos/100)},onDisable:function(){var thumb,el,xy,me=this,i=0,thumbs=me.thumbs,len=thumbs.length;for(me.callParent();i<len;i++)thumb=thumbs[i],el=thumb.el,thumb.disable(),Ext.isIE&&(xy=el.getXY(),el.hide(),me.innerEl.addCls(me.disabledCls).dom.disabled=!0,me.thumbHolder||(me.thumbHolder=me.endEl.createChild({role:"presentation",cls:Ext.baseCSSPrefix+"slider-thumb "+me.disabledCls})),me.thumbHolder.show().setXY(xy))},onEnable:function(){var thumb,el,me=this,i=0,thumbs=me.thumbs,len=thumbs.length;for(this.callParent();i<len;i++)thumb=thumbs[i],el=thumb.el,thumb.enable(),Ext.isIE&&(me.innerEl.removeCls(me.disabledCls).dom.disabled=!1,me.thumbHolder&&me.thumbHolder.hide(),el.show(),me.syncThumbs())},syncThumbs:function(){if(this.rendered)for(var thumbs=this.thumbs,length=thumbs.length,i=0;i<length;i++)thumbs[i].move(this.calculateThumbPosition(thumbs[i].value))},getValue:function(index){return Ext.isNumber(index)?this.thumbs[index].value:this.getValues()},getValues:function(){for(var values=[],i=0,thumbs=this.thumbs,len=thumbs.length;i<len;i++)values.push(thumbs[i].value);return values},getSubmitValue:function(){var me=this;return me.disabled||!me.submitValue?null:me.getValue()},reset:function(){for(var val,me=this,arr=[].concat(me.originalValue),a=0,aLen=arr.length;a<aLen;a++)val=arr[a],me.setValue(a,val);me.clearInvalid(),delete me.wasValid},setReadOnly:function(readOnly){var me=this,thumbs=me.thumbs,len=thumbs.length,i=0;for(me.callParent(arguments),readOnly=me.readOnly;i<len;++i)readOnly?thumbs[i].disable():thumbs[i].enable()},beforeDestroy:function(){var thumb,me=this,thumbs=me.thumbs,t=0,tLen=thumbs.length;for(Ext.destroy(me.innerEl,me.endEl,me.focusEl);t<tLen;t++)thumb=thumbs[t],Ext.destroy(thumb);me.callParent()}}),Ext.define("Ext.tab.Tab",{extend:Ext.button.Button,alias:"widget.tab",isTab:!0,baseCls:Ext.baseCSSPrefix+"tab",closeElOverCls:Ext.baseCSSPrefix+"tab-close-btn-over",activeCls:"active",closableCls:"closable",closable:!0,closeText:"Close Tab",active:!1,childEls:["closeEl"],scale:!1,position:"top",ariaRole:"tab",initComponent:function(){var me=this;me.addEvents("activate","deactivate","beforeclose","close"),me.callParent(arguments),me.card&&me.setCard(me.card),me.overCls=["over",me.position+"-over"]},getTemplateArgs:function(){var me=this,result=me.callParent();return result.closable=me.closable,result.closeText=me.closeText,result},getFramingInfoCls:function(){return this.baseCls+"-"+this.ui+"-"+this.position},beforeRender:function(){var me=this,tabBar=me.up("tabbar"),tabPanel=me.up("tabpanel");me.callParent(),me.addClsWithUI(me.position),me.active&&me.addClsWithUI([me.activeCls,me.position+"-"+me.activeCls]),me.syncClosableUI(),me.minWidth||(me.minWidth=tabBar?tabBar.minTabWidth:me.minWidth,!me.minWidth&&tabPanel&&(me.minWidth=tabPanel.minTabWidth),me.minWidth&&me.iconCls&&(me.minWidth+=25)),me.maxWidth||(me.maxWidth=tabBar?tabBar.maxTabWidth:me.maxWidth,!me.maxWidth&&tabPanel&&(me.maxWidth=tabPanel.maxTabWidth))},onRender:function(){var me=this;me.setElOrientation(),me.callParent(arguments),me.closable&&me.closeEl.addClsOnOver(me.closeElOverCls),me.initKeyNav()},initKeyNav:function(){var me=this;me.keyNav=new Ext.util.KeyNav(me.el,{enter:me.onEnterKey,del:me.onDeleteKey,scope:me})},setElOrientation:function(){var position=this.position;"left"!==position&&"right"!==position||this.el.setVertical("right"===position?90:270)},enable:function(silent){var me=this;return me.callParent(arguments),me.removeClsWithUI(me.position+"-disabled"),me},disable:function(silent){var me=this;return me.callParent(arguments),me.addClsWithUI(me.position+"-disabled"),me},onDestroy:function(){var me=this;Ext.destroy(me.keyNav),delete me.keyNav,me.callParent(arguments)},setClosable:function(closable){var me=this;closable=!arguments.length||!!closable,me.closable!=closable&&(me.closable=closable,me.card&&(me.card.closable=closable),me.syncClosableUI(),me.rendered&&(me.syncClosableElements(),me.updateLayout()))},syncClosableElements:function(){var me=this,closeEl=me.closeEl;me.closable?(closeEl||(closeEl=me.closeEl=me.btnWrap.insertSibling({tag:"a",role:"presentation",cls:me.baseCls+"-close-btn",href:"#",title:me.closeText},"after")),closeEl.addClsOnOver(me.closeElOverCls)):closeEl&&(closeEl.remove(),delete me.closeEl)},syncClosableUI:function(){var me=this,classes=[me.closableCls,me.closableCls+"-"+me.position];me.closable?me.addClsWithUI(classes):me.removeClsWithUI(classes)},setCard:function(card){var me=this;me.card=card,me.setText(me.title||card.title),me.setIconCls(me.iconCls||card.iconCls),me.setIcon(me.icon||card.icon),me.setGlyph(me.glyph||card.glyph)},onCloseClick:function(){var me=this;if(me.fireEvent("beforeclose",me)!==!1)if(me.tabBar){if(me.tabBar.closeTab(me)===!1)return}else me.fireClose()},fireClose:function(){this.fireEvent("close",this)},onEnterKey:function(e){var me=this;me.tabBar&&me.tabBar.onClick(e,me.el)},onDeleteKey:function(e){this.closable&&this.onCloseClick()},activate:function(supressEvent){var me=this;me.active=!0,me.addClsWithUI([me.activeCls,me.position+"-"+me.activeCls]),supressEvent!==!0&&me.fireEvent("activate",me)},deactivate:function(supressEvent){var me=this;me.active=!1,me.removeClsWithUI([me.activeCls,me.position+"-"+me.activeCls]),supressEvent!==!0&&me.fireEvent("deactivate",me)}}),Ext.define("Ext.util.Point",{extend:Ext.util.Region,statics:{fromEvent:function(e){return e=e.browserEvent||e,e=e.changedTouches&&e.changedTouches.length>0?e.changedTouches[0]:e,new this(e.pageX,e.pageY)}},constructor:function(x,y){this.callParent([y,x,y,x])},toString:function(){return"Point["+this.x+","+this.y+"]"},equals:function(p){return this.x==p.x&&this.y==p.y},isWithin:function(p,threshold){return Ext.isObject(threshold)||(threshold={x:threshold,y:threshold}),this.x<=p.x+threshold.x&&this.x>=p.x-threshold.x&&this.y<=p.y+threshold.y&&this.y>=p.y-threshold.y},isContainedBy:function(region){return region instanceof Ext.util.Region||(region=Ext.get(region.el||region).getRegion()),region.contains(this)},roundedEquals:function(p){return Math.round(this.x)==Math.round(p.x)&&Math.round(this.y)==Math.round(p.y)}},function(){this.prototype.translate=Ext.util.Region.prototype.translateBy}),Ext.define("Ext.tab.Bar",{extend:Ext.panel.Header,alias:"widget.tabbar",baseCls:Ext.baseCSSPrefix+"tab-bar",isTabBar:!0,defaultType:"tab",plain:!1,ariaRole:"tablist",childEls:["body","strip"],renderTpl:['<div id="{id}-body" role="presentation" class="{baseCls}-body {bodyCls} {bodyTargetCls}{childElCls}','<tpl if="ui"> {baseCls}-body-{ui}','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>','</tpl>"<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values)%}","</div>",'<div id="{id}-strip" role="presentation" class="{baseCls}-strip {baseCls}-strip-{dock}{childElCls}','<tpl if="ui"> {baseCls}-strip-{ui}','<tpl for="uiCls"> {parent.baseCls}-strip-{parent.ui}-{.}</tpl>','</tpl>">',"</div>"],_reverseDockNames:{left:"right",right:"left"},initComponent:function(){var me=this;me.plain&&me.addCls(me.baseCls+"-plain"),me.addClsWithUI(me.orientation),me.addEvents("change"),me.callParent(arguments),Ext.merge(me.layout,me.initialConfig.layout),me.layout.align="vertical"==me.orientation?"left":"top",me.layout.overflowHandler=new Ext.layout.container.boxOverflow.Scroller(me.layout),me.remove(me.titleCmp),delete me.titleCmp,Ext.apply(me.renderData,{bodyCls:me.bodyCls,dock:me.dock})},onRender:function(){var me=this;me.callParent(),"vertical"===me.orientation&&(Ext.isIE8||Ext.isIE9)&&Ext.isStrict&&me.el.on({mousemove:me.onMouseMove,scope:me})},afterRender:function(){var layout=this.layout;this.callParent(),Ext.isIE9&&Ext.isStrict&&"vertical"===this.orientation&&layout.innerCt.on("scroll",function(){layout.innerCt.dom.scrollLeft=0})},afterLayout:function(){this.adjustTabPositions(),this.callParent(arguments)},adjustTabPositions:function(){var tab,items=this.items.items,i=items.length;if(!Ext.isIE9m)if("right"===this.dock)for(;i--;)tab=items[i],tab.isVisible()&&tab.el.setStyle("left",tab.lastBox.width+"px");else if("left"===this.dock)for(;i--;)tab=items[i],tab.isVisible()&&tab.el.setStyle("left",-tab.lastBox.height+"px")},getLayout:function(){var me=this;return me.layout.type="horizontal"===me.orientation?"hbox":"vbox",me.callParent(arguments)},onAdd:function(tab){tab.position=this.dock,this.callParent(arguments)},onRemove:function(tab){var me=this;tab===me.previousTab&&(me.previousTab=null),me.callParent(arguments)},afterComponentLayout:function(width){var me=this,needsScroll=me.needsScroll;me.callParent(arguments),needsScroll&&me.layout.overflowHandler.scrollToItem(me.activeTab),delete me.needsScroll},onClick:function(e,target){var tabEl,tab,isCloseClick,tabInfo,me=this,tabPanel=me.tabPanel;e.getTarget("."+Ext.baseCSSPrefix+"box-scroller")||("vertical"===me.orientation&&(Ext.isIE8||Ext.isIE9)&&Ext.isStrict?(tabInfo=me.getTabInfoFromPoint(e.getXY()),tab=tabInfo.tab,isCloseClick=tabInfo.close):(tabEl=e.getTarget("."+Ext.tab.Tab.prototype.baseCls),tab=tabEl&&Ext.getCmp(tabEl.id),isCloseClick=tab&&tab.closeEl&&target===tab.closeEl.dom),isCloseClick&&e.preventDefault(),tab&&tab.isDisabled&&!tab.isDisabled()&&(tab.closable&&isCloseClick?tab.onCloseClick():(tabPanel?tabPanel.setActiveTab(tab.card):me.setActiveTab(tab),tab.focus())))},onMouseMove:function(e){var tabInfo,tab,me=this,overTab=me._overTab;e.getTarget("."+Ext.baseCSSPrefix+"box-scroller")||(tabInfo=me.getTabInfoFromPoint(e.getXY()),tab=tabInfo.tab,tab!==overTab&&(overTab&&overTab.rendered&&(overTab.onMouseLeave(e),me._overTab=null),tab?(tab.onMouseEnter(e),me._overTab=tab,tab.disabled||me.el.setStyle("cursor","pointer")):me.el.setStyle("cursor","default")))},onMouseLeave:function(e){var overTab=this._overTab;overTab&&overTab.rendered&&overTab.onMouseLeave(e)},getTabInfoFromPoint:function(xy){for(var lastBox,tabRegion,closeEl,close,closeXY,closeX,closeY,closeWidth,closeHeight,tabX,tabY,tabWidth,tabHeight,closeRegion,isTabReversed,direction,tab,me=this,tabs=me.items.items,length=tabs.length,innerCt=me.layout.innerCt,innerCtXY=innerCt.getXY(),point=new Ext.util.Point(xy[0],xy[1]),i=0;i<length;i++)if(lastBox=tabs[i].lastBox,tabX=innerCtXY[0]+lastBox.x,tabY=innerCtXY[1]-innerCt.dom.scrollTop+lastBox.y,tabWidth=lastBox.width,tabHeight=lastBox.height,tabRegion=new Ext.util.Region(tabY,tabX+tabWidth,tabY+tabHeight,tabX),tabRegion.contains(point)){tab=tabs[i],closeEl=tab.closeEl,closeEl&&(void 0===me._isTabReversed&&(me._isTabReversed=isTabReversed=tab.btnWrap.dom.currentStyle.filter.indexOf("rotation=2")!==-1),direction=isTabReversed?this._reverseDockNames[me.dock]:me.dock,closeWidth=closeEl.getWidth(),closeHeight=closeEl.getHeight(),closeXY=me.getCloseXY(closeEl,tabX,tabY,tabWidth,tabHeight,closeWidth,closeHeight,direction),closeX=closeXY[0],closeY=closeXY[1],closeRegion=new Ext.util.Region(closeY,closeX+closeWidth,closeY+closeHeight,closeX),close=closeRegion.contains(point));break}return{tab:tab,close:close}},getCloseXY:function(closeEl,tabX,tabY,tabWidth,tabHeight,closeWidth,closeHeight,direction){var closeX,closeY,closeXY=closeEl.getXY();return"right"===direction?(closeX=tabX+tabWidth-(closeXY[1]-tabY+closeHeight),closeY=tabY+(closeXY[0]-tabX)):(closeX=tabX+(closeXY[1]-tabY),closeY=tabY+tabX+tabHeight-closeXY[0]-closeWidth),[closeX,closeY]},closeTab:function(toClose){var toActivate,me=this,card=toClose.card,tabPanel=me.tabPanel;if(card&&card.fireEvent("beforeclose",card)===!1)return!1;if(toActivate=me.findNextActivatable(toClose),Ext.suspendLayouts(),tabPanel&&card){if(delete toClose.ownerCt,card.fireEvent("close",card),tabPanel.remove(card),tabPanel.getComponent(card))return toClose.ownerCt=me,Ext.resumeLayouts(!0),!1;toClose.fireClose(),me.remove(toClose)}toActivate&&(tabPanel?tabPanel.setActiveTab(toActivate.card):me.setActiveTab(toActivate),toActivate.focus()),Ext.resumeLayouts(!0)},findNextActivatable:function(toClose){var me=this;if(toClose.active&&me.items.getCount()>1)return me.previousTab&&me.previousTab!==toClose&&!me.previousTab.disabled?me.previousTab:toClose.next("tab[disabled=false]")||toClose.prev("tab[disabled=false]")},setActiveTab:function(tab,initial){var me=this;tab.disabled||tab===me.activeTab||(me.activeTab&&(me.activeTab.isDestroyed?me.previousTab=null:(me.previousTab=me.activeTab,me.activeTab.deactivate())),tab.activate(),me.activeTab=tab,me.needsScroll=!0,initial||(me.fireEvent("change",me,tab,tab.card),me.updateLayout()))}}),Ext.define("Ext.tree.Column",{extend:Ext.grid.column.Column,alias:"widget.treecolumn",tdCls:Ext.baseCSSPrefix+"grid-cell-treecolumn",autoLock:!0,lockable:!1,draggable:!1,hideable:!1,iconCls:Ext.baseCSSPrefix+"tree-icon",checkboxCls:Ext.baseCSSPrefix+"tree-checkbox",elbowCls:Ext.baseCSSPrefix+"tree-elbow",expanderCls:Ext.baseCSSPrefix+"tree-expander",textCls:Ext.baseCSSPrefix+"tree-node-text",innerCls:Ext.baseCSSPrefix+"grid-cell-inner-treecolumn",isTreeColumn:!0,cellTpl:['<tpl for="lines">','<img src="{parent.blankUrl}" class="{parent.childCls} {parent.elbowCls}-img ','{parent.elbowCls}-<tpl if=".">line<tpl else>empty</tpl>" role="presentation"/>',"</tpl>",'<img src="{blankUrl}" class="{childCls} {elbowCls}-img {elbowCls}','<tpl if="isLast">-end</tpl><tpl if="expandable">-plus {expanderCls}</tpl>" role="presentation"/>','<tpl if="checked !== null">','<input type="button" {ariaCellCheckboxAttr}',' class="{childCls} {checkboxCls}<tpl if="checked"> {checkboxCls}-checked</tpl>"/>',"</tpl>",'<img src="{blankUrl}" role="presentation" class="{childCls} {baseIconCls} ','{baseIconCls}-<tpl if="leaf">leaf<tpl else>parent</tpl> {iconCls}"','<tpl if="icon">style="background-image:url({icon})"</tpl>/>','<tpl if="href">','<a href="{href}" role="link" target="{hrefTarget}" class="{textCls} {childCls}">{value}</a>',"<tpl else>",'<span class="{textCls} {childCls}">{value}</span>',"</tpl>"],initComponent:function(){var me=this,renderer=me.renderer;"string"==typeof renderer&&(renderer=Ext.util.Format[renderer]),me.origRenderer=renderer,me.origScope=me.scope||window,me.renderer=me.treeRenderer,me.scope=me,me.callParent()},treeRenderer:function(value,metaData,record,rowIdx,colIdx,store,view){var rendererData,me=this,cls=record.get("cls");return cls&&(metaData.tdCls+=" "+cls),rendererData=me.initTemplateRendererData(value,metaData,record,rowIdx,colIdx,store,view),me.getTpl("cellTpl").apply(rendererData)},initTemplateRendererData:function(value,metaData,record,rowIdx,colIdx,store,view){for(var parentData,me=this,renderer=me.origRenderer,data=record.data,parent=record.parentNode,rootVisible=view.rootVisible,lines=[];parent&&(rootVisible||parent.data.depth>0);)parentData=parent.data,lines[rootVisible?parentData.depth:parentData.depth-1]=parentData.isLast?0:1,parent=parent.parentNode;return{record:record,baseIconCls:me.iconCls,iconCls:data.iconCls,icon:data.icon,checkboxCls:me.checkboxCls,checked:data.checked,elbowCls:me.elbowCls,expanderCls:me.expanderCls,textCls:me.textCls,leaf:data.leaf,expandable:record.isExpandable(),isLast:data.isLast,blankUrl:Ext.BLANK_IMAGE_URL,href:data.href,hrefTarget:data.hrefTarget,lines:lines,metaData:metaData,childCls:me.getChildCls?me.getChildCls()+" ":"",value:renderer?renderer.apply(me.origScope,arguments):value}}}),Ext.define("Ext.selection.CheckboxModel",{alias:"selection.checkboxmodel",extend:Ext.selection.RowModel,mode:"MULTI",injectCheckbox:0,checkOnly:!1,showHeaderCheckbox:void 0,checkSelector:"."+Ext.baseCSSPrefix+"grid-row-checker",headerWidth:24,checkerOnCls:Ext.baseCSSPrefix+"grid-hd-checker-on",constructor:function(){var me=this;me.callParent(arguments),"SINGLE"===me.mode&&me.showHeaderCheckbox!==!0&&(me.showHeaderCheckbox=!1)},beforeViewRender:function(view){var owner,me=this;me.callParent(arguments),me.hasLockedHeader()&&!view.headerCt.lockedCt||(me.showHeaderCheckbox!==!1&&view.headerCt.on("headerclick",me.onHeaderClick,me),me.addCheckbox(view,!0),owner=view.ownerCt,view.headerCt.lockedCt&&(owner=owner.ownerCt),me.mon(owner,"reconfigure",me.onReconfigure,me))},bindComponent:function(view){var me=this;me.sortable=!1,me.callParent(arguments)},hasLockedHeader:function(){var v,views=this.views,vLen=views.length;for(v=0;v<vLen;v++)if(views[v].headerCt.lockedCt)return!0;return!1},addCheckbox:function(view,initial){var me=this,checkbox=me.injectCheckbox,headerCt=view.headerCt;checkbox!==!1&&("first"==checkbox?checkbox=0:"last"==checkbox&&(checkbox=headerCt.getColumnCount()),Ext.suspendLayouts(),view.getStore().buffered&&(me.showHeaderCheckbox=!1),headerCt.add(checkbox,me.getHeaderConfig()),Ext.resumeLayouts()),initial!==!0&&view.refresh()},onReconfigure:function(grid,store,columns){columns&&this.addCheckbox(this.views[0])},toggleUiHeader:function(isChecked){var view=this.views[0],headerCt=view.headerCt,checkHd=headerCt.child("gridcolumn[isCheckerHd]"),cls=this.checkerOnCls;checkHd&&(isChecked?checkHd.addCls(cls):checkHd.removeCls(cls))},onHeaderClick:function(headerCt,header,e){if(header.isCheckerHd){e.stopEvent();var me=this,isChecked=header.el.hasCls(Ext.baseCSSPrefix+"grid-hd-checker-on");me.preventFocus=!0,isChecked?me.deselectAll():me.selectAll(),delete me.preventFocus}},getHeaderConfig:function(){var me=this,showCheck=me.showHeaderCheckbox!==!1;return{isCheckerHd:showCheck,text:"&#160;",clickTargetName:"el",width:me.headerWidth,sortable:!1,draggable:!1,resizable:!1,hideable:!1,menuDisabled:!0,dataIndex:"",cls:showCheck?Ext.baseCSSPrefix+"column-header-checkbox ":"",renderer:Ext.Function.bind(me.renderer,me),editRenderer:me.editRenderer||me.renderEmpty,locked:me.hasLockedHeader()}},renderEmpty:function(){return"&#160;"},refresh:function(){this.callParent(arguments),this.updateHeaderState()},renderer:function(value,metaData,record,rowIndex,colIndex,store,view){var baseCSSPrefix=Ext.baseCSSPrefix;return metaData.tdCls=baseCSSPrefix+"grid-cell-special "+baseCSSPrefix+"grid-cell-row-checker",'<div class="'+baseCSSPrefix+'grid-row-checker" role="presentation">&#160;</div>'},processSelection:function(view,record,item,index,e){var mode,me=this,checker=e.getTarget(me.checkSelector);me.checkOnly&&!checker||(checker?(mode=me.getSelectionMode(),"SINGLE"!==mode&&me.setSelectionMode("SIMPLE"),me.selectWithEvent(record,e),me.setSelectionMode(mode)):me.selectWithEvent(record,e))},onSelectChange:function(){this.callParent(arguments),this.suspendChange||this.updateHeaderState()},onStoreLoad:function(){this.callParent(arguments),this.updateHeaderState()},onStoreAdd:function(){this.callParent(arguments),this.updateHeaderState()},onStoreRemove:function(){this.callParent(arguments),this.updateHeaderState()},onStoreRefresh:function(){this.callParent(arguments),this.updateHeaderState()},maybeFireSelectionChange:function(fireEvent){fireEvent&&!this.suspendChange&&this.updateHeaderState(),this.callParent(arguments)},resumeChanges:function(){this.callParent(),this.suspendChange||this.updateHeaderState()},updateHeaderState:function(){var selected,len,i,me=this,store=me.store,storeCount=store.getCount(),views=me.views,hdSelectStatus=!1,selectedCount=0;if(!store.buffered&&storeCount>0){for(selected=me.selected,hdSelectStatus=!0,i=0,len=selected.getCount();i<len&&me.storeHasSelected(selected.getAt(i));++i)++selectedCount;hdSelectStatus=storeCount===selectedCount}views&&views.length&&me.toggleUiHeader(hdSelectStatus)}}),Ext.define("Ext.slider.Single",{extend:Ext.slider.Multi,alias:["widget.slider","widget.sliderfield"],alternateClassName:["Ext.Slider","Ext.form.SliderField","Ext.slider.SingleSlider","Ext.slider.Slider"],getValue:function(){return this.callParent([0])},setValue:function(value,animate){var args=arguments,len=args.length;return(1==len||len<=3&&"number"!=typeof args[1])&&(args=Ext.toArray(args),args.unshift(0)),this.callParent(args)},getNearest:function(){return this.thumbs[0]}}),Ext.define("Ext.state.CookieProvider",{extend:Ext.state.Provider,constructor:function(config){var me=this;me.path="/",me.expires=new Date(Ext.Date.now()+6048e5),me.domain=null,me.secure=!1,me.callParent(arguments),me.state=me.readCookies()},set:function(name,value){var me=this;return"undefined"==typeof value||null===value?void me.clear(name):(me.setCookie(name,value),void me.callParent(arguments))},clear:function(name){this.clearCookie(name),this.callParent(arguments)},readCookies:function(){for(var matches,name,value,cookies={},c=document.cookie+";",re=/\s?(.*?)=(.*?);/g,prefix=this.prefix,len=prefix.length;null!=(matches=re.exec(c));)name=matches[1],value=matches[2],name&&name.substring(0,len)==prefix&&(cookies[name.substr(len)]=this.decodeValue(value));return cookies},setCookie:function(name,value){var me=this;document.cookie=me.prefix+name+"="+me.encodeValue(value)+(null==me.expires?"":"; expires="+me.expires.toGMTString())+(null==me.path?"":"; path="+me.path)+(null==me.domain?"":"; domain="+me.domain)+(1==me.secure?"; secure":"")},clearCookie:function(name){var me=this;document.cookie=me.prefix+name+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+(null==me.path?"":"; path="+me.path)+(null==me.domain?"":"; domain="+me.domain)+(1==me.secure?"; secure":"")}}),Ext.define("Ext.util.LocalStorage",{id:null,destroyed:!1,lazyKeys:!0,prefix:"",session:!1,_keys:null,_store:null,_users:0,statics:{cache:{},get:function(id){var instance,me=this,cache=me.cache,config={_users:1};return Ext.isString(id)?config.id=id:Ext.apply(config,id),(instance=cache[config.id])?++instance._users:instance=new me(config),instance},supported:!0},constructor:function(config){var me=this;Ext.apply(me,config),me._users&&(Ext.util.LocalStorage.cache[me.id]=me),me.init()},init:function(){var me=this,id=me.id;!me.prefix&&id&&(me.prefix=id+"-"),me._store=me.session?window.sessionStorage:window.localStorage},destroy:function(){var me=this;delete Ext.util.LocalStorage.cache[me.id],me._store=me._keys=null,me.destroyed=!0,me.destroy=Ext.emptyFn},getKeys:function(){var i,key,me=this,store=me._store,prefix=me.prefix,keys=me._keys,n=prefix.length;if(!keys)for(me._keys=keys=[],i=store.length;i--;)key=store.key(i),key.length>n&&prefix===key.substring(0,n)&&keys.push(key.substring(n));return keys},release:function(){--this._users||this.destroy()},save:Ext.emptyFn,clear:function(){var i,me=this,store=me._store,prefix=me.prefix,keys=me._keys||me.getKeys();for(i=keys.length;i--;)store.removeItem(prefix+keys[i]);keys.length=0},key:function(index){var keys=this._keys||this.getKeys();return 0<=index&&index<keys.length?keys[index]:null},getItem:function(key){var k=this.prefix+key;return this._store.getItem(k)},removeItem:function(key){var me=this,k=me.prefix+key,store=me._store,keys=me._keys,length=store.length;store.removeItem(k),keys&&length!==store.length&&(me.lazyKeys?me._keys=null:Ext.Array.remove(keys,key))},setItem:function(key,value){var me=this,k=me.prefix+key,store=me._store,length=store.length,keys=me._keys;store.setItem(k,value),keys&&length!==store.length&&keys.push(key)}},function(){var LocalStorage=this;if(!("localStorage"in window))return Ext.isIE?void LocalStorage.override({data:null,flushDelay:1,init:function(){var el,me=this,data=me.data;me.el=el=document.createElement("div"),el.id=me.id||(me.id="extjs-localstore"),el.addBehavior("#default#userdata"),Ext.getHead().dom.appendChild(el),el.load(me.id),data=el.getAttribute("xdata"),me.data=data=data?Ext.decode(data):{},me._flushFn=function(){me._timer=null,me.save(0)}},destroy:function(){var me=this,el=me.el;el&&(me._timer&&me.save(),el.parentNode.removeChild(el),me.data=me.el=null,me.callParent())},getKeys:function(){var me=this,keys=me._keys;return keys||(me._keys=keys=Ext.Object.getKeys(me.data)),keys},save:function(delay){var me=this;delay?me._timer||(me._timer=setTimeout(me._flushFn,delay)):(me._timer&&(clearTimeout(me._timer),me._timer=null),me.el.setAttribute("xdata",Ext.encode(me.data)),me.el.save(me.id))},clear:function(){var me=this;me.data={},me._keys=null,me.save(me.flushDelay)},getItem:function(key){var data=this.data;return key in data?data[key]:null},removeItem:function(key){var me=this,keys=me._keys,data=me.data;key in data&&(delete data[key],keys&&(me.lazyKeys?me._keys=null:Ext.Array.remove(keys,key)),me.save(me.flushDelay))},setItem:function(key,value){var me=this,data=me.data,keys=me._keys;!keys||key in data||keys.push(key),data[key]=value,me.save(me.flushDelay)}}):void(LocalStorage.supported=!1)}),Ext.define("Ext.state.LocalStorageProvider",{extend:Ext.state.Provider,alias:"state.localstorage",constructor:function(){var me=this;me.callParent(arguments),me.store=me.getStorageObject(),me.store?me.state=me.readLocalStorage():me.state={}},readLocalStorage:function(){for(var key,store=this.store,data={},keys=store.getKeys(),i=keys.length;i--;)key=keys[i],data[key]=this.decodeValue(store.getItem(key));return data},set:function(name,value){var me=this;me.clear(name),null!=value&&(me.store.setItem(name,me.encodeValue(value)),me.callParent(arguments))},clear:function(name){this.store.removeItem(name),this.callParent(arguments)},getStorageObject:function(){var prefix=this.prefix,id=prefix,n=id.length-1;return"-"===id.charAt(n)&&(id=id.substring(0,n)),new Ext.util.LocalStorage({id:id,prefix:prefix})}}),Ext.define("Ext.tab.Panel",{extend:Ext.panel.Panel,alias:"widget.tabpanel",alternateClassName:["Ext.TabPanel"],tabPosition:"top",removePanelHeader:!0,plain:!1,itemCls:Ext.baseCSSPrefix+"tabpanel-child",minTabWidth:void 0,maxTabWidth:void 0,deferredRender:!0,initComponent:function(){var me=this,dockedItems=[].concat(me.dockedItems||[]),activeTab=me.activeTab||(me.activeTab=0),tabPosition=me.tabPosition;me.layout=new Ext.layout.container.Card(Ext.apply({owner:me,deferredRender:me.deferredRender,itemCls:me.itemCls,activeItem:activeTab},me.layout)),me.tabBar=new Ext.tab.Bar(Ext.apply({ui:me.ui,dock:me.tabPosition,orientation:"top"==tabPosition||"bottom"==tabPosition?"horizontal":"vertical",plain:me.plain,cardLayout:me.layout,tabPanel:me},me.tabBar)),dockedItems.push(me.tabBar),me.dockedItems=dockedItems,me.addEvents("beforetabchange","tabchange"),me.callParent(arguments),activeTab=me.activeTab=me.getComponent(activeTab),activeTab&&me.tabBar.setActiveTab(activeTab.tab,!0)},setActiveTab:function(card){var previous,me=this;if(card=me.getComponent(card))return previous=me.getActiveTab(),previous!==card&&me.fireEvent("beforetabchange",me,card,previous)!==!1&&(card.isComponent||(Ext.suspendLayouts(),card=me.add(card),Ext.resumeLayouts()),me.activeTab=card,Ext.suspendLayouts(),me.layout.setActiveItem(card),card=me.activeTab=me.layout.getActiveItem(),card&&card!==previous?(me.tabBar.setActiveTab(card.tab),Ext.resumeLayouts(!0),previous!==card&&me.fireEvent("tabchange",me,card,previous)):Ext.resumeLayouts(!0),card)},getActiveTab:function(){var me=this,result=me.getComponent(me.activeTab);return result&&me.items.indexOf(result)!=-1?me.activeTab=result:me.activeTab=null,me.activeTab},getTabBar:function(){return this.tabBar},onAdd:function(item,index){var me=this,cfg=item.tabConfig||{},defaultConfig={xtype:"tab",ui:me.tabBar.ui,card:item,disabled:item.disabled,closable:item.closable,hidden:item.hidden&&!item.hiddenByLayout,tooltip:item.tooltip,tabBar:me.tabBar,position:me.tabPosition};void 0!==item.closeText&&(defaultConfig.closeText=item.closeText),cfg=Ext.applyIf(cfg,defaultConfig),item.tab=me.tabBar.insert(index,cfg),item.on({scope:me,enable:me.onItemEnable,disable:me.onItemDisable,beforeshow:me.onItemBeforeShow,iconchange:me.onItemIconChange,iconclschange:me.onItemIconClsChange,titlechange:me.onItemTitleChange}),item.isPanel&&(me.removePanelHeader&&(item.rendered?item.header&&item.header.hide():item.header=!1),
item.isPanel&&me.border&&item.setBorder(!1))},onItemEnable:function(item){item.tab.enable()},onItemDisable:function(item){item.tab.disable()},onItemBeforeShow:function(item){if(item!==this.activeTab)return this.setActiveTab(item),!1},onItemIconChange:function(item,newIcon){item.tab.setIcon(newIcon)},onItemIconClsChange:function(item,newIconCls){item.tab.setIconCls(newIconCls)},onItemTitleChange:function(item,newTitle){item.tab.setText(newTitle)},doRemove:function(item,autoDestroy){var toActivate,me=this;me.destroying||1==me.items.getCount()?me.activeTab=null:(toActivate=me.tabBar.items.indexOf(me.tabBar.findNextActivatable(item.tab)))!==-1&&me.setActiveTab(toActivate),this.callParent(arguments),delete item.tab.card,delete item.tab},onRemove:function(item,destroying){var me=this;item.un({scope:me,enable:me.onItemEnable,disable:me.onItemDisable,beforeshow:me.onItemBeforeShow}),me.destroying||item.tab.ownerCt!==me.tabBar||me.tabBar.remove(item.tab)}}),Ext.define("Ext.toolbar.Spacer",{extend:Ext.Component,alias:"widget.tbspacer",alternateClassName:"Ext.Toolbar.Spacer",baseCls:Ext.baseCSSPrefix+"toolbar-spacer",focusable:!1,ariaRole:"presentation"}),Ext.define("Ext.tree.Panel",{extend:Ext.panel.Table,alias:"widget.treepanel",alternateClassName:["Ext.tree.TreePanel","Ext.TreePanel"],viewType:"treeview",selType:"treemodel",treeCls:Ext.baseCSSPrefix+"tree-panel",deferRowRender:!1,rowLines:!1,lines:!0,useArrows:!1,singleExpand:!1,ddConfig:{enableDrag:!0,enableDrop:!0},rootVisible:!0,displayField:"text",root:null,normalCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible","scroll"],lockedCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible"],isTree:!0,arrowCls:Ext.baseCSSPrefix+"tree-arrows",linesCls:Ext.baseCSSPrefix+"tree-lines",noLinesCls:Ext.baseCSSPrefix+"tree-no-lines",autoWidthCls:Ext.baseCSSPrefix+"autowidth-table",constructor:function(config){config=config||{},void 0===config.animate&&(config.animate=Ext.isBoolean(this.animate)?this.animate:Ext.enableFx),this.enableAnimations=config.animate,delete config.animate,this.callParent([config])},initComponent:function(){var view,me=this,cls=[me.treeCls],store=me.store;me.useArrows&&(cls.push(me.arrowCls),me.lines=!1),me.lines?cls.push(me.linesCls):me.useArrows||cls.push(me.noLinesCls),Ext.isString(store)?store=me.store=Ext.StoreMgr.lookup(store):store&&store.isStore?me.root&&(store=me.store=Ext.data.StoreManager.lookup(store),store.setRootNode(me.root),void 0!==me.folderSort&&(store.folderSort=me.folderSort,store.sort())):(store=Ext.apply({type:"tree",root:me.root,fields:me.fields,model:me.model,folderSort:me.folderSort},store),store=me.store=Ext.StoreMgr.lookup(store)),me.viewConfig=Ext.apply({rootVisible:me.rootVisible,animate:me.enableAnimations,singleExpand:me.singleExpand,node:store.getRootNode(),hideHeaders:me.hideHeaders},me.viewConfig),me.columns||(void 0===me.initialConfig.hideHeaders&&(me.hideHeaders=!0),me.addCls(me.autoWidthCls),me.columns=[{xtype:"treecolumn",text:"Name",width:Ext.isIE6?"100%":1e4,dataIndex:me.displayField}]),me.cls&&cls.push(me.cls),me.cls=cls.join(" "),me.callParent(),me.selModel.treeStore=me.store,view=me.getView(),me.relayEvents(view,["checkchange","afteritemexpand","afteritemcollapse"]),view.isLockingView||view.rootVisible||me.getRootNode()||me.setRootNode({expanded:!0})},bindStore:function(store,initial){var me=this;me.store=store,me.storeListeners=me.mon(store,{destroyable:!0,load:me.onStoreLoad,rootchange:me.onRootChange,clear:me.onClear,scope:me}),me.storeRelayers=me.relayEvents(store,["beforeload","load"]),me.storeRelayers1=me.mon(store,{destroyable:!0,append:me.createRelayer("itemappend"),remove:me.createRelayer("itemremove"),move:me.createRelayer("itemmove",[0,4]),insert:me.createRelayer("iteminsert"),beforeappend:me.createRelayer("beforeitemappend"),beforeremove:me.createRelayer("beforeitemremove"),beforemove:me.createRelayer("beforeitemmove"),beforeinsert:me.createRelayer("beforeiteminsert"),expand:me.createRelayer("itemexpand",[0,1]),collapse:me.createRelayer("itemcollapse",[0,1]),beforeexpand:me.createRelayer("beforeitemexpand",[0,1]),beforecollapse:me.createRelayer("beforeitemcollapse",[0,1])}),store.ownerTree=me,initial||me.view.setRootNode(me.getRootNode())},unbindStore:function(){var me=this,store=me.store;store&&(Ext.destroy(me.storeListeners,me.storeRelayers,me.storeRelayers1),delete store.ownerTree)},onClear:function(){this.view.onClear()},setRootNode:function(){return this.store.setRootNode.apply(this.store,arguments)},getRootNode:function(){return this.store.getRootNode()},onRootChange:function(root){this.view.setRootNode(root)},getChecked:function(){return this.getView().getChecked()},isItemChecked:function(rec){return rec.get("checked")},expandNode:function(record,deep,callback,scope){return this.getView().expand(record,deep,callback,scope||this)},collapseNode:function(record,deep,callback,scope){return this.getView().collapse(record,deep,callback,scope||this)},expandAll:function(callback,scope){var me=this,root=me.getRootNode(),animate=me.enableAnimations;root&&(animate||Ext.suspendLayouts(),root.expand(!0,callback,scope||me),animate||Ext.resumeLayouts(!0))},collapseAll:function(callback,scope){var me=this,root=me.getRootNode(),animate=me.enableAnimations,view=me.getView();root&&(animate||Ext.suspendLayouts(),scope=scope||me,view.rootVisible?root.collapse(!0,callback,scope):root.collapseChildren(!0,callback,scope),animate||Ext.resumeLayouts(!0))},expandPath:function(path,field,separator,callback,scope){var keys,expander,me=this,current=me.getRootNode(),index=1;me.getView();return field=field||me.getRootNode().idProperty,separator=separator||"/",Ext.isEmpty(path)?void Ext.callback(callback,scope||me,[!1,null]):(keys=path.split(separator),current.get(field)!=keys[1]?void Ext.callback(callback,scope||me,[!1,current]):(expander=function(){if(++index===keys.length)return void Ext.callback(callback,scope||me,[!0,current]);var node=current.findChild(field,keys[index]);return node?(current=node,void current.expand(!1,expander)):void Ext.callback(callback,scope||me,[!1,current])},void current.expand(!1,expander)))},selectPath:function(path,field,separator,callback,scope){var root,keys,last,me=this;field=field||me.getRootNode().idProperty,separator=separator||"/",keys=path.split(separator),last=keys.pop(),keys.length>1?me.expandPath(keys.join(separator),field,separator,function(success,node){var lastNode=node;return success&&node&&(node=node.findChild(field,last))?(me.getSelectionModel().select(node),void Ext.callback(callback,scope||me,[!0,node])):void Ext.callback(callback,scope||me,[!1,lastNode])},me):(root=me.getRootNode(),root.getId()===last?(me.getSelectionModel().select(root),Ext.callback(callback,scope||me,[!0,root])):Ext.callback(callback,scope||me,[!1,null]))}}),Ext.define("Ext.view.DragZone",{extend:Ext.dd.DragZone,containerScroll:!1,constructor:function(config){var view,ownerCt,el,me=this;Ext.apply(me,config),me.ddGroup||(me.ddGroup="view-dd-zone-"+me.view.id),view=me.view,ownerCt=view.ownerCt,el=ownerCt?ownerCt.getTargetEl().dom:view.el.dom.parentNode,me.callParent([el]),me.ddel=Ext.get(document.createElement("div")),me.ddel.addCls(Ext.baseCSSPrefix+"grid-dd-wrap")},init:function(id,sGroup,config){var me=this;me.initTarget(id,sGroup,config),me.view.on("itemmousedown",me.onItemMouseDown,me)},onValidDrop:function(target,e,id){this.callParent(),target.el.focus()},onItemMouseDown:function(view,record,item,index,e){this.isPreventDrag(e,record,item,index)||(view.focusRow&&view.focusRow(record),this.handleMouseDown(e))},isPreventDrag:function(e){return!1},getDragData:function(e){var view=this.view,item=e.getTarget(view.getItemSelector());if(item)return{copy:view.copy||view.allowCopy&&e.ctrlKey,event:new Ext.EventObjectImpl(e),view:view,ddel:this.ddel,item:item,records:view.getSelectionModel().getSelection(),fromPosition:Ext.fly(item).getXY()}},onInitDrag:function(x,y){var me=this,data=me.dragData,view=data.view,selectionModel=view.getSelectionModel(),record=view.getRecord(data.item);return selectionModel.isSelected(record)||selectionModel.selectWithEvent(record,me.DDMInstance.mousedownEvent),data.records=selectionModel.getSelection(),me.ddel.update(me.getDragText()),me.proxy.update(me.ddel.dom),me.onStartDrag(x,y),!0},getDragText:function(){var count=this.dragData.records.length;return Ext.String.format(this.dragText,count,1==count?"":"s")},getRepairXY:function(e,data){return!!data&&data.fromPosition}}),Ext.define("Ext.tree.ViewDragZone",{extend:Ext.view.DragZone,isPreventDrag:function(e,record){return record.get("allowDrag")===!1||!!e.getTarget(this.view.expanderSelector)},getDragText:function(){var records=this.dragData.records,count=records.length,text=records[0].get(this.displayField),suffix="s";return 1===count&&text?text:(text||(suffix=""),Ext.String.format(this.dragText,count,suffix))},afterRepair:function(){var r,item,me=this,view=me.view,selectedRowCls=view.selectedItemCls,records=me.dragData.records,rLen=records.length,fly=Ext.fly;if(Ext.enableFx&&me.repairHighlight)for(r=0;r<rLen;r++)item=view.getNode(records[r]),fly(item.firstChild).highlight(me.repairHighlightColor,{listeners:{beforeanimate:function(){view.isSelected(item)&&fly(item).removeCls(selectedRowCls)},afteranimate:function(){view.isSelected(item)&&fly(item).addCls(selectedRowCls)}}});me.dragging=!1}}),Ext.define("Ext.tree.ViewDropZone",{extend:Ext.view.DropZone,allowParentInserts:!1,allowContainerDrops:!1,appendOnly:!1,expandDelay:500,indicatorCls:Ext.baseCSSPrefix+"tree-ddindicator",expandNode:function(node){var view=this.view;this.expandProcId=!1,node.isLeaf()||node.isExpanded()||(view.expand(node),this.expandProcId=!1)},queueExpand:function(node){this.expandProcId=Ext.Function.defer(this.expandNode,this.expandDelay,this,[node])},cancelExpand:function(){this.expandProcId&&(clearTimeout(this.expandProcId),this.expandProcId=!1)},getPosition:function(e,node){var fragment,view=this.view,record=view.getRecord(node),y=e.getPageY(),noAppend=record.isLeaf(),noBelow=!1,region=Ext.fly(node).getRegion();return record.isRoot()?"append":this.appendOnly?!noAppend&&"append":(this.allowParentInserts||(noBelow=record.hasChildNodes()&&record.isExpanded()),fragment=(region.bottom-region.top)/(noAppend?2:3),y>=region.top&&y<region.top+fragment?"before":!noBelow&&(noAppend||y>=region.bottom-fragment&&y<=region.bottom)?"after":"append")},isValidDropPoint:function(node,position,dragZone,e,data){if(!node||!data.item)return!1;var i,record,view=this.view,targetNode=view.getRecord(node),draggedRecords=data.records,dataLength=draggedRecords.length,ln=draggedRecords.length;if(!(targetNode&&position&&dataLength))return!1;for(i=0;i<ln;i++)if(record=draggedRecords[i],record.isNode&&record.contains(targetNode))return!1;return("append"!==position||targetNode.get("allowDrop")!==!1)&&(("append"==position||targetNode.parentNode.get("allowDrop")!==!1)&&(!Ext.Array.contains(draggedRecords,targetNode)&&view.fireEvent("nodedragover",targetNode,position,data,e)!==!1))},onNodeOver:function(node,dragZone,e,data){var position=this.getPosition(e,node),returnCls=this.dropNotAllowed,view=this.view,targetNode=view.getRecord(node),indicator=this.getIndicator(),indicatorY=0;return this.cancelExpand(),"append"!=position||this.expandProcId||Ext.Array.contains(data.records,targetNode)||targetNode.isLeaf()||targetNode.isExpanded()||this.queueExpand(targetNode),this.isValidDropPoint(node,position,dragZone,e,data)?(this.valid=!0,this.currentPosition=position,this.overRecord=targetNode,indicator.setWidth(Ext.fly(node).getWidth()),indicatorY=Ext.fly(node).getY()-Ext.fly(view.el).getY()-1,"before"==position?(returnCls=targetNode.isFirst()?Ext.baseCSSPrefix+"tree-drop-ok-above":Ext.baseCSSPrefix+"tree-drop-ok-between",indicator.showAt(0,indicatorY),dragZone.proxy.show()):"after"==position?(returnCls=targetNode.isLast()?Ext.baseCSSPrefix+"tree-drop-ok-below":Ext.baseCSSPrefix+"tree-drop-ok-between",indicatorY+=Ext.fly(node).getHeight(),indicator.showAt(0,indicatorY),dragZone.proxy.show()):(returnCls=Ext.baseCSSPrefix+"tree-drop-ok-append",indicator.hide())):this.valid=!1,this.currentCls=returnCls,returnCls},onNodeOut:function(n,dd,e,data){this.valid=!1,this.getIndicator().hide()},onContainerOver:function(dd,e,data){return e.getTarget("."+this.indicatorCls)?this.currentCls:this.dropNotAllowed},notifyOut:function(){this.callParent(arguments),this.cancelExpand()},handleNodeDrop:function(data,targetNode,position){var records,i,len,record,insertionMethod,argList,needTargetExpand,transferData,me=this,targetView=me.view,parentNode=targetNode?targetNode.parentNode:targetView.panel.getRootNode(),Model=targetView.getStore().treeStore.model;if(data.copy)for(records=data.records,data.records=[],i=0,len=records.length;i<len;i++)record=records[i],record.isNode?data.records.push(record.copy(void 0,!0)):data.records.push(new Model(record.data,record.getId()));me.cancelExpand(),"before"==position?(insertionMethod=parentNode.insertBefore,argList=[null,targetNode],targetNode=parentNode):"after"==position?(targetNode.nextSibling?(insertionMethod=parentNode.insertBefore,argList=[null,targetNode.nextSibling]):(insertionMethod=parentNode.appendChild,argList=[null]),targetNode=parentNode):(targetNode.isExpanded()||targetNode.isLoading()||(needTargetExpand=!0),insertionMethod=targetNode.appendChild,argList=[null]),transferData=function(){var color,n;for(Ext.suspendLayouts(),i=0,len=data.records.length;i<len;i++)record=data.records[i],record.isNode||(record=record.isModel?new Model(record.data,record.getId()):new Model(record),data.records[i]=record),argList[0]=record,insertionMethod.apply(targetNode,argList);if(me.sortOnDrop&&targetNode.sort(targetNode.getOwnerTree().store.generateComparator()),Ext.resumeLayouts(!0),Ext.enableFx&&me.dropHighlight)for(color=me.dropHighlightColor,i=0;i<len;i++)n=targetView.getNode(data.records[i]),n&&Ext.fly(n).highlight(color)},needTargetExpand?targetNode.expand(!1,transferData):targetNode.isLoading()?targetNode.on({expand:transferData,delay:1,single:!0}):transferData()}}),Ext.define("Ext.tree.plugin.TreeViewDragDrop",{extend:Ext.AbstractPlugin,alias:"plugin.treeviewdragdrop",dragText:"{0} selected node{1}",allowParentInserts:!1,allowContainerDrops:!1,appendOnly:!1,ddGroup:"TreeDD",containerScroll:!1,expandDelay:1e3,enableDrop:!0,enableDrag:!0,nodeHighlightColor:"c3daf9",nodeHighlightOnDrop:Ext.enableFx,nodeHighlightOnRepair:Ext.enableFx,displayField:"text",init:function(view){view.on("render",this.onViewRender,this,{single:!0})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},onViewRender:function(view){var scrollEl,me=this;me.enableDrag&&(me.containerScroll&&(scrollEl=view.getEl()),me.dragZone=new Ext.tree.ViewDragZone({view:view,ddGroup:me.dragGroup||me.ddGroup,dragText:me.dragText,displayField:me.displayField,repairHighlightColor:me.nodeHighlightColor,repairHighlight:me.nodeHighlightOnRepair,scrollEl:scrollEl})),me.enableDrop&&(me.dropZone=new Ext.tree.ViewDropZone({view:view,ddGroup:me.dropGroup||me.ddGroup,allowContainerDrops:me.allowContainerDrops,appendOnly:me.appendOnly,allowParentInserts:me.allowParentInserts,expandDelay:me.expandDelay,dropHighlightColor:me.nodeHighlightColor,dropHighlight:me.nodeHighlightOnDrop,sortOnDrop:me.sortOnDrop,containerScroll:me.containerScroll}))}},function(){var proto=this.prototype;proto.nodeHighlightOnDrop=proto.nodeHighlightOnRepair=Ext.enableFx}),Ext.define("Ext.util.Cookies",{singleton:!0,set:function(name,value){var argv=arguments,argc=arguments.length,expires=argc>2?argv[2]:null,path=argc>3?argv[3]:"/",domain=argc>4?argv[4]:null,secure=argc>5&&argv[5];document.cookie=name+"="+escape(value)+(null===expires?"":"; expires="+expires.toGMTString())+(null===path?"":"; path="+path)+(null===domain?"":"; domain="+domain)+(secure===!0?"; secure":"")},get:function(name){for(var arg=name+"=",alen=arg.length,clen=document.cookie.length,i=0,j=0;i<clen;){if(j=i+alen,document.cookie.substring(i,j)==arg)return this.getCookieVal(j);if(i=document.cookie.indexOf(" ",i)+1,0===i)break}return null},clear:function(name,path){this.get(name)&&(path=path||"/",document.cookie=name+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path="+path)},getCookieVal:function(offset){var endstr=document.cookie.indexOf(";",offset);return endstr==-1&&(endstr=document.cookie.length),unescape(document.cookie.substring(offset,endstr))}}),Ext.define("Ext.util.Grouper",{extend:Ext.util.Sorter,isGrouper:!0,getGroupString:function(instance){return instance.get(this.property)}}),Ext.define("Ext.util.History",{singleton:!0,alternateClassName:"Ext.History",mixins:{observable:Ext.util.Observable},useTopWindow:!0,fieldId:Ext.baseCSSPrefix+"history-field",iframeId:Ext.baseCSSPrefix+"history-frame",constructor:function(){var me=this;me.oldIEMode=Ext.isIE7m||!Ext.isStrict&&Ext.isIE8,me.iframe=null,me.hiddenField=null,me.ready=!1,me.currentToken=null,me.mixins.observable.constructor.call(me)},getHash:function(){var href=window.location.href,i=href.indexOf("#");return i>=0?href.substr(i+1):null},setHash:function(hash){var me=this,win=me.useTopWindow?window.top:window;try{win.location.hash=hash}catch(e){}},doSave:function(){this.hiddenField.value=this.currentToken},handleStateChange:function(token){this.currentToken=token,this.fireEvent("change",token)},updateIFrame:function(token){var doc,html='<html><body><div id="state" role="presentation">'+Ext.util.Format.htmlEncode(token)+"</div></body></html>";try{return doc=this.iframe.contentWindow.document,doc.open(),doc.write(html),doc.close(),!0}catch(e){return!1}},checkIFrame:function(){var doc,elem,oldToken,oldHash,me=this,contentWindow=me.iframe.contentWindow;return contentWindow&&contentWindow.document?(doc=contentWindow.document,elem=doc.getElementById("state"),oldToken=elem?elem.innerText:null,oldHash=me.getHash(),Ext.TaskManager.start({run:function(){var doc=contentWindow.document,elem=doc.getElementById("state"),newToken=elem?elem.innerText:null,newHash=me.getHash();newToken!==oldToken?(oldToken=newToken,me.handleStateChange(newToken),me.setHash(newToken),oldHash=newToken,me.doSave()):newHash!==oldHash&&(oldHash=newHash,me.updateIFrame(newHash))},interval:50,scope:me}),me.ready=!0,void me.fireEvent("ready",me)):void Ext.Function.defer(this.checkIFrame,10,this)},startUp:function(){var hash,me=this;me.currentToken=me.hiddenField.value||this.getHash(),me.oldIEMode?me.checkIFrame():(hash=me.getHash(),Ext.TaskManager.start({run:function(){var newHash=me.getHash();newHash!==hash&&(hash=newHash,me.handleStateChange(hash),me.doSave())},interval:50,scope:me}),me.ready=!0,me.fireEvent("ready",me))},init:function(onReady,scope){var me=this,DomHelper=Ext.DomHelper;return me.ready?void Ext.callback(onReady,scope,[me]):Ext.isReady?(me.hiddenField=Ext.getDom(me.fieldId),me.hiddenField||(me.hiddenField=Ext.getBody().createChild({id:Ext.id(),tag:"form",role:"presentation",cls:Ext.baseCSSPrefix+"hide-display",children:[{tag:"input",type:"hidden",id:me.fieldId}]},!1,!0).firstChild),me.oldIEMode&&(me.iframe=Ext.getDom(me.iframeId),me.iframe||(me.iframe=DomHelper.append(me.hiddenField.parentNode,{tag:"iframe",role:"presentation",id:me.iframeId,src:Ext.SSL_SECURE_URL}))),me.addEvents("ready","change"),onReady&&me.on("ready",onReady,scope,{single:!0}),void me.startUp()):void Ext.onReady(function(){me.init(onReady,scope)})},add:function(token,preventDup){var me=this;return preventDup!==!1&&me.getToken()===token||(me.oldIEMode?me.updateIFrame(token):(me.setHash(token),!0))},back:function(){window.history.go(-1)},forward:function(){window.history.go(1)},getToken:function(){return this.ready?this.currentToken:this.getHash()}}),function(){function baseIndexOf(array,value,fromIndex){for(var index=(fromIndex||0)-1,length=array?array.length:0;++index<length;)if(array[index]===value)return index;return-1}function cacheIndexOf(cache,value){var type=typeof value;if(cache=cache.cache,"boolean"==type||null==value)return cache[value]?0:-1;"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value;return cache=(cache=cache[type])&&cache[key],"object"==type?cache&&baseIndexOf(cache,value)>-1?0:-1:cache?0:-1}function cachePush(value){var cache=this.cache,type=typeof value;if("boolean"==type||null==value)cache[value]=!0;else{"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});"object"==type?(typeCache[key]||(typeCache[key]=[])).push(value):typeCache[key]=!0}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){for(var ac=a.criteria,bc=b.criteria,index=-1,length=ac.length;++index<length;){var value=ac[index],other=bc[index];if(value!==other){if(value>other||"undefined"==typeof value)return 1;if(value<other||"undefined"==typeof other)return-1}}return a.index-b.index}function createCache(array){var index=-1,length=array.length,first=array[0],mid=array[length/2|0],last=array[length-1];if(first&&"object"==typeof first&&mid&&"object"==typeof mid&&last&&"object"==typeof last)return!1;var cache=getObject();cache.false=cache.null=cache.true=cache.undefined=!1;var result=getObject();for(result.array=array,result.cache=cache,result.push=cachePush;++index<length;)result.push(array[index]);return result}function escapeStringChar(match){return"\\"+stringEscapes[match]}function getArray(){return arrayPool.pop()||[]}function getObject(){return objectPool.pop()||{array:null,cache:null,criteria:null,false:!1,index:0,null:!1,number:null,object:null,push:null,string:null,true:!1,undefined:!1,value:null}}function isNode(value){return"function"!=typeof value.toString&&"string"==typeof(value+"")}function releaseArray(array){array.length=0,arrayPool.length<maxPoolSize&&arrayPool.push(array)}function releaseObject(object){var cache=object.cache;cache&&releaseObject(cache),object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null,objectPool.length<maxPoolSize&&objectPool.push(object)}function slice(array,start,end){start||(start=0),"undefined"==typeof end&&(end=array?array.length:0);for(var index=-1,length=end-start||0,result=Array(length<0?0:length);++index<length;)result[index]=array[start+index];return result}function runInContext(context){function lodash(value){return value&&"object"==typeof value&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)}function lodashWrapper(value,chainAll){this.__chain__=!!chainAll,this.__wrapped__=value}function baseBind(bindData){function bound(){if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if(this instanceof bound){var thisBinding=baseCreate(func.prototype),result=func.apply(thisBinding,args||arguments);return isObject(result)?result:thisBinding}return func.apply(thisArg,args||arguments)}var func=bindData[0],partialArgs=bindData[2],thisArg=bindData[4];return setBindData(bound,bindData),bound}function baseClone(value,isDeep,callback,stackA,stackB){if(callback){var result=callback(value);if("undefined"!=typeof result)return result}var isObj=isObject(value);if(!isObj)return value;var className=toString.call(value);if(!cloneableClasses[className]||!support.nodeClass&&isNode(value))return value;var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor((+value));case numberClass:case stringClass:return new ctor(value);case regexpClass:return result=ctor(value.source,reFlags.exec(value)),result.lastIndex=value.lastIndex,result}var isArr=isArray(value);if(isDeep){var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];result=isArr?ctor(value.length):{}}else result=isArr?slice(value):assign({},value);return isArr&&(hasOwnProperty.call(value,"index")&&(result.index=value.index),hasOwnProperty.call(value,"input")&&(result.input=value.input)),isDeep?(stackA.push(value),stackB.push(result),(isArr?baseEach:forOwn)(value,function(objValue,key){result[key]=baseClone(objValue,isDeep,callback,stackA,stackB)}),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result):result}function baseCreate(prototype,properties){return isObject(prototype)?nativeCreate(prototype):{}}function baseCreateCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if("undefined"==typeof thisArg||!("prototype"in func))return func;var bindData=func.__bindData__;if("undefined"==typeof bindData&&(support.funcNames&&(bindData=!func.name),bindData=bindData||!support.funcDecomp,!bindData)){var source=fnToString.call(func);support.funcNames||(bindData=!reFuncName.test(source)),bindData||(bindData=reThis.test(source),setBindData(func,bindData))}if(bindData===!1||bindData!==!0&&1&bindData[1])return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return bind(func,thisArg)}function baseCreateWrapper(bindData){function bound(){var thisBinding=isBind?thisArg:this;if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if((partialRightArgs||isCurry)&&(args||(args=slice(arguments)),partialRightArgs&&push.apply(args,partialRightArgs),isCurry&&args.length<arity))return bitmask|=16,baseCreateWrapper([func,isCurryBound?bitmask:bitmask&-4,args,null,thisArg,arity]);if(args||(args=arguments),isBindKey&&(func=thisBinding[key]),this instanceof bound){thisBinding=baseCreate(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}var func=bindData[0],bitmask=bindData[1],partialArgs=bindData[2],partialRightArgs=bindData[3],thisArg=bindData[4],arity=bindData[5],isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isCurryBound=8&bitmask,key=func;return setBindData(bound,bindData),bound}function baseDifference(array,values){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,isLarge=length>=largeArraySize&&indexOf===baseIndexOf,result=[];if(isLarge){var cache=createCache(values);cache?(indexOf=cacheIndexOf,values=cache):isLarge=!1}for(;++index<length;){var value=array[index];indexOf(values,value)<0&&result.push(value)}return isLarge&&releaseObject(values),result}function baseFlatten(array,isShallow,isStrict,fromIndex){for(var index=(fromIndex||0)-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];if(value&&"object"==typeof value&&"number"==typeof value.length&&(isArray(value)||isArguments(value))){isShallow||(value=baseFlatten(value,isShallow,isStrict));var valIndex=-1,valLength=value.length,resIndex=result.length;for(result.length+=valLength;++valIndex<valLength;)result[resIndex++]=value[valIndex]}else isStrict||result.push(value)}return result}function baseIsEqual(a,b,callback,isWhere,stackA,stackB){if(callback){var result=callback(a,b);if("undefined"!=typeof result)return!!result}if(a===b)return 0!==a||1/a==1/b;var type=typeof a,otherType=typeof b;if(!(a!==a||a&&objectTypes[type]||b&&objectTypes[otherType]))return!1;if(null==a||null==b)return a===b;var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass&&(className=objectClass),otherClass==argsClass&&(otherClass=objectClass),className!=otherClass)return!1;switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){var aWrapped=hasOwnProperty.call(a,"__wrapped__"),bWrapped=hasOwnProperty.call(b,"__wrapped__");if(aWrapped||bWrapped)return baseIsEqual(aWrapped?a.__wrapped__:a,bWrapped?b.__wrapped__:b,callback,isWhere,stackA,stackB);if(className!=objectClass||!support.nodeClass&&(isNode(a)||isNode(b)))return!1;var ctorA=!support.argsObject&&isArguments(a)?Object:a.constructor,ctorB=!support.argsObject&&isArguments(b)?Object:b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)&&"constructor"in a&&"constructor"in b)return!1}var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==a)return stackB[length]==b;var size=0;if(result=!0,stackA.push(a),stackB.push(b),isArr){if(length=a.length,size=b.length,result=size==length,result||isWhere)for(;size--;){var index=length,value=b[size];if(isWhere)for(;index--&&!(result=baseIsEqual(a[index],value,callback,isWhere,stackA,stackB)););else if(!(result=baseIsEqual(a[size],value,callback,isWhere,stackA,stackB)))break}}else forIn(b,function(value,key,b){if(hasOwnProperty.call(b,key))return size++,result=hasOwnProperty.call(a,key)&&baseIsEqual(a[key],value,callback,isWhere,stackA,stackB)}),result&&!isWhere&&forIn(a,function(value,key,a){if(hasOwnProperty.call(a,key))return result=--size>-1});return stackA.pop(),stackB.pop(),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result}function baseMerge(object,source,callback,stackA,stackB){(isArray(source)?forEach:forOwn)(source,function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){for(var stackLength=stackA.length;stackLength--;)if(found=stackA[stackLength]==source){value=stackB[stackLength];break}if(!found){var isShallow;callback&&(result=callback(value,source),(isShallow="undefined"!=typeof result)&&(value=result)),isShallow||(value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}),stackA.push(source),stackB.push(value),isShallow||baseMerge(value,source,callback,stackA,stackB)}}else callback&&(result=callback(value,source),"undefined"==typeof result&&(result=source)),"undefined"!=typeof result&&(value=result);object[key]=value})}function baseRandom(min,max){return min+floor(nativeRandom()*(max-min+1))}function baseUniq(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[],isLarge=!isSorted&&length>=largeArraySize&&indexOf===baseIndexOf,seen=callback||isLarge?getArray():result;if(isLarge){var cache=createCache(seen);indexOf=cacheIndexOf,seen=cache}for(;++index<length;){var value=array[index],computed=callback?callback(value,index,array):value;(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0)&&((callback||isLarge)&&seen.push(computed),result.push(value))}return isLarge?(releaseArray(seen.array),releaseObject(seen)):callback&&releaseArray(seen),result}function createAggregator(setter){return function(collection,callback,thisArg){var result={};if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,callback(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,callback(value,key,collection),collection)});return result}}function createWrapper(func,bitmask,partialArgs,partialRightArgs,thisArg,arity){var isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isPartial=16&bitmask,isPartialRight=32&bitmask;if(!isBindKey&&!isFunction(func))throw new TypeError;isPartial&&!partialArgs.length&&(bitmask&=-17,isPartial=partialArgs=!1),isPartialRight&&!partialRightArgs.length&&(bitmask&=-33,isPartialRight=partialRightArgs=!1);var bindData=func&&func.__bindData__;if(bindData&&bindData!==!0)return bindData=slice(bindData),bindData[2]&&(bindData[2]=slice(bindData[2])),bindData[3]&&(bindData[3]=slice(bindData[3])),!isBind||1&bindData[1]||(bindData[4]=thisArg),!isBind&&1&bindData[1]&&(bitmask|=8),!isCurry||4&bindData[1]||(bindData[5]=arity),isPartial&&push.apply(bindData[2]||(bindData[2]=[]),partialArgs),isPartialRight&&unshift.apply(bindData[3]||(bindData[3]=[]),partialRightArgs),
bindData[1]|=bitmask,createWrapper.apply(null,bindData);var creater=1==bitmask||17===bitmask?baseBind:baseCreateWrapper;return creater([func,bitmask,partialArgs,partialRightArgs,thisArg,arity])}function createIterator(){iteratorData.shadowedProps=shadowedProps,iteratorData.array=iteratorData.bottom=iteratorData.loop=iteratorData.top="",iteratorData.init="iterable",iteratorData.useHas=!0;for(var object,index=0;object=arguments[index];index++)for(var key in object)iteratorData[key]=object[key];var args=iteratorData.args;iteratorData.firstArg=/^[^,]+/.exec(args)[0];var factory=Function("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+args+") {\n"+iteratorTemplate(iteratorData)+"\n}");return factory(baseCreateCallback,errorClass,errorProto,hasOwnProperty,indicatorObject,isArguments,isArray,isString,iteratorData.keys,objectProto,objectTypes,nonEnumProps,stringClass,stringProto,toString)}function escapeHtmlChar(match){return htmlEscapes[match]}function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?baseIndexOf:result;return result}function isNative(value){return"function"==typeof value&&reNative.test(value)}function shimIsPlainObject(value){var ctor,result;return!(!(value&&toString.call(value)==objectClass&&(ctor=value.constructor,!isFunction(ctor)||ctor instanceof ctor))||!support.argsClass&&isArguments(value)||!support.nodeClass&&isNode(value))&&(support.ownLast?(forIn(value,function(value,key,object){return result=hasOwnProperty.call(object,key),!1}),result!==!1):(forIn(value,function(value,key){result=key}),"undefined"==typeof result||hasOwnProperty.call(value,result)))}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==argsClass||!1}function clone(value,isDeep,callback,thisArg){return"boolean"!=typeof isDeep&&null!=isDeep&&(thisArg=callback,callback=isDeep,isDeep=!1),baseClone(value,isDeep,"function"==typeof callback&&baseCreateCallback(callback,thisArg,1))}function cloneDeep(value,callback,thisArg){return baseClone(value,!0,"function"==typeof callback&&baseCreateCallback(callback,thisArg,1))}function create(prototype,properties){var result=baseCreate(prototype);return properties?assign(result,properties):result}function findKey(object,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forOwn(object,function(value,key,object){if(callback(value,key,object))return result=key,!1}),result}function findLastKey(object,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forOwnRight(object,function(value,key,object){if(callback(value,key,object))return result=key,!1}),result}function forInRight(object,callback,thisArg){var pairs=[];forIn(object,function(value,key){pairs.push(key,value)});var length=pairs.length;for(callback=baseCreateCallback(callback,thisArg,3);length--&&callback(pairs[length--],pairs[length],object)!==!1;);return object}function forOwnRight(object,callback,thisArg){var props=keys(object),length=props.length;for(callback=baseCreateCallback(callback,thisArg,3);length--;){var key=props[length];if(callback(object[key],key,object)===!1)break}return object}function functions(object){var result=[];return forIn(object,function(value,key){isFunction(value)&&result.push(key)}),result.sort()}function has(object,key){return!!object&&hasOwnProperty.call(object,key)}function invert(object){for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===!0||value===!1||value&&"object"==typeof value&&toString.call(value)==boolClass||!1}function isDate(value){return value&&"object"==typeof value&&toString.call(value)==dateClass||!1}function isElement(value){return value&&1===value.nodeType||!1}function isEmpty(value){var result=!0;if(!value)return result;var className=toString.call(value),length=value.length;return className==arrayClass||className==stringClass||(support.argsClass?className==argsClass:isArguments(value))||className==objectClass&&"number"==typeof length&&isFunction(value.splice)?!length:(forOwn(value,function(){return result=!1}),result)}function isEqual(a,b,callback,thisArg){return baseIsEqual(a,b,"function"==typeof callback&&baseCreateCallback(callback,thisArg,2))}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return"function"==typeof value}function isObject(value){return!(!value||!objectTypes[typeof value])}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||value&&"object"==typeof value&&toString.call(value)==numberClass||!1}function isRegExp(value){return value&&objectTypes[typeof value]&&toString.call(value)==regexpClass||!1}function isString(value){return"string"==typeof value||value&&"object"==typeof value&&toString.call(value)==stringClass||!1}function isUndefined(value){return"undefined"==typeof value}function mapValues(object,callback,thisArg){var result={};return callback=lodash.createCallback(callback,thisArg,3),forOwn(object,function(value,key,object){result[key]=callback(value,key,object)}),result}function merge(object){var args=arguments,length=2;if(!isObject(object))return object;if("number"!=typeof args[2]&&(length=args.length),length>3&&"function"==typeof args[length-2])var callback=baseCreateCallback(args[--length-1],args[length--],2);else length>2&&"function"==typeof args[length-1]&&(callback=args[--length]);for(var sources=slice(arguments,1,length),index=-1,stackA=getArray(),stackB=getArray();++index<length;)baseMerge(object,sources[index],callback,stackA,stackB);return releaseArray(stackA),releaseArray(stackB),object}function omit(object,callback,thisArg){var result={};if("function"!=typeof callback){var props=[];forIn(object,function(value,key){props.push(key)}),props=baseDifference(props,baseFlatten(arguments,!0,!1,1));for(var index=-1,length=props.length;++index<length;){var key=props[index];result[key]=object[key]}}else callback=lodash.createCallback(callback,thisArg,3),forIn(object,function(value,key,object){callback(value,key,object)||(result[key]=value)});return result}function pairs(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if("function"!=typeof callback)for(var index=-1,props=baseFlatten(arguments,!0,!1,1),length=isObject(object)?props.length:0;++index<length;){var key=props[index];key in object&&(result[key]=object[key])}else callback=lodash.createCallback(callback,thisArg,3),forIn(object,function(value,key,object){callback(value,key,object)&&(result[key]=value)});return result}function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);if(null==accumulator)if(isArr)accumulator=[];else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=baseCreate(proto)}return callback&&(callback=lodash.createCallback(callback,thisArg,4),(isArr?baseEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)})),accumulator}function values(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function at(collection){var args=arguments,index=-1,props=baseFlatten(args,!0,!1,1),length=args[2]&&args[2][args[1]]===collection?1:props.length,result=Array(length);for(support.unindexedChars&&isString(collection)&&(collection=collection.split(""));++index<length;)result[index]=collection[props[index]];return result}function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=!1;return fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex)||0,isArray(collection)?result=indexOf(collection,target,fromIndex)>-1:"number"==typeof length?result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1:baseEach(collection,function(value){if(++index>=fromIndex)return!(result=value===target)}),result}function every(collection,callback,thisArg){var result=!0;if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length&&(result=!!callback(collection[index],index,collection)););else baseEach(collection,function(value,index,collection){return result=!!callback(value,index,collection)});return result}function filter(collection,callback,thisArg){var result=[];if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];callback(value,index,collection)&&result.push(value)}else baseEach(collection,function(value,index,collection){callback(value,index,collection)&&result.push(value)});return result}function find(collection,callback,thisArg){if(callback=lodash.createCallback(callback,thisArg,3),!isArray(collection)){var result;return baseEach(collection,function(value,index,collection){if(callback(value,index,collection))return result=value,!1}),result}for(var index=-1,length=collection.length;++index<length;){var value=collection[index];if(callback(value,index,collection))return value}}function findLast(collection,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forEachRight(collection,function(value,index,collection){if(callback(value,index,collection))return result=value,!1}),result}function forEach(collection,callback,thisArg){if(callback&&"undefined"==typeof thisArg&&isArray(collection))for(var index=-1,length=collection.length;++index<length&&callback(collection[index],index,collection)!==!1;);else baseEach(collection,callback,thisArg);return collection}function forEachRight(collection,callback,thisArg){var iterable=collection,length=collection?collection.length:0;if(callback=callback&&"undefined"==typeof thisArg?callback:baseCreateCallback(callback,thisArg,3),isArray(collection))for(;length--&&callback(collection[length],length,collection)!==!1;);else{if("number"!=typeof length){var props=keys(collection);length=props.length}else support.unindexedChars&&isString(collection)&&(iterable=collection.split(""));baseEach(collection,function(value,key,collection){return key=props?props[--length]:--length,callback(iterable[key],key,collection)})}return collection}function invoke(collection,methodName){var args=slice(arguments,2),index=-1,isFunc="function"==typeof methodName,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)}),result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(;++index<length;)result[index]=callback(collection[index],index,collection);else baseEach(collection,function(value,key,collection){result[++index]=callback(value,key,collection)});return result}function max(collection,callback,thisArg){var computed=-(1/0),result=computed;if("function"!=typeof callback&&thisArg&&thisArg[callback]===collection&&(callback=null),null==callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];value>result&&(result=value)}else callback=null==callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3),baseEach(collection,function(value,index,collection){var current=callback(value,index,collection);current>computed&&(computed=current,result=value)});return result}function min(collection,callback,thisArg){var computed=1/0,result=computed;if("function"!=typeof callback&&thisArg&&thisArg[callback]===collection&&(callback=null),null==callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];value<result&&(result=value)}else callback=null==callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3),baseEach(collection,function(value,index,collection){var current=callback(value,index,collection);current<computed&&(computed=current,result=value)});return result}function reduce(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;if(callback=lodash.createCallback(callback,thisArg,4),isArray(collection)){var index=-1,length=collection.length;for(noaccum&&(accumulator=collection[++index]);++index<length;)accumulator=callback(accumulator,collection[index],index,collection)}else baseEach(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)});return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;return callback=lodash.createCallback(callback,thisArg,4),forEachRight(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)}),accumulator}function reject(collection,callback,thisArg){return callback=lodash.createCallback(callback,thisArg,3),filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function sample(collection,n,guard){if(collection&&"number"!=typeof collection.length?collection=values(collection):support.unindexedChars&&isString(collection)&&(collection=collection.split("")),null==n||guard)return collection?collection[baseRandom(0,collection.length-1)]:undefined;var result=shuffle(collection);return result.length=nativeMin(nativeMax(0,n),result.length),result}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){var rand=baseRandom(0,++index);result[index]=result[rand],result[rand]=value}),result}function size(collection){var length=collection?collection.length:0;return"number"==typeof length?length:keys(collection).length}function some(collection,callback,thisArg){var result;if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length&&!(result=callback(collection[index],index,collection)););else baseEach(collection,function(value,index,collection){return!(result=callback(value,index,collection))});return!!result}function sortBy(collection,callback,thisArg){var index=-1,isArr=isArray(callback),length=collection?collection.length:0,result=Array("number"==typeof length?length:0);for(isArr||(callback=lodash.createCallback(callback,thisArg,3)),forEach(collection,function(value,key,collection){var object=result[++index]=getObject();isArr?object.criteria=map(callback,function(key){return value[key]}):(object.criteria=getArray())[0]=callback(value,key,collection),object.index=index,object.value=value}),length=result.length,result.sort(compareAscending);length--;){var object=result[length];result[length]=object.value,isArr||releaseArray(object.criteria),releaseObject(object)}return result}function toArray(collection){return collection&&"number"==typeof collection.length?support.unindexedChars&&isString(collection)?collection.split(""):slice(collection):values(collection)}function compact(array){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];value&&result.push(value)}return result}function difference(array){return baseDifference(array,baseFlatten(arguments,!0,!0,1))}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);++index<length;)if(callback(array[index],index,array))return index;return-1}function findLastIndex(array,callback,thisArg){var length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);length--;)if(callback(array[length],length,array))return length;return-1}function first(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=-1;for(callback=lodash.createCallback(callback,thisArg,3);++index<length&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array?array[0]:undefined;return slice(array,0,nativeMin(nativeMax(0,n),length))}function flatten(array,isShallow,callback,thisArg){return"boolean"!=typeof isShallow&&null!=isShallow&&(thisArg=callback,callback="function"!=typeof isShallow&&thisArg&&thisArg[isShallow]===array?null:isShallow,isShallow=!1),null!=callback&&(array=map(array,callback,thisArg)),baseFlatten(array,isShallow)}function indexOf(array,value,fromIndex){if("number"==typeof fromIndex){var length=array?array.length:0;fromIndex=fromIndex<0?nativeMax(0,length+fromIndex):fromIndex||0}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}return baseIndexOf(array,value,fromIndex)}function initial(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg,3);index--&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:callback||n;return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(){for(var args=[],argsIndex=-1,argsLength=arguments.length,caches=getArray(),indexOf=getIndexOf(),trustIndexOf=indexOf===baseIndexOf,seen=getArray();++argsIndex<argsLength;){var value=arguments[argsIndex];(isArray(value)||isArguments(value))&&(args.push(value),caches.push(trustIndexOf&&value.length>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen)))}var array=args[0],index=-1,length=array?array.length:0,result=[];outer:for(;++index<length;){var cache=caches[0];if(value=array[index],(cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){for(argsIndex=argsLength,(cache||seen).push(value);--argsIndex;)if(cache=caches[argsIndex],(cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0)continue outer;result.push(value)}}for(;argsLength--;)cache=caches[argsLength],cache&&releaseObject(cache);return releaseArray(caches),releaseArray(seen),result}function last(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg,3);index--&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array?array[length-1]:undefined;return slice(array,nativeMax(0,length-n))}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;for("number"==typeof fromIndex&&(index=(fromIndex<0?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1);index--;)if(array[index]===value)return index;return-1}function pull(array){for(var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;++argsIndex<argsLength;)for(var index=-1,value=args[argsIndex];++index<length;)array[index]===value&&(splice.call(array,index--,1),length--);return array}function range(start,end,step){start=+start||0,step="number"==typeof step?step:+step||1,null==end&&(end=start,start=0);for(var index=-1,length=nativeMax(0,ceil((end-start)/(step||1))),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function remove(array,callback,thisArg){var index=-1,length=array?array.length:0,result=[];for(callback=lodash.createCallback(callback,thisArg,3);++index<length;){var value=array[index];callback(value,index,array)&&(result.push(value),splice.call(array,index--,1),length--)}return result}function rest(array,callback,thisArg){if("number"!=typeof callback&&null!=callback){var n=0,index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);++index<length&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:nativeMax(0,callback);return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;for(callback=callback?lodash.createCallback(callback,thisArg,1):identity,value=callback(value);low<high;){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(){return baseUniq(baseFlatten(arguments,!0,!0))}function uniq(array,isSorted,callback,thisArg){return"boolean"!=typeof isSorted&&null!=isSorted&&(thisArg=callback,callback="function"!=typeof isSorted&&thisArg&&thisArg[isSorted]===array?null:isSorted,isSorted=!1),null!=callback&&(callback=lodash.createCallback(callback,thisArg,3)),baseUniq(array,isSorted,callback)}function without(array){return baseDifference(array,slice(arguments,1))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArray(array)||isArguments(array))var result=result?baseUniq(baseDifference(result,array).concat(baseDifference(array,result))):array}return result||[]}function zip(){for(var array=arguments.length>1?arguments:arguments[0],index=-1,length=array?max(pluck(array,"length")):0,result=Array(length<0?0:length);++index<length;)result[index]=pluck(array,index);return result}function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};for(values||!length||isArray(keys[0])||(values=[]);++index<length;){var key=keys[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function after(n,func){if(!isFunction(func))throw new TypeError;return function(){if(--n<1)return func.apply(this,arguments)}}function bind(func,thisArg){return arguments.length>2?createWrapper(func,17,slice(arguments,2),null,thisArg):createWrapper(func,1,null,null,thisArg)}function bindAll(object){for(var funcs=arguments.length>1?baseFlatten(arguments,!0,!1,1):functions(object),index=-1,length=funcs.length;++index<length;){var key=funcs[index];object[key]=createWrapper(object[key],1,null,null,object)}return object}function bindKey(object,key){return arguments.length>2?createWrapper(key,19,slice(arguments,2),null,object):createWrapper(key,3,null,null,object)}function compose(){for(var funcs=arguments,length=funcs.length;length--;)if(!isFunction(funcs[length]))throw new TypeError;return function(){for(var args=arguments,length=funcs.length;length--;)args=[funcs[length].apply(this,args)];return args[0]}}function curry(func,arity){return arity="number"==typeof arity?arity:+arity||func.length,createWrapper(func,4,null,null,null,arity)}function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if(!isFunction(func))throw new TypeError;if(wait=nativeMax(0,wait)||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=options.leading,maxWait="maxWait"in options&&(nativeMax(wait,options.maxWait)||0),trailing="trailing"in options?options.trailing:trailing);var delayed=function(){var remaining=wait-(now()-stamp);if(remaining<=0){maxTimeoutId&&clearTimeout(maxTimeoutId);var isCalled=trailingCall;maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=null))}else timeoutId=setTimeout(delayed,remaining)},maxDelayed=function(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId=timeoutId=trailingCall=undefined,(trailing||maxWait!==wait)&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=null))};return function(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=null),result}}function defer(func){if(!isFunction(func))throw new TypeError;var args=slice(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}function delay(func,wait){if(!isFunction(func))throw new TypeError;var args=slice(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){if(!isFunction(func))throw new TypeError;var memoized=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)};return memoized.cache={},memoized}function once(func){var ran,result;if(!isFunction(func))throw new TypeError;return function(){return ran?result:(ran=!0,result=func.apply(this,arguments),func=null,result)}}function partial(func){return createWrapper(func,16,slice(arguments,1))}function partialRight(func){return createWrapper(func,32,null,slice(arguments,1))}function throttle(func,wait,options){var leading=!0,trailing=!0;if(!isFunction(func))throw new TypeError;return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?options.leading:leading,trailing="trailing"in options?options.trailing:trailing),debounceOptions.leading=leading,debounceOptions.maxWait=wait,debounceOptions.trailing=trailing,debounce(func,wait,debounceOptions)}function wrap(value,wrapper){return createWrapper(wrapper,16,[value])}function constant(value){return function(){return value}}function createCallback(func,thisArg,argCount){var type=typeof func;if(null==func||"function"==type)return baseCreateCallback(func,thisArg,argCount);if("object"!=type)return property(func);var props=keys(func),key=props[0],a=func[key];return 1!=props.length||a!==a||isObject(a)?function(object){for(var length=props.length,result=!1;length--&&(result=baseIsEqual(object[props[length]],func[props[length]],null,!0)););return result}:function(object){var b=object[key];return a===b&&(0!==a||1/a==1/b)}}function escape(string){return null==string?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object,source,options){var chain=!0,methodNames=source&&functions(source);source&&(options||methodNames.length)||(null==options&&(options=source),ctor=lodashWrapper,source=object,object=lodash,methodNames=functions(source)),options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);var ctor=object,isFunc=isFunction(ctor);forEach(methodNames,function(methodName){var func=object[methodName]=source[methodName];isFunc&&(ctor.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(object,args);if(chain||chainAll){if(value===result&&isObject(result))return this;result=new ctor(result),result.__chain__=chainAll}return result})})}function noConflict(){return context._=oldDash,this}function noop(){}function property(key){return function(object){return object[key]}}function random(min,max,floating){var noMin=null==min,noMax=null==max;if(null==floating&&("boolean"==typeof min&&noMax?(floating=min,min=1):noMax||"boolean"!=typeof max||(floating=max,noMax=!0)),noMin&&noMax&&(max=1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function result(object,key){if(object){var value=object[key];return isFunction(value)?object[key]():value}}function template(text,data,options){var settings=lodash.templateSettings;text=String(text||""),options=defaults({},options,settings);var isEvaluating,imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable,hasVariable=variable;hasVariable||(variable="obj",source="with ("+variable+") {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//# sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){throw e.source=source,e}return data?result(data):(result.source=source,result)}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);for(callback=baseCreateCallback(callback,thisArg,1);++index<n;)result[index]=callback(index);return result}function unescape(string){return null==string?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(null==prefix?"":prefix)+id}function chain(value){return value=new lodashWrapper(value),value.__chain__=!0,value}function tap(value,interceptor){return interceptor(value),value}function wrapperChain(){return this.__chain__=!0,this}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayRef=[],errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype,oldDash=context._,toString=objectProto.toString,reNative=RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ceil=Math.ceil,clearTimeout=context.clearTimeout,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=isNative(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,propertyIsEnumerable=objectProto.propertyIsEnumerable,setTimeout=context.setTimeout,splice=arrayRef.splice,unshift=arrayRef.unshift,defineProperty=function(){try{var o={},func=isNative(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}return result}(),nativeCreate=isNative(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,ctorByClass={};
ctorByClass[arrayClass]=Array,ctorByClass[boolClass]=Boolean,ctorByClass[dateClass]=Date,ctorByClass[funcClass]=Function,ctorByClass[objectClass]=Object,ctorByClass[numberClass]=Number,ctorByClass[regexpClass]=RegExp,ctorByClass[stringClass]=String;var nonEnumProps={};nonEnumProps[arrayClass]=nonEnumProps[dateClass]=nonEnumProps[numberClass]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},nonEnumProps[boolClass]=nonEnumProps[stringClass]={constructor:!0,toString:!0,valueOf:!0},nonEnumProps[errorClass]=nonEnumProps[funcClass]=nonEnumProps[regexpClass]={constructor:!0,toString:!0},nonEnumProps[objectClass]={constructor:!0},function(){for(var length=shadowedProps.length;length--;){var key=shadowedProps[length];for(var className in nonEnumProps)hasOwnProperty.call(nonEnumProps,className)&&!hasOwnProperty.call(nonEnumProps[className],key)&&(nonEnumProps[className][key]=!1)}}(),lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};!function(){var ctor=function(){this.x=1},object={0:1,length:1},props=[];ctor.prototype={valueOf:1,y:1};for(var key in new ctor)props.push(key);for(key in arguments);support.argsClass=toString.call(arguments)==argsClass,support.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name"),support.enumPrototypes=propertyIsEnumerable.call(ctor,"prototype"),support.funcDecomp=!isNative(context.WinRTError)&&reThis.test(runInContext),support.funcNames="string"==typeof Function.name,support.nonEnumArgs=0!=key,support.nonEnumShadows=!/valueOf/.test(props),support.ownLast="x"!=props[0],support.spliceObjects=(arrayRef.splice.call(object,0,1),!object[0]),support.unindexedChars="x"[0]+Object("x")[0]!="xx";try{support.nodeClass=!(toString.call(document)==objectClass&&!({toString:0}+""))}catch(e){support.nodeClass=!0}}(1),lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var iteratorTemplate=function(obj){var __p="var index, iterable = "+obj.firstArg+", result = "+obj.init+";\nif (!iterable) return result;\n"+obj.top+";";obj.array?(__p+="\nvar length = iterable.length; index = -1;\nif ("+obj.array+") {  ",support.unindexedChars&&(__p+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),__p+="\n  while (++index < length) {\n    "+obj.loop+";\n  }\n}\nelse {  "):support.nonEnumArgs&&(__p+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+obj.loop+";\n    }\n  } else {  "),support.enumPrototypes&&(__p+="\n  var skipProto = typeof iterable == 'function';\n  "),support.enumErrorProps&&(__p+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var conditions=[];if(support.enumPrototypes&&conditions.push('!(skipProto && index == "prototype")'),support.enumErrorProps&&conditions.push('!(skipErrorProps && (index == "message" || index == "name"))'),obj.useHas&&obj.keys)__p+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }  ";else if(__p+="\n  for (index in iterable) {\n",obj.useHas&&conditions.push("hasOwnProperty.call(iterable, index)"),conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }    ",support.nonEnumShadows){for(__p+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)__p+="\n    index = '"+obj.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",obj.useHas||(__p+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),__p+=") {\n      "+obj.loop+";\n    }      ";__p+="\n  }    "}return(obj.array||support.nonEnumArgs)&&(__p+="\n}"),__p+=obj.bottom+";\nreturn result"};nativeCreate||(baseCreate=function(){function Object(){}return function(prototype){if(isObject(prototype)){Object.prototype=prototype;var result=new Object;Object.prototype=null}return result||context.Object()}}());var setBindData=defineProperty?function(func,value){descriptor.value=value,defineProperty(func,"__bindData__",descriptor),descriptor.value=null}:noop;support.argsClass||(isArguments=function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")||!1});var isArray=nativeIsArray||function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==arrayClass||!1},shimKeys=createIterator({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),keys=nativeKeys?function(object){return isObject(object)?support.enumPrototypes&&"function"==typeof object||support.nonEnumArgs&&object.length&&isArguments(object)?shimKeys(object):nativeKeys(object):[]}:shimKeys,eachIteratorOptions={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:keys,loop:"if (callback(iterable[index], index, collection) === false) return result"},defaultsIteratorOptions={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:keys,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},forOwnIteratorOptions={top:"if (!objectTypes[typeof iterable]) return result;\n"+eachIteratorOptions.top,array:!1},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},htmlUnescapes=invert(htmlEscapes),reEscapedHtml=RegExp("("+keys(htmlUnescapes).join("|")+")","g"),reUnescapedHtml=RegExp("["+keys(htmlEscapes).join("")+"]","g"),baseEach=createIterator(eachIteratorOptions),assign=createIterator(defaultsIteratorOptions,{top:defaultsIteratorOptions.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),defaults=createIterator(defaultsIteratorOptions),forIn=createIterator(eachIteratorOptions,forOwnIteratorOptions,{useHas:!1}),forOwn=createIterator(eachIteratorOptions,forOwnIteratorOptions);isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&toString.call(value)==funcClass});var isPlainObject=getPrototypeOf?function(value){if(!value||toString.call(value)!=objectClass||!support.argsClass&&isArguments(value))return!1;var valueOf=value.valueOf,objProto=isNative(valueOf)&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)}:shimIsPlainObject,countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key]++:result[key]=1}),groupBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)}),indexBy=createAggregator(function(result,value,key){result[key]=value}),pluck=map,where=filter,now=isNative(now=Date.now)&&now||function(){return(new Date).getTime()},parseInt=8==nativeParseInt(whitespace+"08")?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};return lodash.after=after,lodash.assign=assign,lodash.at=at,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.chain=chain,lodash.compact=compact,lodash.compose=compose,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.createCallback=createCallback,lodash.curry=curry,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.filter=filter,lodash.flatten=flatten,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.map=map,lodash.mapValues=mapValues,lodash.max=max,lodash.memoize=memoize,lodash.merge=merge,lodash.min=min,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.pull=pull,lodash.range=range,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.shuffle=shuffle,lodash.sortBy=sortBy,lodash.tap=tap,lodash.throttle=throttle,lodash.times=times,lodash.toArray=toArray,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.values=values,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.collect=map,lodash.drop=rest,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,lodash.unzip=zip,mixin(lodash),lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.contains=contains,lodash.escape=escape,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.has=has,lodash.identity=identity,lodash.indexOf=indexOf,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isNaN=isNaN,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isUndefined=isUndefined,lodash.lastIndexOf=lastIndexOf,lodash.mixin=mixin,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.result=result,lodash.runInContext=runInContext,lodash.size=size,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.template=template,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.all=every,lodash.any=some,lodash.detect=find,lodash.findWhere=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.include=contains,lodash.inject=reduce,mixin(function(){var source={};return forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.first=first,lodash.last=last,lodash.sample=sample,lodash.take=first,lodash.head=first,forOwn(lodash,function(func,methodName){var callbackable="sample"!==methodName;lodash.prototype[methodName]||(lodash.prototype[methodName]=function(n,guard){var chainAll=this.__chain__,result=func(this.__wrapped__,n,guard);return chainAll||null!=n&&(!guard||callbackable&&"function"==typeof n)?new lodashWrapper(result,chainAll):result})}),lodash.VERSION="2.4.2",lodash.prototype.chain=wrapperChain,lodash.prototype.toString=wrapperToString,lodash.prototype.value=wrapperValueOf,lodash.prototype.valueOf=wrapperValueOf,baseEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){var chainAll=this.__chain__,result=func.apply(this.__wrapped__,arguments);return chainAll?new lodashWrapper(result,chainAll):result}}),baseEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments),this}}),baseEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments),this.__chain__)}}),support.spliceObjects||baseEach(["pop","shift","splice"],function(methodName){var func=arrayRef[methodName],isSplice="splice"==methodName;lodash.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,result=func.apply(value,arguments);return 0===value.length&&delete value[0],chainAll||isSplice?new lodashWrapper(result,chainAll):result}}),lodash}var undefined,arrayPool=[],objectPool=[],idCounter=0,indicatorObject={},keyPrefix=+new Date+"",largeArraySize=75,maxPoolSize=40,whitespace=" \t\v\fÂ \ufeff\n\r\u2028\u2029áš€á Žâ€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reFuncName=/^\s*function[ \n\r\t]+\w/,reInterpolate=/<%=([\s\S]+?)%>/g,reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)"),reNoMatch=/($^)/,reThis=/\bthis\b/,reUnescapedString=/['\n\r\t\u2028\u2029\\]/g,contextProps=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],shadowedProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],templateCounter=0,argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",errorClass="[object Error]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]",cloneableClasses={};cloneableClasses[funcClass]=!1,cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=!0;var debounceOptions={leading:!1,maxWait:0,trailing:!1},descriptor={configurable:!1,enumerable:!1,value:null,writable:!1},iteratorData={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},objectTypes={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},root=objectTypes[typeof window]&&window||this,freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,freeGlobal=objectTypes[typeof global]&&global;!freeGlobal||freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal||(root=freeGlobal);var _=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}.call(this);var lscache=function(){function supportsStorage(){var key="__lscachetest__",value=key;if(void 0!==cachedStorage)return cachedStorage;try{setItem(key,value),removeItem(key),cachedStorage=!0}catch(exc){cachedStorage=!1}return cachedStorage}function supportsJSON(){return void 0===cachedJSON&&(cachedJSON=null!=window.JSON),cachedJSON}function expirationKey(key){return key+CACHE_SUFFIX}function currentTime(){return Math.floor((new Date).getTime()/EXPIRY_UNITS)}function getItem(key){return localStorage.getItem(CACHE_PREFIX+cacheBucket+key)}function setItem(key,value){localStorage.removeItem(CACHE_PREFIX+cacheBucket+key),localStorage.setItem(CACHE_PREFIX+cacheBucket+key,value)}function removeItem(key){localStorage.removeItem(CACHE_PREFIX+cacheBucket+key)}function warn(message,err){warnings&&(!1 in window||"function"!=typeof window.console.warn||(window.console.warn("lscache - "+message),err&&window.console.warn("lscache - The error was: "+err.message)))}var cachedStorage,cachedJSON,CACHE_PREFIX="lscache-",CACHE_SUFFIX="-cacheexpiration",EXPIRY_RADIX=10,EXPIRY_UNITS=6e4,MAX_DATE=Math.floor(864e13/EXPIRY_UNITS),cacheBucket="",warnings=!1;return{set:function(key,value,time){if(supportsStorage()){if("string"!=typeof value){if(!supportsJSON())return;try{value=JSON.stringify(value)}catch(e){return}}try{setItem(key,value)}catch(e){if("QUOTA_EXCEEDED_ERR"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name&&"QuotaExceededError"!==e.name)return void warn("Could not add item with key '"+key+"'",e);for(var storedKey,storedKeys=[],i=0;i<localStorage.length;i++)if(storedKey=localStorage.key(i),0===storedKey.indexOf(CACHE_PREFIX+cacheBucket)&&storedKey.indexOf(CACHE_SUFFIX)<0){var mainKey=storedKey.substr((CACHE_PREFIX+cacheBucket).length),exprKey=expirationKey(mainKey),expiration=getItem(exprKey);expiration=expiration?parseInt(expiration,EXPIRY_RADIX):MAX_DATE,storedKeys.push({key:mainKey,size:(getItem(mainKey)||"").length,expiration:expiration})}storedKeys.sort(function(a,b){return b.expiration-a.expiration});for(var targetSize=(value||"").length;storedKeys.length&&targetSize>0;)storedKey=storedKeys.pop(),warn("Cache is full, removing item with key '"+key+"'"),removeItem(storedKey.key),removeItem(expirationKey(storedKey.key)),targetSize-=storedKey.size;try{setItem(key,value)}catch(e){return void warn("Could not add item with key '"+key+"', perhaps it's too big?",e)}}time?setItem(expirationKey(key),(currentTime()+time).toString(EXPIRY_RADIX)):removeItem(expirationKey(key))}},get:function(key){if(!supportsStorage())return null;var exprKey=expirationKey(key),expr=getItem(exprKey);if(expr){var expirationTime=parseInt(expr,EXPIRY_RADIX);if(currentTime()>=expirationTime)return removeItem(key),removeItem(exprKey),null}var value=getItem(key);if(!value||!supportsJSON())return value;try{return JSON.parse(value)}catch(e){return value}},remove:function(key){return supportsStorage()?(removeItem(key),void removeItem(expirationKey(key))):null},supported:function(){return supportsStorage()},flush:function(){if(supportsStorage())for(var i=localStorage.length-1;i>=0;--i){var key=localStorage.key(i);0===key.indexOf(CACHE_PREFIX+cacheBucket)&&localStorage.removeItem(key)}},setBucket:function(bucket){cacheBucket=bucket},resetBucket:function(){cacheBucket=""},enableWarnings:function(enabled){warnings=enabled}}}();!function(){var Ext=window.Ext4||window.Ext;Ext.Component.prototype._componentConstructor=Ext.Component.prototype.constructor}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Deft.core.Class",{alternateClassName:["Deft.Class"],statics:{registerPreprocessor:function(name,fn,position,relativeTo){Ext.getVersion("extjs")&&Ext.getVersion("core").isLessThan("4.1.0")?Ext.Class.registerPreprocessor(name,function(Class,data,callback){return fn.call(this,Class,data,data,callback)}).setDefaultPreprocessorPosition(name,position,relativeTo):Ext.Class.registerPreprocessor(name,function(Class,data,hooks,callback){return fn.call(this,Class,data,hooks,callback)},[name],position,relativeTo)},hookOnClassCreated:function(hooks,fn){Ext.getVersion("extjs")&&Ext.getVersion("core").isLessThan("4.1.0")?Ext.Function.interceptBefore(hooks,"onClassCreated",fn):Ext.Function.interceptBefore(hooks,"onCreated",fn)},hookOnClassExtended:function(data,fn){var onClassExtended;onClassExtended=Ext.getVersion("extjs")&&Ext.getVersion("core").isLessThan("4.1.0")?function(Class,data){return fn.call(this,Class,data,data)}:fn,null!=data.onClassExtended?Ext.Function.interceptBefore(data,"onClassExtended",onClassExtended):data.onClassExtended=onClassExtended},extendsClass:function(className,currentClass){try{return Ext.getClassName(currentClass)===className||!(null==currentClass||!currentClass.superclass)&&(Ext.getClassName(currentClass.superclass)===className||Deft.Class.extendsClass(className,Ext.getClass(currentClass.superclass)))}catch(error){return!1}}}}),Ext.define("Deft.log.Logger",{alternateClassName:["Deft.Logger"],singleton:!0,log:function(message,priority){null==priority&&(priority="info")},error:function(message){this.log(message,"error")},info:function(message){this.log(message,"info")},verbose:function(message){this.log(message,"verbose")},warn:function(message){this.log(message,"warn")},deprecate:function(message){this.log(message,"deprecate")}},function(){var _ref;null!=Ext.getVersion("extjs")?this.log=function(message,priority){null==priority&&(priority="info"),"deprecate"===priority&&(priority="warn"),Ext.log({msg:message,level:priority})}:Ext.isFunction(null!=(_ref=Ext.Logger)?_ref.log:void 0)&&(this.log=Ext.bind(Ext.Logger.log,Ext.Logger))}),Ext.define("Deft.util.Function",{alternateClassName:["Deft.Function"],statics:{spread:function(fn,scope){return function(array){return Ext.isArray(array)||Ext.Error.raise({msg:"Error spreading passed Array over target function arguments: passed a non-Array."}),fn.apply(scope,array)}},memoize:function(fn,scope,hashFn){var memo;return memo={},function(value){var key;return key=Ext.isFunction(hashFn)?hashFn.apply(scope,arguments):value,key in memo||(memo[key]=fn.apply(scope,arguments)),memo[key]}},extract:function(object,key){var value;return value=object[key],delete object[key],value}}}),Ext.define("Deft.event.LiveEventListener",{alternateClassName:["Deft.LiveEventListener"],requires:["Ext.ComponentQuery"],constructor:function(config){var component,components,_i,_len;for(Ext.apply(this,config),this.components=[],components=Ext.ComponentQuery.query(this.selector,this.container),_i=0,_len=components.length;_i<_len;_i++)component=components[_i],this.components.push(component),component.on(this.eventName,this.fn,this.scope,this.options)},destroy:function(){var component,_i,_len,_ref;for(_ref=this.components,_i=0,_len=_ref.length;_i<_len;_i++)component=_ref[_i],component.un(this.eventName,this.fn,this.scope);this.components=null},register:function(component){this.matches(component)&&(this.components.push(component),component.on(this.eventName,this.fn,this.scope,this.options))},unregister:function(component){var index;index=Ext.Array.indexOf(this.components,component),index!==-1&&(component.un(this.eventName,this.fn,this.scope),Ext.Array.erase(this.components,index,1))},matches:function(component){return null===this.selector&&this.container===component||(!(null!==this.container||!Ext.Array.contains(Ext.ComponentQuery.query(this.selector),component))||!(!component.isDescendantOf(this.container)||!Ext.Array.contains(this.container.query(this.selector),component)))}}),Ext.define("Deft.event.LiveEventBus",{alternateClassName:["Deft.LiveEventBus"],requires:["Ext.Component","Ext.ComponentManager","Deft.event.LiveEventListener"],singleton:!0,constructor:function(){this.listeners=[]},destroy:function(){var listener,_i,_len,_ref;for(_ref=this.listeners,_i=0,_len=_ref.length;_i<_len;_i++)listener=_ref[_i],listener.destroy();this.listeners=null},addListener:function(container,selector,eventName,fn,scope,options){var listener;listener=Ext.create("Deft.event.LiveEventListener",{container:container,selector:selector,eventName:eventName,fn:fn,scope:scope,options:options}),this.listeners.push(listener)},removeListener:function(container,selector,eventName,fn,scope){var listener;listener=this.findListener(container,selector,eventName,fn,scope),null!=listener&&(Ext.Array.remove(this.listeners,listener),listener.destroy())},on:function(container,selector,eventName,fn,scope,options){return this.addListener(container,selector,eventName,fn,scope,options)},un:function(container,selector,eventName,fn,scope){return this.removeListener(container,selector,eventName,fn,scope)},findListener:function(container,selector,eventName,fn,scope){var listener,_i,_len,_ref;for(_ref=this.listeners,_i=0,_len=_ref.length;_i<_len;_i++)if(listener=_ref[_i],listener.container===container&&listener.selector===selector&&listener.eventName===eventName&&listener.fn===fn&&listener.scope===scope)return listener;return null},register:function(component){component.on("added",this.onComponentAdded,this),component.on("removed",this.onComponentRemoved,this)},unregister:function(component){component.un("added",this.onComponentAdded,this),component.un("removed",this.onComponentRemoved,this)},onComponentAdded:function(component,container,eOpts){var listener,_i,_len,_ref;for(_ref=this.listeners,_i=0,_len=_ref.length;_i<_len;_i++)listener=_ref[_i],listener.register(component)},onComponentRemoved:function(component,container,eOpts){var listener,_i,_len,_ref;for(_ref=this.listeners,_i=0,_len=_ref.length;_i<_len;_i++)listener=_ref[_i],listener.unregister(component)}},function(){null!=Ext.getVersion("touch")&&Ext.define("Deft.Component",{override:"Ext.Component",setParent:function(newParent){var oldParent,result;return oldParent=this.getParent(),result=this.callParent(arguments),null===oldParent&&null!==newParent?this.fireEvent("added",this,newParent):null!==oldParent&&null!==newParent?(this.fireEvent("removed",this,oldParent),this.fireEvent("added",this,newParent)):null!==oldParent&&null===newParent&&this.fireEvent("removed",this,oldParent),result},isDescendantOf:function(container){var ancestor;for(ancestor=this.getParent();null!=ancestor;){if(ancestor===container)return!0;ancestor=ancestor.getParent()}return!1}}),Ext.Function.interceptAfter(Ext.ComponentManager,"register",function(component){Deft.event.LiveEventBus.register(component)}),Ext.Function.interceptAfter(Ext.ComponentManager,"unregister",function(component){Deft.event.LiveEventBus.unregister(component)})}),Ext.define("Deft.ioc.DependencyProvider",{requires:["Deft.log.Logger"],config:{identifier:null,className:null,parameters:null,fn:null,value:void 0,singleton:!0,eager:!1},constructor:function(config){var classDefinition;return this.initConfig(config),null!=config.value&&config.value.constructor===Object&&this.setValue(config.value),this.getEager()&&(null!=this.getValue()&&Ext.Error.raise({msg:"Error while configuring '"+this.getIdentifier()+"': a 'value' cannot be created eagerly."}),this.getSingleton()||Ext.Error.raise({msg:"Error while configuring '"+this.getIdentifier()+"': only singletons can be created eagerly."})),null!=this.getClassName()&&(classDefinition=Ext.ClassManager.get(this.getClassName()),null==classDefinition&&(Deft.Logger.warn("Synchronously loading '"+this.getClassName()+"'; consider adding Ext.require('"+this.getClassName()+"') above Ext.onReady."),Ext.syncRequire(this.getClassName()),classDefinition=Ext.ClassManager.get(this.getClassName())),null==classDefinition&&Ext.Error.raise({msg:"Error while configuring rule for '"+this.getIdentifier()+"': unrecognized class name or alias: '"+this.getClassName()+"'"})),this.getSingleton()?null!=this.getClassName()&&null!=this.getParameters()&&Ext.ClassManager.get(this.getClassName()).singleton&&Ext.Error.raise({msg:"Error while configuring rule for '"+this.getIdentifier()+"': parameters cannot be applied to singleton classes. Consider removing 'singleton: true' from the class definition."}):(null!=this.getClassName()&&Ext.ClassManager.get(this.getClassName()).singleton&&Ext.Error.raise({msg:"Error while configuring rule for '"+this.getIdentifier()+"': singleton classes cannot be configured for injection as a prototype. Consider removing 'singleton: true' from the class definition."}),null!=this.getValue()&&Ext.Error.raise({msg:"Error while configuring '"+this.getIdentifier()+"': a 'value' can only be configured as a singleton."})),this},resolve:function(targetInstance){var instance,parameters;return Deft.Logger.log("Resolving '"+this.getIdentifier()+"'."),void 0!==this.getValue()?this.getValue():(instance=null,null!=this.getFn()?(Deft.Logger.log("Executing factory function."),instance=this.getFn().call(null,targetInstance)):null!=this.getClassName()?Ext.ClassManager.get(this.getClassName()).singleton?(Deft.Logger.log("Using existing singleton instance of '"+this.getClassName()+"'."),instance=Ext.ClassManager.get(this.getClassName())):(Deft.Logger.log("Creating instance of '"+this.getClassName()+"'."),parameters=null!=this.getParameters()?[this.getClassName()].concat(this.getParameters()):[this.getClassName()],instance=Ext.create.apply(this,parameters)):Ext.Error.raise({msg:"Error while configuring rule for '"+this.getIdentifier()+"': no 'value', 'fn', or 'className' was specified."}),this.getSingleton()&&this.setValue(instance),instance)}}),Ext.define("Deft.ioc.Injector",{alternateClassName:["Deft.Injector"],requires:["Ext.Component","Deft.log.Logger","Deft.ioc.DependencyProvider"],singleton:!0,constructor:function(){return this.providers={},this},configure:function(configuration){var newProviders;Deft.Logger.log("Configuring the injector."),newProviders={},Ext.Object.each(configuration,function(identifier,config){var provider;Deft.Logger.log("Configuring dependency provider for '"+identifier+"'."),provider=Ext.isString(config)?Ext.create("Deft.ioc.DependencyProvider",{identifier:identifier,className:config}):Ext.create("Deft.ioc.DependencyProvider",Ext.apply({identifier:identifier},config)),this.providers[identifier]=provider,newProviders[identifier]=provider},this),Ext.Object.each(newProviders,function(identifier,provider){provider.getEager()&&(Deft.Logger.log("Eagerly creating '"+provider.getIdentifier()+"'."),provider.resolve())},this)},reset:function(){Deft.Logger.log("Resetting the injector."),this.providers={}},canResolve:function(identifier){var provider;return provider=this.providers[identifier],null!=provider},resolve:function(identifier,targetInstance){var provider;return provider=this.providers[identifier],null!=provider?provider.resolve(targetInstance):void Ext.Error.raise({msg:"Error while resolving value to inject: no dependency provider found for '"+identifier+"'."})},inject:function(identifiers,targetInstance,targetInstanceIsInitialized){var injectConfig,name,originalInitConfigFunction,setterFunctionName,value;if(null==targetInstanceIsInitialized&&(targetInstanceIsInitialized=!0),injectConfig={},Ext.isString(identifiers)&&(identifiers=[identifiers]),Ext.Object.each(identifiers,function(key,value){var identifier,resolvedValue,targetProperty;targetProperty=Ext.isArray(identifiers)?value:key,identifier=value,resolvedValue=this.resolve(identifier,targetInstance),targetProperty in targetInstance.config?(Deft.Logger.log("Injecting '"+identifier+"' into '"+targetProperty+"' config."),injectConfig[targetProperty]=resolvedValue):(Deft.Logger.log("Injecting '"+identifier+"' into '"+targetProperty+"' property."),targetInstance[targetProperty]=resolvedValue)},this),targetInstanceIsInitialized)for(name in injectConfig)value=injectConfig[name],setterFunctionName="set"+Ext.String.capitalize(name),targetInstance[setterFunctionName].call(targetInstance,value);else null!=Ext.getVersion("extjs")&&targetInstance instanceof Ext.ClassManager.get("Ext.Component")?targetInstance.injectConfig=injectConfig:Ext.isFunction(targetInstance.initConfig)&&(originalInitConfigFunction=targetInstance.initConfig,targetInstance.initConfig=function(config){var result;return result=originalInitConfigFunction.call(this,Ext.Object.merge({},config||{},injectConfig))});return targetInstance}},function(){null!=Ext.getVersion("extjs")&&(Ext.getVersion("core").isLessThan("4.1.0")?Ext.Component.override({constructor:function(config){
return config=Ext.Object.merge({},config||{},this.injectConfig||{}),delete this.injectConfig,this.callOverridden([config])}}):Ext.define("Deft.InjectableComponent",{override:"Ext.Component",constructor:function(config){return config=Ext.Object.merge({},config||{},this.injectConfig||{}),delete this.injectConfig,this.callParent([config])}}))}),Ext.define("Deft.mixin.Injectable",{requires:["Deft.core.Class","Deft.ioc.Injector","Deft.log.Logger"],onClassMixedIn:function(targetClass){Deft.Logger.deprecate("Deft.mixin.Injectable has been deprecated and can now be omitted - simply use the 'inject' class annotation on its own.")}},function(){var createInjectionInterceptor;createInjectionInterceptor=Ext.getVersion("extjs")&&Ext.getVersion("core").isLessThan("4.1.0")?function(){return function(){return this.$injected||(Deft.Injector.inject(this.inject,this,!1),this.$injected=!0),this.callOverridden(arguments)}}:function(){return function(){return this.$injected||(Deft.Injector.inject(this.inject,this,!1),this.$injected=!0),this.callParent(arguments)}},Deft.Class.registerPreprocessor("inject",function(Class,data,hooks,callback){var dataInjectObject,identifier,_i,_len,_ref;if(Ext.isString(data.inject)&&(data.inject=[data.inject]),Ext.isArray(data.inject)){for(dataInjectObject={},_ref=data.inject,_i=0,_len=_ref.length;_i<_len;_i++)identifier=_ref[_i],dataInjectObject[identifier]=identifier;data.inject=dataInjectObject}Deft.Class.hookOnClassCreated(hooks,function(Class){Class.override({constructor:createInjectionInterceptor()})}),Deft.Class.hookOnClassExtended(data,function(Class,data,hooks){var _ref1;Deft.Class.hookOnClassCreated(hooks,function(Class){Class.override({constructor:createInjectionInterceptor()})}),null==(_ref1=data.inject)&&(data.inject={}),Ext.applyIf(data.inject,Class.superclass.inject)})},"before","extend")}),Ext.define("Deft.mvc.Observer",{requires:["Deft.core.Class","Ext.util.Observable","Deft.util.Function"],statics:{mergeObserve:function(originalParentObserve,originalChildObserve){var childEvent,childEvents,childHandler,childHandlerArray,childObserve,childTarget,convertConfigArray,eventOptionNames,parentEvent,parentEvents,parentHandler,parentHandlerArray,parentObserve,parentTarget,_ref,_ref1;parentObserve=Ext.isObject(originalParentObserve)?Ext.clone(originalParentObserve):{},childObserve=Ext.isObject(originalChildObserve)?Ext.clone(originalChildObserve):{},eventOptionNames=["buffer","single","delay","element","target","destroyable"],convertConfigArray=function(observeConfig){var handlerConfig,newObserveEvents,observeEvents,observeTarget,thisEventOptionName,thisObserveEvent,_i,_j,_len,_len1,_results;_results=[];for(observeTarget in observeConfig)if(observeEvents=observeConfig[observeTarget],Ext.isArray(observeEvents)){for(newObserveEvents={},_i=0,_len=observeEvents.length;_i<_len;_i++)if(thisObserveEvent=observeEvents[_i],1===Ext.Object.getSize(thisObserveEvent))Ext.apply(newObserveEvents,thisObserveEvent);else{for(handlerConfig={},null!=(null!=thisObserveEvent?thisObserveEvent.fn:void 0)&&(handlerConfig.fn=thisObserveEvent.fn),null!=(null!=thisObserveEvent?thisObserveEvent.scope:void 0)&&(handlerConfig.scope=thisObserveEvent.scope),_j=0,_len1=eventOptionNames.length;_j<_len1;_j++)thisEventOptionName=eventOptionNames[_j],null!=(null!=thisObserveEvent?thisObserveEvent[thisEventOptionName]:void 0)&&(handlerConfig[thisEventOptionName]=thisObserveEvent[thisEventOptionName]);newObserveEvents[thisObserveEvent.event]=[handlerConfig]}_results.push(observeConfig[observeTarget]=newObserveEvents)}else _results.push(void 0);return _results},convertConfigArray(parentObserve),convertConfigArray(childObserve);for(childTarget in childObserve){childEvents=childObserve[childTarget];for(childEvent in childEvents)childHandler=childEvents[childEvent],Ext.isString(childHandler)&&(childObserve[childTarget][childEvent]=childHandler.replace(" ","").split(",")),(null!=parentObserve?parentObserve[childTarget]:void 0)||(parentObserve[childTarget]={}),(null!=parentObserve&&null!=(_ref=parentObserve[childTarget])?_ref[childEvent]:void 0)||(parentObserve[childTarget][childEvent]=childObserve[childTarget][childEvent],delete childObserve[childTarget][childEvent])}for(parentTarget in parentObserve){parentEvents=parentObserve[parentTarget];for(parentEvent in parentEvents)parentHandler=parentEvents[parentEvent],Ext.isString(parentHandler)&&(parentObserve[parentTarget][parentEvent]=parentHandler.split(",")),(null!=childObserve&&null!=(_ref1=childObserve[parentTarget])?_ref1[parentEvent]:void 0)&&(childHandlerArray=childObserve[parentTarget][parentEvent],parentHandlerArray=parentObserve[parentTarget][parentEvent],parentObserve[parentTarget][parentEvent]=Ext.Array.unique(Ext.Array.insert(parentHandlerArray,0,childHandlerArray)))}return parentObserve}},constructor:function(config){var eventName,events,handler,handlerArray,host,options,references,scope,target,_i,_len;if(this.listeners=[],host=null!=config?config.host:void 0,target=null!=config?config.target:void 0,events=null!=config?config.events:void 0,host&&target&&(this.isPropertyChain(target)||this.isTargetObservable(host,target)))for(eventName in events)for(handlerArray=events[eventName],Ext.isString(handlerArray)&&(handlerArray=handlerArray.replace(" ","").split(",")),_i=0,_len=handlerArray.length;_i<_len;_i++)handler=handlerArray[_i],scope=host,options=null,Ext.isObject(handler)&&(options=Ext.clone(handler),(null!=options?options.event:void 0)&&(eventName=Deft.util.Function.extract(options,"event")),(null!=options?options.fn:void 0)&&(handler=Deft.util.Function.extract(options,"fn")),(null!=options?options.scope:void 0)&&(scope=Deft.util.Function.extract(options,"scope"))),references=this.locateReferences(host,target,handler),references?(references.target.on(eventName,references.handler,scope,options),this.listeners.push({targetName:target,target:references.target,event:eventName,handler:references.handler,scope:scope}),Deft.Logger.log("Created observer on '"+target+"' for event '"+eventName+"'.")):Deft.Logger.warn("Could not create observer on '"+target+"' for event '"+eventName+"'.");else Deft.Logger.warn("Could not create observers on '"+target+"' because '"+target+"' is not an Ext.util.Observable");return this},isTargetObservable:function(host,target){var hostTarget,hostTargetClass,_ref;return hostTarget=this.locateTarget(host,target),null!=hostTarget&&(null!=hostTarget.isObservable||null!=(null!=(_ref=hostTarget.mixins)?_ref.observable:void 0)||(hostTargetClass=Ext.ClassManager.getClass(hostTarget),Deft.Class.extendsClass("Ext.util.Observable",hostTargetClass)||Deft.Class.extendsClass("Ext.mixin.Observable",hostTargetClass)))},locateTarget:function(host,target){var result;return Ext.isFunction(host["get"+Ext.String.capitalize(target)])?result=host["get"+Ext.String.capitalize(target)].call(host):null!=(null!=host?host[target]:void 0)?result=host[target]:null},isPropertyChain:function(target){return Ext.isString(target)&&target.indexOf(".")>-1},locateReferences:function(host,target,handler){var handlerHost,propertyChain;if(handlerHost=host,this.isPropertyChain(target)){if(propertyChain=this.parsePropertyChain(host,target),!propertyChain)return null;host=propertyChain.host,target=propertyChain.target}return Ext.isFunction(handler)?{target:this.locateTarget(host,target),handler:handler}:Ext.isFunction(handlerHost[handler])?{target:this.locateTarget(host,target),handler:handlerHost[handler]}:null},parsePropertyChain:function(host,target){var propertyChain;if(Ext.isString(target))propertyChain=target.split(".");else{if(!Ext.isArray(target))return null;propertyChain=target}return propertyChain.length>1&&null!=this.locateTarget(host,propertyChain[0])?this.parsePropertyChain(this.locateTarget(host,propertyChain[0]),propertyChain.slice(1)):this.isTargetObservable(host,propertyChain[0])?{host:host,target:propertyChain[0]}:null},destroy:function(){var listenerData,_i,_len,_ref;for(_ref=this.listeners,_i=0,_len=_ref.length;_i<_len;_i++)listenerData=_ref[_i],Deft.Logger.log("Removing observer on '"+listenerData.targetName+"' for event '"+listenerData.event+"'."),listenerData.target.un(listenerData.event,listenerData.handler,listenerData.scope);this.listeners=[]}}),Ext.define("Deft.mvc.ComponentSelectorListener",{requires:["Deft.event.LiveEventBus"],constructor:function(config){var component,_i,_len,_ref;if(Ext.apply(this,config),this.componentSelector.live)Deft.LiveEventBus.addListener(this.componentSelector.view,this.componentSelector.selector,this.eventName,this.fn,this.scope,this.options);else for(_ref=this.componentSelector.components,_i=0,_len=_ref.length;_i<_len;_i++)component=_ref[_i],component.on(this.eventName,this.fn,this.scope,this.options);return this},destroy:function(){var component,_i,_len,_ref;if(this.componentSelector.live)Deft.LiveEventBus.removeListener(this.componentSelector.view,this.componentSelector.selector,this.eventName,this.fn,this.scope);else for(_ref=this.componentSelector.components,_i=0,_len=_ref.length;_i<_len;_i++)component=_ref[_i],component.un(this.eventName,this.fn,this.scope)}}),Ext.define("Deft.mvc.ComponentSelector",{requires:["Ext.ComponentQuery","Deft.log.Logger","Deft.mvc.ComponentSelectorListener"],constructor:function(config){var eventName,fn,listener,options,scope,_ref;if(Ext.apply(this,config),this.live||(this.components=null!=this.selector?Ext.ComponentQuery.query(this.selector,this.view):[this.view]),this.selectorListeners=[],Ext.isObject(this.listeners)){_ref=this.listeners;for(eventName in _ref)listener=_ref[eventName],fn=listener,scope=this.scope,options=null,Ext.isObject(listener)&&(options=Ext.apply({},listener),null!=options.fn&&(fn=options.fn,delete options.fn),null!=options.scope&&(scope=options.scope,delete options.scope)),Ext.isString(fn)&&Ext.isFunction(scope[fn])&&(fn=scope[fn]),Ext.isFunction(fn)||Ext.Error.raise({msg:"Error adding '"+eventName+"' listener: the specified handler '"+fn+"' is not a Function or does not exist."}),this.addListener(eventName,fn,scope,options)}return this},destroy:function(){var selectorListener,_i,_len,_ref;for(_ref=this.selectorListeners,_i=0,_len=_ref.length;_i<_len;_i++)selectorListener=_ref[_i],selectorListener.destroy();this.selectorListeners=[]},addListener:function(eventName,fn,scope,options){var selectorListener;null!=this.findListener(eventName,fn,scope)&&Ext.Error.raise({msg:"Error adding '"+eventName+"' listener: an existing listener for the specified function was already registered for '"+this.selector+"."}),Deft.Logger.log("Adding '"+eventName+"' listener to '"+this.selector+"'."),selectorListener=Ext.create("Deft.mvc.ComponentSelectorListener",{componentSelector:this,eventName:eventName,fn:fn,scope:scope,options:options}),this.selectorListeners.push(selectorListener)},removeListener:function(eventName,fn,scope){var selectorListener;selectorListener=this.findListener(eventName,fn,scope),null!=selectorListener&&(Deft.Logger.log("Removing '"+eventName+"' listener from '"+this.selector+"'."),selectorListener.destroy(),Ext.Array.remove(this.selectorListeners,selectorListener))},findListener:function(eventName,fn,scope){var selectorListener,_i,_len,_ref;for(_ref=this.selectorListeners,_i=0,_len=_ref.length;_i<_len;_i++)if(selectorListener=_ref[_i],selectorListener.eventName===eventName&&selectorListener.fn===fn&&selectorListener.scope===scope)return selectorListener;return null}}),Ext.define("Deft.mvc.ViewController",{alternateClassName:["Deft.ViewController"],requires:["Deft.core.Class","Deft.log.Logger","Deft.mvc.ComponentSelector","Deft.mvc.Observer"],config:{view:null},observe:{},constructor:function(config){return null==config&&(config={}),config.view&&this.controlView(config.view),this.initConfig(config),Ext.Object.getSize(this.observe)>0&&this.createObservers(),this},controlView:function(view){view instanceof Ext.ClassManager.get("Ext.Component")?(this.setView(view),this.registeredComponentReferences={},this.registeredComponentSelectors={},null!=Ext.getVersion("extjs")?this.getView().rendered?this.onViewInitialize():this.getView().on("afterrender",this.onViewInitialize,this,{single:!0}):this.getView().initialized?this.onViewInitialize():this.getView().on("initialize",this.onViewInitialize,this,{single:!0})):Ext.Error.raise({msg:"Error constructing ViewController: the configured 'view' is not an Ext.Component."})},init:function(){},destroy:function(){var id,selector;for(id in this.registeredComponentReferences)this.removeComponentReference(id);for(selector in this.registeredComponentSelectors)this.removeComponentSelector(selector);return this.removeObservers(),!0},onViewInitialize:function(){var config,id,listeners,live,originalViewDestroyFunction,selector,self,_ref;null!=Ext.getVersion("extjs")?this.getView().on("beforedestroy",this.onViewBeforeDestroy,this):(self=this,originalViewDestroyFunction=this.getView().destroy,this.getView().destroy=function(){self.destroy()&&originalViewDestroyFunction.call(this)}),_ref=this.control;for(id in _ref)config=_ref[id],selector=null,"view"!==id&&(selector=Ext.isString(config)?config:null!=config.selector?config.selector:"#"+id),listeners=null,Ext.isObject(config.listeners)?listeners=config.listeners:null==config.selector&&null==config.live&&(listeners=config),live=null!=config.live&&config.live,this.addComponentReference(id,selector,live),this.addComponentSelector(selector,listeners,live);this.init()},onViewBeforeDestroy:function(){return!!this.destroy()&&(this.getView().un("beforedestroy",this.onBeforeDestroy,this),!0)},addComponentReference:function(id,selector,live){var getterName,matches;null==live&&(live=!1),Deft.Logger.log("Adding '"+id+"' component reference for selector: '"+selector+"'."),null!=this.registeredComponentReferences[id]&&Ext.Error.raise({msg:"Error adding component reference: an existing component reference was already registered as '"+id+"'."}),"view"!==id&&(getterName="get"+Ext.String.capitalize(id),null==this[getterName]&&(live?this[getterName]=Ext.Function.pass(this.getViewComponent,[selector],this):(matches=this.getViewComponent(selector),null==matches&&Ext.Error.raise({msg:"Error locating component: no component(s) found matching '"+selector+"'."}),this[getterName]=function(){return matches}),this[getterName].generated=!0)),this.registeredComponentReferences[id]=!0},removeComponentReference:function(id){var getterName;Deft.Logger.log("Removing '"+id+"' component reference."),null==this.registeredComponentReferences[id]&&Ext.Error.raise({msg:"Error removing component reference: no component reference is registered as '"+id+"'."}),"view"!==id&&(getterName="get"+Ext.String.capitalize(id),this[getterName].generated&&(this[getterName]=null)),delete this.registeredComponentReferences[id]},getViewComponent:function(selector){var matches;return null!=selector?(matches=Ext.ComponentQuery.query(selector,this.getView()),0===matches.length?null:1===matches.length?matches[0]:matches):this.getView()},addComponentSelector:function(selector,listeners,live){var componentSelector,existingComponentSelector;null==live&&(live=!1),Deft.Logger.log("Adding component selector for: '"+selector+"'."),existingComponentSelector=this.getComponentSelector(selector),null!=existingComponentSelector&&Ext.Error.raise({msg:"Error adding component selector: an existing component selector was already registered for '"+selector+"'."}),componentSelector=Ext.create("Deft.mvc.ComponentSelector",{view:this.getView(),selector:selector,listeners:listeners,scope:this,live:live}),this.registeredComponentSelectors[selector]=componentSelector},removeComponentSelector:function(selector){var existingComponentSelector;Deft.Logger.log("Removing component selector for '"+selector+"'."),existingComponentSelector=this.getComponentSelector(selector),null==existingComponentSelector&&Ext.Error.raise({msg:"Error removing component selector: no component selector registered for '"+selector+"'."}),existingComponentSelector.destroy(),delete this.registeredComponentSelectors[selector]},getComponentSelector:function(selector){return this.registeredComponentSelectors[selector]},createObservers:function(){var events,target,_ref;this.registeredObservers={},_ref=this.observe;for(target in _ref)events=_ref[target],this.addObserver(target,events)},addObserver:function(target,events){var observer;return observer=Ext.create("Deft.mvc.Observer",{host:this,target:target,events:events}),this.registeredObservers[target]=observer},removeObservers:function(){var observer,target,_ref;_ref=this.registeredObservers;for(target in _ref)observer=_ref[target],observer.destroy(),delete this.registeredObservers[target]}},function(){return Deft.Class.registerPreprocessor("observe",function(Class,data,hooks,callback){Deft.Class.hookOnClassExtended(data,function(Class,data,hooks){var _ref;Class.superclass&&(null!=(_ref=Class.superclass)?_ref.observe:void 0)&&Deft.Class.extendsClass("Deft.mvc.ViewController",Class)&&(data.observe=Deft.mvc.Observer.mergeObserve(Class.superclass.observe,data.observe))})},"before","extend")}),Ext.define("Deft.mvc.Application",{alternateClassName:["Deft.Application"],initialized:!1,constructor:function(config){return null==config&&(config={}),this.initConfig(config),Ext.onReady(function(){this.init(),this.initialized=!0},this),this},init:function(){}}),Ext.define("Deft.mixin.Controllable",{requires:["Ext.Component","Deft.core.Class","Deft.log.Logger"],onClassMixedIn:function(targetClass){Deft.Logger.deprecate("Deft.mixin.Controllable has been deprecated and can now be omitted - simply use the 'controller' class annotation on its own.")}},function(){var createControllerInterceptor;createControllerInterceptor=Ext.getVersion("extjs")&&Ext.getVersion("core").isLessThan("4.1.0")?function(){return function(config){var controller;if(null==config&&(config={}),this instanceof Ext.ClassManager.get("Ext.Component")&&!this.$controlled){try{controller=Ext.create(this.controller,config.controllerConfig||this.controllerConfig||{})}catch(error){throw Deft.Logger.warn("Error initializing view controller: an error occurred while creating an instance of the specified controller: '"+this.controller+"'."),error}return void 0===this.getController&&(this.getController=function(){return controller}),this.$controlled=!0,this.callOverridden(arguments),controller.controlView(this),this}return this.callOverridden(arguments)}}:function(){return function(config){var controller;if(null==config&&(config={}),this instanceof Ext.ClassManager.get("Ext.Component")&&!this.$controlled){try{controller=Ext.create(this.controller,config.controllerConfig||this.controllerConfig||{})}catch(error){throw Deft.Logger.warn("Error initializing view controller: an error occurred while creating an instance of the specified controller: '"+this.controller+"'."),error}return void 0===this.getController&&(this.getController=function(){return controller}),this.$controlled=!0,this.callParent(arguments),controller.controlView(this),this}return this.callParent(arguments)}},Deft.Class.registerPreprocessor("controller",function(Class,data,hooks,callback){var self;return Deft.Class.hookOnClassCreated(hooks,function(Class){Class.override({constructor:createControllerInterceptor()})}),Deft.Class.hookOnClassExtended(data,function(Class,data,hooks){Deft.Class.hookOnClassCreated(hooks,function(Class){Class.override({constructor:createControllerInterceptor()})})}),self=this,Ext.require([data.controller],function(){null!=callback&&callback.call(self,Class,data,hooks)}),!1},"before","extend")}),Ext.define("Deft.promise.Promise",{alternateClassName:["Deft.Promise"],statics:{when:function(promiseOrValue){var deferred;return promiseOrValue instanceof Ext.ClassManager.get("Deft.promise.Promise")||promiseOrValue instanceof Ext.ClassManager.get("Deft.promise.Deferred")?promiseOrValue.then():Ext.isObject(promiseOrValue)&&Ext.isFunction(promiseOrValue.then)?(deferred=Ext.create("Deft.promise.Deferred"),promiseOrValue.then(function(value){deferred.resolve(value)},function(error){deferred.reject(error)}),deferred.then()):(deferred=Ext.create("Deft.promise.Deferred"),deferred.resolve(promiseOrValue),deferred.then())},all:function(promisesOrValues){return this.when(promisesOrValues).then({success:function(promisesOrValues){var cancelFunction,canceller,complete,createSuccessFunction,deferred,failureFunction,index,progressFunction,promiseOrValue,rejecter,resolvedCount,resolvedValues,resolver,total,updater,_i,_len;for(deferred=Ext.create("Deft.promise.Deferred"),total=promisesOrValues.length,resolvedValues=new Array(promisesOrValues),resolvedCount=0,updater=function(progress){return deferred.update(progress),progress},resolver=function(index,value){return resolvedValues[index]=value,resolvedCount++,resolvedCount===total&&(complete(),deferred.resolve(resolvedValues)),value},rejecter=function(error){return complete(),deferred.reject(error),error},canceller=function(reason){return complete(),deferred.cancel(reason),reason},complete=function(){return updater=resolver=rejecter=canceller=Ext.emptyFn},createSuccessFunction=function(index){return function(value){return resolver(index,value)}},failureFunction=function(value){return rejecter(value)},progressFunction=function(value){return updater(value)},cancelFunction=function(value){return canceller(value)},index=_i=0,_len=promisesOrValues.length;_i<_len;index=++_i)promiseOrValue=promisesOrValues[index],index in promisesOrValues&&this.when(promiseOrValue).then({success:createSuccessFunction(index),failure:failureFunction,progress:progressFunction,cancel:cancelFunction});return deferred.getPromise()},scope:this})},any:function(promisesOrValues){return this.some(promisesOrValues,1).then({success:function(values){return values[0]}})},some:function(promisesOrValues,howMany){return this.when(promisesOrValues).then({success:function(promisesOrValues){var cancelFunction,canceller,complete,deferred,errorMessage,failureFunction,index,progressFunction,promiseOrValue,rejecter,remainingToReject,remainingToResolve,resolver,successFunction,updater,values,_i,_len;if(values=[],remainingToResolve=howMany,remainingToReject=promisesOrValues.length-remainingToResolve+1,deferred=Ext.create("Deft.promise.Deferred"),promisesOrValues.length<howMany)deferred.reject(new Error("Too few Promises or values were supplied to obtain the requested number of resolved values."));else for(errorMessage=1===howMany?"No Promises were resolved.":"Too few Promises were resolved.",updater=function(progress){return deferred.update(progress),progress},resolver=function(value){return values.push(value),remainingToResolve--,0===remainingToResolve&&(complete(),deferred.resolve(values)),value},rejecter=function(error){return remainingToReject--,0===remainingToReject&&(complete(),deferred.reject(new Error(errorMessage))),error},canceller=function(reason){return remainingToReject--,0===remainingToReject&&(complete(),deferred.reject(new Error(errorMessage))),reason},complete=function(){return updater=resolver=rejecter=canceller=Ext.emptyFn},successFunction=function(value){return resolver(value)},failureFunction=function(value){return rejecter(value)},progressFunction=function(value){return updater(value)},cancelFunction=function(value){return canceller(value)},index=_i=0,_len=promisesOrValues.length;_i<_len;index=++_i)promiseOrValue=promisesOrValues[index],index in promisesOrValues&&this.when(promiseOrValue).then({success:successFunction,failure:failureFunction,progress:progressFunction,cancel:cancelFunction});return deferred.getPromise()},scope:this})},memoize:function(fn,scope,hashFn){var memoizedFn;return memoizedFn=Deft.util.Function.memoize(fn,scope,hashFn),Ext.bind(function(){return this.all(Ext.Array.toArray(arguments)).then(function(values){return memoizedFn.apply(scope,values)})},this)},map:function(promisesOrValues,mapFunction){var createCallback;return createCallback=function(index){return function(value){return mapFunction(value,index,promisesOrValues)}},this.when(promisesOrValues).then({success:function(promisesOrValues){var index,promiseOrValue,results,_i,_len;for(results=new Array(promisesOrValues.length),index=_i=0,_len=promisesOrValues.length;_i<_len;index=++_i)promiseOrValue=promisesOrValues[index],index in promisesOrValues&&(results[index]=this.when(promiseOrValue).then(createCallback(index)));return this.reduce(results,this.reduceIntoArray,results)},scope:this})},reduce:function(promisesOrValues,reduceFunction,initialValue){var initialValueSpecified;return initialValueSpecified=3===arguments.length,this.when(promisesOrValues).then({success:function(promisesOrValues){var reduceArguments,whenFunction;return whenFunction=this.when,reduceArguments=[function(previousValueOrPromise,currentValueOrPromise,currentIndex){return whenFunction(previousValueOrPromise).then(function(previousValue){return whenFunction(currentValueOrPromise).then(function(currentValue){return reduceFunction(previousValue,currentValue,currentIndex,promisesOrValues)})})}],initialValueSpecified&&reduceArguments.push(initialValue),this.when(this.reduceArray.apply(promisesOrValues,reduceArguments))},scope:this})},reduceArray:function(reduceFunction,initialValue){var args,array,index,length,reduced;if(index=0,array=Object(this),length=array.length>>>0,args=arguments,args.length<=1)for(;;){if(index in array){reduced=array[index++];break}if(++index>=length)throw new TypeError}else reduced=args[1];for(;index<length;)index in array&&(reduced=reduceFunction(reduced,array[index],index,array)),index++;return reduced},reduceIntoArray:function(previousValue,currentValue,currentIndex){return previousValue[currentIndex]=currentValue,previousValue}},id:null,constructor:function(config){return this.id=config.id,this.deferred=config.deferred,this},then:function(callbacks){return this.deferred.then.apply(this.deferred,arguments)},otherwise:function(callback,scope){return this.deferred.otherwise.apply(this.deferred,arguments)},always:function(callback,scope){return this.deferred.always.apply(this.deferred,arguments)},cancel:function(reason){return this.deferred.cancel(reason)},getState:function(){return this.deferred.getState()},toString:function(){return null!=this.id?"Promise "+this.id:"Promise"}},function(){null!=Array.prototype.reduce&&(this.reduceArray=Array.prototype.reduce)}),Ext.define("Deft.promise.Deferred",{alternateClassName:["Deft.Deferred"],requires:["Deft.log.Logger","Deft.promise.Promise"],id:null,constructor:function(config){return null==config&&(config={}),this.id=config.id,this.state="pending",this.progress=void 0,this.value=void 0,this.progressCallbacks=[],this.successCallbacks=[],this.failureCallbacks=[],this.cancelCallbacks=[],this.promise=Ext.create("Deft.Promise",{id:this.id?"of "+this.id:null,deferred:this}),this},then:function(callbacks){var callback,cancelCallback,deferred,failureCallback,progressCallback,scope,successCallback,_i,_len,_ref;for(Ext.isObject(callbacks)?(successCallback=callbacks.success,failureCallback=callbacks.failure,progressCallback=callbacks.progress,cancelCallback=callbacks.cancel,scope=callbacks.scope):(successCallback=arguments[0],failureCallback=arguments[1],progressCallback=arguments[2],cancelCallback=arguments[3],scope=arguments[4]),_ref=[successCallback,failureCallback,progressCallback,cancelCallback],_i=0,_len=_ref.length;_i<_len;_i++)callback=_ref[_i],Ext.isFunction(callback)||null===callback||void 0===callback||Ext.Error.raise({msg:"Error while registering callback with "+this+": a non-function specified."});return deferred=Ext.create("Deft.promise.Deferred",{id:"transformed result of "+this}),this.register(this.wrapCallback(deferred,successCallback,scope,"success","resolve"),this.successCallbacks,"resolved",this.value),this.register(this.wrapCallback(deferred,failureCallback,scope,"failure","reject"),this.failureCallbacks,"rejected",this.value),this.register(this.wrapCallback(deferred,cancelCallback,scope,"cancel","cancel"),this.cancelCallbacks,"cancelled",this.value),this.register(this.wrapProgressCallback(deferred,progressCallback,scope),this.progressCallbacks,"pending",this.progress),Deft.Logger.log("Returning "+deferred.getPromise()+"."),deferred.getPromise()},otherwise:function(callback,scope){var _ref;return Ext.isObject(callback)&&(_ref=callback,callback=_ref.fn,scope=_ref.scope),this.then({failure:callback,scope:scope})},always:function(callback,scope){var _ref;return Ext.isObject(callback)&&(_ref=callback,callback=_ref.fn,scope=_ref.scope),this.then({success:callback,failure:callback,cancel:callback,scope:scope})},update:function(progress){Deft.Logger.log(""+this+" updated with progress: "+progress),"pending"===this.state?(this.progress=progress,this.notify(this.progressCallbacks,progress)):"cancelled"!==this.state&&Ext.Error.raise({msg:"Error: this "+this+" has already been completed and cannot be modified."})},resolve:function(value){Deft.Logger.log(""+this+" resolved with value: "+value),this.complete("resolved",value,this.successCallbacks)},reject:function(error){Deft.Logger.log(""+this+" rejected with error: "+error),this.complete("rejected",error,this.failureCallbacks)},cancel:function(reason){Deft.Logger.log(""+this+" cancelled with reason: "+reason),this.complete("cancelled",reason,this.cancelCallbacks)},getPromise:function(){return this.promise},getState:function(){return this.state},toString:function(){return null!=this.id?"Deferred "+this.id:"Deferred"},wrapCallback:function(deferred,callback,scope,callbackType,action){var self;return self=this,null!=callback&&Deft.Logger.log("Registering "+callbackType+" callback for "+self+"."),function(value){var result;if(Ext.isFunction(callback))try{Deft.Logger.log("Calling "+callbackType+" callback registered for "+self+"."),result=callback.call(scope,value),result instanceof Ext.ClassManager.get("Deft.promise.Promise")||result instanceof Ext.ClassManager.get("Deft.promise.Deferred")?(Deft.Logger.log(""+deferred.getPromise()+" will be completed based on the "+result+" returned by the "+callbackType+" callback."),result.then(Ext.bind(deferred.resolve,deferred),Ext.bind(deferred.reject,deferred),Ext.bind(deferred.update,deferred),Ext.bind(deferred.cancel,deferred))):(Deft.Logger.log(""+deferred.getPromise()+" resolved with the value returned by the "+callbackType+" callback: "+result+"."),deferred.resolve(result))}catch(error){Ext.Array.contains(["RangeError","ReferenceError","SyntaxError","TypeError"],error.name)?Deft.Logger.error("Error: "+callbackType+" callback for "+self+" threw: "+(null!=error.stack?error.stack:error)):Deft.Logger.log(""+deferred.getPromise()+" rejected with the Error returned by the "+callbackType+" callback: "+error),deferred.reject(error)}else Deft.Logger.log(""+deferred.getPromise()+" resolved with the value: "+value+"."),deferred[action](value)}},wrapProgressCallback:function(deferred,callback,scope){var self;return self=this,null!=callback&&Deft.Logger.log("Registering progress callback for "+self+"."),function(value){var result;if(Ext.isFunction(callback))try{Deft.Logger.log("Calling progress callback registered for "+self+"."),result=callback.call(scope,value),Deft.Logger.log(""+deferred.getPromise()+" updated with progress returned by the progress callback: "+result+"."),deferred.update(result)}catch(error){Deft.Logger.error("Error: progress callback registered for "+self+" threw: "+(null!=error.stack?error.stack:error))}else Deft.Logger.log(""+deferred.getPromise()+" updated with progress: "+value),deferred.update(value)}},register:function(callback,callbacks,state,value){Ext.isFunction(callback)&&("pending"===this.state?(callbacks.push(callback),this.state===state&&void 0!==value&&this.notify([callback],value)):this.state===state&&this.notify([callback],value))},complete:function(state,value,callbacks){"pending"===this.state?(this.state=state,this.value=value,this.notify(callbacks,value),this.releaseCallbacks()):"cancelled"!==this.state&&Ext.Error.raise({msg:"Error: this "+this+" has already been completed and cannot be modified."})},notify:function(callbacks,value){
var callback,_i,_len;for(_i=0,_len=callbacks.length;_i<_len;_i++)(callback=callbacks[_i])(value)},releaseCallbacks:function(){this.progressCallbacks=null,this.successCallbacks=null,this.failureCallbacks=null,this.cancelCallbacks=null}}),Ext.define("Deft.promise.Chain",{alternateClassName:["Deft.Chain"],requires:["Deft.promise.Promise"],statics:{sequence:function(fns,scope){return Deft.Promise.reduce(fns,function(results,fn){return Deft.Promise.when(fn.call(scope)).then(function(result){return results.push(result),results})},[])},parallel:function(fns,scope){return Deft.Promise.map(fns,function(fn){return fn.call(scope)})},pipeline:function(fns,scope,initialValue){return Deft.Promise.reduce(fns,function(value,fn){return fn.call(scope,value)},initialValue)}}})}(),!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.moment=b()}(this,function(){"use strict";function a(){return Dc.apply(null,arguments)}function b(a){Dc=a}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function e(a,b){var c,d=[];for(c=0;c<a.length;++c)d.push(b(a[c],c));return d}function f(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function g(a,b){for(var c in b)f(b,c)&&(a[c]=b[c]);return f(b,"toString")&&(a.toString=b.toString),f(b,"valueOf")&&(a.valueOf=b.valueOf),a}function h(a,b,c,d){return za(a,b,c,d,!0).utc()}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function j(a){return null==a._pf&&(a._pf=i()),a._pf}function k(a){if(null==a._isValid){var b=j(a);a._isValid=!isNaN(a._d.getTime())&&b.overflow<0&&!b.empty&&!b.invalidMonth&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour)}return a._isValid}function l(a){var b=h(NaN);return null!=a?g(j(b),a):j(b).userInvalidated=!0,b}function m(a,b){var c,d,e;if("undefined"!=typeof b._isAMomentObject&&(a._isAMomentObject=b._isAMomentObject),"undefined"!=typeof b._i&&(a._i=b._i),"undefined"!=typeof b._f&&(a._f=b._f),"undefined"!=typeof b._l&&(a._l=b._l),"undefined"!=typeof b._strict&&(a._strict=b._strict),"undefined"!=typeof b._tzm&&(a._tzm=b._tzm),"undefined"!=typeof b._isUTC&&(a._isUTC=b._isUTC),"undefined"!=typeof b._offset&&(a._offset=b._offset),"undefined"!=typeof b._pf&&(a._pf=j(b)),"undefined"!=typeof b._locale&&(a._locale=b._locale),Fc.length>0)for(c in Fc)d=Fc[c],e=b[d],"undefined"!=typeof e&&(a[d]=e);return a}function n(b){m(this,b),this._d=new Date((+b._d)),Gc===!1&&(Gc=!0,a.updateOffset(this),Gc=!1)}function o(a){return a instanceof n||null!=a&&null!=a._isAMomentObject}function p(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function q(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&p(a[d])!==p(b[d]))&&g++;return g+f}function r(){}function s(a){return a?a.toLowerCase().replace("_","-"):a}function t(a){for(var b,c,d,e,f=0;f<a.length;){for(e=s(a[f]).split("-"),b=e.length,c=s(a[f+1]),c=c?c.split("-"):null;b>0;){if(d=u(e.slice(0,b).join("-")))return d;if(c&&c.length>=b&&q(e,c,!0)>=b-1)break;b--}f++}return null}function u(a){var b=null;if(!Hc[a]&&"undefined"!=typeof module&&module&&module.exports)try{b=Ec._abbr,require("./locale/"+a),v(b)}catch(c){}return Hc[a]}function v(a,b){var c;return a&&(c="undefined"==typeof b?x(a):w(a,b),c&&(Ec=c)),Ec._abbr}function w(a,b){return null!==b?(b.abbr=a,Hc[a]||(Hc[a]=new r),Hc[a].set(b),v(a),Hc[a]):(delete Hc[a],null)}function x(a){var b;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return Ec;if(!c(a)){if(b=u(a))return b;a=[a]}return t(a)}function y(a,b){var c=a.toLowerCase();Ic[c]=Ic[c+"s"]=Ic[b]=a}function z(a){return"string"==typeof a?Ic[a]||Ic[a.toLowerCase()]:void 0}function A(a){var b,c,d={};for(c in a)f(a,c)&&(b=z(c),b&&(d[b]=a[c]));return d}function B(b,c){return function(d){return null!=d?(D(this,b,d),a.updateOffset(this,c),this):C(this,b)}}function C(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function D(a,b,c){return a._d["set"+(a._isUTC?"UTC":"")+b](c)}function E(a,b){var c;if("object"==typeof a)for(c in a)this.set(c,a[c]);else if(a=z(a),"function"==typeof this[a])return this[a](b);return this}function F(a,b,c){for(var d=""+Math.abs(a),e=a>=0;d.length<b;)d="0"+d;return(e?c?"+":"":"-")+d}function G(a,b,c,d){var e=d;"string"==typeof d&&(e=function(){return this[d]()}),a&&(Mc[a]=e),b&&(Mc[b[0]]=function(){return F(e.apply(this,arguments),b[1],b[2])}),c&&(Mc[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function H(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function I(a){var b,c,d=a.match(Jc);for(b=0,c=d.length;c>b;b++)Mc[d[b]]?d[b]=Mc[d[b]]:d[b]=H(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function J(a,b){return a.isValid()?(b=K(b,a.localeData()),Lc[b]||(Lc[b]=I(b)),Lc[b](a)):a.localeData().invalidDate()}function K(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Kc.lastIndex=0;d>=0&&Kc.test(a);)a=a.replace(Kc,c),Kc.lastIndex=0,d-=1;return a}function L(a,b,c){_c[a]="function"==typeof b?b:function(a){return a&&c?c:b}}function M(a,b){return f(_c,a)?_c[a](b._strict,b._locale):new RegExp(N(a))}function N(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function O(a,b){var c,d=b;for("string"==typeof a&&(a=[a]),"number"==typeof b&&(d=function(a,c){c[b]=p(a)}),c=0;c<a.length;c++)ad[a[c]]=d}function P(a,b){O(a,function(a,c,d,e){d._w=d._w||{},b(a,d._w,d,e)})}function Q(a,b,c){null!=b&&f(ad,a)&&ad[a](b,c._a,c,a)}function R(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function S(a){return this._months[a.month()]}function T(a){return this._monthsShort[a.month()]}function U(a,b,c){var d,e,f;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),d=0;12>d;d++){if(e=h([2e3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a))return d;if(c&&"MMM"===b&&this._shortMonthsParse[d].test(a))return d;if(!c&&this._monthsParse[d].test(a))return d}}function V(a,b){var c;return"string"==typeof b&&(b=a.localeData().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),R(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function W(b){return null!=b?(V(this,b),a.updateOffset(this,!0),this):C(this,"Month")}function X(){return R(this.year(),this.month())}function Y(a){var b,c=a._a;return c&&-2===j(a).overflow&&(b=c[cd]<0||c[cd]>11?cd:c[dd]<1||c[dd]>R(c[bd],c[cd])?dd:c[ed]<0||c[ed]>24||24===c[ed]&&(0!==c[fd]||0!==c[gd]||0!==c[hd])?ed:c[fd]<0||c[fd]>59?fd:c[gd]<0||c[gd]>59?gd:c[hd]<0||c[hd]>999?hd:-1,j(a)._overflowDayOfYear&&(bd>b||b>dd)&&(b=dd),j(a).overflow=b),a}function Z(b){a.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+b)}function $(a,b){var c=!0,d=a+"\n"+(new Error).stack;return g(function(){return c&&(Z(d),c=!1),b.apply(this,arguments)},b)}function _(a,b){kd[a]||(Z(b),kd[a]=!0)}function aa(a){var b,c,d=a._i,e=ld.exec(d);if(e){for(j(a).iso=!0,b=0,c=md.length;c>b;b++)if(md[b][1].exec(d)){a._f=md[b][0]+(e[6]||" ");break}for(b=0,c=nd.length;c>b;b++)if(nd[b][1].exec(d)){a._f+=nd[b][0];break}d.match(Yc)&&(a._f+="Z"),ta(a)}else a._isValid=!1}function ba(b){var c=od.exec(b._i);return null!==c?void(b._d=new Date((+c[1]))):(aa(b),void(b._isValid===!1&&(delete b._isValid,a.createFromInputFallback(b))))}function ca(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function da(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function ea(a){return fa(a)?366:365}function fa(a){return a%4===0&&a%100!==0||a%400===0}function ga(){return fa(this.year())}function ha(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=Aa(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ia(a){return ha(a,this._week.dow,this._week.doy).week}function ja(){return this._week.dow}function ka(){return this._week.doy}function la(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function ma(a){var b=ha(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function na(a,b,c,d,e){var f,g,h=da(a,0,1).getUTCDay();return h=0===h?7:h,c=null!=c?c:e,f=e-h+(h>d?7:0)-(e>h?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:ea(a-1)+g}}function oa(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function pa(a,b,c){return null!=a?a:null!=b?b:c}function qa(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function ra(a){var b,c,d,e,f=[];if(!a._d){for(d=qa(a),a._w&&null==a._a[dd]&&null==a._a[cd]&&sa(a),a._dayOfYear&&(e=pa(a._a[bd],d[bd]),a._dayOfYear>ea(e)&&(j(a)._overflowDayOfYear=!0),c=da(e,0,a._dayOfYear),a._a[cd]=c.getUTCMonth(),a._a[dd]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=f[b]=d[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[ed]&&0===a._a[fd]&&0===a._a[gd]&&0===a._a[hd]&&(a._nextDay=!0,a._a[ed]=0),a._d=(a._useUTC?da:ca).apply(null,f),null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[ed]=24)}}function sa(a){var b,c,d,e,f,g,h;b=a._w,null!=b.GG||null!=b.W||null!=b.E?(f=1,g=4,c=pa(b.GG,a._a[bd],ha(Aa(),1,4).year),d=pa(b.W,1),e=pa(b.E,1)):(f=a._locale._week.dow,g=a._locale._week.doy,c=pa(b.gg,a._a[bd],ha(Aa(),f,g).year),d=pa(b.w,1),null!=b.d?(e=b.d,f>e&&++d):e=null!=b.e?b.e+f:f),h=na(c,d,e,g,f),a._a[bd]=h.year,a._dayOfYear=h.dayOfYear}function ta(b){if(b._f===a.ISO_8601)return void aa(b);b._a=[],j(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,k=0;for(e=K(b._f,b._locale).match(Jc)||[],c=0;c<e.length;c++)f=e[c],d=(h.match(M(f,b))||[])[0],d&&(g=h.substr(0,h.indexOf(d)),g.length>0&&j(b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),k+=d.length),Mc[f]?(d?j(b).empty=!1:j(b).unusedTokens.push(f),Q(f,d,b)):b._strict&&!d&&j(b).unusedTokens.push(f);j(b).charsLeftOver=i-k,h.length>0&&j(b).unusedInput.push(h),j(b).bigHour===!0&&b._a[ed]<=12&&b._a[ed]>0&&(j(b).bigHour=void 0),b._a[ed]=ua(b._locale,b._a[ed],b._meridiem),ra(b),Y(b)}function ua(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d&&12>b&&(b+=12),d||12!==b||(b=0),b):b}function va(a){var b,c,d,e,f;if(0===a._f.length)return j(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e<a._f.length;e++)f=0,b=m({},a),null!=a._useUTC&&(b._useUTC=a._useUTC),b._f=a._f[e],ta(b),k(b)&&(f+=j(b).charsLeftOver,f+=10*j(b).unusedTokens.length,j(b).score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function wa(a){if(!a._d){var b=A(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],ra(a)}}function xa(a){var b,e=a._i,f=a._f;return a._locale=a._locale||x(a._l),null===e||void 0===f&&""===e?l({nullInput:!0}):("string"==typeof e&&(a._i=e=a._locale.preparse(e)),o(e)?new n(Y(e)):(c(f)?va(a):f?ta(a):d(e)?a._d=e:ya(a),b=new n(Y(a)),b._nextDay&&(b.add(1,"d"),b._nextDay=void 0),b))}function ya(b){var f=b._i;void 0===f?b._d=new Date:d(f)?b._d=new Date((+f)):"string"==typeof f?ba(b):c(f)?(b._a=e(f.slice(0),function(a){return parseInt(a,10)}),ra(b)):"object"==typeof f?wa(b):"number"==typeof f?b._d=new Date(f):a.createFromInputFallback(b)}function za(a,b,c,d,e){var f={};return"boolean"==typeof c&&(d=c,c=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=e,f._l=c,f._i=a,f._f=b,f._strict=d,xa(f)}function Aa(a,b,c,d){return za(a,b,c,d,!1)}function Ba(a,b){var d,e;if(1===b.length&&c(b[0])&&(b=b[0]),!b.length)return Aa();for(d=b[0],e=1;e<b.length;++e)b[e][a](d)&&(d=b[e]);return d}function Ca(){var a=[].slice.call(arguments,0);return Ba("isBefore",a)}function Da(){var a=[].slice.call(arguments,0);return Ba("isAfter",a)}function Ea(a){var b=A(a),c=b.year||0,d=b.quarter||0,e=b.month||0,f=b.week||0,g=b.day||0,h=b.hour||0,i=b.minute||0,j=b.second||0,k=b.millisecond||0;this._milliseconds=+k+1e3*j+6e4*i+36e5*h,this._days=+g+7*f,this._months=+e+3*d+12*c,this._data={},this._locale=x(),this._bubble()}function Fa(a){return a instanceof Ea}function Ga(a,b){G(a,0,0,function(){var a=this.utcOffset(),c="+";return 0>a&&(a=-a,c="-"),c+F(~~(a/60),2)+b+F(~~a%60,2)})}function Ha(a){var b=(a||"").match(Yc)||[],c=b[b.length-1]||[],d=(c+"").match(td)||["-",0,0],e=+(60*d[1])+p(d[2]);return"+"===d[0]?e:-e}function Ia(b,c){var e,f;return c._isUTC?(e=c.clone(),f=(o(b)||d(b)?+b:+Aa(b))-+e,e._d.setTime(+e._d+f),a.updateOffset(e,!1),e):Aa(b).local()}function Ja(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Ka(b,c){var d,e=this._offset||0;return null!=b?("string"==typeof b&&(b=Ha(b)),Math.abs(b)<16&&(b=60*b),!this._isUTC&&c&&(d=Ja(this)),this._offset=b,this._isUTC=!0,null!=d&&this.add(d,"m"),e!==b&&(!c||this._changeInProgress?$a(this,Va(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?e:Ja(this)}function La(a,b){return null!=a?("string"!=typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Ma(a){return this.utcOffset(0,a)}function Na(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(Ja(this),"m")),this}function Oa(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ha(this._i)),this}function Pa(a){return a=a?Aa(a).utcOffset():0,(this.utcOffset()-a)%60===0}function Qa(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ra(){if(this._a){var a=this._isUTC?h(this._a):Aa(this._a);return this.isValid()&&q(this._a,a.toArray())>0}return!1}function Sa(){return!this._isUTC}function Ta(){return this._isUTC}function Ua(){return this._isUTC&&0===this._offset}function Va(a,b){var c,d,e,g=a,h=null;return Fa(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=ud.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:p(h[dd])*c,h:p(h[ed])*c,m:p(h[fd])*c,s:p(h[gd])*c,ms:p(h[hd])*c}):(h=vd.exec(a))?(c="-"===h[1]?-1:1,g={y:Wa(h[2],c),M:Wa(h[3],c),d:Wa(h[4],c),h:Wa(h[5],c),m:Wa(h[6],c),s:Wa(h[7],c),w:Wa(h[8],c)}):null==g?g={}:"object"==typeof g&&("from"in g||"to"in g)&&(e=Ya(Aa(g.from),Aa(g.to)),g={},g.ms=e.milliseconds,g.M=e.months),d=new Ea(g),Fa(a)&&f(a,"_locale")&&(d._locale=a._locale),d}function Wa(a,b){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*b}function Xa(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b)&&--c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function Ya(a,b){var c;return b=Ia(b,a),a.isBefore(b)?c=Xa(a,b):(c=Xa(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function Za(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(_(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Va(c,d),$a(this,e,a),this}}function $a(b,c,d,e){var f=c._milliseconds,g=c._days,h=c._months;e=null==e||e,f&&b._d.setTime(+b._d+f*d),g&&D(b,"Date",C(b,"Date")+g*d),h&&V(b,C(b,"Month")+h*d),e&&a.updateOffset(b,g||h)}function _a(a){var b=a||Aa(),c=Ia(b,this).startOf("day"),d=this.diff(c,"days",!0),e=-6>d?"sameElse":-1>d?"lastWeek":0>d?"lastDay":1>d?"sameDay":2>d?"nextDay":7>d?"nextWeek":"sameElse";return this.format(this.localeData().calendar(e,this,Aa(b)))}function ab(){return new n(this)}function bb(a,b){var c;return b=z("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Aa(a),+this>+a):(c=o(a)?+a:+Aa(a),c<+this.clone().startOf(b))}function cb(a,b){var c;return b=z("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Aa(a),+a>+this):(c=o(a)?+a:+Aa(a),+this.clone().endOf(b)<c)}function db(a,b,c){return this.isAfter(a,c)&&this.isBefore(b,c)}function eb(a,b){var c;return b=z(b||"millisecond"),"millisecond"===b?(a=o(a)?a:Aa(a),+this===+a):(c=+Aa(a),+this.clone().startOf(b)<=c&&c<=+this.clone().endOf(b))}function fb(a){return 0>a?Math.ceil(a):Math.floor(a)}function gb(a,b,c){var d,e,f=Ia(a,this),g=6e4*(f.utcOffset()-this.utcOffset());return b=z(b),"year"===b||"month"===b||"quarter"===b?(e=hb(this,f),"quarter"===b?e/=3:"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:fb(e)}function hb(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return 0>b-f?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)}function ib(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function jb(){var a=this.clone().utc();return 0<a.year()&&a.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():J(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):J(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function kb(b){var c=J(this,b||a.defaultFormat);return this.localeData().postformat(c)}function lb(a,b){return this.isValid()?Va({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function mb(a){return this.from(Aa(),a)}function nb(a,b){return this.isValid()?Va({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function ob(a){return this.to(Aa(),a)}function pb(a){var b;return void 0===a?this._locale._abbr:(b=x(a),null!=b&&(this._locale=b),this)}function qb(){return this._locale}function rb(a){switch(a=z(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a&&this.weekday(0),"isoWeek"===a&&this.isoWeekday(1),"quarter"===a&&this.month(3*Math.floor(this.month()/3)),this}function sb(a){return a=z(a),void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")}function tb(){return+this._d-6e4*(this._offset||0)}function ub(){return Math.floor(+this/1e3)}function vb(){return this._offset?new Date((+this)):this._d}function wb(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function xb(){return k(this)}function yb(){return g({},j(this))}function zb(){return j(this).overflow}function Ab(a,b){G(0,[a,a.length],0,b)}function Bb(a,b,c){return ha(Aa([a,11,31+b-c]),b,c).week}function Cb(a){var b=ha(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")}function Db(a){var b=ha(this,1,4).year;return null==a?b:this.add(a-b,"y")}function Eb(){return Bb(this.year(),1,4)}function Fb(){var a=this.localeData()._week;return Bb(this.year(),a.dow,a.doy)}function Gb(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Hb(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function Ib(a){return this._weekdays[a.day()]}function Jb(a){return this._weekdaysShort[a.day()]}function Kb(a){return this._weekdaysMin[a.day()]}function Lb(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=Aa([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b}function Mb(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Hb(a,this.localeData()),this.add(a-b,"d")):b}function Nb(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Ob(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)}function Pb(a,b){G(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Qb(a,b){return b._meridiemParse}function Rb(a){return"p"===(a+"").toLowerCase().charAt(0)}function Sb(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Tb(a){G(0,[a,3],0,"millisecond")}function Ub(){return this._isUTC?"UTC":""}function Vb(){return this._isUTC?"Coordinated Universal Time":""}function Wb(a){return Aa(1e3*a)}function Xb(){return Aa.apply(null,arguments).parseZone()}function Yb(a,b,c){var d=this._calendar[a];return"function"==typeof d?d.call(b,c):d}function Zb(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b}function $b(){return this._invalidDate}function _b(a){return this._ordinal.replace("%d",a)}function ac(a){return a}function bc(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)}function cc(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)}function dc(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function ec(a,b,c,d){var e=x(),f=h().set(d,b);return e[c](f,a)}function fc(a,b,c,d,e){if("number"==typeof a&&(b=a,a=void 0),a=a||"",null!=b)return ec(a,b,c,e);var f,g=[];for(f=0;d>f;f++)g[f]=ec(a,f,c,e);return g}function gc(a,b){return fc(a,b,"months",12,"month")}function hc(a,b){return fc(a,b,"monthsShort",12,"month")}function ic(a,b){return fc(a,b,"weekdays",7,"day")}function jc(a,b){return fc(a,b,"weekdaysShort",7,"day")}function kc(a,b){return fc(a,b,"weekdaysMin",7,"day")}function lc(){var a=this._data;return this._milliseconds=Rd(this._milliseconds),this._days=Rd(this._days),this._months=Rd(this._months),a.milliseconds=Rd(a.milliseconds),a.seconds=Rd(a.seconds),a.minutes=Rd(a.minutes),a.hours=Rd(a.hours),a.months=Rd(a.months),a.years=Rd(a.years),this}function mc(a,b,c,d){var e=Va(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function nc(a,b){return mc(this,a,b,1)}function oc(a,b){return mc(this,a,b,-1)}function pc(){var a,b,c,d=this._milliseconds,e=this._days,f=this._months,g=this._data,h=0;return g.milliseconds=d%1e3,a=fb(d/1e3),g.seconds=a%60,b=fb(a/60),g.minutes=b%60,c=fb(b/60),g.hours=c%24,e+=fb(c/24),h=fb(qc(e)),e-=fb(rc(h)),f+=fb(e/30),e%=30,h+=fb(f/12),f%=12,g.days=e,g.months=f,g.years=h,this}function qc(a){return 400*a/146097}function rc(a){return 146097*a/400}function sc(a){var b,c,d=this._milliseconds;if(a=z(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+12*qc(b),"month"===a?c:c/12;switch(b=this._days+Math.round(rc(this._months/12)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function tc(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*p(this._months/12)}function uc(a){return function(){return this.as(a)}}function vc(a){return a=z(a),this[a+"s"]()}function wc(a){return function(){return this._data[a]}}function xc(){return fb(this.days()/7)}function yc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function zc(a,b,c){var d=Va(a).abs(),e=fe(d.as("s")),f=fe(d.as("m")),g=fe(d.as("h")),h=fe(d.as("d")),i=fe(d.as("M")),j=fe(d.as("y")),k=e<ge.s&&["s",e]||1===f&&["m"]||f<ge.m&&["mm",f]||1===g&&["h"]||g<ge.h&&["hh",g]||1===h&&["d"]||h<ge.d&&["dd",h]||1===i&&["M"]||i<ge.M&&["MM",i]||1===j&&["y"]||["yy",j];return k[2]=b,k[3]=+a>0,k[4]=c,yc.apply(null,k)}function Ac(a,b){return void 0!==ge[a]&&(void 0===b?ge[a]:(ge[a]=b,!0))}function Bc(a){var b=this.localeData(),c=zc(this,!a,b);return a&&(c=b.pastFuture(+this,c)),b.postformat(c)}function Cc(){var a=he(this.years()),b=he(this.months()),c=he(this.days()),d=he(this.hours()),e=he(this.minutes()),f=he(this.seconds()+this.milliseconds()/1e3),g=this.asSeconds();return g?(0>g?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}var Dc,Ec,Fc=a.momentProperties=[],Gc=!1,Hc={},Ic={},Jc=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,Kc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Lc={},Mc={},Nc=/\d/,Oc=/\d\d/,Pc=/\d{3}/,Qc=/\d{4}/,Rc=/[+-]?\d{6}/,Sc=/\d\d?/,Tc=/\d{1,3}/,Uc=/\d{1,4}/,Vc=/[+-]?\d{1,6}/,Wc=/\d+/,Xc=/[+-]?\d+/,Yc=/Z|[+-]\d\d:?\d\d/gi,Zc=/[+-]?\d+(\.\d{1,3})?/,$c=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,_c={},ad={},bd=0,cd=1,dd=2,ed=3,fd=4,gd=5,hd=6;G("M",["MM",2],"Mo",function(){return this.month()+1}),G("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),G("MMMM",0,0,function(a){return this.localeData().months(this,a)}),y("month","M"),L("M",Sc),L("MM",Sc,Oc),L("MMM",$c),L("MMMM",$c),O(["M","MM"],function(a,b){b[cd]=p(a)-1}),O(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[cd]=e:j(c).invalidMonth=a});var id="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),jd="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),kd={};a.suppressDeprecationWarnings=!1;var ld=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,md=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],nd=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],od=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=$("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),G(0,["YY",2],0,function(){return this.year()%100}),G(0,["YYYY",4],0,"year"),G(0,["YYYYY",5],0,"year"),G(0,["YYYYYY",6,!0],0,"year"),y("year","y"),L("Y",Xc),L("YY",Sc,Oc),L("YYYY",Uc,Qc),L("YYYYY",Vc,Rc),L("YYYYYY",Vc,Rc),O(["YYYY","YYYYY","YYYYYY"],bd),O("YY",function(b,c){c[bd]=a.parseTwoDigitYear(b)}),a.parseTwoDigitYear=function(a){return p(a)+(p(a)>68?1900:2e3)};var pd=B("FullYear",!1);G("w",["ww",2],"wo","week"),G("W",["WW",2],"Wo","isoWeek"),y("week","w"),y("isoWeek","W"),L("w",Sc),L("ww",Sc,Oc),L("W",Sc),L("WW",Sc,Oc),P(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=p(a)});var qd={dow:0,doy:6};G("DDD",["DDDD",3],"DDDo","dayOfYear"),y("dayOfYear","DDD"),L("DDD",Tc),L("DDDD",Pc),O(["DDD","DDDD"],function(a,b,c){c._dayOfYear=p(a)}),a.ISO_8601=function(){};var rd=$("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=Aa.apply(null,arguments);return this>a?this:a}),sd=$("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=Aa.apply(null,arguments);return a>this?this:a});Ga("Z",":"),Ga("ZZ",""),L("Z",Yc),L("ZZ",Yc),O(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ha(a)});var td=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var ud=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,vd=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Va.fn=Ea.prototype;var wd=Za(1,"add"),xd=Za(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var yd=$("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});G(0,["gg",2],0,function(){return this.weekYear()%100}),G(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ab("gggg","weekYear"),Ab("ggggg","weekYear"),Ab("GGGG","isoWeekYear"),Ab("GGGGG","isoWeekYear"),y("weekYear","gg"),y("isoWeekYear","GG"),L("G",Xc),L("g",Xc),L("GG",Sc,Oc),L("gg",Sc,Oc),L("GGGG",Uc,Qc),L("gggg",Uc,Qc),L("GGGGG",Vc,Rc),L("ggggg",Vc,Rc),P(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=p(a)}),P(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),G("Q",0,0,"quarter"),y("quarter","Q"),L("Q",Nc),O("Q",function(a,b){b[cd]=3*(p(a)-1)}),G("D",["DD",2],"Do","date"),y("date","D"),L("D",Sc),L("DD",Sc,Oc),L("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),O(["D","DD"],dd),O("Do",function(a,b){b[dd]=p(a.match(Sc)[0],10)});var zd=B("Date",!0);G("d",0,"do","day"),G("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),G("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),G("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),G("e",0,0,"weekday"),G("E",0,0,"isoWeekday"),y("day","d"),y("weekday","e"),y("isoWeekday","E"),L("d",Sc),L("e",Sc),L("E",Sc),L("dd",$c),L("ddd",$c),L("dddd",$c),P(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=d:j(c).invalidWeekday=a}),P(["d","e","E"],function(a,b,c,d){b[d]=p(a)});var Ad="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Bd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Cd="Su_Mo_Tu_We_Th_Fr_Sa".split("_");G("H",["HH",2],0,"hour"),G("h",["hh",2],0,function(){return this.hours()%12||12}),Pb("a",!0),Pb("A",!1),y("hour","h"),L("a",Qb),L("A",Qb),L("H",Sc),L("h",Sc),L("HH",Sc,Oc),L("hh",Sc,Oc),O(["H","HH"],ed),O(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),O(["h","hh"],function(a,b,c){b[ed]=p(a),j(c).bigHour=!0});var Dd=/[ap]\.?m?\.?/i,Ed=B("Hours",!0);G("m",["mm",2],0,"minute"),y("minute","m"),L("m",Sc),L("mm",Sc,Oc),O(["m","mm"],fd);var Fd=B("Minutes",!1);G("s",["ss",2],0,"second"),y("second","s"),L("s",Sc),L("ss",Sc,Oc),O(["s","ss"],gd);var Gd=B("Seconds",!1);G("S",0,0,function(){return~~(this.millisecond()/100)}),G(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Tb("SSS"),Tb("SSSS"),y("millisecond","ms"),L("S",Tc,Nc),L("SS",Tc,Oc),L("SSS",Tc,Pc),L("SSSS",Wc),O(["S","SS","SSS","SSSS"],function(a,b){b[hd]=p(1e3*("0."+a))});var Hd=B("Milliseconds",!1);G("z",0,0,"zoneAbbr"),G("zz",0,0,"zoneName");var Id=n.prototype;Id.add=wd,Id.calendar=_a,Id.clone=ab,Id.diff=gb,Id.endOf=sb,Id.format=kb,Id.from=lb,Id.fromNow=mb,Id.to=nb,Id.toNow=ob,Id.get=E,Id.invalidAt=zb,Id.isAfter=bb,Id.isBefore=cb,Id.isBetween=db,Id.isSame=eb,Id.isValid=xb,Id.lang=yd,Id.locale=pb,Id.localeData=qb,Id.max=sd,Id.min=rd,Id.parsingFlags=yb,Id.set=E,Id.startOf=rb,Id.subtract=xd,Id.toArray=wb,Id.toDate=vb,Id.toISOString=jb,Id.toJSON=jb,Id.toString=ib,Id.unix=ub,Id.valueOf=tb,Id.year=pd,Id.isLeapYear=ga,Id.weekYear=Cb,Id.isoWeekYear=Db,Id.quarter=Id.quarters=Gb,Id.month=W,Id.daysInMonth=X,Id.week=Id.weeks=la,Id.isoWeek=Id.isoWeeks=ma,Id.weeksInYear=Fb,Id.isoWeeksInYear=Eb,Id.date=zd,Id.day=Id.days=Mb,Id.weekday=Nb,Id.isoWeekday=Ob,Id.dayOfYear=oa,Id.hour=Id.hours=Ed,Id.minute=Id.minutes=Fd,Id.second=Id.seconds=Gd,Id.millisecond=Id.milliseconds=Hd,Id.utcOffset=Ka,Id.utc=Ma,Id.local=Na,Id.parseZone=Oa,Id.hasAlignedHourOffset=Pa,Id.isDST=Qa,Id.isDSTShifted=Ra,Id.isLocal=Sa,Id.isUtcOffset=Ta,Id.isUtc=Ua,Id.isUTC=Ua,Id.zoneAbbr=Ub,Id.zoneName=Vb,
Id.dates=$("dates accessor is deprecated. Use date instead.",zd),Id.months=$("months accessor is deprecated. Use month instead",W),Id.years=$("years accessor is deprecated. Use year instead",pd),Id.zone=$("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",La);var Jd=Id,Kd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Ld={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},Md="Invalid date",Nd="%d",Od=/\d{1,2}/,Pd={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Qd=r.prototype;Qd._calendar=Kd,Qd.calendar=Yb,Qd._longDateFormat=Ld,Qd.longDateFormat=Zb,Qd._invalidDate=Md,Qd.invalidDate=$b,Qd._ordinal=Nd,Qd.ordinal=_b,Qd._ordinalParse=Od,Qd.preparse=ac,Qd.postformat=ac,Qd._relativeTime=Pd,Qd.relativeTime=bc,Qd.pastFuture=cc,Qd.set=dc,Qd.months=S,Qd._months=id,Qd.monthsShort=T,Qd._monthsShort=jd,Qd.monthsParse=U,Qd.week=ia,Qd._week=qd,Qd.firstDayOfYear=ka,Qd.firstDayOfWeek=ja,Qd.weekdays=Ib,Qd._weekdays=Ad,Qd.weekdaysMin=Kb,Qd._weekdaysMin=Cd,Qd.weekdaysShort=Jb,Qd._weekdaysShort=Bd,Qd.weekdaysParse=Lb,Qd.isPM=Rb,Qd._meridiemParse=Dd,Qd.meridiem=Sb,v("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===p(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=$("moment.lang is deprecated. Use moment.locale instead.",v),a.langData=$("moment.langData is deprecated. Use moment.localeData instead.",x);var Rd=Math.abs,Sd=uc("ms"),Td=uc("s"),Ud=uc("m"),Vd=uc("h"),Wd=uc("d"),Xd=uc("w"),Yd=uc("M"),Zd=uc("y"),$d=wc("milliseconds"),_d=wc("seconds"),ae=wc("minutes"),be=wc("hours"),ce=wc("days"),de=wc("months"),ee=wc("years"),fe=Math.round,ge={s:45,m:45,h:22,d:26,M:11},he=Math.abs,ie=Ea.prototype;ie.abs=lc,ie.add=nc,ie.subtract=oc,ie.as=sc,ie.asMilliseconds=Sd,ie.asSeconds=Td,ie.asMinutes=Ud,ie.asHours=Vd,ie.asDays=Wd,ie.asWeeks=Xd,ie.asMonths=Yd,ie.asYears=Zd,ie.valueOf=tc,ie._bubble=pc,ie.get=vc,ie.milliseconds=$d,ie.seconds=_d,ie.minutes=ae,ie.hours=be,ie.days=ce,ie.weeks=xc,ie.months=de,ie.years=ee,ie.humanize=Bc,ie.toISOString=Cc,ie.toString=Cc,ie.toJSON=Cc,ie.locale=pb,ie.localeData=qb,ie.toIsoString=$("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Cc),ie.lang=yd,G("X",0,0,"unix"),G("x",0,0,"valueOf"),L("x",Xc),L("X",Zc),O("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),O("x",function(a,b,c){c._d=new Date(p(a))}),a.version="2.10.3",b(Aa),a.fn=Jd,a.min=Ca,a.max=Da,a.utc=h,a.unix=Wb,a.months=gc,a.isDate=d,a.locale=v,a.invalid=l,a.duration=Va,a.isMoment=o,a.weekdays=ic,a.parseZone=Xb,a.localeData=x,a.isDuration=Fa,a.monthsShort=hc,a.weekdaysMin=kc,a.defineLocale=w,a.weekdaysShort=jc,a.normalizeUnits=z,a.relativeTimeThreshold=Ac;var je=a;return je}),function(root,factory){"use strict";"function"==typeof define&&define.amd?define(["moment"],factory):"object"==typeof exports?module.exports=factory(require("moment")):factory(root.moment)}(this,function(moment){"use strict";function charCodeToInt(charCode){return charCode>96?charCode-87:charCode>64?charCode-29:charCode-48}function unpackBase60(string){var num,i=0,parts=string.split("."),whole=parts[0],fractional=parts[1]||"",multiplier=1,out=0,sign=1;for(45===string.charCodeAt(0)&&(i=1,sign=-1),i;i<whole.length;i++)num=charCodeToInt(whole.charCodeAt(i)),out=60*out+num;for(i=0;i<fractional.length;i++)multiplier/=60,num=charCodeToInt(fractional.charCodeAt(i)),out+=num*multiplier;return out*sign}function arrayToInt(array){for(var i=0;i<array.length;i++)array[i]=unpackBase60(array[i])}function intToUntil(array,length){for(var i=0;i<length;i++)array[i]=Math.round((array[i-1]||0)+6e4*array[i]);array[length-1]=1/0}function mapIndices(source,indices){var i,out=[];for(i=0;i<indices.length;i++)out[i]=source[indices[i]];return out}function unpack(string){var data=string.split("|"),offsets=data[2].split(" "),indices=data[3].split(""),untils=data[4].split(" ");return arrayToInt(offsets),arrayToInt(indices),arrayToInt(untils),intToUntil(untils,indices.length),{name:data[0],abbrs:mapIndices(data[1].split(" "),indices),offsets:mapIndices(offsets,indices),untils:untils}}function Zone(packedString){packedString&&this._set(unpack(packedString))}function normalizeName(name){return(name||"").toLowerCase().replace(/\//g,"_")}function addZone(packed){var i,zone,zoneName;for("string"==typeof packed&&(packed=[packed]),i=0;i<packed.length;i++)zone=new Zone(packed[i]),zoneName=normalizeName(zone.name),zones[zoneName]=zone,upgradeLinksToZones(zoneName)}function getZone(name){return zones[normalizeName(name)]||null}function getNames(){var i,out=[];for(i in zones)zones.hasOwnProperty(i)&&zones[i]&&out.push(zones[i].name);return out.sort()}function addLink(aliases){var i,alias;for("string"==typeof aliases&&(aliases=[aliases]),i=0;i<aliases.length;i++)alias=aliases[i].split("|"),pushLink(alias[0],alias[1]),pushLink(alias[1],alias[0])}function upgradeLinksToZones(zoneName){if(links[zoneName]){var i,zone=zones[zoneName],linkNames=links[zoneName];for(i=0;i<linkNames.length;i++)copyZoneWithName(zone,linkNames[i]);links[zoneName]=null}}function copyZoneWithName(zone,name){var linkZone=zones[normalizeName(name)]=new Zone;linkZone._set(zone),linkZone.name=name}function pushLink(zoneName,linkName){zoneName=normalizeName(zoneName),zones[zoneName]?copyZoneWithName(zones[zoneName],linkName):(links[zoneName]=links[zoneName]||[],links[zoneName].push(linkName))}function loadData(data){addZone(data.zones),addLink(data.links),tz.dataVersion=data.version}function zoneExists(name){return zoneExists.didShowError||(zoneExists.didShowError=!0,logError("moment.tz.zoneExists('"+name+"') has been deprecated in favor of !moment.tz.zone('"+name+"')")),!!getZone(name)}function needsOffset(m){return!(!m._a||void 0!==m._tzm)}function logError(message){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}function tz(input){var args=Array.prototype.slice.call(arguments,0,-1),name=arguments[arguments.length-1],zone=getZone(name),out=moment.utc.apply(null,args);return zone&&!moment.isMoment(input)&&needsOffset(out)&&out.add(zone.parse(out),"minutes"),out.tz(name),out}function abbrWrap(old){return function(){return this._z?this._z.abbr(this):old.call(this)}}function resetZoneWrap(old){return function(){return this._z=null,old.apply(this,arguments)}}if(void 0!==moment.tz)return moment;var VERSION="0.3.0",zones={},links={},momentVersion=moment.version.split("."),major=+momentVersion[0],minor=+momentVersion[1];(major<2||2===major&&minor<6)&&logError("Moment Timezone requires Moment.js >= 2.6.0. You are using Moment.js "+moment.version+". See momentjs.com"),Zone.prototype={_set:function(unpacked){this.name=unpacked.name,this.abbrs=unpacked.abbrs,this.untils=unpacked.untils,this.offsets=unpacked.offsets},_index:function(timestamp){var i,target=+timestamp,untils=this.untils;for(i=0;i<untils.length;i++)if(target<untils[i])return i},parse:function(timestamp){var offset,offsetNext,offsetPrev,i,target=+timestamp,offsets=this.offsets,untils=this.untils,max=untils.length-1;for(i=0;i<max;i++)if(offset=offsets[i],offsetNext=offsets[i+1],offsetPrev=offsets[i?i-1:i],offset<offsetNext&&tz.moveAmbiguousForward?offset=offsetNext:offset>offsetPrev&&tz.moveInvalidForward&&(offset=offsetPrev),target<untils[i]-6e4*offset)return offsets[i];return offsets[max]},abbr:function(mom){return this.abbrs[this._index(mom)]},offset:function(mom){return this.offsets[this._index(mom)]}},tz.version=VERSION,tz.dataVersion="",tz._zones=zones,tz._links=links,tz.add=addZone,tz.link=addLink,tz.load=loadData,tz.zone=getZone,tz.zoneExists=zoneExists,tz.names=getNames,tz.Zone=Zone,tz.unpack=unpack,tz.unpackBase60=unpackBase60,tz.needsOffset=needsOffset,tz.moveInvalidForward=!0,tz.moveAmbiguousForward=!1;var fn=moment.fn;moment.tz=tz,moment.defaultZone=null,moment.updateOffset=function(mom,keepTime){var offset;void 0===mom._z&&(mom._z=moment.defaultZone),mom._z&&(offset=mom._z.offset(mom),Math.abs(offset)<16&&(offset/=60),void 0!==mom.utcOffset?mom.utcOffset(-offset,keepTime):mom.zone(offset,keepTime))},fn.tz=function(name){return name?(this._z=getZone(name),this._z?moment.updateOffset(this):logError("Moment Timezone has no data for "+name+". See http://momentjs.com/timezone/docs/#/data-loading/."),this):this._z?this._z.name:void 0},fn.zoneName=abbrWrap(fn.zoneName),fn.zoneAbbr=abbrWrap(fn.zoneAbbr),fn.utc=resetZoneWrap(fn.utc),moment.tz.setDefault=function(name){return(major<2||2===major&&minor<9)&&logError("Moment Timezone setDefault() requires Moment.js >= 2.9.0. You are using Moment.js "+moment.version+"."),moment.defaultZone=name?getZone(name):null,moment};var momentProperties=moment.momentProperties;return"[object Array]"===Object.prototype.toString.call(momentProperties)?(momentProperties.push("_z"),momentProperties.push("_a")):momentProperties&&(momentProperties._z=null),moment}),moment.tz.load({version:"2014j",zones:["Africa/Abidjan|LMT GMT|g.8 0|01|-2ldXH.Q","Africa/Accra|LMT GMT GHST|.Q 0 -k|012121212121212121212121212121212121212121212121|-26BbX.8 6tzX.8 MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE 1BAk MnE 1C0k MnE 1BAk MnE 1BAk MnE","Africa/Addis_Ababa|LMT EAT BEAT BEAUT|-2r.g -30 -2u -2J|01231|-1F3Cr.g 3Dzr.g okMu MFXJ","Africa/Algiers|PMT WET WEST CET CEST|-9.l 0 -10 -10 -20|0121212121212121343431312123431213|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 DA0 Imo0 rd0 De0 9Xz0 1fb0 1ap0 16K0 2yo0 mEp0 hwL0 jxA0 11A0 dDd0 17b0 11B0 1cN0 2Dy0 1cN0 1fB0 1cL0","Africa/Bangui|LMT WAT|-d.A -10|01|-22y0d.A","Africa/Bissau|LMT WAT GMT|12.k 10 0|012|-2ldWV.E 2xonV.E","Africa/Blantyre|LMT CAT|-2a.k -20|01|-2GJea.k","Africa/Cairo|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-1bIO0 vb0 1ip0 11z0 1iN0 1nz0 12p0 1pz0 10N0 1pz0 16p0 1jz0 s3d0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1WL0 rd0 1Rz0 wp0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1qL0 Xd0 1oL0 11d0 1oL0 11d0 1pb0 11d0 1oL0 11d0 1oL0 11d0 1ny0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 WL0 1qN0 Rb0 1wp0 On0 1zd0 Lz0 1EN0 Fb0 c10 8n0 8Nd0 gL0 e10 mn0 1o10 jz0 gN0 pb0 1qN0 dX0 e10 xz0 1o10 bb0 e10 An0 1o10 5z0 e10 FX0 1o10 2L0 e10 IL0 1C10 Lz0 1wp0 TX0 1qN0 WL0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0","Africa/Casablanca|LMT WET WEST CET|u.k 0 -10 -10|012121212121212121312121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2gMnt.E 130Lt.E rb0 Dd0 dVb0 b6p0 TX0 EoB0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4mn0 SyN0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uo0 e00 DA0 11A0 rA0 e00 Jc0 WM0 m00 gM0 M00 WM0 jc0 e00 RA0 11A0 dA0 e00 Uo0 11A0 800 gM0 Xc0 11A0 5c0 e00 17A0 WM0 2o0 e00 1ao0 19A0 1g00 16M0 1iM0 1400 1lA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qo0 1200 1kM0 14M0 1i00","Africa/Ceuta|WET WEST CET CEST|0 -10 -10 -20|010101010101010101010232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-25KN0 11z0 drd0 18o0 3I00 17c0 1fA0 1a00 1io0 1a00 1y7p0 LL0 gnd0 rz0 43d0 AL0 1Nd0 XX0 1Cp0 pz0 dEp0 4VB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Africa/El_Aaiun|LMT WAT WET WEST|Q.M 10 0 -10|0123232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1rDz7.c 1GVA7.c 6L0 AL0 1Nd0 XX0 1Cp0 pz0 1cBB0 AL0 1Nd0 wn0 1FB0 Db0 1zd0 Lz0 1Nf0 wM0 co0 go0 1o00 s00 dA0 vc0 11A0 A00 e00 y00 11A0 uo0 e00 DA0 11A0 rA0 e00 Jc0 WM0 m00 gM0 M00 WM0 jc0 e00 RA0 11A0 dA0 e00 Uo0 11A0 800 gM0 Xc0 11A0 5c0 e00 17A0 WM0 2o0 e00 1ao0 19A0 1g00 16M0 1iM0 1400 1lA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qo0 1200 1kM0 14M0 1i00","Africa/Johannesburg|SAST SAST SAST|-1u -20 -30|012121|-2GJdu 1Ajdu 1cL0 1cN0 1cL0","Africa/Juba|LMT CAT CAST EAT|-2a.8 -20 -30 -30|01212121212121212121212121212121213|-1yW2a.8 1zK0a.8 16L0 1iN0 17b0 1jd0 17b0 1ip0 17z0 1i10 17X0 1hB0 18n0 1hd0 19b0 1gp0 19z0 1iN0 17b0 1ip0 17z0 1i10 18n0 1hd0 18L0 1gN0 19b0 1gp0 19z0 1iN0 17z0 1i10 17X0 yGd0","Africa/Monrovia|MMT LRT GMT|H.8 I.u 0|012|-23Lzg.Q 29s01.m","Africa/Ndjamena|LMT WAT WAST|-10.c -10 -20|0121|-2le10.c 2J3c0.c Wn0","Africa/Tripoli|LMT CET CEST EET|-Q.I -10 -20 -20|012121213121212121212121213123123|-21JcQ.I 1hnBQ.I vx0 4iP0 xx0 4eN0 Bb0 7ip0 U0n0 A10 1db0 1cN0 1db0 1dd0 1db0 1eN0 1bb0 1e10 1cL0 1c10 1db0 1dd0 1db0 1cN0 1db0 1q10 fAn0 1ep0 1db0 AKq0 TA0 1o00","Africa/Tunis|PMT CET CEST|-9.l -10 -20|0121212121212121212121212121212121|-2nco9.l 18pa9.l 1qM0 DA0 3Tc0 11B0 1ze0 WM0 7z0 3d0 14L0 1cN0 1f90 1ar0 16J0 1gXB0 WM0 1rA0 11c0 nwo0 Ko0 1cM0 1cM0 1rA0 10M0 zuM0 10N0 1aN0 1qM0 WM0 1qM0 11A0 1o00","Africa/Windhoek|SWAT SAST SAST CAT WAT WAST|-1u -20 -30 -20 -10 -20|012134545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2GJdu 1Ajdu 1cL0 1SqL0 9NA0 11D0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 11B0 1nX0 11B0","America/Adak|NST NWT NPT BST BDT AHST HAST HADT|b0 a0 a0 b0 a0 a0 a0 90|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anchorage|CAT CAWT CAPT AHST AHDT YST AKST AKDT|a0 90 90 a0 90 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T00 8wX0 iA0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cm0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Anguilla|LMT AST|46.4 40|01|-2kNvR.U","America/Antigua|LMT EST AST|47.c 50 40|012|-2kNvQ.M 1yxAQ.M","America/Araguaina|LMT BRT BRST|3c.M 30 20|0121212121212121212121212121212121212121212121212121|-2glwL.c HdKL.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 ny10 Lz0","America/Argentina/Buenos_Aires|CMT ART ARST ART ARST|4g.M 40 30 30 20|0121212121212121212121212121212121212121213434343434343234343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 j3c0 uL0 1qN0 WL0","America/Argentina/Catamarca|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343454343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Cordoba|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343454343234343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 j3c0 uL0 1qN0 WL0","America/Argentina/Jujuy|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|01212121212121212121212121212121212121212134343456543432343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1ze0 TX0 1ld0 WK0 1wp0 TX0 g0p0 10M0 j3c0 uL0","America/Argentina/La_Rioja|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434534343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Mendoza|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|0121212121212121212121212121212121212121213434345656543235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1u20 SL0 1vd0 Tb0 1wp0 TW0 g0p0 10M0 agM0 Op0 7TX0 uL0","America/Argentina/Rio_Gallegos|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343434343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 ako0 7B0 8zb0 uL0","America/Argentina/Salta|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434543432343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 j3c0 uL0","America/Argentina/San_Juan|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|01212121212121212121212121212121212121212134343434534343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Qn0 qO0 16n0 Rb0 1wp0 TX0 g0p0 10M0 ak00 m10 8lb0 uL0","America/Argentina/San_Luis|CMT ART ARST ART ARST WART WARST|4g.M 40 30 30 20 40 30|01212121212121212121212121212121212121212134343456536353465653|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 XX0 1q20 SL0 AN0 kin0 10M0 ak00 m10 8lb0 8L0 jd0 1qN0 WL0 1qN0","America/Argentina/Tucuman|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|012121212121212121212121212121212121212121343434345434323534343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wq0 Ra0 1wp0 TX0 g0p0 10M0 ako0 4N0 8BX0 uL0 1qN0 WL0","America/Argentina/Ushuaia|CMT ART ARST ART ARST WART|4g.M 40 30 30 20 40|0121212121212121212121212121212121212121213434343434343235343|-20UHH.c pKnH.c Mn0 1iN0 Tb0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 1C10 LX0 1C10 LX0 1C10 LX0 1C10 Mn0 MN0 2jz0 MN0 4lX0 u10 5Lb0 1pB0 Fnz0 u10 uL0 1vd0 SL0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 zvd0 Bz0 1tB0 TX0 1wp0 Rb0 1wp0 Rb0 1wp0 TX0 g0p0 10M0 ajA0 8p0 8zb0 uL0","America/Aruba|LMT ANT AST|4z.L 4u 40|012|-2kV7o.d 28KLS.d","America/Asuncion|AMT PYT PYT PYST|3O.E 40 30 30|012131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|-1x589.k 1DKM9.k 3CL0 3Dd0 10L0 1pB0 10n0 1pB0 10n0 1pB0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1dd0 1cL0 1dd0 1cL0 1dd0 1db0 1dd0 1cL0 1lB0 14n0 1dd0 1cL0 1fd0 WL0 1rd0 1aL0 1dB0 Xz0 1qp0 Xb0 1qN0 10L0 1rB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 WN0 1qL0 11B0 1nX0 1ip0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 TX0 1tB0 19X0 1a10 1fz0 1a10 1fz0 1cN0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1ip0 17b0 1ip0 17b0 1ip0","America/Atikokan|CST CDT CWT CPT EST|60 50 50 50 50|0101234|-25TQ0 1in0 Rnb0 3je0 8x30 iw0","America/Bahia|LMT BRT BRST|2y.4 30 20|01212121212121212121212121212121212121212121212121212121212121|-2glxp.U HdLp.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 l5B0 Rb0","America/Bahia_Banderas|LMT MST CST PST MDT CDT|71 70 60 80 60 50|0121212131414141414141414141414141414152525252525252525252525252525252525252525252525252525252|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nW0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Barbados|LMT BMT AST ADT|3W.t 3W.t 40 30|01232323232|-1Q0I1.v jsM0 1ODC1.v IL0 1ip0 17b0 1ip0 17b0 1ld0 13b0","America/Belem|LMT BRT BRST|3d.U 30 20|012121212121212121212121212121|-2glwK.4 HdKK.4 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0","America/Belize|LMT CST CHDT CDT|5Q.M 60 5u 50|01212121212121212121212121212121212121212121212121213131|-2kBu7.c fPA7.c Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1wou Rbu 1zcu Onu 1zcu Onu 1zcu Rbu 1wou Rbu 1f0Mu qn0 lxB0 mn0","America/Blanc-Sablon|AST ADT AWT APT|40 30 30 30|010230|-25TS0 1in0 UGp0 8x50 iu0","America/Boa_Vista|LMT AMT AMST|42.E 40 30|0121212121212121212121212121212121|-2glvV.k HdKV.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 smp0 WL0 1tB0 2L0","America/Bogota|BMT COT COST|4U.g 50 40|0121|-2eb73.I 38yo3.I 2en0","America/Boise|PST PDT MST MWT MPT MDT|80 70 70 60 60 60|0101023425252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-261q0 1nX0 11B0 1nX0 8C10 JCL0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 Dd0 1Kn0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Cambridge_Bay|zzz MST MWT MPT MDDT MDT CST CDT EST|0 70 60 60 50 60 60 50 50|0123141515151515151515151515151515151515151515678651515151515151515151515151515151515151515151515151515151515151515151515151|-21Jc0 RO90 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11A0 1nX0 2K0 WQ0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Campo_Grande|LMT AMT AMST|3C.s 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwl.w HdLl.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0","America/Cancun|LMT CST EST EDT CDT|5L.4 60 50 40 50|0123232341414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQG0 2q2o0 yLB0 1lb0 14p0 1lb0 14p0 Lz0 xB0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Caracas|CMT VET VET|4r.E 4u 40|0121|-2kV7w.k 28KM2.k 1IwOu","America/Cayenne|LMT GFT GFT|3t.k 40 30|012|-2mrwu.E 2gWou.E","America/Cayman|KMT EST|57.b 50|01|-2l1uQ.N","America/Chicago|CST CDT EST CWT CPT|60 50 50 50 50|01010101010101010101010101010101010102010101010103401010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 1wp0 TX0 WN0 1qL0 1cN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 11B0 1Hz0 14p0 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Chihuahua|LMT MST CST CDT MDT|74.k 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Costa_Rica|SJMT CST CDT|5A.d 60 50|0121212121|-1Xd6n.L 2lu0n.L Db0 1Kp0 Db0 pRB0 15b0 1kp0 mL0","America/Creston|MST PST|70 80|010|-29DR0 43B0","America/Cuiaba|LMT AMT AMST|3I.k 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwf.E HdLf.E 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 4a10 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0","America/Danmarkshavn|LMT WGT WGST GMT|1e.E 30 20 0|01212121212121212121212121212121213|-2a5WJ.k 2z5fJ.k 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 DC0","America/Dawson|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 jrA0 fNd0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Dawson_Creek|PST PDT PWT PPT MST|80 70 70 70 70|0102301010101010101010101010101010101010101010101010101014|-25TO0 1in0 UGp0 8x10 iy0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 ML0","America/Denver|MST MDT MWT MPT|70 60 60 60|01010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 11B0 1qL0 WN0 mn0 Ord0 8x20 ix0 LCN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Detroit|LMT CST EST EWT EPT EDT|5w.b 60 50 40 40 40|01234252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2Cgir.N peqr.N 156L0 8x40 iv0 6fd0 11z0 Jy10 SL0 dnB0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Edmonton|LMT MST MDT MWT MPT|7x.Q 70 60 60 60|01212121212121341212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2yd4q.8 shdq.8 1in0 17d0 hz0 2dB0 1fz0 1a10 11z0 1qN0 WL0 1qN0 11z0 IGN0 8x20 ix0 3NB0 11z0 LFB0 1cL0 3Cp0 1cL0 66N0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Eirunepe|LMT ACT ACST AMT|4D.s 50 40 40|0121212121212121212121212121212131|-2glvk.w HdLk.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0 yTd0 d5X0","America/El_Salvador|LMT CST CDT|5U.M 60 50|012121|-1XiG3.c 2Fvc3.c WL0 1qN0 WL0","America/Ensenada|LMT MST PST PDT PWT PPT|7M.4 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOP0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fort_Wayne|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010101023010101010101010101040454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 QI10 Db0 RB0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 5Tz0 1o10 qLb0 1cL0 1cN0 1cL0 1qhd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Fortaleza|LMT BRT BRST|2y 30 20|0121212121212121212121212121212121212121|-2glxq HdLq 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 5z0 2mN0 On0","America/Glace_Bay|LMT AST ADT AWT APT|3X.M 40 30 30 30|012134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsI0.c CwO0.c 1in0 UGp0 8x50 iu0 iq10 11z0 Jg10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Godthab|LMT WGT WGST|3q.U 30 20|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5Ux.4 2z5dx.4 19U0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/Goose_Bay|NST NDT NST NDT NWT NPT AST ADT ADDT|3u.Q 2u.Q 3u 2u 2u 2u 40 30 20|010232323232323245232323232323232323232323232323232323232326767676767676767676767676767676767676767676768676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-25TSt.8 1in0 DXb0 2HbX.8 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 S10 g0u 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Grand_Turk|KMT EST EDT AST|57.b 50 40 40|0121212121212121212121212121212121212121212121212121212121212121212121212123|-2l1uQ.N 2HHBQ.N 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Guatemala|LMT CST CDT|62.4 60 50|0121212121|-24KhV.U 2efXV.U An0 mtd0 Nz0 ifB0 17b0 zDB0 11z0","America/Guayaquil|QMT ECT|5e 50|01|-1yVSK","America/Guyana|LMT GBGT GYT GYT GYT|3Q.E 3J 3J 30 40|01234|-2dvU7.k 24JzQ.k mlc0 Bxbf","America/Halifax|LMT AST ADT AWT APT|4e.o 40 30 30 30|0121212121212121212121212121212121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsHJ.A xzzJ.A 1db0 3I30 1in0 3HX0 IL0 1E10 ML0 1yN0 Pb0 1Bd0 Mn0 1Bd0 Rz0 1w10 Xb0 1w10 LX0 1w10 Xb0 1w10 Lz0 1C10 Jz0 1E10 OL0 1yN0 Un0 1qp0 Xb0 1qp0 11X0 1w10 Lz0 1HB0 LX0 1C10 FX0 1w10 Xb0 1qp0 Xb0 1BB0 LX0 1td0 Xb0 1qp0 Xb0 Rf0 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 3Qp0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 6i10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Havana|HMT CST CDT|5t.A 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Meuu.o 72zu.o ML0 sld0 An0 1Nd0 Db0 1Nd0 An0 6Ep0 An0 1Nd0 An0 JDd0 Mn0 1Ap0 On0 1fd0 11X0 1qN0 WL0 1wp0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 14n0 1ld0 14L0 1kN0 15b0 1kp0 1cL0 1cN0 1fz0 1a10 1fz0 1fB0 11z0 14p0 1nX0 11B0 1nX0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 1a10 1in0 1a10 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 17c0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 11A0 6i00 Rc0 1wo0 U00 1tA0 Rc0 1wo0 U00 1wo0 U00 1zc0 U00 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0","America/Hermosillo|LMT MST CST PST MDT|7n.Q 70 60 80 60|0121212131414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0","America/Indiana/Knox|CST CDT CWT CPT EST|60 50 50 50 50|0101023010101010101010101010101010101040101010101010101010101010101010101010101010101010141010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 3NB0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 3Cn0 8wp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 z8o0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Marengo|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010104545454545414545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 dyN0 11z0 6fd0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1e6p0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Petersburg|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010104010101010101010101010141014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 njX0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 3Fb0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 19co0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Tell_City|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vevay|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|010102304545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 kPB0 Awn0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1lnd0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Vincennes|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010454541014545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 g0p0 11z0 1o10 11z0 1qL0 WN0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 caL0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Indiana/Winamac|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|01010230101010101010101010101010101010454541054545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 jrz0 1cL0 1cN0 1cL0 1qhd0 1o00 Rd0 1za0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Inuvik|zzz PST PDDT MST MDT|0 80 60 70 60|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-FnA0 tWU0 1fA0 wPe0 2pz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Iqaluit|zzz EWT EPT EST EDDT EDT CST CDT|0 40 40 50 30 40 60 50|01234353535353535353535353535353535353535353567353535353535353535353535353535353535353535353535353535353535353535353535353|-16K00 7nX0 iv0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Jamaica|KMT EST EDT|57.b 50 40|0121212121212121212121|-2l1uQ.N 2uM1Q.N 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0","America/Juneau|PST PWT PPT PDT YDT YST AKST AKDT|80 70 70 70 80 90 90 80|01203030303030303030303030403030356767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cM0 1cM0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Louisville|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101010102301010101010101010101010101454545454545414545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 3Fd0 Nb0 LPd0 11z0 RB0 8x30 iw0 Bb0 10N0 2bB0 8in0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 xz0 gso0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1VA0 LA0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Kentucky/Monticello|CST CDT CWT CPT EST EDT|60 50 50 50 50 40|0101023010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454545454|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 SWp0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/La_Paz|CMT BOST BOT|4w.A 3w.A 40|012|-1x37r.o 13b0","America/Lima|LMT PET PEST|58.A 50 40|0121212121212121|-2tyGP.o 1bDzP.o zX0 1aN0 1cL0 1cN0 1cL0 1PrB0 zX0 1O10 zX0 6Gp0 zX0 98p0 zX0","America/Los_Angeles|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 5Wp0 1Vb0 3dB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Maceio|LMT BRT BRST|2m.Q 30 20|012121212121212121212121212121212121212121|-2glxB.8 HdLB.8 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 dMN0 Lz0 8Q10 WL0 1tB0 5z0 2mN0 On0","America/Managua|MMT CST EST CDT|5J.c 60 50 50|0121313121213131|-1quie.M 1yAMe.M 4mn0 9Up0 Dz0 1K10 Dz0 s3F0 1KH0 DB0 9In0 k8p0 19X0 1o30 11y0","America/Manaus|LMT AMT AMST|40.4 40 30|01212121212121212121212121212121|-2glvX.U HdKX.U 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 dPB0 On0","America/Martinique|FFMT AST ADT|44.k 40 30|0121|-2mPTT.E 2LPbT.E 19X0","America/Matamoros|LMT CST CDT|6E 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Mazatlan|LMT MST CST PST MDT|75.E 70 60 80 60|0121212131414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 otX0 gmN0 P2N0 13Vd0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Menominee|CST CDT CWT CPT EST|60 50 50 50 50|01010230101041010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 1o10 11z0 LCN0 1fz0 6410 9Jb0 1cM0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Merida|LMT CST EST CDT|5W.s 60 50 50|0121313131313131313131313131313131313131313131313131313131313131313131313131313131313131|-1UQG0 2q2o0 2hz0 wu30 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Metlakatla|PST PWT PPT PDT|80 70 70 70|0120303030303030303030303030303030|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0","America/Mexico_City|LMT MST CST CDT CWT|6A.A 70 60 50 50|012121232324232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 gEn0 TX0 3xd0 Jb0 6zB0 SL0 e5d0 17b0 1Pff0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Miquelon|LMT AST PMST PMDT|3I.E 40 30 20|012323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-2mKkf.k 2LTAf.k gQ10 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Moncton|EST AST ADT AWT APT|50 40 30 30 30|012121212121212121212134121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2IsH0 CwN0 1in0 zAo0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1Nd0 An0 1K10 Lz0 1zB0 NX0 1u10 Wn0 S20 8x50 iu0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14n1 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 ReX 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Monterrey|LMT CST CDT|6F.g 60 50|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1UQG0 2FjC0 1nX0 i6p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Montevideo|MMT UYT UYHST UYST UYT UYHST|3I.I 3u 30 20 30 2u|012121212121212121212121213434343434345454543453434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-20UIf.g 8jzJ.g 1cLu 1dcu 1cLu 1dcu 1cLu ircu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu WLu 1qMu WLu 1qMu 11zu 1o0u 11zu NAu 11bu 2iMu zWu Dq10 19X0 pd0 jz0 cm10 19X0 1fB0 1on0 11d0 1oL0 1nB0 1fzu 1aou 1fzu 1aou 1fzu 3nAu Jb0 3MN0 1SLu 4jzu 2PB0 Lb0 3Dd0 1pb0 ixd0 An0 1MN0 An0 1wp0 On0 1wp0 Rb0 1zd0 On0 1wp0 Rb0 s8p0 1fB0 1ip0 11z0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10 14n0 1ld0 14n0 1ld0 14n0 1ld0 14n0 1o10 11z0 1o10 11z0 1o10","America/Montreal|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-28tR0 bV0 2m30 1in0 121u 1nb0 1g10 11z0 1o0u 11zu 1o0u 11zu 3VAu Rzu 1qMu WLu 1qMu WLu 1qKu WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kO0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Nassau|LMT EST EDT|59.u 50 40|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2kNuO.u 26XdO.u 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/New_York|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 11B0 1qL0 1a10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 RB0 8x40 iv0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Nipigon|EST EDT EWT EPT|50 40 40 40|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 Rnb0 3je0 8x40 iv0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Nome|NST NWT NPT BST BDT YST AKST AKDT|b0 a0 a0 b0 a0 90 90 80|012034343434343434343434343434343456767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676767676|-17SX0 8wW0 iB0 Qlb0 52O0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cl0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Noronha|LMT FNT FNST|29.E 20 10|0121212121212121212121212121212121212121|-2glxO.k HdKO.k 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0","America/North_Dakota/Beulah|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Oo0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/Center|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101014545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/North_Dakota/New_Salem|MST MDT MWT MPT CST CDT|70 60 60 60 60 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101454545454545454545454545454545454545454545454545454545454545454545454|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14o0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Ojinaga|LMT MST CST CDT MDT|6V.E 70 60 50 60|0121212323241414141414141414141414141414141414141414141414141414141414141414141414141414141|-1UQF0 deL0 8lc0 17c0 10M0 1dd0 2zQN0 1lb0 14p0 1lb0 14q0 1lb0 14p0 1nX0 11B0 1nX0 1fB0 WL0 1fB0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 U10 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Panama|CMT EST|5j.A 50|01|-2uduE.o","America/Pangnirtung|zzz AST AWT APT ADDT ADT EDT EST CST CDT|0 40 30 30 20 30 40 50 60 50|012314151515151515151515151515151515167676767689767676767676767676767676767676767676767676767676767676767676767676767676767|-1XiM0 PnG0 8x50 iu0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1o00 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11C0 1nX0 11A0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Paramaribo|LMT PMT PMT NEGT SRT SRT|3E.E 3E.Q 3E.A 3u 3u 30|012345|-2nDUj.k Wqo0.c qanX.I 1dmLN.o lzc0","America/Phoenix|MST MDT MWT|70 60 60|01010202010|-261r0 1nX0 11B0 1nX0 SgN0 4Al1 Ap0 1db0 SWqX 1cL0","America/Port-au-Prince|PPMT EST EDT|4N 50 40|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-28RHb 2FnMb 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14q0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 i6n0 1nX0 11B0 1nX0 d430 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Porto_Acre|LMT ACT ACST AMT|4v.c 50 40 40|01212121212121212121212121212131|-2glvs.M HdLs.M 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0 d5X0","America/Porto_Velho|LMT AMT AMST|4f.A 40 30|012121212121212121212121212121|-2glvI.o HdKI.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0","America/Puerto_Rico|AST AWT APT|40 30 30|0120|-17lU0 7XT0 iu0","America/Rainy_River|CST CDT CWT CPT|60 50 50 50|010123010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TQ0 1in0 Rnb0 3je0 8x30 iw0 19yN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Rankin_Inlet|zzz CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313131313131313131313131313131313131313131313131313131313131313131|-vDc0 keu0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Recife|LMT BRT BRST|2j.A 30 20|0121212121212121212121212121212121212121|-2glxE.o HdLE.o 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 nsp0 WL0 1tB0 2L0 2pB0 On0","America/Regina|LMT MST MDT MWT MPT CST|6W.A 70 60 60 60 60|012121212121212121212121341212121212121212121212121215|-2AD51.o uHe1.o 1in0 s2L0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 66N0 1cL0 1cN0 19X0 1fB0 1cL0 1fB0 1cL0 1cN0 1cL0 M30 8x20 ix0 1ip0 1cL0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 3NB0 1cL0 1cN0","America/Resolute|zzz CST CDDT CDT EST|0 60 40 50 50|012131313131313131313131313131313131313131313431313131313431313131313131313131313131313131313131313131313131313131313131|-SnA0 GWS0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Santa_Isabel|LMT MST PST PDT PWT PPT|7D.s 70 80 70 70 70|012123245232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UQE0 4PX0 8mM0 8lc0 SN0 1cL0 pHB0 83r0 zI0 5O10 1Rz0 cOP0 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 BUp0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0","America/Santarem|LMT AMT AMST BRT|3C.M 40 30 30|0121212121212121212121212121213|-2glwl.c HdLl.c 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 qe10 xb0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 NBd0","America/Santiago|SMT CLT CLT CLST CLST|4G.K 50 40 40 30|010203131313131313124242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424|-2q5Th.e fNch.e 5gLG.K 21bh.e jRAG.K 1pbh.e 11d0 1oL0 11d0 1oL0 11d0 1oL0 11d0 1pb0 11d0 nHX0 op0 9UK0 1Je0 Qen0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1ld0 14n0 1qN0 11z0 1cN0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","America/Santo_Domingo|SDMT EST EDT EHDT AST|4E 50 40 4u 40|01213131313131414|-1ttjk 1lJMk Mn0 6sp0 Lbu 1Cou yLu 1RAu wLu 1QMu xzu 1Q0u xXu 1PAu 13jB0 e00","America/Sao_Paulo|LMT BRT BRST|36.s 30 20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-2glwR.w HdKR.w 1cc0 1e10 1bX0 Ezd0 So0 1vA0 Mn0 1BB0 ML0 1BB0 zX0 pTd0 PX0 2ep0 nz0 1C10 zX0 1C10 LX0 1C10 Mn0 H210 Rb0 1tB0 IL0 1Fd0 FX0 1EN0 FX0 1HB0 Lz0 1EN0 Lz0 1C10 IL0 1HB0 Db0 1HB0 On0 1zd0 On0 1zd0 Lz0 1zd0 Rb0 1wN0 Wn0 1tB0 Rb0 1tB0 WL0 1tB0 Rb0 1zd0 On0 1HB0 FX0 1C10 Lz0 1Ip0 HX0 1zd0 On0 1HB0 IL0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1zd0 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0 On0 1zd0 On0 1zd0 On0 1C10 Lz0 1C10 Lz0 1C10 Lz0 1C10 On0 1zd0 Rb0 1wp0 On0 1C10 Lz0 1C10 On0 1zd0","America/Scoresbysund|LMT CGT CGST EGST EGT|1r.Q 20 10 0 10|0121343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2a5Ww.8 2z5ew.8 1a00 1cK0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","America/Sitka|PST PWT PPT PDT YST AKST AKDT|80 70 70 70 90 90 80|01203030303030303030303030303030345656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-17T20 8x10 iy0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 co0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/St_Johns|NST NDT NST NDT NWT NPT NDDT|3u.Q 2u.Q 3u 2u 2u 2u 1u|01010101010101010101010101010101010102323232323232324523232323232323232323232323232323232323232323232323232323232323232323232323232323232326232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-28oit.8 14L0 1nB0 1in0 1gm0 Dz0 1JB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1fB0 19X0 1fB0 19X0 10O0 eKX.8 19X0 1iq0 WL0 1qN0 WL0 1qN0 WL0 1tB0 TX0 1tB0 WL0 1qN0 WL0 1qN0 7UHu itu 1tB0 WL0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1tB0 WL0 1ld0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14n1 1lb0 14p0 1nW0 11C0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zcX Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Swift_Current|LMT MST MDT MWT MPT CST|7b.k 70 60 60 60 60|012134121212121212121215|-2AD4M.E uHdM.E 1in0 UGp0 8x20 ix0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 isN0 1cL0 3Cp0 1cL0 1cN0 11z0 1qN0 WL0 pMp0","America/Tegucigalpa|LMT CST CDT|5M.Q 60 50|01212121|-1WGGb.8 2ETcb.8 WL0 1qN0 WL0 GRd0 AL0","America/Thule|LMT AST ADT|4z.8 40 30|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a5To.Q 31NBo.Q 1cL0 1cN0 1cL0 1fB0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Thunder_Bay|CST EST EWT EPT EDT|60 50 40 40 40|0123141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141|-2q5S0 1iaN0 8x40 iv0 XNB0 1cL0 1cN0 1fz0 1cN0 1cL0 3Cp0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Toronto|EST EDT EWT EPT|50 40 40 40|01010101010101010101010101010101010101010101012301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TR0 1in0 11Wu 1nzu 1fD0 WJ0 1wr0 Nb0 1Ap0 On0 1zd0 On0 1wp0 TX0 1tB0 TX0 1tB0 TX0 1tB0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 4kM0 8x40 iv0 1o10 11z0 1nX0 11z0 1o10 11z0 1o10 1qL0 11D0 1nX0 11B0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Vancouver|PST PDT PWT PPT|80 70 70 70|0102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-25TO0 1in0 UGp0 8x10 iy0 1o10 17b0 1ip0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Whitehorse|YST YDT YWT YPT YDDT PST PDT|90 80 80 80 70 80 70|0101023040565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565|-25TN0 1in0 1o10 13V0 Ser0 8x00 iz0 LCL0 1fA0 1Be0 xDz0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Winnipeg|CST CDT CWT CPT|60 50 50 50|010101023010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aIi0 WL0 3ND0 1in0 Jap0 Rb0 aCN0 8x30 iw0 1tB0 11z0 1ip0 11z0 1o10 11z0 1o10 11z0 1rd0 10L0 1op0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 1cL0 1cN0 11z0 6i10 WL0 6i10 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1o00 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1o00 11A0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Yakutat|YST YWT YPT YDT AKST AKDT|90 80 80 80 90 80|01203030303030303030303030303030304545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-17T10 8x00 iz0 Vo10 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 cn0 10q0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","America/Yellowknife|zzz MST MWT MPT MDDT MDT|0 70 60 60 50 60|012314151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151515151|-1pdA0 hix0 8x20 ix0 LCL0 1fA0 zgO0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Antarctica/Casey|zzz AWST CAST|0 -80 -b0|012121|-2q00 1DjS0 T90 40P0 KL0","Antarctica/Davis|zzz DAVT DAVT|0 -70 -50|01012121|-vyo0 iXt0 alj0 1D7v0 VB0 3Wn0 KN0","Antarctica/DumontDUrville|zzz PMT DDUT|0 -a0 -a0|0102|-U0o0 cfq0 bFm0","Antarctica/Macquarie|AEST AEDT zzz MIST|-a0 -b0 0 -b0|0102010101010101010101010101010101010101010101010101010101010101010101010101010101010101013|-29E80 19X0 4SL0 1ayy0 Lvs0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0","Antarctica/Mawson|zzz MAWT MAWT|0 -60 -50|012|-CEo0 2fyk0","Antarctica/McMurdo|NZMT NZST NZST NZDT|-bu -cu -c0 -d0|01020202020202020202020202023232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323|-1GCVu Lz0 1tB0 11zu 1o0u 11zu 1o0u 11zu 1o0u 14nu 1lcu 14nu 1lcu 1lbu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1nXu 11Au 1qLu WMu 1qLu 11Au 1n1bu IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Antarctica/Palmer|zzz ARST ART ART ARST CLT CLST|0 30 40 30 20 40 30|012121212123435656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656565656|-cao0 nD0 1vd0 SL0 1vd0 17z0 1cN0 1fz0 1cN0 1cL0 1cN0 asn0 Db0 jsN0 14N0 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1ld0 14n0 1qN0 11z0 1cN0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","Antarctica/Rothera|zzz ROTT|0 30|01|gOo0","Antarctica/Syowa|zzz SYOT|0 -30|01|-vs00","Antarctica/Troll|zzz UTC CEST|0 0 -20|01212121212121212121212121212121212121212121212121212121212121212121|1puo0 hd0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Antarctica/Vostok|zzz VOST|0 -60|01|-tjA0","Arctic/Longyearbyen|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2awM0 Qm0 W6o0 5pf0 WM0 1fA0 1cM0 1cM0 1cM0 1cM0 wJc0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1qM0 WM0 zpc0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Aden|LMT AST|-2X.S -30|01|-MG2X.S","Asia/Almaty|LMT ALMT ALMT ALMST|-57.M -50 -60 -70|0123232323232323232323232323232323232323232323232|-1Pc57.M eUo7.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 3Cl0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Amman|LMT EET EEST|-2n.I -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1yW2n.I 1HiMn.I KL0 1oN0 11b0 1oN0 11b0 1pd0 1dz0 1cp0 11b0 1op0 11b0 fO10 1db0 1e10 1cL0 1cN0 1cL0 1cN0 1fz0 1pd0 10n0 1ld0 14n0 1hB0 15b0 1ip0 19X0 1cN0 1cL0 1cN0 17b0 1ld0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1So0 y00 1fc0 1dc0 1co0 1dc0 1cM0 1cM0 1cM0 1o00 11A0 1lc0 17c0 1cM0 1cM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 4bX0 Dd0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0","Asia/Anadyr|LMT ANAT ANAT ANAST ANAST ANAST ANAT|-bN.U -c0 -d0 -e0 -d0 -c0 -b0|01232414141414141414141561414141414141414141414141414141414141561|-1PcbN.U eUnN.U 23CL0 1db0 1cN0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0","Asia/Aqtau|LMT FORT FORT SHET SHET SHEST AQTT AQTST AQTST AQTT|-3l.4 -40 -50 -50 -60 -60 -50 -60 -50 -40|012345353535353535353536767676898989898989898989896|-1Pc3l.4 eUnl.4 1jcL0 JDc0 1cL0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2UK0 Fz0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cN0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 RW0","Asia/Aqtobe|LMT AKTT AKTT AKTST AKTT AQTT AQTST|-3M.E -40 -50 -60 -60 -50 -60|01234323232323232323232565656565656565656565656565|-1Pc3M.E eUnM.E 23CL0 1db0 1cM0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2UK0 Fz0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Ashgabat|LMT ASHT ASHT ASHST ASHST TMT TMT|-3R.w -40 -50 -60 -50 -40 -50|012323232323232323232324156|-1Pc3R.w eUnR.w 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 ba0 xC0","Asia/Baghdad|BMT AST ADT|-2V.A -30 -40|012121212121212121212121212121212121212121212121212121|-26BeV.A 2ACnV.A 11b0 1cp0 1dz0 1dd0 1db0 1cN0 1cp0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1de0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0 1dc0 1dc0 1cM0 1dc0 1cM0 1dc0 1cM0 1dc0","Asia/Bahrain|LMT GST AST|-3m.k -40 -30|012|-21Jfm.k 27BXm.k","Asia/Baku|LMT BAKT BAKT BAKST BAKST AZST AZT AZT AZST|-3j.o -30 -40 -50 -40 -40 -30 -40 -50|0123232323232323232323245657878787878787878787878787878787878787878787878787878787878787878787878787878787878787|-1Pc3j.o 1jUoj.o WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 10K0 c30 1cJ0 1cL0 8wu0 1o00 11z0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Bangkok|BMT ICT|-6G.4 -70|01|-218SG.4","Asia/Beirut|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-21aq0 1on0 1410 1db0 19B0 1in0 1ip0 WL0 1lQp0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 q6N0 En0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1op0 11b0 dA10 17b0 1iN0 17b0 1iN0 17b0 1iN0 17b0 1vB0 SL0 1mp0 13z0 1iN0 17b0 1iN0 17b0 1jd0 12n0 1a10 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0","Asia/Bishkek|LMT FRUT FRUT FRUST FRUST KGT KGST KGT|-4W.o -50 -60 -70 -60 -50 -60 -60|01232323232323232323232456565656565656565656565656567|-1Pc4W.o eUnW.o 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11c0 1tX0 17b0 1ip0 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1cPu 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 T8u","Asia/Brunei|LMT BNT BNT|-7D.E -7u -80|012|-1KITD.E gDc9.E","Asia/Calcutta|HMT BURT IST IST|-5R.k -6u -5u -6u|01232|-18LFR.k 1unn.k HB0 7zX0","Asia/Chita|LMT YAKT YAKT YAKST YAKST YAKT IRKT|-7x.Q -80 -90 -a0 -90 -a0 -80|012323232323232323232324123232323232323232323232323232323232323256|-21Q7x.Q pAnx.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Choibalsan|LMT ULAT ULAT CHOST CHOT CHOT|-7C -70 -80 -a0 -90 -80|012343434343434343434343434343434343434343434345|-2APHC 2UkoC cKn0 1da0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 3Db0","Asia/Chongqing|CST CDT|-80 -90|01010101010101010|-1c1I0 LX0 16p0 1jz0 1Myp0 Rb0 1o10 11z0 1o10 11z0 1qN0 11z0 1o10 11z0 1o10 11z0","Asia/Colombo|MMT IST IHST IST LKT LKT|-5j.w -5u -60 -6u -6u -60|01231451|-2zOtj.w 1rFbN.w 1zzu 7Apu 23dz0 11zu n3cu","Asia/Dacca|HMT BURT IST DACT BDT BDST|-5R.k -6u -5u -60 -60 -70|01213454|-18LFR.k 1unn.k HB0 m6n0 LqMu 1x6n0 1i00","Asia/Damascus|LMT EET EEST|-2p.c -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-21Jep.c Hep.c 17b0 1ip0 17b0 1ip0 17b0 1ip0 19X0 1xRB0 11X0 1oN0 10L0 1pB0 11b0 1oN0 10L0 1mp0 13X0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 1pd0 11b0 1oN0 Nb0 1AN0 Nb0 bcp0 19X0 1gp0 19X0 3ld0 1xX0 Vd0 1Bz0 Sp0 1vX0 10p0 1dz0 1cN0 1cL0 1db0 1db0 1g10 1an0 1ap0 1db0 1fd0 1db0 1cN0 1db0 1dd0 1db0 1cp0 1dz0 1c10 1dX0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1db0 1cN0 1db0 1cN0 19z0 1fB0 1qL0 11B0 1on0 Wp0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 1qL0 WN0 1qL0","Asia/Dili|LMT TLT JST TLT WITA|-8m.k -80 -90 -90 -80|012343|-2le8m.k 1dnXm.k 8HA0 1ew00 Xld0","Asia/Dubai|LMT GST|-3F.c -40|01|-21JfF.c","Asia/Dushanbe|LMT DUST DUST DUSST DUSST TJT|-4z.c -50 -60 -70 -60 -50|0123232323232323232323245|-1Pc4z.c eUnz.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 14N0","Asia/Gaza|EET EET EEST IST IDT|-20 -30 -30 -20 -30|010101010102020202020202020202023434343434343434343434343430202020202020202020202020202020202020202020202020202020202020202020202020202020202020|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 11z0 1o10 14o0 1lA1 SKX 1xd1 MKX 1AN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Hebron|EET EET EEST IST IDT|-20 -30 -30 -20 -30|01010101010202020202020202020202343434343434343434343434343020202020202020202020202020202020202020202020202020202020202020202020202020202020202020|-1c2q0 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 pBd0 Vz0 1oN0 11b0 1oO0 10N0 1pz0 10N0 1pb0 10N0 1pb0 10N0 1pb0 10N0 1pz0 10N0 1pb0 10N0 1pb0 11d0 1oL0 dW0 hfB0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 M10 C00 17c0 1io0 17c0 1io0 17c0 1o00 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 17c0 1io0 18N0 1bz0 19z0 1gp0 1610 1iL0 12L0 1mN0 14o0 1lc0 Tb0 1xd1 MKX bB0 cn0 1cN0 1a00 1fA0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 19X0 1fB0 19X0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0","Asia/Ho_Chi_Minh|LMT PLMT ICT IDT JST|-76.E -76.u -70 -80 -90|0123423232|-2yC76.E bK00.a 1h7b6.u 5lz0 18o0 3Oq0 k5b0 aW00 BAM0","Asia/Hong_Kong|LMT HKT HKST JST|-7A.G -80 -90 -90|0121312121212121212121212121212121212121212121212121212121212121212121|-2CFHA.G 1sEP6.G 1cL0 ylu 93X0 1qQu 1tX0 Rd0 1In0 NB0 1cL0 11B0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1kL0 14N0 1nX0 U10 1tz0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 Rd0 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 17d0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 s10 1Vz0 1cN0 1cL0 1cN0 1cL0 6fd0 14n0","Asia/Hovd|LMT HOVT HOVT HOVST|-66.A -60 -70 -80|01232323232323232323232323232323232323232323232|-2APG6.A 2Uko6.A cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0","Asia/Irkutsk|IMT IRKT IRKT IRKST IRKST IRKT|-6V.5 -70 -80 -90 -80 -90|012323232323232323232324123232323232323232323232323232323232323252|-21zGV.5 pjXV.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Istanbul|IMT EET EEST TRST TRT|-1U.U -20 -30 -40 -30|012121212121212121212121212121212121212121212121212121234343434342121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ogNU.U dzzU.U 11b0 8tB0 1on0 1410 1db0 19B0 1in0 3Rd0 Un0 1oN0 11b0 zSp0 CL0 mN0 1Vz0 1gN0 1pz0 5Rd0 1fz0 1yp0 ML0 1kp0 17b0 1ip0 17b0 1fB0 19X0 1jB0 18L0 1ip0 17z0 qdd0 xX0 3S10 Tz0 dA10 11z0 1o10 11z0 1qN0 11z0 1ze0 11B0 WM0 1qO0 WI0 1nX0 1rB0 10L0 11B0 1in0 17d0 1in0 2pX0 19E0 1fU0 16Q0 1iI0 16Q0 1iI0 1Vd0 pb0 3Kp0 14o0 1df0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WO0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 Xc0 1qo0 WM0 1qM0 11A0 1o00 1200 1nA0 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Jakarta|BMT JAVT WIB JST WIB WIB|-77.c -7k -7u -90 -80 -70|01232425|-1Q0Tk luM0 mPzO 8vWu 6kpu 4PXu xhcu","Asia/Jayapura|LMT WIT ACST|-9m.M -90 -9u|0121|-1uu9m.M sMMm.M L4nu","Asia/Jerusalem|JMT IST IDT IDDT|-2k.E -20 -30 -40|01212121212132121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-26Bek.E SyMk.E 5Rb0 10r0 1px0 10N0 1pz0 16p0 1jB0 16p0 1jx0 3LB0 Em0 or0 1cn0 1dB0 16n0 10O0 1ja0 1tC0 14o0 1cM0 1a00 11A0 1Na0 An0 1MP0 AJ0 1Kp0 LC0 1oo0 Wl0 EQN0 Db0 1fB0 Rb0 npB0 11z0 1C10 IL0 1s10 10n0 1o10 WL0 1zd0 On0 1ld0 11z0 1o10 14n0 1o10 14n0 1nd0 12n0 1nd0 Xz0 1q10 12n0 1hB0 1dX0 1ep0 1aL0 1eN0 17X0 1nf0 11z0 1tB0 19W0 1e10 17b0 1ep0 1gL0 18N0 1fz0 1eN0 17b0 1gq0 1gn0 19d0 1dz0 1c10 17X0 1hB0 1gn0 19d0 1dz0 1c10 17X0 1kp0 1dz0 1c10 1aL0 1eN0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0 10N0 1rz0 W10 1rz0 W10 1rz0 W10 1rz0 10N0 1oL0 10N0 1oL0","Asia/Kabul|AFT AFT|-40 -4u|01|-10Qs0","Asia/Kamchatka|LMT PETT PETT PETST PETST|-ay.A -b0 -c0 -d0 -c0|01232323232323232323232412323232323232323232323232323232323232412|-1SLKy.A ivXy.A 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0","Asia/Karachi|LMT IST IST KART PKT PKST|-4s.c -5u -6u -50 -50 -60|012134545454|-2xoss.c 1qOKW.c 7zX0 eup0 LqMu 1fy01 1cL0 dK0X 11b0 1610 1jX0","Asia/Kashgar|LMT XJT|-5O.k -60|01|-1GgtO.k","Asia/Kathmandu|LMT IST NPT|-5F.g -5u -5J|012|-21JhF.g 2EGMb.g","Asia/Khandyga|LMT YAKT YAKT YAKST YAKST VLAT VLAST VLAT YAKT|-92.d -80 -90 -a0 -90 -a0 -b0 -b0 -a0|01232323232323232323232412323232323232323232323232565656565656565782|-21Q92.d pAp2.d 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 qK0 yN0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0","Asia/Krasnoyarsk|LMT KRAT KRAT KRAST KRAST KRAT|-6b.q -60 -70 -80 -70 -80|012323232323232323232324123232323232323232323232323232323232323252|-21Hib.q prAb.q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Kuala_Lumpur|SMT MALT MALST MALT MALT JST MYT|-6T.p -70 -7k -7k -7u -90 -80|01234546|-2Bg6T.p 17anT.p 7hXE dM00 17bO 8Fyu 1so1u","Asia/Kuching|LMT BORT BORT BORTST JST MYT|-7l.k -7u -80 -8k -90 -80|01232323232323232425|-1KITl.k gDbP.k 6ynu AnE 1O0k AnE 1NAk AnE 1NAk AnE 1NAk AnE 1O0k AnE 1NAk AnE pAk 8Fz0 1so10","Asia/Kuwait|LMT AST|-3b.U -30|01|-MG3b.U","Asia/Macao|LMT MOT MOST CST|-7y.k -80 -90 -80|0121212121212121212121212121212121212121213|-2le7y.k 1XO34.k 1wn0 Rd0 1wn0 R9u 1wqu U10 1tz0 TVu 1tz0 17gu 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cOu 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cJu 1cL0 1cN0 1fz0 1cN0 1cL0 KEp0","Asia/Magadan|LMT MAGT MAGT MAGST MAGST MAGT|-a3.c -a0 -b0 -c0 -b0 -c0|012323232323232323232324123232323232323232323232323232323232323251|-1Pca3.c eUo3.c 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Makassar|LMT MMT WITA JST|-7V.A -7V.A -80 -90|01232|-21JjV.A vfc0 myLV.A 8ML0","Asia/Manila|PHT PHST JST|-80 -90 -90|010201010|-1kJI0 AL0 cK10 65X0 mXB0 vX0 VK10 1db0","Asia/Muscat|LMT GST|-3S.o -40|01|-21JfS.o","Asia/Nicosia|LMT EET EEST|-2d.s -20 -30|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1Vc2d.s 2a3cd.s 1cL0 1qp0 Xz0 19B0 19X0 1fB0 1db0 1cp0 1cL0 1fB0 19X0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1o30 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Asia/Novokuznetsk|LMT KRAT KRAT KRAST KRAST NOVST NOVT NOVT|-5M.M -60 -70 -80 -70 -70 -60 -70|012323232323232323232324123232323232323232323232323232323232325672|-1PctM.M eULM.M 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0 8Hz0","Asia/Novosibirsk|LMT NOVT NOVT NOVST NOVST|-5v.E -60 -70 -80 -70|0123232323232323232323241232341414141414141414141414141414141414121|-21Qnv.E pAFv.E 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 ml0 Os0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Omsk|LMT OMST OMST OMSST OMSST OMST|-4R.u -50 -60 -70 -60 -70|012323232323232323232324123232323232323232323232323232323232323252|-224sR.u pMLR.u 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Oral|LMT URAT URAT URAST URAT URAST ORAT ORAST ORAT|-3p.o -40 -50 -60 -60 -50 -40 -50 -50|012343232323232323251516767676767676767676767676768|-1Pc3p.o eUnp.o 23CL0 1db0 1cM0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 2UK0 Fz0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 RW0","Asia/Pontianak|LMT PMT WIB JST WIB WITA WIB|-7h.k -7h.k -7u -90 -80 -80 -70|012324256|-2ua7h.k XE00 munL.k 8Rau 6kpu 4PXu xhcu Wqnu","Asia/Pyongyang|LMT KST JCST JST KST|-8n -8u -90 -90 -90|01234|-2um8n 97XR 12FXu jdA0","Asia/Qatar|LMT GST AST|-3q.8 -40 -30|012|-21Jfq.8 27BXq.8","Asia/Qyzylorda|LMT KIZT KIZT KIZST KIZT QYZT QYZT QYZST|-4l.Q -40 -50 -60 -60 -50 -60 -70|012343232323232323232325676767676767676767676767676|-1Pc4l.Q eUol.Q 23CL0 1db0 1cM0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 2UK0 dC0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0","Asia/Rangoon|RMT BURT JST MMT|-6o.E -6u -90 -6u|0123|-21Jio.E SmnS.E 7j9u","Asia/Riyadh|LMT AST|-36.Q -30|01|-TvD6.Q","Asia/Sakhalin|LMT JCST JST SAKT SAKST SAKST SAKT|-9u.M -90 -90 -b0 -c0 -b0 -a0|0123434343434343434343435634343434343565656565656565656565656565636|-2AGVu.M 1iaMu.M je00 1qFa0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o10 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Samarkand|LMT SAMT SAMT SAMST TAST UZST UZT|-4r.R -40 -50 -60 -60 -60 -50|01234323232323232323232356|-1Pc4r.R eUor.R 23CL0 1db0 1cM0 1dc0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11x0 bf0","Asia/Seoul|LMT KST JCST JST KST KDT KDT|-8r.Q -8u -90 -90 -90 -9u -a0|01234151515151515146464|-2um8r.Q 97XV.Q 12FXu jjA0 kKo0 2I0u OL0 1FB0 Rb0 1qN0 TX0 1tB0 TX0 1tB0 TX0 1tB0 TX0 2ap0 12FBu 11A0 1o00 11A0","Asia/Singapore|SMT MALT MALST MALT MALT JST SGT SGT|-6T.p -70 -7k -7k -7u -90 -7u -80|012345467|-2Bg6T.p 17anT.p 7hXE dM00 17bO 8Fyu Mspu DTA0","Asia/Srednekolymsk|LMT MAGT MAGT MAGST MAGST MAGT SRET|-ae.Q -a0 -b0 -c0 -b0 -c0 -b0|012323232323232323232324123232323232323232323232323232323232323256|-1Pcae.Q eUoe.Q 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Taipei|JWST JST CST CDT|-80 -90 -80 -90|01232323232323232323232323232323232323232|-1iw80 joM0 1yo0 Tz0 1ip0 1jX0 1cN0 11b0 1oN0 11b0 1oN0 11b0 1oN0 11b0 10N0 1BX0 10p0 1pz0 10p0 1pz0 10p0 1db0 1dd0 1db0 1cN0 1db0 1cN0 1db0 1cN0 1db0 1BB0 ML0 1Bd0 ML0 uq10 1db0 1cN0 1db0 97B0 AL0","Asia/Tashkent|LMT TAST TAST TASST TASST UZST UZT|-4B.b -50 -60 -70 -60 -60 -50|01232323232323232323232456|-1Pc4B.b eUnB.b 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 11y0 bf0","Asia/Tbilisi|TBMT TBIT TBIT TBIST TBIST GEST GET GET GEST|-2X.b -30 -40 -50 -40 -40 -30 -40 -50|0123232323232323232323245656565787878787878787878567|-1Pc2X.b 1jUnX.b WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 3y0 19f0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cM0 1cL0 1fB0 3Nz0 11B0 1nX0 11B0 1qL0 WN0 1qL0 WN0 1qL0 11B0 1nX0 11B0 1nX0 11B0 An0 Os0 WM0","Asia/Tehran|LMT TMT IRST IRST IRDT IRDT|-3p.I -3p.I -3u -40 -50 -4u|01234325252525252525252525252525252525252525252525252525252525252525252525252525252525252525252525252|-2btDp.I 1d3c0 1huLT.I TXu 1pz0 sN0 vAu 1cL0 1dB0 1en0 pNB0 UL0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 64p0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0 1cN0 1dz0 1cp0 1dz0 1cp0 1dz0 1cp0 1dz0","Asia/Thimbu|LMT IST BTT|-5W.A -5u -60|012|-Su5W.A 1BGMs.A","Asia/Tokyo|JCST JST JDT|-90 -90 -a0|0121212121|-1iw90 pKq0 QL0 1lB0 13X0 1zB0 NX0 1zB0 NX0","Asia/Ulaanbaatar|LMT ULAT ULAT ULAST|-77.w -70 -80 -90|01232323232323232323232323232323232323232323232|-2APH7.w 2Uko7.w cKn0 1db0 1dd0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 6hD0 11z0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0","Asia/Ust-Nera|LMT YAKT YAKT MAGST MAGT MAGST MAGT MAGT VLAT VLAT|-9w.S -80 -90 -c0 -b0 -b0 -a0 -c0 -b0 -a0|0123434343434343434343456434343434343434343434343434343434343434789|-21Q9w.S pApw.S 23CL0 1d90 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 17V0 7zD0","Asia/Vladivostok|LMT VLAT VLAT VLAST VLAST VLAT|-8L.v -90 -a0 -b0 -a0 -b0|012323232323232323232324123232323232323232323232323232323232323252|-1SJIL.v itXL.v 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Yakutsk|LMT YAKT YAKT YAKST YAKST YAKT|-8C.W -80 -90 -a0 -90 -a0|012323232323232323232324123232323232323232323232323232323232323252|-21Q8C.W pAoC.W 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Yekaterinburg|LMT PMT SVET SVET SVEST SVEST YEKT YEKST YEKT|-42.x -3J.5 -40 -50 -60 -50 -50 -60 -60|0123434343434343434343435267676767676767676767676767676767676767686|-2ag42.x 7mQh.s qBvJ.5 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Asia/Yerevan|LMT YERT YERT YERST YERST AMST AMT AMT AMST|-2W -30 -40 -50 -40 -40 -30 -40 -50|0123232323232323232323245656565657878787878787878787878787878787|-1Pc2W 1jUnW WCL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1am0 2r0 1cJ0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fb0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0","Atlantic/Azores|HMT AZOT AZOST AZOMT AZOT AZOST WET|1S.w 20 10 0 10 0 0|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545456545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldW5.s aPX5.s Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cL0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Bermuda|LMT AST ADT|4j.i 40 30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1BnRE.G 1LTbE.G 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Atlantic/Canary|LMT CANT WET WEST|11.A 10 0 -10|01232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-1UtaW.o XPAW.o 1lAK0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Cape_Verde|LMT CVT CVST CVT|1y.4 20 10 10|01213|-2xomp.U 1qOMp.U 7zX0 1djf0","Atlantic/Faeroe|LMT WET WEST|r.4 0 -10|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2uSnw.U 2Wgow.U 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Madeira|FMT MADT MADST MADMT WET WEST|17.A 10 0 -10 0 -10|01212121212121212121212121212121212121212121232123212321232121212121212121212121212121212121212121454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2ldWQ.o aPWQ.o Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 qIl0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Atlantic/Reykjavik|RMT IST ISST GMT|1r.M 10 0 0|01212121212121212121212121212121212121212121212121212121212121213|-2uWmw.c mfaw.c 1Bd0 ML0 1LB0 NLX0 1pe0 zd0 1EL0 LA0 1C00 Oo0 1wo0 Rc0 1wo0 Rc0 1wo0 Rc0 1zc0 Oo0 1zc0 14o0 1lc0 14o0 1lc0 14o0 1o00 11A0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1lc0 14o0 1o00 14o0","Atlantic/South_Georgia|GST|20|0|","Atlantic/Stanley|SMT FKT FKST FKT FKST|3P.o 40 30 30 20|0121212121212134343212121212121212121212121212121212121212121212121212|-2kJw8.A 12bA8.A 19X0 1fB0 19X0 1ip0 19X0 1fB0 19X0 1fB0 19X0 1fB0 Cn0 1Cc10 WL0 1qL0 U10 1tz0 U10 1qM0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 U10 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1tz0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qL0 WN0 1qN0 U10 1wn0 Rd0 1wn0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1tz0 U10 1wn0 U10 1tz0 U10 1tz0 U10","Australia/ACT|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Adelaide|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 WM0 1qM0 Rc0 1zc0 U00 1tA0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Brisbane|AEST AEDT|-a0 -b0|01010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0","Australia/Broken_Hill|ACST ACDT|-9u -au|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 14o0 1o00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1tA0 WM0 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Currie|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Darwin|ACST ACDT|-9u -au|010101010|-293lt xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0","Australia/Eucla|ACWST ACWDT|-8J -9J|0101010101010101010|-293kI xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0","Australia/Hobart|AEST AEDT|-a0 -b0|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-29E80 19X0 10jd0 yL0 1cN0 1cL0 1fB0 19X0 VfB0 1cM0 1o00 Rc0 1wo0 Rc0 1wo0 U00 1wo0 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 11A0 1qM0 WM0 1qM0 Oo0 1zc0 Oo0 1zc0 Oo0 1wo0 WM0 1tA0 WM0 1tA0 U00 1tA0 U00 1tA0 11A0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 11A0 1o00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/LHI|AEST LHST LHDT LHDT|-a0 -au -bu -b0|0121212121313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313|raC0 1zdu Rb0 1zd0 On0 1zd0 On0 1zd0 On0 1zd0 TXu 1qMu WLu 1tAu WLu 1tAu TXu 1tAu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu 11zu 1o0u 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 11Au 1nXu 1qMu 11zu 1o0u 11zu 1o0u 11zu 1qMu WLu 1qMu 11zu 1o0u WLu 1qMu 14nu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1fzu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1cMu 1cLu 1fAu 1cLu 1cMu 1cLu 1cMu","Australia/Lindeman|AEST AEDT|-a0 -b0|010101010101010101010|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 H1A0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0","Australia/Melbourne|AEST AEDT|-a0 -b0|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101|-293lX xcX 10jd0 yL0 1cN0 1cL0 1fB0 19X0 17c10 LA0 1C00 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 U00 1qM0 WM0 1qM0 11A0 1tA0 U00 1tA0 U00 1tA0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 11A0 1o00 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 14o0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0","Australia/Perth|AWST AWDT|-80 -90|0101010101010101010|-293jX xcX 10jd0 yL0 1cN0 1cL0 1gSp0 Oo0 l5A0 Oo0 iJA0 G00 zU00 IM0 1qM0 11A0 1o00 11A0","CET|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","CST6CDT|CST CDT CWT CPT|60 50 50 50|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261s0 1nX0 11B0 1nX0 SgN0 8x30 iw0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Chile/EasterIsland|EMT EASST EAST EAST EASST|7h.s 60 70 60 50|012121212121212121212121212121213434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-1uSgG.w nHUG.w op0 9UK0 RXB0 WL0 1zd0 On0 1ip0 11z0 1o10 11z0 1qN0 WL0 1ld0 14n0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 WL0 1qN0 1cL0 1cN0 11z0 1ld0 14n0 1qN0 11z0 1cN0 19X0 1qN0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1ip0 1fz0 1fB0 11z0 1qN0 WL0 1qN0 WL0 1qN0 WL0 1qN0 11z0 1o10 11z0 1o10 11z0 1qN0 WL0 1qN0 17b0 1ip0 11z0 1o10 19X0 1fB0 1nX0 G10 1EL0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1wn0 Rd0 1zb0 Op0 1zb0 Rd0 1wn0 Rd0","EET|EET EEST|-20 -30|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","EST|EST|50|0|","EST5EDT|EST EDT EWT EPT|50 40 40 40|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261t0 1nX0 11B0 1nX0 SgN0 8x40 iv0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Eire|DMT IST GMT BST IST|p.l -y.D 0 -10 -10|01232323232324242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242|-2ax9y.D Rc0 1fzy.D 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 g5X0 14p0 1wn0 17d0 1io0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Etc/GMT+0|GMT|0|0|","Etc/GMT+1|GMT+1|10|0|","Etc/GMT+10|GMT+10|a0|0|","Etc/GMT+11|GMT+11|b0|0|","Etc/GMT+12|GMT+12|c0|0|","Etc/GMT+2|GMT+2|20|0|","Etc/GMT+3|GMT+3|30|0|","Etc/GMT+4|GMT+4|40|0|","Etc/GMT+5|GMT+5|50|0|","Etc/GMT+6|GMT+6|60|0|","Etc/GMT+7|GMT+7|70|0|","Etc/GMT+8|GMT+8|80|0|","Etc/GMT+9|GMT+9|90|0|","Etc/GMT-1|GMT-1|-10|0|","Etc/GMT-10|GMT-10|-a0|0|","Etc/GMT-11|GMT-11|-b0|0|","Etc/GMT-12|GMT-12|-c0|0|","Etc/GMT-13|GMT-13|-d0|0|","Etc/GMT-14|GMT-14|-e0|0|","Etc/GMT-2|GMT-2|-20|0|","Etc/GMT-3|GMT-3|-30|0|","Etc/GMT-4|GMT-4|-40|0|","Etc/GMT-5|GMT-5|-50|0|","Etc/GMT-6|GMT-6|-60|0|","Etc/GMT-7|GMT-7|-70|0|","Etc/GMT-8|GMT-8|-80|0|","Etc/GMT-9|GMT-9|-90|0|","Etc/UCT|UCT|0|0|","Etc/UTC|UTC|0|0|","Europe/Amsterdam|AMT NST NEST NET CEST CET|-j.w -1j.w -1k -k -20 -10|010101010101010101010101010101010101010101012323234545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545|-2aFcj.w 11b0 1iP0 11A0 1io0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1co0 1io0 1yo0 Pc0 1a00 1fA0 1Bc0 Mo0 1tc0 Uo0 1tA0 U00 1uo0 W00 1s00 VA0 1so0 Vc0 1sM0 UM0 1wo0 Rc0 1u00 Wo0 1rA0 W00 1s00 VA0 1sM0 UM0 1w00 fV0 BCX.w 1tA0 U00 1u00 Wo0 1sm0 601k WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Andorra|WET CET CEST|0 -10 -20|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-UBA0 1xIN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Athens|AMT EET EEST CEST CET|-1y.Q -20 -30 -20 -10|012123434121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2a61x.Q CNbx.Q mn0 kU10 9b0 3Es0 Xa0 1fb0 1dd0 k3X0 Nz0 SCp0 1vc0 SO0 1cM0 1a00 1ao0 1fc0 1a10 1fG0 1cg0 1dX0 1bX0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Belfast|GMT BST BDST|0 -10 -20|0101010101010101010101010101010101010101010101010121212121210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1a00 1qM0 WM0 1qM0 11A0 1o00 WM0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1tA0 IM0 90o0 U00 1tA0 U00 1tA0 U00 1tA0 U00 1tA0 WM0 1qM0 WM0 1qM0 WM0 1tA0 U00 1tA0 U00 1tA0 11z0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1o00 14o0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Belgrade|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19RC0 3IP0 WM0 1fA0 1cM0 1cM0 1rc0 Qo0 1vmo0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Berlin|CET CEST CEMT|-10 -20 -30|01010101010101210101210101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 kL0 Nc0 m10 WM0 1ao0 1cp0 dX0 jz0 Dd0 1io0 17c0 1fA0 1a00 1ehA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Bratislava|CET CEST|-10 -20|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 16M0 1lc0 1tA0 17A0 11c0 1io0 17c0 1io0 17c0 1fc0 1ao0 1bNc0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Brussels|WET CET CEST WEST|0 -10 -20 -10|0121212103030303030303030303030303030303030303030303212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ehc0 3zX0 11c0 1iO0 11A0 1o00 11A0 my0 Ic0 1qM0 Rc0 1EM0 UM0 1u00 10o0 1io0 1io0 17c0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a30 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 y00 5Wn0 WM0 1fA0 1cM0 16M0 1iM0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Bucharest|BMT EET EEST|-1I.o -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1xApI.o 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Axc0 On0 1fA0 1a10 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Budapest|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1ip0 17b0 1op0 1tb0 Q2m0 3Ne0 WM0 1fA0 1cM0 1cM0 1oJ0 1dc0 1030 1fA0 1cM0 1cM0 1cM0 1cM0 1fA0 1a00 1iM0 1fA0 8Ha0 Rb0 1wN0 Rb0 1BB0 Lz0 1C20 LB0 SNX0 1a10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Busingen|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-19Lc0 11A0 1o00 11A0 1xG10 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Chisinau|CMT BMT EET EEST CEST CET MSK MSD|-1T -1I.o -20 -30 -20 -10 -30 -40|0123232323232323232345454676767676767676767623232323232323232323232323232323232323232323232323232323232323232323232323232323232323232323232|-26jdT wGMa.A 20LI.o RA0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 27A0 2en0 39g0 WM0 1fA0 1cM0 V90 1t7z0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1ty0 2bD0 1cM0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Copenhagen|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 Tz0 VuO0 60q0 WM0 1fA0 1cM0 1cM0 1cM0 S00 1HA0 Nc0 1C00 Dc0 1Nc0 Ao0 1h5A0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Gibraltar|GMT BST BDST CET CEST|0 -10 -20 -10 -20|010101010101010101010101010101010101010101010101012121212121010121010101010101010101034343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-2axa0 Rc0 1fA0 14M0 1fc0 1g00 1co0 1dc0 1co0 1oo0 1400 1dc0 19A0 1io0 1io0 WM0 1o00 14o0 1o00 17c0 1io0 17c0 1fA0 1a00 1lc0 17c0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1cM0 1io0 17c0 1fA0 1a00 1io0 17c0 1io0 17c0 1fA0 1a00 1io0 1qM0 Dc0 2Rz0 Dc0 1zc0 Oo0 1zc0 Rc0 1wo0 17c0 1iM0 FA0 xB0 1fA0 1a00 14o0 bb0 LA0 xB0 Rc0 1wo0 11A0 1o00 17c0 1fA0 1a00 1fA0 1cM0 1fA0 1a00 17c0 1fA0 1a00 1io0 17c0 1lc0 17c0 1fA0 10Jz0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Helsinki|HMT EET EEST|-1D.N -20 -30|0121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-1WuND.N OULD.N 1dA0 1xGq0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Kaliningrad|CET CEST CET CEST MSK MSD EEST EET FET|-10 -20 -20 -30 -30 -40 -30 -20 -30|0101010101010232454545454545454545454676767676767676767676767676767676767676787|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 Am0 Lb0 1en0 op0 1pNz0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1cJ0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Europe/Kiev|KMT EET MSK CEST CET MSD EEST|-22.4 -20 -30 -20 -10 -40 -30|0123434252525252525252525256161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc22.4 eUo2.4 rnz0 2Hg0 WM0 1fA0 da0 1v4m0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 Db0 3220 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Lisbon|LMT WET WEST WEMT CET CEST|A.J 0 -10 -20 -10 -20|012121212121212121212121212121212121212121212321232123212321212121212121212121212121212121212121214121212121212121212121212121212124545454212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ldXn.f aPWn.f Sp0 LX0 1vc0 Tc0 1uM0 SM0 1vc0 Tc0 1vc0 SM0 1vc0 6600 1co0 3E00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 3I00 17c0 1cM0 1cM0 3Fc0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 1tA0 1cM0 1dc0 1400 gL0 IM0 s10 U00 dX0 Rc0 pd0 Rc0 gL0 Oo0 pd0 Rc0 gL0 Oo0 pd0 14o0 1cM0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 3Co0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 pvy0 1cM0 1cM0 1fA0 1cM0 1cM0 1cN0 1cL0 1cN0 1cM0 1cM0 1cM0 1cM0 1cN0 1cL0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Luxembourg|LMT CET CEST WET WEST WEST WET|-o.A -10 -20 0 -10 -20 -10|0121212134343434343434343434343434343434343434343434565651212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2DG0o.A t6mo.A TB0 1nX0 Up0 1o20 11A0 rW0 CM0 1qP0 R90 1EO0 UK0 1u20 10m0 1ip0 1in0 17e0 19W0 1fB0 1db0 1cp0 1in0 17d0 1fz0 1a10 1in0 1a10 1in0 17f0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Dc0 vA0 60L0 WM0 1fA0 1cM0 17c0 1io0 16M0 1C00 Uo0 1eeo0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Madrid|WET WEST WEMT CET CEST|0 -10 -20 -10 -20|01010101010101010101010121212121234343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343|-28dd0 11A0 1go0 19A0 1co0 1dA0 b1A0 18o0 3I00 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 iyo0 Rc0 18o0 1hc0 1io0 1a00 14o0 5aL0 MM0 1vc0 17A0 1i00 1bc0 1eo0 17d0 1in0 17A0 6hA0 10N0 XIL0 1a10 1in0 17d0 19X0 1cN0 1fz0 1a10 1fX0 1cp0 1cO0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Malta|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2as10 M00 1cM0 1cM0 14o0 1o00 WM0 1qM0 17c0 1cM0 M3A0 5M20 WM0 1fA0 1cM0 1cM0 1cM0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 Lz0 1C10 Lz0 1EN0 Lz0 1C10 Lz0 1zd0 Oo0 1C00 On0 1cp0 1cM0 1lA0 Xc0 1qq0 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1o10 11z0 1iN0 19z0 1fB0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Minsk|MMT EET MSK CEST CET MSD EEST FET|-1O -20 -30 -20 -10 -40 -30 -30|012343432525252525252525252616161616161616161616161616161616161616172|-1Pc1O eUnO qNX0 3gQ0 WM0 1fA0 1cM0 Al0 1tsn0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 3Fc0 1cN0 1cK0 1cM0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hy0","Europe/Monaco|PMT WET WEST WEMT CET CEST|-9.l 0 -10 -20 -10 -20|01212121212121212121212121212121212121212121212121232323232345454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-2nco9.l cNb9.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 2RV0 11z0 11B0 1ze0 WM0 1fA0 1cM0 1fa0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Moscow|MMT MMT MST MDST MSD MSK MSM EET EEST MSK|-2u.h -2v.j -3v.j -4v.j -40 -30 -50 -20 -30 -40|012132345464575454545454545454545458754545454545454545454545454545454545454595|-2ag2u.h 2pyW.W 1bA0 11X0 GN0 1Hb0 c20 imv.j 3DA0 dz0 15A0 c10 2q10 iM10 23CL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 IM0 rU0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Europe/Paris|PMT WET WEST CEST CET WEMT|-9.l 0 -10 -20 -10 -20|0121212121212121212121212121212121212121212121212123434352543434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434343434|-2nco8.l cNb8.l HA0 19A0 1iM0 11c0 1oo0 Wo0 1rc0 QM0 1EM0 UM0 1u00 10o0 1io0 1wo0 Rc0 1a00 1fA0 1cM0 1cM0 1io0 17c0 1fA0 1a00 1io0 1a00 1io0 17c0 1fA0 1a00 1io0 17c0 1cM0 1cM0 1a00 1io0 1cM0 1cM0 1a00 1fA0 1io0 17c0 1cM0 1cM0 1a00 1fA0 1io0 1qM0 Df0 Ik0 5M30 WM0 1fA0 1cM0 Vx0 hB0 1aq0 16M0 1ekn0 1cL0 1fC0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Riga|RMT LST EET MSK CEST CET MSD EEST|-1A.y -2A.y -20 -30 -20 -10 -40 -30|010102345454536363636363636363727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272727272|-25TzA.y 11A0 1iM0 ko0 gWm0 yDXA.y 2bX0 3fE0 WM0 1fA0 1cM0 1cM0 4m0 1sLy0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1o00 11A0 1o00 11A0 1qM0 3oo0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Rome|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2as10 M00 1cM0 1cM0 14o0 1o00 WM0 1qM0 17c0 1cM0 M3A0 5M20 WM0 1fA0 1cM0 16K0 1iO0 16m0 1de0 1lc0 14m0 1lc0 WO0 1qM0 GTW0 On0 1C10 Lz0 1C10 Lz0 1EN0 Lz0 1C10 Lz0 1zd0 Oo0 1C00 On0 1C10 Lz0 1zd0 On0 1C10 LA0 1C00 LA0 1zc0 Oo0 1C00 Oo0 1zc0 Oo0 1fC0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Samara|LMT SAMT SAMT KUYT KUYST MSD MSK EEST KUYT SAMST SAMST|-3k.k -30 -40 -40 -50 -40 -30 -30 -30 -50 -40|012343434343434343435656782929292929292929292929292929292929292a12|-22WNk.k qHak.k bcn0 1Qqo0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cN0 8o0 14j0 1cL0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qN0 WM0","Europe/Simferopol|SMT EET MSK CEST CET MSD EEST MSK|-2g -20 -30 -20 -10 -40 -30 -40|012343432525252525252525252161616525252616161616161616161616161616161616172|-1Pc2g eUog rEn0 2qs0 WM0 1fA0 1cM0 3V0 1u0L0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 4eL0 1cL0 1cN0 1cL0 1cN0 dX0 WL0 1cN0 1cL0 1fB0 1o30 11B0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11z0 1nW0","Europe/Sofia|EET CET CEST EEST|-20 -10 -20 -30|01212103030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030|-168L0 WM0 1fA0 1cM0 1cM0 1cN0 1mKH0 1dd0 1fb0 1ap0 1fb0 1a20 1fy0 1a30 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cK0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 1nX0 11E0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Stockholm|CET CEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2azC0 TB0 2yDe0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Tallinn|TMT CET CEST EET MSK MSD EEST|-1D -10 -20 -20 -30 -40 -30|012103421212454545454545454546363636363636363636363636363636363636363636363636363636363636363636363636363636363636363636363|-26oND teD 11A0 1Ta0 4rXl KSLD 2FX0 2Jg0 WM0 1fA0 1cM0 18J0 1sTX0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o10 11A0 1qM0 5QM0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Tirane|LMT CET CEST|-1j.k -10 -20|01212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2glBj.k 14pcj.k 5LC0 WM0 4M0 1fCK0 10n0 1op0 11z0 1pd0 11z0 1qN0 WL0 1qp0 Xb0 1qp0 Xb0 1qp0 11z0 1lB0 11z0 1qN0 11z0 1iN0 16n0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Uzhgorod|CET CEST MSK MSD EET EEST|-10 -20 -30 -40 -20 -30|010101023232323232323232320454545454545454545454545454545454545454545454545454545454545454545454545454545454545454545454|-1cqL0 6i00 WM0 1fA0 1cM0 1ml0 1Cp0 1r3W0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1Q00 1Nf0 2pw0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Vienna|CET CEST|-10 -20|0101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 3KM0 14o0 LA00 6i00 WM0 1fA0 1cM0 1cM0 1cM0 400 2qM0 1a00 1cM0 1cM0 1io0 17c0 1gHa0 19X0 1cP0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Vilnius|WMT KMT CET EET MSK CEST MSD EEST|-1o -1z.A -10 -20 -30 -20 -40 -30|012324525254646464646464646464647373737373737352537373737373737373737373737373737373737373737373737373737373737373737373|-293do 6ILM.o 1Ooz.A zz0 Mfd0 29W0 3is0 WM0 1fA0 1cM0 LV0 1tgL0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11B0 1o00 11A0 1qM0 8io0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Volgograd|LMT TSAT STAT STAT VOLT VOLST VOLST VOLT MSK MSK|-2V.E -30 -30 -40 -40 -50 -40 -30 -40 -30|012345454545454545454676748989898989898989898989898989898989898989|-21IqV.E cLXV.E cEM0 1gqn0 Lco0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1fA0 1cM0 2pz0 1cJ0 1cQ0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 8Hz0","Europe/Warsaw|WMT CET CEST EET EEST|-1o -10 -20 -20 -30|012121234312121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121|-2ctdo 1LXo 11d0 1iO0 11A0 1o00 11A0 1on0 11A0 6zy0 HWP0 5IM0 WM0 1fA0 1cM0 1dz0 1mL0 1en0 15B0 1aq0 1nA0 11A0 1io0 17c0 1fA0 1a00 iDX0 LA0 1cM0 1cM0 1C00 Oo0 1cM0 1cM0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1C00 LA0 uso0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cN0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","Europe/Zaporozhye|CUT EET MSK CEST CET MSD EEST|-2k -20 -30 -20 -10 -40 -30|01234342525252525252525252526161616161616161616161616161616161616161616161616161616161616161616161616161616161616161616161|-1Pc2k eUok rdb0 2RE0 WM0 1fA0 8m0 1v9a0 1db0 1cN0 1db0 1cN0 1db0 1dd0 1cO0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cK0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cQ0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","HST|HST|a0|0|","Indian/Chagos|LMT IOT IOT|-4N.E -50 -60|012|-2xosN.E 3AGLN.E","Indian/Christmas|CXT|-70|0|","Indian/Cocos|CCT|-6u|0|","Indian/Kerguelen|zzz TFT|0 -50|01|-MG00","Indian/Mahe|LMT SCT|-3F.M -40|01|-2yO3F.M","Indian/Maldives|MMT MVT|-4S -50|01|-olgS","Indian/Mauritius|LMT MUT MUST|-3O -40 -50|012121|-2xorO 34unO 14L0 12kr0 11z0","Indian/Reunion|LMT RET|-3F.Q -40|01|-2mDDF.Q","Kwajalein|MHT KWAT MHT|-b0 c0 -c0|012|-AX0 W9X0","MET|MET MEST|-10 -20|01010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-2aFe0 11d0 1iO0 11A0 1o00 11A0 Qrc0 6i00 WM0 1fA0 1cM0 1cM0 1cM0 16M0 1gMM0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00","MST|MST|70|0|","MST7MDT|MST MDT MWT MPT|70 60 60 60|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261r0 1nX0 11B0 1nX0 SgN0 8x20 ix0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","NZ-CHAT|CHAST CHAST CHADT|-cf -cJ -dJ|012121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212121212|-WqAf 1adef IM0 1C00 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Oo0 1zc0 Rc0 1zc0 Oo0 1qM0 14o0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1lc0 14o0 1lc0 14o0 1lc0 17c0 1io0 17c0 1io0 17c0 1io0 17c0 1io0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","PST8PDT|PST PDT PWT PPT|80 70 70 70|010102301010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|-261q0 1nX0 11B0 1nX0 SgN0 8x10 iy0 QwN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1cN0 1cL0 1cN0 1cL0 s10 1Vz0 LB0 1BX0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1fz0 1a10 1fz0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 14p0 1lb0 14p0 1lb0 14p0 1nX0 11B0 1nX0 11B0 1nX0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Rd0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0 Op0 1zb0","Pacific/Apia|LMT WSST SST SDT WSDT WSST|bq.U bu b0 a0 -e0 -d0|01232345454545454545454545454545454545454545454545454545454|-2nDMx.4 1yW03.4 2rRbu 1ff0 1a00 CI0 AQ0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1io0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1a00 1fA0 1cM0 1fA0 1a00 1fA0 1a00","Pacific/Bougainville|PGT JST BST|-a0 -90 -b0|0102|-16Wy0 7CN0 2MQp0","Pacific/Chuuk|CHUT|-a0|0|","Pacific/Efate|LMT VUT VUST|-bd.g -b0 -c0|0121212121212121212121|-2l9nd.g 2Szcd.g 1cL0 1oN0 10L0 1fB0 19X0 1fB0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1cN0 1cL0 1fB0 Lz0 1Nd0 An0","Pacific/Enderbury|PHOT PHOT PHOT|c0 b0 -d0|012|nIc0 B8n0","Pacific/Fakaofo|TKT TKT|b0 -d0|01|1Gfn0","Pacific/Fiji|LMT FJT FJST|-bT.I -c0 -d0|012121212121212121212121212121212121212121212121212121212121212|-2bUzT.I 3m8NT.I LA0 1EM0 IM0 nJc0 LA0 1o00 Rc0 1wo0 Ao0 1Nc0 Ao0 1Q00 xz0 1SN0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 xA0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1VA0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0 uM0 1SM0","Pacific/Funafuti|TVT|-c0|0|","Pacific/Galapagos|LMT ECT GALT|5W.o 50 60|012|-1yVS1.A 2dTz1.A","Pacific/Gambier|LMT GAMT|8X.M 90|01|-2jof0.c","Pacific/Guadalcanal|LMT SBT|-aD.M -b0|01|-2joyD.M","Pacific/Guam|GST ChST|-a0 -a0|01|1fpq0","Pacific/Honolulu|HST HDT HST|au 9u a0|010102|-1thLu 8x0 lef0 8Pz0 46p0","Pacific/Kiritimati|LINT LINT LINT|aE a0 -e0|012|nIaE B8nk","Pacific/Kosrae|KOST KOST|-b0 -c0|010|-AX0 1bdz0","Pacific/Majuro|MHT MHT|-b0 -c0|01|-AX0","Pacific/Marquesas|LMT MART|9i 9u|01|-2joeG","Pacific/Midway|NST NDT BST SST|b0 a0 b0 b0|01023|-x3N0 An0 pJd0 EyM0","Pacific/Nauru|LMT NRT JST NRT|-b7.E -bu -90 -c0|01213|-1Xdn7.E PvzB.E 5RCu 1ouJu","Pacific/Niue|NUT NUT NUT|bk bu b0|012|-KfME 17y0a","Pacific/Norfolk|NMT NFT|-bc -bu|01|-Kgbc","Pacific/Noumea|LMT NCT NCST|-b5.M -b0 -c0|01212121|-2l9n5.M 2EqM5.M xX0 1PB0 yn0 HeP0 Ao0","Pacific/Pago_Pago|LMT NST BST SST|bm.M b0 b0 b0|0123|-2nDMB.c 2gVzB.c EyM0","Pacific/Palau|PWT|-90|0|","Pacific/Pitcairn|PNT PST|8u 80|01|18Vku","Pacific/Pohnpei|PONT|-b0|0|","Pacific/Port_Moresby|PGT|-a0|0|","Pacific/Rarotonga|CKT CKHST CKT|au 9u a0|012121212121212121212121212|lyWu IL0 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Onu 1zcu Rbu 1zcu Onu 1zcu Onu 1zcu Onu","Pacific/Saipan|MPT MPT ChST|-90 -a0 -a0|012|-AV0 1g2n0","Pacific/Tahiti|LMT TAHT|9W.g a0|01|-2joe1.I","Pacific/Tarawa|GILT|-c0|0|","Pacific/Tongatapu|TOT TOT TOST|-ck -d0 -e0|01212121|-1aB0k 2n5dk 15A0 1wo0 xz0 1Q10 xz0","Pacific/Wake|WAKT|-c0|0|","Pacific/Wallis|WFT|-c0|0|","WET|WET WEST|0 -10|010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010101010|hDB0 1a00 1fA0 1cM0 1cM0 1cM0 1fA0 1a00 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1cM0 1fA0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00 11A0 1qM0 WM0 1qM0 WM0 1qM0 WM0 1qM0 11A0 1o00 11A0 1o00"],
links:["Africa/Abidjan|Africa/Bamako","Africa/Abidjan|Africa/Banjul","Africa/Abidjan|Africa/Conakry","Africa/Abidjan|Africa/Dakar","Africa/Abidjan|Africa/Freetown","Africa/Abidjan|Africa/Lome","Africa/Abidjan|Africa/Nouakchott","Africa/Abidjan|Africa/Ouagadougou","Africa/Abidjan|Africa/Sao_Tome","Africa/Abidjan|Africa/Timbuktu","Africa/Abidjan|Atlantic/St_Helena","Africa/Addis_Ababa|Africa/Asmara","Africa/Addis_Ababa|Africa/Asmera","Africa/Addis_Ababa|Africa/Dar_es_Salaam","Africa/Addis_Ababa|Africa/Djibouti","Africa/Addis_Ababa|Africa/Kampala","Africa/Addis_Ababa|Africa/Mogadishu","Africa/Addis_Ababa|Africa/Nairobi","Africa/Addis_Ababa|Indian/Antananarivo","Africa/Addis_Ababa|Indian/Comoro","Africa/Addis_Ababa|Indian/Mayotte","Africa/Bangui|Africa/Brazzaville","Africa/Bangui|Africa/Douala","Africa/Bangui|Africa/Kinshasa","Africa/Bangui|Africa/Lagos","Africa/Bangui|Africa/Libreville","Africa/Bangui|Africa/Luanda","Africa/Bangui|Africa/Malabo","Africa/Bangui|Africa/Niamey","Africa/Bangui|Africa/Porto-Novo","Africa/Blantyre|Africa/Bujumbura","Africa/Blantyre|Africa/Gaborone","Africa/Blantyre|Africa/Harare","Africa/Blantyre|Africa/Kigali","Africa/Blantyre|Africa/Lubumbashi","Africa/Blantyre|Africa/Lusaka","Africa/Blantyre|Africa/Maputo","Africa/Cairo|Egypt","Africa/Johannesburg|Africa/Maseru","Africa/Johannesburg|Africa/Mbabane","Africa/Juba|Africa/Khartoum","Africa/Tripoli|Libya","America/Adak|America/Atka","America/Adak|US/Aleutian","America/Anchorage|US/Alaska","America/Anguilla|America/Dominica","America/Anguilla|America/Grenada","America/Anguilla|America/Guadeloupe","America/Anguilla|America/Marigot","America/Anguilla|America/Montserrat","America/Anguilla|America/Port_of_Spain","America/Anguilla|America/St_Barthelemy","America/Anguilla|America/St_Kitts","America/Anguilla|America/St_Lucia","America/Anguilla|America/St_Thomas","America/Anguilla|America/St_Vincent","America/Anguilla|America/Tortola","America/Anguilla|America/Virgin","America/Argentina/Buenos_Aires|America/Buenos_Aires","America/Argentina/Catamarca|America/Argentina/ComodRivadavia","America/Argentina/Catamarca|America/Catamarca","America/Argentina/Cordoba|America/Cordoba","America/Argentina/Cordoba|America/Rosario","America/Argentina/Jujuy|America/Jujuy","America/Argentina/Mendoza|America/Mendoza","America/Aruba|America/Curacao","America/Aruba|America/Kralendijk","America/Aruba|America/Lower_Princes","America/Atikokan|America/Coral_Harbour","America/Chicago|US/Central","America/Denver|America/Shiprock","America/Denver|Navajo","America/Denver|US/Mountain","America/Detroit|US/Michigan","America/Edmonton|Canada/Mountain","America/Ensenada|America/Tijuana","America/Ensenada|Mexico/BajaNorte","America/Fort_Wayne|America/Indiana/Indianapolis","America/Fort_Wayne|America/Indianapolis","America/Fort_Wayne|US/East-Indiana","America/Halifax|Canada/Atlantic","America/Havana|Cuba","America/Indiana/Knox|America/Knox_IN","America/Indiana/Knox|US/Indiana-Starke","America/Jamaica|Jamaica","America/Kentucky/Louisville|America/Louisville","America/Los_Angeles|US/Pacific","America/Los_Angeles|US/Pacific-New","America/Manaus|Brazil/West","America/Mazatlan|Mexico/BajaSur","America/Mexico_City|Mexico/General","America/New_York|US/Eastern","America/Noronha|Brazil/DeNoronha","America/Phoenix|US/Arizona","America/Porto_Acre|America/Rio_Branco","America/Porto_Acre|Brazil/Acre","America/Regina|Canada/East-Saskatchewan","America/Regina|Canada/Saskatchewan","America/Santiago|Chile/Continental","America/Sao_Paulo|Brazil/East","America/St_Johns|Canada/Newfoundland","America/Toronto|Canada/Eastern","America/Vancouver|Canada/Pacific","America/Whitehorse|Canada/Yukon","America/Winnipeg|Canada/Central","Antarctica/McMurdo|Antarctica/South_Pole","Antarctica/McMurdo|NZ","Antarctica/McMurdo|Pacific/Auckland","Arctic/Longyearbyen|Atlantic/Jan_Mayen","Arctic/Longyearbyen|Europe/Oslo","Asia/Ashgabat|Asia/Ashkhabad","Asia/Bangkok|Asia/Phnom_Penh","Asia/Bangkok|Asia/Vientiane","Asia/Calcutta|Asia/Kolkata","Asia/Chongqing|Asia/Chungking","Asia/Chongqing|Asia/Harbin","Asia/Chongqing|Asia/Shanghai","Asia/Chongqing|PRC","Asia/Dacca|Asia/Dhaka","Asia/Ho_Chi_Minh|Asia/Saigon","Asia/Hong_Kong|Hongkong","Asia/Istanbul|Europe/Istanbul","Asia/Istanbul|Turkey","Asia/Jerusalem|Asia/Tel_Aviv","Asia/Jerusalem|Israel","Asia/Kashgar|Asia/Urumqi","Asia/Kathmandu|Asia/Katmandu","Asia/Macao|Asia/Macau","Asia/Makassar|Asia/Ujung_Pandang","Asia/Nicosia|Europe/Nicosia","Asia/Seoul|ROK","Asia/Singapore|Singapore","Asia/Taipei|ROC","Asia/Tehran|Iran","Asia/Thimbu|Asia/Thimphu","Asia/Tokyo|Japan","Asia/Ulaanbaatar|Asia/Ulan_Bator","Atlantic/Faeroe|Atlantic/Faroe","Atlantic/Reykjavik|Iceland","Australia/ACT|Australia/Canberra","Australia/ACT|Australia/NSW","Australia/ACT|Australia/Sydney","Australia/Adelaide|Australia/South","Australia/Brisbane|Australia/Queensland","Australia/Broken_Hill|Australia/Yancowinna","Australia/Darwin|Australia/North","Australia/Hobart|Australia/Tasmania","Australia/LHI|Australia/Lord_Howe","Australia/Melbourne|Australia/Victoria","Australia/Perth|Australia/West","Chile/EasterIsland|Pacific/Easter","Eire|Europe/Dublin","Etc/GMT+0|Etc/GMT","Etc/GMT+0|Etc/GMT-0","Etc/GMT+0|Etc/GMT0","Etc/GMT+0|Etc/Greenwich","Etc/GMT+0|GMT","Etc/GMT+0|GMT+0","Etc/GMT+0|GMT-0","Etc/GMT+0|GMT0","Etc/GMT+0|Greenwich","Etc/UCT|UCT","Etc/UTC|Etc/Universal","Etc/UTC|Etc/Zulu","Etc/UTC|UTC","Etc/UTC|Universal","Etc/UTC|Zulu","Europe/Belfast|Europe/Guernsey","Europe/Belfast|Europe/Isle_of_Man","Europe/Belfast|Europe/Jersey","Europe/Belfast|Europe/London","Europe/Belfast|GB","Europe/Belfast|GB-Eire","Europe/Belgrade|Europe/Ljubljana","Europe/Belgrade|Europe/Podgorica","Europe/Belgrade|Europe/Sarajevo","Europe/Belgrade|Europe/Skopje","Europe/Belgrade|Europe/Zagreb","Europe/Bratislava|Europe/Prague","Europe/Busingen|Europe/Vaduz","Europe/Busingen|Europe/Zurich","Europe/Chisinau|Europe/Tiraspol","Europe/Helsinki|Europe/Mariehamn","Europe/Lisbon|Portugal","Europe/Moscow|W-SU","Europe/Rome|Europe/San_Marino","Europe/Rome|Europe/Vatican","Europe/Warsaw|Poland","Kwajalein|Pacific/Kwajalein","NZ-CHAT|Pacific/Chatham","Pacific/Chuuk|Pacific/Truk","Pacific/Chuuk|Pacific/Yap","Pacific/Honolulu|Pacific/Johnston","Pacific/Honolulu|US/Hawaii","Pacific/Pago_Pago|Pacific/Samoa","Pacific/Pago_Pago|US/Samoa","Pacific/Pohnpei|Pacific/Ponape"]}),function(){var Ext=window.Ext4||window.Ext;Ext.override(Deft.Logger,{log:function(message,priority){"error"===priority&&Ext.global.console&&(Ext.global.console.error(message),Rally&&Rally.environment&&Rally.environment.getMessageBus().publish(Rally.clientmetrics.Message.error,new Error(message.split("\n")[0])))}})}(),function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.RallyMetrics=factory():root.RallyMetrics=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _aggregator=__webpack_require__(1),_aggregator2=_interopRequireDefault(_aggregator),_windowErrorListener=__webpack_require__(6),_windowErrorListener2=_interopRequireDefault(_windowErrorListener);module.exports={Aggregator:_aggregator2.default,WindowErrorListener:_windowErrorListener2.default}},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getRallyRequestId=void 0;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_corsBatchSender=__webpack_require__(2),_corsBatchSender2=_interopRequireDefault(_corsBatchSender),_util=__webpack_require__(3),_uuid=__webpack_require__(4),_uuid2=_interopRequireDefault(_uuid),DEFAULT_ERROR_LIMIT=25,DEFAULT_STACK_LIMIT=10,_currentEventId="__clientMetricsCurrentEventId__",_metricsIdProperty="__clientMetricsID__",WEBSERVICE_SLUG="webservice/",getUniqueId=function(){return _uuid2.default.v4()},getUrl=function(url){if(!url)return"unknown";var webserviceIndex=url.indexOf(WEBSERVICE_SLUG),questionIndex=void 0;if(webserviceIndex!==-1){questionIndex=url.indexOf("?",webserviceIndex),questionIndex===-1&&(questionIndex=url.length);var skip=WEBSERVICE_SLUG.length;return url.substring(webserviceIndex+skip,questionIndex)}return questionIndex=url.indexOf("?"),questionIndex===-1?url:url.substring(0,questionIndex)},getComponentId=function(cmp){return cmp[_metricsIdProperty]||(cmp[_metricsIdProperty]=getUniqueId()),cmp[_metricsIdProperty]},getRallyRequestId=exports.getRallyRequestId=function(response){var headerName="RallyRequestID";if(response){if("string"==typeof response)return response;if(response.responseHeaders&&response.responseHeaders.RallyRequestID)return response.responseHeaders.RallyRequestID;if("function"==typeof response.getResponseHeader)return response.getResponseHeader(headerName);if(response.getResponseHeader&&response.getResponseHeader[headerName])return response.getResponseHeader[headerName];if("function"==typeof response.headers)return response.headers(headerName)}},Aggregator=function(){function Aggregator(config){var _this=this;_classCallCheck(this,Aggregator),(0,_util.assign)(this,config),this._pendingEvents=[],this._browserTabId=getUniqueId(),this._startingTime=Date.now(),this._currentTraceId=null,this._errorCount=0,this.errorLimit=this.errorLimit||DEFAULT_ERROR_LIMIT,this.stackLimit=this.stackLimit||DEFAULT_STACK_LIMIT,this.handlers=this.handlers||[],this.sender=this.sender||new _corsBatchSender2.default({keysToIgnore:["cmp","component"],beaconUrl:config.beaconUrl,disableSending:config.disableSending}),"function"==typeof this.sender.getMaxLength&&(this.maxErrorLength=Math.floor(.9*this.sender.getMaxLength())),this.flushInterval&&(this._flushIntervalId=window.setInterval(function(){return _this.sendAllRemainingEvents()},this.flushInterval))}return _createClass(Aggregator,[{key:"destroy",value:function(){this._flushIntervalId&&window.clearInterval(this._flushIntervalId)}},{key:"startSession",value:function(status,defaultParams){arguments.length<2&&(defaultParams=status),this._pendingEvents=[],defaultParams&&defaultParams.sessionStart&&(this._startingTime=defaultParams.sessionStart),this._sessionStartTime=this.getRelativeTime(),this.sendAllRemainingEvents(),this._defaultParams=(0,_util.omit)(defaultParams,"sessionStart"),this._errorCount=0,delete this._actionStartTime}},{key:"recordAction",value:function(options){var cmp=options.component;delete options.component;var traceId=getUniqueId();this._actionStartTime=this.getRelativeTime(options.startTime);var action=this._startEvent((0,_util.assign)({eType:"action",cmp:cmp,cmpH:options.hierarchy||this._getHierarchyString(cmp),eDesc:options.description,cmpId:getComponentId(cmp),eId:traceId,tId:traceId,status:"Ready",cmpType:options.name||this.getComponentType(cmp),start:this._actionStartTime,stop:this._actionStartTime},options.miscData));return this._currentTraceId=traceId,this._finishEvent(action),traceId}},{key:"recordError",value:function(e){var miscData=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],error=void 0;error="string"==typeof e?e:e.message,error=error.substring(0,this.maxErrorLength||1/0);var stack=e.stack?e.stack.split("\n").slice(0,this.stackLimit).join("\n"):miscData.stack,traceId=this._currentTraceId;if(traceId&&this._errorCount<this.errorLimit){++this._errorCount;var startTime=this.getRelativeTime(),errorEvent=this._startEvent((0,_util.assign)({},miscData,{error:error,stack:stack,eType:"error",eId:getUniqueId(),tId:traceId,start:startTime,stop:startTime}));this._finishEvent(errorEvent),this.sendAllRemainingEvents()}}},{key:"recordComponentReady",value:function(options){if("undefined"!=typeof this._sessionStartTime&&"undefined"!=typeof this._actionStartTime){var traceId=this._currentTraceId,cmp=options.component,cmpHierarchy=options.hierarchy||this._getHierarchyString(cmp),cmpReadyEvent=this._startEvent((0,_util.assign)({},options.miscData,{eType:"load",start:this._actionStartTime,stop:this.getRelativeTime(options.stopTime),eId:getUniqueId(),tId:traceId,pId:traceId,cmpType:options.name||this.getComponentType(cmp),cmpH:cmpHierarchy,eDesc:"component ready",componentReady:!0}));this._finishEvent(cmpReadyEvent)}}},{key:"startSpan",value:function(options){var _this2=this,cmp=options.component,traceId=this._currentTraceId;if(traceId){var startTime=this.getRelativeTime(options.startTime),eventId=getUniqueId(),event=(0,_util.assign)({},options.miscData,{eType:options.type||"load",cmp:cmp,cmpH:options.hierarchy||this._getHierarchyString(cmp),eId:eventId,cmpType:options.name||this.getComponentType(cmp),tId:traceId,pId:options.pId||traceId,start:startTime});options.description&&(event.eDesc=options.description);var data=this._startEvent(event);return{data:data,end:function(options){if(options=options||{},options.stop=_this2.getRelativeTime(options.stopTime),_this2._shouldRecordEvent(data,options)){var newEventData=(0,_util.assign)({status:"Ready"},(0,_util.omit)(options,"stopTime"));_this2._finishEvent(data,newEventData)}}}}}},{key:"beginLoad",value:function(options){var cmp=options.component,traceId=this._currentTraceId;if(traceId&&!cmp[_currentEventId+"load"]){var startTime=this.getRelativeTime(options.startTime),eventId=getUniqueId();cmp[_currentEventId+"load"]=eventId;var event=(0,_util.assign)({},options.miscData,{eType:"load",cmp:cmp,cmpH:this._getHierarchyString(cmp),eDesc:options.description,cmpId:getComponentId(cmp),eId:eventId,cmpType:this.getComponentType(cmp),tId:traceId,pId:this._findParentId(cmp,traceId),start:startTime});this._startEvent(event)}}},{key:"endLoad",value:function(options){var cmp=options.component,eventId=cmp[_currentEventId+"load"];if(eventId){delete cmp[_currentEventId+"load"];var event=this._findPendingEvent(eventId);if(event&&(options.stop=this.getRelativeTime(options.stopTime),this._shouldRecordEvent(event,options))){var newEventData=(0,_util.assign)({status:"Ready"},(0,_util.omit)(options,"stopTime"));this._finishEvent(event,newEventData)}}}},{key:"beginDataRequest",value:function(requester,url,miscData){var options=void 0,metricsData=void 0;1===arguments.length&&(options=arguments[0],requester=options.requester,url=options.url,miscData=options.miscData);var traceId=this._currentTraceId;if(requester&&traceId){var eventId=getUniqueId(),parentId=this._findParentId(requester,traceId),ajaxRequestId=getUniqueId();requester[_currentEventId+"dataRequest"+ajaxRequestId]=eventId,this._startEvent((0,_util.assign)({},miscData,{eType:"dataRequest",cmp:requester,cmpH:this._getHierarchyString(requester),url:getUrl(url),cmpType:this.getComponentType(requester),cmpId:getComponentId(requester),eId:eventId,tId:traceId,pId:parentId},miscData)),metricsData={requestId:ajaxRequestId,xhrHeaders:{"X-Trace-Id":traceId,"X-Parent-Id":eventId}}}return metricsData}},{key:"endDataRequest",value:function(requester,xhr,requestId){var options=void 0;if(1===arguments.length&&(options=arguments[0],requester=options.requester,xhr=options.xhr,requestId=options.requestId),requester){var eventId=requester[_currentEventId+"dataRequest"+requestId],event=this._findPendingEvent(eventId);if(!event)return;var newEventData={status:"Ready",stop:this.getRelativeTime()},rallyRequestId=getRallyRequestId(xhr);rallyRequestId&&(newEventData.rallyRequestId=rallyRequestId),this._finishEvent(event,newEventData)}}},{key:"sendAllRemainingEvents",value:function(){this.sender.flush()}},{key:"getComponentType",value:function(cmp){return this._getFromHandlers(cmp.singleton||cmp,"getComponentType")}},{key:"getDefaultParams",value:function(){return this._defaultParams}},{key:"getSessionStartTime",value:function(){return this._sessionStartTime}},{key:"getCurrentTraceId",value:function(){return this._currentTraceId}},{key:"addHandler",value:function(handler,index){var insertIndex=2===arguments.length?index:this.handlers.length;this.handlers.splice(insertIndex,0,handler)}},{key:"getRelativeTime",value:function(timestamp){return(timestamp||Date.now())-this._startingTime}},{key:"getUnrelativeTime",value:function(timestamp){return timestamp+this._startingTime}},{key:"_finishEvent",value:function(existingEvent,newEventData){var event=(0,_util.assign)({},existingEvent,newEventData);this._pendingEvents=this._pendingEvents.filter(function(ev){return ev!==existingEvent}),this.sender.send(event)}},{key:"_startEvent",value:function(event){if(event.tabId=this._browserTabId,event.start||(event.start=this.getRelativeTime()),event.bts=this.getUnrelativeTime(event.start),event.cmp){var appName=this._getFromHandlers(event.cmp,"getAppName");appName&&(event.appName=appName)}return this._pendingEvents.push((0,_util.assign)(event,this._defaultParams)),event}},{key:"_getFromHandlers",value:function(cmp,methodName){var result=null;return(0,_util.forEach)(this.handlers,function(handler){return result=handler[methodName](cmp),!result}),result}},{key:"_findParentId",value:function(sourceCmp,traceId){var _this3=this,hierarchy=this._getHierarchy(sourceCmp),eventId=traceId;return(0,_util.forEach)(hierarchy,function(cmp){var parentEvent=_this3._findLastEvent(function(event){return"dataRequest"!==event.eType&&(event.cmp===cmp||event.cmp===sourceCmp)&&event.tId===traceId});if(parentEvent)return eventId=parentEvent.eId,!1}),eventId}},{key:"_getHierarchy",value:function(cmp){for(var cmpType=this.getComponentType(cmp),hierarchy=[];cmpType;)hierarchy.push(cmp),cmp=cmp.clientMetricsParent||cmp.ownerCt||cmp.owner||cmp.initialConfig&&cmp.initialConfig.owner,cmpType=cmp&&this.getComponentType(cmp);return hierarchy}},{key:"_getHierarchyString",value:function(cmp){var _this4=this,hierarchy=this._getHierarchy(cmp);return 0===hierarchy.length?"none":hierarchy.map(function(c){return _this4.getComponentType(c)}).join(":")}},{key:"_findPendingEvent",value:function(eventId){for(var i=0;i<this._pendingEvents.length;i++){var ev=this._pendingEvents[i];if(ev.eId===eventId)return ev}return null}},{key:"_findLastEvent",value:function(predicate){for(var i=this._pendingEvents.length-1;i>=0;i--){var ev=this._pendingEvents[i];if(predicate(ev))return ev}return null}},{key:"_shouldRecordEvent",value:function(existingEvent,options){return!(options.whenLongerThan&&options.stop-existingEvent.start<=options.whenLongerThan)||(this._pendingEvents=this._pendingEvents.filter(function(ev){return ev!==existingEvent}),!1)}}]),Aggregator}();exports.default=Aggregator},function(module,exports,__webpack_require__){"use strict";function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_util=__webpack_require__(3),MIN_NUMBER_OF_EVENTS=25,MAX_NUMBER_OF_EVENTS=100,appendIndexToKeys=function(event,index){return Object.keys(event).reduce(function(result,key){return result[key+"."+index]=""+event[key],result},{})},CorsBatchSender=function(){function CorsBatchSender(config){_classCallCheck(this,CorsBatchSender),(0,_util.assign)(this,{_disabled:!1,keysToIgnore:[],minNumberOfEvents:MIN_NUMBER_OF_EVENTS,maxNumberOfEvents:MAX_NUMBER_OF_EVENTS,beaconUrl:"https://trust.f4tech.com/beacon/"},config),this.disableSending&&this._disableClientMetrics(),this._eventQueue=[]}return _createClass(CorsBatchSender,[{key:"send",value:function(event){this._eventQueue.push(event),this._sendBatches()}},{key:"flush",value:function(){this._sendBatches({flush:!0})}},{key:"getPendingEvents",value:function(){return this._eventQueue}},{key:"getMaxLength",value:function(){return this.maxLength}},{key:"_sendBatches",value:function(options){for(var nextBatch=this._getNextBatch(options);nextBatch;)this._sendBatch(nextBatch),nextBatch=this._getNextBatch(options)}},{key:"_getNextBatch",value:function(){var options=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],toBeSent=this._eventQueue.slice(0,this.maxNumberOfEvents);if(toBeSent.length&&(toBeSent.length>=this.minNumberOfEvents||options.flush))return toBeSent}},{key:"_sendBatch",value:function(batch){this._disabled||this._makePOST(batch),this._eventQueue=this._eventQueue.filter(function(ev){return batch.indexOf(ev)===-1})}},{key:"_getUrl",value:function(){return this.beaconUrl}},{key:"_disableClientMetrics",value:function(){this._disabled=!0}},{key:"isDisabled",value:function(){return this._disabled}},{key:"_makePOST",value:function(events){var _this=this,data=events.reduce(function(data,event,index){var eventToSend=appendIndexToKeys(_util.omit.apply(void 0,[event].concat(_toConsumableArray(_this.keysToIgnore))),index);return(0,_util.assign)({},data,eventToSend)},{});try{!function(){var xhr=(0,_util.createCorsXhr)("POST",_this.beaconUrl);xhr?(xhr.onerror=_this._disableClientMetrics.bind(_this),setTimeout(function(){return xhr.send(JSON.stringify(data))},0)):_this._disableClientMetrics()}()}catch(e){this._disableClientMetrics()}}}]),CorsBatchSender}();exports.default=CorsBatchSender},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},emptyFn=function(){},keys=(exports.createCorsXhr=function(method,url){var xhr=new XMLHttpRequest;return"withCredentials"in xhr?(xhr.open(method,url,!0),xhr.setRequestHeader("Content-type","application/json; charset=utf-8")):"undefined"!=typeof XDomainRequest?(xhr=new XDomainRequest,xhr.onload=emptyFn,xhr.onprogress=emptyFn,xhr.ontimeout=emptyFn,xhr.open(method,url)):xhr=null,xhr},exports.omit=function(obj){for(var _len=arguments.length,fields=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)fields[_key-1]=arguments[_key];return obj?keys(obj).reduce(function(acc,key){return fields.indexOf(key)===-1&&(acc[key]=obj[key]),acc},{}):{}},exports.assign=function(dest){for(var _len2=arguments.length,sources=Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)sources[_key2-1]=arguments[_key2];return sources.forEach(function(source){"object"===("undefined"==typeof source?"undefined":_typeof(source))&&keys(source).forEach(function(key){dest[key]=source[key]})}),dest},exports.keys=function keys(obj){var keys=[];for(var key in obj)obj.hasOwnProperty(key)&&keys.push(key);return keys});exports.forEach=function(arr,fn){for(var i=0;i<arr.length;i++){var result=fn(arr[i]);if(result===!1)return}}},function(module,exports,__webpack_require__){function parse(s,buf,offset){var i=buf&&offset||0,ii=0;for(buf=buf||[],s.toLowerCase().replace(/[0-9a-f]{2}/g,function(oct){ii<16&&(buf[i+ii++]=_hexToByte[oct])});ii<16;)buf[i+ii++]=0;return buf}function unparse(buf,offset){var i=offset||0,bth=_byteToHex;return bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+"-"+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]+bth[buf[i++]]}function v1(options,buf,offset){var i=buf&&offset||0,b=buf||[];options=options||{};var clockseq=void 0!==options.clockseq?options.clockseq:_clockseq,msecs=void 0!==options.msecs?options.msecs:(new Date).getTime(),nsecs=void 0!==options.nsecs?options.nsecs:_lastNSecs+1,dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&void 0===options.clockseq&&(clockseq=clockseq+1&16383),(dt<0||msecs>_lastMSecs)&&void 0===options.nsecs&&(nsecs=0),nsecs>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=msecs,_lastNSecs=nsecs,_clockseq=clockseq,msecs+=122192928e5;var tl=(1e4*(268435455&msecs)+nsecs)%4294967296;b[i++]=tl>>>24&255,b[i++]=tl>>>16&255,b[i++]=tl>>>8&255,b[i++]=255&tl;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255,b[i++]=255&tmh,b[i++]=tmh>>>24&15|16,b[i++]=tmh>>>16&255,b[i++]=clockseq>>>8|128,b[i++]=255&clockseq;for(var node=options.node||_nodeId,n=0;n<6;n++)b[i+n]=node[n];return buf?buf:unparse(b)}function v4(options,buf,offset){var i=buf&&offset||0;"string"==typeof options&&(buf="binary"==options?new Array(16):null,options=null),options=options||{};var rnds=options.random||(options.rng||_rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf)for(var ii=0;ii<16;ii++)buf[i+ii]=rnds[ii];return buf||unparse(rnds)}for(var _rng=__webpack_require__(5),_byteToHex=[],_hexToByte={},i=0;i<256;i++)_byteToHex[i]=(i+256).toString(16).substr(1),_hexToByte[_byteToHex[i]]=i;var _seedBytes=_rng(),_nodeId=[1|_seedBytes[0],_seedBytes[1],_seedBytes[2],_seedBytes[3],_seedBytes[4],_seedBytes[5]],_clockseq=16383&(_seedBytes[6]<<8|_seedBytes[7]),_lastMSecs=0,_lastNSecs=0,uuid=v4;uuid.v1=v1,uuid.v4=v4,uuid.parse=parse,uuid.unparse=unparse,module.exports=uuid},function(module,exports){(function(global){var rng;if(global.crypto&&crypto.getRandomValues){var _rnds8=new Uint8Array(16);rng=function(){return crypto.getRandomValues(_rnds8),_rnds8}}if(!rng){var _rnds=new Array(16);rng=function(){for(var r,i=0;i<16;i++)0===(3&i)&&(r=4294967296*Math.random()),_rnds[i]=r>>>((3&i)<<3)&255;return _rnds}}module.exports=rng}).call(exports,function(){return this}())},function(module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),ErrorListener=function(){function ErrorListener(aggregator,supportsOnError,config){_classCallCheck(this,ErrorListener),this.aggregator=aggregator,this._stackLimit=null,config&&config.stackLimit&&(this._stackLimit=parseInt(config.stackLimit,10)),this._originalWindowOnError=window.onerror,window.onerror=this._onWindowError.bind(this)}return _createClass(ErrorListener,[{key:"_onWindowError",value:function(msg,filename,lineno,colno,errorObject){if(errorObject&&errorObject.message)return this.aggregator.recordError(errorObject);"function"==typeof this._originalWindowOnError&&this._originalWindowOnError.call(window,msg,filename,lineno);var colIsNumber=!!colno,message=msg||"unknown message",file=filename||"??",lineNumber=lineno?":"+lineno:"",columnNumber=colIsNumber?":"+colno:"",errorInfo=message+", "+file+lineNumber+columnNumber,miscData={};colIsNumber&&(miscData.columnNumber=colno),errorObject&&errorObject.stack&&(miscData.stack=errorObject.stack,this._stackLimit&&(miscData.stack=miscData.stack.split("\n").slice(0,this._stackLimit).join("\n"))),this.aggregator.recordError(errorInfo,miscData)}}]),ErrorListener}();exports.default=ErrorListener}])}),function(){var Ext=window.Ext4||window.Ext;Ext.Ajax.timeout=9e4;var oldIdFunc=Ext.id;Ext.id=function(element,prefix){return oldIdFunc(element,Ext.baseCSSPrefix+(prefix||"gen"))},Ext.AbstractComponent.prototype.getId=function(){return this.id||(this.id=Ext.baseCSSPrefix+"cmp-"+this.getAutoId())},Ext.Component.prototype.getId=function(){var xtype,me=this;return me.id||(xtype=me.getXType(),xtype=xtype?xtype.replace(Ext.Component.INVALID_ID_CHARS_Re,"-"):Ext.baseCSSPrefix+"cmp",me.id=xtype+"-"+me.getAutoId()),me.id},Ext.Base.prototype.mergeConfig=function(config){this.config=Ext.Object.merge({},this.config||{},config||{}),Ext.apply(this,this.config)};var version=function(is,regex){var m;return is&&(m=regex.exec(Ext.userAgent))?parseFloat(m[1]):0};Ext.ieVersion=version(Ext.isIE,/msie (\d+\.\d+)/)||document.documentMode||0;var firefoxVersion=version(!0,/\bfirefox\/(\d+\.\d+)/);Ext.isFF6=6<=firefoxVersion&&firefoxVersion<7,Ext.isFF7=7<=firefoxVersion&&firefoxVersion<8,Ext.isFF8=8<=firefoxVersion&&firefoxVersion<9,Ext.onReady(function(){var body=Ext.getBody();Ext.isIE&&body.addCls([Ext.baseCSSPrefix+"ie11m"]),Ext.isIE10m&&body.addCls([Ext.baseCSSPrefix+"ie10m"]),Ext.isIE10?body.addCls([Ext.baseCSSPrefix+"ie",Ext.baseCSSPrefix+"ie8p",Ext.baseCSSPrefix+"ie9p",Ext.baseCSSPrefix+"ie10p"]):Ext.isIE11&&body.addCls([Ext.baseCSSPrefix+"ie",Ext.baseCSSPrefix+"ie8p",Ext.baseCSSPrefix+"ie9p",Ext.baseCSSPrefix+"ie10p",Ext.baseCSSPrefix+"ie11"])}),Ext&&Ext.menu.Item&&Ext.override(Ext.menu.Item,{activate:function(){var me=this;!me.activated&&me.canActivate&&me.rendered&&!me.isDisabled()&&me.isVisible()&&(me.el.addCls(me.activeCls),me.activated=!0,me.fireEvent("activate",me))},deactivate:function(){var me=this;me.activated&&(me.el.removeCls(me.activeCls),me.hideMenu(),me.activated=!1,me.fireEvent("deactivate",me))}}),Ext.data.Types.FORMATTED_ID={sortType:function(formattedId){return+formattedId.replace(/[\D]/g,"")},type:"FormattedID"},Ext&&Ext.JSON&&(Ext.JSON.encodeDate=function(o){return'"'+Ext.Date.format(o,"c")+'"'}),Ext.data.Types.AUTO.convert=function(v){return v},Ext.apply(Ext.data.SortTypes,{asCaseSensitive:function(s){return s}}),Ext.override(Ext.layout.container.Box,{finishedLayout:function(ownerContext){this.overflowHandler.finishedLayout(ownerContext),this.callParent(arguments),this.targetEl.setWidth(ownerContext.innerCtContext.props.width)}}),Ext.override(Ext.util.TextMetrics,{bind:function(el){this.callParent(arguments),this.measure.setStyle("wordWrap",this.el.getStyle("wordWrap")),this.measure.setStyle("whiteSpace",this.el.getStyle("whiteSpace"))}}),Ext.Date.brokenParse=Ext.Date.parse,Ext.Date.parse=function(input,format,strict){return"c"===format?Rally.util.DateTime.fromIsoString(input):Ext.Date.brokenParse(input,format,strict)},Ext.override(Ext.Component,{afterRender:function(){this.callParent(arguments),this.addInteractionClass&&this.addCls("interactable")}}),Ext.override(Ext.LoadMask,{shadow:!1,floating:{shadow:!1},setZIndex:function(){try{return this.callParent(arguments)}catch(Exception){}},getMaskEl:function(){var maskEl=this.callParent();return"display"===this.hideMode&&maskEl.getVisibilityMode()!==Ext.dom.AbstractElement.DISPLAY&&maskEl.setVisibilityMode(Ext.dom.AbstractElement.DISPLAY),
maskEl}});var originalMeasure=Ext.util.TextMetrics.measure;Ext.util.TextMetrics.measure=function(el){var result=originalMeasure.apply(this,arguments);if(Ext.isIE8){var element=Ext.get(el);element.hasCls(Ext.baseCSSPrefix+"btn-inner")&&(result.width+=2,element.up("."+Ext.baseCSSPrefix+"btn-icon-text-left")&&(result.width+=18))}return result},Ext.Array.first=function(array,predicate){for(var i=0,len=array.length;i<len;i++)if(predicate(array[i]))return array[i]},Ext.apply(Ext.data.JsonP,Ext.create("Ext.util.Observable")),Ext.data.JsonP.addEvents("beforerequest");var _originalJsonPRequest=Ext.data.JsonP.request;Ext.data.JsonP.request=function(options){this.fireEvent("beforerequest",this,options)!==!1&&_originalJsonPRequest.apply(Ext.data.JsonP,arguments)},Ext.define("Ext.dom.Element_anim",{override:"Ext.dom.Element",highlight:function(color,o){var restore,to,attr,lns,event,fn,me=this,dom=me.dom,from={};return o=o||{},lns=o.listeners||{},attr=o.attr||"backgroundColor",from[attr]=color||"ffff9c",o.to?to=o.to:(to={},to[attr]=o.endColor||me.getColor(attr,"ffffff","")),o.listeners=Ext.apply(Ext.apply({},lns),{beforeanimate:function(){restore=dom.style[attr];var el=Ext.fly(dom,"_anim");if(el.clearOpacity(),el.show(),event=lns.beforeanimate)return fn=event.fn||event,fn.apply(event.scope||lns.scope||window,arguments)},afteranimate:function(){dom&&(dom.style[attr]=restore),event=lns.afteranimate,event&&(fn=event.fn||event,fn.apply(event.scope||lns.scope||window,arguments))}}),me.animate(Ext.apply({},o,{duration:1e3,easing:"ease-in",from:from,to:to})),me}}),Ext.data.Model.load=function(id,config){config=Ext.apply({},config),config=Ext.applyIf(config,{action:"read",id:id});var callback,operation=new Ext.data.Operation(config),scope=config.scope||this;callback=function(operation){var record=null,success=operation.wasSuccessful();success?(record=operation.getRecords()[0],record&&!record.hasId()&&record.setId(id),Ext.callback(config.success,scope,[record,operation])):Ext.callback(config.failure,scope,[record,operation]),Ext.callback(config.callback,scope,[record,operation,success])},this.getProxy().read(operation,callback,this)},Ext.override(Ext.util.AbstractMixedCollection,{rebuildIndexMap:function(){for(var key in this.indexMap)this.indexMap.hasOwnProperty(key)&&delete this.indexMap[key];for(var i=0;i<this.keys.length;i++)this.indexMap[this.keys[i]]=i;this.indexGeneration=this.generation}}),Ext.override(Ext.data.writer.Writer,{getRecordData:function(record,operation){var changes,field,key,mappedIdProperty,f,fLen,isPhantom=record.phantom===!0,writeAll=this.writeAllFields||isPhantom,fields=record.fields,fieldItems=fields.items,data={},clientIdProperty=record.clientIdProperty;if(writeAll)for(fLen=fieldItems.length,f=0;f<fLen;f++)field=fieldItems[f],field.persist&&this.writeValue(data,field,record);else if(operation&&"destroy"===operation.action)this.writeValue(data,record.idField,record);else{changes=record.getChanges();for(key in changes)changes.hasOwnProperty(key)&&(field=fields.get(key),field.persist&&this.writeValue(data,field,record))}return isPhantom?clientIdProperty&&operation&&operation.records.length>1&&(data[clientIdProperty]=record.internalId):this.writeRecordId&&(mappedIdProperty=fields.get(record.idProperty)[this.nameProperty]||record.idProperty,data[mappedIdProperty]=record.getId()),data}}),Ext.override(Ext.view.Table,{renderCell:function(column,record,recordIndex,rowIndex,columnIndex,out){var fullIndex,value,clsInsertPoint,me=this,selModel=me.selModel,cellValues=me.cellValues,classes=cellValues.classes,fieldValue=record.data[column.dataIndex],cellTpl=me.cellTpl;cellValues.record=record,cellValues.column=column,cellValues.recordIndex=recordIndex,cellValues.rowIndex=rowIndex,cellValues.columnIndex=columnIndex,cellValues.cellIndex=columnIndex,cellValues.align=column.align,cellValues.tdCls=column.tdCls,cellValues.innerCls=column.innerCls,cellValues.style=cellValues.tdAttr="",cellValues.unselectableAttr=me.enableTextSelection?"":'unselectable="on"',column.renderer&&column.renderer.call?(fullIndex=me.ownerCt.columnManager.getHeaderIndex(column),value=column.renderer.call(column.scope||me.ownerCt,fieldValue,cellValues,record,recordIndex,fullIndex,me.dataSource,me),cellValues.css&&(record.cssWarning=!0,cellValues.tdCls+=" "+cellValues.css,delete cellValues.css)):value=fieldValue,cellValues.value=void 0===value||null===value||""===value?column.emptyCellText:value,classes[1]=column.getCellId(),clsInsertPoint=2,column.tdCls&&(classes[clsInsertPoint++]=column.tdCls),me.markDirty&&record.isModified(column.dataIndex)&&(classes[clsInsertPoint++]=me.dirtyCls),column.isFirstVisible&&(classes[clsInsertPoint++]=me.firstCls),column.isLastVisible&&(classes[clsInsertPoint++]=me.lastCls),me.enableTextSelection||(classes[clsInsertPoint++]=me.unselectableCls),cellValues.tdCls&&(classes[clsInsertPoint++]=cellValues.tdCls),selModel&&selModel.isCellModel&&selModel.isCellSelected(me,recordIndex,columnIndex)&&(classes[clsInsertPoint++]=me.selectedCellCls),classes.length=clsInsertPoint,cellValues.tdCls=classes.join(" "),cellTpl.applyOut(cellValues,out),cellValues.column=null}}),Ext.override(Ext.form.field.ComboBox,{onListSelectionChange:function(list,selectedRecords){var me=this,isMulti=me.multiSelect,hasRecords=selectedRecords.length>0;!me.ignoreSelection&&me.isExpanded&&(isMulti||me.collapse(),(isMulti||hasRecords)&&me.setValue(selectedRecords,!1),hasRecords&&me.fireEvent("select",me,selectedRecords),me.inputEl&&me.inputEl.focus())},onLoad:function(store,records,success){var me=this;me.ignoreSelection>0&&--me.ignoreSelection,success&&!store.lastOptions.rawQuery&&((null===me.value||!Ext.isDefined(me.value)||me.multiSelect&&0===me.value.length)&&me.store.getCount()?me.doAutoSelect():me.setValue(me.value))}}),Ext.override(Ext.AbstractComponent,{resumeLayouts:function(flushOptions){this.isLayoutSuspended()&&this.callParent(arguments)}}),Ext.isGecko&&Ext.override(Ext.form.field.ComboBox,{onExpand:function(){var me=this,keyNav=me.listKeyNav,selectOnTab=me.selectOnTab,picker=me.getPicker();if(keyNav)keyNav.enable();else{keyNav=this.listKeyNav=new Ext.view.BoundListKeyNav(me.inputEl,{boundList:picker,forceKeyDown:!0,enter:function(e){var selModel=picker.getSelectionModel(),count=selModel.getCount();this.selectHighlighted(e),me.multiSelect||count!==selModel.getCount()||me.collapse()}});var geckoKeyNav=new Ext.view.BoundListKeyNav(me.inputEl,{boundList:picker,forceKeyDown:!1,tab:function(e){return selectOnTab&&(this.selectHighlighted(e),me.triggerBlur()),!0}});this.on("expand",geckoKeyNav.enable,geckoKeyNav),this.on("collapse",geckoKeyNav.disable,geckoKeyNav),this.on("destroy",geckoKeyNav.destroy,geckoKeyNav)}selectOnTab&&(me.ignoreMonitorTab=!0),Ext.defer(keyNav.enable,1,keyNav),me.inputEl.focus()}}),Ext.isIE&&Ext.override(Ext.dd.DragTracker,{onMouseDown:function(e,target){var el,me=this;me.disabled||e.dragTracked||(me.dragTarget=me.delegate?target:me.handle.dom,me.startXY=me.lastXY=e.getXY(),me.startRegion=Ext.fly(me.dragTarget).getRegion(),me.fireEvent("mousedown",me,e)!==!1&&me.fireEvent("beforedragstart",me,e)!==!1&&me.onBeforeStart(e)!==!1&&(me.mouseIsDown=!0,e.dragTracked=!0,el=me.el.dom,Ext.isIE&&el.setCapture&&this.captureEvent!==!1&&el.setCapture(),me.preventDefault!==!1&&e.preventDefault(),Ext.getDoc().on({scope:me,mouseup:me.onMouseUp,mousemove:me.onMouseMove,selectstart:me.stopSelect}),me.autoStart&&(me.timer=Ext.defer(me.triggerStart,me.autoStart===!0?1e3:me.autoStart,me,[e]))))}}),Ext.override(Ext.data.proxy.Rest,{buildUrl:function(request){var me=this,operation=request.operation,records=operation.records||[],record=records[0],format=me.format,url=me.getUrl(request),id=record?record.getId():operation.id,appendId=me.appendId&&operation.appendId!==!1;return appendId&&me.isValidId(id)&&(url.match(/\/$/)||(url+="/"),url+=id),format&&(url.match(/\.$/)||(url+="."),url+=format),request.url=url,Ext.data.proxy.Rest.superclass.buildUrl.apply(me,arguments)}}),Ext.override(Ext.data.TreeStore,{load:function(options){options=options||{},options.params=options.params||{};var operation,me=this,node=options.node||me.tree.getRootNode(),callback=options.callback,scope=options.scope;return options.fetch=options.fetch||this.fetch,options.context=options.context||this.context,node||(me.setRootNode({expanded:!0},!0),node=me.getRootNode()),node.data.expanded&&(node.data.loaded=!1,me.clearOnLoad&&(node.data.expanded=!1),options.callback=function(){me.clearOnLoad||node.collapse(),node.expand(),Ext.callback(callback,scope,arguments)}),options.id=node.getId(),options=Ext.apply({action:"read",filters:me.filters.items,sorters:me.getSorters(),node:options.node||node},options),me.lastOptions=options,operation=new Ext.data.Operation(options),me.fireEvent("beforeload",me,operation)!==!1&&(me.clearOnLoad&&(me.clearRemovedOnLoad&&me.clearRemoved(node),me.tree.un("remove",me.onNodeRemove,me),node.removeAll(!1),me.tree.on("remove",me.onNodeRemove,me)),me.loading=!0,me.proxy.read(operation,me.onProxyLoad,me)),me.loading&&node&&node.set("loading",!0),me}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.overrides.NodeCache",{override:"Ext.view.NodeCache",insert:function(insertPoint,nodes){var i,me=this,elements=me.elements,nodeCount=nodes.length;if(me.view.bufferedRenderer){if(me.count){if(insertPoint<=me.endIndex)for(i=me.endIndex+nodeCount;i>=insertPoint+nodeCount;i--)elements[i]=elements[i-nodeCount],this._setDataRecordIndex(elements[i],i);me.endIndex=me.endIndex+nodeCount}else me.startIndex=insertPoint,me.endIndex=insertPoint+nodeCount-1;for(i=0;i<nodeCount;i++,insertPoint++)elements[insertPoint]=nodes[i],this._setDataRecordIndex(elements[insertPoint],insertPoint);me.count+=nodeCount}else{if(me.count){if((insertPoint>me.endIndex+1||insertPoint+nodes.length-1<me.startIndex)&&Ext.Error.raise("Discontiguous range would result from inserting "+nodes.length+" nodes at "+insertPoint),insertPoint<me.count)for(i=me.endIndex+nodeCount;i>=insertPoint+nodeCount;i--)elements[i]=elements[i-nodeCount],this._setDataRecordIndex(elements[i],i);me.endIndex=me.endIndex+nodeCount}else me.startIndex=insertPoint,me.endIndex=insertPoint+nodeCount-1;for(i=0;i<nodeCount;i++,insertPoint++)elements[insertPoint]=nodes[i],this._setDataRecordIndex(elements[insertPoint],insertPoint);me.count+=nodeCount}},removeRange:function(start,end,removeDom){var el,i,removeCount,fromPos,me=this,elements=me.elements;for(end=void 0===end?me.count:Math.min(me.endIndex+1,end+1),start||(start=0),removeCount=end-start,i=start,fromPos=end;i<me.endIndex;i++,fromPos++)removeDom&&i<end&&Ext.removeNode(elements[i]),fromPos<=me.endIndex?(el=elements[i]=elements[fromPos],this._setDataRecordIndex(el,i)):delete elements[i];me.count-=removeCount,me.endIndex-=removeCount},replaceElement:function(el,replacement,domReplace){var elements=this.elements,index="number"==typeof el?el:this.indexOf(el);return index>-1&&(replacement=Ext.getDom(replacement),domReplace&&(el=elements[index],el.parentNode.insertBefore(replacement,el),Ext.removeNode(el),this._setDataRecordIndex(replacement,index)),this.elements[index]=replacement),this},removeElement:function(keys,removeDom){var inKeys,key,deleteCount,index,fromIndex,me=this,elements=me.elements,keyIndex=0;if(Ext.isArray(keys)){for(inKeys=keys,keys=[],deleteCount=inKeys.length,keyIndex=0;keyIndex<deleteCount;keyIndex++)key=inKeys[keyIndex],"number"!=typeof key&&(key=me.indexOf(key)),key>=me.startIndex&&key<=me.endIndex&&(keys[keys.length]=key);Ext.Array.sort(keys),deleteCount=keys.length}else{if(keys<me.startIndex||keys>me.endIndex)return;deleteCount=1,keys=[keys]}for(index=fromIndex=keys[0],keyIndex=0;index<=me.endIndex;index++,fromIndex++)keyIndex<deleteCount&&index===keys[keyIndex]&&(fromIndex++,keyIndex++,removeDom&&Ext.removeNode(elements[index])),fromIndex<=me.endIndex&&fromIndex>=me.startIndex?(el=elements[index]=elements[fromIndex],this._setDataRecordIndex(el,index)):delete elements[index];me.endIndex-=deleteCount,me.count-=deleteCount},_setDataRecordIndex:function(element,index){element.setAttribute("data-recordIndex",index);var dataRowEl=Ext.fly(element).down("."+Ext.baseCSSPrefix+"grid-data-row");dataRowEl&&dataRowEl.dom.setAttribute("data-recordIndex",index)},shiftIndexesLeftByOne:function(){var index,fromIndex,el,elements=this.elements;if(this.startIndex>0){for(fromIndex=this.startIndex;fromIndex<=this.endIndex;fromIndex++)index=fromIndex-1,el=elements[index]=elements[fromIndex],this._setDataRecordIndex(el,index);delete elements[this.endIndex],this.startIndex=this.startIndex-1,this.endIndex=this.endIndex-1}},scroll:function(newRecords,direction,removeCount){this.callParent(arguments),this.view.fireEvent("bufferedscroll",newRecords)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.Message",{singleton:!0},function(){Ext.apply(Rally.Message,{gridLoaded:"gridloaded",treeLoaded:"treeloaded",iframeLoaded:"iframeloaded",treeItemExpanded:"treeitemexpanded",treeItemCollapsed:"treeitemcollapsed",objectFocus:"objectfocus",objectCreate:"objectcreate",objectWillUpdate:"objectwillupdate",recordDidChange:"recorddidchange",objectUpdate:"objectupdate",objectDestroy:"objectdestroy",bulkUpdate:"bulkupdate",bulkImport:"bulkimport",recordUpdateFailure:"recordupdatefailure",recordUpdateSuccess:"recordupdatesuccess",displayNotification:"displayNotification",errorDisplayNotification:"errorDisplayNotification",clearNotification:"clearNotification",notificationRemoved:"notificationremoved",piKanbanBoardReady:"pikanbanboardready",piChartAppReady:"pichartappready",piChildTypeDefDetermined:"pichildtypedefdetermined",blockedReasonPopoverNoOpSave:"blockedreasonpopovernoopsave",attributeDefinitionEditorLoaded:"attributedefinitioneditorloaded",preferenceUpdated:"preferenceupdated",preferenceRemoved:"preferenceremoved",attachmentAssociated:"attachmentAssociated",attachmentUploadFailed:"attachmentUploadFailed",clientLatency:"clientlatency",layout:"layout",render:"render",ajaxRequests:"ajaxrequests",schemaFetched:"schemafetched"})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Error",{requires:[],singleton:!0,captureError:function(e){if(Rally.isDevMode&&window.console&&window.console.info&&window.console.info(e.stack?e.stack:e),Rally.environment.getMessageBus().publish(Rally.clientmetrics.Message.error,e),Rally.BrowserTestErrors){var error={message:e.toString()};error.description=error.message,e.stack&&(error.stack=e.stack,error.description+=error.stack.toString()),Rally.BrowserTestErrors.captureError(error)}},getUserFriendlyError:function(message){return message.match(/concurrency conflict:/i)?"Concurrency Error: Another change is currently in progress, and your last edit was not saved. Please try again.":message.match(/invalid key/i)?"Oops, something went wrong. Please refresh your browser to continue.":message}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.MessageBus",{mixins:{observable:Ext.util.Observable},constructor:function(){for(var key in this.mixins)this.mixins.hasOwnProperty(key)&&this.mixins[key].constructor.call(this);this.callParent()},destroy:function(){this.clearListeners(),this.callParent(arguments)},subscribe:function(observable,event,fn,scope,options){var args=Ext.Array.toArray(arguments),obs=this._removeObservableFromList(args),eventName=args[0];if(!eventName)throw Error("Must provide name of event when calling subscribe");this._ensureEventExists(eventName),this.addListener.apply(this,args),obs?obs.on("destroy",function(){this.unsubscribe.apply(this,args)},this):this.addListener.apply(this,args)},unsubscribe:function(observable,event,fn,scope){var args=Ext.Array.toArray(arguments);this._removeObservableFromList(args),this.removeListener.apply(this,args)},publish:function(event,varargs){this._ensureEventExists(event);try{this.fireEvent.apply(this,arguments)}catch(e){Rally.util.Error.captureError(e)}},_removeObservableFromList:function(args){var obs=null;return args.length>0&&args[0]&&args[0].isObservable&&(obs=args.shift()),obs},_ensureEventExists:function(event){this.events[event]||this.addEvents(event)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.Messageable",{subscribe:function(observable,event,fn,scope){var mb=this._getMessageBus();mb.subscribe.apply(mb,arguments)},unsubscribe:function(observable,event,fn,scope){var mb=this._getMessageBus();mb.unsubscribe.apply(mb,arguments)},publish:function(event,varargs){var mb=this._getMessageBus();mb.publish.apply(mb,arguments)},_getMessageBus:function(){return this.messageBus||this.initialConfig&&this.initialConfig.messageBus||Rally.environment.getMessageBus()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.BulkRecordUpdater",{singleton:!0,updateRecords:function(options){if(options.notUpdatedRecords=options.notUpdatedRecords||[],options.records.length){var record=_.first(options.records);if(options.records=_.rest(options.records),!record.get("updatable")&&!record.phantom)return options.notUpdatedRecords.push(record),this.updateRecords(options);options.propertiesToUpdate&&record.set(options.propertiesToUpdate),record.save({callback:function(records,operation){operation.wasSuccessful()?Ext.isFunction(options.recordUpdate)&&options.recordUpdate.call(options.scope,record):(record.errorMessages=operation.error.errors,options.notUpdatedRecords.push(record)),this.updateRecords(options)},scope:this})}else options.success.call(options.scope,options.notUpdatedRecords)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.Field",{extend:Ext.data.Field,isRallyField:!0,typeMappings:{bool:"boolean",auto:"string",string:"string",date:"date",float:"float",number:"float",int:"integer"},displayName:null,constructor:function(config){config.displayName||(config.displayName=config.name),this.callParent([config])},getType:function(){return this.typeMappings[this.type.type]||"string"},isMultiValueCustom:function(){return!1}})}(),function(){function _convertToRallyFields(fields){var rallyFields=[];return _.map(fields,function(field){rallyFields.push(field.isRallyField?field:new Rally.data.Field(field))}),rallyFields}var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.Model",{extend:Ext.data.Model,uriKey:"_ref",onClassExtended:function(baseClass,extendedClass,hooks){var me=this,onBeforeClassCreated=hooks.onBeforeCreated;hooks.onBeforeCreated=function(baseClass,extendedClass,hooks){if(extendedClass.fields=_convertToRallyFields(extendedClass.fields),onBeforeClassCreated.call(this,baseClass,extendedClass,hooks),extendedClass.idProperty&&extendedClass.idProperty!==me.prototype.idProperty){var fields=baseClass.prototype.fields;fields.remove(fields.get(me.prototype.idProperty))}}},constructor:function(data){this.callParent(arguments),this.addEvents("aftercommit")},getUri:function(){return this.get(this.uriKey)},getField:function(field){return this.self.getField(field)},hasField:function(field){return this.self.hasField(field)},isFieldVisible:function(fieldName){var field=this.getField(fieldName);return!!field&&!field.hidden},getFields:function(){return this.self.getFields()},getDirtyFields:function(){var me=this;return _.intersection(me.getFields(),_.map(me.modified,function(value,key){return me.getField(key)}))},hasValue:function(field){return field&&!_.contains([null,void 0,""],this.get(field.name))},isCustomField:function(fieldName){return!1},commit:function(silent){this.callParent(arguments),this.fireEvent("aftercommit")},inheritableStatics:{addField:function(field){this.prototype.fields.add(field.name,Ext.create("Rally.data.Field",field))},getField:function(fieldName){return _.find(this.getFields(),{name:fieldName})},hasField:function(field){return Ext.isObject(this.getField(field))},getCustomFields:function(){return _.filter(this.getFields(),{custom:!0})},isAttributeEqual:function(attr,value){return function(record){return record.get(attr)===value}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.TypeInfo",{requires:[],singleton:!0,typeInfos:{hierarchicalrequirement:{prefix:"ar",shortTypeName:"Story",pluralShortTypeName:"Stories",typeName:"User Story",pluralTypeName:"User Stories",detailSlugPrefix:"/project/detail",detail:"/detail/ar",editor:{newPath:"ar/new.sp"},schemaType:"HierarchicalRequirement",alias:"userstory",icon:"icon-story"},defect:{prefix:"df",typeName:"Defect",detail:"/detail/df",detailSlugPrefix:"/project/detail",editor:{newPath:"df/new.sp"},schemaType:"Defect",alias:"defect",icon:"icon-defect"},defectsuite:{prefix:"ds",typeName:"Defect Suite",detail:"/detail/ds",detailSlugPrefix:"/project/detail",editor:{newPath:"ds/new.sp"},schemaType:"DefectSuite",icon:"icon-defect-suite"},testcase:{prefix:"tc",typeName:"Test Case",detail:"/detail/tc",detailSlugPrefix:"/project/detail",schemaType:"TestCase",editor:{newPath:"tc/new.sp"},icon:"icon-test-case"},testcaseresult:{prefix:"tcr",typeName:"Test Case Result",detail:"/detail/tcr",detailSlugPrefix:"/project/detail",schemaType:"TestCaseResult",editor:{newPath:"tcr/new.sp"}},task:{prefix:"tk",typeName:"Task",detail:"/detail/tk",detailSlugPrefix:"/project/detail",schemaType:"Task",editor:{newPath:"tk/new.sp"},alias:"task",icon:"icon-task"},testfolder:{prefix:"tf",typeName:"Test Folder",detail:null,detailSlugPrefix:"/project/detail",editor:{newPath:"tf/new.sp"},schemaType:"TestFolder",icon:"icon-folder"},recyclebinentry:{typeName:"Recycle Bin Entry",schemaType:"RecycleBinEntry"},testset:{prefix:"ts",typeName:"Test Set",pluralTypeName:"Test Sets",detail:null,detailSlugPrefix:"/project/detail",detailSlugSuffix:"/run",editor:{newPath:"ts/new.sp"},schemaType:"TestSet",icon:"icon-test-set"},project:{prefix:"pj",typeName:"Project",detail:"/detail",detailSlugPrefix:"/setup/detail",schemaType:"Project",editor:{newPath:"pj/new.sp"}},workspace:{prefix:"ws",detailSlugPrefix:"/setup/detail",editor:{newPath:"ws/new.sp"},schemaType:"Workspace"},subscription:{prefix:"subscription",detailSlugPrefix:"/setup/detail",schemaType:"Subscription"},adminsubscription:{prefix:"admin/sp",detailSlugPrefix:"/admin/detail"},projectuser:{prefix:"user",detail:"/detail/user",detailSlugPrefix:"/setup/detail",alias:"user"},changeset:{prefix:"changeset",detail:null},build:{prefix:"build",detail:null},change:{prefix:"change",detail:null},user:{typeName:"User",prefix:"user",detail:"/detail/user",detailSlugPrefix:"/setup/detail",editor:{newPath:"user/new.sp"},schemaType:"User"},adminuser:{typeName:"User",prefix:"admin/user",editor:{newPath:"admin/user/new.sp"}},release:{prefix:"rl",detailSlugPrefix:"/project/detail",detail:"/detail/release",editor:{newPath:"rl/new.sp"},schemaType:"Release"},iteration:{prefix:"it",detailSlugPrefix:"/project/detail",detail:"/detail/iteration",editor:{newPath:"it/new.sp"},schemaType:"Iteration"},webtab:{prefix:"wt",detail:null,editor:{newPath:"wt/new.sp"}},program:{prefix:"pg",editor:{newPath:"pg/new.sp"}},attribute:{prefix:"at",editor:{newPath:"at/new.sp"}},scopedattributedefinition:{prefix:"at",editor:{newPath:"at/new.sp"},alias:"weblinkdefinition"},attributedefinition:{prefix:"at",editor:{newPath:"at/new.sp"},alias:"weblinkdefinition"},customview:{prefix:"view",editor:{newPath:"view/new.sp"}},usernotificationfilter:{prefix:"un",editor:{newPath:"un/new.sp"}},portfolioitem:{icon:"icon-portfolio",prefix:"pi",schemaType:"PortfolioItem"},milestone:{icon:"icon-milestone",typeName:"Milestone",alias:"milestone"},deliverygroup:{icon:"icon-delivery-group",typeName:"DeliveryGroup",alias:"deliverygroup"},expertise:{icon:"icon-expertise",typeName:"Expertise",alias:"expertise"},expertisedemand:{icon:"icon-expertise",typeName:"ExpertiseDemand",alias:"expertisedemand"},expertisecapacity:{icon:"icon-expertise",typeName:"ExpertiseCapacity",alias:"expertisecapacity"}},normalizeTypeName:function(type){return type.toLowerCase().replace(/ /g,"").replace(/\/.+$/,"")},getTypeInfoByName:function(name){var formattedName=name.toLowerCase().replace(/ /g,""),returnVal=this.typeInfos[formattedName]||this.getTypeInfoByAttr("alias",formattedName);return returnVal||this.buildDefaultTypeInfo(name,formattedName)},buildDefaultTypeInfo:function(name,formattedName){return{prefix:formattedName,typeName:name,editor:{newPath:formattedName+"/new.sp"},schemaType:formattedName,alias:formattedName}},getTypeInfoByAttr:function(attr,value){var info=null,typeInfos=this.typeInfos;for(var typeName in typeInfos)if(typeInfos.hasOwnProperty(typeName)){var type=typeInfos[typeName];if(type[attr]===value){info=type;break}}return info}})}(),function(){var Ext=window.Ext4||window.Ext,characterOrDigitRegularExpression=/[0-9A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BEF\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C66-\u0C6F\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D66-\u0D6F\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F29\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u1810-\u1819\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u19D0-\u19D9\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,uuidOrOidRegularExpression=/([a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}|[a-fA-F0-9]{32}|[0-9]+|\d+u\d+[pw]\d+|-?\d+)/;Ext.define("Rally.util.RegularExpression",{statics:{characterOrDigitRegularExpression:characterOrDigitRegularExpression,uuidOrOidRegularExpression:uuidOrOidRegularExpression,refRegularExpressions:{LINE_BEGIN:/^/,VERSION:/\/?(?:(?:(?:v?\d+\.(?:\d+|x))|x)?\/?)/,SCOPE:/(?:(.*?)\/)?/,TYPE:new RegExp("((?:"+characterOrDigitRegularExpression.source+")*)"),UUID_OR_OID_REF:new RegExp("/"+uuidOrOidRegularExpression.source),EXTENSION:/(?:\.js)?/,COLLECTION:/(\/[_0-9A-Za-z]+)?/,PARAMS:/(?:\?.*)?/,LINE_END:/$/},buildRegularExpression:_.memoize(function(cacheKey,regs,options){return new RegExp(Object.keys(regs).map(function(key){return regs[key].source}).join(""),options)}),combineRegularExpressions:function(regs,options){return this.buildRegularExpression(Object.keys(regs)[0],regs,options)}}})}(),function(){var Ext=window.Ext4||window.Ext,UUID_FORMAT=/[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}|[a-fA-F0-9]{32}/,PERMISSION_FORMAT=/\d+u\d+[pw]\d+/,EXPLICIT_VERSION_FORMAT=/^v{0,1}\d+?\.\d+?$/;Ext.define("Rally.util.Ref",{statics:{getCombinedRegularExpression:function(){return(!Rally.environment.narrowJsScriptingValley||!this.combinedRegEx&&Rally.environment.narrowJsScriptingValley)&&(this.combinedRegEx=Rally.util.RegularExpression.combineRegularExpressions(Rally.util.RegularExpression.refRegularExpressions)),this.combinedRegEx},isRefUri:function(uri){return Ext.isString(uri)&&Rally.util.Ref.getCombinedRegularExpression().test(uri)},isRefUriWithValidObjectId:function(uri){if(uri&&this.isRefUri(uri)){var oid=this.getRefObject(uri).getOid();return!Ext.isNumber(oid)||parseInt(oid,10)>0}return!1},isRefObject:function(reference){return Ext.isObject(reference)&&!Ext.isEmpty(reference.getOid)&&!Ext.isEmpty(reference.getType)},getRefUri:function(input){if(this.isRefUri(input))return input;if(input&&Ext.isObject(input)){if(Ext.isFunction(input.get)&&this.isRefUri(input.get("_ref")))return input.get("_ref");if(this.isRefUri(input._ref))return input._ref}return null},getRefObject:function(input){var refUri=this.getRefUri(input);if(!this.isRefUri(refUri))throw Error("Reference ["+input+"] must be a valid WSAPI uri or a valid reference object.");return Ext.create("Rally.util.Ref",refUri)},getRelativeUri:function(reference){var refUri=this.getRefUri(reference),relativeUri=null;return refUri?relativeUri=Ext.create("Rally.util.Ref",refUri).getRelativeUri():this.isRefObject(reference)&&(relativeUri=this.getRelativeUriFromUriWithVersion(reference.getRelativeUriWithVersion())),relativeUri},getUrl:function(reference){var uri=this.getUri(reference),origin=window.location.protocol+"//"+window.location.host;return uri.match(/^http/)||(uri=origin+uri),uri},getRelativeUriFromUriWithVersion:function(uri){if(!uri)return null;var results=Rally.util.Ref.getCombinedRegularExpression().exec(uri),scopingPart=results[1],typePart=results[2],oidPart=results[3],collectionPart=results[4];
return uri=scopingPart?"/"+scopingPart+"/"+typePart+"/"+oidPart:"/"+typePart+"/"+oidPart,collectionPart&&(uri+=collectionPart),uri},addProjectParameterIfEditingAtProject:function(reference,url){var refUri=reference.getRelativeUri(),urlPartsArray=refUri.split("/");return"PROJECT"===urlPartsArray[1].toUpperCase()&&(url+="&scopeOid="+urlPartsArray[2]),url},getUri:function(reference){var version=Ext.isFunction(reference.getVersion)&&reference.getVersion()||Rally.environment.getServer().getWsapiVersion();return Rally.environment.getServer().getWsapiUrl(version)+this.getRelativeUri(reference)},getOidFromRef:function(input){var objectId,oid,ref=this.getRefUri(input);return ref?(objectId=Rally.util.Ref.getCombinedRegularExpression().exec(ref)[3],oid=UUID_FORMAT.test(objectId)||PERMISSION_FORMAT.test(objectId)?objectId:parseInt(objectId,10)):null},getTypeFromRef:function(input){var ref=this.getRefUri(input);if(ref=this.getRelativeUri(ref)){var groups=Rally.util.Ref.getCombinedRegularExpression().exec(ref);return"portfolioitem"===groups[1]?groups[1]+"/"+groups[2]:groups[2]}return null},getRefFromTypeAndOid:function(type,oid){return Ext.isString(type)&&!isNaN(oid)?"/"+type.toLowerCase()+"/"+oid.toString():null}},constructor:function(reference){Ext.isObject(reference)&&reference.oid&&reference.type?(reference.relativeUriWithVersion="/"+reference.type+"/"+reference.oid,this.reference=reference):this.reference=this._parseUri(reference)},getType:function(){return this.reference.type||null},getOid:function(){return this.reference.oid||null},getTypeDefOid:function(){return this.reference.typeDefOid||null},getScopeType:function(){return this.reference.scopeType||null},getScopeOid:function(){return this.reference.scopeOid||null},getVersion:function(){return this.reference.version||"x"},setVersion:function(version){this.reference.version=version},getRelativeUriWithVersion:function(){return this.reference.relativeUriWithVersion||null},getParsedUri:function(){return this.reference.parsedUri},getRelativeUri:function(){return this.self.getRelativeUri(this)},getUri:function(){return this.self.getUri(this)},getTypeInfo:function(){return Rally.util.TypeInfo.getTypeInfoByName(this.getType())},_parseUri:function(inputUri){var uri=inputUri;if(!this.self.isRefUri(uri))throw Error("Reference ["+uri+"] must be a valid WSAPI uri");uri=uri.replace(/^https?:\/\/[^\/]+?/,""),uri=uri.replace(/^.*?webservice/,""),uri.match(/^\//)||(uri="/"+uri);var parts=uri.split("/"),length=parts.length,ref={oid:this.self.getOidFromRef(uri),type:this._parseTypeFromUri(uri),relativeUriWithVersion:uri,parsedUri:inputUri},versionCandidate=parts[1],server=Rally.environment.getServer();if(EXPLICIT_VERSION_FORMAT.test(versionCandidate)||Ext.Array.contains(server.getWsapiVersionAliases(),versionCandidate)?ref.version=versionCandidate:ref.version=server.getWsapiVersion(),length>=4&&"TYPEDEFINITION"===parts[length-4].toUpperCase()&&(ref.typeDefOid=parseInt(parts[length-3],10)),length>=6){var scopeType=parts[length-6].toUpperCase();"PROJECT"===scopeType?ref.scopeType="project":"WORKSPACE"===scopeType&&(ref.scopeType="workspace"),ref.scopeOid=parseInt(parts[length-5],10)}return ref},_parseTypeFromUri:function(uri){var relativeUri=this.self.getRelativeUriFromUriWithVersion(uri),relativeUriParts=relativeUri.split("/");return this._isNestedType(relativeUriParts)?this._buildFullyQualifiedTypeName(relativeUriParts):this._getTypeFromUriParts(relativeUriParts)},_buildFullyQualifiedTypeName:function(uriParts){return uriParts[1]+"/"+uriParts[2]},_isNestedType:function(uriParts){return 4===uriParts.length},_getTypeFromUriParts:function(uriParts){return uriParts[uriParts.length-2]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.ScopedStateUtil",{stateDelimiter:"::",scopeDelimiter:"||",getScopedStateId:function(stateId,preferenceOpts){preferenceOpts=preferenceOpts||{};var scope=this.getScopeString(preferenceOpts);return Ext.isEmpty(scope)||(stateId=scope+this.stateDelimiter+stateId),stateId},getScopeString:function(preferenceOpts){var userRef;userRef=preferenceOpts.filterByUser===!0?Rally.environment.getContext().getUser()._ref:preferenceOpts.filterByUser?preferenceOpts.filterByUser:"";var keyParts=[preferenceOpts.appID,Rally.util.Ref.getRelativeUri(preferenceOpts.workspace),Rally.util.Ref.getRelativeUri(preferenceOpts.project),Rally.util.Ref.getRelativeUri(userRef)];return keyParts.join(this.scopeDelimiter)},parseScopedStateId:function(stateId){var splitStateId=stateId.split(this.stateDelimiter);if(splitStateId.length>2&&Ext.Error.raise("Invalid state stateId: "+stateId),splitStateId.length>1){var parsedStateId=this._parseScope(splitStateId[0]);return parsedStateId.stateScope=splitStateId[0],parsedStateId.stateId=splitStateId[1],parsedStateId}return{stateId:splitStateId[0]}},_parseScope:function(scope){var scopeParts=scope.split(this.scopeDelimiter);return{appID:scopeParts[0],workspace:scopeParts[1],project:scopeParts[2],filterByUser:scopeParts[3]}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.PreferenceManager",{mixins:[Rally.Messageable],singleton:!0,clientMetrics:[{beginMethod:"load",endMethod:"_onPrefLoad",description:"preference loaded"},{beginMethod:"update",endMethod:"_onPrefUpdate",description:"preference updated"},{beginMethod:"remove",endMethod:"_onPrefRemove",description:"preference removed"}],cacheProvider:void 0,load:function(options){var prefs=this._shouldUseCache(options)?this._getNamedCachedPref(options):null,deferred=Ext.create("Deft.Deferred");return!Ext.isEmpty(prefs)&&_.size(prefs)?(this._onPrefLoad(prefs,options),deferred.resolve(prefs)):this._buildPrefStore(options).load({callback:function(records){var prefs=this._convertRecordsToCachedPrefValue(records);this._shouldUseCache(options)&&this._setCachedPref(prefs,options),this._onPrefLoad(prefs,options),deferred.resolve(prefs)},scope:this}),deferred.promise},update:function(options){var store=this._buildPrefStore(options),updateOptions=options;return store.load().then({success:function(){return this._updatePreferences(store,updateOptions)},scope:this}).then({success:function(records){return this._onPrefUpdate(records,updateOptions),records},scope:this})},remove:function(options){options.name&&!options.filterByName&&(options.filterByName=options.name),options.filterByName||Ext.Error.raise("filterByName is a required parameter for Rally.data.PreferenceManager#remove"),this._buildPrefStore(options).load({callback:function(records){var pref=records[0];pref?pref.destroy({success:function(){this._onPrefRemove(options)},scope:this}):this._onPrefRemove(options)},scope:this})},_onPrefLoad:function(prefs,options){options.success&&options.success.call(options.scope,prefs)},_onPrefUpdate:function(records,options){options.success&&options.success.call(options.scope,records),_.isEmpty(records)||this.publish(Rally.Message.preferenceUpdated,records)},_onPrefRemove:function(options){options.filterByName?this._removeCachedPref(options):Ext.Error.raise("filterByName is a required parameter for Rally.data.PreferenceManager#remove"),options.success&&options.success.call(options.scope),this.publish(Rally.Message.preferenceRemoved)},_convertRecordsToCachedPrefValue:function(records){var prefs={};return records&&Ext.Array.forEach(records,function(record){var existingPref=prefs[record.get("Name")];existingPref||(prefs[record.get("Name")]=record.get("Value"))}),prefs},_updatePreferences:function(store,options){Ext.Object.each(options.settings,function(settingName,settingValue){var existingPref=store.findExactRecord("Name",settingName);if(existingPref)existingPref.set("Value",settingValue);else{var pref={Name:settingName,Value:settingValue,Project:Rally.util.Ref.getRelativeUri(options.project)||null};options.appID&&(pref.AppId=options.appID),options.filterByUser&&(pref.User=this._getUserRef(options.filterByUser)),options.workspace&&(pref.Project=null,pref.Workspace=Rally.util.Ref.getRelativeUri(options.workspace)),store.add(pref)}},this);var deferred=Ext.create("Deft.Deferred"),recordsToUpdate=store.getNewRecords().concat(store.getUpdatedRecords());return Rally.data.BulkRecordUpdater.updateRecords({records:recordsToUpdate,success:function(){var cachedPrefValue=this._convertRecordsToCachedPrefValue(store.getRecords());this._setCachedPref(cachedPrefValue,options),deferred.resolve(recordsToUpdate)},scope:this}),deferred.promise},_getUserRef:function(filterByUser){var user=filterByUser===!0?this._getCurrentUserRef():filterByUser;return Rally.util.Ref.getRelativeUri(user)},_buildPrefStore:function(options){var filters=[];return options.appID&&filters.push({property:"AppId",value:options.appID}),options.hasOwnProperty("filterByUser")&&filters.push({property:"User",value:this._getUserRef(options.filterByUser)||null}),options.filterByName&&filters.push({property:"Name",value:options.filterByName}),options.hasOwnProperty("project")&&filters.push({property:"Project",value:Rally.util.Ref.getRelativeUri(options.project)||null}),options.hasOwnProperty("workspace")&&filters.push({property:"Workspace",value:Rally.util.Ref.getRelativeUri(options.workspace)||null}),filters=filters.concat(options.additionalFilters||[]),Ext.create("Rally.data.wsapi.Store",{requester:options.requester,model:Ext.identityFn("preference"),filters:filters,context:Rally.environment.getContext().getDataContext()})},_getCurrentUserRef:function(){return"/user/"+Rally.environment.getContext().getUser().ObjectID},_getUnNamedOptions:function(options){var unFilteredOpts=Ext.merge({},options);return delete unFilteredOpts.filterByName,unFilteredOpts},_buildCacheKey:function(options){return this.scopedStateUtil||(this.scopedStateUtil=Ext.create("Rally.state.ScopedStateUtil")),this.scopedStateUtil.getScopeString(options)},_getCachedPref:function(options){if(this.cacheProvider)return this.cacheProvider.get(this._buildCacheKey(options))},_getNamedCachedPref:function(options){var prefs=this._getCachedPref(options);if(!Ext.isEmpty(prefs)&&options.filterByName){var namedPrefs={};return prefs.hasOwnProperty(options.filterByName)&&(namedPrefs[options.filterByName]=prefs[options.filterByName]),namedPrefs}return prefs},_setCachedPref:function(prefs,options){if(this._shouldUseCacheOrPreferenceIsAlreadyCached(options))if(Ext.isEmpty(prefs))this._removeCachedPref(options);else{var oldCacheValue=this._getCachedPref(options)||{},newCacheValue=Ext.merge(oldCacheValue,prefs);this.cacheProvider.set(this._buildCacheKey(options),newCacheValue)}},_removeCachedPref:function(options){this.cacheProvider&&(options.filterByName?this._removeNamedCachedPref(options):this.cacheProvider.clear(this._buildCacheKey(options)))},_removeNamedCachedPref:function(options){var cachedPrefs=this._getCachedPref(options);Ext.isEmpty(cachedPrefs)||(delete cachedPrefs[options.filterByName],this.cacheProvider.set(this._buildCacheKey(options),cachedPrefs))},_shouldUseCache:function(options){return this._isFilteredByUser(options)&&this._isCacheEnabled(options)&&!this._hasAdditionalFilters(options)&&this.cacheProvider},_isFilteredByUser:function(options){return options&&options.filterByUser},_isCacheEnabled:function(options){return!options||!options.hasOwnProperty("cache")||options.cache},_shouldUseCacheOrPreferenceIsAlreadyCached:function(options){return this._shouldUseCache(options)||this.cacheProvider&&this.cacheProvider.get(this._buildCacheKey(options))},_hasAdditionalFilters:function(options){return options&&!Ext.isEmpty(options.additionalFilters)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.WindowNameStorage",{length:0,constructor:function(){this._cache=new Ext.util.MixedCollection,this._load()},key:function(index){return this._cache.keys[index]},getItem:function(key){return this._cache.getByKey(key)},setItem:function(key,value){this._cache.removeAtKey(key),this._cache.add(key,value),this._save()},removeItem:function(key){this._cache.removeAtKey(key),this._save()},clear:function(){this._cache.clear(),this._save()},_load:function(){Ext.each(Ext.JSON.decode(window.name,!0),function(entry){this._cache.add(entry.key,entry.value)},this),this._updateLength()},_save:function(){this._updateLength();var entries=[];this._cache.eachKey(function(key,value){entries.push({key:key,value:value})}),window.name=Ext.JSON.encode(entries)},_updateLength:function(){this.length=this._cache.getCount()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.SessionStorageProvider",{extend:Ext.state.LocalStorageProvider,alias:"state.sessionstorage",statics:{PAGE_PREFIX:"rallypage-",APP_PREFIX:"rallyapp-"},constructor:function(config){if(config=config||{},!config.prefix)throw Error("Must provide a unique per-session prefix");this.callParent([config]),this._purgeOldState()},_purgeOldState:function(){this._isMainPagePrefix(this.prefix)&&this._oldPageStateExists()&&this._removeAllSessionState()},_oldPageStateExists:function(){for(var key,store=this.store,index=store.length-1,prefix=this.prefix,prefixLength=prefix.length,oldPageKeyFound=!1;index>=0;){if(key=store.key(index),oldPageKeyFound||key.substring(0,prefixLength)!==prefix&&this._isMainPagePrefix(key)){oldPageKeyFound=!0;break}index--}return oldPageKeyFound},_removeAllSessionState:function(){for(var key,store=this.store,index=store.length-1;index>=0;)key=store.key(index),this.store.removeItem(key),index--},_isMainPagePrefix:function(prefix){return prefix.substring(0,Rally.state.SessionStorageProvider.PAGE_PREFIX.length)===Rally.state.SessionStorageProvider.PAGE_PREFIX}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.Message",{singleton:!0},function(){Ext.apply(Rally.app.Message,{timeboxScopeChange:"timeboxScopeChange",legacyPageRefreshRequest:"legacypagerefreshrequest"})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.TimeboxScope",{config:{record:null,type:void 0},constructor:function(config){this.initConfig(config),this.callParent(arguments)},getQueryFilter:function(){var filter,typeName=Ext.String.capitalize(this.getType());return filter=this.isScheduled()?this._getQueryFilter(typeName+"."):"milestone"===this.getType()?Ext.create("Rally.data.wsapi.Filter",{property:"Milestones.ObjectID",value:null}):Ext.create("Rally.data.wsapi.Filter",{property:typeName,value:null}),filter.itemId=typeName+"Filter",filter},isApplicable:function(model){return"milestone"===this.getType()?model.hasField("Milestones"):model.hasField(Ext.String.capitalize(this.getType()))},getType:function(){var type=Rally.util.Ref.getTypeFromRef(this.getRecord())||this.type;return type.toLowerCase()},getPlannedVelocity:function(){var deferred=Ext.create("Deft.Deferred");if(this._plannedVelocity)deferred.resolve(this._plannedVelocity);else if(this.getRecord()){var filter=this._getQueryFilter("");Ext.create("Rally.data.wsapi.Store",{model:this.getRecord().self,fetch:["PlannedVelocity"],autoLoad:!0,filters:filter,component:this,listeners:{load:function(store,records){var totalVelocity=_.reduce(records,function(sum,record){return sum+record.get("PlannedVelocity")||0},0);deferred.resolve(totalVelocity)}}})}else deferred.resolve(void 0);return deferred.promise},getRecord:function(){return this.isScheduled()?this.record:null},isScheduled:function(){var timeboxRecord=this.record;return!!timeboxRecord&&Rally.util.Ref.isRefUriWithValidObjectId(timeboxRecord.get("_ref"))},getStartDate:function(){var record=this.getRecord(),startFieldName=this._getStartDateFieldName();return record&&startFieldName&&this.getRecord().get(startFieldName)},getEndDate:function(){return this.getRecord()&&this.getRecord().get(this._getEndDateFieldName())},_getQueryFilter:function(prefix){var startDateField=this._getStartDateFieldName(),endDateField=this._getEndDateFieldName(),record=this.getRecord();return"milestone"===this.getType()?Ext.create("Rally.data.wsapi.Filter",{property:"Milestones",operator:"contains",value:record.get("_ref")}):Rally.data.wsapi.Filter.and([{property:prefix+"Name",value:record.get("Name")},{property:prefix+startDateField,value:Rally.util.DateTime.toUtcIsoString(this.getStartDate())},{property:prefix+endDateField,value:Rally.util.DateTime.toUtcIsoString(this.getEndDate())}])},_getStartDateFieldName:function(){if("milestone"!==this.getType())return"iteration"===this.getType()?"StartDate":"ReleaseStartDate"},_getEndDateFieldName:function(){return"iteration"===this.getType()?"EndDate":"milestone"===this.getType()?"TargetDate":"ReleaseDate"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.Message",{requires:[],singleton:!0},function(){Ext.apply(Rally.clientmetrics.Message,{startSession:"rally.clientmetrics.message.startsession",action:"rally.clientmetrics.message.action",loadBegin:"rally.clientmetrics.message.loadbegin",loadEnd:"rally.clientmetrics.message.loadend",dataBegin:"rally.clientmetrics.message.dataBegin",dataEnd:"rally.clientmetrics.message.dataEnd",error:"rally.clientmetrics.message.error",componentReady:"rally.clientmetrics.message.componentready"})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.ClientMetricsRecordable",{recordStartSession:function(status,defaultParams){var options={defaultParams:defaultParams,status:status};this._clientMetricsPublish(Rally.clientmetrics.Message.startSession,options)},recordAction:function(options){this._clientMetricsPublish(Rally.clientmetrics.Message.action,options)},recordLoadBegin:function(options){this._clientMetricsPublish(Rally.clientmetrics.Message.loadBegin,options)},recordLoadEnd:function(options){this._clientMetricsPublish(Rally.clientmetrics.Message.loadEnd,options)},recordComponentReady:function(options){options=options||{};var component=options.component||this,message=this._clientMetricsGetComponentReadyMessageName(component);return this._clientMetricsPublish(message,component),options.testOnly||this._clientMetricsPublish(Rally.clientmetrics.Message.componentReady,options),component.componentReady=!0,message},_clientMetricsPublish:function(message,options){var messageBus=this.messageBus||this.initialConfig&&this.initialConfig.messageBus||Rally.environment.getMessageBus();options=options||{},options.component=options.component||this,messageBus.publish.call(messageBus,message,options)},_clientMetricsGetComponentReadyMessageName:function(component){return(component.xtype||component.ptype||component.ftype||component)+"-ready"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.settings.Loader",{singleton:!0,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},load:function(options){var deferred=new Deft.Deferred,loadingPromises=[this._loadWorkspaceAndProjectSettings(options),this._loadUserSettings(options)];return Deft.Promise.all(loadingPromises).then({success:function(results){var allSettings=this._mergeAllSettings(results);Ext.callback(options.callback,options.scope,[allSettings]),deferred.resolve(allSettings)},scope:this}),deferred.promise},_loadWorkspaceAndProjectSettings:function(options){var deferred=new Deft.Deferred;options.settingsScope=options.settingsScope||"app",options.requester=options.requester||this,this.recordLoadBegin({description:"loading app preferences",component:options.requester});var loadingPromises=[];return Ext.isObject(options.appScopedSettings)?loadingPromises.push(Deft.promise.Promise.when(options.appScopedSettings)):loadingPromises.push(this._loadSettings("app",options)),options.appSettings&&loadingPromises.push(Deft.Promise.when(options.appSettings)),"workspace"!==options.settingsScope&&"project"!==options.settingsScope||(Ext.isObject(options.workspaceScopedSettings)?loadingPromises.push(Deft.promise.Promise.when(options.workspaceScopedSettings)):loadingPromises.push(this._loadSettings("workspace",options))),"project"===options.settingsScope&&(Ext.isObject(options.projectScopedSettings)?loadingPromises.push(Deft.promise.Promise.when(options.projectScopedSettings)):loadingPromises.push(this._loadSettings("project",options))),Deft.Promise.all(loadingPromises).then({success:function(loadedSettingsGroups){var allSettings=this._mergeAllSettings(loadedSettingsGroups);deferred.resolve(allSettings)},failure:function(error){deferred.reject(error)},scope:this}).always(function(){this.recordLoadEnd({component:options.requester})},this),deferred.promise},_loadUserSettings:function(options){var stateProvider=Ext.state.Manager.getProvider();if(Ext.isFunction(stateProvider.loadAppScopedState)){var prefOpts=Ext.merge({},options);return prefOpts.filterByUser=!0,prefOpts.callback=null,prefOpts.success=null,prefOpts.failure=null,prefOpts=this._getPreferenceOptions(prefOpts.scopeOfUserPrefs||"workspace",prefOpts),Ext.isObject(options.userScopedSettings)&&Ext.isFunction(stateProvider.addAppScopedState)?(stateProvider.addAppScopedState(options.userScopedSettings,prefOpts),Deft.promise.Promise.when(options.userScopedSettings)):stateProvider.loadAppScopedState(prefOpts)}return Deft.promise.Promise.when()},_loadSettings:function(settingsScope,options){var prefOpts=this._getPreferenceOptions(settingsScope,options);return Rally.data.PreferenceManager.load(prefOpts)},_getPreferenceOptions:function(settingsScope,options){return{requester:options.requester,appID:options.appID||options.context.get("appID"),project:"project"===settingsScope?options.context.getProject():null,workspace:"workspace"===settingsScope?options.context.getWorkspace():null,filterByUser:!!options.filterByUser||null,scope:this}},_mergeAllSettings:function(loadedSettingsGroups){return _.reduce(loadedSettingsGroups,function(results,loadedSettingsGroup){return Ext.apply(results,loadedSettingsGroup)},{})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.ModelFactory",{singleton:!0,constructor:function(config){Ext.apply(this,config||{}),this.types={}},registerType:function(type,factory){this.types[this._getCompatibleType(type)]=factory},registerTypes:function(types,factory){_.each(types,function(type){this.registerType(type,factory)},this)},clearTypes:function(){this.types={}},getFactory:function(type){return this.types[this._getCompatibleType(type)]},getModel:function(options){options.type&&this.getFactory(options.type)||Ext.Error.raise("Could not find registered factory for type:  "+options.type);var factory=this.getFactory(options.type);return factory.getModel.call(factory,options)},getModels:function(options){var me=Rally.data.ModelFactory,successFn=options.success,failureFn=options.failure,factories={},promises=[];options.success=Ext.emptyFn,options.failure=Ext.emptyFn,options.types=this._ensureTypesAreDefined(options.types),_.each(options.types,function(type){me.getFactory(me._getCompatibleType(type))||Ext.Error.raise("Factory is not registered for type: "+type);var factory=me.getFactory(me._getCompatibleType(type)).$className;factories[factory]?factories[factory].push(type):factories[factory]=[type]},me),_.each(factories,function(types,className){var factory=Ext.ClassManager.get(className),promise=factory.getModels(Ext.applyIf({types:types},options));void 0===promise&&Ext.Error.raise(className+".getModels should return a value or a promise"),promises.push(promise)});var deferred=new Deft.Deferred;return Deft.Promise.all(promises).then(function(values){successFn&&Ext.callback(successFn,options.scope,[me._flattenPromiseValues(values)],1),deferred.resolve(me._flattenPromiseValues(values))}).otherwise(function(err){failureFn&&Ext.callback(failureFn,options.scope,[err],1),deferred.reject(err)}),deferred.promise},_ensureTypesAreDefined:function(types){return types||Ext.Error.raise('getModels requires "types" to be defined'),types=_.isArray(types)?types:[types],types.length||Ext.Error.raise('getModels requires "types" to be defined'),types},_getCompatibleType:function(type){if(type)return type.toLowerCase().replace(/\s/g,"").split("/")[0]},_flattenPromiseValues:function(values){var flattenedValue={};return _.each(values,function(value){Ext.apply(flattenedValue,value)}),flattenedValue}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.Ranker",{singleton:!0,mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},RANK_FIELDS:{MANUAL:"Rank",DND:"DragAndDropRank",TASK:"TaskIndex"},getRankField:function(model){return"Task"===model.elementName?this.RANK_FIELDS.TASK:model.hasField(this.RANK_FIELDS.DND)?this.RANK_FIELDS.DND:model.hasField(this.RANK_FIELDS.MANUAL)?this.RANK_FIELDS.MANUAL:null},isRankable:function(model){return!!this.getRankField(model)},isRankableRecord:function(record){return record.isUpdatable()&&this.isRankable(record.self)},isStoreSortedByRank:function(store){return this.isStoreSortedByRankAsc(store)||this.isStoreSortedByRankDesc(store)},isStoreSortedByRankAsc:function(store){return this._isStoreSortedByRankInExpectedOrder(store,"asc")||!!store.alwaysSortedByRankAsc},isStoreSortedByRankDesc:function(store){return this._isStoreSortedByRankInExpectedOrder(store,"desc")},isDnDRankable:function(store){return this.isRankable(store.model)&&this.isDnDEnabled(store)&&this.isStoreSortedByRankAsc(store)},isDnDEnabled:function(store){if(store&&store.model&&store.model.isTask())return!0;var workspace=store&&store.context&&store.context.workspace;if(!Ext.isObject(workspace)){var context=Rally.environment.getContext();workspace=context?context.getWorkspace():void 0}return workspace&&workspace.WorkspaceConfiguration&&workspace.WorkspaceConfiguration.DragDropRankingEnabled},isRankField:function(field){return field===this.RANK_FIELDS.MANUAL||field===this.RANK_FIELDS.DND||field===this.RANK_FIELDS.TASK},rankRelative:function(config){this._rank(config.recordToRank,Ext.merge(config.saveOptions||{},{recordsForNotificationMessage:[config.recordToRank,config.relativeRecord],notificationMessage:config.notificationMessage},this.generateRankParameters(config)))},generateRankParameters:function(config){var saveOptions={},rankParamName=this._getRelativeRankPrefix(config.relativeRecord)+("after"===config.position?"Below":"Above"),relativeRecordRef=config.relativeRecord.get("_ref");return config.relativeRecord.isScheduledTestCase()&&(relativeRecordRef=config.relativeRecord.raw.ScheduledTestCase._ref),saveOptions.params={},saveOptions.params[rankParamName]=relativeRecordRef,saveOptions},rankToTop:function(record,config){var options=config||{};this._rank(record,Ext.apply({params:Ext.merge({rankTo:"TOP"},options.params),notificationMessage:"{0} is now ranked highest."},options.saveOptions))},rankToBottom:function(record,config){var options=config||{};this._rank(record,Ext.apply({params:Ext.merge({rankTo:"BOTTOM"},options.params),notificationMessage:"{0} is now ranked lowest."},options.saveOptions))},getFindRankedRecordFn:function(store){return function(options){var cloneConfig=Ext.merge({},store.getInitialConfig(),{autoLoad:!0,sorters:Rally.data.util.Sorter.sorters(Rally.data.Ranker.getRankField(store.model)+(options.highest?" ASC":" DESC")),pageSize:1,listeners:{load:function(store){var highestRankedRecord=store.getAt(0);highestRankedRecord&&Ext.callback(options.success,options.scope,[highestRankedRecord])}},proxy:null});Ext.create(store.$className,cloneConfig)}},loadExtremeRankedRecord:function(store,options){return this._buildExtremeRankStore(store,options).load().then({success:function(records){return this.isStoreSortedByRankAsc(store)&&options.last?_.last(records):_.first(records)},scope:this})},_getSuccessfulNotificationMessage:function(options){var formatParams=[options.notificationMessage||"{0} has been moved"],recordTexts=_.map(options.recordsForNotificationMessage||[],function(record){var formattedId=record.get("FormattedID"),name=Rally.util.String.niceSubstring(record.get("Name"),60,!0);return'"'+(Ext.isEmpty(formattedId)?"":formattedId+": ")+name+'"'});return formatParams=formatParams.concat(recordTexts),Ext.String.format.apply(Ext.String,formatParams)},_buildExtremeRankStore:function(store,options){return options=options||{},Ext.create(store.self,Ext.apply({autoLoad:!1,model:store.model,models:store.models,pageSize:1,fetch:store.fetch,filters:store.filters.getRange(),proxy:store.getProxy(),requester:options.metricsCmp,sorters:[{property:this.getRankField(store.model),direction:options.last?"DESC":"ASC"}]},options.storeConfig))},_isFieldReadOnlyOrRank:function(field){return!field.readOnly||"DragAndDropRank"===field.name},_isStoreSortedByRankInExpectedOrder:function(store,order){if(store.sorters&&1===store.sorters.getCount()){var field=store.model.getField(this.getRankField(store.model)),sorter=store.sorters.getAt(0);return field&&sorter.property===field.name&&this._isFieldReadOnlyOrRank(field)&&sorter.direction.toLowerCase()===order}return!1},_getRelativeRankPrefix:function(record){return"Task"===record.self.elementName?"taskIndex":"rank"},_rank:function(record,saveOptions){record.isScheduledTestCase()&&Ext.apply(saveOptions,{url:Rally.environment.getServer().getWsapiUrl()+Rally.util.Ref.getRelativeUri(record.raw.ScheduledTestCase),appendId:!1}),saveOptions.originalCallback=saveOptions.callback,saveOptions.callback=Ext.bind(this._rankCallback,this,[saveOptions],!0),saveOptions.requester={singleton:this,clientMetricsParent:saveOptions.requester},record.isTask()&&(record.oldTaskIndex=record.get("TaskIndex")),this.recordLoadBegin({description:"Ranking record",component:saveOptions.requester}),saveOptions.recordsForNotificationMessage=saveOptions.recordsForNotificationMessage||[record],Rally.ui.notify.Notifier.showStatus({message:"Moving..."}),record.save(saveOptions)},_rankCallback:function(record,operation,success,saveOptions){success?(this.publish(Rally.Message.objectUpdate,record,[Rally.data.Ranker.getRankField(record.self)],this),Rally.ui.notify.Notifier.show({message:this._getSuccessfulNotificationMessage(saveOptions)})):Rally.data.util.Record.showWsapiErrorNotification(record,operation),this.recordLoadEnd({component:saveOptions.requester}),Ext.callback(saveOptions.originalCallback,saveOptions.scope||this,[record,operation])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.PageableStore",{extend:Ext.data.Store,limit:void 0,filterOnLoad:!1,remoteSort:!0,remoteFilter:!0,pageSize:200,constructor:function(config){this.mergeConfig(config),this.initialConfig=config,this.callParent([this.config])},load:function(options){var opts=options||{};if(!opts.isPaging&&Ext.isDefined(this.limit)&&this.limit>this.pageSize){this.on("beforeload",function(){this.suspendEvents(!1)},this,{single:!0});var origCallback=opts.callback,origScope=opts.scope;opts.callback=Ext.bind(this._loadNext,this,[origCallback,origScope,opts],!0)}this.callParent([opts])},setModel:function(model){this.model=model,this.proxy&&(this.proxy.model=model,this.proxy.reader&&(this.proxy.reader.model=model),this.proxy.writer&&(this.proxy.writer.model=model))},_loadNext:function(records,operation,success,origCallback,origScope,opts){this._shouldLoadMorePages(operation)?this._loadNextPage(Ext.bind(this._loadNext,this,[origCallback,origScope,opts],!0),opts):this._afterDoneLoadingAllPages(operation,success,origCallback,origScope)},_shouldLoadMorePages:function(operation){var page=operation.page,total=Math.min(this.limit,this.getTotalCount()),totalPages=Math.ceil(total/this.pageSize);return totalPages>page},_loadNextPage:function(callback,opts){this.loading=!0,this.nextPage(Ext.apply({},{addRecords:!0,callback:callback,isPaging:!0},opts))},_afterDoneLoadingAllPages:function(operation,success,callback,scope){this.resumeEvents(),this.currentPage=1,this.fireEvent("datachanged",this),this.fireEvent("refresh",this),this.loading=!1,this.fireEvent("load",this,this.data.items,success),Ext.callback(callback,scope,[this.data.items,operation,success])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.WsapiFindRecords",{findExact:function(property,value,start){return this.data.findIndexBy(function(rec){return Ext.isObject(value)?rec.get(property)===value[property]:rec.get(property)===value},this,start)}})}(),function(){var Ext=window.Ext4||window.Ext;
Ext.define("Rally.data.wsapi.RecordUpdatable",{refreshRecords:function(storeRecords){var promises=_.map(storeRecords,function(storeRecord){var deferred=new Deft.promise.Deferred;return this.reloadRecord(storeRecord,{success:function(record){_.invoke(storeRecord.stores,"suspendEvents");var newData=_(record.raw).keys().reduce(function(accum,key){return accum[key]=record.get(key),accum},{});storeRecord.set(newData),_.invoke(storeRecord.stores,"resumeEvents"),storeRecord.commit(),deferred.resolve(storeRecord)},failure:function(){this.remove(storeRecord),deferred.resolve(storeRecord)},scope:this}),deferred.promise},this);return promises.length?Deft.promise.Promise.all(promises):Deft.Promise.when([])},getAssociatedRecords:function(record){return _.compact(_.map(record.getAssociatedRefs(),function(associatedRef){return this.findExactRecord(associatedRef)},this))}})}(),function(){var Ext=window.Ext4||window.Ext,wsapiMaxPageSize=200;Ext.define("Rally.data.wsapi.Store",{extend:Rally.data.PageableStore,alias:["store.rallywsapidatastore","store.rallywsapistore"],alternateClassName:["Rally.data.WsapiDataStore"],mixins:{messageable:Rally.Messageable,findRecords:Rally.data.WsapiFindRecords,recordUpdatable:Rally.data.wsapi.RecordUpdatable},statics:{wsapiMaxPageSize:wsapiMaxPageSize},autoSync:!1,pageSize:wsapiMaxPageSize,fetch:void 0,useShallowFetch:!1,enablePostGet:!1,compact:void 0,includeSchema:!1,context:void 0,wsapiVersion:void 0,search:void 0,enableRankFieldParameterAutoMapping:!0,constructor:function(config){config.proxy?this._customProxyInUse=!0:Ext.isString(config.model)&&(config.proxy=Rally.environment.getIoProvider().getProxy({wsapiVersion:config.wsapiVersion})),this.callParent(arguments)},load:function(options){if(this.loading=!0,options=options||{},Ext.isFunction(options)&&(options={callback:options}),!this.model&&Ext.isString(this.initialConfig.model))return this._hydrateModelAndLoad(options);var promise=this._wrapCallbackWithPromise(options);return this._setFetch(options),options.useShallowFetch=this.useShallowFetch,options.fetch=this.fetch,options.search=this.search,options.context=this.context,options.requester=options.requester||this.requester,options.enablePostGet=this.enablePostGet,options.includeSchema=this.includeSchema,options.compact=this.compact,this.url&&(options.url=this.url),this.callParent([options]),promise},sync:function(options){options=options||{};var deferred=Ext.create("Deft.Deferred"),me=this,opts=Ext.apply({},{callback:function(batch,syncOptions){Ext.callback(options.callback,options.scope||me,[batch,syncOptions]),batch.hasException?deferred.reject(batch):deferred.resolve(batch)}},options);return this.callParent([opts]),deferred.promise},setFilter:function(filter){this.clearFilter(!0),_.each(this.decodeFilters(Ext.Array.from(filter)),function(filter){this.filters.add(filter)},this)},reloadRecord:function(record,options){options=options||{};var deferred=Ext.create("Deft.promise.Deferred"),operation=Ext.create("Ext.data.Operation",Ext.merge({action:"read",filters:this.filters.getRange().concat({property:"ObjectID",value:record.getId?record.getId():record}),limit:1,enablePostGet:this.enablePostGet,requester:this,context:this.context},options));return operation.useShallowFetch=this.useShallowFetch,operation.fetch=this.fetch||this._getFetchFields(this.model),this.model.getProxy().read(operation,function(op){if(op.wasSuccessful()&&op.getRecords()&&op.getRecords().length){var record=op.getRecords()[0];Ext.callback(options.success,options.scope,[record]),deferred.resolve(record)}else Ext.callback(options.failure,options.scope,[op]),deferred.reject(op)},this),deferred.promise},hydrateModel:function(){return Rally.data.ModelFactory.getModel({type:this.initialConfig.model,context:this.context,wsapiVersion:this.wsapiVersion,requester:this.requester}).then({success:function(model){return this.model=model,this._customProxyInUse?this.proxy.setModel(model):this.proxy=model.getProxy(),model},failure:function(msg){return Ext.Error.raise(msg),msg},scope:this})},sums:{},getSums:function(){return this.sums},setSums:function(sums){this.sums=sums},_wrapCallbackWithPromise:function(options){var me=this,deferred=new Deft.Deferred,promise=deferred.promise,originalCallback=options.callback;return options.callback=function(records,operation,success){operation.resultSet&&operation.resultSet.sums&&me.setSums(operation.resultSet.sums),Ext.isFunction(originalCallback)&&originalCallback.apply(options.scope||me,arguments),me._cleanUpCallbackForReload(options,originalCallback),me._cleanUpCallbackForReload(me.lastOptions,originalCallback),success?deferred.resolve(records,operation):deferred.reject(operation),deferred=null,options=null,me=null},promise},_cleanUpCallbackForReload:function(options,callback){options&&(options.callback=callback)},_hydrateModelAndLoad:function(options){var deferred=new Deft.Deferred;return this.hydrateModel().then({success:function(model){this.load(options).then({success:Ext.bind(deferred.resolve,deferred),failure:Ext.bind(deferred.reject,deferred)})},scope:this}),deferred.promise},_getModelFailureMessage:function(config){return"Invalid model type specified: "+config.model},filter:function(){this.currentPage=1,this.callParent(arguments)},prefetch:function(options){return options=options||{},options.fetch=this.fetch.join(","),this.callParent([options])},clearFilter:function(suppressEvent,suppressRemoteFilter){var remoteFilter=this.remoteFilter;this.remoteFilter=!suppressRemoteFilter&&remoteFilter;try{var results=this.callParent(arguments);return results}finally{this.remoteFilter=remoteFilter}},getItems:function(){return Ext.Array.pluck(this.getRange(),"raw")},getRecords:function(){var items=[];return this.each(function(storeItem){items.push(storeItem)}),items},loadPages:function(options){var totalCount,pageCount,collectedRecords=[],pageNum=options.startPage||1,nextPage=Ext.bind(function(){return options.endPage&&pageNum>options.endPage?Ext.callback(options.callback,options.scope,[collectedRecords]):void this.loadPage(pageNum,{callback:function(records){totalCount=totalCount||this.getTotalCount(),pageCount=pageCount||Math.ceil(totalCount/this.pageSize)||1,options.endPage=options.endPage||pageCount,collectedRecords=collectedRecords.concat(records),pageNum++,nextPage()},scope:this})},this);nextPage()},clone:function(){var cloneConfig=Ext.merge(this.initialConfig,{sorters:this.getSorters()});return Ext.create(this.self,cloneConfig)},findExact:function(field,value,start){return this.mixins.findRecords.findExact.call(this,field,value,start)},findExactRecord:function(field,value){if(value)return this.findRecord(field,value,void 0,void 0,void 0,!0);try{var ref=Rally.util.Ref.getRefObject(field);return this.findExactRecord("_ref",ref.getRelativeUri())}catch(e){}return null},findRecordEvenIfFiltered:function(field,value){if(this.isFiltered()&&this.snapshot&&this.snapshot.items){var match=_.find(this.snapshot.items,function(item){return item.get(field)===value});return"undefined"!=typeof match?match:null}return this.findExactRecord(field,value)},_setFetch:function(options){this.fetch=options.fetch||this.fetch||this._getFetchFields(this.model),this.enableRankFieldParameterAutoMapping&&(this._convertFetch(),this._convertSorters())},_getFetchFields:function(model){return _.pluck(_.isFunction(model.getNonCollectionFields)?model.getNonCollectionFields():[],"name")},_convertFetch:function(){var fetch=this.fetch;Ext.isString(fetch)&&(fetch=fetch.split(",")),Ext.isArray(fetch)&&(this.fetch=_.uniq(_.map(fetch,function(item){return Rally.data.Ranker.isRankField(item)&&(item=Rally.data.Ranker.getRankField(this.model)),item},this)))},_convertSorters:function(){this.sorters.each(function(sorter){Rally.data.Ranker.isRankField(sorter.property)&&(sorter.property=Rally.data.Ranker.getRankField(this.model))},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.realtime.Realtime",{mixins:[Rally.clientmetrics.ClientMetricsRecordable,Rally.Messageable,Rally.data.wsapi.Store],enabled:!1,singleton:!0,traceIds:[],connection:{},subscribedProjects:[],projects:{},setup:function(config){this.enabled=!0,this.traceIds=[],this.connection={},this.subscribedProjects=[],this.projects={},Ext.Function.interceptBefore(XMLHttpRequest.prototype,"setRequestHeader",function(header,value){try{"x-trace-id"===header.toLowerCase()&&this._addTraceId({timestamp:(new Date).getTime(),id:value})}finally{return!0}},this),this._loadProjectHierarchy(Ext.bind(this.launch,this)),this.subscribe("projectpickerupdated",this._subscribeToGlobalProjects,this)},_traceIdBufferSize:1e3,_subscribeToGlobalProjects:function(e){this.unsubscribeComponent("global"),this.subscribeComponent(Rally.environment.getContext().getProject()._refObjectUUID,Rally.environment.getContext().getScope().up,Rally.environment.getContext().getScope().down)},_addTraceId:function(traceObject){traceObject.id&&(_.contains(this.traceIds,traceObject.id)||this.traceIds.unshift(traceObject),this.traceIds.length>this._traceIdBufferSize&&this.traceIds.pop())},getSubscribeMessage:function(projectUuid){return JSON.stringify({uri:"/_subscribe","request-method":"post",body:{topic:projectUuid}})},getUnSubscribeMessage:function(projectUuid){return JSON.stringify({uri:"/_unsubscribe","request-method":"post",body:{topic:projectUuid}})},getStateFieldValue:function(data,name){var field=_.find(_.values(data.data.state),{name:name});return field&&field.value},getExtCompatibleRecordData:function(data,Model,useOldValue){var values=_.values(data.data.state).concat(_.values(data.data.changes)),recordData=_.reduce(values,function(rd,v){return rd[v.name]=useOldValue?v.old_value:v.value,rd},{});return recordData._type=Model.typePath,_.filter(recordData,_.isObject).map(function(refObject){refObject._ref&&(refObject._ref=refObject._ref.substring(refObject._ref.indexOf("/",1)))}),recordData},getTypeFromScope:function(data){if(!data||!data.data||!data.data.scope)return null;var match=data.data.scope.match(/([^\/]*)$/);if(!match)return null;var typeString=match.pop(),typeMap={"user-story":"UserStory"};return typeMap[typeString]||typeString},buildRecord:function(data,callback){var recordType=this.getStateFieldValue(data,"object_type")||this.getTypeFromScope(data);if(recordType){var me=this;Rally.data.wsapi.ModelFactory.getModel({type:recordType,success:function(Model){var record=new Model(me.getExtCompatibleRecordData(data,Model,"Recycled"===data.data.action));callback(record)}})}},getChangedFields:function(data){return _.pluck(_.values(data.data.changes),"name")},getMessageToPublish:function(data){if(!data||!data.data||!data.data.action)return null;var action=data.data.action,actionMap={Updated:Rally.Message.objectUpdate,Created:Rally.Message.objectCreate,Recycled:Rally.Message.objectDestroy};return actionMap[action]},_shimThatRecord:function(record){var type=record.data._type;record.getRef=function(){return{getType:function(){return type}}},record.data._ref="/"+type+"/"+record.data.ObjectID},isRealtimeMessage:function(record){return!!(record&&record.data&&record.data._changedFields)},getArgsForMessage:function(message,record,changedFields,cmp){return"objectupdate"===message&&changedFields.length>2&&0!==record.data._type.indexOf("portfolioitem")&&(record.data._changedFields=changedFields),this._shimThatRecord(record),"objectupdate"===message||"objectcreate"===message?[message,record,changedFields,cmp]:[message,record,cmp,[]]},_shouldPublish:function(message,slug){return message&&slug&&0!==slug.indexOf("/detail/")},publishObjectChanged:function(data,cmp){if(data.data&&data.data.transaction){var foundId=_.find(this.traceIds,function(entry){return entry.id===data.data.transaction.trace_id});if(foundId)return void this.recordAction({description:"realtime message lag",miscData:{realtimeMessageLag:(new Date).getTime()-data.data.transaction.timestamp}})}var message=this.getMessageToPublish(data),me=this,almStr="alm",slug=Rally[almStr].navigation.NavigationStore.getCurrentNavState().getSlug();this._shouldPublish(message,slug)&&this.buildRecord(data,function(record){var changedFields=me.getChangedFields(data),args=me.getArgsForMessage(message,record,changedFields,cmp),mb=Rally.environment.getMessageBus();mb.publish.apply(mb,args)})},subscribeToRealtime:function(cmp,projectRefUUID){this._subscribe(projectRefUUID),_.find(this.subscribedProjects,{id:cmp,project:projectRefUUID})||this.subscribedProjects.push({id:cmp,project:projectRefUUID})},_subscribe:function(projectRefUUID){this.isWebSocketReady()&&this.publishMessage(this.getSubscribeMessage(projectRefUUID))},publishMessage:function(msg){this.connection.send(msg)},unsubscribeComponent:function(cmp){var id=cmp+"",cmpSubscribedProjects=_.flatten(_.filter(this.subscribedProjects,{id:id}),"projects");this.subscribedProjects=_.reject(this.subscribedProjects,{id:id}),_.each(cmpSubscribedProjects,function(e){_.find(this.subscribedProjects,{project:e})||this.unsubscribeProject(e)},this)},unsubscribeProject:function(projectRefUUID){this.isWebSocketReady()&&this.publishMessage(this.getUnSubscribeMessage(projectRefUUID))},subscribeComponent:function(currentProject,scopeUp,scopeDown,cmp){var id=cmp||"global";this.subscribeToRealtime(id,currentProject),scopeUp!==!0&&"true"!==scopeUp||_.each(this.getProjectsScopedUp(currentProject),function(e){this.subscribeToRealtime(id,e._refObjectUUID)},this),scopeDown!==!0&&"true"!==scopeDown||_.each(this.getProjectsScopedDown(currentProject),function(e){this.subscribeToRealtime(id,e._refObjectUUID)},this)},connect:function(){var protocol=location.protocol.match(/https/)?"wss":"ws";websocket_url=protocol+"://"+location.host+"/notifications/_websocket/",this.connection=new this.ReconnectingWebSocket(websocket_url);var me=this;return this.connection.onopen=function(){me.subscribedProjects.length>0?_.each(me.subscribedProjects,function(e){me.subscribeToRealtime(e.id,e.project)}):me._subscribeToGlobalProjects()},this.connection.onerror=function(e){},this.connection},launch:function(){var websocket=this.connect();websocket.onmessage=Ext.bind(function(e){var data=JSON.parse(e.data);this.publishObjectChanged(data,this)},this)},_loadProjectHierarchy:function(callback){Ext.create("Rally.data.WsapiDataStore",{autoLoad:{callback:function(records){this.projects=_.map(_.pluck(records,"data"),function(entry){return _.pick(entry,["_ref","_refObjectUUID","Name","Parent"])}),callback()},scope:this},context:{project:null,workspace:"/workspace/"+Rally.environment.getContext().getWorkspace().OID},fetch:["Name","Parent"],filters:[{property:"State",value:"Open"}],limit:1/0,model:Ext.identityFn("Project"),sorters:[{property:"Name"}]})},getProjectsScopedUp:function(projectID){var project=_.find(this.projects,{_refObjectUUID:projectID});return this._getParents(project)||[]},_getParents:function(project){var parents=[];if(project&&project.Parent){var parent=_.find(this.projects,{_refObjectUUID:project.Parent._refObjectUUID});parents=parents.concat(parent);var p=this._getParents(parent);return p&&(parents=parents.concat(p)),parents}return null},getProjectsScopedDown:function(projectId){return _.filter(this._getChildren(projectId),function(e){return e})||[]},_getChildren:function(projectId){var children=[];if(projectId){var c=_.where(this.projects,{Parent:{_refObjectUUID:projectId}});if(c&&c.length>0){children=children.concat(c);var grandChildren=_.map(c,function(e){return this._getChildren(e._refObjectUUID)},this);if(grandChildren&&grandChildren.length>0)return children.concat(grandChildren[0])}}return children},isWebSocketReady:function(){return!_.isUndefined(this.connection)&&this.connection.readyState===WebSocket.OPEN},ReconnectingWebSocket:function(url,protocols){function connect(reconnectAttempt){if(!(reconnectAttempt&&reconnectCounter>self.maxTries)){ws=new WebSocket(url,protocols),reconnectAttempt?reconnectCounter+=1:reconnectCounter=0,self.onconnecting();var localWs=ws,timeout=setTimeout(function(){timedOut=!0,localWs.close(),timedOut=!1},self.timeoutInterval);ws.onopen=function(event){clearTimeout(timeout),self.readyState=WebSocket.OPEN,reconnectAttempt=!1,self.onopen(event)},ws.onclose=function(event){clearTimeout(timeout),ws=null,forcedClose?(self.readyState=WebSocket.CLOSED,self.onclose(event)):(self.readyState=WebSocket.CONNECTING,self.onconnecting(),reconnectAttempt||timedOut||self.onclose(event),setTimeout(function(){connect(!0)},self.reconnectInterval))},ws.onmessage=function(event){self.onmessage(event)},ws.onerror=function(event){self.onerror(event)}}}protocols=protocols||[],this.debug=!1,this.reconnectInterval=2e3,this.timeoutInterval=5e3,this.maxTries=3;var ws,self=this,forcedClose=!1,timedOut=!1,reconnectCounter=0;this.url=url,this.protocols=protocols,this.readyState=WebSocket.CONNECTING,this.URL=url,this.onopen=function(event){},this.onclose=function(event){},this.onconnecting=function(event){},this.onmessage=function(event){},this.onerror=function(event){},connect(url),this.send=function(data){if(ws)return ws.send(data);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(){forcedClose=!0,ws&&ws.close()},this.refresh=function(){ws&&ws.close()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.realtime.RealtimePlugin",{extend:Ext.AbstractPlugin,alias:"plugin.rallyrealtime",init:function(cmp){this.cmp=cmp,this.cmp.mon(this.cmp,"ready",this.subscribe,this,{single:!0})},subscribe:function(){try{Rally.environment.getContext().context.scope.up===this.cmp.context.getProjectScopeUp()&&Rally.environment.getContext().context.scope.down===this.cmp.context.getProjectScopeDown()&&Rally.environment.getContext().getProject()===this.cmp.context.getProject()||Rally.realtime.Realtime.subscribeComponent(this.cmp.context.getProject()._refObjectUUID,this.cmp.context.getProjectScopeUp(),this.cmp.context.getProjectScopeDown(),this.cmp.getId())}finally{}},destroy:function(){Rally.realtime.Realtime.unsubscribeComponent(this.cmp.getId())}})}(),function(){var Ext=window.Ext4||window.Ext,PROJECT_FETCH=["ObjectID","Name","State","Workspace","SchemaVersion","WorkspaceConfiguration","DateFormat","DateTimeFormat","DragDropRankingEnabled","BuildandChangesetEnabled","TimeZone","WorkDays","IterationEstimateUnitName","ReleaseEstimateUnitName","TaskUnitName","Children"].join(",");Ext.define("Rally.data.ScopeLoader",{singleton:!0,cachingEnabled:!1,cache:{},enableCaching:function(cachingEnabled){this.cachingEnabled=cachingEnabled},loadScope:function(options){var deferred=new Deft.Deferred,params={fetch:PROJECT_FETCH},scope=this._getScopeFromCache(options.type,options.id);return scope?deferred.resolve(scope):Rally.environment.getIoProvider().httpGet({requester:options.requester||this,params:params,enableCaching:!0,enableQueuing:!0,item:Ext.String.format("/{0}/{1}",options.type,options.id),success:function(scope){this.cacheScope(options.type,options.id,scope),deferred.resolve(scope)},failure:function(response){var errorMsg;errorMsg=_.isArray(response)?response[0]:response.responseText,deferred.reject(errorMsg)},scope:this}),deferred.promise},cacheScope:function(type,oid,scope){this.cachingEnabled&&(this.cache[type.toLowerCase()+":"+oid]=scope)},clear:function(){this.cache={}},_getScopeFromCache:function(type,oid){return this.cache[type.toLowerCase()+":"+oid]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.App",{alias:"widget.rallyapp",extend:Ext.Container,mixins:[Rally.Messageable,Rally.clientmetrics.ClientMetricsRecordable],plugins:[],autoScroll:!0,config:{context:void 0,settings:{},defaultSettings:{}},appName:void 0,settingsScope:"app",projectScopeable:!0,constructor:function(config){this.mergeConfig(config),Rally.realtime.Realtime.enabled&&this.plugins.push({ptype:"rallyrealtime"}),this.callParent([this.config])},initEvents:function(){this.callParent(arguments),this.addEvents("beforelaunch","contentupdated","preferencesaved","ready","settingsneeded")},initComponent:function(){this.callParent(arguments),this.loadSettingsAndLaunch(),this.addCls("rally-app"),this.isFullPageApp&&this.addCls("full-page-app"),this.subscribe(this,Rally.app.Message.timeboxScopeChange,this.onTimeboxScopeChange,this)},loadSettingsAndLaunch:function(){this.getAppId()?(this.stateful&&!this.stateId&&(this.stateId=this.getContext().getScopedStateId("appState")),Deft.Chain.pipeline([this._loadScope,this._loadSettings,this._applyDefaultSettingsAndLaunch],this)):this._applyDefaultSettingsAndLaunch({})},_loadSettings:function(){return Rally.app.settings.Loader.load({appSettings:this.settings,context:this.getContext(),requester:this,scope:this,scopeOfUserPrefs:this.scopeOfUserPrefs,settingsScope:this.settingsScope,appScopedSettings:this.appScopedSettings,workspaceScopedSettings:this.workspaceScopedSettings,projectScopedSettings:this.projectScopedSettings,userScopedSettings:this.userScopedSettings})},_getSettingsScopedProjectRef:function(){var contextProject=this.getContext().getProject();return this._hasAppProjectSettings()?contextProject:this._hasDashboardProjectSettings()?"/project/"+contextProject:void 0},_hasAppProjectSettings:function(){return Ext.isString(this.getContext().getProject())},_hasDashboardProjectSettings:function(){return Ext.isNumber(this.getContext().getProject())},_loadScope:function(){var projectRef=this._getSettingsScopedProjectRef();return projectRef?this._loadProject(projectRef).then({success:this._setSettingsScopedProject,failure:function(message){this.add({xtype:"panel",cls:"no-data",html:"<p>"+message+"</p>"})},scope:this}):Deft.Promise.when()},_setSettingsScopedProject:function(project){var context=this.getContext();this._hasDashboardProjectSettings()&&(this.projectScopedSettings=null),context.setProject(project),context.setWorkspace(project.Workspace)},_loadProject:function(projectRef){return Rally.data.ScopeLoader.loadScope({type:"project",id:Rally.util.Ref.getOidFromRef(projectRef),requester:this})},_applyDefaultSettingsAndLaunch:function(scopedSettings){Ext.apply(this.settings,scopedSettings),Ext.applyIf(this.settings,this.defaultSettings),this.initState(),this.fireEvent("beforelaunch",this)!==!1&&this.launch(),this.fireEvent("ready",this)},getSetting:function(name){var settingValue=this.getSettings()[name];return"true"===settingValue||"false"!==settingValue&&(isNaN(settingValue)||isNaN(parseFloat(settingValue))?settingValue:parseFloat(settingValue))},updateSettingsValues:function(options){Rally.data.PreferenceManager.update(Ext.apply(this._getAppSettingsLoadOptions(),{requester:this,settings:options.settings,success:function(updatedSettings){Ext.apply(this.settings,updatedSettings),options.success&&options.success.call(options.scope)},scope:this}))},removeSetting:function(options){Rally.data.PreferenceManager.remove(Ext.apply(this._getAppSettingsLoadOptions(),{requester:this,filterByName:options.name,success:function(){delete this.settings[options.name],options.success&&options.success.call(options.scope)},scope:this}))},_getAppSettingsLoadOptions:function(settingsScope){settingsScope=settingsScope||this.settingsScope;var loadOptions={appID:this.getAppId()};return"project"===settingsScope?loadOptions.project=this.getContext().getProject():"workspace"===settingsScope&&(loadOptions.workspace=this.getContext().getWorkspace()),loadOptions},getAppId:function(){return this.getContext().get("appID")},launch:Ext.emptyFn,getOptions:function(){return[]},getSettingsFields:function(){return[]},getUserSettingsFields:function(){return[]},showSettings:function(options){options=options||{};var listeners=options.listeners;return this._appSettings=Ext.create("Rally.app.AppSettings",Ext.apply({fields:this.getSettingsFields(),userFields:this.getUserSettingsFields(),settings:this.getSettings(),defaultSettings:this.getDefaultSettings(),context:this.getContext(),settingsScope:this.settingsScope,listeners:{cancel:this.hideSettings,save:this._onSettingsSaved,scope:this}},_.omit(options,"listeners"))),listeners&&this._appSettings.on(listeners),this.hide(),this._appSettings.getEl()||this.up().add(this._appSettings),this._appSettings},_onSettingsSaved:function(settings){Ext.apply(this.settings,settings),this.hideSettings(),this.onSettingsUpdate(settings)},hideSettings:function(){this._appSettings&&(this._appSettings.destroy(),delete this._appSettings),this.show()},onSettingsUpdate:function(settings){},onTimeboxScopeChange:function(timeboxScope){this.getContext().setTimeboxScope(timeboxScope)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tooltip.ToolTippable",{mixins:{observable:Ext.util.Observable},toolTipType:"Rally.ui.tooltip.ToolTip",toolTipText:void 0,toolTipConfig:void 0,toolTipPreferenceKey:void 0,showToolTipWithPreference:!0,buildToolTip:function(){this.toolTipText&&Ext.isEmpty(this.toolTipConfig)&&(this.toolTipConfig={html:'<div class="tooltip-text">'+this.toolTipText+"</div>",anchor:"top"}),Ext.isEmpty(this.toolTipConfig)||(this.toolTipPreferenceKey?this._getPreferenceAndBuildToolTip():this._buildToolTip(this.toolTipConfig,!1))},setToolTipText:function(tipText){this.toolTipText=tipText,this.toolTip&&this.toolTip.hide()},getToolTipTargetEl:function(){return this.el.dom},disableToolTip:function(){this.toolTip&&this.toolTip.hide(),this.addCls("hide-tooltip")},enableToolTip:function(){this.removeCls("hide-tooltip")},_getPreferenceAndBuildToolTip:function(){Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:this.toolTipPreferenceKey,success:this._onPreferenceQuery,scope:this})},_onPreferenceQuery:function(pref){var showNow=!1,config=Ext.apply({},this.toolTipConfig);if("true"!==pref[this.toolTipPreferenceKey])Ext.applyIf(config,{closableOnce:!0}),showNow=!0;else if(!this.showToolTipWithPreference)return;this._buildToolTip(config,showNow)},_buildToolTip:function(config,showNow){var toolTipTarget=this.getToolTipTargetEl();toolTipTarget&&(this.toolTip=this._createToolTip(config,toolTipTarget),this.on("destroy",function(){Ext.destroy(this.toolTip)},this),this.mon(this.toolTip,{destroy:function(){this.toolTip=null},beforeclose:this._saveToolTipPreference,beforeshow:this._onBeforeShowToolTip,scope:this}),showNow&&this.toolTip.showNow())},_onBeforeShowToolTip:function(){if(this.hasCls("hide-tooltip"))return!1;if(this.toolTipText&&this.toolTip)if(this.toolTip.getEl()){var div=this.toolTip.getEl().query(".tooltip-text")[0];div&&(div.innerHTML=this.toolTipText)}else this.toolTip.html='<div class="tooltip-text">'+this.toolTipText+"</div>"},_createToolTip:function(config,toolTipTarget){return Ext.create(this.toolTipType,Ext.apply({target:toolTipTarget},config))},_saveToolTipPreference:function(){if(this.toolTipPreferenceKey){var value="true",settings={};settings[this.toolTipPreferenceKey]=value,Rally.data.PreferenceManager.update({filterByUser:!0,settings:settings})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.Button",{extend:Ext.Button,alias:"widget.rallybutton",mixins:{tooltippable:Rally.ui.tooltip.ToolTippable},clientMetrics:{event:"click",descriptionProperty:"userAction",description:"clicked"},config:{iconOnly:!1,border:0,toolTipConfig:null,elTooltip:"",betaBadge:!1},handleMouseEvents:!1,cls:"primary rly-small",constructor:function(config){this.mergeConfig(config),this.iconOnly&&(this.style=this.style||{},this.style.background="none"),!Ext.isDefined(this.userAction)&&Ext.isString(this.text)&&(this.userAction="clicked "+this.text),this.betaBadge&&(this.renderTpl=new Ext.XTemplate(this.renderTpl.html+'<div class="button-beta-badge">Beta</div>')),this.callParent([this.config])},afterRender:function(){this.callParent(arguments),this.getEl().set({role:"button"}),this.elTooltip&&!Ext.isObject(this.toolTipConfig)?this.getEl().set({title:this.elTooltip}):this.buildToolTip()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.Filter",{alternateClassName:["Rally.data.QueryFilter"],extend:Ext.util.Filter,statics:{fromExtFilter:function(filter){if(!filter.property)return null;var operator=filter.operator;return operator||(operator=filter.anyMatch?"Contains":"="),Ext.create("Rally.data.wsapi.Filter",{property:filter.property,operator:operator,value:filter.value})},fromQueryString:function(query){var parser=Ext.create("Rally.data.util.QueryStringParser",{string:query});return parser.parseExpression()},and:function(queries){return Rally.data.wsapi.Filter._joinQueries(queries,"and")},or:function(queries){return Rally.data.wsapi.Filter._joinQueries(queries,"or")},_joinQueries:function(queries,joinOperator){var joined=null,className="Rally.data.wsapi.Filter";return Ext.each(queries,function(query){var q=Ext.getClassName(query)===className?query:Ext.create(className,query);joined=joined?joined[joinOperator](q):q}),joined}},config:{operator:"="},root:"data",constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},_createQueryString:function(property,operator,value){return Ext.isDefined(value)?null===value&&(value="null"):value='""',"("+property.toString()+" "+operator+" "+value.toString()+")"},_joinQuery:function(filter,joinOperator){var other;return other=filter._createQueryString&&filter.operator?filter:Rally.data.wsapi.Filter.fromExtFilter(filter),Ext.create("Rally.data.wsapi.Filter",{property:this,operator:joinOperator,value:other,filterFn:function(){return!0}})},toString:function(){var value=this.value;if(Ext.isDate(value)&&(value=Rally.util.DateTime.toIsoString(value)),Ext.isString(value)){value=value.replace(/([^\\]"|^")/g,function(s){return s.replace(/((?=[^\\])"|^")/g,"\\$&")});var backslashes=/(\\+(?!"))/g;value=value.replace(backslashes,function(s){return s.length%2===0?s:s+"\\"}),value=Ext.String.format('"{0}"',value)}return this._createQueryString(this.property,this.operator,value)},and:function(filter){return this._joinQuery(filter,"AND")},or:function(filter){return this._joinQuery(filter,"OR")},clone:function(){return Rally.data.wsapi.Filter.fromQueryString(this.toString())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.DeepCopy",{singleton:!0,copy:function(obj){if(null===obj||void 0===obj||"object"!=typeof obj)return obj;var newObj;if(Ext.isArray(obj)){newObj=[];for(var i=0;i<obj.length;i++)newObj.push(Rally.util.DeepCopy.copy(obj[i]))}else{newObj={};for(var attr in obj)obj.hasOwnProperty(attr)&&(newObj[attr]=Rally.util.DeepCopy.copy(obj[attr]))}return newObj}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.ComboBox",{extend:Ext.form.field.ComboBox,alias:"widget.rallycombobox",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},clientMetrics:[{endEvent:"ready",description:"data loaded"},{method:"onListSelectionChange",description:"combobox value changed"},{event:"expand",description:"combobox expanded"}],inheritableStatics:{queryDelay:500},config:{showArrows:!1,arrowUserAction:"Arrow value changed",invertArrows:!0,componentCls:"rui-triggerfield",overCls:"combobox-over",valueField:"_ref",displayField:"_refObjectName",matchFieldWidth:!1,labelSeparator:"",storeConfig:{},storeType:"Rally.data.wsapi.Store",listConfig:{loadMask:!1,emptyText:"No Items Found",deferEmptyText:!1,hideMode:"visibility"},stateful:!1,stateId:null,forceSelection:!0,defaultSelectionPosition:"first",autoSelectCurrentItem:!0,autoSelect:!0,autoExpand:!1,enableKeyEvents:!0,shouldRespondToScopeChange:!1,allowNoEntry:!1,noEntryText:"-- No Entry --",noEntryValue:null,allowClear:!1,clearText:"-- Clear --",clearValue:"",context:void 0},constructor:function(config){config=config||{},config.storeConfig&&!config.storeConfig.remoteFilter||config.store&&!config.store.remoteFilter?this.queryMode="local":this.lastQuery="";var displayField=config.displayField||this.displayField;config.multiSelect&&(config=Ext.merge({cls:"rally-checkbox-combobox",autoSelect:!1,editable:!1,defaultSelectionPosition:null,allowClear:!1,displayTpl:this._getMultiSelectDisplayTpl(),listConfig:{cls:"rally-checkbox-boundlist",itemTpl:this._getMultiSelectListItemTpl(displayField)}},config)),config.listConfig&&!config.listConfig.itemTpl&&(this.listConfig.itemTpl=new Ext.XTemplate("{"+displayField+":htmlEncode}")),
config.onChangeUserAction&&Ext.applyIf(config.listConfig,{onChangeUserAction:config.onChangeUserAction}),this.mergeConfig(config),this.callParent([this.config]),this.originalAutoLoad?this.store.load():this.store.getCount()>0&&(this._onStoreLoad(this.store),this.setDefaultValue(),this.onReady());var bufferDelay=Ext.isNumber(this.queryDelay)&&this.queryDelay>100?this.queryDelay-100:0;this._bufferedRecordTypeAction=Ext.Function.createBuffered(this._recordTypeAction,bufferDelay,this)},initEvents:function(){this.callParent(arguments),!this.editable&&this.autoExpand&&this.mun(this.inputEl,"click",this.onTriggerClick,this)},initComponent:function(){var storeListeners;this.addEvents("ready","setvalue"),this.store||(this.originalAutoLoad=this.storeConfig.autoLoad,delete this.storeConfig.autoLoad,storeListeners=this.storeConfig.listeners,delete this.storeConfig.listeners,Ext.applyIf(this.storeConfig,{requester:this}),this.context&&!this.storeConfig.context&&(this.storeConfig.context=this.context.getDataContext()),this.store=Ext.create(this.storeType,this.storeConfig)),this.stateful&&(this.stateId||Ext.Error.raise("When stateful is enabled, you must provide a stateId!"),this.on("staterestore",this._onStateRestore,this,{single:!0})),this.callParent(arguments),this.store.on("load",this._onStoreLoad,this),this.store.on("load",this._setDefaultValueOnLoad,this,{single:!0}),this.store.on("load",function(){this.onReady()},this,{single:!0}),this.store.on(storeListeners),this.on("boxready",this._onBoxReady,this,{single:!0}),this.on("focus",this._onFocus,this),this.on("blur",this._onBlur,this),this.on("keyup",this._onKeyUp,this),this.autoExpand&&this.on("focus",this.expand,this),this.autoSelectCurrentItem&&this.on("expand",this._highlightCurrentValue,this),this.allowClear&&this.on("select",this._onSelect,this)},destroy:function(){this.callParent(arguments),delete this.config,delete this.initialConfig},refreshStore:function(){this.store.load()},_setDefaultValueOnLoad:function(store,records,successful){successful&&this.setDefaultValue()},getRecord:function(){return this.findRecordByValue(this.getValue())},onKeyDown:function(e,el){this.editable||e.getKey()!==e.BACKSPACE||e.stopEvent()},onEditorEnter:function(event){this.listKeyNav&&this.listKeyNav.selectHighlighted(event)},getPicker:function(){var picker=this.callParent(arguments),el=this.getEl();if(el){var comboBoxWidth=el.down("."+Ext.baseCSSPrefix+"form-trigger-input-cell").getWidth()+el.down("."+Ext.baseCSSPrefix+"trigger-cell").getWidth();picker.minWidth=comboBoxWidth}return picker},createPicker:function(){var picker=this.callParent(arguments);return this.mon(picker,"refresh",this._onPickerRefresh,this),picker},getDefaultValue:function(){var value;return this._hasValue(this.value)&&!_.isNull(this.value)?value=this.value:this._hasValue(this.originalValue)?value=this.originalValue:this._hasValue(this.stateValue)&&(value=this.stateValue),value},_hasValue:function(value){return _.isArray(value)?!_.isEmpty(value):!_.isUndefined(value)},getInputTextValue:function(){var inputEl=this.getInputElement();if(inputEl)return inputEl.dom.value},getInputElement:function(){return this.inputEl},applyState:function(state){this.store.on("load",function(){this.setValue(state.value),this.saveState()},this,{single:!0})},saveState:function(){var state,id=this.stateful&&this.getStateId(),hasListeners=this.hasListeners;id&&(state=this.getState()||{},hasListeners.beforestatesave&&this.fireEvent("beforestatesave",this,state)===!1||(state.value?Ext.state.Manager.set(id,state):Ext.state.Manager.clear(id),hasListeners.statesave&&this.fireEvent("statesave",this,state)))},onReady:function(){this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},refreshWithNewContext:function(context){this.getShouldRespondToScopeChange()&&(this.context=context,this.getStore()&&(this.getStore().context=context.getDataContext(),this.getStore().reload()))},getSubmitData:function(){var val,data=null;return this.disabled||!this.submitValue||this.isFileUpload()||(val=this.getValue(),data={},data[this.getName()]=val),data},reloadStoreWithNewProject:function(project){this.store.context=this.store.context||{},Ext.merge(this.store.context,{project:Rally.util.Ref.getRelativeUri(project)}),this.store.load()},setContextFromRecord:function(record){this.reloadStoreWithNewProject(record.get("Project"))},setDefaultValue:function(){var defaultValueToNoEntry,store=this.store,defaultValue=this.getDefaultValue();if(store){this.suspendEvents(!0);try{Ext.isDefined(defaultValue)&&this.findRecordByValue(defaultValue)?this.setValue(this.findRecordByValue(defaultValue)):Ext.isDefined(defaultValue)&&_.isArray(defaultValue)&&!_.isEmpty(defaultValue)?this.setValue(defaultValue):store.getCount()&&("first"===this.defaultSelectionPosition?this.setValue(store.first().get(this.valueField)):"last"===this.defaultSelectionPosition&&this.setValue(store.last().get(this.valueField))),defaultValueToNoEntry=this.getAllowNoEntry()&&!this.getValue()&&("first"===this.defaultSelectionPosition||"last"===this.defaultSelectionPosition),defaultValueToNoEntry&&this.setValue(this.store.first()),this.autoSelectCurrentItem&&this._highlightCurrentValue()}finally{this.value&&!this.originalValue&&this.resetOriginalValue(),this.resumeEvents()}}},_highlightCurrentValue:function(){this._highlightItemByValue(this.getValue())},_highlightItemByValue:function(value){if(this.picker){var record=this.store.findRecord(this.valueField,value),node=this.picker.getNode(record);this.picker.highlightItem(node)}},setValue:function(value){this.callParent(arguments),this.fireEvent("setvalue",this,this.getValue())},setOriginalValue:function(value){this.originalValue=value},_onPickerRefresh:function(){var emptyCls="rally-empty-boundlist";this.store.getRange().length<1?this.picker.addCls(emptyCls):this.picker.removeCls(emptyCls)},_onStateRestore:function(obj,state){this.stateValue=state.value},_onStoreLoad:function(){this.store&&(this.getAllowNoEntry()&&this._insertNoEntry(),this.getAllowClear()&&this._insertClear())},_insertClear:function(){var record,doesNotHaveClear=0===this.store.count()||this.store.getAt(0).get(this.valueField)!==this.clearValue,shouldAddClear=!this.lastQuery||!this.getInputTextValue()||this.getInputTextValue()===this.clearText;doesNotHaveClear&&shouldAddClear&&(record=Ext.create(this.store.model),record.set(this.displayField,this.clearText),record.set(this.valueField,this.clearValue),this.store.insert(0,record))},_insertNoEntry:function(){var record,doesNotHaveNoEntry=0===this.store.count()||this.store.getAt(0).get(this.valueField)!==this.noEntryValue,shouldAddNoEntry=!this.lastQuery||!this.getInputTextValue()||this.getInputTextValue()===this.noEntryText;doesNotHaveNoEntry&&shouldAddNoEntry&&(record=Ext.create(this.store.model),record.set(this.displayField,this.noEntryText),record.set(this.valueField,this.noEntryValue),this.store.insert(0,record))},_onBoxReady:function(){this.getWidth()>this.maxWidth&&this.setWidth(this.maxWidth)},_onFocus:function(){this.addCls("combobox-focus")},_onBlur:function(){this.removeCls("combobox-focus"),this._clearValueIfStoreLoading()},_clearValueIfStoreLoading:function(){var store=this.getStore(),inputEl=this.getInputElement();this.forceSelection&&store&&store.isLoading()&&!this.findRecordByDisplay(inputEl.dom.value)&&(inputEl.dom.value="")},_onSelect:function(){this.getValue()===this.clearValue&&(this.setOriginalValue(void 0),this.reset())},_onKeyUp:function(textField,e){var key=e.getKey();e.isSpecialKey()&&key!==e.BACKSPACE&&key!==e.DELETE||this._bufferedRecordTypeAction(this)},_recordTypeAction:function(){this.recordAction({description:"text search"})},_getMultiSelectDisplayTpl:function(){var me=this;return Ext.create("Ext.XTemplate","{[this.getMultiSelectDisplayValue(values)]}",{getMultiSelectDisplayValue:function(values){var firstSelectedItem=_.first(_.pluck(values,me.displayField)),selectedItemCount=_.size(values);return firstSelectedItem&&selectedItemCount>1?Ext.String.format("{0} (+{1})",firstSelectedItem,selectedItemCount-1):firstSelectedItem||""}})},_getMultiSelectListItemTpl:function(displayField){return Ext.create("Ext.XTemplate",'<div class="rally-checkbox-image"></div>','<div class="rally-checkbox-text">{'+displayField+":htmlEncode}</div>")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.TextField",{extend:Ext.form.field.Text,alias:"widget.rallytextfield",componentCls:"rally-textfield-component",config:{removeNameAttribute:!1},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},getSubTplData:function(){var subTplData=this.callParent(arguments);return this.removeNameAttribute&&delete subTplData.name,subTplData}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.collection.Store",{extend:Rally.data.wsapi.Store,alternateClassName:["Rally.data.CollectionStore"],alias:["store.rallycollectionstore","store.rallywsapicollectionstore"],initialCount:0,cacheResults:!1,constructor:function(config){this.callParent(arguments),this.on("load",function(store,records,successful){this._wasSuccessful=successful},this,{single:!0}),this.proxy.requester=this.requester,this.isCollectionStore=!0},load:function(options){return this.cacheResults&&this._wasSuccessful?this._loadCachedResults(options):this.callParent(arguments)},_loadCachedResults:function(options){options=options||{},Ext.isFunction(options)&&(options={callback:options});var deferred=new Deft.Deferred,operation=Ext.create("Ext.data.Operation",options),records=this.getRange(),successful=!!_.isUndefined(this._wasSuccessful)||this._wasSuccessful;return this.fireEvent("beforeload",this,operation)!==!1?(Ext.callback(options.callback,options.scope,[records,operation,successful]),deferred.resolve(records,operation,successful),this.hasListeners.load&&this.fireEvent("load",this,records,successful)):deferred.reject("beforeload returned false"),deferred.promise},add:function(){var records=this.self.toRecordsForAdd(this,arguments);return this.callParent(records)},remove:function(records){this.callParent([this.self.toRecordsForRemove(this,records)])},getCount:function(){return this._wasSuccessful||!this.initialCount?this.callParent(arguments):this.initialCount},getTotalCount:function(){return this._wasSuccessful||!this.initialCount?this.callParent(arguments):this.initialCount},inheritableStatics:{toRecordsForAdd:function(store,originalArgs){var records=this._makeArray.apply(this,originalArgs);return _.map(records,function(record){return _.isString(record)&&(record=new store.model({_ref:record})),record.hasOwnProperty("_ref")&&(record=new store.model({_ref:record._ref})),record.phantom=!0,record.validations=[],record})},toRecordsForRemove:function(store,originalArgs){var records=Ext.Array.from(originalArgs);return _.map(records,function(record){return _.isString(record)?store.findRecord("_ref",new RegExp("^"+record+"$")):record.hasOwnProperty("_ref")?store.findRecord("_ref",new RegExp("^"+record._ref+"$")):store.findRecord("_ref",new RegExp("^"+record.getRef().getRelativeUri()+"$"))})},_makeArray:function(records){return _.isArray(records)?records.slice(0):_.toArray(arguments)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.Field",{extend:Rally.data.Field,alternateClassName:["Rally.domain.WsapiField"],constructor:function(config){this.callParent([this._updateDisplayName(config)])},getType:function(){return this.attributeDefinition?this.attributeDefinition.AttributeType.toLowerCase():this.callParent()},getAllowedValueStore:function(storeConfig){var allowedValues=this._getAllowedValues();return allowedValues?(this._allowedValueStore||(this._allowedValueStore=Ext.create("Rally.data.wsapi.collection.Store",_.merge({cacheResults:!0,initialCount:allowedValues.length||allowedValues.Count,model:Ext.identityFn("AllowedAttributeValue"),proxy:Rally.data.wsapi.ModelFactory.buildProxy(this.getAllowedValuesRef(),this.name)},storeConfig))),this._allowedValueStore):null},getAllowedQueryOperatorStore:function(){var allowedQueryOperators=this._getAllowedQueryOperators();return allowedQueryOperators?(this._allowedQueryOperatorsStore||(this._allowedQueryOperatorsStore=Ext.create("Rally.data.wsapi.collection.Store",{model:Ext.identityFn("AllowedQueryOperator"),proxy:Rally.data.wsapi.ModelFactory.buildProxy(this.getAllowedQueryOperatorsRef(),this.name),initialCount:allowedQueryOperators.length||allowedQueryOperators.Count,cacheResults:!0})),this._allowedQueryOperatorsStore):null},clearAllowedValueStore:function(){this._allowedValueStore=null},hasAllowedValues:function(){var allowedValues=this._getAllowedValues(),type=this.getType();return!(!allowedValues||!(allowedValues.length||allowedValues.Count||allowedValues._ref&&this.attributeDefinition&&("string"===type&&this.isConstrained()||this.attributeDefinition.AllowedValueType||"rating"===type||"collection"===type)))},getAllowedValuesRef:function(){var allowedValues=this._getAllowedValues();return Ext.isObject(allowedValues)?Rally.util.Ref.getUri(allowedValues._ref):Rally.util.Ref.getUri(this.attributeDefinition._ref+"/AllowedValues")},getAllowedQueryOperatorsRef:function(){var allowedQueryOperators=this._getAllowedQueryOperators();return Ext.isObject(allowedQueryOperators)?Rally.util.Ref.getUri(allowedQueryOperators._ref):Rally.util.Ref.getUri(this.attributeDefinition._ref+"/AllowedQueryOperators")},getUUID:function(){return this.attributeDefinition&&this.attributeDefinition._refObjectUUID},isCustom:function(){return this.attributeDefinition&&this.attributeDefinition.Custom},isConstrained:function(){return this.attributeDefinition&&this.attributeDefinition.Constrained},isCollection:function(){return"collection"===this.getType()},isDate:function(){return"date"===this.getType()},isObject:function(){return"object"===this.getType()},isBoolean:function(){return"boolean"===this.getType()},isMultiValueCustom:function(){return this.isCustom()&&this.isConstrained()&&this.isCollection()},getAllowedStringValues:function(){return _.map(this._getAllowedValues(),function(value){return value.StringValue})},getAllowedValueType:function(){return this.attributeDefinition&&this.attributeDefinition.AllowedValueType&&this.attributeDefinition.AllowedValueType._refObjectName.toLowerCase()},_updateDisplayName:function(config){return"Hidden"!==config.name&&"VisibilityOnChildProjects"!==config.name||(config.displayName="Visible"),config},_getAllowedValues:function(){return this.attributeDefinition&&this.attributeDefinition.AllowedValues},_getAllowedQueryOperators:function(){return this.attributeDefinition&&this.attributeDefinition.AllowedQueryOperators}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.MilestoneTargetProjectPermissionsHelper",{singleton:!0,canEdit:function(record){return!this.shouldDisableEditing(record)},shouldDisableEditing:function(record){var projectData=record.get("TargetProject"),projectRef=projectData&&_.isString(projectData._ref)?projectData._ref:projectData;return record.phantom&&""===projectRef&&(projectRef=Rally.environment.getContext().getProject()),this._doesNotHaveAccess(projectRef)||this._isEditingWorkspaceMilestoneButDoNotHavePermission(projectRef)||this._isEditingProjectMilestoneButDoNotHaveEditorAccess(projectRef)},getProjectName:function(record,textOnly,context){var project=record.isModel?record.get("TargetProject"):record.TargetProject;return null===project?"All projects in "+context.getWorkspace().Name:project?project.Name||project._refObjectName:textOnly?"Project Permissions Required":'<div class="permission-required">Project Permissions Required</div>'},confirmEditIfRequired:function(record){var deferred=new Deft.Deferred;return this.shouldDisableEditing(record)?deferred.resolve(!1):record.get("TotalArtifactCount")>0?Ext.create("Rally.ui.dialog.ConfirmDialog",{title:"WORK ITEMS ASSOCIATED TO MILESTONE",message:"There are work items associated to "+record.data.FormattedID+": "+record.data.Name+". Changing the project of this milestone may remove these associations, which cannot be undone.",confirmLabel:"Continue Edit",cancelLabel:"Cancel Edit",listeners:{confirm:function(){deferred.resolve(!0)},cancel:function(){deferred.resolve(!1)},destroy:function(){"pending"===deferred.state&&deferred.resolve(!1)}}}):deferred.resolve(!0),deferred.promise},_doesNotHaveAccess:function(projectRef){return""===projectRef},_isEditingProjectMilestoneButDoNotHaveEditorAccess:function(projectRef){return null!==projectRef&&!Rally.environment.getContext().getPermissions().isProjectEditor(projectRef)},_isEditingWorkspaceMilestoneButDoNotHavePermission:function(projectRef){return null===projectRef&&!Rally.environment.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.DragAndDropRankColumnRenderer",{singleton:!0,getRankValue:function(record,gridStore){var store=gridStore&&gridStore.treeStore||gridStore,sorters=store&&store.getSorters(),sorter=sorters&&sorters[0];if(sorter&&Rally.data.Ranker.isRankField(sorter.property)){var index=store.indexOf(record);if(index!==-1){var currentPage=store.currentPage?store.currentPage:1,offset=store.pageSize*(currentPage-1);return"ASC"===sorter.direction?index+offset+1:store.getTotalCount()-offset-index}}return""},renderer:function(value,metaData,record,rowIndex,colIndex,gridStore,view){return Rally.ui.grid.DragAndDropRankColumnRenderer.getRankValue(record,gridStore)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.ManualRankColumnRenderer",{singleton:!0,renderer:function(value,metaData,record,rowIndex,colIndex,gridStore,view){return _.isFunction(record.getDepth)&&record.getDepth()>1?"":value}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.HealthColorCalculator",{requires:[],singleton:!0,colors:{red:{label:"Late",hex:"#F66349"},green:{label:"On Track",hex:"#8DC63F"},yellow:{label:"At Risk",hex:"#FAD200"},white:{label:"Not Started",hex:"#E0E0E0"},gray:{label:"Complete",hex:"#D1D1D1"}},calculateHealthColor:function(config){var colors=Rally.util.HealthColorCalculator.colors,percentComplete=100*config.percentComplete,millisecondsInDay=864e5,startDate=config.startDate,endDate=config.endDate;Ext.isString(startDate)&&(startDate=new Date(Date.parse(startDate))),Ext.isString(endDate)&&(endDate=new Date(Date.parse(endDate)));var startDay=startDate.getTime()/millisecondsInDay;startDay=Math.floor(startDay);var endDay=endDate.getTime()/millisecondsInDay;endDay=Math.ceil(endDay)-.01;var asOfDay=config.asOfDate.getTime()/millisecondsInDay,defaultConfig={acceptanceStartDelay:.2*(endDay-startDay),warningDelay:.2*(endDay-startDay),inProgress:percentComplete>0};if(config=Ext.applyIf(Ext.clone(config),defaultConfig),asOfDay<startDay)return colors.white;if(asOfDay>=startDay&&asOfDay<=startDay+config.acceptanceStartDelay&&!config.inProgress)return colors.green;if(asOfDay>=endDay)return percentComplete>=100?colors.gray:colors.red;var redXIntercept=startDay+config.acceptanceStartDelay+config.warningDelay,redSlope=100/(endDay-redXIntercept),redYIntercept=-1*redXIntercept*redSlope,redThreshold=redSlope*asOfDay+redYIntercept;if(percentComplete<redThreshold)return colors.red;var yellowXIntercept=startDay+config.acceptanceStartDelay,yellowSlope=100/(endDay-yellowXIntercept),yellowYIntercept=-1*yellowXIntercept*yellowSlope,yellowThreshold=yellowSlope*asOfDay+yellowYIntercept;return percentComplete<yellowThreshold?colors.yellow:colors.green},calculateHealthColorForPortfolioItemData:function(recordData,percentDoneFieldName){var today=this._getToday(),config={percentComplete:recordData[percentDoneFieldName],startDate:recordData.ActualStartDate||recordData.PlannedStartDate||today,asOfDate:today};return 1===recordData[percentDoneFieldName]?config.endDate=recordData.ActualEndDate||recordData.PlannedEndDate||today:config.endDate=recordData.PlannedEndDate||today,config.inProgress=config.percentComplete>0,this.calculateHealthColor(config)},calculateCapacityHealthColor:function(recordData,percentDoneFieldName){var percent=100*(recordData[percentDoneFieldName]||0);return percent>=100?Rally.util.HealthColorCalculator.colors.red:percent>=80?Rally.util.HealthColorCalculator.colors.yellow:percent>0?Rally.util.HealthColorCalculator.colors.green:Rally.util.HealthColorCalculator.colors.gray},_getToday:function(){return new Date}})}(),function(){var Ext=window.Ext4||window.Ext,toTitleCaseFn=function(fieldName){return Ext.create("Rally.ui.renderer.template.StringTemplate",{fieldName:fieldName,titleCase:!0,toSpace:["_"]})};Ext.define("Rally.ui.renderer.RendererFactory",{singleton:!0,mixins:{messageable:Rally.Messageable},constructor:function(){this.fieldRenderers={draganddroprank:Rally.ui.grid.DragAndDropRankColumnRenderer.renderer,rank:Rally.ui.grid.ManualRankColumnRenderer.renderer,taskindex:Rally.ui.grid.DragAndDropRankColumnRenderer.renderer}},getRenderTemplate:_.memoize(function(field){var modelType=field.modelType,fieldName=field.name.toLowerCase(),fieldType=field.getType();return this.typeFieldTemplates[modelType]&&this.typeFieldTemplates[modelType][fieldName]?this.typeFieldTemplates[modelType][fieldName](field):field.isMultiValueCustom&&field.isMultiValueCustom()?this.typeTemplates.multivalue(field):this.fieldTemplates[field.name.toLowerCase()]?this.fieldTemplates[field.name.toLowerCase()](field):this.typeTemplates[fieldType]?this.typeTemplates[fieldType](field):this.defaultRenderer(field)},function(field){var modelType=field.modelType,fieldName=field.name.toLowerCase(),fieldType=field.getType();return modelType+fieldName+fieldType}),renderRecordField:function(record,fieldName,context){return Rally.ui.renderer.RendererFactory.getRenderTemplate(record.getField(fieldName)).apply(Ext.apply({context:context,isDirty:record.dirty,modified:record.modified},record.data))},getFieldRenderer:function(record,fieldName){return this.fieldRenderers[fieldName.toLowerCase()]},defaultRenderer:function(field){return Ext.create("Ext.XTemplate","{"+field.name+":htmlEncode()}")},clearCacheOnAttributeDefinitionChanges:function(){this.subscribe(Rally.Message.objectCreate,this._invalidateAttributeDefinitionCache,this),this.subscribe(Rally.Message.objectUpdate,this._invalidateAttributeDefinitionCache,this)},_invalidateAttributeDefinitionCache:function(records){records=Ext.Array.from(records),_.each(records,function(record){if("AttributeDefinition"===record.self.elementName)return this.getRenderTemplate.cache={},!1},this)},typeFieldTemplates:{defectsuite:{state:function(field){return Ext.create("Rally.ui.renderer.template.DefectSuiteStateTemplate",{field:field})}},milestone:{formattedid:function(field){return Ext.create("Rally.ui.renderer.template.FormattedIDTemplate")}},task:{state:function(field){return Ext.create("Rally.ui.renderer.template.ScheduleStateTemplate",{field:field,showTrigger:!0})}},testcase:{lastbuild:function(field){return Ext.create("Rally.ui.renderer.template.LastBuildTemplate")}},recyclebinentry:{type:function(field){return Ext.create("Rally.ui.renderer.template.TypeDefNameTemplate",{fieldName:field.name})}}},fieldTemplates:{attributetype:function(){return Ext.create("Rally.ui.renderer.template.AttributeTypeTemplate")},blocked:function(){return Ext.create("Rally.ui.renderer.template.BlockedTemplate")},defects:function(){return Ext.create("Rally.ui.renderer.template.status.DefectStatusTemplate")},defectstatus:function(){return toTitleCaseFn("DefectStatus")},disabled:function(){return Ext.create("Rally.ui.renderer.template.BooleanTemplate",{fieldName:"Disabled",alt:"Disabled"})},discussion:function(){return Ext.create("Rally.ui.renderer.template.status.DiscussionStatusTemplate")},displaycolor:function(){return Ext.create("Rally.ui.renderer.template.DisplayColorTemplate")},feature:function(){return Ext.create("Rally.ui.renderer.template.FeatureTemplate")},formattedid:function(field,config){return Ext.create("Rally.ui.renderer.template.FormattedIDTemplate",config)},hidden:function(field){return Ext.create("Rally.ui.renderer.template.BooleanTemplate",{fieldName:"Hidden",showCheckWhenTrue:!1})},lastverdict:function(field){return Ext.create("Rally.ui.renderer.template.LastVerdictTemplate",{field:field})},load:function(){return Ext.create("Rally.ui.renderer.template.progressbar.ProgressBarTemplate",{height:"15px",percentDoneName:"Load",calculateColorFn:function(recordData){return Rally.util.HealthColorCalculator.calculateCapacityHealthColor(recordData,"Load").hex}})},parent:function(){return Ext.create("Rally.ui.renderer.template.ParentTemplate")},percentdonebystorycount:function(){return Ext.create("Rally.ui.renderer.template.progressbar.PercentDoneByStoryCountTemplate")},percentdonebystoryplanestimate:function(){return Ext.create("Rally.ui.renderer.template.progressbar.PercentDoneByStoryPlanEstimateTemplate")},predecessorsandsuccessors:function(){return Ext.create("Rally.ui.renderer.template.status.PredecessorsAndSuccessorsStatusTemplate")},rank:function(field){return Ext.create("Rally.ui.renderer.template.DecimalTemplate",{fieldName:field.name})},requirement:function(field){return Ext.create("Rally.ui.renderer.template.ChildObjectFormattedIDTemplate",{childObjectProperty:"Requirement",showName:!0})},schedulestate:function(field){return Ext.create("Rally.ui.renderer.template.ScheduleStateTemplate",{field:field,showTrigger:!0})},statechangeddate:function(){return Ext.create("Rally.ui.renderer.template.DaysInThisColumnTemplate")},tags:function(){return Ext.create("Rally.ui.renderer.template.TagPillTemplate",{collectionName:"Tags"})},milestones:function(){return Ext.create("Rally.ui.renderer.template.PillTemplate",{collectionName:"Milestones",iconCls:"icon-milestone",cls:"milestone-pill"})},tasks:function(){return Ext.create("Rally.ui.renderer.template.status.TaskStatusTemplate")},taskstatus:function(){return toTitleCaseFn("TaskStatus")},testcase:function(field){return Ext.create("Rally.ui.renderer.template.ChildObjectFormattedIDTemplate",{childObjectProperty:"TestCase",showName:!0})},testcases:function(){return Ext.create("Rally.ui.renderer.template.status.TestCaseStatusTemplate")},testcasestatus:function(){return toTitleCaseFn("TestCaseStatus")},testfolder:function(field){return Ext.create("Rally.ui.renderer.template.ChildObjectFormattedIDTemplate",{childObjectProperty:"TestFolder",showName:!0})},visibilityonchildprojects:function(field){return Ext.create("Rally.ui.renderer.template.VisibilityOnSubprojectsTemplate")},workproduct:function(){return Ext.create("Rally.ui.renderer.template.ChildObjectFormattedIDTemplate",{childObjectProperty:"WorkProduct",showName:!0})},targetproject:function(){return Ext.create("Ext.XTemplate","{[this.getProjectName(values)]}",{getProjectName:function(recordData){return Rally.ui.MilestoneTargetProjectPermissionsHelper.getProjectName(recordData,!1,recordData.context)}})}},typeTemplates:{text:function(field){return Ext.create("Rally.ui.renderer.template.StringTemplate",{fieldName:field.name})},string:function(field){return this.text(field)},boolean:function(field){return Ext.create("Rally.ui.renderer.template.BooleanTemplate",{fieldName:field.name})},collection:function(field){return Ext.create("Rally.ui.renderer.template.CollectionTemplate",{fieldName:field.name})},date:function(field){return Ext.create("Rally.ui.renderer.template.DateTemplate",{fieldName:field.name})},decimal:function(field){return Ext.create("Rally.ui.renderer.template.DecimalTemplate",{fieldName:field.name,maxFractionalDigits:field.attributeDefinition?field.attributeDefinition.MaxFractionalDigits:-1})},float:function(field){return Ext.create("Rally.ui.renderer.template.DecimalTemplate",{fieldName:field.name,maxFractionalDigits:field.attributeDefinition?field.attributeDefinition.MaxFractionalDigits:-1})},integer:function(field){return Ext.create("Rally.ui.renderer.template.DecimalTemplate",{fieldName:field.name})},multivalue:function(field){return Ext.create("Rally.ui.renderer.template.CollectionTemplate",{fieldName:field.name,wrapWithAnchorTag:!0})},object:function(field){return Ext.create("Rally.ui.renderer.template.ObjectTemplate",{fieldName:field.name})},quantity:function(field){return Ext.create("Rally.ui.renderer.template.DecimalTemplate",{fieldName:field.name,maxFractionalDigits:field.attributeDefinition?field.attributeDefinition.MaxFractionalDigits:-1})},web_link:function(field){return Ext.create("Rally.ui.renderer.template.WebLinkTemplate",{fieldName:field.name,urlWithTokens:field.attributeDefinition.URL,shouldOpenInNewWindow:1!==field.attributeDefinition.DisplayPreference})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.FieldFactory",{singleton:!0,_knownDefaultedFields:{ScheduleState:!0,Project:!0,Workspace:!0},_getAttributeValidations:function(attribute){var validations=[];return"STRING"===attribute.AttributeType&&!isNaN(attribute.MaxLength)&&attribute.MaxLength>0&&validations.push({type:"length",field:attribute.ElementName,max:attribute.MaxLength,min:0}),validations},_mapRallyAttributeType:function(attribute){if("FormattedID"===attribute.ElementName)return Ext.data.Types.FORMATTED_ID;switch(attribute.AttributeType){case"BINARY_DATA":return"AUTO";case"BOOLEAN":return"BOOLEAN";case"COLLECTION":return"AUTO";case"DATE":return"DATE";case"DECIMAL":return"AUTO";case"INTEGER":return"INT";case"OBJECT":return"AUTO";case"QUANTITY":return attribute.AttributeType.MaxFractionalDigits<=0?"INT":"AUTO";case"RATING":return"STRING";case"STATE":return"STRING";case"STRING":return"STRING";case"TEXT":return"STRING";case"WEB_LINK":return"AUTO";default:return"AUTO"}},_defaultTypeRenderers:{object:function(value){return value?value._refObjectName?value._refObjectName:value:""},flat:_.identity},buildFieldFromAttributeDefinition:function(attribute,mapping){var type=Rally.data.FieldFactory._mapRallyAttributeType(attribute),attrType=attribute.AttributeType,fieldDefinition={name:attribute.ElementName,displayName:attribute.Name,type:type,required:!!attribute.Required,persist:!attribute.ReadOnly,attributeDefinition:attribute,hidden:!!attribute.Hidden,custom:!!attribute.Custom,readOnly:!!attribute.ReadOnly,useNull:this._shouldUseNull(attribute,type),sortable:!!attribute.Sortable},fieldName=fieldDefinition.name;(_.isString(mapping)||_.isFunction(mapping))&&(fieldDefinition.mapping=mapping),"DATE"===fieldDefinition.type?this._augmentDateField(fieldDefinition):"COLLECTION"===attrType?this._augmentCollectionField(fieldDefinition):"OBJECT"===attrType?this._augmentObjectField(fieldDefinition):"RATING"===attrType&&(fieldDefinition.defaultValue="None"),"Tags"===fieldName?fieldDefinition.defaultValue=[]:"Predecessors"===fieldName||"Successors"===fieldName?this._augmentPredecessorsAndSuccessorsField(fieldDefinition):fieldName===Rally.data.Ranker.RANK_FIELDS.DND&&(fieldDefinition.sortType=Ext.data.SortTypes.asCaseSensitive),fieldDefinition.printable=!_.contains(this.getExcludedForPrintFields(),fieldName);var field=new Rally.data.wsapi.Field(fieldDefinition);if(field.editor=Rally.ui.renderer.GridEditorFactory.getEditor(field),field.hasAllowedValues()&&("STRING"===attrType||"STATE"===attrType)){var sortMap=_.transform(attribute.AllowedValues,function(acc,value,i){acc[value.StringValue]=i+1},{});field.sortType=function(value){return sortMap[value]||-1}}return field},buildFieldsFromTypeDefinitionAttributes:function(attributes){return _.map(attributes||[],this.buildFieldFromAttributeDefinition,this)},buildValidationsFromTypeDefinitionAttributes:function(attributes){return _.flatten(_.map(attributes,this._getAttributeValidations,this))},getCommonWsapiFields:function(){var me=this;return[{name:"ObjectID",displayName:"Object ID",type:"INT",persist:!1,hidden:!0,useNull:!0},{name:"_type",displayName:"Type",type:"STRING",persist:!1,hidden:!0},{name:"_refObjectName",displayName:"ObjectName",type:"STRING",persist:!1,hidden:!0},{name:"_refObjectUUID",displayName:"Object UUID",type:"STRING",persist:!1,hidden:!0,convert:function(value,record){
var uuidRef="/"+record.self.typePath+"/"+value;return record[record.persistenceProperty]._uuidRef=uuidRef,value}},{name:"_ref",displayName:"Ref",type:"STRING",persist:!1,hidden:!0,convert:function(value,record){var ref;return value&&!me._isNullAllowedAttributeValueRef(value,record)&&(ref=Ext.create("Rally.util.Ref",value),record[record.persistenceProperty].ObjectID=ref.getOid(),record[record.persistenceProperty]._type=ref.getType()),ref?ref.getRelativeUri():value}},{name:"_uuidRef",displayName:"UUIDRef",type:"STRING",persist:!1,hidden:!0},{name:"_objectVersion",displayName:"Version",persist:!1,hidden:!0},{name:"_CreatedAt",displayName:"CreatedAt",type:"STRING",persist:!1,hidden:!0},{name:"deletable",type:"BOOLEAN",persist:!1,hidden:!0},{name:"updatable",type:"BOOLEAN",persist:!1,hidden:!0},{name:"creatable",type:"BOOLEAN",persist:!1,hidden:!0},{name:"_p",displayName:"Permission",type:"INTEGER",persist:!1,hidden:!0,convert:function(value,record){var perms=Rally.data.wsapi.Model.getPermissionLevels(value);return record[record.persistenceProperty].deletable=perms.deletable,record[record.persistenceProperty].updatable=perms.updatable,record[record.persistenceProperty].creatable=perms.creatable,value}},{name:"Summary",displayName:"Summary",type:"AUTO",persist:!1,hidden:!0}]},getVirtualWsapiFields:function(typeDefinition){var virtualFields=[],attributeNames=_.pluck(typeDefinition.Attributes,"ElementName");return _.contains(attributeNames,"TotalDefectCount")&&_.contains(attributeNames,"ClosedDefectCount")&&virtualFields.push(this._getVirtualFieldConfig("State")),"TestSet"===typeDefinition.TypePath&&virtualFields.push(this._getVirtualFieldConfig("Defects",{displayName:"Defects"})),_.contains(attributeNames,"TestCaseCount")&&_.contains(attributeNames,"PassingTestCaseCount")&&virtualFields.push(this._getVirtualFieldConfig("LastVerdict",{displayName:"Last Verdict",getFieldsForExport:function(){return["LastVerdict","PassingTestCaseCount","TestCaseCount"]}})),(_.contains(attributeNames,"Predecessors")||_.contains(attributeNames,"Successors"))&&virtualFields.push(this._getVirtualFieldConfig("PredecessorsAndSuccessors",{displayName:"Dependencies"})),virtualFields},_getVirtualFieldConfig:function(name,config){return _.merge({displayName:name,hidden:!1,name:name,persist:!1,readOnly:!0,sortable:!1,type:"OBJECT",virtual:!0},config)},getExcludedForPrintFields:function(){return["ObjectID","FormattedID","Name","RevisionHistory","Changesets","Discussion"]},_isNullAllowedAttributeValueRef:function(value,record){var allowedNullTypes=["allowedattributevalue","allowedqueryoperator"];return value&&record.self.typePath&&_.contains(allowedNullTypes,record.self.typePath.toLowerCase())&&0===value.indexOf("null")},_augmentDateField:function(fieldDefinition){fieldDefinition.dateFormat="c",fieldDefinition.serialize=function(o){return o},fieldDefinition.convert=function(value,record){return"undefined"==typeof value||null===value||""===value?null:Ext.isDate(value)?value:Rally.util.DateTime.fromIsoString(value)}},_augmentCollectionField:function(fieldDefinition){var me=this;fieldDefinition.convert=function(value,record){return value&&Ext.isArray(value)&&_.each(value,me._refToRelative,me),value}},_augmentObjectField:function(fieldDefinition){var me=this;fieldDefinition.convert=function(value,record){return value&&me._refToRelative(value),value}},_augmentPredecessorsAndSuccessorsField:function(fieldDefinition){var fieldName=fieldDefinition.name;fieldDefinition.convert=function(value,record){var data=record[record.persistenceProperty];return data.PredecessorsAndSuccessors=data.PredecessorsAndSuccessors||{Count:0},data.PredecessorsAndSuccessors[fieldName]=value.Count,data.PredecessorsAndSuccessors.Count+=value.Count,0===data.PredecessorsAndSuccessors.Count&&data.PredecessorsAndSuccessors.hasOwnProperty("Predecessors")&&data.PredecessorsAndSuccessors.hasOwnProperty("Successors")&&(data.PredecessorsAndSuccessors=null),value}},_refToRelative:function(entry){entry._ref&&(entry._ref=Rally.util.Ref.getRelativeUri(entry._ref))},_shouldUseNull:function(attribute,type){return"ObjectID"===attribute.ElementName||"INT"===type}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.Model",{extend:Rally.data.Model,alternateClassName:["Rally.domain.WsapiModel"],idProperty:"ObjectID",isWsapiModel:!0,constructor:function(data){var originalData={};Ext.isObject(data)&&(originalData=Ext.clone(data)),this.callParent(arguments),this.phantom&&Ext.Object.each(originalData,function(fieldName,value){var field=this.getField(fieldName);Ext.isDefined(field)&&field.persist&&Ext.isDefined(value)&&(this.modified[fieldName]=value)},this),this.raw=this.raw||{},this.getId()&&(this.internalId=Ext.id())},get:function(fieldName){var field=this.self.getField(fieldName);return field?this.callParent([field.name]):this.callParent(arguments)},set:function(fieldName,value){var mappedField=this.getMappedField(fieldName);if(mappedField){var unmappedField=this.getUnmappedField(mappedField.name);if(unmappedField){var result=this.callParent([unmappedField.name,value]);return result&&(this.data[mappedField.name]=value,result.push(mappedField.name)),result}}else{var field=this.self.getField(fieldName);if(field){var currentValue=this.get(field.name);return currentValue&&currentValue._ref===value?null:this.callParent([field.name,value])}}return this.callParent(arguments)},getMappedField:function(fieldName){var mappedFieldName,mappings=this.getArtifactMappings();if(_.has(mappings,fieldName))mappedFieldName=mappings[fieldName];else{if(!_.contains(mappings,fieldName))return;mappedFieldName=fieldName}return this.self.getField(mappedFieldName)},getUnmappedField:function(fieldName){var result,inverseMappings=this.self.getInverseArtifactMappings();return _.has(inverseMappings,fieldName)&&(result=this.getField(inverseMappings[fieldName])),result},getAllowedValueStore:function(fieldName){var field=this.getField(fieldName);return field.getAllowedValueStore()},getCollections:function(fieldNames,config){config=config||{};var collectionStores=_.object(_.map(fieldNames,function(fieldName){return[fieldName,this.getCollection(fieldName,config)]},this));return Ext.create("Rally.data.wsapi.collection.MultiStore",{stores:collectionStores})},getCollection:function(fieldName,config){var value=this.get(fieldName),field=this.getField(fieldName);return field.isCollection()?this._createCollectionStore(field,value,config):value},isCustomField:function(fieldName){var custom,fieldDef=this.getField(fieldName);return Ext.isObject(fieldDef)&&(custom=fieldDef.custom),custom},getSummaryField:function(field){if(Ext.isString(field)&&field.indexOf(":summary")!==-1){var fieldWithSummary=field.split(":summary")[0];return this.fields.get(fieldWithSummary)}},getRef:function(){var refProp,ref=this._refObject;if(!Ext.isObject(ref)){if(refProp=this.get("_ref"),!refProp)return null;ref=Ext.create("Rally.util.Ref",refProp),this._refObject=ref}return ref},save:function(options){options=options||{};var deferred=Ext.create("Deft.Deferred"),me=this,promise=deferred.promise;if(options.waitForChildCollectionSync&&this.creationDependencies){var allPromises=Ext.Array.clone(this.creationDependencies);promise=deferred.promise.then(function(result){return Deft.Promise.all(allPromises).then(function(){return result})})}delete this.creationDependencies;var optionsCopy=Ext.clone(options);delete optionsCopy.callback,delete optionsCopy.success,delete optionsCopy.failure;var opts=Ext.apply({},optionsCopy,{callback:function(record,operation,success){var callbackArgs=arguments;options.callback&&promise.always(function(){Ext.callback(options.callback,options.scope||me,callbackArgs)}),success?deferred.resolve(record):deferred.reject(operation)},success:function(){var callbackArgs=arguments;options.success&&promise.always(function(){Ext.callback(options.success,options.scope||me,callbackArgs)})},failure:function(){var callbackArgs=arguments;options.failure&&promise.always(function(){Ext.callback(options.failure,options.scope||me,callbackArgs)})}});return this.callParent([opts]),promise},destroy:function(options){options=options||{};var deferred=Ext.create("Deft.Deferred"),me=this,opts=Ext.apply({},{callback:function(record,operation){Ext.callback(options.callback,options.scope||me,[me,operation]),operation.wasSuccessful()?deferred.resolve(record):deferred.reject(operation)}},options);return this.callParent([opts]),deferred.promise},isRankable:function(){return Rally.data.Ranker.isRankableRecord(this)},isUpdatable:function(){return this.get("updatable")},isMilestone:function(){return this.self.isMilestone()},isUserStory:function(){return this.self.isUserStory()},isUser:function(){return this.self.isUser()},isTestSet:function(){return this.self.isTestSet()},isTestCase:function(){return this.self.isTestCase()},isScheduledTestCase:function(){return!(!this.isTestCase()||!this.raw.ScheduledTestCase)},isDefect:function(){return this.self.isDefect()},isTask:function(){return this.self.isTask()},isPortfolioItem:function(){return this.self.isPortfolioItem()},isPreference:function(){return this.self.isPreference()},isProject:function(){return this.self.isProject()},isRelease:function(){return this.self.isRelease()},isSearch:function(){return this.self.isSearch()},canHaveChildren:function(){return this.self.canHaveChildren()},canHaveTasks:function(){var type=this.get("_type");return"defect"===type||"defectsuite"===type||"testset"===type||"hierarchicalrequirement"===type&&0===this.get("DirectChildrenCount")},canHaveDefects:function(){return this.self.canHaveDefects()},canHaveTestCases:function(){return this.self.canHaveTestCases()},canHaveTestCaseResults:function(){return this.self.canHaveTestCaseResults()},commit:function(silent){this.callParent(arguments),this.fireEvent("aftercommit")},isAnEditableAttributeDefinitionOf:function(typeName){if(!_.contains(["scopedattributedefinition","attributedefinition"],this.self.typePath))return!1;if(this.get("Custom")===!0)return!0;if(("User"===typeName||"Workspace"===typeName)&&"RATING"!==this.get("AttributeType"))return!1;if("Release"===typeName&&"Release Backlog Items Count"===this.get("Name"))return!1;if(this.get("SystemRequired")!==!0)return!0;var attributeDefName=(this.get("Name")||"").toLowerCase();return attributeDefName.indexOf("state")>-1&&!_.contains(["task","iteration","release","project"],typeName.toLowerCase())||!!_.contains(["category","type","verdict"],attributeDefName)},getArtifactMappings:function(){return this.self.getArtifactMappings()},getAssociatedRefs:function(){var associationFieldNames=_.pluck(this.getAssociationFields(),"name"),associatedRefs=_.map(_.filter(associationFieldNames,this.isFieldVisible,this),function(attribute){var associatedRef,attr=this.get(attribute)||this.raw[attribute];return attr&&(associatedRef=Rally.util.Ref.getRelativeUri(attr)),associatedRef},this);return _.unique(_.compact(associatedRefs))},getAssociationFields:function(){return this.self.getAssociationFields()},_createCollectionStore:function(field,value,config){if(config=Ext.applyIf({model:field.attributeDefinition.AllowedValueType?field.attributeDefinition.AllowedValueType._refObjectName.replace(/\s/g,""):"AllowedAttributeValue",fieldName:field.name,record:this},config||{}),this.phantom)return Ext.create("Rally.data.wsapi.collection.MemoryStore",config);var url,count;return Ext.isObject(value)?(url=Ext.create("Rally.util.Ref",value._ref).getUri(),count=value.Count):(url=Rally.util.Ref.getUri(this.get("_ref"))+"/"+field.name,count=value.length),config.model=config.collectionModel||config.model,config.proxy=Rally.data.wsapi.ModelFactory.buildProxy(url,field.name,"rally.data.collection.writer"),config.initialCount=count,Ext.create("Rally.data.wsapi.collection.Store",config)},addCreationDependency:function(promise){this.creationDependencies=this.creationDependencies||[],this.creationDependencies.push(promise)},inheritableStatics:{getField:function(identifier){if(Ext.isString(identifier)&&identifier.indexOf(":summary")!==-1)return this.getField(identifier.split(":summary")[0]);var fields=this.getFields();return _.find(fields,function(field){return field.name===identifier||_.isFunction(field.getUUID)&&field.getUUID()===identifier})||_.find(fields,{name:"c_"+identifier})},getPermissionLevels:function(permission){return{creatable:0!==(4&permission),updatable:0!==(2&permission),deletable:0!==(1&permission)}},getCustomFields:function(){return _.filter(this.getFields(),{custom:!0})},getNonCollectionFields:function(){return _.filter(_.difference(this.getFields(),this.getCollectionFields()),function(field){return field.attributeDefinition&&0!==field.name.indexOf("_")})},getCollectionFields:function(){return _.filter(this.getFields(),function(field){return _.isFunction(field.isCollection)&&field.isCollection()})},getCollectionFieldFor:function(model){return _.find(this.getCollectionFields(),function(collField){return collField.attributeDefinition.AllowedValueType&&collField.attributeDefinition.AllowedValueType._refObjectName===model.elementName})},isObjectField:function(field){return field.attributeDefinition&&"OBJECT"===field.attributeDefinition.AttributeType},getAssociationFields:function(){return _.filter(this.getFields(),this.isObjectField)},getFieldsByName:function(fieldNames){return _.map(fieldNames,function(fieldName){var field=this.getField(fieldName);return field||Ext.Error.raise("Could not find field with name: "+fieldName),field},this)},find:function(options){Ext.create("Rally.data.wsapi.Store",{model:this,pageSize:1,filters:options.filters,context:options.context}).load({callback:function(records,operation,success){var record;records&&(record=records[0]),success?options.success&&options.success.call(options.scope,record):options.failure&&options.failure.call(options.scope),options.callback&&options.callback.call(options.scope,record,success)}})},isModelFor:function(record){return record&&record.self&&record.self.typePath===this.typePath},isArtifact:function(){var typePath=Rally.data.ModelTypes.getTypeByName(this.typePath);return this.isPortfolioItem()||_.contains(Rally.data.ModelTypes.artifactTypes,typePath.toLowerCase())},isPortfolioItem:function(){return this.parentTypeName&&"portfolioitem"===this.parentTypeName.replace(/\s/g,"").toLowerCase()},isPreference:function(){return"preference"===this.typePath},isProject:function(){return"project"===this.typePath},isRelease:function(){return"release"===this.typePath},isLowestLevelPortfolioItem:function(){return this.isPortfolioItem()&&0===this.ordinal},isTimebox:function(){return _.contains(["milestone","iteration","release"],this.typePath)},isMilestone:function(record){return"milestone"===this.typePath},isUserStory:function(){return"hierarchicalrequirement"===this.typePath},isUser:function(){return"user"===this.typePath},isTestSet:function(){return"testset"===this.typePath},isTestCase:function(){return"testcase"===this.typePath},isDefect:function(){return"defect"===this.typePath},isTask:function(){return"task"===this.typePath},isSearch:function(){return"search"===this.typePath},canHaveChildren:function(){return this.hasField("Children")||this.hasField("UserStories")},canHaveDefects:function(){return"defectsuite"===this.typePath||"hierarchicalrequirement"===this.typePath||"testcase"===this.typePath},canHaveTestCases:function(){return _.contains(["defect","hierarchicalrequirement","testset"],this.typePath)&&this.hasField("TestCases")},canHaveTestCaseResults:function(){return"testcase"===this.typePath&&this.hasField("Results")},isImportable:function(){return this.isPortfolioItem()||_.contains(["defect","hierarchicalrequirement","task","testcase"],this.typePath)},isRecyclable:function(){return this.isPortfolioItem()||_.contains(["defect","hierarchicalrequirement","task","testcase","milestone"],this.typePath)},artifactFieldMappings:{task:{State:"ScheduleState",Estimate:"TaskEstimateTotal",ToDo:"TaskRemainingTotal",Actuals:"TaskActualTotal"}},getInverseArtifactMappings:function(){return this._inverseArtifactMappings||(this._inverseArtifactMappings=_.invert(this.getArtifactMappings())),this._inverseArtifactMappings},getArtifactMappings:function(){var mappings,typePath=this.typePath&&this.typePath.toLowerCase();return typePath&&(mappings=this.artifactFieldMappings[typePath]),mappings||{}},load:function(identifier,options){options=options||{};var deferred=Ext.create("Deft.Deferred"),id=Rally.util.Ref.getOidFromRef(identifier)||identifier,opts=Ext.apply({},{callback:function(record,operation){Ext.callback(options.callback,options.scope,[record,operation]),operation.wasSuccessful()?deferred.resolve(record):deferred.reject(operation)}},options);return Rally.data.wsapi.Model.superclass.self.load.apply(this,[id,opts]),deferred.promise}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.project.ProjectPicker",{extend:Ext.form.field.Picker,alias:"widget.rallyprojectpicker",componentCls:"rui-triggerfield rui-project-picker",placeholderCls:"rui-multi-object-placeholder",editable:!1,pickerOffset:[0,-1],matchFieldWidth:!1,config:{loadingText:"Loading...",showMostRecentlyUsedProjects:!0,showProjectScopeUpAndDown:!1,workspace:void 0},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addEvents("change","invalidvalue"),this.tree=this._createProjectTree()},createPicker:function(){var items=[];return this.getShowMostRecentlyUsedProjects()&&(this.recents=this._createMostRecentlyUsedProjects(),items.push(this.recents)),items.push(this.tree),this.getShowProjectScopeUpAndDown()&&(this.projectScopeUpDownField=this._createProjectScopeUpDownField(),items.push(this.projectScopeUpDownField)),this.picker=Ext.widget("container",{cls:"rui-project-picker-container",itemId:"projectPickerContainer",floating:!0,shadow:!1,hidden:!0,minWidth:250,items:items}),this.picker},_createProjectTree:function(){return Ext.create("Rally.ui.tree.ProjectTree",{workspace:this.getWorkspace(),autoLoadTopLevel:!1,listeners:{scope:this,itemselected:this._treeItemSelected}})},_createMostRecentlyUsedProjects:function(){return Ext.create("Rally.ui.picker.project.MostRecentlyUsedProjects",{workspaceObjectID:Rally.environment.getContext().getWorkspace().ObjectID,listeners:{select:this._mostRecentlyUsedProjectSelected,scope:this}})},_createProjectScopeUpDownField:function(){return Ext.create("Rally.ui.picker.project.ProjectScopeUpDownField",{value:{projectScopeUp:this.projectScopeUp,projectScopeDown:this.projectScopeDown},listeners:{change:function(field,value){this.projectScopeUp=value.projectScopeUp,this.projectScopeDown=value.projectScopeDown,this.fireEvent("change",this,this.getValue())},scope:this}})},_mostRecentlyUsedProjectSelected:function(project){this.setSelectedRecord(project),this.fireEvent("select"),this.collapse()},_treeItemSelected:function(treeItem){var record=treeItem.getRecord();this.setSelectedRecord(record),this.fireEvent("select"),this.collapse()},applyShowProjectScopeUpAndDown:function(value,oldValue){return value&&Rally.environment.getContext().getSubscription().ProjectHierarchyEnabled},setValue:function(value){return value instanceof Rally.data.wsapi.Model?void this.setSelectedRecord(value):void(Ext.isString(value)?this.setValueForProjectRef(value):Ext.isObject(value)&&(this.getShowProjectScopeUpAndDown()&&(this.projectScopeUp=value.projectScopeUp,this.projectScopeDown=value.projectScopeDown,this.projectScopeUpDownField&&this.projectScopeUpDownField.setValue({projectScopeUp:value.projectScopeUp,projectScopeDown:value.projectScopeDown})),this.setValueForProjectRef(value.project)))},getValue:function(){var ref=this.getSelectedRecord()?this.getSelectedRecord().get("_ref"):void 0;return this.getShowProjectScopeUpAndDown()?{project:ref,projectScopeUp:this.projectScopeUp,projectScopeDown:this.projectScopeDown}:ref},setValueForProjectRef:function(ref){Rally.data.ModelFactory.getModel({type:"Project",success:function(model){var oid=Rally.util.Ref.getOidFromRef(ref);model.load(oid,{success:function(record){this.setValue(record)},failure:function(){this.fireEvent("invalidvalue")},fetch:["Name","Workspace"],scope:this})},scope:this})},setDisplayValue:function(value){this.inputEl&&this.inputEl.dom&&(this.inputEl.dom.value=value)},setSelectedRecord:function(record){this.projectRecord=record;var displayValue=record&&record.get("Name")||"";this.setDisplayValue(displayValue),this.fireEvent("change",this,this.getValue())},getSelectedRecord:function(){return this.projectRecord},expand:function(){this.isLoaded?(this.removePlaceholderText(),this.callParent(arguments)):(this.setPlaceholderText(this.getLoadingText()),this.tree.loadTopLevel().then({success:function(){this.isLoaded=!0,this.expand()},scope:this}))},setPlaceholderText:function(text){var inputEl=this.inputEl;inputEl.addCls(this.placeholderCls),this.prePlaceholderText=inputEl.dom.value,inputEl.dom.value=text},removePlaceholderText:function(){var inputEl=this.inputEl;inputEl.hasCls(this.placeholderCls)&&(inputEl.removeCls(this.placeholderCls),inputEl.dom.value=this.prePlaceholderText)},getSubmitData:function(){var data;return!this.disabled&&this.submitValue&&(data={},data[this.getName()]=this.getValue()),data},destroy:function(){this.tree&&this.tree.destroy(),this.recents&&this.recents.destroy(),this.projectScopeUpDownField&&this.projectScopeUpDownField.destroy(),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.settings.ProjectScopeField",{extend:Ext.form.FieldContainer,alias:"widget.rallyprojectscopefield",mixins:{field:Ext.form.field.Field},cls:"projectScopeField",radioSelectedStyle:"radioSelected",readyEvent:"initialload",config:{value:void 0},initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this.addEvents("scopechanged","initialload"),this.add([{xtype:"radiofield",boxLabel:"Follow Global Project Setting",name:"projectscope",cls:this.radioSelectedStyle+" followGlobalProjectSetting",itemId:"globalRadio",submitValue:!1},{xtype:"radiofield",boxLabel:"Choose Specific Project",cls:"chooseSpecificProject",name:"projectscope",itemId:"specificRadio",submitValue:!1},{xtype:"rallyprojectpicker",disabled:!0,showProjectScopeUpAndDown:!0,submitValue:!1,listeners:{change:this._onPickerChange,invalidvalue:this._onPickerInvalidValue,scope:this}}]),this.on("afterrender",this._onAfterRender,this),this.on("initialload",function(){this.initialLoadFinished=!0},this)},_onAfterRender:function(){var globalRadio=this.down("#globalRadio"),specificRadio=this.down("#specificRadio");this.getValue()&&this.getValue().project?(globalRadio.setValue(!1),specificRadio.setValue(!0)):(globalRadio.setValue(!0),this.setValue(this._buildGlobalDataContext())),globalRadio.on("change",this._onRadioChange,this);var picker=this.down("rallyprojectpicker");picker.on("change",function(picker){this.reconfigureView(),this.fireEvent("initialload",picker,picker.getSelectedRecord())},this,{single:!0}),picker.setValue(this.getValue())},_buildGlobalDataContext:function(){return{project:Rally.environment.getContext().getProject()._ref,projectScopeUp:Rally.environment.getContext().getProjectScopeUp(),projectScopeDown:Rally.environment.getContext().getProjectScopeDown()}},reconfigureView:function(){var picker=this.down("rallyprojectpicker"),globalRadio=this.down("#globalRadio"),specificRadio=this.down("#specificRadio");globalRadio.checked?(picker.disable(),this.setValue(void 0),globalRadio.getEl().addCls(this.radioSelectedStyle),specificRadio.getEl().removeCls(this.radioSelectedStyle)):(picker.enable(),this.setValue(picker.getValue()),globalRadio.getEl().removeCls(this.radioSelectedStyle),specificRadio.getEl().addCls(this.radioSelectedStyle)),this.getValue()&&Ext.Object.toQueryString(picker.getValue())!==Ext.Object.toQueryString(this.getValue())&&picker.setValue(this.getValue())},_onRadioChange:function(){this.down("#globalRadio").checked?delete this._currentScope:this._currentScope=this.down("rallyprojectpicker").getSelectedRecord(),this.reconfigureView()},_onPickerChange:function(picker,projectData){this._currentScope=picker.getSelectedRecord(),Ext.Object.toQueryString(this.getValue())!==Ext.Object.toQueryString(projectData)&&this.setValue(projectData)},_onPickerInvalidValue:function(){this.down("#globalRadio").setValue(!0),this.fireEvent("scopechanged",void 0,void 0)},getErrors:function(){return[]},getSubmitData:function(){var data=this.getValue();return data||(data={project:"",projectScopeUp:"",projectScopeDown:""}),Ext.isString(data)&&(data={project:data}),data},setValue:function(value){Ext.Object.toQueryString(value)!==Ext.Object.toQueryString(this.getValue())&&this.initialLoadFinished&&this.fireEvent("scopechanged",value,this._currentScope),this.mixins.field.setValue.call(this,value)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.CheckboxField",{requires:[],extend:Ext.form.field.Checkbox,alias:"widget.rallycheckboxfield",inputValue:!0,uncheckedValue:!1,stateEvents:["change"],cls:"rally-checkboxfield-component",constructor:function(config){config&&config.hasOwnProperty("value")&&(this._initialValue=config.value),this.callParent(arguments)},initValue:function(){this.hasOwnProperty("_initialValue")&&(this.checked=this.isChecked(this._initialValue),delete this._initialValue),this.callParent(arguments)},getState:function(){return{checked:this.isChecked(this.getValue())}},applyState:function(state){this.setValue(state.checked)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tooltip.ToolTip",{extend:Ext.tip.ToolTip,alias:"widget.rallytooltip",anchor:"right",dismissDelay:0,shadow:!1,config:{showOnClick:!1,closableOnce:!1,destroyAfterHide:!1},constructor:function(config){config.closableOnce&&(config.closable=!0),this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.on("beforeshow",this._onBeforeShow,this)},setTarget:function(){this.target&&this.mun(Ext.get(this.target),"click",this.onTargetClick,this),this.callParent(arguments),this.target&&this.mon(Ext.get(this.target),"click",this.onTargetClick,this)},onHide:function(){if(this._tearDownListeners(),this.callParent(arguments),this.closableOnce){var config=Ext.apply({},this.initialConfig);this.destroy(),config.closable=!1,config.closableOnce=!1}this.destroyAfterHide&&this.destroy()},onShow:function(){return this.callParent(arguments),this.trigger=this._getTrigger(),Ext.get(this.trigger.dom)?void(this.closable||this._setupListeners()):void this.destroy()},onTargetOver:function(e){this.showOnClick||this.onShowTip(e)},onTargetClick:function(e){this.showOnClick&&(e.preventDefault(),this.onShowTip(e))},onMouseMove:function(){this.closable||this.callParent(arguments)},onDocMouseDown:function(){},onShowTip:function(e){this.el&&this.zIndexManager.bringToFront(this),this.isHidden()&&Rally.ui.tooltip.ToolTip.superclass.onTargetOver.call(this,e)},showNow:function(){var target=Ext.get(this.target),e={within:function(){return!1},getTarget:function(){return target?target.dom:null},getXY:function(){return target?target.getAnchorXY("r"):[0,0]}};this.onShowTip(e)},_getTrigger:function(){return this.triggerElement&&Ext.get(this.triggerElement)||Ext.get(this.target)},_setupListeners:function(){this.getEl().on("mouseout",this._initTimeout,this),this.getEl().on("mouseover",this._clearTimeout,this),this.trigger.on("mouseout",this._initTimeout,this),this.trigger.on("mouseover",this._clearTimeout,this),this._listenersAreSetup=!0},_tearDownListeners:function(){this._listenersAreSetup&&(this.getEl().un("mouseout",this._initTimeout,this),this.getEl().un("mouseover",this._clearTimeout,this),this.trigger.un("mouseout",this._initTimeout,this),this.trigger.un("mouseover",this._clearTimeout,this),this._listenersAreSetup=!1)},_initTimeout:function(){this.timeout&&this._clearTimeout(),this.timeout=Ext.defer(function(){this._clearTimeout(),this.hide()},this.hideDelay,this)},_clearTimeout:function(){window.clearTimeout(this.timeout),this.timeout=null},_onBeforeShow:function(){if(Ext.isObject(this.target)&&this.target.hasCls("hide-tooltip"))return!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.FieldValidationUi",{extend:Ext.AbstractPlugin,alias:"plugin.rallyfieldvalidationui",init:function(field){field.invalidCls="rally-invalid",field.msgTarget="none",field.on("errorchange",this._onErrorChange,this),field.on("blur",this._hideValidationCmp,this),field.on("afterrender",this._afterRender,this),field.on("hide",this._hideValidationCmp,this),this.callParent(arguments)},destroy:function(){this._cleanUpValidationCmp()},_cleanUpValidationCmp:function(){this.cmp.validationCmp&&(this.cmp.un("errorchange",this._onErrorChange,this),Ext.EventManager.removeResizeListener(this._alignToField,this),this.cmp.validationCmp.destroy(),delete this.cmp.validationCmp)},_afterRender:function(field){var parent=field.up();parent&&"editor"===parent.xtype&&parent.on("hide",this._hideValidationCmp,this,{single:!0})},_hideValidationCmp:function(field){field.validationCmp&&field.validationCmp.hide()},_onErrorChange:function(field){field.activeError?(field.validationCmp?field.validationCmp.update(field.activeError):field.getEl()?(field.validationCmp=Ext.create("Rally.ui.tooltip.ToolTip",{target:field.bodyEl,html:field.activeError,anchor:"top",listeners:{beforeshow:function(){return field.hasActiveError()&&field.isVisible(!0)}}}),Ext.EventManager.onWindowResize(this._alignToField,this)):field.on("afterrender",this._onErrorChange,this,{single:!0,delay:50}),this._alignToField()):field.validationCmp&&field.validationCmp.hide()},_alignToField:function(){this.cmp.validationCmp&&this.cmp.validationCmp.showBy(this.cmp.bodyEl,"tl-bl",[0,6])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.settings.CardAgeField",{extend:Ext.form.FieldContainer,alias:"widget.rallycardagesettingsfield",mixins:{field:Ext.form.field.Field},layout:"hbox",cls:"card-age-settings",config:{value:void 0},initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this.add([{xtype:"rallycheckboxfield",name:"showCardAge",boxLabel:"Show age for card after",submitValue:!1,value:this.getValue().showCardAge},{xtype:"rallytextfield",plugins:["rallyfieldvalidationui"],name:"cardAgeThreshold",width:20,margin:"0 5px",maskRe:/[0-9]/,submitValue:!1,value:this.getValue().cardAgeThreshold,getErrors:function(){return this.allowBlank=!this.ownerCt.down("rallycheckboxfield").getValue(),Rally.ui.TextField.prototype.getErrors.apply(this,arguments)}},{xtype:"component",autoEl:"label",margin:"3px 0 0 0",html:"day(s) in column"}])},getSubmitData:function(){var data={},showCardAgeField=this.down("rallycheckboxfield");if(data[showCardAgeField.name]=showCardAgeField.getValue(),showCardAgeField.getValue()){var cardAgeThreshold=this.down("rallytextfield");data[cardAgeThreshold.name]=cardAgeThreshold.getValue()}return data}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Test",{requires:[],singleton:!0,toBrowserTestCssClass:function(){return""},toBrowserTestCssSelector:Ext.emptyFn})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.EmptyTextFactory",{requires:[],singleton:!0,emptyTextCls:Ext.baseCSSPrefix+"grid-view-empty",config:{typeMap:{},defaultText:"<p>No items found.</p>"},constructor:function(cfg){this.initConfig(cfg)},get:function(typeName){return this.getEmptyTextFor(this.getTypeNameMessage(typeName))},getEmptyTextFor:function(message){return this.getEmptyTextDiv(message)},getEmptyTextDiv:function(emptyText){return'<div class="'+this.emptyTextCls+'">'+emptyText+"</div>"},getTypeNameMessage:function(typeName){var typeMap=this.getTypeMap();return typeName&&typeMap.hasOwnProperty(typeName)?new Ext.XTemplate(typeMap[typeName]).apply({}):this.getDefaultText()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.ButtonChooser",{extend:Ext.form.FieldContainer,
alias:"widget.rallybuttonchooser",mixins:{field:Ext.form.field.Field},portfolioItemConfig:{chooserConfig:{artifactTypes:["portfolioitem"],storeConfig:{context:{project:null},fetch:["PortfolioItemType"]},title:"Choose a Portfolio Item",closeAction:"hide",selectionButtonText:"Select"},extractDisplayValue:"portfolioitem"},config:{name:"rallybuttonchooser",value:void 0,layout:"hbox",items:[{xtype:"rallybutton",text:"Choose",cls:"primary rly-small",itemId:"changeButton",style:{"padding-left":"15px","padding-right":"15px"}},{xtype:"displayfield",itemId:"itemField",style:{"margin-left":"10px","margin-top":"2px"}}],type:"portfolioitem",chooserConfig:void 0,extractDisplayValue:void 0,context:void 0,emptyText:"<p>No portfolio items match your search criteria.</p>"},_prebuiltDisplayValueExtractors:{portfolioitem:function(portfolioItem){return portfolioItem.PortfolioItemType.Name+" "+portfolioItem.FormattedID+": "+portfolioItem.Name},defaultExtractor:function(artifact){return""+artifact.FormattedID}},_displayValueExtractor:Ext.emptyFn,constructor:function(config){config=this._configureChooser(config),this.mergeConfig(config),this.callParent([this.config])},_configureChooser:function(config){var context={};if("portfolioitem"===config.type&&Ext.Object.merge(config,this.portfolioItemConfig),config.context&&(context={workspace:config.context.getWorkspace()._ref}),!config.chooserConfig)throw"No configuration set for chooser, please specify config.type or config.chooserConfig";return Ext.Object.merge(config.chooserConfig,{listeners:{artifactChosen:this._onArtifactChosen,scope:this},storeConfig:{project:null,context:context},gridConfig:{showRowActionsColumn:!1,viewConfig:{emptyText:Rally.ui.EmptyTextFactory.getEmptyTextFor(config.emptyText||this.config.emptyText)}}}),config},initComponent:function(){this.addCls(Rally.util.Test.toBrowserTestCssClass("buttonChooser")),this.callParent(arguments),this._configureDisplayNameExtractor();var artifactWithContext=Ext.JSON.decode(this.getValue());this._setDisplayValue(artifactWithContext),this.down("#changeButton").addListener("click",this._onButtonClick,this)},_configureDisplayNameExtractor:function(){var configValue=this.extractDisplayValue,builtInExtractors=this._prebuiltDisplayValueExtractors;"function"==typeof configValue?this._displayValueExtractor=configValue:builtInExtractors.hasOwnProperty(configValue)?this._displayValueExtractor=builtInExtractors[configValue]:this._displayValueExtractor=builtInExtractors.defaultExtractor},_setDisplayValue:function(artifactWithContext){var displayValue="";if(artifactWithContext)try{displayValue=this._displayValueExtractor(artifactWithContext.artifact)}catch(e){this.value=void 0}this.down("#itemField").setValue(displayValue)},_onButtonClick:function(){this.dialog&&this.dialog.destroy(),this.dialog=Ext.create("Rally.ui.dialog.ChooserDialog",this.chooserConfig),this.dialog.show()},_onArtifactChosen:function(results){var artifactWithContext,encodedString;results&&(artifactWithContext={artifact:results.data,context:results.store.model.context},this._setDisplayValue(artifactWithContext),encodedString=Ext.JSON.encode(artifactWithContext),this.setValue(encodedString)),this.dialog.destroy()},getSubmitData:function(){var returnObject={};return returnObject[this.getName()]=this.getValue(),returnObject}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Help",{singleton:!0,constructor:function(){this.linkTpl=Ext.create("Ext.Template",'<a href="{href}" target="_blank" title="Help & Training" alt="Help & Training">{text}</a>'),this.iconTpl=Ext.create("Ext.Template",'<span class="rally-help-icon">{link}</span>'),this.callParent(arguments)},topics:[{id:0,url:""},{id:2,url:"use-and-customize-views#summary"},{id:3,url:"use-and-customize-views#details"},{id:4,url:"keyboard-shortcuts"},{id:5,url:"defects#viewing"},{id:6,url:""},{id:7,url:"creating-iteration#viewing iteration summary and detail"},{id:8,url:""},{id:9,url:"defining-tasks#task detail"},{id:10,url:"test-cases"},{id:11,url:""},{id:12,url:""},{id:13,url:""},{id:14,url:""},{id:15,editor:"iteration",url:"creating-iteration#iteration fields"},{id:16,url:""},{id:17,editor:"task",url:"defining-tasks#task fields"},{id:18,editor:"testcase",url:"test-cases"},{id:19,url:""},{id:20,url:""},{id:21,url:""},{id:22,url:"viewing-rally-revision-history"},{id:23,url:"status-reports#printing"},{id:24,url:"edit-multiple-attribute-values"},{id:25,url:""},{id:26,url:"tracking-iterations#iteration task status"},{id:27,url:""},{id:28,url:""},{id:29,url:"defining-tasks#task summary"},{id:30,url:"creating-release#viewing release summary and detail"},{id:31,editor:"release",url:"creating-release#release fields"},{id:32,url:"searching-work-items#search tab"},{id:33,url:""},{id:34,url:"creating-release#viewing release summary and detail"},{id:35,url:"creating-iteration#viewing iteration summary and detail"},{id:36,url:"progress-reports#idpc"},{id:37,url:"importing-and-exporting-data"},{id:38,url:"importing-and-exporting-data"},{id:39,editor:"subscription",url:"configure-your-subscription#fields"},{id:40,url:"set-your-profile"},{id:41,editor:"webtab",url:"create-custom-pages#fields"},{id:42,url:"customize-your-workspace#manage workspaces"},{id:43,url:"set-your-notifications#summary"},{id:44,editor:"usernotificationfilter",url:"set-your-notifications#create"},{id:45,url:"creating-user-story#pages"},{id:46,url:"customize-your-workspace#set up work item prefixes"},{id:47,editor:"userstory",url:"creating-user-story#fields"},{id:48,url:"creating-user-story#pages"},{id:49,editor:"attribute",url:"create-custom-fields"},{id:50,url:"defining-tasks#my tasks"},{id:51,url:"planning-iterations"},{id:52,url:"change-project-scoping#select"},{id:53,url:""},{id:54,url:"progress-reports#icfc"},{id:55,url:"tracking-iterations#iteration defect status"},{id:56,url:"tracking-iterations#iteration test case status"},{id:57,url:"tracking-releases#release metrics"},{id:58,url:"build-your-backlog"},{id:59,url:"collaborate-team-members#attachments"},{id:60,url:"progress-reports"},{id:61,url:"progress-reports#iburndown"},{id:62,url:"defects#my"},{id:63,url:"test-cases"},{id:64,editor:"testcaseresult",url:"test-case-results#fields"},{id:65,url:"customize-your-workspace#set up work item fields"},{id:66,url:"identifying-dependencies"},{id:67,url:"progress-reports#rburndown"},{id:68,url:"setting-projects#project details"},{id:69,editor:"project",url:"setting-projects#fields"},{id:70,url:""},{id:71,url:"administer-users#users"},{id:72,editor:"workspace",url:"customize-your-workspace"},{id:73,url:"customize-your-workspace#view workspace detail"},{id:74,url:""},{id:75,url:""},{id:76,url:""},{id:77,url:"test-case-results#details"},{id:78,url:"test-case-results#summary"},{id:79,url:"set-your-notifications#my"},{id:80,url:"tracking-releases#view release defect status"},{id:81,url:"test-cases"},{id:82,url:"setting-programs#roadmap"},{id:83,url:"breaking-down-stories"},{id:84,url:"setting-programs#roadmap"},{id:85,url:""},{id:86,url:""},{id:87,url:""},{id:88,url:""},{id:89,url:"defects#viewing"},{id:90,url:"progress-reports#velocity"},{id:91,url:""},{id:92,url:""},{id:93,url:"setting-programs#status"},{id:94,url:"creating-user-story#fields"},{id:95,url:"customize-your-workspace#set up work item fields"},{id:96,editor:"testfolder",url:"managing-test-plans#edit"},{id:97,editor:"customview",url:"use-and-customize-views#fields"},{id:98,url:"log-rally"},{id:99,url:"view-team-member-capacity"},{id:100,url:"administer-programs"},{id:101,editor:"program",url:"setting-programs#fields"},{id:102,url:"how-rally-organizes-information"},{id:103,url:"how-rally-organizes-information"},{id:104,url:"how-rally-organizes-information"},{id:105,url:"how-rally-organizes-information"},{id:106,editor:"user",url:"administer-users#fields"},{id:107,url:""},{id:108,url:""},{id:109,url:""},{id:110,url:"customize-your-workspace#configuring workspace units"},{id:111,url:"configure-your-subscription"},{id:112,url:"defect-suites"},{id:113,url:"defect-suites"},{id:114,url:"defect-suites"},{id:115,url:"breaking-stories-down"},{id:116,url:"tracking-releases#view release task status"},{id:117,url:"tracking-releases#view release test case status"},{id:118,url:"flow-based-tracking#view work item status"},{id:119,editor:"defect",url:"defects#fields"},{id:120,editor:"defectsuite",url:"defects#fields"},{id:121,url:"timebox-based-planning"},{id:122,url:"setting-programs#status"},{id:123,url:"kanban-reports#workitem"},{id:124,url:""},{id:125,url:"change_project_scoping#relationships"},{id:126,url:"progress-reports#idsc"},{id:127,url:"categorizing-work#view"},{id:128,url:"progress-reports#rcfc"},{id:129,url:"status-reports#arrival"},{id:130,url:"status-reports#priority"},{id:131,url:"status-reports#state"},{id:132,url:"collaborate-team-members#discussions"},{id:133,url:"defects#duplicate"},{id:134,url:"test-runs"},{id:135,url:"creating-user-story#child"},{id:136,url:""},{id:137,url:""},{id:139,url:"status-reports#workspace"},{id:140,url:"program-dashboard"},{id:141,url:"team-measurements#my"},{id:142,url:"identifying-dependencies#succsum"},{id:143,url:"identifying-dependencies#predsum"},{id:144,url:"change-project-scoping#views"},{id:145,url:"setting-projects#child"},{id:146,url:"setting-projects#project details"},{id:147,url:"configure-your-subscription#managing"},{id:148,url:"searching-work-items#custom"},{id:149,url:"setting-projects#child"},{id:150,url:"administer-users#fields"},{id:151,url:"prioritizing-work"},{id:152,url:"prioritizing-work"},{id:153,url:"managing-test-plans"},{id:154,url:"managing-test-plans#run"},{id:155,url:"Prioritizing-Backlog"},{id:156,url:"writing-great-user-story"},{id:157,url:"setting-projects#overview"},{id:158,url:"use-and-customize-views#create"},{id:159,url:"build-your-backlog"},{id:160,editor:"testset",url:"rally-quality-manager-overview"},{id:161,url:"enhanced-burndown-chart"},{id:162,url:"cross-workspace-release-status"},{id:163,url:"release-and-iteration-dashboard"},{id:164,url:"agile-evm"},{id:165,url:"super-customizable-charts"},{id:166,resource:"backlog",url:"build-your-backlog"},{id:167,url:"scope-change-report"},{id:168,url:"enhanced-velocity-chart"},{id:169,resource:"recyclebin",url:"common-actions#using the recycle bin"},{id:170,url:"administer-users#teams"},{id:171,url:"progress-reports#iburnup"},{id:172,url:"progress-reports#rburnup"},{id:173,url:"defects#convert"},{id:174,url:"progress-reports#rdtc"},{id:175,url:"progress-reports#sburndown"},{id:176,resource:"iterationstatus",url:"tracking-iterations#iteration status"},{id:177,url:"hp-quality-center-app"},{id:178,resource:"tt",url:"rally-time-tracker-overview"},{id:179,url:"user-lookup"},{id:180,url:"customize-your-dashboard"},{id:181,url:""},{id:182,url:"watch-tutorials"},{id:183,url:"agile-video-tutorials"},{id:184,url:"custom-reports"},{id:185,url:"generate-timesheet-reports"},{id:186,url:"rally-reports-and-charts"},{id:187,url:"custom-reports"},{id:188,resource:"dashboard",url:"customize-your-dashboard"},{id:189,resource:"projectusers",url:"administer-users#add"},{id:190,resource:"users",url:"administer-users"},{id:191,resource:"changeset",url:"view-build-status#BuildandSCMTraceability-enable"},{id:192,resource:"search",url:"searching-work-items#search tab"},{id:193,url:"rally-menu-preview"},{id:194,url:"grid-queries"},{id:195,url:"new-rally-menus"},{id:196,url:"ide-connectors"},{id:197,url:"source-code"},{id:198,url:"tables"},{id:199,url:"card-board"},{id:200,url:"dropdown-components"},{id:201,url:"basic-components#CheckBox"},{id:202,url:"basic-components#Link"},{id:203,url:"basic-components#TextBox"},{id:204,url:"basic-components#Tooltip"},{id:205,url:"pie-chart"},{id:206,url:"basic-components#Dialog"},{id:207,url:"rally-data-source"},{id:208,url:"ui-examples#dashboard"},{id:209,url:"ui-examples#iteration"},{id:210,url:"ui-examples#colorcoded"},{id:211,url:"App-SDK"},{id:212,url:"connect-your-tools"},{id:213,url:"iteration-demo-and-review-meetings"},{id:214,url:"progress-reports#sburnup"},{id:215,url:"progress-reports#scfc"},{id:216,url:"progress-reports#tsbc"},{id:217,url:"team-measurements#cycle"},{id:218,url:"team-measurements#through"},{id:219,url:"status-reports#trend"},{id:220,url:"status-reports#health"},{id:221,url:"progress-reports#bhbic"},{id:222,url:"status-reports#top"},{id:223,url:"status-reports#files"},{id:224,url:"getting-started-rally-portfolio-manager"},{id:225,resource:"portfolioitemuserstories",url:"creating-user-story"},{id:226,editor:"portfolioitem",resource:["portfolioitem","portfolioitemchildren"],url:"portfolio-item"},{id:227,url:"get-started-rally"},{id:228,url:"customize-your-dashboard#shared"},{id:229,url:"portfolio-item-timeline"},{id:230,url:"build_traceability"},{id:231,url:"build-dashboard"},{id:232,url:"defects_by_closer"},{id:233,url:"enhanced-burndown-chart"},{id:234,url:"enhanced-velocity-chart"},{id:235,url:"epic-progress"},{id:236,url:"estimation-board"},{id:237,url:"iteration-summary"},{id:238,url:"kanban-board"},{id:239,url:"last-result-test-set"},{id:240,url:"planned-vs-actual-burndown-chart"},{id:241,url:"print-story-cards"},{id:242,url:"print-task-cards"},{id:243,url:"quality-center"},{id:244,url:"recently-changed"},{id:245,url:"release-dependencies"},{id:246,url:"content/test-set"},{id:247,url:"release-summary"},{id:248,url:"scope-change-report"},{id:249,url:"source-code-check"},{id:250,url:"stories-creator"},{id:251,url:"story-board"},{id:252,url:"story-deep-copy"},{id:253,url:"story-map"},{id:254,url:"iteration-status-beta"},{id:255,url:"system-requirement-validation-document-0"},{id:256,url:"test-case-passfail-history"},{id:257,url:"traceability-matrix-0"},{id:258,url:""},{id:259,url:"utilization-chart"},{id:260,url:"manage-unfinished-work"},{id:261,url:"active-defect-charts"},{id:262,url:"plan-release"},{id:263,url:"customize-your-workspace#show hide custom"},{id:264,url:"start-learning-rally-product"},{id:265,name:"portfolioItemKanbanPolicies",url:"portfolio-kanban-board#video"},{id:266,name:"deprecate program",url:"administer-programs"},{id:267,url:"track-iterations"},{id:268,url:"portfolio-hierarchy"},{id:269,url:"story-hierarchy"},{id:270,url:"iteration-tracking-board"},{id:271,url:"grid-queries-rpm"},{id:272,url:"iteration-planning-board"},{id:273,url:"portfolio-item-burnup"},{id:274,url:"portfolio-item-cumulative-flow"},{id:275,url:"administer-users#custom"},{id:276,url:"kanban-board#setup"},{id:277,url:"report-blocked-work"},{id:278,url:"release-burndown"},{id:279,url:"project-cumulative-flow"},{id:280,url:"plan-roadmaps"},{id:281,url:"plan-roadmaps#plans-defined"},{id:282,url:"plan-roadmaps#coming-soon"},{id:283,url:"create-custom-pages#share"},{id:284,url:"release-planning-board"},{id:285,url:"milestones"},{id:286,url:"task-board"},{id:287,url:"custom-board"},{id:288,url:"timeboxes"},{id:289,url:"filter-customize-view"},{id:290,url:"link-first-minutes-ac"},{id:291,url:"link-build-backlog"},{id:292,url:"link-plan"},{id:293,url:"link-custom-pages"},{id:294,url:"link-update-tasks"},{id:295,url:"link-health-status"},{id:296,url:"link-stories-blank"},{id:297,url:"link-testplan-blank"}],demoVideos:[{id:1,demoVideo:!0,name:"first5Minutes",url:"your_first_minutes_in_rally.swf"},{id:2,demoVideo:!0,name:"agileTransition",url:"leading_an_agile_transition.swf"},{id:3,demoVideo:!0,name:"statusAndHealth",url:"checking_status_and_health.swf"},{id:4,demoVideo:!0,name:"predictReleaseDate",url:"predicting_a_release_date.swf"},{id:5,demoVideo:!0,name:"updateTasks",url:"update_tasks.swf"},{id:6,demoVideo:!0,name:"scrumMasterStart",url:"getting_started_for_scrum_masters.swf"},{id:7,demoVideo:!0,name:"buildBacklog",url:"build_your_backlog.swf"},{id:8,demoVideo:!0,name:"planReleasesAndIterations",url:"plan_releases_and_iterations.swf"},{id:9,demoVideo:!0,name:"createTestPlans",url:"test_plans.swf"},{id:10,demoVideo:!0,name:"customizeDashboard",url:"customize_your_dashboard.swf"},{id:123,demoVideo:!0,name:"portfolioitem",url:"portfolio_manager_overview_user.swf"},{id:124,demoVideo:!0,url:"portfolio_manager_overview_admin.swf"},{id:125,demoVideo:!0,name:"planIterations",url:"planning_an_iteration.swf"}],launchHelp:function(options){var url=options&&options.url;if(url)url=this._injectBaseHost(url);else{var topic=this.findTopic(options);url=this.getFullUrlForTopic(topic)}var windowOpener=this._getWindowOpener(),omitWindowOptions=Ext.isChrome;return windowOpener&&windowOpener(url,1024,768,"help",null,{location:1,toolbar:1},!0,omitWindowOptions),!1},getLinkTag:function(options){return this.linkTpl.apply({href:this.getHelpUrl(options),text:options.text})},getIcon:function(options){return options.text="",this.iconTpl.apply({link:this.getLinkTag(options)})},getHelpUrl:function(options){var topic=this.findTopic(options);return topic?this.getFullUrlForTopic(topic):options.resource?this._injectBaseHost(this.getSearchBaseUrl()+options.resource):this._injectBaseHost(this.getHelpBaseUrl())},findTopic:function(options){var matchingTopic;if(options)return options.id&&(options.id="string"==typeof options.id?parseInt(options.id,10):options.id),options.demoVideo===!0?Ext.each(this.demoVideos,function(topic){if(options.id){if(options.id===topic.id)return matchingTopic=Ext.clone(topic),!1}else if(options.name&&options.name===topic.name)return matchingTopic=Ext.clone(topic),!1}):Ext.each(this.topics,function(topic){if(options.id){if(options.id===topic.id)return matchingTopic=Ext.clone(topic),!1}else if(options.resource){var resources=topic.resource?topic.resource instanceof Array?topic.resource:[topic.resource]:[];if(Ext.Array.contains(resources,options.resource))return matchingTopic=Ext.clone(topic),!1}else if(options.editor){var editors=topic.editor?topic.editor instanceof Array?topic.editor:[topic.editor]:[];if(Ext.Array.contains(editors,options.editor))return matchingTopic=Ext.clone(topic),!1}}),matchingTopic&&(matchingTopic.url=this._updateNameBasedOnSubscriptionType(matchingTopic.url)),matchingTopic},getFullUrlForTopic:function(topic){var url;if(topic){var baseUrl;baseUrl=topic.demoVideo?this.getMediaBaseUrl():this.getHelpBaseUrl(),url=baseUrl+topic.url}else url=this.getHelpBaseUrl();return url=this._injectBaseHost(url)},getHelpBaseUrl:function(){return Ext.String.format("https://{0}help.rallydev.com/",this.getAbbreviationForEdition())},getEditionSpecificSuffix:function(){return this.getAbbreviationForEdition().length>0?"-"+this.getAbbreviationForEdition():""},getAbbreviationForEdition:function(){var context=Rally.environment.getContext(),subscriptionType=context.getSubscription().SubscriptionType;return Rally.util.String.contains(subscriptionType,"HS")?"ce":Rally.util.String.contains(subscriptionType,"Express_Edition")?"xe":""},getSearchBaseUrl:function(){return"https://help.rallydev.com/search/site/"},getMediaBaseUrl:function(){return"https://help.rallydev.com/sites/default/files/multimedia/videos/"},getWikiUrl:function(){return"http://www.rallydev.com"},_injectBaseHost:function(url){var basehost="?basehost="+window.location.protocol+"//"+window.location.host;return url.indexOf("basehost")===-1&&(url.indexOf("#")!==-1?url=url.replace(/#.*/i,basehost+"$&"):url+=basehost),url},_getWindowOpener:function(){var globalOpener="popup";return window[globalOpener]||window.top[globalOpener]},_updateNameBasedOnSubscriptionType:function(name){return name&&name.length>0&&(name.indexOf(".")!==-1||name.indexOf("#")!==-1?name=name.replace(/(\.|#).*/i,this.getEditionSpecificSuffix()+"$&"):name+=this.getEditionSpecificSuffix()),name}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.HelpField",{extend:Ext.AbstractPlugin,alias:"plugin.rallyhelpfield",helpId:void 0,helpText:"query help",init:function(cmp){cmp.on("afterrender",this._onAfterCmpRender,this)},_onAfterCmpRender:function(cmp){cmp.getEl().down("tr").createChild({cls:"help-field",html:Rally.util.Help.getLinkTag({id:this.helpId,text:this.helpText}),tag:"td"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.SettingsFactory",{singleton:!0,getEditorConfig:function(type){return this.editorRenderers[type]},editorRenderers:{text:{xtype:"rallytextfield",anchor:"100%"},cardage:{xtype:"rallycardagesettingsfield",fieldLabel:"",mapsToMultiplePreferenceKeys:["showCardAge","cardAgeThreshold"]},type:{readyEvent:"ready",xtype:"rallycombobox",shouldRespondToScopeChange:!0,stateful:!1,storeConfig:{autoLoad:!1,remoteFilter:!0,model:Ext.identityFn("TypeDefinition"),sorters:{property:"ordinalValue",direction:"Desc"},filters:[{property:"Parent.Name",value:"Portfolio Item"},{property:"Creatable",operator:"=",value:"true"}]},listeners:{setvalue:function(field,value){value&&this.isReady&&this.fireEvent("typeselected",field.getRecord().get("TypePath"),this.context)},ready:function(combo){this.isReady=!0,this.fireEvent("typeselected",combo.getRecord().get("TypePath"),this.context)}},bubbleEvents:["typeselected"],defaultSelectionPosition:"last",handlesEvents:{projectscopechanged:function(context){this.mon(this.store,"load",this.setDefaultValue,this,{single:!0}),this.refreshWithNewContext(context)}}},project:{xtype:"rallyprojectscopefield",mapsToMultiplePreferenceKeys:["project","projectScopeUp","projectScopeDown"],storeConfig:{autoLoad:!1},bubbleEvents:["initialload","scopechanged"]},buttonchooser:{xtype:"rallybuttonchooser"},query:{xtype:"textarea",fieldLabel:"Query",name:"query",anchor:"100%",cls:"query-field",margin:"0 70 0 0",plugins:[{ptype:"rallyhelpfield",helpId:194},"rallyfieldvalidationui"],validateOnBlur:!1,validateOnChange:!1,validator:function(value){try{return value&&Rally.data.wsapi.Filter.fromQueryString(value),!0}catch(e){return e.message}}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.ClosableTool",{extend:Ext.panel.Tool,alias:"widget.rallyclosabletool",renderTpl:['<div class="icon-cancel"></div>'],renderSelectors:{toolEl:".icon-cancel"},width:22,handler:function(event,target,owner){var dialog=owner.ownerCt;dialog.close()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.ScrollListener",{requires:[],defaultOptions:{buffer:250},saveScrollPosition:!1,constructor:function(handler,scope,options){this.handler=handler,this.scope=scope,Ext.apply(this.options,options,this.defaultOptions)},enable:function(){Ext.getDoc().on("scroll",this._executeHandler,this,this.options),Ext.getBody().on("scroll",this._executeHandler,this,this.options)},disable:function(){Ext.getDoc().un("scroll",this._executeHandler,this),Ext.getBody().un("scroll",this._executeHandler,this)},_executeHandler:function(){this.saveScrollPosition&&this._restorePosition(this.scope),Ext.callback(this.handler,this.scope)},_restorePosition:function(scope){if(scope.savedScrollPosition){var savedPosition=scope.savedScrollPosition;window.scrollTo(savedPosition.xOffset,savedPosition.yOffset),this.saveScrollPosition=!1}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.Dialog",{extend:Ext.window.Window,alias:"widget.rallydialog",clientMetrics:{beginEvent:"beforeshow",endEvent:"show",description:"dialog shown"},config:{context:void 0},ui:"rally",stateful:!1,resizable:!1,draggable:!1,modal:!0,shadow:!0,closable:!1,plain:!0,autoCenter:!0,persistOnNavigation:!1,disableScroll:!1,titleIconHtml:"",y:1,_originalDocumentScrollFunction:null,_originalWindowScrollFunction:null,constructor:function(config){this.autoCenter&&(this.scrollListener=Ext.create("Rally.ui.ScrollListener",this.center,this)),this.callParent(arguments)},initComponent:function(){this.title=this.titleIconHtml+this.title,this.callParent(arguments)},addTool:function(tools){Ext.isObject(tools)&&"close"===tools.type&&(Ext.destroy(tools),tools={xtype:"rallyclosabletool"}),this.callParent(arguments)},show:function(){this.autoCenter&&(Ext.EventManager.onWindowResize(this.center,this,{buffer:250}),this.scrollListener.enable()),this.disableScroll&&(window.addEventListener&&window.addEventListener("DOMMouseScroll",this._cancelScroll,!1),this._originalWindowScrollFunction=window.onmousewheel,this._originalDocumentScrollFunction=document.onmousewheel,window.onmousewheel=document.onmousewheel=this._cancelScroll),this.callParent(arguments)},afterShow:function(){this.callParent(arguments),this.autoCenter&&this.center()},destroy:function(){this.autoCenter&&(Ext.EventManager.removeResizeListener(this.center,this),this.scrollListener.disable()),this.disableScroll&&(window.addEventListener&&window.removeEventListener("DOMMouseScroll",this._cancelScroll,!1),window.onmousewheel=this._originalWindowScrollFunction,document.onmousewheel=this._originalDocumentScrollFunction),this.callParent(arguments)},_cancelScroll:function(event){return event.preventDefault&&event.preventDefault(),event.returnValue=!1,!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.ConfirmDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallyconfirmdialog",clientMetrics:{beginEvent:"beforeshow",endEvent:"show",description:"dialog shown"},width:350,closable:!0,autoShow:!0,componentCls:"rally-confirm-dialog",title:"",titleIconHtml:'<span aria-hidden="true" class="icon-warning"></span> ',message:"",confirmLabel:"Continue",cancelLabel:"Cancel",defaultFocus:"confirm",items:[{xtype:"component",itemId:"confirmMsg",cls:"confirmMessage"}],dockedItems:[{xtype:"toolbar",dock:"bottom",padding:"10",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",cls:"confirm primary rly-small",itemId:"confirmButton",userAction:"clicked yes in dialog"},{xtype:"rallybutton",cls:"cancel secondary rly-small",itemId:"cancelButton",ui:"link"}]}],constructor:function(config){this.callParent(arguments),this.autoCenter&&(this.scrollListener.saveScrollPosition=!0)},initComponent:function(){this.callParent(arguments),this.addEvents("confirm","cancel"),this.down("#confirmButton").on("click",this._onConfirm,this),this.down("#confirmButton").setText(this.confirmLabel),this.down("#cancelButton").on("click",this._onCancel,this),this.down("#cancelButton").setText(this.cancelLabel),this.message?this.down("#confirmMsg").update(this.message):this.down("#confirmMsg").hide()},show:function(){this.autoCenter&&this._saveScrollPosition(),this.callParent(arguments);var focusButton=this.down("#"+this.defaultFocus+"Button");focusButton&&focusButton.rendered&&focusButton.focus()},close:function(){this._onCancel()},_onConfirm:function(){this.fireEvent("confirm",this),this.destroy()},_onCancel:function(){this.fireEvent("cancel",this),this.destroy()},_saveScrollPosition:function(){this.savedScrollPosition={xOffset:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,yOffset:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.AppSettings",{extend:Ext.Container,alias:"widget.rallyappsettings",inheritableStatics:{GLOBAL_SETTINGS:["title","project","projectScopeUp","projectScopeDown","autoResize"]},componentCls:"app-settings",config:{context:void 0,fields:[],userFields:[],settings:{},defaultSettings:{},isEditable:!0,settingsScope:"app",shouldInjectTitleField:!1},_currentScope:null,constructor:function(config){Ext.applyIf(config.settings,config.defaultSettings),this.initialSettings=Ext.clone(config.settings),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addEvents("save","cancel","appsettingsready"),this.isReady={},this._loadPreferenceModel()},addSettingsFields:function(fields){this.addFieldsToCmp(this.down("#scopedSettingsForm"),fields)},addFieldsToCmp:function(cmp,fields){var drawFieldForCmp=_.curry(this._drawField)(cmp);_.each(fields,drawFieldForCmp,this)},_loadPreferenceModel:function(){Rally.data.ModelFactory.getModel({type:"Preference",success:function(model){this._preferenceModel=model,this._loadPreferences({callback:this._preferencesRetrieved,scope:this})},scope:this})},_drawForms:function(){var disableAppScopedSettings=!1,disableScopedSettings=!1,permissions=this.context.getPermissions(),isCurrentProjectAdmin=permissions&&permissions.isProjectAdmin(this._getCurrentContext().getProject()),hasAppScopedSettings=this._getAppScopedSettingsFields().length,hasWorkspaceOrProjectSettings="app"!==this.settingsScope&&this._getScopedSettingsFields().length,hasNonUserScopedSettings=hasAppScopedSettings||hasWorkspaceOrProjectSettings;!this.isEditable&&"project"===this.settingsScope&&isCurrentProjectAdmin&&(this.isEditable=!0,disableAppScopedSettings=!0),hasNonUserScopedSettings&&this.add({xtype:"container",itemId:"nonUserScopedSettingsContainer"}),hasAppScopedSettings&&this._drawAppSettingsForm(disableAppScopedSettings),hasWorkspaceOrProjectSettings&&this._drawWorkspaceOrProjectSettingsForm(disableScopedSettings),this.getUserFields()&&this.getUserFields().length&&this._drawUserSettingsForm()},_getDefaultFormConfig:function(){return{xtype:"form",cls:"settings-form",border:!1,manageHeight:!1}},_drawAppSettingsForm:function(disableAppScopedSettings){this.down("#nonUserScopedSettingsContainer").add([{xtype:"component",itemId:"settingsTitle",disabled:disableAppScopedSettings,html:"app"!==this.settingsScope&&this._getScopedSettingsFields().length?"Global Settings":"Settings",cls:"settings-title"},Ext.apply({itemId:"settingsForm",disabled:disableAppScopedSettings,listeners:{initialload:this._projectScopeAvailable,scopechanged:this._raiseProjectScopeChanged,scope:this}},this._getDefaultFormConfig())])},_drawWorkspaceOrProjectSettingsForm:function(disableScopedSettings){this.down("#nonUserScopedSettingsContainer").add([{xtype:"component",itemId:"scopedSettingsTitle",disabled:disableScopedSettings,html:("project"===this.settingsScope&&this._getCurrentContext().getProject().Name||"workspace"===this.settingsScope&&this._getCurrentContext().getWorkspace().Name)+" Settings",cls:"settings-title scoped"},Ext.apply({itemId:"scopedSettingsForm",disabled:disableScopedSettings},this._getDefaultFormConfig())])},_drawUserSettingsForm:function(){this.add([{xtype:"component",html:"My Settings",itemId:"userSettingsTitle",cls:"settings-title user-scoped"},Ext.apply({itemId:"userScopedSettingsForm"},this._getDefaultFormConfig())])},_hasProjectPicker:function(){return _.some(this.getFields(),{type:"project"})},_projectScopeAvailable:function(picker,scopeRecord){"app"!==this.settingsScope&&(this._currentScope=scopeRecord,this._drawScopedSettings())},_loadPreferences:function(options){this.getContext()&&this.getContext().get("appID")?Rally.app.settings.Loader.load({callback:options.callback,context:this._getCurrentContext(),scope:options.scope,settingsScope:this.settingsScope}):Ext.callback(options.callback,options.scope,[{}])},_preferencesRetrieved:function(settings){this.isReady.canInvoke=!0,this.setSettings(Ext.apply({},settings,this.settings)),this._injectTitleField(),this._drawForms(),this._drawAppScopedSettings(),"app"===this.settingsScope||this._hasProjectPicker()||this._drawScopedSettings(),this._drawUserScopedSettings(),this._fireReady()},_raiseProjectScopeChanged:function(project,scopeRecord){this._currentScope=scopeRecord,"project"===this.settingsScope?(this.setLoading(!0),this.down("#scopedSettingsForm").items.each(this._removeFieldEventHandlers,this),this.down("#scopedSettingsForm").removeAll(!0),this._loadPreferences({callback:this._redrawProjectSettings,scope:this})):this.fireEvent("projectscopechanged",this._getCurrentContext())},_removeFieldEventHandlers:function(field){Ext.Object.each(field.handlesEvents,function(event,handler){this.un(event,handler,field)},this)},_redrawProjectSettings:function(settings){this.setSettings(Ext.apply({},settings,this.defaultSettings)),this._drawScopedSettings(),this.setLoading(!1)},_injectTitleField:function(){this.getShouldInjectTitleField()&&!_.some(this.getFields(),{name:"title"})&&this.getFields().unshift({type:"text",name:"title",label:"Title"})},_getAppScopedSettingsFields:function(){
var appScopedSettingsFields=_.filter(this.getFields(),function(fieldConfig){return this._isGlobalSettingsField(fieldConfig)||"app"===this.settingsScope},this);return this.isEditable&&"project"===this.settingsScope&&this.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()&&appScopedSettingsFields.push({xtype:"rallycheckboxfield",plugins:[{ptype:"rallyhelpfield",helpId:276,helpText:"more info"}],boxLabel:"Check this box to update the default settings for this app across the Workspace. If this box is not checked, settings will be applied for the current Project only.",boxLabelCls:"default-settings-box-label",cls:"default-settings-checkbox",itemId:"defaultSettingsCheckbox",label:"Default Settings",submitValue:!1}),appScopedSettingsFields},_getScopedSettingsFields:function(){return _.filter(this.getFields(),function(fieldConfig){return"app"!==this.settingsScope&&!this._isGlobalSettingsField(fieldConfig)},this)},_drawAppScopedSettings:function(){this.addFieldsToCmp(this.getAppScopedSettingsForm(),this._getAppScopedSettingsFields())},_drawScopedSettings:function(){var scopedSettingsFields=this._getScopedSettingsFields();if(scopedSettingsFields.length){var scopeName="project"===this.settingsScope?this._getCurrentContext().getProject().Name:this._getCurrentContext().getWorkspace().Name;this.down("#scopedSettingsTitle").update(scopeName+" Settings"),this.addSettingsFields(scopedSettingsFields)}},_drawUserScopedSettings:function(){this.getUserFields()&&this.getUserFields().length&&this.addFieldsToCmp(this.down("#userScopedSettingsForm"),this.getUserFields())},_isGlobalSettingsField:function(fieldConfig){return _.contains(this.self.GLOBAL_SETTINGS,fieldConfig.name)||_.contains(this.self.GLOBAL_SETTINGS,fieldConfig.type)},_drawField:function(form,fieldConfig){var field=this._createFieldFromConfig(fieldConfig);this._applyScopeToField(field),this._addFieldToForm(form,field,fieldConfig)},_getValueForField:function(field,fieldName,settings){var value;return field.mapsToMultiplePreferenceKeys?(value={},Ext.each(field.mapsToMultiplePreferenceKeys,function(name){value[name]=settings[name]})):value=settings[fieldName],value},_createFieldFromConfig:function(fieldConfig){if(fieldConfig.storeConfig&&fieldConfig.storeConfig.autoLoad)throw"Field Config for App Settings components should not auto load the store. Store will be loaded from the App Settings panel after init.";var field=Ext.apply({},Rally.app.SettingsFactory.getEditorConfig(fieldConfig.type)||fieldConfig),fieldName=fieldConfig.name||fieldConfig.type,fieldValue=this._getValueForField(field,fieldName,this.settings)||fieldConfig.initialValue;return Ext.apply(field,fieldConfig.config),Ext.applyIf(field,{fieldLabel:fieldConfig.label||fieldConfig.name&&Ext.util.Format.capitalize(fieldConfig.name)||fieldConfig.type&&Ext.util.Format.capitalize(fieldConfig.type),name:fieldName,labelWidth:75,labelSeparator:"",value:fieldValue}),field},_addFieldToForm:function(form,field,fieldConfig){var fieldCmp=form.add(field);return fieldCmp.addCls(Rally.util.Test.toBrowserTestCssClass("settings-"+fieldConfig.type)),this._handleReady(fieldCmp),this._connectFieldEventHandlers(fieldCmp),fieldCmp.getStore&&fieldCmp.getStore()&&fieldCmp.getStore().load(),fieldCmp},_handleReady:function(field){field.readyEvent&&(this.isReady[field.getId()]=!1,field.on(field.readyEvent,function(){this._markReady(field.getId())},this))},_markReady:function(id){this.isReady[id]=!0,this._fireReady()},_fireReady:function(){var fireReady=!0;Ext.Object.each(this.isReady,function(fieldId){fireReady=fireReady&&this.isReady[fieldId]},this),fireReady&&this._onAppSettingsReady()},afterRender:function(){this.callParent(arguments),this._fireReady()},_onAppSettingsReady:function(){this.rendered&&this.isReady.canInvoke&&(!this.isEditable&&Ext.isEmpty(this.getUserFields())||this._drawSaveAndCancelButtons(),this.isEditable||this._maskSettings(),this.fireEvent("appsettingsready",this),this.isReady.canInvoke=!1)},_connectFieldEventHandlers:function(field){field.handlesEvents&&Ext.Object.each(field.handlesEvents,function(event,handler){this.on(event,handler,field)},this)},_applyScopeToField:function(field){field.context=this._getCurrentContext(),field.storeConfig&&(field.storeConfig.context?Ext.applyIf(field.storeConfig.context,{project:this._getCurrentProjectScope()}):Ext.applyIf(field.storeConfig,{context:{project:this._getCurrentProjectScope()}}))},_getCurrentContext:function(){var currentContext=null;return currentContext=Ext.isFunction(this.getContext().clone)?this.getContext().clone():Ext.clone(this.getContext()),null!==this._currentScope&&(this._currentScope?(currentContext.put("project",this._currentScope.raw),currentContext.put("workspace",this._currentScope.raw.Workspace)):(currentContext.put("project",Rally.environment.getContext().getProject()),currentContext.put("workspace",Rally.environment.getContext().getWorkspace()))),currentContext},_getCurrentProjectScope:function(){return Rally.util.Ref.getRelativeUri(this._getCurrentContext().getProject())},_getCurrentWorkspaceScope:function(){return Rally.util.Ref.getRelativeUri(this._getCurrentContext().getWorkspace())},_onSaveSuccess:function(records){this.fireEvent("save",this.settings,records)},save:function(){_.every(this.query("form"),function(form){return form.getForm().isValid()})&&(this._shouldApplyDefaults()?Ext.create("Rally.ui.dialog.ConfirmDialog",{confirmLabel:"OK",listeners:{confirm:this._saveScopedSettings,scope:this},message:"You are about to apply settings at the Workspace level. These settings will become the default for this app. Existing Project-level settings will be preserved. "+Rally.util.Help.getLinkTag({id:276,text:"more info"})}):this._saveScopedSettings())},cancel:function(){this.hasChanges()?this.confirmDialog=Ext.create("Rally.ui.dialog.ConfirmDialog",{width:350,title:"Do you want to save your changes?",confirmLabel:"Save",cancelLabel:"Don't Save",listeners:{confirm:function(){this.save()},cancel:function(){this.fireEvent("cancel")},scope:this}}):this.fireEvent("cancel")},_saveScopedSettings:function(){var saveSettingsPromises=[],appScopedSettingsForm=this.getAppScopedSettingsForm();return appScopedSettingsForm&&!appScopedSettingsForm.isDisabled()&&Ext.Object.getSize(appScopedSettingsForm.getValues())&&saveSettingsPromises.push(this._saveAppGlobalScopedSettings()),Ext.isEmpty(this._getScopedSettingsFields())||saveSettingsPromises.push(this._saveAppProjectScopedSettings()),Ext.isEmpty(this.getUserFields())||saveSettingsPromises.push(this._saveUserScopedSettings()),Deft.Promise.all(saveSettingsPromises).then({success:function(recordSets){var records=_.uniq(_.reduce(recordSets,function(result,recordSet){return result.concat(recordSet)},[]));return this._onSaveSuccess(records),records},scope:this})},_saveSettings:function(options){return this.getContext()&&this.getContext().get("appID")?Rally.data.PreferenceManager.update(options):Deft.Promise.when([])},_saveAppGlobalScopedSettings:function(){var globalAppSettings=this.getAppScopedSettingsForm().getValues();return Ext.apply(this.settings,globalAppSettings),this._saveSettings({appID:this.getContext()&&this.getContext().get("appID"),settings:globalAppSettings,project:null,workspace:null,scope:this})},_saveAppProjectScopedSettings:function(){var scopedSettings=this.down("#scopedSettingsForm").getValues();Ext.apply(this.settings,scopedSettings);var updateOptions={appID:this.getContext()&&this.getContext().get("appID"),settings:scopedSettings,scope:this};return"workspace"===this.settingsScope||this._shouldApplyDefaults()?updateOptions.workspace=this._getCurrentWorkspaceScope():"project"===this.settingsScope&&(updateOptions.project=this._getCurrentProjectScope()),this._saveSettings(updateOptions)},_saveUserScopedSettings:function(){var userSettings=this.getUserScopedSettingsForm().getValues();return Ext.apply(this.settings,userSettings),this._saveSettings({appID:this.getContext()&&this.getContext().get("appID"),settings:userSettings,filterByUser:!0,project:null,workspace:this._getCurrentWorkspaceScope(),scope:this})},getAppScopedSettingsForm:function(){return this.down("#settingsForm")},getUserScopedSettingsForm:function(){return this.down("#userScopedSettingsForm")},getApplyDefaultsCheckbox:function(){return this.down("#defaultSettingsCheckbox")},onDestroy:function(){this.callParent(arguments),this.confirmDialog&&(this.confirmDialog.destroy(),delete this.confirmDialog)},_shouldApplyDefaults:function(){return this.getApplyDefaultsCheckbox()&&this.getApplyDefaultsCheckbox().getValue()},hasChanges:function(){return!!this.isEditable&&_.some(this.query("form"),this._formHasChanges,this)},_formHasChanges:function(form){var hasChanges=!1;return Ext.Object.each(form.getValues(),function(name,value){var setting=new this._preferenceModel({Value:value});if(this.initialSettings[name]!==setting.get("Value"))return hasChanges=!0,!1},this),hasChanges},_drawSaveAndCancelButtons:function(){this.add({xtype:"container",padding:"6 0 0 0",height:35,layout:{type:"vbox",align:"center"},items:{xtype:"container",cls:"center",items:[{xtype:"rallybutton",text:"Save",cls:"save-button primary rly-small",listeners:{click:this.save,scope:this}},{xtype:"rallybutton",itemId:"cancelButton",text:"Cancel",cls:"secondary rly-small",ui:"link",hidden:this.hideCancelButton,listeners:{click:this.cancel,scope:this}}]}})},_getAllFormItems:function(){function getItems(cmp){return cmp.items&&cmp.items.items?cmp.items.items:cmp.items}var settingsForm=this.down("#settingsForm"),scopedSettingsForm=this.down("#scopedSettingsForm"),items=[];return settingsForm&&(items=items.concat(getItems(settingsForm))),scopedSettingsForm&&(items=items.concat(getItems(scopedSettingsForm))),items},_maskSettings:function(){var maskContainer=this.down("#nonUserScopedSettingsContainer");if(maskContainer){var mask=maskContainer.setLoading({useMsg:!1}),items=this._getAllFormItems();items.length&&this._sendPickersBehindCmp(mask,items)}},_sendPickersBehindCmp:function(cmp,items){var pickerRE=/picker$/,pickerFields=_.filter(items,function(field){return pickerRE.test(field.xtype)});_.each(pickerFields,function(pickerField){cmp.zIndexManager.sendToBack(pickerField.getPicker())})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.ModelTypes",{requires:[],singleton:!0,getTypeByModel:function(model){return this.getTypeByName(model.typePath)},getTypeByName:function(typePath){var spacelessType=typePath?typePath.replace(/\s/g,"").toLowerCase():"";return this.types[spacelessType]||spacelessType},isScopedByName:function(spacelessname){return _.contains(this.scopedTypes,this.getTypeByName(spacelessname))},isCompositeModel:function(model){return"artifact"===model.typePath||"portfolioitem"===model.typePath},isArtifact:function(type){var typePath=this._getTypePath(type);return this.isPortfolioItem(typePath)||_.contains(Rally.data.ModelTypes.artifactTypes,this.getTypeByName(typePath).toLowerCase())},areArtifacts:function(types){return _.any(types,function(type){return Rally.data.ModelTypes.isArtifact(type)},this)},isPortfolioItem:function(type){return!!this._getTypePath(type).match(/^portfolioitem/i)},_getTypePath:function(type){return(type.isModel?type.get("TypePath"):type)||""},artifactTypes:["defect","defectsuite","risk","task","testcase","testset","userstory","hierarchicalrequirement"],scopedTypes:["ScopedAttributeDefinition"],types2:{HierarchicalRequirement:["userstory","hierarchicalrequirement"]},types:{administratableproject:"AdministratableProject",allowedattributevalue:"AllowedAttributeValue",allowedqueryoperator:"AllowedQueryOperator",artifactnotification:"ArtifactNotification",artifact:"Artifact",attachment:"Attachment",attachmentcontent:"AttachmentContent",attributeconfiguration:"AttributeConfiguration",attributedefinition:"AttributeDefinition",blocker:"Blocker",build:"Build",builddefinition:"BuildDefinition",buildmetric:"BuildMetric",buildmetricdefinition:"BuildMetricDefinition",change:"Change",changeset:"Changeset",conversationpost:"ConversationPost",defect:"Defect",defectsuite:"DefectSuite",deliverygroup:"DeliveryGroup",expertise:"Expertise",expertisecapacity:"ExpertiseCapacity",expertisedemand:"ExpertiseDemand",hierarchicalrequirement:"HierarchicalRequirement",iteration:"Iteration",iterationcumulativeflowdata:"IterationCumulativeFlowData",milestone:"Milestone",portfolioitem:"PortfolioItem",preference:"Preference",preliminaryestimate:"PreliminaryEstimate",program:"Program",project:"Project",projectpermission:"ProjectPermission",recyclebinentry:"RecycleBinEntry",release:"Release",releasecumulativeflowdata:"ReleaseCumulativeFlowData",revision:"Revision",revisionhistory:"RevisionHistory",risk:"Risk",scopedattributedefinition:"ScopedAttributeDefinition",scmrepository:"SCMRepository",state:"State",subscription:"Subscription",subscriptionUser:"SubscriptionUser",tag:"Tag",task:"Task",testcase:"TestCase",testcaseresult:"TestCaseResult",testcasestep:"TestCaseStep",testfolder:"TestFolder",testset:"TestSet",timeentryitem:"TimeEntryItem",timeentryvalue:"TimeEntryValue",type:"Type",typedefinition:"TypeDefinition",user:"User",userstory:"HierarchicalRequirement",useriterationcapacity:"UserIterationCapacity",userpermission:"UserPermission",userprofile:"UserProfile",weblinkdefinition:"WebLinkDefinition",writableProject:"WritableProject",workspace:"Workspace",workspaceconfiguration:"WorkspaceConfiguration",workspacepermission:"WorkspacePermission",workspaceuser:"WorkspaceUser"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.TypeDefinitionMetaData",{config:{requested:void 0,context:void 0,wsapiVersion:void 0},constructor:function(config){this.initConfig(config),this.callParent(arguments)},getFullyQualifiedName:function(){var context=this.getContext();return context.project?oidStr="project."+Rally.util.Ref.getOidFromRef(context.project):oidStr="workspace."+Rally.util.Ref.getOidFromRef(context.workspace),"Rally.domain."+this.getWsapiVersion()+"."+oidStr+"."+this.getTypePath().replace(/\//g,"")},getTypePath:function(){return Rally.data.ModelTypes.getTypeByName(this.getRequested())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.ModelBuilder",{alternateClassName:["Rally.domain.WsapiModelBuilder"],singleton:!0,build:function(typeDefMetaData,typeDefinition){var attributes=typeDefinition.Attributes,commonWsapiFields=_.map(Rally.data.FieldFactory.getCommonWsapiFields().concat(Rally.data.FieldFactory.getVirtualWsapiFields(typeDefinition)),this._createWsapiField),fields=commonWsapiFields.concat(Rally.data.FieldFactory.buildFieldsFromTypeDefinitionAttributes(attributes)),validations=Rally.data.FieldFactory.buildValidationsFromTypeDefinitionAttributes(attributes),typePath=typeDefinition.TypePath,metadataTypePath=typeDefMetaData.getTypePath().toLowerCase();return _.each(fields,function(field){field.modelType=typePath.toLowerCase()}),Ext.define(typeDefMetaData.getFullyQualifiedName(),{extend:"Rally.data.wsapi.Model",fields:fields,validations:validations,statics:{typeName:metadataTypePath,prettyTypeName:"hierarchicalrequirement"===metadataTypePath?"userstory":metadataTypePath,typePath:typePath.toLowerCase(),displayName:typeDefinition.DisplayName,parentTypeName:typeDefinition.Parent&&typeDefinition.Parent._refObjectName,elementName:typeDefinition.ElementName,ordinal:typeDefinition.Ordinal,context:typeDefMetaData.context,restorable:typeDefinition.Restorable,wsapiVersion:typeDefMetaData.wsapiVersion,typeDefOid:typeDefinition.ObjectID,typeDefName:typeDefinition.Name,idPrefix:typeDefinition.IDPrefix,typeDefinition:typeDefinition},proxy:Rally.data.wsapi.ModelFactory.buildProxy(Rally.data.wsapi.ModelFactory.buildProxyUrl(typePath,typeDefMetaData.wsapiVersion),typeDefinition.ElementName,null,typeDefMetaData.wsapiVersion)})},buildCompositeArtifact:function(models,context,wsapiVersion){var typePath="artifact",displayName="Artifact",typeDefMetaData=Ext.create("Rally.data.TypeDefinitionMetaData",{requested:typePath,context:context,wsapiVersion:wsapiVersion}),typeDefinition={Attributes:this._getAttributeDefinitionsFromModels(models),TypePath:typePath,DisplayName:displayName,Parent:null,ElementName:displayName,Restorable:!1},model=this.build(typeDefMetaData,typeDefinition);model.getArtifactComponentModels=function(){return models},model.getModelsForField=function(field){return _.transform(this.getArtifactComponentModels(),function(matchingModels,model){_.find(model.getFields(),{name:field.name})&&matchingModels.push(model)},[])};var modelsByType=_.indexBy(model.getArtifactComponentModels(),"typeName");return model.getArtifactComponentModel=function(type){var canonicalType=type.toLowerCase();return modelsByType[canonicalType]},model},_getAttributeDefinitionsFromModels:function(models){var attrDefs={};return _.each(models,function(model){_.each(model.getFields(),function(field){var attrDef=field.attributeDefinition;attrDef&&(attrDefs[attrDef.ElementName]?attrDefs[attrDef.ElementName].Hidden=attrDefs[attrDef.ElementName].Hidden&&attrDef.Hidden:attrDefs[attrDef.ElementName]=attrDef)});var typeMappings=model.getArtifactMappings();typeMappings&&_.each(typeMappings,function(value,key){this._addArtifactFieldToModel(model,key,value)},this)},this),_.sortBy(_.values(attrDefs),"DisplayName")},_createWsapiField:function(config){return Ext.create("Rally.data.wsapi.Field",config)},_addArtifactFieldToModel:function(model,field,newFieldName){var clonedField=Rally.data.FieldFactory.buildFieldFromAttributeDefinition(model.getField(field).attributeDefinition,field);clonedField.name=newFieldName,clonedField.defaultValue=null,clonedField.convert=function(value,record){return _.isUndefined(value)||_.isNull(value)&&record.raw?record.raw[field]:value},clonedField.isMappedFromArtifact=!0,model.prototype.fields.add(clonedField)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.artifact.Store",{extend:Rally.data.wsapi.Store,alternateClassName:["Rally.data.WsapiArtifactStore"],alias:["store.rallywsapiartifactstore"],models:[],constructor:function(config){config=config||{},config.model=config.model||"artifact",this.callParent([config]),this._initModel()},load:function(options){return options=options||{},this.loading=!0,Ext.isFunction(this.model)&&"artifact"===this.model.typeName?(this._addModelFilterToOptions(options),this.callParent([options])):this._loadModels().then(Ext.bind(this._loadData,this,[options],!0))},reloadRecord:function(record,options){return this.callParent([record,Ext.merge({params:{types:this._getModelTypes()}},options)])},_loadModels:function(){return Ext.isEmpty(this.models)&&Ext.Error.raise('load requires "models" to be defined'),Rally.data.ModelFactory.getModels({types:this.models,requester:this.requester})},_loadData:function(models,options){return this._configureModel(models),this.load(options)},_initModel:function(){!Ext.isEmpty(this.models)&&_.all(this.models,Ext.isFunction)&&this._configureModel(this.models)},_configureModel:function(models){this._validateModels(models),this.model=this._getArtifactModel(models),this.proxy=this.model.getProxy()},_validateModels:function(models){for(var modelName in models)models.hasOwnProperty(modelName)&&(models[modelName].getField("FormattedID")||Ext.Error.raise('"'+modelName+'" is not an artifact'))},_getArtifactModel:function(models){var context=this.context||Rally.environment.getContext(),wsapiVersion=Rally.environment.getServer().getWsapiVersion(this.wsapiVersion);return Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(models,context,wsapiVersion)},_addModelFilterToOptions:function(options){options.params=Ext.merge({},options.params),options.params.types=this._getModelTypes()},_getModelTypes:function(){return _.pluck(this.model.getArtifactComponentModels(),"typePath").join(",")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.DataStoreBuilder",{build:function(config){return this.loadModels(config).then({success:function(models){return models=_.values(models),this._buildStoreWithModels(models,config)},scope:this})},loadModels:function(config){var models=this._getModelConfig(config),hasModelNames=_.any(models,_.isString);if(models.length<1)throw new Error("Cannot configure store with no models defined");return hasModelNames?Rally.data.ModelFactory.getModels({context:config.context,types:this._getModelNames(models),requester:config.requester||this}).then({success:this._getModelsByTypePath,scope:this}):Deft.Promise.when(models)},_getModelConfig:function(config){var modelConfigs=[config.model,config.models],modelConfig=_.find(modelConfigs,function(modelConfig){return!_.isEmpty(modelConfig)})||[];return Ext.Array.from(modelConfig)},_getModelNames:function(models){return _.map(models,function(model){return _.isString(model)?model:model.typeName})},_loadModels:function(config){var models=this._getModelConfig(config),hasModelNames=_.any(models,_.isString);if(models.length<1)throw new Error("Cannot configure store with no models defined");return hasModelNames?Rally.data.ModelFactory.getModels({context:config.context,types:this._getModelNames(models)}):Deft.Promise.when(models)},_buildStoreWithModels:function(models,config){var storeType;return config=Ext.merge({},config),this._useCompositeArtifacts(models,config)?(storeType=config.storeType||"Rally.data.wsapi.artifact.Store",config.model=this._getArtifactModel(models,config),config.models=models):(storeType=config.storeType||"Rally.data.wsapi.Store",config.model=models[0],delete config.models),Ext.create(storeType,config)},_useCompositeArtifacts:function(models,config){return config.useCompositeArtifacts||models.length>1},_getArtifactModel:function(models,config){var context=config.context||Rally.environment.getContext(),wsapiVersion=Rally.environment.getServer().getWsapiVersion(config.wsapiVersion);return Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(models,context,wsapiVersion)},_getModelsByTypePath:function(models){return _.transform(_.values(models),function(result,model){result[model.typePath]=model},{})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.SelectedGroupable",{extend:Ext.AbstractPlugin,alias:"plugin.rallypickerselectedgroupable",selectedTextLabel:"Selected",availableTextLabel:"Available",groupName:"groupSelected",init:function(cmp){this.callParent(arguments),this.cmp=cmp,cmp._groupRecords=this.groupRecords,cmp._groupSelectedRecords=this.groupSelectedRecords,cmp._cleanUpStore=this._cleanUpStore,cmp._removeItemFromMixedCollection=this._removeItemFromMixedCollection,cmp.selectedTextLabel=this.selectedTextLabel,cmp.availableTextLabel=this.availableTextLabel,cmp.groupName=this.groupName,cmp.on("expand",this._onFirstExpand,this,{single:!0}),cmp.on("blur",this._onBlur,this)},groupRecords:function(selectedRecords){var selectedText=this.selectedTextLabel,availableText=this.availableTextLabel,attr=this.groupName,store=this.store;store.suspendEvents(!1),store.each(function(record){record.set(attr,availableText)}),Ext.each(selectedRecords,function(record){record.set(attr,selectedText)}),store.resumeEvents(),store.group([{property:attr,direction:"DESC"}]),this._cleanUpStore()},groupSelectedRecords:function(){this._groupRecords(this.selectedValues.getRange())},_cleanUpStore:function(){this._removeItemFromMixedCollection(this.store.sorters,this.groupName),this._removeItemFromMixedCollection(this.store.groupers,this.groupName)},_removeItemFromMixedCollection:function(collection,property){var item=collection.findBy(function(sorter){return sorter.property===property});item&&collection.remove(item)},_groupRecordsAndScroll:function(selectedRecords){this._doWithMaintainedScrollPosition(function(){this._groupRecords(selectedRecords)})},_onFirstExpand:function(){var cmp=this.cmp;cmp.store&&cmp.mon(cmp.store,"filterbytextinput",this._onFilter,this)},_onBlur:function(){this.cmp._groupSelectedRecords()},_onFilter:function(){this.cmp._groupSelectedRecords()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.plugin.Filtering",{extend:Ext.AbstractPlugin,alias:"plugin.rallyfiltering",inheritableStatics:{buildRegex:function(filterText){var regexChars=/([\\\{\}\[\]\^\$\.\*\+\?\|\(\)])/g,escapedText=filterText.replace(regexChars,"\\$1");return new RegExp("("+escapedText+")","ig")}},init:function(){this.callParent(arguments),this.cmp.on("blur",this._onBlur,this)},updateMatchedText:function(filterText){var store=this.cmp.store,displayFieldName=this.cmp.matchFieldName;Ext.isEmpty(filterText)?this.resetMatchedText():store.each(function(record){record.set(displayFieldName,record.get(this.cmp.filterFieldName)),record.set(displayFieldName,record.get(displayFieldName).replace(this.self.buildRegex(filterText),'<span class="rui-multi-object-match">$1</span>'))},this)},resetMatchedText:function(){this.cmp.store.each(function(record){record.set(this.cmp.matchFieldName,record.get(this.cmp.filterFieldName))},this)},_onBlur:function(){var cmp=this.cmp;cmp.store&&!cmp.store.remoteFilter&&cmp.store.clearFilter()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.plugin.ClientFiltering",{extend:Rally.ui.picker.plugin.Filtering,alias:"plugin.rallyclientfiltering",init:function(){this.callParent(arguments),this.cmp.on("afterrender",this._onAfterRender,this),this.cmp.on("expand",this._onExpand,this)},_onAfterRender:function(){this.cmp.on("inputtextchanged",this._onInputTextChanged,this)},_onInputTextChanged:function(filterText){var store=this.cmp.store;store&&(store.suspendEvents(!1),store.filterBy(this._buildFilter(filterText),this),this.updateMatchedText(filterText),store.resumeEvents(),store.fireEvent("refresh"),store.fireEvent("filterbytextinput"))},_buildFilter:function(filterText){var me=this,baseFilter=me.cmp.getBaseFilter();return function(record){var textInputMatches=me.self.buildRegex(filterText).test(record.get(me.cmp.filterFieldName));return baseFilter?textInputMatches&&baseFilter.filterFn(record):textInputMatches}},_onExpand:function(){var cmp=this.cmp,store=cmp.store;if(store){var sorters=cmp.sorters||store.sorters||Ext.create("Ext.util.MixedCollection");(sorters.getCount()<1||!sorters.get(0).hasOwnProperty("alwaysSelectedFirst"))&&sorters.insert(0,Ext.create("Ext.util.Sorter",{sorterFn:Ext.bind(this._sortAlwaysSelectedFirst,this),alwaysSelectedFirst:!0})),store.sorters=sorters,cmp.refresh().then({success:function(){cmp.getInputTextValue()===cmp.getRawValue()?cmp.focusPlaceholderText():this.updateMatchedText(cmp.getInputTextValue())},scope:this})}},_sortAlwaysSelectedFirst:function(record1,record2){var isRecord1AlwaysSelected=this.cmp.isRecordAlwaysSelected(record1),isRecord2AlwaysSelected=this.cmp.isRecordAlwaysSelected(record2);return isRecord1AlwaysSelected&&!isRecord2AlwaysSelected?-1:isRecord2AlwaysSelected&&!isRecord1AlwaysSelected?1:0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.list.PagingToolbar",{extend:Ext.toolbar.Toolbar,alias:"widget.rallylistpagingtoolbar",mixins:{bindable:Ext.util.Bindable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},cls:"rally-list-paging-toolbar",emptyMsg:"No Tags",prevText:"Previous Page",nextText:"Next Page",defaultButtonUI:"default",initComponent:function(){this.items=this.getPagingItems(),this.callParent(arguments)},layout:{type:"hbox",align:"middle"},getPagingItems:function(){return[{xtype:"tbfill"},{itemId:"prev",border:!1,disabled:!0,scale:"medium",iconCls:"icon-chevron-left",overflowText:this.prevText,tooltip:this.prevText,handler:this.movePrevious,scope:this},{xtype:"tbtext",itemId:"toolbarText"},{itemId:"next",border:!1,disabled:!0,scale:"medium",iconCls:"icon-chevron-right",overflowText:this.nextText,tooltip:this.nextText,handler:this.moveNext,scope:this}]},movePrevious:function(){var store=this.store,prev=store.currentPage-1;return this.recordAction({description:"previous page button clicked"}),prev>0&&this.fireEvent("beforechange",this,prev)!==!1&&(store.previousPage(),!0)},moveNext:function(){var store=this.store,total=this.getPageData().pageCount,next=store.currentPage+1;return this.recordAction({description:"next page button clicked"}),next<=total&&this.fireEvent("beforechange",this,next)!==!1&&(store.nextPage(),!0)},updateInfo:function(){var msg,pageData=this.getPageData();msg=0===this.store.getCount()?this.emptyMsg:Ext.String.format("{0} - {1} of {2}",pageData.fromRecord,pageData.toRecord,pageData.total),this.down("#toolbarText").setText(msg)},onLoad:function(){var isEmpty=0===this.store.getCount(),pageData=this.getPageData();if(isEmpty)currPage=0,pageCount=0;else if(currPage=pageData.currentPage,pageCount=pageData.pageCount,currPage>pageCount)return void this.store.loadPage(pageCount);Ext.suspendLayouts(),this.setChildDisabled("#prev",1===currPage||isEmpty),this.setChildDisabled("#next",currPage===pageCount||isEmpty),this.updateInfo(),Ext.resumeLayouts(!0)},setChildDisabled:function(selector,disabled){var item=this.child(selector);item&&item.setDisabled(disabled)},getPageData:function(){var store=this.store,totalCount=store.getTotalCount();return{total:totalCount,currentPage:store.currentPage,pageCount:Math.ceil(totalCount/store.pageSize),fromRecord:(store.currentPage-1)*store.pageSize+1,toRecord:Math.min(store.currentPage*store.pageSize,totalCount)}},getStoreListeners:function(store){return{load:this.onLoad,datachanged:this.updateInfo}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.plugin.RemoteFiltering",{extend:Rally.ui.picker.plugin.Filtering,alias:"plugin.rallyremotefiltering",pageSize:10,init:function(){this.callParent(arguments),this.cmp.listCfg||Ext.Error.raise("No listCfg defined"),this.cmp.listCfg.pageSize=this.pageSize,this.cmp.listCfg.createPagingToolbar=Ext.bind(this._createPagingToolbar,this),this.cmp.on("afterrender",this._onAfterRender,this),this.cmp.on("expand",this._onFirstExpand,this,{single:!0})},_onAfterRender:function(){this.cmp.on("inputtextchanged",this._onInputTextChanged,this)},_onFirstExpand:function(){this._setupStore(),this.cmp.on("load",function(){this.updateMatchedText(this.cmp.getInputTextValue()),this.cmp.getList().refresh()},this)},_setupStore:function(){this.cmp.store.remoteFilter=!0,this.cmp.store.remoteSort=!0,this.cmp.relayEvents(this.cmp.store,["load"])},_onInputTextChanged:function(filterText){var doFilter=!Ext.isEmpty(filterText),store=this.cmp.store;if(doFilter){store.filters&&store.filters.clear();var nameContainsFilter=Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"contains",value:filterText});store.filter(this.cmp.getBaseFilter()?this.cmp.getBaseFilter().and(nameContainsFilter):nameContainsFilter)}else this.resetMatchedText();store.fireEvent("filterbytextinput")},_createPagingToolbar:function(){return Ext.widget("rallylistpagingtoolbar",{pageSize:this.pageSize,store:this.cmp.store,border:!1,ownerCt:this.cmp,ownerLayout:this.cmp.getComponentLayout(),layout:{align:"middle"}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Event",{singleton:!0,isModifierKey:function(event){return!!(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)||!!event.browserEvent&&(event.browserEvent.keyIdentifier&&_.contains(["Shift","Alt","Control","Meta"],event.browserEvent.keyIdentifier))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.MultiObjectPicker",{extend:Ext.form.field.Picker,alias:"widget.rallymultiobjectpicker",clientMetrics:[{beginMethod:"expand",endMethod:"refreshView",description:"object picker loaded"},{method:"_onListItemClick",description:"list item clicked"}],inheritableStatics:{defaultRowTextCls:"rui-picker-option-text"},componentCls:"rui-multiobject-picker",config:{autoExpand:!1,alwaysExpanded:!1,loadingText:"Loading...",selectionKey:"_ref",recordKey:"ObjectID",storeConfig:{autoLoad:!1,fetch:"Name",pageSize:200,remoteGroup:!1,remoteSort:!1,remoteFilter:!1,limit:1/0,sorters:[{property:"Name",direction:"ASC"}]},storeLoadOptions:void 0,pickerType:"Ext.container.Container",pickerCfg:{floating:!0,
hidden:!0,focusOnToFront:!1,shadow:!1,layout:{type:"vbox",align:"stretch",shrinkToFit:!0},cls:"multiobject-picker"},listType:"Ext.view.BoundList",listCfg:{selModel:{mode:"SIMPLE"},displayField:"Name",pageSize:0,autoScroll:!0,cls:"rui-multi-object-list"},rowSelectable:!1,rowCheckboxCls:"rui-picker-checkbox",msgTarget:"side",rowCls:"rui-multi-object-picker",disabledRowCls:"rui-multi-object-picker-disabled",maintainScrollPosition:!1,alwaysSelectedValues:[],allowNoEntry:!1,noEntryText:"-- No Entry --",emptyText:"Begin typing...",notFoundText:'<div class="rui-multi-object-picker-empty-text">No matching item</div>',matchFieldName:"matchedText",filterFieldName:"Name",enableGrouping:!0,remoteFilter:!1,showCloseButton:!1,showSearchIcon:!1},constructor:function(config){this.mergeConfig(config),this.plugins=this.plugins||[],this.remoteFilter?this.plugins.push({ptype:"rallyremotefiltering"}):this.plugins.push({ptype:"rallyclientfiltering"}),this.enableGrouping&&this.plugins.push(this._getSelectedGroupableConfig()),this.selectedValues=Ext.create("Ext.util.MixedCollection"),this.alwaysExpanded&&!Ext.isDefined(this.config.hideTrigger)&&(this.hideTrigger=!0),this.callParent([this.config])},initComponent:function(){this.addEvents("afteralignpicker","select","deselect","selectionchange","datachanged"),this.callParent(arguments)},initEvents:function(){this.callParent(arguments),this.on("afterrender",this._onAfterRender,this,{single:!0}),this.on("afteralignpicker",this._selectCheckboxes,this),this.on("expand",this._onInitialExpand,this,{single:!0}),this._initInputEvents(),this._autoExpand()},setValue:function(values){var items=Ext.isString(values)?values.split(","):Ext.Array.from(values);items=Ext.Array.merge(items,this.alwaysSelectedValues),!Ext.isEmpty(items)&&this.store&&this.store.isLoading()?this.store.on("load",function(){this._selectValues(items)},this,{single:!0}):this._selectValues(items)},_selectValues:function(items){var oldValue=this.selectedValues.getRange();this.selectedValues.clear(),_.each(items,function(item){var value=item&&item.isModel?item.get(this.selectionKey):item,record=this.findInStore(value);record?this.selectedValues.add(this._getKey(record),record):item.isModel&&this.selectedValues.add(value,item)},this),this.isExpanded&&(this._onListRefresh(),this._groupSelectedRecords()),this.fireEvent("change",this,this.selectedValues.getRange(),oldValue)},getValue:function(){return this._getRecordValue()},getSubmitData:function(){var ret={};return ret[this.name]=this.getSubmitValue(),ret},getSubmitValue:function(){var submitValue=[];return this.selectedValues.eachKey(function(key,value){value.get(this.selectionKey)&&submitValue.push(value.get(this.selectionKey))},this),submitValue},createPicker:function(){return this.picker=Ext.create(this.pickerType,this.pickerCfg),this.picker.add(this._createList()),this.alwaysExpanded&&this.picker.on("beforehide",this._onBeforeHide),this.picker},_onBeforeHide:function(){return!1},setAlwaysExpanded:function(alwaysExpanded){alwaysExpanded?(this.alwaysExpanded=!0,this.picker.on("beforehide",this._onBeforeHide)):(this.alwaysExpanded=!1,this.picker.removeListener("beforehide",this._onBeforeHide))},alignPicker:function(){var heightAbove=this.getPosition()[1]-Ext.getBody().getScroll().top,heightBelow=Ext.Element.getViewHeight()-heightAbove-this.getHeight(),space=Math.max(heightAbove,heightBelow)-5;this._alignPickerAndList(),this.pickerCfg.height?(this.picker.setHeight(this.pickerCfg.height),this.list.setHeight(this.pickerCfg.height)):this._getListHeight()>space?(this.list.setHeight(space),this.picker.setHeight(space)):this._getListHeight()<space&&(this.list.setHeight(null),this.picker.setHeight(null)),Ext.isIE&&!this.hasDeferedAlign&&(this.hasDeferedAlign=!0,Ext.defer(function(){this.picker.isVisible()&&this.alignPicker(),delete this.hasDeferedAlign},1,this)),this.fireEvent("afteralignpicker")},_getListHeight:function(){return this.list.listEl.child("ul").getHeight()},doAlign:function(){var visibility=this.picker.el.getStyle("visibility");this.callParent(arguments),this.picker.el.setStyle({visibility:visibility})},_alignPickerAndList:function(){if(this.isExpanded){if(this.matchFieldWidth){var labelWidth=0;this.fieldLabel&&"top"!==this.labelAlign&&(labelWidth=this.labelWidth+5),this.list.setSize(this.getWidth()-labelWidth,null),this.picker.setSize(this.getWidth()-labelWidth,this._getPickerHeight())}this.picker.isFloating()&&this.doAlign()}},expand:function(){this.store?this.callParent(arguments):this._createStoreAndExpand()},collapseIf:function(){},collapse:function(){this.alwaysExpanded||this.callParent(arguments)},validateBlur:function(e){var el=Ext.get(e.target);return!this.isDestroyed&&!(el.hasCls(this.rowCls)||el.hasCls(this.self.defaultRowTextCls)||el.hasCls(this.rowCheckboxCls))},refresh:function(){return this._refreshStore().then({success:this.refreshView,scope:this})},refreshView:function(){this._initFiltering(),this._groupRecords(this._getRecordValue()),this.originalValue&&this.setValue(this.originalValue),this.list&&this.list.refresh()},isRecordAlwaysSelected:function(record){return _.contains(this.alwaysSelectedValues,record.get(this.selectionKey))},_initFiltering:function(){this._setMatchedFieldValues()},_setMatchedFieldValues:function(){this.store.each(function(record){record.set(this.matchFieldName,record.get(this.filterFieldName))},this)},select:function(record){var key=record.get(this.selectionKey);this.selectedValues.add(key,record),this._syncSelection()},syncSelectionText:function(){var text=_.map(this.selectedValues.getRange(),function(record){return record.get(this.filterFieldName)},this).join(", ");Ext.isEmpty(text)?this.focusPlaceholderText():this.setValueText(text)},resetFilters:function(suppressEvent){this.store.clearFilter(suppressEvent),this.store.filter(this.getBaseFilter())},getBaseFilter:Ext.emptyFn,onEditorEnter:function(){this.resetFilters(!0)},onRender:function(){if(this.callParent(arguments),this.hideTrigger||this.inputEl.addCls("rui-multi-object-picker-no-trigger"),this.showSearchIcon){var searchIconNode=this.inputEl.insertHtml("afterEnd",'<div class="icon-search rally-search-button"></div>');Ext.get(searchIconNode).on("click",function(){this.focus()},this)}},addRecord:function(record){var deferred=Ext.create("Deft.Deferred");return this.mon(this.list,"refresh",function(){deferred.resolve(record)},this,{single:!0}),this.store.loadData([record],!0),deferred.promise},_initInputEvents:function(){return this.rendered?(this.mon(this.inputEl,"keydown",this._onInputKeyDown,this),this.mon(this.inputEl,"keyup",this.validate,this),void this.mon(this.inputEl,"keyup",this._onInputKeyUp,this)):void this.on("afterrender",this._initInputEvents,this,{single:!0})},_onAfterRender:function(){this.getInputEl().addCls("rui-multi-object-input"),this.getEl().on("click",this.expand,this)},_onInputKeyUp:function(event){this._setAppropriateEmptyText(),!event.shiftKey&&Rally.util.Event.isModifierKey(event)||this.fireEvent("inputtextchanged",this.getInputTextValue())},_onInputKeyDown:function(event,inputField){event.isSpecialKey()||event.ctrlKey||this.isExpanded||this.expand()},_setAppropriateEmptyText:function(){var list=this.getList(),listCfg=this.listCfg;list&&listCfg&&listCfg.emptyText&&(Ext.isEmpty(this.getInputTextValue())?list.emptyText=listCfg.emptyText:list.emptyText=this.notFoundText)},_autoExpand:function(){return this.rendered?void((this.alwaysExpanded||this.autoExpand)&&this.expand()):void this.on("afterrender",this._autoExpand,this,{single:!0})},_onInitialExpand:function(field){field.inputEl&&field.mon(field.inputEl,"click",function(){var picker=field.getPicker();picker&&picker.zIndexManager.bringToFront(picker)}),this.list.getEl().on("click",this.triggerBlur,this,{delegate:".rui-multi-object-picker-close-button"}),this.list.on("refresh",function(){var closeButton=this.list.listEl.down(".rui-multi-object-picker-close-button");if(closeButton){var scrollBarVisible=this.list.listEl.dom.scrollHeight>this.list.listEl.dom.clientHeight;closeButton.setStyle("padding-right",(scrollBarVisible?Ext.getScrollbarSize().width:0)+"px")}},this)},createStore:function(){var storeBuilder=Ext.create("Rally.data.DataStoreBuilder"),storeConfig=Ext.merge({model:this.modelType,requester:this},this.storeConfig);return storeBuilder.build(storeConfig).then({success:function(store){this.store=store,this.relayEvents(this.store,["datachanged"])},scope:this})},_createStoreAndExpand:function(){this.createStore().then({success:this.expand,scope:this})},_getRecordValue:function(){var recordArray=[];return this.selectedValues.eachKey(function(key,value){var record=this.findInStore(value.get(this.selectionKey));record?recordArray.push(record):recordArray.push(value)},this),recordArray},_createList:function(){var listCfg=Ext.apply({store:this.store,tpl:this._getListTpl()},this.listCfg);return this.list=Ext.create(this.listType,listCfg),this.mon(this.list,{refresh:this._onListRefresh,itemclick:this._onListItemClick,scope:this}),this.list},_onStoreLoaded:function(){if(this.allowNoEntry){var noEntryExists=this.store.count()>0&&this.store.findRecord(this.listCfg.displayField,this.noEntryText);if(!noEntryExists){var record=Ext.create(this.store.model);record.set(this.listCfg.displayField,this.noEntryText),record.set(this.selectionKey,null),record.set(this.recordKey,0),this.store.insert(0,record)}}this.resetFilters()},_selectCheckboxes:function(){this.list&&this.list.getSelectionModel()&&Ext.each(this.list.getSelectionModel().getSelection(),function(record){this._selectRowCheckbox(record.get(this.recordKey))},this)},_refreshStore:function(){var loadPromise;return this.store?(this.resetFilters(),this.store.clearGrouping(),this.store.requester=this,loadPromise=this.store.getCount()<1?this.store.load(this.storeLoadOptions):Deft.Promise.when(this.store.data)):loadPromise=this.createStore().then({success:function(){return this.store.load(this.storeLoadOptions)},scope:this}),loadPromise.then({success:this._onStoreLoaded,scope:this})},_getPickerHeight:function(){var totalHeight=0;return Ext.each(this.picker.items.getRange(),function(item){item.isVisible()&&(totalHeight+=item.getHeight())}),totalHeight},_syncSelection:function(){if(this.list){var selectionModel=this.list.getSelectionModel();selectionModel.deselectAll(!0);var selectedInList=Ext.Array.filter(this._getRecordValue(),this._isRecordInList,this);this._doWithMaintainedScrollPosition(function(){selectionModel.select(selectedInList,!1,!0)})}},_getOptionCheckbox:function(recordId){var checkboxSelector="li."+this.id+"."+this._getOptionClass(recordId)+" .rui-picker-checkbox";return Ext.get(Ext.DomQuery.selectNode(checkboxSelector))},_getOptionClass:function(recordId){return"rui-multi-object-picker-option-id-"+recordId.toString()},_selectRowCheckbox:function(recordId){var checkbox=this._getOptionCheckbox(recordId);checkbox&&checkbox.addCls("rui-picker-cb-checked")},_deselectRowCheckbox:function(recordId){this._getOptionCheckbox(recordId).removeCls("rui-picker-cb-checked")},_isRecordInList:function(record){return!!this.list.getNode(record)},_getListTpl:function(){var me=this;return Ext.create("Ext.XTemplate",'<tpl if="this.showCloseButton">','<div class="rui-multi-object-picker-close-button icon-cancel"></div>',"</tpl>",'<tpl exec="this.headerRendered = false"></tpl>',"<ul>",'<tpl for=".">','<tpl if="(!this.headerRendered) || (this.groupSelected !== values.groupSelected)">','<tpl exec="this.groupSelected = values.groupSelected"></tpl>','<tpl exec="this.headerRendered = true"></tpl>','<div class="rally-group-header multi-object-picker-header">',"{groupSelected}","</div>","</tpl>",'<li class="'+Ext.baseCSSPrefix+"boundlist-item "+this.rowCls+" {[this._getDisableClass(values)]} "+this.id+" rui-multi-object-picker-option-id-{"+this.recordKey+'}">','<div class="'+this.rowCheckboxCls+'" ></div>','<div class="{[this._getRowTextCls(values)]}">',"{[this._getMatchedText(values)]} {[this._getRightListHtml(values)]}","</div>","</li>","</tpl>","</ul>",{showCloseButton:this.showCloseButton,_getDisableClass:function(recordData){return Ext.Array.contains(me.alwaysSelectedValues,recordData[me.selectionKey])||!me.editable?me.disabledRowCls:""},_getRightListHtml:function(recordData){return me.getRightListHtml(recordData)},_getMatchedText:function(recordData){return me.getMatchedTextHtml(recordData)},_getRowTextCls:function(recordData){return me.getRowTextCls(recordData)}})},onListItemSelect:function(record,event,itemEl){this.select(record),this._selectRowCheckbox(record.get(this.recordKey)),this._groupRecordsAndScroll(this._getRecordValue()),this.fireEvent("select",this,record,this.getValue(),event),this._fireSelectionChange()},onListItemDeselect:function(record,event,itemEl){var key=this._getKey(record);this.selectedValues.remove(this.selectedValues.get(key)),this._syncSelection(),this._deselectRowCheckbox(record.get(this.recordKey)),this._groupRecordsAndScroll(this._getRecordValue()),this.fireEvent("deselect",this,record,this.getValue(),event),this._fireSelectionChange()},getMatchedTextHtml:function(recordData){return recordData[this.matchFieldName]},getRightListHtml:function(){return""},getRowTextCls:function(recordData){return this.self.defaultRowTextCls},_getKey:function(record){return record.get(this.selectionKey)||this.noEntryText},_fireSelectionChange:function(){this.fireEvent("selectionchange",this,this.getValue()),this.focus()},_onListItemClick:function(view,record,itemEl,index,event){if(this.isRecordAlwaysSelected(record)||!this.editable)return!1;var selModel=this.list.getSelectionModel();return selModel.isSelected(record)?this.onListItemDeselect(record,event,itemEl):this.onListItemSelect(record,event,itemEl),!1},_onListRefresh:function(){this._syncSelection(),this.alignPicker()},_groupRecordsAndScroll:function(selectedRecords){var scroll=0;this.maintainScrollPosition&&(scroll=this.list.listEl.getScroll()),this._groupRecords(selectedRecords),this.maintainScrollPosition&&Ext.Object.each(scroll,function(key){this.list.listEl.scrollTo(key,scroll[key])},this)},_doWithMaintainedScrollPosition:function(callback){var scroll=0;this.maintainScrollPosition&&(scroll=this.list.listEl.getScroll()),callback.call(this),this.maintainScrollPosition&&Ext.Object.each(scroll,function(key){this.list.listEl.scrollTo(key,scroll[key])},this)},_getSelectedGroupableConfig:function(){var config={ptype:"rallypickerselectedgroupable"};return this.selectedTextLabel&&(config.selectedTextLabel=this.selectedTextLabel),this.availableTextLabel&&(config.availableTextLabel=this.availableTextLabel),config},getInputTextValue:function(){return this.getInputEl().dom.value},focusPlaceholderText:function(){if(this.emptyText){var selectionRange=[0,0];this.focus(selectionRange)}},setValueText:function(text){var inputEl=this.getInputEl();inputEl&&(inputEl.dom.value=text)},getInputEl:function(){return this.inputEl},getList:function(){return this.list},containsExactMatch:function(){var store=this.store,inputField=this.filterFieldName,inputText=this.getInputTextValue();return store.findBy(function(record){return record.get(inputField)===inputText})>-1},onEnable:function(){this.callParent(arguments),this.alwaysExpanded&&this.getPicker().enable()},onDisable:function(){this.callParent(arguments),this.alwaysExpanded&&this.getPicker().disable()},findInStore:function(value){return this.store?this.store.findRecord(this.selectionKey,new RegExp("^"+value+"$")):null},_groupRecords:Ext.emptyFn,_groupSelectedRecords:Ext.emptyFn})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.FieldDisplayNameRenderer",{singleton:!0,columnLabels:{DisplayColor:"Color",DragAndDropRank:"Rank",FormattedID:"ID",PlanEstimate:"Plan Est",PredecessorsAndSuccessors:"Dependencies",ReleaseStartDate:"Start Date",Requirement:"User Story",TargetProject:"Project",TaskEstimateTotal:"Task Est",TaskRemainingTotal:"To Do",TotalArtifactCount:"Item Count",TaskActualTotal:"Actuals"},getDisplayName:function(field){return Ext.isObject(field)?this.columnLabels[field.name]||field.displayName:this.columnLabels[field]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.FieldPicker",{alias:"widget.rallyfieldpicker",extend:Rally.ui.picker.MultiObjectPicker,margin:"10px 0 255px 0",maxLength:32,readyEvent:"ready",width:300,clientMetrics:[{beginMethod:"expand",endMethod:"_onStoreLoad",description:"object picker loaded"},{method:"_onListItemClick",description:"list item clicked"},{event:"focus",description:"field picker focused"},{event:"blur",description:"field picker blurred"}],config:{maxLength:32,toolTipConfig:{html:'<h3 class="tooltip-heading">Field Picker Tip</h3><div class="tooltip-text">Start typing in the box to filter fields.</div>',destroyAfterHide:!0,showOnClick:!0,closable:!0},selectedTextLabel:"Selected Fields",availableTextLabel:"Available Fields",listCfg:{emptyText:'<div class="rui-multi-object-picker-empty-text">Type to filter fields</div>'},filterFieldName:"displayName",recordKey:"name",selectionKey:"name",rowSelectable:!0,modelTypes:[],fieldWhiteList:[],fieldBlackList:[],showAllCustomFields:!0,shouldRespondToScopeChange:!0,pickerCfg:{style:{border:"1px solid #DDD","border-top":"none"},height:248,shadow:!1},alwaysExpanded:!0,pickerAlign:"tl-bl",maintainScrollPosition:!0},constructor:function(config){this.enableGrouping=!0,this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.addEvents("fieldpickerstoreloaded"),this.callParent(arguments)},getStore:function(){return this.store},_fieldIsInWhiteList:function(field){return!field.custom&&(!this.fieldWhiteList.length||Ext.Array.contains(this.fieldWhiteList,field.name))},_fieldIsInBlackList:function(field){return Ext.Array.contains(this.fieldBlackList,field.name)},_shouldShowCustomField:function(field){return field.custom&&this.showAllCustomFields},setValue:function(values){if(this.store)if(Ext.isString(values)){var models=_.values(this.models),fieldNames=_(values.split(",")).map(function(value){var modelFields=_(models).invoke("getField",value).compact().value(),builtInFields=_.filter(modelFields,{custom:!1}),customFields=_.difference(modelFields,builtInFields);return 0===builtInFields.length?customFields:builtInFields}).flatten().compact().pluck("name").unique().value();this.callParent([fieldNames.join(",")])}else this.callParent(arguments);else this.on("fieldpickerstoreloaded",function(){this.setValue(values)},this)},_filterApplied:function(){this._groupRecords(this._getRecordValue())},_loadStore:function(options){var onComplete=function(options){this.fireEvent("fieldpickerstoreloaded",this,this.store),this.store.mon(this.store,"filterbytextinput",this._filterApplied,this),options&&options.success&&options.success.call(options.scope,[])};Rally.data.ModelFactory.getModels({types:this.modelTypes,context:this.context||this.getStoreConfig().context,success:function(models){var data=this._buildStoreData(models);this.models=models,this.store=this._createStoreWithData(Ext.Object.getValues(data)),onComplete.call(this,options)},failure:function(){this.store=this._createStoreWithData([]),onComplete.call(this,options)},scope:this,requester:this})},_buildStoreData:function(models){var data={},excludeMappedFields=1===Ext.Object.getSize(models);return Ext.Object.each(models,function(modelName,model){var fields=_.filter(model.getFields(),function(field){return(!excludeMappedFields||!field.isMappedFromArtifact)&&this._shouldShowField(field)},this),otherModels=_.difference(Ext.Object.getValues(models),[model]);_.each(fields,function(field){var fieldNameWithoutPrefix=field.name.replace(/^c_/,"");if(!data[fieldNameWithoutPrefix]){data[fieldNameWithoutPrefix]={name:field.name,displayName:Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(field)};var otherModelsWithField=_.filter(otherModels,function(otherModel){return otherModel.hasField(fieldNameWithoutPrefix)&&this._shouldShowField(otherModel.getField(fieldNameWithoutPrefix))},this);if(otherModelsWithField.length!==otherModels.length){var modelsWithField=[model.displayName].concat(_.pluck(otherModelsWithField,"displayName"));modelsWithField=_.map(modelsWithField,function(modelWithField){return modelWithField.replace("Portfolio Item ","")}),data[fieldNameWithoutPrefix].displayName+=" ("+modelsWithField.join(", ")+")"}}},this)},this),data},_shouldShowField:function(field){return field.hidden===!1&&(this._fieldIsInWhiteList(field)||this._shouldShowCustomField(field))&&!this._fieldIsInBlackList(field)},_createStoreWithData:function(data){return Ext.create("Ext.data.Store",{fields:[{name:"displayName",sortType:Ext.data.SortTypes.asUCString},{name:"name"}],sorters:[{property:"displayName",direction:"ASC"}],data:data,proxy:{type:"memory"}})},_createStoreAndExpand:function(){this.modelTypes&&this.modelTypes.length&&this._loadStore({success:function(){this.expand(),this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},scope:this})},refreshWithNewContext:function(context){this.getShouldRespondToScopeChange()&&this.refreshWithNewModelTypes(this.modelTypes,context)},refreshWithNewModelTypes:function(modelTypes,context){this.modelTypes=modelTypes,context&&(this.context=context,this.getStoreConfig().context=context.getDataContext()),this._invokeStoreRefresh()},_invokeStoreRefresh:function(){this.picker?this._loadStore({success:function(){this.list.bindStore(this.store),this.refreshView(),this.fireEvent("ready",this)},scope:this}):this.expand()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.CardFieldSelectable",{showFieldPicker:!0,appendCardFieldPickerSetting:function(fields){var alwaysSelectedValues=["FormattedID","Name","Owner","BlockedReason"];this.showFieldPicker&&fields.push({fieldLabel:"Card Fields",name:"cardFields",xtype:"rallyfieldpicker",settingsType:"board",modelTypes:this.modelNames,fieldBlackList:["Successors","Predecessors"],alwaysSelectedValues:alwaysSelectedValues,alwaysExpanded:!0,listeners:{selectionchange:function(picker){picker.validate()}},handlesEvents:{columnsettingsready:function(){this.picker&&this.alignPicker()}}})},getDefaultCardFieldSetting:function(){return this.config&&this.config.defaultSettings&&this.config.defaultSettings.cardFields?this.config.defaultSettings.cardFields:""},getCardFieldNames:function(){var fieldString=this.showFieldPicker?this.getSetting("cardFields"):this.getDefaultCardFieldSetting();return Ext.isEmpty(fieldString)?[]:fieldString.split(",")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.Context",{constructor:function(config){this.map=Ext.create("Ext.util.HashMap"),config&&config.initialValues&&this.putAll(config.initialValues)},get:function(key){return this.map.get(key)},put:function(key,value){var all={};all[key]=value,this.putAll(all)},putAll:function(object){Ext.Object.each(object,function(key,value){this.map.add(key,value)},this)},remove:function(value){this.map.remove(value)},clear:function(){this.map.clear()},clone:function(initialValues){return Ext.create("Rally.app.Context",{initialValues:Ext.merge({},this.map.map,initialValues)})},getScopedStateId:function(stateId){return Ext.create("Rally.state.ScopedStateUtil").getScopedStateId(stateId,{appID:this.getAppId(),workspace:this.getWorkspaceRef(),filterByUser:this.getUser()?this.getUser().getRef():null})},getAppId:function(){return this.get("appID")},getDataContext:function(){return{workspace:this.getWorkspaceRef(),project:this.getProjectRef(),projectScopeUp:this.getProjectScopeUp(),projectScopeDown:this.getProjectScopeDown()}},getWorkspace:function(){return this.get("workspace")},getPermissions:function(){return this.get("permissions")},getWorkspaceRef:function(){var workspace=this.getWorkspace();return workspace?Rally.util.Ref.getRelativeUri(workspace):null},getSubscription:function(){var subscription=this.get("subscription");return subscription instanceof Rally.domain.Subscription?subscription:Ext.create("Rally.domain.Subscription",subscription)},getProject:function(){return this.get("project")},setProject:function(project){project.self&&(project=project[project.persistenceProperty]),this.put("project",project)},setWorkspace:function(workspace){workspace.self&&(workspace=workspace[workspace.persistenceProperty]),this.put("workspace",workspace)},getProjectRef:function(){var project=this.getProject();return project?Rally.util.Ref.getRelativeUri(project):null},getProjectScopeDown:function(){return this.get("projectScopeDown")},getProjectScopeUp:function(){return this.get("projectScopeUp")},getTimeboxScope:function(){var scope=this.get("timebox");return scope&&scope.isWsapiModel&&(scope=Ext.create("Rally.app.TimeboxScope",{record:scope})),scope},setTimeboxScope:function(scope){return this.put("timebox",scope)},isFeatureEnabled:function(feature){return this.get("featureToggles")&&this.get("featureToggles").isEnabled(feature)},getUser:function(){var user=this.get("user");return user instanceof Rally.domain.User?user:Ext.create("Rally.domain.User",user)},getGlobalContext:function(){return Rally.environment.getGlobalContext()},getProps:function(){return this.map.data},_addListener:function(attribute,fn,scope){this.map.on("add",this._wrapListenerForAddOrReplace(attribute,fn,scope)),this.map.on("clear",this._wrapListenerForClear(fn,scope)),this.map.on("remove",this._wrapListenerForRemove(attribute,fn,scope)),this.map.on("replace",this._wrapListenerForAddOrReplace(attribute,fn,scope))},_removeListener:function(attribute,fn,scope){this.map.un("add",this._wrapListenerForAddOrReplace(attribute,fn,scope)),this.map.un("clear",this._wrapListenerForClear(fn,scope)),this.map.un("remove",this._wrapListenerForRemove(attribute,fn,scope)),this.map.un("replace",this._wrapListenerForAddOrReplace(attribute,fn,scope))},_wrapListenerForAddOrReplace:function(attribute,fn,scope){return function(map,key,value){key===attribute&&Ext.callback(fn,scope,[value])}},_wrapListenerForClear:function(fn,scope){return function(){Ext.callback(fn,scope,[null])}},_wrapListenerForRemove:function(attribute,fn,scope){return function(map,key){key===attribute&&Ext.callback(fn,scope,[null])}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.plugin.GridBoardAppResizer",{alias:"plugin.rallygridboardappresizer",extend:Ext.AbstractPlugin,init:function(cmp){this.cmp=cmp,cmp.on("contentupdated",function(){this.cmp.isDestroyed||(this._sizeGridBoardsToPage(),this._listenerAdded||(this._listenerAdded=!0,Ext.EventManager.onWindowResize(this._sizeGridBoardsToPage,this)))},this),cmp.on("destroy",function(){this._listenerAdded&&Ext.EventManager.removeResizeListener(this._sizeGridBoardsToPage,this)},this)},_getFooterHeight:_.memoize(function(){var footerContainerEl=Ext.get(Ext.query(".footer-container")[0]);return footerContainerEl&&footerContainerEl.getHeight()||0}),_getTotalParentBottomPadding:_.memoize(function(){for(var el=this.cmp.getEl(),totalBottomPadding=0;el&&"content"!==el.id;)totalBottomPadding+=el.getPadding("b")+el.getBorderWidth("b"),el=el.parent();return totalBottomPadding}),_sizeGridBoardsToPage:function(){var gridboards=this.cmp.query("rallygridboard");if(gridboards.length){var appTop=this.cmp.getEl().getTop(),availableHeight=this.cmp.getHeight(),minHeight=availableHeight,windowHeight=Rally.util.Window.getHeight();this.cmp.isFullPageApp&&(availableHeight=windowHeight-appTop-this._getFooterHeight()-this._getTotalParentBottomPadding()-3,minHeight=(600-(windowHeight-availableHeight))/gridboards.length),_.each(gridboards,function(gridboard){if(gridboard.rendered){var container=gridboard.up(),prevEl=container.getEl().prev(),containerHeaderHeight=gridboard.getEl().getTop()-(prevEl?prevEl.getBottom():appTop);gridboard.setHeight(Math.max(minHeight,availableHeight/gridboards.length-containerHeaderHeight))}})}}})}(),function(){var Ext=window.Ext4||window.Ext,fileUploadFieldLabel=new Ext.Template('<ol><li>Use our <a href="{contextPath}/resources/templates/import.sp?typedef={typedef}">import template</a> ',"to ensure the proper data format for import.</li>",'<li>Choose a .csv file to import.<div class="file-input"/></li>','<li class="last" style="display: none;">Choose your character encoding<div class="radio-group"/></li></ol>'),importErrorMessage=new Ext.Template('<div class="csv-import-error-header">',"We&#39;re sorry but there was a problem with your import.","</div>",'<div class="csv-import-error-body" id="error_message">{message}</div>');Ext.define("Rally.ui.dialog.CsvImportDialog",{alias:"widget.rallycsvimportdialog",extend:Rally.ui.dialog.Dialog,mixins:{messageable:Rally.Messageable},title:"Import",componentCls:"csv-import-dialog",autoShow:!0,constrain:!0,closable:!0,layout:"fit",width:420,dockedItems:[{xtype:"toolbar",dock:"bottom",ui:"footer",align:"middle",layout:{type:"hbox",pack:"center"}}],config:{model:void 0,params:{}},initComponent:function(){this.callParent(arguments),this.addEvents("successfulimport","failedimport","cancel"),this.advancedOptions=new Ext.form.RadioGroup({labelSeparator:"",hideLabel:!0,padding:0,vertical:!0,columns:1,items:[{labelAlign:"left",padding:"10 0 0 20",name:"encoding",id:"iso-latin-encoding-radio",inputValue:"ISO-8859-1",checked:!0,boxLabel:"ISO Latin-1 (Default for Excel)"},{labelAlign:"left",padding:"0 0 0 20",name:"encoding",id:"utf8-encoding-radio",inputValue:"UTF-8",boxLabel:"UTF-8"}]});var typeInfo=Rally.util.TypeInfo.getTypeInfoByAttr("schemaType",this.type)||Rally.util.TypeInfo.getTypeInfoByName(this.type);this.form=this.add({xtype:"form",itemId:"form",border:!1,url:Rally.environment.getServer().getContextUrl()+"/ajax/"+typeInfo.prefix+"/upload.sp?"+Ext.Object.toQueryString(this.params),fileUpload:!0,bodyCls:"form-body",labelAlign:"top",defaults:{anchor:"95%",allowBlank:!1,msgTarget:"side"},items:[{xtype:"component",html:fileUploadFieldLabel.apply({typedef:this.type,contextPath:Rally.environment.getServer().getContextUrl()})},{xtype:"component",itemId:"advanced",componentCls:"advanced",html:"advanced...",listeners:{click:{element:"el",fn:this._onFieldSetExpand},scope:this}}]}),this._dock=_.first(this.getDockedItems('toolbar[dock="bottom"]')),this._dock.add(this._getItemsToDock("import"))},afterRender:function(){this.callParent(arguments),this.fileField=Ext.widget({xtype:"fileuploadfield",itemId:"filefield",width:350,name:"importFile",emptyText:"Select a CSV File",hideLabel:!0,clearOnSubmit:!1,buttonConfig:{cls:"primary rly-small"},renderTo:this.getEl().down(".file-input")})},_onImport:function(){var formPanel=this.form,form=formPanel.form;form.waitMsgTarget=formPanel.getEl(),form.getFields=_.bind(function(){var fields=new Ext.util.MixedCollection;return fields.add(this.fileField),fields.add(this.advancedOptions.items.items[0]),fields.add(this.advancedOptions.items.items[1]),fields},this),formPanel.isValid()&&formPanel.submit({waitMsg:"Uploading your data...",success:function(form,action){this._switchToScreen("success",{xtype:"component",padding:10,id:"confirmation_message",componentCls:"csv-import-confirmation-message",html:action.result.responseText});var closeButton=this._dock.items.first();closeButton.focus(),this.publish(Rally.Message.bulkImport,this)},scope:this,failure:function(form,action){var errorMessage;errorMessage=action.result.errors?action.result.errors.message:Ext.String.htmlDecode(action.result.responseText),this._switchToScreen("failure",{xtype:"component",padding:10,html:importErrorMessage.apply({message:errorMessage})});var tryAgainButton=this._dock.items.first();tryAgainButton.focus()}})},_onFieldSetExpand:function(){this.down("#advanced").destroy(),this.advancedOptions.render(this.getEl().down(".radio-group")),this.getEl().down(".last").show(),this.doLayout()},_switchToScreen:function(screen,bodyItems){Ext.suspendLayouts(),"import"===screen?this.removeAll():this.remove(this.form,!1),this.add(bodyItems),this._dock.removeAll(),this._dock.add(this._getItemsToDock(screen)),Ext.resumeLayouts(!0)},_getItemsToDock:function(screen){return"import"===screen?[{text:"Import",
cls:"primary medium",border:0,itemId:"importButton",margin:"0 12 0 0",handler:this._onImport,scope:this},{text:"Cancel",cls:"secondary medium",border:0,itemId:"cancelButton",handler:this._onCancel,scope:this}]:"success"===screen?[{xtype:"button",text:"Close",cls:"primary medium",border:0,itemId:"closeButton",handler:this.destroy,scope:this}]:"failure"===screen?[{xtype:"button",text:"Try Again",cls:"primary medium",border:0,itemId:"closeButton",handler:this._onTryAgain,scope:this},{xtype:"button",text:"Cancel",cls:"secondary medium",border:0,itemId:"cancelButton",handler:this.destroy,scope:this}]:void 0},_onCancel:function(){this.destroy()},onDestroy:function(){this.form&&this.form.destroy(),this.callParent(arguments)},_onTryAgain:function(){this._switchToScreen("import",this.form)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.Scopeable",{context:null,rankScope:null,getContext:function(){return this.context},getDataContext:function(){var context=this.getAppContextOrEnvironmentContext();return context?context.getDataContext():null},getPermissions:function(){return this.getEnvironmentContext().getPermissions()},getEnvironmentContext:function(){return Rally.environment.getContext()},getAppContextOrEnvironmentContext:function(){return this.getContext()||this.getEnvironmentContext()},getRankScope:function(){return this.rankScope||this.getIterationRef()||this.getReleaseRef()||null},getIterationRef:function(){return this._getTimeboxScopeRef("iteration")},getReleaseRef:function(){return this._getTimeboxScopeRef("release")},_getTimeboxScopeRef:function(scopeType){var context=this.getContext(),timeboxScope=context&&context.getTimeboxScope();return timeboxScope&&timeboxScope.getType()===scopeType&&timeboxScope.getRecord()&&timeboxScope.getRecord().get("_ref")||null},getProjectRef:function(){var project=this.getAppContextOrEnvironmentContext().getProject();return project?project._ref:null},getWorkspaceRef:function(){var workspace=this.getAppContextOrEnvironmentContext().getWorkspace();return workspace?workspace._ref:null},isProjectEditor:function(){return this.getEnvironmentContext().getPermissions().isProjectEditor(this.getProjectRef())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.LeftRight",{alias:"widget.rallyleftright",extend:Ext.container.Container,cls:"rui-leftright",defaults:{xtype:"container"},items:[{itemId:"left",cls:"rly-left"},{itemId:"right",cls:"rly-right"}],getLeft:function(){return this.down("#left")},getRight:function(){return this.down("#right")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.GridBoardToggle",{extend:Ext.Container,alias:"widget.rallygridboardtoggle",statics:{BUTTON_DISABLED:"disabled"},componentCls:"rui-gridboard-toggle toggle-button-group",layout:"hbox",border:1,activeButtonCls:"rly-active",toggleState:"grid",showGridToggle:!0,showBoardToggle:!0,showChartToggle:!1,defaultType:"rallybutton",initComponent:function(){this.items=this._getItems(),this.callParent(arguments),this.addEvents(["toggle"]),this.addCls("toggle-button-group-"+this.items.length),this.items.each(function(item,index,length){this.mon(item,"click",this._onButtonClick,this);var isActive=item.itemId===this.toggleState;isActive&&item.addCls(this.activeButtonCls),(isActive||item.disabled)&&item.addCls("hide-tooltip"),0===index&&length>1?item.addCls("rly-left"):index===length-1&&length>1?item.addCls("rly-right"):item.addCls("center")},this)},_getItems:function(){return[].concat(this._getToggleConfig("board",this.showBoardToggle,{anchorOffset:45})).concat(this._getToggleConfig("grid",this.showGridToggle,{tooltipName:"List"})).concat(this._getToggleConfig("chart",this.showChartToggle,{anchorOffset:90,iconCls:"bars"}))},_getToggleConfig:function(toggleState,showButton,options){return options=_.merge({iconCls:toggleState,tooltipName:Ext.String.capitalize(toggleState),anchorOffset:65},options),showButton?{itemId:toggleState,cls:"toggle "+toggleState,disabled:showButton===this.self.BUTTON_DISABLED,iconCls:"icon-"+options.iconCls,frame:!1,toolTipConfig:{html:"Switch to "+options.tooltipName+" View",anchor:"top",hideDelay:0,constrainPosition:!1,anchorOffset:options.anchorOffset,mouseOffset:[-1*options.anchorOffset,0]}}:[]},_onButtonClick:function(btn){var btnId=btn.getItemId();btnId!==this.toggleState&&(this.toggleState=btnId,this.items.each(function(item){item===btn?item.addCls(this.activeButtonCls):item.removeCls(this.activeButtonCls)},this),this.fireEvent("toggle",this,this.toggleState))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Window",{singleton:!0,getMainWindow:function(){var win=this.getWindow();if(win.opener)try{win.opener.location.host===win.host&&(win=win.opener)}catch(e){}return win.top&&win.top!==win&&(win=win.top),win},getWindow:function(){return window},getScrollX:function(){var x,w=this.getWindow();return w.pageXOffset?x=w.pageXOffset:document.documentElement&&document.documentElement.scrollLeft?x=document.documentElement.scrollLeft:document.body&&(x=document.body.scrollLeft),x},getScrollY:function(){var y,w=this.getWindow();return w.pageYOffset?y=w.pageYOffset:document.documentElement&&document.documentElement.scrollTop?y=document.documentElement.scrollTop:document.body&&(y=document.body.scrollTop),y},getWidth:function(){var x,w=this.getWindow();return w.innerHeight?x=self.innerWidth:document.documentElement&&document.documentElement.clientWidth?x=document.documentElement.clientWidth:document.body&&(x=document.body.clientWidth),x},getHeight:function(){var y;return self.innerHeight?y=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?y=document.documentElement.clientHeight:document.body&&(y=document.body.clientHeight),y},isInFrame:function(){return top!==self}}),Rally.getWindow=function(){return Rally.util.Window.getWindow()}}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.nav.Message",{singleton:!0},function(){Ext.apply(Rally.nav.Message,{manageIterations:"manageIterations",detail:"detail",edit:"edit",create:"create",copy:"copy",split:"split",goTo:"goTo",applyParameters:"applyParameters",postNavigationFlair:"postnavigationflair"})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.nav.Manager",{alternateClassName:["Rally.util.Navigation"],singleton:!0,_getContextPath:function(){return Rally.environment.getServer().getContextUrl()},getDetailUrl:function(record,options){if(options=options||{},!record)return null;var hash=this.getDetailHash(record,options);return hash?Rally.environment.getServer().getHashBaseUrl()+"#"+hash:null},getDetailHash:function(record,options){options=options||{};var ref=Rally.util.Ref.getRefUri(record);if(!Rally.util.Ref.isRefUri(ref))return null;var refItem=Rally.util.Ref.getRefObject(ref),refType=refItem.getType();if("testfolder"===refType)return null;var oid=refItem.getOid(),info=(refType?Rally.util.TypeInfo.getTypeInfoByName(refType):null)||{},alias=info.alias,suffix=info.detailSlugSuffix,prettyType=alias||refType.toLowerCase(),scopePath="/"+Rally.environment.getContext().getScopeStr(options.projectOid||this._determineProjectOidForLink(record,options)),hash=oid&&prettyType?scopePath+"/detail/"+prettyType+"/"+oid+(suffix||""):null;return hash&&options.subPage&&(hash+="/"+options.subPage),hash},_determineProjectOidForLink:function(record,options){var artifactProjectOid,context=Rally.environment.getContext(),currentWorkspaceOid=Rally.util.Ref.getOidFromRef(context.getWorkspace()._ref),currentProjectOid=Rally.util.Ref.getOidFromRef(context.getProject()._ref);if(options.useExt2Records)artifactProjectOid=Rally.util.Ref.getOidFromRef(record&&record.json&&record.json.Project&&record.json.Project._ref);else{var project=record.Project||Ext.isFunction(record.get)&&record.get("Project");artifactProjectOid=Rally.util.Ref.getOidFromRef(project&&project._ref)}if(!artifactProjectOid)return currentProjectOid;if(currentProjectOid===artifactProjectOid)return artifactProjectOid;var artifactWorkspaceOid=context.getPermissions().getProjectToWorkspaceMap()[artifactProjectOid];return artifactWorkspaceOid!==currentWorkspaceOid?artifactProjectOid:currentProjectOid},showDetail:function(item,args){Rally.environment.getMessageBus().publish(Rally.nav.Message.detail,item,args)},goToRallyPage:function(token,context){context&&(token=this.getScopedToken(token,context)),Rally.environment.getMessageBus().publish(Rally.nav.Message.goTo,token)},goBack:function(){Rally.environment.getMessageBus().publish(Rally.nav.Message.goTo,"goBack")},create:function(type,args){Rally.environment.getMessageBus().publish(Rally.nav.Message.create,type,args)},copy:function(item){Rally.environment.getMessageBus().publish(Rally.nav.Message.copy,item)},edit:function(item,args){Rally.environment.getMessageBus().publish(Rally.nav.Message.edit,item,args)},manageIterations:function(context){context=context||Rally.environment.getContext(),(context.getSubscription().isHsEdition()||context.getSubscription().isExpressEdition())&&Rally.environment.getMessageBus().publish(Rally.nav.Message.manageIterations,{context:context})},split:function(record){Rally.environment.getMessageBus().publish(Rally.nav.Message.split,record)},applyParameters:function(params,triggerNavStateChange,paramsToRemove){Rally.environment.getMessageBus().publish(Rally.nav.Message.applyParameters,params,triggerNavStateChange,paramsToRemove)},getScopedToken:function(token,context){var scopeStr;return scopeStr=Ext.isFunction(context.getScopeStr)?context.getScopeStr():Rally.env.Context.prototype.getScopeStr.call(context),"/"+scopeStr+token}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.nav.DetailLink",{alternateClassName:["Rally.util.DetailLink"],singleton:!0,template:void 0,constructor:function(){this.callParent(arguments),this.template=Ext.create("Ext.XTemplate","<a",'<tpl if="tooltip"> class="formatted-id-link"</tpl>',' href="{href}"','<tpl if="id"> id="{id}"</tpl>','<tpl if="onclick"> onclick="{onclick}"</tpl>','<tpl if="target"> target="{target}"</tpl>','<tpl if="hover"> {hover}</tpl>',">{text}</a>")},getLink:function(options){var data=options.record.isModel?options.record.data:options.record,target=Rally.util.Window.isInFrame()?"_top":"",hover="",href=Rally.nav.Manager.getDetailUrl(data,options);if(!href)return options.text;var showHover=options.showHover!==!1&&window.activateEl;showHover&&(hover=this._getHoverText(data._ref));var oid=Rally.util.Ref.getOidFromRef(data._ref);return this.template.apply({href:href,target:target,onclick:options.onclick,text:options.text,hover:hover,tooltip:options.showTooltip!==!1,id:showHover?"hov"+oid:""})},_getHoverText:function(ref){return"user"===Rally.util.Ref.getTypeFromRef(ref)?'onmouseover="activateEl(this, showUserDisplayTip);return false;"':'onmouseover="activateEl(this);return false;"'}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.String",{requires:[],singleton:!0,htmlEncode:Ext.String.htmlEncode,endsWith:function(str,suffix){return!(!str||!suffix||"string"!=typeof str)&&str.indexOf(suffix,str.length-suffix.length)!==-1},startsWith:function(str,prefix){return!(!str||!prefix||"string"!=typeof str)&&str.substr(0,prefix.length)===prefix},niceSubstring:function(str,len,removeFromMiddle,allowMarkup){var s=str||"",max=len||80;if(s.length<max)return s;if(allowMarkup&&(s=Rally.util.String.getText(str)),removeFromMiddle){var half=max/2-2;return s.substring(0,half).trim()+" ... "+s.substring(s.length-half+1).trim()}return s.length>max?s.substring(0,max-3)+"...":s},getText:function(html){var value="";try{var span=document.createElement("span");span.innerHTML=html,value=span.textContent||span.innerText}catch(e){}return value?value:""},isEmpty:function(s){return"undefined"==typeof s||null===s||""===s},isNotEmpty:function(s){return!this.isEmpty(s)},contains:function(str,match){return!this.isEmpty(str)&&str.indexOf(match)>-1},fixMarkup:function(markup){return markup=Ext.util.Format.stripScripts(markup),this.hasUnbalancedTags(markup)?this.htmlEncode(markup):this.autoCloseTags(markup)},hasUnbalancedTags:function(markup){var str=""+markup;return str.split("<").length!==str.split(">").length},autoCloseTags:function(markup){var scratchDiv=document.createElement("div");if(Ext.isIE){var scratchDiv2=document.createElement("div"),fragment=document.createDocumentFragment();scratchDiv.innerHTML=markup;for(var nodes=scratchDiv.childNodes,elems=[],i=0;i<nodes.length;i++)elems.push(nodes[i]);for(var e=0;e<elems.length;e++){var tag=elems[e].tagName;tag&&0===tag.indexOf("/")||fragment.appendChild(elems[e])}return scratchDiv2.innerHTML="",scratchDiv2.appendChild(fragment.cloneNode(!0)),scratchDiv2.innerHTML}return scratchDiv.innerHTML=markup,scratchDiv.innerHTML},appendWithSeparator:function(str,strToAppend,separator){return separator=separator||" ",strToAppend?(str?str+separator:"")+strToAppend:str},stripHTML:function(oldString){if(oldString){var newString=oldString.replace(/(<([^>]+)>)/gi,"");return newString=escape(newString),newString=newString.replace("/%0D%0A/g"," "),newString=newString.replace("/%0A/g"," "),newString=newString.replace("/%0D/g"," "),newString=unescape(newString),newString=Rally.util.String.consolidateSpaces(newString)}},consolidateSpaces:function(inputString){if(!Ext.isString(inputString))return inputString;var retValue=Ext.String.trim(inputString);return retValue.replace(/( )+/g," ")},containsEscapableChars:function(str){return!!str&&str!==escape(str).replace('^"|"$',"")},toTitleCase:function(str){return str.replace(/\w\S*/g,function(word){return word.charAt(0).toUpperCase()+word.substr(1).toLowerCase()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.notify.Notification",{extend:Ext.Component,alias:"widget.rallynotification",componentCls:"rui-notification",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},statics:{statusCls:"status",confirmCls:"confirm",warningCls:"rly-warning",errorCls:"error",templates:{},getTemplatedMessage:function(config){var message=config.message||"";return config.allowHTML!==!0&&(message=Rally.util.String.stripHTML(config.message)),config.model&&(this.templates.hasOwnProperty(message)||(this.templates[message]=Ext.create("Ext.XTemplate",message)),message=this.templates[message].apply(config.model)),message}},renderTpl:['<div class="rui-notification-body">','  <tpl if="closable">','    <div class="rui-notification-close-btn"><div class="icon-cancel"></div></div>',"  </tpl>",'  <div class="rui-notification-message">{message}</div>',"</div>"],renderSelectors:{closeBtnEl:".rui-notification-close-btn",messageEl:".rui-notification-message"},message:"",closable:!0,duration:1e4,showDuration:500,hideDuration:250,showForever:!1,animateShowHide:!0,allowHTML:!1,links:[],constructor:function(config){this.callParent(arguments),this.showForever&&(this.duration=0)},initComponent:function(){this.callParent(arguments),this.renderData=Ext.merge(this.renderData,{message:this.self.getTemplatedMessage(this),closable:this.closable}),this.on("render",this._onRender,this)},destroy:function(){return this.showAnimation?(this.showAnimation.callback=function(){delete this.showAnimation,this.destroy()},void this.showAnimation.end()):this.hideAnimation?(this.hideAnimation.callback=function(){delete this.hideAnimation,this.self.superclass.destroy.call(this)},void this.hideAnimation.end()):this.animateShowHide?void this._hide():(Rally.environment.getMessageBus().publish(Rally.Message.notificationRemoved),void this.callParent(arguments))},_onRender:function(){this._initCloseButton(),this._attachLinks(),this.duration>0&&setTimeout(Ext.bind(this.destroy,this),this.duration),this._show()},_show:function(){var el=this.getEl();this.animateShowHide?(el.setOpacity(0),el.setStyle("visibility","visible"),this.showAnimation=Ext.create("Ext.fx.Anim",{target:el,duration:this.showDuration,to:{opacity:1},callback:function(){delete this.showAnimation},scope:this}),this._forceShow()):this._makeVisible()},_hide:function(){var el=this.getEl();el&&(this.hideAnimation=Ext.create("Ext.fx.Anim",{target:el,duration:this.hideDuration,to:{opacity:0},callback:function(){delete this.hideAnimation,this.self.superclass.destroy.call(this)},scope:this}))},_forceShow:function(){setTimeout(Ext.bind(function(){this.showAnimation&&this.showAnimation.running&&(this.showAnimation.end(),this._makeVisible())},this),this.showDuration+1)},_makeVisible:function(){var el=this.getEl();el.setOpacity(1),el.setStyle("visibility","visible")},_attachLinks:function(){Ext.isEmpty(this.links)||Ext.each(this.links,function(link){this._createLink(this.messageEl,link)},this)},_createLink:function(el,link){var linkEl=Ext.DomHelper.append(el,{tag:"a",html:"<span>"+Rally.util.String.stripHTML(link.text)+"</span>"},!0);linkEl.dom.href=link.href||"#",link.fn&&this.mon(linkEl,"click",function(){this.recordAction({description:"clicked notification link",miscData:{linkText:link.text}}),Ext.callback(link.fn,link.scope||this,link.args||[]),this._hide()},this,{stopEvent:!0})},_initCloseButton:function(){this._addCloseBtnListeners(this.closeBtnEl)},_addCloseBtnListeners:function(btnEl){var hoverCls="hover";btnEl&&(btnEl.hover(function(){btnEl.addCls(hoverCls)},function(){btnEl.removeCls(hoverCls)}),btnEl.on("click",function(){this.recordAction({description:"closed notification"}),this.destroy()},this))}})}(),function(){var Ext=window.Ext4||window.Ext,splitType=function(type){return(type||"").split("/")};Ext.define("Rally.util.Type",{singleton:!0,containsTypeOrParent:function(container,type){return!!this.getByTypeOrParentType(container,type)},getByTypeOrParentType:function(container,type){var typeOrParent=this.getTypeOrParentType(type);return Ext.isArray(container)?container.indexOf(typeOrParent)>-1?typeOrParent:void 0:container[typeOrParent]},getTypeOrParentType:function(type){return splitType(type)[0]},getUnqualifiedType:function(type){var typeNameParts=splitType(type);return typeNameParts[typeNameParts.length-1]},getModelDisplayName:function(model){return model.isPortfolioItem&&model.isPortfolioItem()?model.elementName:model.displayName},isArtifact:function(typePath,parentTypeName){return typePath=Rally.data.ModelTypes.getTypeByName(typePath),this.isPortfolioItem(parentTypeName)||_.contains(Rally.data.ModelTypes.artifactTypes,typePath.toLowerCase())},isPortfolioItem:function(parentTypeName){return parentTypeName&&"portfolioitem"===parentTypeName.replace(/\s/g,"").toLowerCase()},PortfolioItem:{isTopLevelType:function(record){return!Ext.isDefined(record.get("Parent"))}}})}(),function(){var Ext=window.Ext4||window.Ext,notifiableBlacklist=["subscription","workspace","project","user"];Ext.define("Rally.ui.notify.Notifier",{singleton:!0,show:function(config){var notificationMessage=config.notificationMessage||Rally.Message.displayNotification;Rally.environment.getMessageBus().publish(notificationMessage,config)},hide:function(config){config=config||{},Rally.environment.getMessageBus().publish(Rally.Message.clearNotification,config)},showConfirmation:function(config){config.cls=Rally.ui.notify.Notification.confirmationCls,this.show(config)},showStatus:function(config){config.cls=Rally.ui.notify.Notification.statusCls,this.show(config)},showWarning:function(config){config.cls=Rally.ui.notify.Notification.warningCls,this.show(config)},showError:function(config){config.cls=Rally.ui.notify.Notification.errorCls,config.message&&(config.message=Rally.util.Error.getUserFriendlyError(config.message)),this.show(config)},showErrorDialog:function(config){config.notificationMessage=Rally.Message.errorDisplayNotification,this.showError({message:"Looks like there was a problem. "+config.validationErrors[0],timeout:1e4}),this.show(config)},showCreate:function(config){config.recordAction="added",this._showRecordMessage(config)},showUpdate:function(config){config.recordAction="changed",this._showRecordMessage(config)},showDelete:function(record,restoreHandler,scope){var config={artifact:record,showAddDetails:!1,forceFlare:!0};record.self.restorable===!0?(config.recordAction="deleted",config.links=[{text:"Restore from Recycle Bin",fn:Ext.bind(restoreHandler||this._defaultRestoreHandler,scope||this,[record]),iconCls:"sprite-recycle-small",iconPos:"r"}]):config.recordAction="permanently deleted",this._showRecordMessage(config)},_showCustomRecordMessage:function(record,message){this.show({allowHTML:!0,message:Ext.String.format(message,this._recordToString(record)),timeout:1e4})},showWatch:function(record,options){var message="Watching {0}.";options&&options.prependMessage&&(message=options.prependMessage+" "+message),this._showCustomRecordMessage(record,message)},showUnwatch:function(record){var message="Unwatched {0}.";this._showCustomRecordMessage(record,message)},showWatchConflict:function(record){this._showCustomRecordMessage(record,"You are already watching {0}.")},showRemove:function(removedRecord,associatedRecord){var message=Ext.String.format("{0} has been removed from {1}",this._recordToString(removedRecord),this._recordToString(associatedRecord));this.show({allowHTML:!0,message:message})},showRestore:function(config){if(config.recordAction="restored",config.showAddDetails=!1,config.uri){var link=Rally.nav.DetailLink.getLink({record:config.artifact,text:"Go To The Restored Item"});config.links=[{text:link,href:"#"+Rally.nav.Manager.getDetailHash(config.artifact)}]}this._showRecordMessage(config)},_isShowableType:function(record){return!_.contains(notifiableBlacklist,record.self.typePath.toLowerCase())},_showRecordMessage:function(config){if(this._makeSureRecordsHaveFields(config.artifact),this._isShowableType(config.artifact)||config.forceFlare){config.artifactName=this._recordToString(config.artifact);var message=Ext.String.format("{0} has been {1}.",config.artifactName,config.recordAction),links=config.links||[];config.artifact.self.isArtifact()&&config.showAddDetails!==!1&&links.push({text:"Add Details",fn:function(){Rally.nav.Manager.edit(config.artifact)}}),config.artifact.self.isArtifact()&&config.showRank===!0&&links.push({text:"Move to Top",fn:function(){Rally.data.Ranker.rankToTop(config.artifact,config.rankScope?{params:{rankScope:config.rankScope}}:{})}}),this.show({allowHTML:!0,message:message,links:links})}},_recordToString:function(record){var recordString;return recordString=_.isFunction(record.getFormattedName)?record.getFormattedName():_.isFunction(record.isPreference)&&record.isPreference()&&"View"===record.get("Type")?'View "'+Rally.util.String.niceSubstring(record.get("_refObjectName"),60,!0)+'"':record.hasField("FormattedID")&&record.get("FormattedID")||record.hasField("ID")&&record.get("ID")?'"<span class="formatted-id-template">'+(record.get("FormattedID")||record.get("ID"))+":</span> "+Rally.util.String.niceSubstring(record.get("_refObjectName"),60,!0)+'"':"attributedefinition"===record.self.typePath?'Field "'+Rally.util.String.niceSubstring(record.get("_refObjectName"),60,!0)+'"':"testcaseresult"===record.self.typePath?'Test Case Result for build "'+Rally.util.String.niceSubstring(record.get("Build"),60,!0)+'"':'"'+Rally.util.String.niceSubstring(record.get("_refObjectName"),60,!0)+'"'},_makeSureRecordsHaveFields:function(record){record.self||(record.self={}),record.self.typePath||(record.self.typePath=record._type||"unknown"),record.self.parentTypeName||(record.self.parentTypeName=Rally.util.Type.getTypeOrParentType(record.self.typePath)),record.self.isArtifact||(record.self.isArtifact=function(){return Rally.util.Type.isArtifact(record.self.typePath,record.self.parentTypeName)})},_defaultRestoreHandler:function(artifact){Rally.environment.getIoProvider().httpGet({url:Rally.environment.getServer().getContextUrl()+"/recyclebin/restoreItem.sp",params:{itemOid:artifact.getId(),noRedirect:"true"},success:function(){Rally.environment.getMessageBus().publish(Rally.Message.objectCreate,artifact,this),Rally.ui.notify.Notifier.showRestore({artifact:artifact})},failure:function(){Rally.environment.getMessageBus().publish(Rally.Message.objectCreate,artifact,this),Rally.ui.notify.Notifier.showRestore({artifact:artifact})},scope:this})},buildPrefix:function(fid,name){name=Rally.util.String.fixMarkup(name);var prefixTemplate=new Ext.XTemplate('"<tpl if="fid"><span class="formatted-id-template">{fid}:</span> </tpl>',Rally.util.String.niceSubstring(name,35,!0,!0),'"');return prefixTemplate.apply({fid:fid,name:name})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Array",{singleton:!0,firstElementsOf:function(array,n){return Ext.Array.slice(array,0,n)},lastElementsOf:function(array,n){return Ext.Array.slice(array,array.length-n,array.length)},sortByAttribute:function(list,attributeName){return Ext.Array.sort(list,function(a,b){var aValue=a[attributeName],bValue=b[attributeName];return aValue>bValue?1:aValue<bValue?-1:0})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Ui",{singleton:!0,executeCallbackWhenImagesLoaded:function(images,callback,scope){function decrementNumImagesLoaded(){numImagesLoading--,0===numImagesLoading&&callback.apply(scope)}var numImagesLoading=0;images.each(function(image){image.dom.complete||(numImagesLoading++,image.on("load",decrementNumImagesLoaded),image.on("error",decrementNumImagesLoaded))})},scrollWindowToOrigin:function(){window.scrollTo(0,0)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.RecordCollection",{singleton:!0,modify:function(options){options.parentRecord.getCollection(options.collectionName,{autoLoad:!0,limit:1/0,listeners:{load:function(store){_.each(options.add,function(record){store.add(record)}),_.each(options.remove,function(record){store.remove(record)}),store.sync(options.saveOptions)}}})}})}(),function(){var unloadHandler,Ext=window.Ext4||window.Ext,unloadCount=0;Ext.define("Rally.data.util.Record",{singleton:!0,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},getNoCopyAttributes:function(record){return{_ref:"",_refObjectName:"",_CreatedAt:"",_objectVersion:"",_p:"",Attachments:this.getEmptyCollectionField(record),ObjectID:"",VersionId:"",FormattedID:"",CreationDate:"",LastUpdateDate:"",Discussion:this.getEmptyCollectionField(record),Changesets:this.getEmptyCollectionField(record),Children:this.getEmptyCollectionField(record),Tags:this.getEmptyCollectionField(record),TestCases:this.getEmptyCollectionField(record)}},getEmptyCollectionField:function(record){return null},getDifferences:function(recordA,recordB){var differentFields=[];return Ext.Object.each(recordA.data,function(key,value){Ext.isObject(value)&&value._ref?value._ref!==recordB.get(key)._ref&&differentFields.push(key):Ext.isObject(value)||Ext.isArray(value)?Ext.Object.toQueryString(value)!==Ext.Object.toQueryString(recordB.get(key))&&differentFields.push(key):Ext.isDate(value)?Ext.Date.isEqual(value,recordB.get(key))||differentFields.push(key):value!==recordB.get(key)&&differentFields.push(key)}),differentFields},serverSideCopy:function(record){var deferred=Ext.create("Deft.Deferred"),type=record.get("_type"),data={};return data[type]={},Ext.Ajax.request({url:[Rally.environment.getServer().getWsapiUrl(),type,record.getId(),"copy"].join("/"),method:"POST",params:{key:Rally.env.IoProvider.getSecurityToken()},jsonData:data,success:function(response,options){var data=JSON.parse(response.responseText).CreateResult;if(data.Errors&&data.Errors.length>0)Rally.ui.notify.Notifier.showError({message:data.Errors[0]}),deferred.reject({response:response,options:options});else{var newRecord=Ext.create(record.$className,data.Object);deferred.resolve({response:response,options:options,record:newRecord})}},failure:function(response,options){Rally.ui.notify.Notifier.showError({message:"Sorry, a server error occurred while copying."}),deferred.reject({response:response,options:options})}}),deferred.promise},copyRecord:function(recordToCopy){var newRecord=recordToCopy.copy();return newRecord.set(this.getNoCopyAttributes(newRecord)),Ext.data.Model.id(newRecord),newRecord.setDirty(),newRecord.copied=!0,newRecord.copyObjectID=recordToCopy.getId(),newRecord},getWsapiOperationErrorMessage:function(operation){return operation.error&&operation.error.errors&&operation.error.errors.length&&operation.error.errors[0]},removeValidationCruft:function(message){if(message&&message.indexOf("Validation error:")>-1){var splitMessage=message.split(":");splitMessage.length>2&&(message=splitMessage.slice(2).join(":"))}return message},showWsapiErrorNotification:function(record,operation){var message,errorMessage=this.getWsapiOperationErrorMessage(operation);this._isObjectDoesNotExistErrorMessage(errorMessage)?message=(record?record.get("FormattedID"):"The record")+" was deleted by another user":(message=(record?record.get("FormattedID")+" a":"A")+"n unexpected error occurred",errorMessage&&(message+=": "+errorMessage)),Rally.ui.notify.Notifier.showError({message:message})},isObjectDoesNotExistWsapiError:function(operation){var errorMessage=this.getWsapiOperationErrorMessage(operation);return this._isObjectDoesNotExistErrorMessage(errorMessage)},makeErrorMessageMoreUserFriendly:function(errorMessage){var message=errorMessage;return _.contains(errorMessage,"Preference.Name conflicts with")&&(message=Ext.String.format('Validation error: "{0}" already exists. Please choose a unique name.',errorMessage.split("Preference.Name conflicts with ")[1].trim())),message},_isObjectDoesNotExistErrorMessage:function(errorMessage){return!!errorMessage&&_.some(["Object to delete cannot be null","Cannot find object to read","Could not read:"],function(objectErrorMessage){return _.contains(errorMessage,objectErrorMessage)})},copyAndSaveRecord:function(record,saveOptions,memberOverrides){var copyContext=this._intializeCopyContext(record,saveOptions,memberOverrides),loadOpts={context:saveOptions&&saveOptions.context,failure:copyContext.saveOptions.failure,success:Ext.bind(this._saveRecordCopy,this,[copyContext],!0)};this.recordLoadBegin({description:"Copying record",miscData:{id:record.getId()}}),record.self.load(record.getId(),loadOpts)},splitAndSaveRecord:function(record,saveOptions,memberOverrides){var collectionsToCopy=[{collectionName:"Tags",shallow:!0}];collectionsToCopy=collectionsToCopy.concat(this._getMultiValueCustomFieldCollectionDefs(record)),saveOptions=Ext.merge(saveOptions||{},{collectionsToCopy:collectionsToCopy}),this.copyAndSaveRecord(record,saveOptions,memberOverrides)},_intializeCopyContext:function(record,saveOptions,memberOverrides){var copyContext={originalRecord:record,saveOptions:Ext.applyIf(saveOptions||{},{context:{project:record.get("Project")&&record.get("Project")._ref,workspace:null},collectionsToCopy:this._initializeCollectionsToCopy(record),requester:this}),memberOverrides:memberOverrides||{}};return copyContext.saveOptions._failure=copyContext.saveOptions.failure,copyContext.saveOptions.failure=Ext.bind(this._onCopyFailure,this,[copyContext],!0),copyContext},_getMultiValueCustomFieldCollectionDefs:function(record){var mvcfCollectionsToCopy=_(record.getFields()).filter(function(field){return _.isFunction(field.isMultiValueCustom)&&field.isMultiValueCustom()}).map(function(field){return{collectionName:field.name,shallow:!0}}).value();return mvcfCollectionsToCopy},_initializeCollectionsToCopy:function(record){var collectionsToCopy=[{collectionName:"Tasks",relationName:"WorkProduct"},{collectionName:"Milestones",shallow:!0},{collectionName:"Predecessors",shallow:!0},{collectionName:"Successors",shallow:!0},{collectionName:"Tags",shallow:!0}];return collectionsToCopy=collectionsToCopy.concat(this._getMultiValueCustomFieldCollectionDefs(record)),"testset"===record.self.prettyTypeName&&collectionsToCopy.push({collectionName:"TestCases",shallow:!0}),collectionsToCopy},getProject:function(record){var project=record.get("Project");return project=""===project?Rally.environment.getContext().context.scope.project:project,null!==project&&(project=project._ref||project),project},isParent:function(record){
return void 0!==record.get("Children")&&record.get("Children").Count>0},isReadOnly:function(record){var updatable=!1;return updatable=_.isFunction(record.isUpdatable)?record.isUpdatable():record.get("updatable"),!updatable&&!record.phantom},syncModelProject:function(record,onSuccess,scope){var recordProject=record.get("Project");if(recordProject&&recordProject._ref){var modelContext=record.self.context;if(!modelContext||modelContext.project!==recordProject._ref)return Rally.data.ModelFactory.getModel({context:{project:recordProject._ref},type:record.self.typeName,success:function(model){record.self=model,onSuccess.call(this,record)},scope:scope}),!0}return!1},_saveRecordCopy:function(record,operation,copyContext){var copiedRecord=this.copyRecord(record);copiedRecord.set(copyContext.memberOverrides),copiedRecord.isTask()&&!copiedRecord.get("ToDo")&&copiedRecord.set("ToDo",0),this._prepareCollectionsToCopy(record,copyContext).then({success:function(collectionsToCopy){var opts,Ranker=Rally.data.Ranker,rankOptions=Ranker.generateRankParameters({relativeRecord:record,position:"after"});Ext.merge(copyContext.saveOptions,rankOptions),copyContext.copiedRecord=copiedRecord,copyContext.collectionsToCopy=collectionsToCopy,collectionsToCopy.length>0?this._saveRecordCopyWithCollections(copyContext):(opts=copyContext.memberOverrides.copyingCollectionItem?copyContext.saveOptions:{success:function(record,operation){copyContext.savedRecord=record,copyContext.saveOperation=operation,this._onCopySuccess(copyContext)},failure:copyContext.saveOptions.failure,context:copyContext.saveOptions.context,requester:copyContext.saveOptions.requester,scope:this},copiedRecord.isTask()&&(opts.params={rankTo:"BOTTOM"}),copiedRecord.save(opts))},scope:this})},_prepareCollectionsToCopy:function(record,copyContext){var copyableCollections=copyContext.saveOptions.collectionsToCopy,promises=_(copyableCollections).map(function(collection){return this._loadDataForCollection(record,collection)},this).compact().value();return 0===promises.length?Deft.Promise.when([]):Deft.Promise.all(promises)},_loadDataForCollection:function(record,collection){var collectionName=collection.collectionName,collectionStore=record.hasField(collectionName)&&record.getCollection(collectionName,{limit:1/0}),deferred=new Deft.Deferred;return collectionStore&&collectionStore.getTotalCount()>0?(collectionStore.load({callback:function(records){collection.collection=records,deferred.resolve(collection)}}),deferred):null},_saveRecordCopyWithCollections:function(copyContext){unloadCount<1&&(unloadHandler=window.onbeforeunload,window.onbeforeunload=Ext.bind(this._onCopyUnload,this)),unloadCount++,copyContext.copiedRecord.save({failure:copyContext.saveOptions.failure,success:Ext.bind(function(record,operation){copyContext.savedRecord=record,copyContext.saveOperation=operation,this._copyAndSaveCollections(copyContext)},this),context:{project:copyContext.copiedRecord.get("Project")._ref,workspace:null},params:copyContext.saveOptions?copyContext.saveOptions.params:void 0,requester:copyContext.saveOptions.requester})},_copyAndSaveCollections:function(copyContext){var collectionsToCopy=copyContext.collectionsToCopy,record=copyContext.originalRecord;if(collectionsToCopy.length>0){var collectionToCopy=collectionsToCopy.pop();!collectionToCopy.shallow&&collectionToCopy.collection&&collectionToCopy.collection.length>0&&Rally.ui.notify.Notifier.showStatus({message:'Copy of "<span class="formatted-id-template">'+record.get("FormattedID")+":</span> "+record.get("Name")+"\" in progress. Please stay on this page until it's complete.",allowHTML:!0}),this._copyAndSaveCollection(collectionToCopy,copyContext)}else this._onCopySuccess(copyContext)},_copyAndSaveCollection:function(collectionToCopy,copyContext){var collection=collectionToCopy.collection;if(collection.length>0)if(collectionToCopy.shallow)Rally.data.util.RecordCollection.modify({add:collection,collectionName:collectionToCopy.collectionName,parentRecord:copyContext.savedRecord,saveOptions:{success:function(){this._copyAndSaveCollections(copyContext)},failure:function(batch){this._onCopyFailure(void 0,batch.operations[0],copyContext)},scope:this}});else{var collectionItem=collection.pop();Rally.data.ModelFactory.getModel({type:collectionItem.self.typePath,success:Ext.bind(this._copyAndSaveCollectionItem,this,[collectionItem,collectionToCopy,copyContext],!0),scope:this})}else this._copyAndSaveCollections(copyContext)},_copyAndSaveCollectionItem:function(model,collectionItem,collectionToCopy,copyContext){var memberOverrides={copyingCollectionItem:!0},itemRecord=model.create(collectionItem.getData()),callback=Ext.bind(function(collectionItemRecord,operation){operation.success||this._onCopyFailure(collectionItemRecord,operation,copyContext),this._copyAndSaveCollection(collectionToCopy,copyContext)},this);itemRecord.set("Project",copyContext.savedRecord.get("Project")),collectionToCopy.relationName&&(memberOverrides[collectionToCopy.relationName]=copyContext.savedRecord.get("_ref")),this.copyAndSaveRecord(itemRecord,{callback:callback},memberOverrides)},_onCopySuccess:function(copyContext){return this._addCopiedRecordToParentCollection(copyContext).then({success:function(){this._onParentCollectionCopy(copyContext)},scope:this})},_onParentCollectionCopy:function(copyContext){var saveOptions=copyContext.saveOptions;saveOptions.success?copyContext.savedRecord.self.load(copyContext.savedRecord.getId(),{success:function(record,operation){copyContext.saveOptions.copyWithoutFlair||Rally.ui.notify.Notifier.showCreate({artifact:record}),Ext.callback(saveOptions.success,saveOptions.scope||this,[record,copyContext.saveOperation]),this._onCopyOperationComplete(copyContext.savedRecord,copyContext.saveOperation,copyContext)},scope:this,requester:copyContext.saveOptions.requester}):this._onCopyOperationComplete(copyContext.savedRecord,copyContext.saveOperation,copyContext)},_getParentRecord:function(record){if(record&&record.parentNode&&record.parentNode.parentNode)return record.parentNode},_addCopiedRecordToParentCollection:function(copyContext){var parentCollection,parentCollectionStore,parentRecord=this._getParentRecord(copyContext.originalRecord),parentCollections=[{collectionName:"Defects",parentTypePath:"DefectSuite",childTypePath:"Defect"}],copiedModel=copyContext.copiedRecord.self;return parentRecord&&(parentCollection=_.find(parentCollections,function(parentCollection){var parentTypePathMatches=parentCollection.parentTypePath.toLowerCase()===parentRecord.self.typePath.toLowerCase(),childTypePathMatches=parentCollection.childTypePath.toLowerCase()===copyContext.copiedRecord.self.typePath.toLowerCase();return!(!parentTypePathMatches||!childTypePathMatches)&&!_.isEmpty(parentRecord.get(parentCollection.collectionName))}))?(parentCollectionStore=parentRecord.getCollection(parentCollection.collectionName),parentCollectionStore.model=copiedModel,parentCollectionStore.getProxy().model=copiedModel,parentCollectionStore.getProxy().getReader().model=copiedModel,parentCollectionStore.add(copyContext.copiedRecord),parentCollectionStore.sync()):Deft.Promise.when(copyContext)},_onCopyFailure:function(record,operation,copyContext){this.showWsapiErrorNotification(copyContext.originalRecord,operation),Ext.callback(copyContext.saveOptions._failure,copyContext.saveOptions.scope,[copyContext.originalRecord||copyContext.copiedRecord,operation]),this._onCopyOperationComplete(copyContext.originalRecord,operation,copyContext)},_onCopyOperationComplete:function(record,operation,copyContext){var saveOptions=copyContext.saveOptions;unloadCount--,unloadCount<1&&(Ext.isDefined(unloadHandler)||(unloadHandler=null),window.onbeforeunload=unloadHandler),Ext.callback(saveOptions.callback,saveOptions.scope||this,[record,operation]),this.recordLoadEnd()},_onCopyUnload:function(){return"Copy operation is in progress. Navigation will result in inconsistent state."}})}(),function(){var Ext=window.Ext4||window.Ext,NO_DROP_CLASS="no-drop",DROP_CLASS="dnd-over";Ext.define("Rally.ui.cardboard.ColumnDropTarget",{extend:Ext.dd.DropTarget,ddGroup:"cardboard",dropAllowed:"cardboard",dropNotAllowed:"cardboard",column:void 0,row:void 0,dropIndicator:null,constructor:function(dropEl,config){this.mergeConfig(config),this.callParent([dropEl,this.config]),this.column.on("destroy",this._onColumnDestroy,this),this.column.on("beforecardrender",this._onBeforeCardRender,this)},notifyDrop:function(source,e,data){var index,samePlace=!1,column=this.column,card=column.getCard(data.card.getRecord()),cards=column.getCardsInRow(this.row),dropHandler=column.dropControllerPlugin;if(data.target&&data.target.position){var position=data.target.position;if("first"===position)data.target.card?index=0:samePlace=!0;else{var cardInfo=this.column.findCardInfo(data.target.card.record);cardInfo&&"before"===data.target.position?(index=cardInfo.index,samePlace=cards[index]===card||cards[index-1]===card):cardInfo&&"after"===data.target.position&&(index=cardInfo.index+1,samePlace=cards[index-1]===card||cards[index]===card,index>=cards.length&&(index=void 0))}samePlace||dropHandler.onCardDropped(this,data,index)}return this._removeAllExistingDropIndicators(),this._getTargetEl().removeCls(DROP_CLASS),this._getTargetEl().removeCls(NO_DROP_CLASS),!0},notifyEnter:function(source,e,data){this._getTargetEl().addCls(DROP_CLASS)},notifyOut:function(source,e,data){this._getTargetEl().removeCls(DROP_CLASS),this._getTargetEl().removeCls(NO_DROP_CLASS),this._removeAllExistingDropIndicators()},notifyOver:function(source,e,data){var column=this.column,cards=column.getCardsInRow(this.row);if(data.target=null,!column.mayRank()||!column.enableCrossColumnRanking&&data.column!==column){var index=column._getInsertIndex(data.card);0===index?cards[0]?this._addDropIndicatorBefore(cards[0],data):this._addDropIndicatorFirst(e.target,data):this._addDropIndicatorAfter(cards[index-1],data)}else{var mouseEventY=e.xy[1],found=_.some(cards,function(card){var cardContainerY=card.getEl().getY(),cardContainerHeight=card.getEl().getSize().height;return this._mouseIsOverCard(card,mouseEventY)?(mouseEventY-cardContainerY>cardContainerHeight/2?this._addDropIndicatorAfter(card,data):this._addDropIndicatorBefore(card,data),!0):this._mouseIsBeforeCard(card,mouseEventY)?(this._addDropIndicatorBefore(card,data),!0):void 0},this);if(!found)if(cards.length){var last=cards[cards.length-1];this._addDropIndicatorAfter(last,data)}else this._addDropIndicatorFirst(e.target,data)}data.target||(data.target={position:"first"})},_onColumnDestroy:function(){this.column.un("destroy",this._onColumnDestroy,this),this._removeAllExistingDropIndicators(),this.destroy()},_getTargetEl:function(){return Ext.get(this.getEl())},_onBeforeCardRender:function(){this._removeAllExistingDropIndicators()},_mouseIsOverCard:function(card,mouseEventY){var cardContainerY=card.getEl().getY(),cardContainerHeight=card.getEl().getSize().height;return cardContainerY<=mouseEventY&&cardContainerHeight+cardContainerY>=mouseEventY},_mouseIsBeforeCard:function(card,mouseEventY){var cardContainerY=card.getEl().getY();return mouseEventY<cardContainerY},_addDropIndicator:function(height){this.dropIndicator||(this.dropIndicator=Ext.getBody().createChild({cls:"rally-drop-indicator",style:{height:height+"px",display:"none"}}),this.dropIndicator.setVisibilityMode(Ext.dom.AbstractElement.DISPLAY))},_addDropIndicatorFirst:function(target,data){var eventTargetEl=Ext.fly(target),targetEl=null;targetEl=eventTargetEl.hasCls("column-content")?target:eventTargetEl.hasCls("rally-drop-indicator")?eventTargetEl.up(".column-content"):eventTargetEl.down(".column-content"),targetEl&&(this._addDropIndicator(data.card.getHeight()),data.target={card:data.card,position:"first"},this.dropIndicator.appendTo(targetEl),this.dropIndicator.setVisible(!0),this._refreshCache())},_addDropIndicatorAfter:function(card,data){card.id!==data.card.id&&card.getEl().next()!==data.card.getEl()?(this._addDropIndicator(data.card.getHeight()),data.target={card:card,position:"after"},this.dropIndicator.insertAfter(card.getEl()),this.dropIndicator.setVisible(!0),this._refreshCache()):this._removeAllExistingDropIndicators()},_addDropIndicatorBefore:function(card,data){card.id!==data.card.id&&card.getEl().prev()!==data.card.getEl()?(this._addDropIndicator(data.card.getHeight()),data.target={card:card,position:"before"},this.dropIndicator.insertBefore(card.getEl()),this.dropIndicator.setVisible(!0),this._refreshCache()):this._removeAllExistingDropIndicators()},_refreshCache:function(){var groupsToRefresh={};groupsToRefresh[this.ddGroup]=!0,Ext.dd.DragDropManager.refreshCache(groupsToRefresh)},_removeAllExistingDropIndicators:function(){this.dropIndicator&&(this.dropIndicator.destroy(),this.dropIndicator=null,this._refreshCache())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.ColumnDragZone",{extend:Ext.dd.DragZone,config:{cardDraggedCls:"dragged-card",column:null,row:null,ddGroup:null},containerScroll:{ddGroup:"cardboard",vthresh:100,animate:!1,frequency:100,increment:25},constructor:function(el,config){this.proxy=Ext.create("Ext.dd.StatusProxy",{animRepair:!0,shadow:!1,dropAllowed:"cardboard",dropNotAllowed:"cardboard"}),config.scrollEl&&config.scrollEl.on("scroll",function(){this._refreshCache()},this,{buffer:250}),this.callParent(arguments)},_refreshCache:function(){if(this.dragging){var groupsToRefresh={};groupsToRefresh[this.ddGroup]=!0,Ext.dd.DragDropManager.refreshCache(groupsToRefresh)}},onBeforeDrag:function(data,e){var avatar=Ext.fly(this.dragElId);avatar.setWidth(data.targetWidth),this.column.fireEvent("cardpickedup",data.card)},onDrag:function(){Ext.get(this.dragData.sourceEl).addCls(this.cardDraggedCls)},afterValidDrop:function(e,id){this.dragData.card.focus();var cardEl=this.dragData.card.getEl(),scrollEl=this.column.ownerCardboard.getScrollElement();if(scrollEl){var oldScrollTop=scrollEl.getScrollTop();cardEl.scrollIntoView(scrollEl),oldScrollTop!==scrollEl.getScrollTop()&&scrollEl.scroll("t",100)}this.dragData.card.removeCls(this.cardDraggedCls)},afterInvalidDrop:function(target,e,id){this.dragData.card.focus(),this.dragData.card.removeCls(this.cardDraggedCls)},afterRepair:function(){this.dragging=!1},getDragData:function(e){var dragEl=e.getTarget(".drag-handle",10);if(dragEl){var sourceEl=e.getTarget(".rui-card",10),avatar=sourceEl.cloneNode(!0);return avatar.id=Ext.id(),{targetWidth:Ext.fly(sourceEl).getWidth(),ddel:avatar,sourceEl:sourceEl,repairXY:Ext.fly(sourceEl).getXY(),card:Ext.ComponentManager.get(sourceEl.id),column:this.column,row:this.row}}},onMouseDown:function(){this.setDelta(this.dragData.card.getEl().getWidth(!0)/2,0)},getRepairXY:function(){return this.dragData.repairXY}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.ColumnDropController",{extend:Ext.AbstractPlugin,alias:"plugin.rallycolumndropcontroller",mixins:{messageable:Rally.Messageable},inheritableStatics:{cardDraggableCls:"drag-handle"},clientMetrics:[{method:"onCardDropped",description:"card dropped"},{beginEvent:"beforecarddroppedsave",endEvent:"aftercarddroppedsave",description:"card saved"}],init:function(column){this.callParent(arguments),column.dropControllerPlugin=this,column.on("rowadd",function(column,row){this._addDndForRow(row)},this),column.on("cardready",this.addDragDropHandle,this)},onCardDropped:function(target,dragData,index){this._cardBlocked=!1;var relativeCard,card=dragData.card,record=card.getRecord(),sourceColumn=dragData.column,sourceIndex=sourceColumn.findCardInfo(record).index,params={},column=target.column,row=target.row,sourceRow=dragData.row,isSameRow=row===sourceRow,isSameColumn=sourceColumn===column,cards=column.getCardsInRow(row);if(column.mayRank()&&isNaN(index)&&(index=cards.length),cards.length&&column.mayRank()&&(isSameColumn||column.enableCrossColumnRanking)){var rankParam=record.isTask()?"taskIndex":"rank";0===index?(relativeCard=cards[index],rankParam+="Above"):(relativeCard=cards[index-1],rankParam+="Below"),params[rankParam]=this.getRefForRelativeRecord(relativeCard.getRecord()),isSameColumn&&isSameRow&&index>sourceIndex&&index--}var currentReadyValue;!isSameColumn&&record.isFieldVisible("Ready")&&(currentReadyValue=record.get("Ready"),record.set("Ready",!1)),isSameRow||(record.set(row.fieldDef.name,row.getRowValue()),this._cardBlocked=record.getChanges().Blocked),column.addCard(card,index);var options={card:card,record:record,column:column,sourceColumn:sourceColumn,index:index,sourceIndex:sourceIndex,type:isSameColumn&&isSameRow?"reorder":"move",params:params,currentReadyValue:currentReadyValue,row:row,sourceRow:sourceRow};column.fireEvent("beforecarddroppedsave",column,card,options.type,sourceColumn)!==!1&&this.handleBeforeCardDroppedSave(options)},getRefForRelativeRecord:function(relativeRecord){return Rally.util.Ref.getRelativeUri(relativeRecord.get("_ref"))},handleBeforeCardDroppedSave:function(options){options.record.save({requester:options.column,callback:function(updatedRecord,operation){operation.success?this._onDropSaveSuccess(options.column,options.sourceColumn,options.card,updatedRecord,options.type):this._onDropSaveFailure(options.column,options.sourceColumn,options.currentReadyValue,options.record,options.card,options.sourceIndex,operation)},scope:this,params:Ext.apply({fetch:options.column.getAllFetchFields()},options.params)})},addDragDropHandle:function(card){this.canDragDropCard(card)&&card.addCls(this.self.cardDraggableCls)},canDragDropCard:function(card){return card.record.get("updatable")},_onDropSaveSuccess:function(column,sourceColumn,card,updatedRecord,type){this.publish(Rally.Message.objectUpdate,updatedRecord,[Rally.data.Ranker.getRankField(updatedRecord.self)],card),column.fireEvent("aftercarddroppedsave",column,card,type,sourceColumn),this._cardBlocked&&card.fireEvent("blocked")},_onDropSaveFailure:function(column,sourceColumn,currentReadyValue,record,card,sourceIndex,operation){Rally.data.util.Record.showWsapiErrorNotification(record,operation),record.set("Ready",currentReadyValue),sourceColumn.addCard(card,sourceIndex,!0)},enable:function(){this.callParent(arguments),_.each(this.cmp.getRows(),this._addDndForRow,this)},disable:function(){this.callParent(arguments),this._cleanUpDnd()},_addDndForRow:function(row){this._addDragZone(row),this._addDropTarget(row),row.on("destroy",this._removeDndForRow,this,{single:!0})},_removeDndForRow:function(row){if(row){var rowValue=row.getRowValue();this._destroyAndDelete(this.dropTargets,rowValue),this._destroyAndDelete(this.dragZones,rowValue)}},_destroyAndDelete:function(obj,key){obj&&obj[key]&&(obj[key].destroy(),delete obj[key])},_getDDGroup:function(col,row){return col.enableCrossRowDragging?col.ddGroup:col.ddGroup+"_"+row.getRowValue()},_addDropTarget:function(row){if(this.dropTargets=this.dropTargets||{},!this.dropTargets[row.getRowValue()]){var column=this.cmp;this.dropTargets[row.getRowValue()]=Ext.create("Rally.ui.cardboard.ColumnDropTarget",row.getContentCellFor(column).parent(),{ddGroup:this._getDDGroup(column,row),column:column,row:row})}},_addDragZone:function(row){if(this.dragZones=this.dragZones||{},!this.dragZones[row.getRowValue()]){var column=this.cmp;this.dragZones[row.getRowValue()]=Ext.create("Rally.ui.cardboard.ColumnDragZone",row.getContentCellFor(column).parent(),{column:column,row:row,ddGroup:this._getDDGroup(column,row),scrollEl:column.ownerCardboard.getScrollElement()})}},_cleanUpDnd:function(){_.invoke(_.values(this.dragZones),"destroy"),delete this.dragZones,_.invoke(_.values(this.dropTargets),"destroy"),delete this.dropTargets},destroy:function(){this.callParent(arguments),this._cleanUpDnd()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.predicate.RecordPredicates",{singleton:!0,isArtifact:function(record){return record.self.isArtifact()},isRankable:function(record){return record.isRankable()},isUpdatable:function(record){return record.isUpdatable()},isUserStory:function(record){return record.isUserStory()},isTestSet:function(record){return record.isTestSet()},canHaveChildren:function(record){return record.canHaveChildren()},canHaveTasks:function(record){return record.canHaveTasks()},canHaveDefects:function(record){return record.canHaveDefects()},canHaveTestCases:function(record){return record.canHaveTestCases()},canHaveTestCaseResults:function(record){return record.canHaveTestCaseResults()},passesAllPredicates:function(predicates,record){return _.every(predicates,function(predicate){return predicate(record)})},passesSomePredicates:function(predicates,record){return _.some(predicates,function(predicate){return predicate(record)})},mustPassAllPredicates:function(predicates){return _.partial(this.passesAllPredicates,predicates)},mustPassSomePredicates:function(predicates){return _.partial(this.passesSomePredicates,predicates)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.LabeledFieldTemplate",{config:{valueTemplate:null,fieldLabel:null},constructor:function(config){this.mergeConfig(config)},apply:function(values){var valueStr=this.valueTemplate.apply(values);if(valueStr.length<1)return valueStr;var renderedValue=['<div class="rui-field-value">',valueStr,"</div>"];return this.fieldLabel&&(renderedValue=['<span class="rui-field-label">',Ext.htmlEncode(this.fieldLabel),":</span>"].concat(renderedValue)),renderedValue.join("")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.StatusFieldTemplate",{config:{valueTemplate:null},constructor:function(config){this.mergeConfig(config)},apply:function(values){var valueStr=this.valueTemplate.apply(values);return valueStr?['<div class="rui-field-value">',valueStr,"</div>"].join(""):valueStr}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.CardRendererFactory",{singleton:!0,rendererCache:{},unlabeledFields:["Name","PercentDoneByStoryCount","PercentDoneByStoryPlanEstimate","UserStories","ScheduleState","StateChangedDate","Milestones","PredecessorsAndSuccessors"],getRenderTemplate:function(field){if(!field.attributeDefinition||!Ext.isNumeric(field.attributeDefinition.ObjectID))return this._getRenderTemplate(field);var key=field.attributeDefinition.ObjectID;return this.rendererCache.hasOwnProperty(key)||(this.rendererCache[key]=this._getRenderTemplate(field)),this.rendererCache[key]},isStatusField:function(field){return _.contains(["Tasks","Defects","Discussion","TestCases"],field.name)},_getRenderTemplate:function(field){var valueTemplate=this._getRenderer(field);return this.isStatusField(field)?Ext.create("Rally.ui.renderer.template.StatusFieldTemplate",{valueTemplate:valueTemplate}):Ext.create("Rally.ui.renderer.template.LabeledFieldTemplate",{fieldLabel:_.contains(this.unlabeledFields,field.name)?null:Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(field),valueTemplate:valueTemplate})},_getRenderer:function(field){var renderer=null,fieldKey=field.name;return renderer=this.fieldRenderers.hasOwnProperty(fieldKey)?this.fieldRenderers[fieldKey](field):field.attributeDefinition&&this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()]?this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()](field):field.attributeDefinition&&this.typeRenderers[field.attributeDefinition._refObjectName]?this.typeRenderers[field.attributeDefinition._refObjectName](fieldKey):Rally.ui.renderer.RendererFactory.getRenderTemplate(field)},fieldRenderers:{Parent:function(){return Ext.create("Rally.ui.renderer.template.ParentTemplate")},PercentDoneByStoryCount:function(){return Ext.create("Rally.ui.renderer.template.progressbar.PercentDoneByStoryCountTemplate",{showOnlyIfInProgress:!0})},PercentDoneByStoryPlanEstimate:function(){return Ext.create("Rally.ui.renderer.template.progressbar.PercentDoneByStoryPlanEstimateTemplate",{showOnlyIfInProgress:!0})},PortfolioItem:function(){return Ext.create("Rally.ui.renderer.template.ParentTemplate")},Defects:function(){return Ext.create("Rally.ui.renderer.template.CardDefectSummaryTemplate")},Tasks:function(){return Ext.create("Rally.ui.renderer.template.CardTaskSummaryTemplate")},TestCases:function(){return Ext.create("Rally.ui.renderer.template.CardTestCaseSummaryTemplate")},Discussion:function(){return Ext.create("Rally.ui.renderer.template.CardDiscussionSummaryTemplate")},Children:function(){return Ext.create("Rally.ui.renderer.template.CardChildrenSummaryTemplate")},EmailAddress:function(){return Ext.create("Ext.XTemplate",'<a href="mailto:{EmailAddress}">{EmailAddress}</a>')},UserStories:function(){return Ext.create("Rally.ui.renderer.template.CardUserStoriesTemplate")},PredecessorsAndSuccessors:function(){return Ext.create("Rally.ui.renderer.template.CardDependenciesTemplate")},Tags:function(){return Ext.create("Rally.ui.renderer.template.TagPillTemplate",{isBoard:!0})}},typeRenderers:{boolean:function(field){return Ext.create("Rally.ui.renderer.template.BooleanYesNoTemplate",{fieldName:field.name})},feature:function(featureAttributeName){return Ext.create("Rally.ui.renderer.template.FeatureTemplate",{attributeName:featureAttributeName})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.StringTemplate",{extend:Ext.XTemplate,fieldName:"",titleCase:!1,toSpace:[],constructor:function(config){var templateConfig=["{[this.formatString(values)]}",{formatString:function(values){var value=values[this.fieldName];if(!value)return"";if(value=Rally.util.String.fixMarkup(value),!_.isEmpty(this.toSpace)){var regex=new RegExp("["+this.toSpace.join()+"]","g");value=value.replace(regex," ")}return this.titleCase&&(value=Rally.util.String.toTitleCase(value)),value}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.FormattedIDTemplate",{extend:Ext.XTemplate,showIcon:!0,renderIdAsText:!1,constructor:function(config){return this.callParent(['<span class="formatted-id-template">{[this.createIdValue(values)]}</span>',config])},createIdValue:function(data){return data.Recycled||this.renderIdAsText?this.createTextValue(data):this.createDetailLink(data)},createTextValue:function(data){return this.createIcon(data)+Ext.create("Rally.ui.renderer.template.StringTemplate",{fieldName:"FormattedID"}).apply(data)},createDetailLink:function(data){var options={record:data,text:this.createIcon(data)+(data.FormattedID||""),showHover:!!this.showHover},ref=Rally.util.Ref.getRelativeUri(data),type=Rally.util.Ref.getTypeFromRef(ref);if("testset"===type)ref&&(options.onclick="Rally.nav.Manager.edit('"+ref+"'); return false;");else if("milestone"===type){var projectToNavigateTo=data.TargetProject||data.context.getProject();options.projectOid=Rally.util.Ref.getOidFromRef(projectToNavigateTo)}return Rally.nav.DetailLink.getLink(options)},createIcon:function(data){if(this.showIcon===!1)return"";var type=Rally.util.Ref.getTypeFromRef(data),typeName=Rally.util.TypeInfo.normalizeTypeName(type),typeInfo=Rally.util.TypeInfo.getTypeInfoByName(typeName),className=typeInfo&&typeInfo.icon,colorAttr="milestone"===typeName&&data.DisplayColor?' style="color: '+data.DisplayColor+';"':"";return className?'<span class="artifact-icon '+className+'"'+colorAttr+"></span>":""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardContentLeft",{alias:"plugin.rallycardcontentleft",extend:Ext.AbstractPlugin,mixins:{observable:Ext.util.Observable},nonDisplayableFields:["PlanEstimate","FormattedID","Owner","PreliminaryEstimate","Estimate"],footerFields:["PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","UserStories","PredecessorsAndSuccessors","Milestones"],statics:{getIdTpl:function(){return this.idTpl||(this.idTpl=Ext.create("Rally.ui.renderer.template.FormattedIDTemplate")),this.idTpl},getHeaderTpl:function(){return this.headerTpl||(this.headerTpl=Ext.create("Ext.XTemplate",['<div class="left-header">','<div class="id" style="min-width: {idWidth}px">{formattedId}</div>','<tpl if="owner"><div class="owner-name">{owner}</div></tpl>',"</div>"])),this.headerTpl}},constructor:function(config){this.addEvents("fieldclick"),this.callParent(arguments),this.mixins.observable.constructor.call(this)},init:function(card){this.callParent(arguments),this.card=card,card.contentLeftPlugin=this,card.on("afterrender",this._onAfterRender,this),card.on("rerender",this._onAfterRender,this),card.on("beforedestroy",this._onBeforeDestroy,this),card.relayEvents(this,["fieldclick"])},destroy:function(){this.card&&(this.detachListeners(),delete this.card.contentLeftPlugin,delete this.card),this.callParent(arguments)},detachListeners:function(){this.card&&this.card.getEl()&&this.card.getEl().down(".rui-card-content").un("click",this._onClick,this)},getDisplayedFields:function(){return this.card.getFieldNames()},getHtml:function(){var contentHtml=[],statusHtml=[];_.each(_.filter(this.card.getFieldDefinitions(),function(fieldDefinition){return this._isDisplayableField(fieldDefinition.name)&&!this._isFieldHandledByPlugin(fieldDefinition.name)},this),function(fieldDefinition){var fieldHtml=this._getFieldHtml(fieldDefinition);fieldHtml&&(this._isStatusField(fieldDefinition)?statusHtml.push(fieldHtml):contentHtml.push(fieldHtml))},this);var result=[];return result.push('<td class="rui-card-content">'),result.push(this.getCardHeader()),result.push(contentHtml.join("\n")),result.push(this.getCardFooter()),this._isFieldHandledByPlugin("BlockedReason")&&result.push(this._getBlockedReasonContent()),result.push('<div class="status-content">'),result.push(statusHtml.join("\n")),result.push("</div></td>"),result.join("\n")},_isFieldHandledByPlugin:function(fieldName){return"BlockedReason"===fieldName&&this.card.blockedReasonPlugin&&!this.card.blockedReasonPlugin.isBlockedOrBlockedReasonHidden()},_isDisplayableField:function(fieldName){return!_.contains(this.nonDisplayableFields.concat(this.footerFields),fieldName)},_isStatusField:function(fieldDefinition){return fieldDefinition.hasOwnProperty("isStatus")?fieldDefinition.isStatus:Rally.ui.cardboard.CardRendererFactory.isStatusField(fieldDefinition)},addField:function(fieldDefinition){var fieldHtml=this._getFieldHtml(fieldDefinition);fieldHtml&&(this._isStatusField(fieldDefinition)?this._getStatusContent().createChild(fieldHtml):this._getCardContent().createChild(fieldHtml,this._getStatusContent()))},getFieldEl:function(fieldName){return this.card.getEl().down(".field-content."+fieldName)},refreshField:function(fieldName){if(!_.contains(this.nonDisplayableFields,fieldName)){var el=this.getFieldEl(fieldName),tpl=this._getRenderTpl({name:fieldName});el&&tpl&&el.update(tpl.apply(this.card.getRecord().getData()))}},_getRenderTpl:function(fieldDefinition){var card=this.card,modelField=card.getRecord().getField(fieldDefinition.name),hasData=Ext.isFunction(fieldDefinition.hasValue)&&fieldDefinition.hasValue()||card.getRecord().hasValue(modelField),isRenderable=hasData||modelField&&(modelField.isCollection()||modelField.virtual);return modelField&&modelField.isHidden?null:isRenderable?!fieldDefinition.renderTpl&&modelField?Rally.ui.cardboard.CardRendererFactory.getRenderTemplate(modelField):fieldDefinition.renderTpl:null},_getFieldHtml:function(fieldDefinition){var html="",cls="",typeCls="",tpl=this._getRenderTpl(fieldDefinition);if(tpl&&(html=tpl.apply(Ext.apply({context:this.card.getContext()},this.card.getRecord().getData())))){cls=this._isStatusField(fieldDefinition)?"status-field ":"";var field=this.card.getRecord().self.getField(fieldDefinition.name);field&&field.attributeDefinition&&(typeCls=" type-"+field.attributeDefinition.AttributeType.toLowerCase()),html='<div class="field-content '+cls+fieldDefinition.name+typeCls+'">'+html+"</div>"}return html},_getCardContent:function(){return this.card.getEl().down(".rui-card-content")},_getStatusContent:function(){return this._getCardContent().down(".status-content")},_getBlockedReasonContent:function(){
return this.card.blockedReasonPlugin?this.card.blockedReasonPlugin.getHtml():""},getCardHeader:function(){var record=this.card.getRecord(),formattedId=record.get("FormattedID"),data={};return formattedId?(data.idWidth=20+8*formattedId.length,data.formattedId=this.self.getIdTpl().apply(record.data),data.owner=record.get("Owner")?record.get("Owner")._refObjectName:null,this.self.getHeaderTpl().apply(data)):""},getCardFooter:function(){var footerHtml=_.reduce(this.footerFields,function(html,fieldName){var fieldDefinition=_.find(this.card.getFieldDefinitions(),function(fieldDefinition){return fieldDefinition.name===fieldName});return fieldDefinition?html+this._getFieldHtml(fieldDefinition)+"\n":html},"",this);return footerHtml.length?'<div class="card-footer">'+footerHtml+"</div>":""},_onAfterRender:function(){this._getCardContent().on("click",this._onClick,this),this.card.getEl().down(".formatted-id-template")&&this.card.getEl().down(".formatted-id-template").on("mouseenter",this.card.popoverPlugin.showDescription,this.card.popoverPlugin)},_onBeforeDestroy:function(){this.card&&this.card.getEl()&&this.card.getEl().down(".id")&&this.card.getEl().down(".formatted-id-template").un("mouseenter",this.card.popoverPlugin.showDescription,this.card.popoverPlugin)},_onClick:function(e){var target=e.getTarget(".field-content",this._getCardContent(),!1);if(target){var classNames=target.className.split(" "),fieldName=_.find(classNames,function(className){return!_.contains(["field-content","status-field"],className)});Ext.isDefined(fieldName)&&!_.contains(classNames,"editable")&&this._onFieldClick(fieldName.replace(/Summary$/,""),e,target)}},_onFieldClick:function(fieldName){this.fireEvent("fieldclick",fieldName,this.card)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.User",{singleton:!0,getProfileImageUrl:function(imageSize,userRef){return Ext.isNumber(window.devicePixelRatio)&&(imageSize=Ext.util.Format.round(imageSize*window.devicePixelRatio,0)),Rally.environment.getServer().getContextUrl()+"/profile/image/"+Rally.util.Ref.getOidFromRef(userRef)+"/"+imageSize+".sp"},getNoOwnerImageUrl:function(){return Rally.environment.getServer().getImagesPath()+"/cardboard/no-owner.png"},noOwnerValue:"/user/-1"})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardOwnerImageTemplate",{extend:Ext.XTemplate,inheritableStatics:{OWNER_IMAGE_EL_CLS:"card-owner-img"},config:{editable:!1},constructor:function(config){this.initConfig(config),this.callParent(['<div class="card-owner-field">','<div class="field-content Owner">','<div class="rui-field-value" title="{[this.getOwnerTitle(values)]}">','<img class="{[this.getOwnerCls(values)]}" src="{[this.getProfileImageSrc(values)]}">',"</div>","</div>","</div>",{getOwnerCls:function(recordData){var cls=[Rally.util.Test.toBrowserTestCssClass(Rally.util.Ref.getOidFromRef(recordData.Owner)||"none"),Rally.ui.renderer.template.CardOwnerImageTemplate.OWNER_IMAGE_EL_CLS];return this.editable&&cls.push("editable"),cls.join(" ")},getOwnerTitle:function(recordData){var title=recordData.Owner?Ext.String.htmlEncode(recordData.Owner._refObjectName):"No Owner";return this.editable&&(title+=". Change owner..."),title},getProfileImageSrc:function(recordData){return recordData.Owner?Rally.util.User.getProfileImageUrl(25,recordData.Owner):Rally.util.User.getNoOwnerImageUrl()}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardPlanEstimateTemplate",{extend:Ext.XTemplate,constructor:function(fieldValue,fieldName,additionalClass){var fieldValueCls="rui-field-value";additionalClass&&(fieldValueCls+=" "+additionalClass),this.callParent(['<div class="card-estimate-field">','<div class="field-content '+fieldName+'">','<div class="'+fieldValueCls+'">',fieldValue,"</div>","</div>","</div>"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardContentRight",{alias:"plugin.rallycardcontentright",extend:Ext.AbstractPlugin,clientMetrics:[{method:"_onOwnerClick",description:"owner field on card clicked"}],inheritableStatics:{BOTTOM_SIDE_CLS:"right-bottom-side",TOP_SIDE_CLS:"right-top-side"},init:function(card){this.card=card,card.contentRightPlugin=this,this._fieldNameToDisplay=this._getEstimateFieldName(),card.on("afterrender",this._onAfterRender,this),card.on("rerender",this._onAfterRender,this),card.on("validitychange",this._onValidityChange,this)},_initializePreliminaryEstimateStore:function(){this.cardboard.preliminaryEstimateStore=Ext.create("Rally.data.wsapi.Store",{model:Ext.identityFn("PreliminaryEstimate"),autoLoad:!0})},_hasField:function(columnName){return this.card.getRecord().hasField(columnName)&&_.some(this.card.getFields(),function(field){return field===columnName||field.name===columnName})},_getEstimateFieldName:function(){var me=this;return _.find(["PlanEstimate","PreliminaryEstimate","Estimate"],function(fieldName){return me._hasField(fieldName)})},getDisplayedFields:function(){var fields=["Owner"];return this._fieldNameToDisplay&&fields.push(this._fieldNameToDisplay),fields},getHtml:function(){this._initCurrentEstimate();var tplData=Ext.clone(this.card.getRecord().data);return this.getTpl().apply(tplData)},getTpl:function(){if(!this.tpl){var me=this;this.tpl=Ext.create("Ext.XTemplate",['<td class="{[this.getTplClass()]}">','<div class="{[Rally.ui.cardboard.plugin.CardContentRight.TOP_SIDE_CLS]}">',"{[this.getTopTpl(values)]}","</div>",'<div class="{[Rally.ui.cardboard.plugin.CardContentRight.BOTTOM_SIDE_CLS]}">{[this.getBottomTpl(values)]}</div>',"</td>",{getTplClass:function(){var cls="rui-card-right-side";return me._shouldShowEstimate()&&(cls+=" has-estimate"),cls},getTopTpl:function(recordData){return Ext.create("Rally.ui.renderer.template.CardOwnerImageTemplate",{editable:me.card.getRecord().get("updatable")}).apply(recordData)},getBottomTpl:function(recordData){var additionalClass;if(me._shouldShowEstimate())return me._currentEstimate.needsValue&&(additionalClass="no-estimate"),me.card.addCls("rui-card-swipe"),Ext.create("Rally.ui.renderer.template.CardPlanEstimateTemplate",me._currentEstimate.value,me._fieldNameToDisplay,additionalClass).apply(recordData)}}])}return this.tpl},_removeTooltip:function(){this.estimateTooltip&&this.estimateTooltip.destroy()},_onAfterRender:function(){this.card.getRecord().get("updatable")&&this.card.getEl().down(".card-owner-img").on("click",this._onOwnerClick,this),this.cardboard=this.card.ownerColumn&&this.card.ownerColumn.ownerCardboard,this._removeTooltip();var cardEstimateField=this.card.getEl().down(".card-estimate-field");cardEstimateField&&this._shouldShowEstimate()&&(this.estimateTooltip=Ext.create("Rally.ui.tooltip.ToolTip",{target:cardEstimateField,hideDelay:100,anchor:"left",mouseOffset:[2,2],html:this._getTooltipHtml(),listeners:{beforeShow:function(){return!this.target.down(".rally-invalid-field")}}}),cardEstimateField.on("click",function(){this.estimateTooltip.hide()},this))},_onValidityChange:function(card,field,isValid){!isValid&&this.estimateTooltip&&this.estimateTooltip.hide()},_onOwnerClick:function(){this.card.fireEvent("fieldclick","Owner",this.card)},_initCurrentEstimate:function(){var currentEstimate,field;this._fieldNameToDisplay&&(currentEstimate={},field=this.card.getRecord().get(this._fieldNameToDisplay),field&&field._refObjectName?currentEstimate.value=field._refObjectName:Ext.isNumber(field)&&(currentEstimate.value=field),void 0===currentEstimate.value&&(currentEstimate.value="+",currentEstimate.needsValue=!0)),this._currentEstimate=currentEstimate},_shouldShowEstimate:function(){return!!this._fieldNameToDisplay&&(this.card.getRecord().get("updatable")||!this._currentEstimate.needsValue)},_getTooltipHtml:function(){if(this._fieldNameToDisplay){if(this._currentEstimate.needsValue)return"<strong>Set "+this.card.getRecord().getField(this._fieldNameToDisplay).displayName+"</strong>";if("PlanEstimate"===this._fieldNameToDisplay)return this._getPlanEstimateTooltip();if("Estimate"===this._fieldNameToDisplay)return this._getTaskEstimateTooltip();if("PreliminaryEstimate"===this._fieldNameToDisplay&&this.cardboard){if(this.cardboard.preliminaryEstimateStore||this._initializePreliminaryEstimateStore(),this.cardboard.preliminaryEstimateStore.count())return this._getPreliminaryEstimateTooltip();this.cardboard.preliminaryEstimateStore.on("load",function(){this.estimateTooltip.update(this._getPreliminaryEstimateTooltip())},this,{single:!0})}}},_getPlanEstimateTooltip:function(){var units=Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.IterationEstimateUnitName;return"Plan Estimate ("+units+")"},_getTaskEstimateTooltip:function(){var units=Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.TaskUnitName;return"Estimate ("+units+")"},_getPreliminaryEstimateTooltip:function(){var points,name=this._currentEstimate.value,estimate=_.find(this.cardboard.preliminaryEstimateStore.data.items,function(item){return item.data.Name===name});return estimate?(points=estimate.data.Value,"<div><strong>Preliminary Estimate</strong></div><div>"+estimate.data.Description+" = "+points+" Point"+(1!==points?"s":"")+"</div>"):"Preliminary Estimate: "+name},destroy:function(){this.card&&this.card.getEl()&&this.card.getEl().down(".card-owner-img").un("click",this._onOwnerClick,this),this._removeTooltip(),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.DateField",{requires:[],extend:Ext.form.field.Date,alias:"widget.rallydatefield",componentCls:"rui-triggerfield",constructor:function(config){Ext.applyIf(config,{format:Rally.util.DateTime.getUserExtDateFormat()}),this.callParent(arguments)},initComponent:function(){this.addEvents("aftervalidate"),this.callParent(arguments)},valueToRaw:function(value){return this.callParent(arguments)||""},rawToValue:function(rawValue){if(Rally.environment.useSystemTimezone||Rally.environment.useWorkspaceTimeZone)return this.callParent(arguments);var rawValueAsDate=this.parseDate(rawValue);if(!rawValueAsDate)return rawValue;var yearMonthDay=Ext.Date.format(rawValueAsDate,"c").split("T")[0],hourMinuteSecondTimezone=Ext.Date.format(rawValueAsDate,"c").split("T")[1],d=Ext.Date.parse(yearMonthDay+"T"+hourMinuteSecondTimezone,"c");return this.originalValue&&(d.setHours(this.originalValue.getHours()),d.setMinutes(this.originalValue.getMinutes()),d.setSeconds(this.originalValue.getSeconds())),d},onRender:function(){this.callParent(arguments),this.triggerEl.addCls("icon-calendar")},validateValue:function(value){var isValid=this.callParent(arguments);return this.fireEvent("aftervalidate",this,isValid),isValid},createPicker:function(){var me=this,format=Ext.String.format,WORKSPACE_TIMEZONE_TOGGLE=Rally.environment.useWorkspaceTimeZone;return WORKSPACE_TIMEZONE_TOGGLE&&(me.showToday=!1),new Ext.picker.Date({pickerField:me,ownerCt:me.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,focusOnToFront:!1,shadow:!1,minDate:me.minValue,maxDate:me.maxValue,disabledDatesRE:me.disabledDatesRE,disabledDatesText:me.disabledDatesText,disabledDays:me.disabledDays,disabledDaysText:me.disabledDaysText,format:me.format,showToday:me.showToday,startDay:me.startDay,minText:format(me.minText,me.formatDate(me.minValue)),maxText:format(me.maxText,me.formatDate(me.maxValue)),cls:"rally-date-picker",listeners:{scope:me,beforerender:function(picker){WORKSPACE_TIMEZONE_TOGGLE&&picker.addCls("rally-date-picker-use-workspace-time")},afterrender:function(picker){var header=picker.getEl().down("."+Ext.baseCSSPrefix+"datepicker-header");header.down("."+Ext.baseCSSPrefix+"datepicker-prev").addCls("icon-chevron-left"),header.down("."+Ext.baseCSSPrefix+"datepicker-next").addCls("icon-chevron-right"),WORKSPACE_TIMEZONE_TOGGLE||picker.getEl().down("."+Ext.baseCSSPrefix+"datepicker-footer ."+Ext.baseCSSPrefix+"btn").addCls("secondary small")},show:function(picker){WORKSPACE_TIMEZONE_TOGGLE&&(Ext.isDate(this.rawToValue(this.rawValue))?picker.removeCls("rally-date-picker-no-date-selected"):picker.addCls("rally-date-picker-no-date-selected"))},select:me.onSelect},keyNavConfig:{esc:function(){me.collapse()},backspace:function(e){e.stopEvent()}},createMonthPicker:function(){var me=this,picker=me.monthPicker;return this.picker||(me.monthPicker=picker=new Ext.picker.Month({renderTo:me.el,floating:!0,padding:me.padding,shadow:!1,small:me.showToday===!1,listeners:{scope:me,afterrender:function(picker){var monthPickerButtons=picker.getEl().down("."+Ext.baseCSSPrefix+"monthpicker-buttons");monthPickerButtons.down("."+Ext.baseCSSPrefix+"btn:first-child").addCls("primary small"),monthPickerButtons.down("."+Ext.baseCSSPrefix+"btn:last-child").addCls("secondary small"),picker.getEl().down("."+Ext.baseCSSPrefix+"monthpicker-yearnav-prev").addCls("icon-chevron-left"),picker.getEl().down("."+Ext.baseCSSPrefix+"monthpicker-yearnav-next").addCls("icon-chevron-right")},cancelclick:me.onCancelClick,okclick:me.onOkClick,yeardblclick:me.onOkClick,monthdblclick:me.onOkClick}}),me.disableAnim||picker.el.setStyle("display","none"),me.on("beforehide",Ext.Function.bind(me.hideMonthPicker,me,[!1]))),picker}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.NumberField",{requires:[],extend:Ext.form.field.Number,alias:"widget.rallynumberfield",componentCls:"rui-triggerfield",allowExponential:!1,onSpinUp:function(){this.callParent(arguments),this._focusInputEl()},onSpinDown:function(){this.callParent(arguments),this._focusInputEl()},onBlur:function(){this.callParent(arguments),this._preventBlur&&(this.inputEl.focus(),delete this._preventBlur)},_focusInputEl:function(){this._preventBlur=!0,this.inputEl.focus()},onRender:function(){this.callParent(arguments),this.spinUpEl.addCls("icon-full-arrow-up"),this.spinDownEl.addCls("icon-full-arrow-down")}})}(),function(){var Ext=window.Ext4||window.Ext,NULL_REF="null";Ext.define("Rally.ui.combobox.FieldValueComboBox",{alias:["widget.rallyfieldvaluecombobox","widget.rallyattributecombobox"],alternateClassName:"Rally.ui.combobox.AttributeComboBox",extend:Rally.ui.combobox.ComboBox,config:{model:void 0,field:void 0,context:void 0,storeConfig:{autoLoad:!0},useNullForNoEntryValue:!1,allowInitialValue:!1,queryMode:"local",editable:!0,typeAhead:!0,forceSelection:!0,selectOnFocus:!0,valueField:"value",displayField:"name",ratingNoEntryString:"None",noEntryValue:""},constructor:function(config){return config.field&&(config.field=Ext.clone(config.field)),this.mergeConfig(config),this.store=Ext.create("Ext.data.Store",{fields:[this.valueField,this.displayField],data:[]}),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.storeConfig&&this.storeConfig.listeners&&this.store.on(this.storeConfig.listeners),_.isString(this.model)?this._fetchModel():this.storeConfig&&this.storeConfig.autoLoad?(_.isString(this.field)&&(this.field=this.model.getField(this.field)),this._populateStore()):this.onReady()},refreshStore:function(){this._populateStore()},setValue:function(value){this.callParent([this.transformOriginalValue(value)])},setField:function(field){this.field===field&&this.store.getCount()||(this.field=field,this._loadStoreValues())},transformOriginalValue:function(value){var val=value;return value&&value._ref&&(val=value._ref),val},setContextFromRecord:function(record){this.model=record.self,this.field=record.self.getField(_.isString(this.field)?this.field:this.field.name),this.context={project:Rally.util.Ref.getRelativeUri(record.get("Project"))},this._loadStoreValues()},_fetchModel:function(){Rally.data.ModelFactory.getModel({context:this.context,type:this.model,success:this._onModelRetrieved,scope:this})},_onModelRetrieved:function(model){this.model=model,this.field=this.model.getField(this.field),this.storeConfig&&this.storeConfig.autoLoad?this._populateStore():this.onReady()},_populateStore:function(){this.field||Ext.Error.raise("field config must be specified when creating a Rally.ui.combobox.FieldValueComboBox"),this._loadStoreValues()},_loadStoreValues:function(){this.field.getAllowedValueStore({context:this.context&&_.isFunction(this.context.getDataContext)?this.context.getDataContext():this.context}).load({requester:this,callback:function(records,operation,success){var store=this.store;if(store){var values=[],labelValues=_.map(_.filter(records,this._hasStringValue),this._convertAllowedValueToLabelValuePair,this);if("boolean"===this.field.getType())labelValues=labelValues.concat([this._convertToLabelValuePair("Yes",!0),this._convertToLabelValuePair("No",!1)]);else if(this.field.required===!1){var name="-- No Entry --",value=this.noEntryValue;this.getUseNullForNoEntryValue()&&(this.noEntryValue=value=null),"rating"===this.field.attributeDefinition.AttributeType.toLowerCase()&&(name=this.getRatingNoEntryString(),value="None"),values.push(this._convertToLabelValuePair(name,value))}if(this.getAllowInitialValue()&&this.config.value){var initialValue=this.transformOriginalValue(this.config.value);if(this._valueNotInAllowedValues(initialValue,labelValues)){var label=this.config.value._refObjectName||initialValue;values.push(this._convertToLabelValuePair(label,initialValue))}}store.loadRawData(values.concat(labelValues)),store.fireEvent("load",store,store.getRange(),success)}},scope:this})},_valueNotInAllowedValues:function(value,labelValues){return value&&!_.contains(_.pluck(labelValues,this.valueField),value)},_hasStringValue:function(allowedValueObject){return""!==allowedValueObject.get("StringValue")},_convertAllowedValueToLabelValuePair:function(allowedValueObject){var stringValue=allowedValueObject.get("StringValue");return ref=allowedValueObject.get("_ref"),this._convertToLabelValuePair(stringValue,ref===NULL_REF?stringValue:ref)},_convertToLabelValuePair:function(label,value){var allowedValue={};return allowedValue[this.valueField]=value,allowedValue[this.displayField]=label,allowedValue},onReady:function(){this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},isEmpty:function(){var value=this.getValue();return _.isEmpty(value)||value===this.getNoEntryValue()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.MilestoneProjectComboBox",{alias:"widget.rallymilestoneprojectcombobox",extend:Rally.ui.combobox.ComboBox,cls:"milestone-project-combo-box",config:{autoExpand:!0,queryMode:"local",dialogOpen:!1,selectOnFocus:!0,storeConfig:{autoLoad:!0,limit:1/0,model:Ext.identityFn("WritableProject"),remoteFilter:!1,sorters:{property:"Name",direction:"ASC"}}},constructor:function(config){var me=this;this.callParent([_.merge({tpl:Ext.create("Ext.XTemplate",'<tpl if="this.showHelperText()">','<div class="milestone-project-helper-text">Milestones will be available for<br />ALL CHILD PROJECTS.</div>',"</tpl>",'<tpl for=".">','<div class="'+Ext.buildSettings.baseCSSPrefix+'boundlist-item">{[values._refObjectName]}</div>',"</tpl>",{showHelperText:function(){return!me.queryFilter}})},config)])},initComponent:function(){this._setContextSpecificFields((this.context||Rally.environment.getContext()).getWorkspace().Name),this.callParent(arguments)},expand:function(){this.milestoneRecord?this.dialogOpen||(this.dialogOpen=!0,Rally.ui.MilestoneTargetProjectPermissionsHelper.confirmEditIfRequired(this.milestoneRecord).then({success:function(continueEditing){continueEditing&&this.self.superclass.expand.call(this),this.dialogOpen=!1},scope:this})):this.callParent(arguments)},setContextFromRecord:function(record,columnDataIndex,dataContext){var workspaceRef=Rally.util.Ref.getRelativeUri(dataContext.workspace);workspaceRef!==Rally.util.Ref.getRelativeUri(Rally.environment.getContext().getWorkspace()._ref)&&this._setContextSpecificFields("Workspace",workspaceRef),this.reloadStoreWithNewProject(dataContext.project)},_setContextSpecificFields:function(workspaceName,workspaceRef){this.allowNoEntry=Rally.environment.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin(workspaceRef),this.noEntryText="All Projects in "+workspaceName}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.RefsToRecords",{convert:function(refs,options){var refObjs=_.map(refs,function(ref){return Ext.create("Rally.util.Ref",ref)},this);return this.requester=options&&options.requester||this,this._loadRecords(refObjs)},_getModelFromRefs:function(refObjs){return _.reduce(refObjs,function(modelName,refObj){var typeName=refObj.getType();return null!==modelName&&modelName!==typeName?(Ext.warn("All refs must match type "+type+". Skipping type "+typeName),modelName):typeName},null)},_loadRecords:function(refObjs){return Ext.create("Rally.data.wsapi.Store",{model:this._getModelFromRefs(refObjs),filters:this._getFilterFromRefs(refObjs),requester:this.requester}).load()},_getFilterFromRefs:function(refObjs){var filterCfgs=_.map(refObjs,function(refObj){return{property:"ObjectID",operator:"=",value:refObj.getOid()}});return Rally.data.wsapi.Filter.or(filterCfgs)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.UserSearchComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyusersearchcombobox",config:{noEntryText:"-- No Owner --",cls:"rally-user-combobox",shadow:!1,selectOnTab:!1,alwaysExpanded:!1,queryMode:"remote",minChars:0,emptyText:"Search all users...",project:void 0,listConfig:{cls:"rally-user-combobox-boundlist",overflowX:"hidden",emptyText:"No matching users"},allowNoEntry:!0,defaultSelectionPosition:null,teamMembersHeaderTitle:"Team Members",includeWorkspaceUsers:!1},storeMode:"teamMembershipStoreMode",TEAM_MEMBERSHIP_STORE_MODE:"teamMembershipStoreMode",USER_SEARCH_STORE_MODE:"userSearchStoreMode",constructor:function(config){config=config||{},config._autoLoadStore=!config.storeConfig||!config.storeConfig.hasOwnProperty("autoLoad")||config.storeConfig.autoLoad,config.storeConfig=this._getStoreConfig(),config.context&&!config.project&&(config.project=config.context.getProjectRef()),this.callParent(arguments)},initComponent:function(){this.listConfig.tpl=this._getBoundlistTemplate(),this.callParent(arguments),this.addEvents("pickerrefreshed","defaultsset"),this.mon(this.store,"load",this._addDefaultsToStore,this),this.mon(this.store,"load",this._fireComponentReady,this,{single:!0}),this.relayEvents(this.store,["load"],"store"),this._loadStoreWhenReady()},createPicker:function(){var picker=this.callParent(arguments);return picker.on({show:this._addBoundListHeaders,refresh:this._addBoundListHeaders,scope:this}),this.alwaysExpanded&&picker.on("beforehide",function(){return!1}),picker},setContextFromRecord:function(record,fieldName){var projectRef=record.get("Project")&&record.get("Project")._ref||Rally.environment.getContext().getProject()._ref;this.addCls(Rally.util.Test.toBrowserTestCssClass("rally-user-combobox-"+record.get("ObjectID"))),this.on("beforerender",function(picker){picker.addCls(Rally.util.Test.toBrowserTestCssClass("rally-user-combobox-"+record.get("ObjectID")))}),this.on("expand",function(picker){picker.getPicker().addCls(Rally.util.Test.toBrowserTestCssClass("rally-user-combobox-boundlist-"+record.get("ObjectID")))},this,{single:!0}),this.store.on("load",function(){this.setValue(record.get(fieldName))},this,{single:!0}),this.setProject(projectRef)},setValue:function(value){this.lastQuery="";var refsToAdd=this._getRefsNotInStore(value);this._shouldAddRecordsToStore(refsToAdd)?(this._removeNonTeamMembersFromStore(),this._loadQuickPickRecords(refsToAdd).then({success:function(addedRecords){var record=this.store.findRecord(this.valueField,value);addedRecords.length&&record&&this.setValue(record)},scope:this})):(this._recordsAreTeamMembers(value)&&this._removeNonTeamMembersFromStore(),this.callParent(arguments))},onKeyDown:function(e){this.callParent(arguments),e.getKey()===e.ESC&&this.triggerBlur()},refreshStore:function(){this._storeLoaded=!0,this.store.load()},_removeNonTeamMembersFromStore:function(){this.store.remove(_.filter(this.store.data.getRange(),{_nonTeamMember:!0}))},_removeTeamMembers:function(){var idx=this._findTeamMemberIndex();if(idx>-1){var teamMembers=this.store.data.getRange(idx);teamMembers=_.reject(teamMembers,function(record){return record._quickPickRecord}),this.store.remove(teamMembers)}},_waitForDefaultsToBeSet:function(){var deferred=Ext.create("Deft.Deferred");return this._getCurrentUserIndex()>-1?deferred.resolve():this.on("defaultsset",deferred.resolve,deferred,{single:!0}),deferred.promise},_shouldAddRecordsToStore:function(refsToAdd){return!Ext.isEmpty(refsToAdd)&&this.store&&(Ext.isEmpty(this.storeMode)||this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE)},_addBoundListHeaders:function(boundList){this._addQuickLinkToBoundList(boundList),this._addTeamMemberListItemToBoundList(boundList)},_addTeamMemberListItemToBoundList:function(boundList){var nodes=boundList.getNodes(),html='<div class="rally-teammember-header rally-group-header multi-object-picker-header">'+this.teamMembersHeaderTitle+"</div>",idx=-1;_.each(Ext.query(".rally-teammember-header",boundList.getEl().dom),Ext.removeNode),this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE&&(idx=this._findTeamMemberIndex(),idx>-1&&idx<nodes.length&&Ext.DomHelper.insertBefore(nodes[idx],html))},_addQuickLinkToBoundList:function(boundList){var nodes=boundList.getNodes(),html='<div class="rally-quick-header rally-group-header multi-object-picker-header">Quick Picks</div>';if(_.each(Ext.query(".rally-quick-header",boundList.getEl().dom),Ext.removeNode),this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE&&nodes.length>0){var node=nodes[this._findQuickPicksIndex()]||nodes[0];Ext.DomHelper.insertBefore(node,html)}},_loadStoreWhenReady:function(){this.project?this._loadTeamMembershipStore():(this._configureTeamMembershipStore(),this.store.hydrateModel().then(function(){this.store.fireEvent("load",this.store)}.bind(this))),Ext.Function.interceptAfter(this,"setProject",this._changeProject,this)},_configureTeamMembershipStore:function(){var url=Rally.environment.getServer().getWsapiUrl()+"/User",filter=this._getTeamMembershipFilter();return this._configureStore(url,filter,this.TEAM_MEMBERSHIP_STORE_MODE),filter},_configureUserSearchQueryStore:function(query){var url=this.project&&!this.includeWorkspaceUsers?Rally.util.Ref.getUri(this.project)+"/Editors":Rally.environment.getServer().getWsapiUrl()+"/Users",filter=this._getUserQueryFilter(query);return this._configureStore(url,filter,this.USER_SEARCH_STORE_MODE),filter},_configureStore:function(url,filter,storeMode){var filterPropertyName="userSearchComboFilter";filter[filterPropertyName]=!0,this.store.filters=this.store.filters.filterBy(function(item){return!item.hasOwnProperty(filterPropertyName)}),this.store.filters.add(filter),this.store.getProxy().url=url,this.storeMode=storeMode,this._toggleNoEntryBySearchMode()},_toggleNoEntryBySearchMode:function(){this.storeMode===this.USER_SEARCH_STORE_MODE?(Ext.isEmpty(this._allowNoEntry)&&(this._allowNoEntry=this.allowNoEntry),this.allowNoEntry=!1):Ext.isBoolean(this._allowNoEntry)&&(this.allowNoEntry=this._allowNoEntry)},_getTeamMembershipFilter:function(){var filter=Ext.create("Rally.data.wsapi.Filter",{property:"Disabled",operator:"!=",value:!0});return this.project&&(filter=Rally.data.wsapi.Filter.and([filter,{property:"TeamMemberships",operator:"contains",value:Rally.util.Ref.getRelativeUri(this.project)}])),filter},_getUserQueryFilter:function(query){var userQueryFilter=Rally.data.wsapi.Filter.or([{property:"DisplayName",operator:"contains",value:query},{property:"FirstName",operator:"contains",value:query},{property:"LastName",operator:"contains",value:query},{property:"EmailAddress",operator:"contains",value:query}]);return this.includeWorkspaceUsers&&(userQueryFilter=userQueryFilter.and({property:"WorkspacePermission",operator:"!=",value:"No Access"})),userQueryFilter},_getStoreConfig:function(){return{autoLoad:!1,fetch:["ObjectID","EmailAddress","DisplayName"],requester:this,sorters:[{property:"DisplayName",direction:"ASC"}],model:Ext.identityFn("User")}},_addDefaultsToStore:function(){var currentUserRef=Rally.util.Ref.getRelativeUri(Rally.environment.getContext().getUser()._ref);if(this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE){this.store.suspendEvents(!0);var currentUserRecord=this.store.data.findBy(function(record){return record.get("_ref")===currentUserRef});currentUserRecord?this.store.remove(currentUserRecord):currentUserRecord=new this.store.model(Rally.environment.getContext().getUser()),currentUserRecord._quickPickRecord=!0,this.store.insert(this._findCurrentUserIndex(),[currentUserRecord]),this.store.resumeEvents(),this.fireEvent("defaultsset",this),this.getPicker().refresh(),this.fireEvent("pickerrefreshed",this)}},_loadQuickPickRecords:function(refsToAdd){return Ext.create("Rally.data.wsapi.RefsToRecords").convert(refsToAdd,{requester:this}).then({success:function(recordsToAdd){return this._waitForDefaultsToBeSet().then({success:function(){return this._addQuickPickRecords(recordsToAdd),recordsToAdd},scope:this})},scope:this})},_getRefsNotInStore:function(records){if(this._recordsAreEmpty(records))return[];var refs=_.map(Ext.Array.from(records),function(record){return Rally.util.Ref.getRelativeUri(record.isModel?record.get(this.valueField):record)},this);return _.filter(refs,function(ref){return!this.findRecordByValue(ref)},this)},_recordsAreTeamMembers:function(records){return!!this._recordsAreEmpty(records)||!_.any(Ext.Array.from(records),function(record){var storeRecord=this.findRecordByValue(record.isModel?record.get(this.valueField):record);return storeRecord&&storeRecord._nonTeamMember},this)},_recordsAreEmpty:function(records){return Ext.isEmpty(records)||_.any(Ext.Array.from(records),function(record){return record&&record.isModel&&Ext.isEmpty(record.get("_ref"))})},_addQuickPickRecords:function(records){var insertIdx=this._getCurrentUserIndex()+1;this.store&&this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE&&(this.store.suspendEvents(!0),_.eachRight(records,function(record){this.store.getById(record.getId())||(record._quickPickRecord=!0,record._nonTeamMember=!0,this.store.insert(insertIdx,record))},this),this.store.resumeEvents())},_getCurrentUserIndex:function(){var currentUserRef=Rally.util.Ref.getRelativeUri(Rally.environment.getContext().getUser()._ref);return this.store?_.findIndex(this.store.data.getRange(),function(record){return record.get("_ref")===currentUserRef}):-1},_findCurrentUserIndex:function(){var index=0;return this.allowClear&&index++,this.allowNoEntry&&index++,index},_findQuickPicksIndex:function(){return this.allowClear?1:0},_findTeamMemberIndex:function(){return _.findIndex(this.store.getRange(),function(record){return!(record._quickPickRecord||record.get(this.valueField)===this.noEntryValue||this.allowClear&&record.get(this.valueField)===this.clearValue||record._nonTeamMember)},this)},onReady:Ext.emptyFn,_fireComponentReady:function(){this.alwaysExpanded&&this.expand(),this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_getBoundlistTemplate:function(itemCls){return Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="'+Ext.baseCSSPrefix+"boundlist-item "+(itemCls||"rally-user-item")+'">','<tpl if="this.hasProfilePicture(values._ref)"><img src="{[this.getProfileImageSrc(values._ref)]}"/></tpl><span class="{[this.getBrowserTestClass(values._ref)]}">{_refObjectName:htmlEncode}</span>',"</div>","</tpl>",{getProfileImageSrc:function(_ref){return Rally.util.User.getProfileImageUrl(18,_ref)},hasProfilePicture:function(_ref){return Rally.util.Ref.isRefUriWithValidObjectId(_ref)},getBrowserTestClass:function(_ref){return Rally.util.Test.toBrowserTestCssClass("user-combo-item-"+Rally.util.Ref.getOidFromRef(_ref))}})},doQuery:function(queryString,forceAll,rawQuery){if(Ext.isEmpty(queryString)){if(this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE)return void this.expand();queryString=this._configureTeamMembershipStore().toString()}else queryString=this._configureUserSearchQueryStore(queryString).toString();
this.callParent([queryString,forceAll,rawQuery])},_loadTeamMembershipStore:function(){this._configureTeamMembershipStore(),this._autoLoadStore||this._storeLoaded?this.refreshStore():this._fireComponentReady()},_changeProject:function(){if(this.project)this._loadTeamMembershipStore();else{var storeRecord=this.findRecordByValue(this.value);storeRecord&&(storeRecord._quickPickRecord=!0),this._removeTeamMembers()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.ComboBoxEditor",{extend:Ext.grid.CellEditor,alias:"widget.rallycomboboxeditor",ignoreNoChange:!0,initComponent:function(){this.callParent(arguments),this.field.on("select",this._onValueSelected,this)},getName:function(){return this.field&&this.field.getName()},getValue:function(){return this._valueSelected?this.callParent(arguments):this.startValue},_onValueSelected:function(){this._valueSelected=!0},onHide:function(){this.callParent(arguments),delete this._valueSelected,this.field.setValue("")},startEdit:function(el,value){this.field.setOriginalValue(value),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RecordContextEditor",{extend:Rally.ui.grid.ComboBoxEditor,alias:"widget.rallyrecordcontexteditor",getName:function(){return this.field&&this.field.getName()},prepareEditor:function(context,callback){this.mon(this.field.store,"datachanged",callback,this,{single:!0}),this.field.store.clearFilter(!0),this.field.setContextFromRecord(context.record,this.column.dataIndex,context.grid&&context.grid.context?context.grid.context.getDataContext():null)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.OwnerEditor",{extend:Rally.ui.grid.RecordContextEditor,alias:"widget.rallyownereditor",startEdit:function(el,value){this.callParent([el,""])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.CollectionEditor",{extend:Ext.grid.CellEditor,alias:"widget.rallycollectioneditor",field:{autoExpand:!0,hideTrigger:!0,matchFieldWidth:!1},initComponent:function(){this.callParent(arguments),this.on("beforecomplete",this._onBeforeComplete,this)},getValue:function(){return _.map(this.field.getValue(),function(record){return{Name:record.get("Name"),_refObjectName:record.get("_refObjectName"),_ref:record.get("_ref")}})},getName:function(){return this.name},_onBeforeComplete:function(cmp,newCollection,startValue,opt){var originalCollection=startValue._tagsNameArray;if(originalCollection&&this._collectionsAreEqual(originalCollection,newCollection))return this.hideEdit(),!1},_valueIsEqual:function(val1,val2){return val1._ref===val2._ref&&val1.Name===val2.Name},_collectionsAreEqual:function(collection1,collection2){return collection2=_.sortBy(collection2,"_ref"),collection1.length===collection2.length&&_(collection1).sortBy("_ref").all(function(val1,i){return this._valueIsEqual(val1,collection2[i])},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.CollectionPicker",{extend:Rally.ui.picker.MultiObjectPicker,alias:"widget.rallycollectionpicker",clientMetrics:[{event:"focus",description:"collection picker focused"},{event:"blur",description:"collection picker blurred"}],config:{selectedTextLabel:"Selected",availableTextLabel:"Available",listCfg:{emptyText:'<div class="rui-multi-object-picker-empty-text">No items found.</div>'},modelType:null},setValue:function(values){values&&values._tagsNameArray&&(values=_.pluck(values._tagsNameArray,this.selectionKey).join(",")),this.callParent([values])},initEvents:function(){this.callParent(arguments),this.on("focus",this._onFocus,this)},_onFocus:function(){(this.autoExpand&&this.picker.isHidden()||!this.expanded)&&this.expand()},triggerBlur:function(){this.callParent(arguments),this.isExpanded&&!this.alwaysExpanded&&this.collapse()}})}(),function(){var Ext=window.Ext4||window.Ext,translateRallyDateFormatToExtDateFormat=_.memoize(function(format){return format.replace("MMM","M").replace("MM","m").replace("yyyy","Y").replace("dd","d")}),translateRallyDateTimeFormatToExtDateTimeFormat=_.memoize(function(format){var translatedDateString=translateRallyDateFormatToExtDateFormat(format);return translatedDateString.replace("hh","h").replace("mm","i").replace("ss","s").replace("a","A").replace(/S{1,3}/,"u")}),yearMonthDayTimeFormat="YYYY-MM-DDTHH:mm:ss";Ext.define("Rally.util.DateTime",{singleton:!0,format:function(date,format){return date?Ext.Date.format(date,translateRallyDateTimeFormatToExtDateTimeFormat(format)):""},formatWithDefault:function(date,context){return this.format(date,this._getDefaultDateFormat(context))},formatWithNoYearWithDefault:function(date,context){return this.format(date,this._getDefaultDateFormatWithNoYear(context))},formatWithDefaultDateTime:function(date,context){return this.format(date,this._getDefaultDateTimeFormat(context))},parse:function(stringDate,format){return stringDate&&format?Ext.Date.parse(stringDate,translateRallyDateTimeFormatToExtDateTimeFormat(format)):null},parseWithDefault:function(stringDate,context){return this.parse(stringDate,this._getDefaultDateFormat(context))},parseWithDefaultDateTime:function(stringDate,context){return this.parse(stringDate,this._getDefaultDateTimeFormat(context))},_getDefaultDateFormat:function(context){var c=context||Rally.environment.getContext();return c.getUser().UserProfile.DateFormat||c.getWorkspace().WorkspaceConfiguration.DateFormat},_getDefaultDateFormatWithNoYear:function(context){var format=this._getDefaultDateFormat(context),formatsWithoutYears={"yyyy-MM-dd":"MM-dd","MM/dd/yyyy":"MM/dd","dd/MM/yyyy":"dd/MM","yyyy/MM/dd":"MM/dd","yyyy-MMM-dd":"MMM-dd"};return formatsWithoutYears[format]||format},_getDefaultDateTimeFormat:function(context){var c=context||Rally.environment.getContext();return c.getUser().UserProfile.DateTimeFormat||c.getWorkspace().WorkspaceConfiguration.DateTimeFormat},toIsoString:function(date,adjustFromLocalTime){if(adjustFromLocalTime){var offset=parseInt(Ext.Date.format(date,"Z"),10),adjustedDate=Ext.Date.add(date,Ext.Date.SECOND,-offset);return Ext.Date.format(adjustedDate,"c").replace(Ext.Date.format(adjustedDate,"P"),"Z")}return Ext.Date.format(date,"c")},toUtcIsoString:function(date){return moment(date).utc().toISOString()},fromIsoString:function(input){if(Ext.isIE8||Ext.isIE7){var reIsoDate=/^(\d{4})-(\d{2})-(\d{2})((T)(\d{2}):(\d{2})(:(\d{2})(\.\d*)?)?)?(Z|([+\-][\d:]+))?$/,parseFn=function(val){var m;if(m="string"==typeof val&&val.match(reIsoDate)){var utcMilliseconds=Date.UTC(+m[1],+m[2]-1,+m[3],+m[6]||0,+m[7]||0,+m[9]||0,parseInt(1e3*+m[10],10)||0),timezoneOffset=m[12];return timezoneOffset&&(utcMilliseconds-=60*this.parseTimezoneOffset(timezoneOffset)*1e3),new Date(utcMilliseconds)}return null};return parseFn.call(this,input)}return new Date(Date.parse(input,"c"))},add:function(date,unit,quantity){var extUnit={millisecond:Ext.Date.MILLI,second:Ext.Date.SECOND,minute:Ext.Date.MINUTE,hour:Ext.Date.HOUR,day:Ext.Date.DAY,week:Ext.Date.DAY,month:Ext.Date.MONTH,year:Ext.Date.YEAR};return"week"===unit&&(quantity=7*quantity),Ext.Date.add(date,extUnit[unit]||unit,quantity)},getDifference:function(dateA,dateB,unit){var unitSize={second:1,minute:60,hour:3600,day:86400,week:604800,month:2592e3,year:31536e3},getUtcEpochSeconds=function(date){return parseInt(Ext.Date.format(date,"U"),10)-60*date.getTimezoneOffset()},dateASecs=getUtcEpochSeconds(dateA),dateBSecs=getUtcEpochSeconds(dateB),diffSecs=dateASecs-dateBSecs,diffUnits=diffSecs/unitSize[unit];return diffUnits=dateASecs>dateBSecs?Math.floor(diffUnits):Math.ceil(diffUnits)},getUserExtDateFormat:function(){return translateRallyDateFormatToExtDateFormat(this._getDefaultDateFormat())},parseTimezoneOffset:function(timezone){var offset,west=timezone.match(/^-/),offsetStr=timezone.replace(/[\-+:]/g,"");return offset=60*parseInt(offsetStr.substring(0,2),10),4===offsetStr.length&&(offset+=parseInt(offsetStr.substring(2,4),10)),west&&(offset=0-offset),offset},getTimezoneAbbreviationFromDateString:function(dateString){var timezoneAbbreviation;try{timezoneAbbreviation=this._getTimezoneAbbreviationForModernBrowsers(dateString),timezoneAbbreviation||(timezoneAbbreviation=this._getTimezoneAbbreviationForIE9(dateString))}catch(e){}return timezoneAbbreviation||(timezoneAbbreviation=moment().format("Z")),timezoneAbbreviation},_getTimezoneAbbreviationForModernBrowsers:function(dateString){var timezoneMatch=dateString.match(/\((.*)\)$/);if(timezoneMatch&&timezoneMatch.length>1){var timezone=timezoneMatch[1],timezoneWords=timezone.split(/\s/);if(timezoneWords.length>1){var timezoneAbbreviation=[];timezoneWords.forEach(function(word){timezoneAbbreviation.push(word.substring(0,1).toUpperCase())}),timezone=timezoneAbbreviation.join("")}return timezone}},_getTimezoneAbbreviationForIE9:function(dateString){var timezoneMatch=dateString.match(/\d\d\s([A-Z]{3,4})\s\d\d\d\d$/);if(timezoneMatch&&timezoneMatch.length>1)return timezoneMatch[1]},_convertJodaFormatToMomentFormat:function(format){return format.replace(/y/g,"Y").replace(/d/g,"D").replace(/a/g,"A")},formatDate:function(inputDate,showZoneAbbreviation){if(!inputDate)return"";var momentDate,timezoneAbbreviation,WORKSPACE_TIMEZONE_TOGGLE=Rally.environment.useWorkspaceTimeZone,currentUser=Rally.environment.getContext().getUser(),currentWorkspace=Rally.environment.getContext().getWorkspace(),jodaDateFormat=currentUser.UserProfile.DateFormat||currentWorkspace.WorkspaceConfiguration.DateFormat,jodaDateTimeFormat=currentUser.UserProfile.DateTimeFormat||currentWorkspace.WorkspaceConfiguration.DateTimeFormat,momentDateFormat=this._convertJodaFormatToMomentFormat(jodaDateFormat),momentDateTimeFormat=this._convertJodaFormatToMomentFormat(jodaDateTimeFormat);if(Rally.environment.useSystemTimezone)momentDate=moment(inputDate),timezoneAbbreviation=this.getTimezoneAbbreviationFromDateString(inputDate.toString());else if(WORKSPACE_TIMEZONE_TOGGLE)momentDate=this.rollToWorkspaceTz(inputDate),timezoneAbbreviation="";else{var timezone=currentUser.UserProfile.TimeZone||currentWorkspace.WorkspaceConfiguration.TimeZone;momentDate=moment.tz(inputDate,timezone),timezoneAbbreviation=momentDate.format("z")}return showZoneAbbreviation?momentDate.format(momentDateTimeFormat)+" "+timezoneAbbreviation:momentDate.format(momentDateFormat)},convertForEditing:function(date){if(date instanceof Date){var dateRolledToWorkspaceTz=this.rollToWorkspaceTz(date),dateTimeString=dateRolledToWorkspaceTz.format(yearMonthDayTimeFormat),dateInSystemTz=moment(dateTimeString).toDate();return dateInSystemTz}return date},convertFromEditing:function(date){if(date instanceof Date){var dateTimeString=moment(date).format(yearMonthDayTimeFormat),dateTimeInWorkspaceTimezone=this.rollToWorkspaceTz(dateTimeString),dateTimeRolledToSystemTz=dateTimeInWorkspaceTimezone.toDate();return dateTimeRolledToSystemTz}return date},rollToWorkspaceTzAsIsoString:function(dateObj){var tz=this._getWorkspaceTimeZone();return moment.tz(dateObj,tz).format()},rollToWorkspaceTz:function(dateRepresentation){var tz=this._getWorkspaceTimeZone();return moment.tz(dateRepresentation,tz)},_getWorkspaceTimeZone:function(){var currentWorkspace=Rally.environment.getContext().getWorkspace();return currentWorkspace.WorkspaceConfiguration.TimeZone}})}(),function(){var Ext=window.Ext4||window.Ext,defaultSorts={HierarchicalRequirement:"FormattedID DESC",Defect:"FormattedID DESC",DefectSuite:"FormattedID DESC",Task:"FormattedID DESC",User:"Name ASC",Iteration:"StartDate ASC",Release:"ReleaseStartDate ASC",RecycleBinEntry:"DeletionDate DESC"},defaultSortFns={Milestone:function(o1,o2){var today=new Date,d1=o1.get("TargetDate"),d2=o2.get("TargetDate"),dateComparison=d1>d2?1:d1<d2?-1:0,n1=(o1.get("Name")||"").toLowerCase(),n2=(o2.get("Name")||"").toLowerCase(),nameComparison=n1>n2?1:n1<n2?-1:0;return n1?n2?d1?d1>=today?!d2||d2<today?-1:0===dateComparison?nameComparison:dateComparison:!d2||d2>today?1:0===dateComparison?nameComparison:-dateComparison:d2?d2>=today?1:-1:nameComparison:1:-1}};Ext.define("Rally.data.util.Sorter",{singleton:!0,sorters:function(sorterString){var sorters=[];if(Rally.util.String.isNotEmpty(sorterString)){var sorterEntries=sorterString.split(/,\s*/);Ext.each(sorterEntries,function(sorterEntry){sorters.push(this._buildSorter(sorterEntry.trim()))},this)}return sorters},_buildSorter:function(sorterEntry){var sortItems=sorterEntry.split(/\s+/);return{property:sortItems[0],direction:Rally.util.String.isNotEmpty(sortItems[1])?sortItems[1]:void 0}},getDefaultSort:function(typeName,options){typeName=Rally.data.ModelTypes.getTypeByName(typeName);var sortString=defaultSorts[typeName];return options&&options.asSorter?this.sorters(sortString):sortString||null},getDefaultSortFn:function(typeName){return typeName=Rally.data.ModelTypes.getTypeByName(typeName),defaultSortFns[typeName]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.MilestoneListHeadings",{_addListHeaders:function(boundList,options){options=this._mergeDefaultHeaderOptions(options);var today=new Date,nodes=boundList.getNodes();options.filterSelectedNodes&&(nodes=_.filter(nodes,function(node){return!_.contains(node.className,"boundlist-selected")})),Ext.suspendLayouts(),this._removeExistingHeaders(boundList,options.headerSelectedTextLabel,options.groupHeaderSelector),this._addHeader("FUTURE MILESTONES",options.headerClasses,this._findFirstNode(nodes,function(n){return n>=today})),this._addHeader("UNDATED MILESTONES",options.headerClasses,this._findFirstUndatedNode(nodes)),this._addHeader("PAST MILESTONES",options.headerClasses,this._findFirstNode(nodes,function(n){return n<today})),Ext.resumeLayouts(!0),this.alignPicker&&this.alignPicker()},_mergeDefaultHeaderOptions:function(options){return _.merge({filterSelectedNodes:!0,groupHeaderSelector:".rally-group-header",headerClasses:"rally-quick-header rally-group-header multi-object-picker-header",headerSelectedTextLabel:"Selected Milestones"},options)},_removeExistingHeaders:function(boundList,ignoredLabel,groupHeaderSelector){_.each(Ext.query(groupHeaderSelector,boundList.getEl().dom),function(header){header.innerHTML!==ignoredLabel&&Ext.removeNode(header)},this)},_findFirstNode:function(nodes,comparator){var nodeDate;return _.find(nodes,function(node){if(nodeDate=Ext.query(".milestone-raw-date",node),nodeDate.length>0&&nodeDate[0].innerHTML)return comparator(new Date(nodeDate[0].innerHTML))})},_findFirstUndatedNode:function(nodes){var nodeDate,nodeName;return _.find(nodes,function(node){return nodeDate=Ext.query(".milestone-raw-date",node),nodeName=Ext.query(".milestone-name",node),(!nodeName.length||nodeName[0].innerHTML!==this.noEntryText&&nodeName[0].innerHTML!==this.clearText)&&(0===nodeDate.length||""===nodeDate[0].innerHTML||"null"===nodeDate[0].innerHTML)},this)},_addHeader:function(text,cls,node){node&&Ext.DomHelper.insertBefore(node,'<div class="'+cls+'">'+text+"</div>")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.MilestonePicker",{extend:Rally.ui.picker.CollectionPicker,alias:"widget.rallymilestonepicker",mixins:[Rally.ui.MilestoneListHeadings],config:{currentProject:null,selectedTextLabel:"Selected Milestones",emptyText:"Search Milestones",notFoundText:'<div class="rui-multi-object-picker-empty-text">No matching Milestones</div>',maxLength:100,modelType:"Milestone",storeConfig:{fetch:"Name,TargetDate",remoteFilter:!0},pickerCfg:{minWidth:250}},initComponent:function(){this.storeConfig.sorters=[{sorterFn:Rally.data.util.Sorter.getDefaultSortFn("Milestone")}],this.callParent(arguments)},createPicker:function(){var picker=this.callParent(arguments),boundList=picker.items.items[0];return boundList.on({show:this._addListHeaders,refresh:this._addListHeaders,scope:this}),picker},resetFilters:function(){this.store.setFilter(this.getBaseFilter())},getBaseFilter:function(){return this.currentProject?Ext.create("Rally.data.QueryFilter",{property:"Projects",operator:"contains",value:this.currentProject}).or(Ext.create("Rally.data.QueryFilter",{property:"Projects.ObjectID",operator:"=",value:"null"})):void 0},getMatchedTextHtml:function(recordData){return'<div class="milestone-name">'+recordData[this.matchFieldName]+"</div>"},getRightListHtml:function(recordData){return'<div class="milestone-date">'+Rally.util.DateTime.formatWithDefault(recordData.TargetDate,Rally.environment.getContext())+'</div><div class="milestone-raw-date">'+recordData.TargetDate+"</div>"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.MilestoneEditor",{extend:Rally.ui.grid.CollectionEditor,alias:"widget.rallymilestoneeditor",field:{xtype:"rallymilestonepicker",autoExpand:!0,hideTrigger:!0,matchFieldWidth:!1,showSearchIcon:!0,showCloseButton:!0},startEdit:function(){var project=this.editingPlugin.getActiveRecord().get("Project");project&&(this.field.currentProject=project._ref),this.field.store&&(this.field.store.removeAll(),this.field.refresh()),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.MilestoneProjectEditor",{alias:"widget.rallymilestoneprojecteditor",extend:Rally.ui.grid.RecordContextEditor,confirmResult:!1,initComponent:function(){this.callParent(arguments),this.on("beforestartedit",this._onBeforeStart,this)},_onBeforeStart:function(editor,boundEl,value){return this.confirmResult?(this.confirmResult=!1,!0):(Rally.ui.MilestoneTargetProjectPermissionsHelper.confirmEditIfRequired(this.record).then({success:function(continueEditing){this.confirmResult=continueEditing,continueEditing?this.startEdit(boundEl,value):(this.editingPlugin.setActiveEditor(null),this.cancelEdit())},scope:this}),!1)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TaskRemainingTotalEditor",{extend:Ext.grid.CellEditor,alias:"widget.rallytaskremainingtotaleditor",initComponent:function(){this.callParent(arguments),this.on("beforestartedit",this._onBeforeStart,this)},isNotEditable:function(record){return record.isTask()&&"Completed"===record.get("State")},_onBeforeStart:function(){if(this.isNotEditable(this.record))return this.editingPlugin.cancelEdit(),!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Colors",{singleton:!0,logo_red:"#EE1C25",brick:"#B81B10",red_lt:"#F2D3D0",red_med:"#F66349",lime:"#8DC63F",lime2:"#91D164",lime_med:"#CADDA3",lime_lt:"#E4EECF",grey1:"#F6F6F6",grey2:"#E6E6E6",grey3:"#D6D6D6",grey4:"#C0C0C0",grey5:"#A9A9A9",grey6:"#888888",grey7:"#666666",grey8:"#444444",grey9:"#222222",cyan:"#00A9E0",cyan_med:"#82D3ED",cyan_lt:"#BFE9F5",cyan_very_lt:"#ECF8FB",cyan_focus:"#CCEEF9",cyan_hover:"#29BEFF",cyan5:"#35B2E4",blue:"#005EB8",blue_med:"#7CAFD7",blue_lt:"#BDD7EA",blue_very_lt:"#BEDEE6",blue_link:"#337EC6",yellow:"#FAD200",yellow5:"#FDD419",yellow_med:"#FFDD82",yellow_lt:"#FFEDBF",yellow_very_lt:"#E7E6B6",yellow_highlight:"#FDFECC",gold:"#F6A900",gold_dk:"#CF871B",gold_lt:"#F4BF4B",orange:"#FF8200",orange_bright:"#F9A814",orange_med:"#FBB990",orange_lt:"#FDDCC6",green_dk:"#1E7C00",green:"#3a874f",light_green:"#6ab17d",lighter_green:"#b2e3b6",lightest_green:"#e3f9e9",pink:"#DA1884",pink_med:"#E38CBE",pink_lt:"#F1C5DD",purple:"#7832A5",purple_med:"#B29DCD",purple_lt:"#D7CCE5",teal:"#00B398",teal_med:"#8CD5C8",teal_lt:"#C3E9E3",white:"#fff",black:"#000",DISPLAY_COLOR_PALETTE:[{value:"#105CAB",name:"Dark Blue"},{value:"#21A2E0",name:"Blue"},{value:"#107C1E",name:"Green"},{value:"#4A1D7E",name:"Purple"},{value:"#DF1A7B",name:"Pink"},{value:"#EE6C19",name:"Burnt Orange"},{value:"#F9A814",name:"Orange"},{value:"#FCE205",name:"Yellow"},{value:"#848689",name:"Grey"}]})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.watches.SubscriptionEmailOffDialog",{extend:Rally.ui.dialog.ConfirmDialog,modal:!0,title:"Email Notifications Off",cls:"new-ux warning-dialog subscription-email-off-dialog",width:"600px",height:"350px",checkboxId:"dialogSubscriptionCheckbox",mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},constructor:function(config){var scopeStr=Rally.environment.getContext().getScopeStr();this.message='<h2 class="message">Your subscription currently has Email Functionality turned off.</h2><div class="message-secondary"><p>You will not receive email notifications for the items you are watching.</p><p>Contact your system administrator to change this setting.</p><p class="watches-message-warning">WARNING!</p><p>Doing so may also trigger emails for existing Notification Rules.</p><a class="go-to-notification-rules" href="/#/'+scopeStr+'/mynotificationrules">Go to my Notification Rules.</a></div>',this.dockedItems=[{xtype:"toolbar",dock:"bottom",padding:"10",layout:{type:"hbox",pack:"left"},ui:"footer",items:[{xtype:"checkbox",boxLabel:"Don't show this message again, thanks.",checked:!1,id:this.checkboxId}]},{xtype:"toolbar",dock:"bottom",padding:"10",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",cls:"confirm primary medium",itemId:"confirmButton",userAction:"clicked 'Okay' in Subscription Email Off dialog"},{xtype:"rallybutton",cls:"cancel secondary medium",itemId:"cancelButton",userAction:"clicked 'Cancel Watch' in Subscription Email Off dialog",ui:"link"}]}],this.callParent(arguments),this.on({render:function(cmp){cmp.getEl().down(".go-to-notification-rules").on("click",function(){this.recordAction({description:"user clicked 'Go to my Notification Rules' in Subscription Email Off dialog"})},this)},confirm:function(){this.recordAction({description:"dismiss dialog: Subscription Email Off",miscData:{neverShowDialogAgain:this._neverAgainIsChecked()}}),this._setNeverAgainPreference()},cancel:function(){this._setNeverAgainPreference()}})},confirmLabel:"Okay",cancelLabel:"Cancel Watch",defaultFocus:"confirm",_neverAgainIsChecked:function(){return Ext.getCmp(this.checkboxId).checked},_setNeverAgainPreference:function(){var value=this._neverAgainIsChecked();Rally.data.PreferenceManager.update({filterByUser:!0,settings:{"watchartifact.nevershowdialog.subscription":value}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.watches.UserEmailOffDialog",{extend:Rally.ui.dialog.ConfirmDialog,modal:!0,title:"Email Notifications Off",cls:"new-ux warning-dialog user-email-off-dialog",width:"600px",height:"350px",checkboxId:"dialogUserCheckbox",confirmLabel:"Turn Email Notifications On",cancelLabel:"No thanks",mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},constructor:function(config){var scopeStr=Rally.environment.getContext().getScopeStr();this.message='<h2 class="message">You currently have Email Notifications turned off.</h2><div class="message-secondary"><p>You will not receive email notifications for the items you are watching.</p><p>Would you like to turn Email Notifications on?</p><p class="watches-message-warning">WARNING!</p><p>Doing so may also trigger emails for existing Notification Rules.</p><a class="go-to-notification-rules" href="/#/'+scopeStr+'/mynotificationrules">Go to my Notification Rules.</a></div>',this.dockedItems=[{xtype:"toolbar",dock:"bottom",padding:"10",layout:{type:"hbox",pack:"left"},ui:"footer",items:[{xtype:"checkbox",boxLabel:"Don't show this message again, thanks.",checked:!1,id:this.checkboxId}]},{xtype:"toolbar",dock:"bottom",padding:"10",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",cls:"confirm primary medium",itemId:"confirmButton",ui:"link",userAction:"clicked 'Turn Email Notifications On' in User Email Off dialog"},{xtype:"rallybutton",cls:"cancel secondary medium",itemId:"cancelButton",userAction:"clicked 'Cancel' in User Email Off dialog"}]}],this.callParent(arguments),this.on({render:function(cmp){cmp.getEl().down(".go-to-notification-rules").on("click",function(){this.recordAction({description:"user clicked 'Go to my Notification Rules' in User Email Off dialog"})},this)},confirm:function(){this._setNeverAgainPreference()},cancel:function(){this._setNeverAgainPreference()}})},_loadUserProfile:function(){var userProfileId=Rally.environment.getContext().getUser().UserProfile.ObjectID,deferred=Ext.create("Deft.Deferred");return Rally.data.ModelFactory.getModel({type:"UserProfile",success:function(model){model.load(userProfileId,{success:function(record){deferred.resolve(record)},failure:function(response){deferred.reject(response)}})},failure:function(response){deferred.reject(response)}}),deferred.promise},_showUnableToEnableEmailProfileSettingFlare:function(){Rally.ui.notify.Notifier.showError({message:"Unable to turn on email profile setting.  Canceled watch."})},_updateContextWithUserProfileEmailNotificationSetting:function(value){Rally.environment.getContext().getUser().UserProfile.EmailNotificationEnabled=value},setUserProfileEmailEnabled:function(){var deferred=Ext.create("Deft.Deferred"),me=this;return this.recordLoadBegin({description:"enable user profile email setting"}),this._loadUserProfile().then({success:function(record){record.set("EmailNotificationEnabled",!0),record.save({callback:function(records,operation,success){success?me._updateContextWithUserProfileEmailNotificationSetting(!0):me._showUnableToEnableEmailProfileSettingFlare(),me.recordLoadEnd(),deferred.resolve({success:success})}})},failure:function(){me._showUnableToEnableEmailProfileSettingFlare(),me.recordLoadEnd(),deferred.resolve({success:!1})}}),deferred.promise},_neverAgainIsChecked:function(){return Ext.getCmp(this.checkboxId).checked},_setNeverAgainPreference:function(){var value=this._neverAgainIsChecked();Rally.data.PreferenceManager.update({filterByUser:!0,settings:{"watchartifact.nevershowdialog.user":value}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.notifications.Api",{extend:Ext.Base,mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},config:{subscription:null,userProfile:null},statics:{version:1},constructor:function(config){this.connection=config&&config.connection||Ext.Ajax,this.baseUrl=Rally.environment.getServer().getNotificationsUrl(),this.version=Rally.data.notifications.Api.version,this.callParent(arguments),this.setSubscription(Rally.environment.getContext().getSubscription()),this.setUserProfile(Rally.environment.getContext().getUser().UserProfile)},getUserEmailOffDialog:function(){return this.userEmailOffDialog},getSubscriptionEmailOffDialog:function(){return this.subscriptionEmailOffDialog},_getDefaultRequestOptions:function(){var tenant=Rally.data.notifications.Api.tenant;return{withCredentials:!0,params:{zuul_tenant:tenant},headers:{Accept:"application/json","x-tenant":tenant}}},_getWatchUrl:function(record){var url=this.baseUrl+"/watch";return 1===this.version&&(url+="/"+record.get("_refObjectUUID")),url},checkIfWatching:function(record,options){if(_.isUndefined(record.userIsWatching)){var me=this;this.recordLoadBegin({description:"check if user is watching artifact",miscData:{artifactOid:record.getId(),artifactUUID:record.get("_refObjectUUID")}});var requestOptions=_.merge(this._getDefaultRequestOptions(),{url:this._getWatchUrl(record),method:"GET",requester:this,success:function(response){me.recordLoadEnd();var userIsWatching=!1;if(2===me.version&&200===response.status){var jsonResponse=Ext.JSON.decode(response.responseText);jsonResponse.TotalResultCount>0&&(userIsWatching=!0)}1===me.version&&200===response.status&&(userIsWatching=!0),record.userIsWatching=userIsWatching,options.success.call(options.scope,userIsWatching)},failure:function(response){me.recordLoadEnd(),options.failure.call(options.scope,response)}});2===this.version&&_.merge(requestOptions.params,{userUUID:Rally.environment.getContext().getUser()._refObjectUUID,artifactUUID:record.get("_refObjectUUID")}),this.connection.request(requestOptions)}else options.success.call(options.scope,record.userIsWatching)},watch:function(records){records=_.isArray(records)?records:[records];var me=this;return this.recordLoadBegin({description:"watch artifact(s)",miscData:{artifactOIDs:_.invoke(records,"getId"),artifactUUIDs:_.invoke(records,"get","_refObjectUUID")}}),this.showDialogs().then(function(dialogResults){return dialogResults.canceledWatch?Deft.Promise.when({successfulRecords:[],unsuccessfulRecords:[]}):me._getUserInfo().then(function(user){var watches=_.map(records,function(record){return me._watch(record,user)});return Deft.Promise.all(watches).then(function(results){return me.recordLoadEnd(),1===results.length?me._showSingleWatchFlare(results,dialogResults):me._showMultiWatchFlare(results,dialogResults),{successfulRecords:_(results).filter({success:!0}).pluck("record").value(),unsuccessfulRecords:_(results).filter({success:!1}).pluck("record").value()}})})})},_watch:function(record,user){var deferred=Ext.create("Deft.Deferred"),alreadyWatching=!1,requestOptions=_.merge(this._getDefaultRequestOptions(),{method:"POST",requester:this,url:this._getWatchUrl(record),success:function(response){record.userIsWatching=!0;var result=JSON.parse(response.responseText);if(_.has(result,"Errors")){var error=result.Errors[0];alreadyWatching="Watch Exists"===error.message}deferred.resolve({alreadyWatching:alreadyWatching,success:!0,record:record})},failure:function(response){alreadyWatching=409===response.status,deferred.resolve({alreadyWatching:alreadyWatching,success:alreadyWatching,record:record})}});return 1===this.version?_.merge(requestOptions,{jsonData:{user:user._refObjectUUID,email:user.EmailAddress}}):_.merge(requestOptions,{jsonData:{UserUUID:Rally.environment.getContext().getUser()._refObjectUUID,ArtifactUUID:record.get("_refObjectUUID")}}),this.connection.request(requestOptions),deferred},unwatch:function(records){records=_.isArray(records)?records:[records];var me=this;return this.recordLoadBegin({description:"unwatch record(s)",miscData:{artifactOIDs:_.invoke(records,"getId"),artifactUUIDs:_.invoke(records,"get","_refObjectUUID")}}),me._getUserInfo().then(function(user){var watches=_.map(records,function(record){return me._unwatch(record,user)});return Deft.Promise.all(watches).then(function(results){return me.recordLoadEnd(),1===results.length?me._showSingleUnwatchFlare(results):me._showMultiUnwatchFlare(results),{successfulRecords:_(results).filter({success:!0}).pluck("record").value(),unsuccessfulRecords:_(results).filter({success:!1}).pluck("record").value()}})})},_unwatch:function(record,user){var deferred=Ext.create("Deft.Deferred"),requestOptions=_.merge(this._getDefaultRequestOptions(),{method:"DELETE",requester:this,url:this._getWatchUrl(record),success:function(){record.userIsWatching=!1,deferred.resolve({alreadyUnwatching:!1,success:!0,record:record})},failure:function(response){var alreadyUnwatching=404===response.status;deferred.resolve({alreadyUnwatching:alreadyUnwatching,success:alreadyUnwatching,record:record})}});return 2===this.version&&_.merge(requestOptions,{url:this._getWatchUrl(record)+"?artifactUUID="+record.get("_refObjectUUID")+"&userUUID="+Rally.environment.getContext().getUser()._refObjectUUID}),this.connection.request(requestOptions),deferred},_isSubscriptionEmailEnabled:function(){return this.subscription.EmailEnabled},_isUserEmailEnabled:function(){return this.userProfile.EmailNotificationEnabled},loadEmailPreferences:function(options){var response={subscription:this._isSubscriptionEmailEnabled(),user:this._isUserEmailEnabled()};options.success.call(options.scope,response)},_checkNeverShowAgainDialogPreference:function(dialogType,options){var deferred=Ext.create("Deft.Deferred"),preferenceName="watchartifact.nevershowdialog."+dialogType;return Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:preferenceName,success:function(preferences){var preferenceValue=preferences[preferenceName];deferred.resolve("true"===preferenceValue)},failure:function(response){deferred.reject(response)},scope:this}),deferred.promise},createSubscriptionEmailOffDialog:function(){var deferred=Ext.create("Deft.Deferred");return this.recordAction({description:"open dialog: Subscription Email Off"}),this.subscriptionEmailOffDialog=Ext.create("Rally.ui.watches.SubscriptionEmailOffDialog",{
listeners:{cancel:function(){deferred.resolve({canceledWatch:!0})},confirm:function(){deferred.resolve({})}}}),deferred.promise},createUserEmailOffDialog:function(){var deferred=Ext.create("Deft.Deferred");this.recordAction({description:"open dialog: User Email Off"});var dialog=Ext.create("Rally.ui.watches.UserEmailOffDialog",{listeners:{cancel:function(){deferred.resolve({})},confirm:function(){dialog.setUserProfileEmailEnabled().then(function(results){results.success&&deferred.resolve({userEmailTurnedOn:!0})})}}});return this.userEmailOffDialog=dialog,deferred.promise},showDialogs:function(){var promise,me=this;return promise=this._isSubscriptionEmailEnabled()?this._isUserEmailEnabled()?Deft.Promise.when({}):this._checkNeverShowAgainDialogPreference("user").then(function(neverShowDialog){return neverShowDialog?Deft.Promise.when({}):me.createUserEmailOffDialog()}):this._checkNeverShowAgainDialogPreference("subscription").then(function(neverShowDialog){return neverShowDialog?Deft.Promise.when({}):me.createSubscriptionEmailOffDialog()})},_showSingleWatchFlare:function(results,opts){var args=opts.userEmailTurnedOn?{prependMessage:"Email Notifications are turned on for your profile. "}:{};results[0].success?Rally.ui.notify.Notifier.showWatch(results[0].record,args):Rally.ui.notify.Notifier.showError({message:"An error occurred.  Unable to watch."})},_showMultiWatchFlare:function(results,opts){var successfulResults=_.filter(results,{success:!0}),unsuccessfulResults=_.filter(results,{success:!1}),watchedResults=_.filter(successfulResults,{alreadyWatching:!1}),alreadyWatchedResults=_.filter(successfulResults,{alreadyWatching:!0}),msg="";opts.userEmailTurnedOn&&(msg+="Email Notifications are turned on for your profile.  "),watchedResults.length>0&&(msg+="Watched "+watchedResults.length+" item"+(1===watchedResults.length?"":"s")+"."),alreadyWatchedResults.length>0&&(msg+="  "+alreadyWatchedResults.length+" item"+(1===alreadyWatchedResults.length?" was":"s were")+" already being watched."),unsuccessfulResults.length>0&&(msg+=(""===msg?"":"  ")+"Some items could not be watched.  Please try again."),0===unsuccessfulResults.length?Rally.ui.notify.Notifier.showConfirmation({message:msg}):successfulResults.length>0&&unsuccessfulResults.length>0?Rally.ui.notify.Notifier.showWarning({message:msg}):Rally.ui.notify.Notifier.showError({message:msg})},_showSingleUnwatchFlare:function(results){results[0].success?Rally.ui.notify.Notifier.showUnwatch(results[0].record):Rally.ui.notify.Notifier.showError({message:"An error occurred.  Unable to unwatch."})},_showMultiUnwatchFlare:function(results){var successfulResults=_.filter(results,{success:!0}),unsuccessfulResults=_.filter(results,{success:!1}),unwatchedResults=_.filter(successfulResults,{alreadyUnwatching:!1}),nonexistentWatches=_.filter(successfulResults,{alreadyUnwatching:!0}),msg="";unwatchedResults.length>0&&(msg+="Unwatched "+unwatchedResults.length+" item"+(1===unwatchedResults.length?"":"s")+"."),nonexistentWatches.length>0&&(msg+="  "+nonexistentWatches.length+" item"+(1===nonexistentWatches.length?" was":"s were")+" already not watched."),unsuccessfulResults.length>0&&(msg+=(""===msg?"":"  ")+"Some items could not be unwatched.  Please try again."),0===unsuccessfulResults.length?Rally.ui.notify.Notifier.showConfirmation({message:msg}):successfulResults.length>0&&unsuccessfulResults.length>0?Rally.ui.notify.Notifier.showWarning({message:msg}):Rally.ui.notify.Notifier.showError({message:msg})},_getUserInfo:function(options){var deferred=Ext.create("Deft.Deferred"),userOid=Rally.environment.getContext().getUser().ObjectID;return this.connection.request({method:"GET",requester:this,url:"/slm/webservice/v2.0/user/"+userOid+"?fetch=EmailAddress",success:function(response){var result=JSON.parse(response.responseText);deferred.resolve(result.User)},failure:function(response){deferred.reject(response)}}),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.env.Server",{config:{baseUrl:"",contextPath:"",resourcesPath:"",libraryPath:"",defaultWsapiVersion:"v2.x",defaultLookbackVersion:"v2.0",wsapiVersionAliases:["x","v2.x"]},constructor:function(config){config=config||{},this.mergeConfig(config)},getHashBaseUrl:function(){return""},getWsapiUrl:function(version){return this.getContextUrl()+"/webservice/"+this.getWsapiVersion(version)},getRelativeWsapiUrl:function(version){return this.contextPath+"/webservice/"+this.getWsapiVersion(version)},getWsapiVersion:function(version){return version||this.defaultWsapiVersion},getWsapiRestExtension:function(version){return 0===this.getWsapiVersion(version).indexOf("v2.")?"":".js"},getLookbackUrl:function(version){return this.getBaseUrl()+"/analytics/"+this.getLookbackVersion(version)},getLookbackVersion:function(version){return version||this.defaultLookbackVersion},getNotificationsUrl:function(){return"/notifications/api/v"+Rally.data.notifications.Api.version},getImagesPath:function(){return this.getResourcesPath()+"/css/images"},getResourcesPath:function(){return this.resourcesPath},getLibraryPath:function(){return this.libraryPath},getBaseUrl:function(){return this.baseUrl},getContextUrl:function(){return this.getBaseUrl()+this.contextPath}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.ProxyBase",{alternateClassName:["Rally.data.Proxy"],statics:{getGlobalWorkspace:function(){return"/workspace/"+Rally.environment.getContext().getWorkspace().ObjectID},getGlobalProject:function(){return"/project/"+Rally.environment.getContext().getProject().ObjectID},getGlobalProjectScopeUp:function(){return Rally.environment.getContext().getProjectScopeUp()},getGlobalProjectScopeDown:function(){return Rally.environment.getContext().getProjectScopeDown()},actionMethods:{create:"PUT",read:"GET",update:"POST",destroy:"DELETE"},getMethod:function(action){return Rally.data.wsapi.ProxyBase.actionMethods[action]},compact:!0},setProject:function(record){record.self.getField("Project")&&!record.get("Project")&&null!==record.get("Project")&&(record.set("Project",this._getProject()),null!==this._getWorkspace()&&record.set("Workspace",this._getWorkspace()))},buildRequest:function(operation,request){"create"===operation.action&&_.each(operation.records,this.setProject,this),request.enableQueuing=!0,request.params=request.params||{},Ext.apply(request.params,operation.params||{});var fetchParam=operation.useShallowFetch?"shallowFetch":"fetch";return operation.useShallowFetch?(request.params.shallowFetch=operation.fetch,delete request.params.fetch):request.params.fetch=request.params.fetch||"undefined"==typeof operation.fetch||operation.fetch,operation.includeSchema&&(request.params.includeSchema=operation.includeSchema),_.isArray(request.params[fetchParam])&&(request.params[fetchParam]=request.params[fetchParam].join(",")),void 0!==operation.search&&(request.params.search=operation.search),request.params.includePermissions=!0,"read"===operation.action&&(request.params[this.sortParam]&&request.params[this.directionParam]&&(request.params[this.sortParam]=request.params[this.sortParam]+" "+request.params[this.directionParam],delete request.params[this.directionParam]),request.params.start=request.params.start||0,request.params.start++,Ext.isDefined(request.params.pagesize)||(request.params.pagesize=this.defaultPageSize)),Ext.isDefined(request.params.compact)||(Ext.isDefined(request.operation.compact)?request.params.compact=request.operation.compact:Rally.data.wsapi.ProxyBase.compact&&(request.params.compact=Rally.data.wsapi.ProxyBase.compact)),request.params[this.idParam]?delete request.params[this.idParam]:"undefined"==typeof this.idParam&&delete request.params.undefined,this.setRequestContext(request,operation.context),request},setRequestContext:function(request,context){var contextProps={};Rally.environment.getContext()&&(contextProps.workspace=this._getWorkspace(),contextProps.project=this._getProject(),contextProps.projectScopeUp=this._getProjectScopeUp(),contextProps.projectScopeDown=this._getProjectScopeDown()),context&&Ext.apply(contextProps,context),contextProps.project||(delete contextProps.project,delete contextProps.projectScopeUp,delete contextProps.projectScopeDown),contextProps.project&&"null"!==contextProps.workspace&&delete contextProps.workspace,Ext.apply(request.params,contextProps)},_getProject:function(){return Ext.isDefined(this.model.context)&&Ext.isDefined(this.model.context.project)?this.model.context.project:Rally.data.wsapi.ProxyBase.getGlobalProject()},_getProjectScopeUp:function(){return Ext.isDefined(this.model.context)&&Ext.isDefined(this.model.context.projectScopeUp)?this.model.context.projectScopeUp:Rally.data.wsapi.ProxyBase.getGlobalProjectScopeUp()},_getProjectScopeDown:function(){return Ext.isDefined(this.model.context)&&Ext.isDefined(this.model.context.projectScopeDown)?this.model.context.projectScopeDown:Rally.data.wsapi.ProxyBase.getGlobalProjectScopeDown()},_getWorkspace:function(){return Ext.isDefined(this.model.context)&&Ext.isDefined(this.model.context.workspace)?this.model.context.workspace:Rally.data.wsapi.ProxyBase.getGlobalWorkspace()},buildUrl:function(request){var url=request.url||this.url;Ext.isIE9&&_.contains(url,"/PortfolioItem/")&&(request.url=this._encodePortfolioItemUrl(url)),"create"===request.action?request.url=url+"/create":"read"===request.action&&url.match(/\/user$/i)&&(request.url=url+"s")},processResponse:function(success,operation,request,response,callback,scope){if(success){var data=this.parseResponse(response),value=Ext.Object.getValues(data)[0];_.isEmpty(value.Errors)||(success=!1),operation.warnings=value.Warnings}return success},parseResponse:Ext.emptyFn,setException:function(operation,response){var exception={response:response};try{exception.errors=Ext.Object.getValues(this.parseResponse(response))[0].Errors}catch(e){exception.errors=[response.statusText]}operation.setException(exception)},encodeFilters:function(filters){var query,rallyFilters=Ext.Array.clean(Ext.Array.map(filters||[],function(filter){return filter instanceof Rally.data.wsapi.Filter?filter:Rally.data.wsapi.Filter.fromExtFilter(filter)}));return rallyFilters&&rallyFilters.length?(Ext.Array.forEach(rallyFilters,function(filter){filter&&(query=query?query.and(filter):filter)}),query.toString()):""},encodeSorters:function(sorters){var sortTokens=[],isUnique=!1;return sorters&&(Ext.isObject(sorters)&&(sorters=[sorters]),Ext.isArray(sorters)&&Ext.each(sorters,function(sorter){sorter.property&&(sorter.property.indexOf("ObjectID")>=0&&(isUnique=!0),"Parent"===sorter.property&&this.model.getField("Parent")&&"hierarchicalrequirement"===this.model.getField("Parent").getAllowedValueType()?(sortTokens.push(["PortfolioItem",sorter.direction].join(" ")),sortTokens.push(["Parent",sorter.direction].join(" "))):sortTokens.push([sorter.property,sorter.direction].join(" ")))},this)),isUnique||sortTokens.push("ObjectID"),sortTokens.join(",")},_encodePortfolioItemUrl:function(url){var matchString="/PortfolioItem/",idx=url.indexOf(matchString);if(idx>=0){var piType=url.substring(idx+matchString.length),encodedPiType=encodeURIComponent(piType);url=url.replace(piType,encodedPiType)}return url}})}(),function(){var Ext=window.Ext4||window.Ext,MAX_FETCH_LENGTH=100;Ext.define("Rally.data.wsapi.Proxy",{extend:Ext.data.proxy.Rest,alias:["proxy.rally.data.proxy.wsapi","proxy.rally.data.proxy.rest","proxy.Rally.data.WsapiRestProxy","proxy.rallywsapiproxy"],alternateClassName:["Rally.data.WsapiProxy","Rally.data.WsapiRestProxy"],mixins:{proxy:Rally.data.wsapi.ProxyBase},defaultPageSize:200,filterParam:"query",limitParam:"pagesize",groupParam:"order",sortParam:"order",pageParam:void 0,noCache:!1,wsapiVersion:void 0,constructor:function(config){config=config||{},this.actionMethods=Rally.data.wsapi.ProxyBase.actionMethods,config.wsapiVersion=config.wsapiVersion||Rally.environment.getServer().getWsapiVersion(),0!==config.wsapiVersion.indexOf("v2.")&&(config.format="js"),this.callParent(arguments)},buildRequest:function(operation){var request=this.callParent(arguments);return this.mixins.proxy.buildRequest.call(this,operation,request)},getMethod:function(request){var method=this.callParent(arguments);return this._overrideMethod&&(method=this._overrideMethod(request)),this._shouldUsePostGet(method,request)&&(method=this._enablePostGet(request)),method},_enablePostGet:function(request){return this._changeGetToPost(request),"POST"},_shouldUsePostGet:function(method,request){return"GET"===method&&request.operation&&(request.operation.enablePostGet||this._hasTooManyFetchParams(request))},_hasTooManyFetchParams:function(request){return request.operation.fetch&&request.operation.fetch.length>MAX_FETCH_LENGTH},_changeGetToPost:function(request){request.params&&(request.params._method="GET")},buildUrl:function(request){this.mixins.proxy.buildUrl.call(this,request);var url=this.callParent(arguments);return url},processResponse:function(success,operation,request,response,callback,scope){success=this.mixins.proxy.processResponse.call(this,success,operation,request,response,callback,scope),this.callParent([success,operation,request,response,callback,scope])},setException:function(operation,response){this.mixins.proxy.setException.call(this,operation,response)},encodeFilters:function(filters){return this.mixins.proxy.encodeFilters.call(this,filters)},encodeSorters:function(sorters){return this.mixins.proxy.encodeSorters.call(this,sorters)},parseResponse:function(response){return Ext.JSON.decode(response.responseText)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.env.IoProvider",{statics:{_securityToken:null,setSecurityToken:function(securityToken){this._securityToken=securityToken},getSecurityToken:function(){return Rally.env.IoProvider._securityToken}},constructor:function(){Ext.Ajax.on("beforerequest",this._attachSecurityToken),Ext.data.JsonP.on("beforerequest",this._attachSecurityToken),this.callParent(arguments)},httpGet:function(getConfig){function getResponseErrors(queryResult){var errors=queryResult&&queryResult.Errors;return errors||[]}function failure(result){var callbackParam=result,responseErrors=getResponseErrors(result);responseErrors.length&&(callbackParam=responseErrors),Ext.callback(getConfig.failure,getConfig.scope||this,[callbackParam])}function success(response){var queryResult,responseErrors,result=response;if(result.responseText)try{result=Ext.JSON.decode(result.responseText)}catch(e){return void Ext.callback(getConfig.success,getConfig.scope||this,[result])}queryResult=Ext.Object.getValues(result)[0],responseErrors=getResponseErrors(queryResult),responseErrors.length?failure(queryResult):Ext.callback(getConfig.success,getConfig.scope||this,[queryResult])}var url=getConfig.url,disableCaching=getConfig.enableCaching===!1,noQueryScoping=getConfig.noQueryScoping,server=Rally.environment.getServer(),headers=getConfig.headers||{};url||(url=server.getWsapiUrl(getConfig.wsapiVersion),getConfig.type?url+="/"+getConfig.type+server.getWsapiRestExtension(getConfig.wsapiVersion):getConfig.item&&(url+=Rally.util.Ref.getRelativeUri(getConfig.item)+server.getWsapiRestExtension(getConfig.wsapiVersion)));var params=getConfig.params||{};Ext.isArray(params.fetch)&&(params.fetch=params.fetch.join(",")),params.query&&Ext.isFunction(params.query.toString)&&(params.query=params.query.toString()),this.doRequest({requester:getConfig.requester,url:url,params:params,success:success,failure:failure,callback:getConfig.callback,scope:getConfig.scope,method:"GET",disableCaching:disableCaching,enableQueuing:getConfig.enableQueuing,noQueryScoping:noQueryScoping,headers:headers})},doRequest:function(request){Ext.Ajax.request(request)},getProxy:function(proxyConfig){var defaultConfig={wsapiVersion:Rally.environment.getServer().getWsapiVersion(),type:"rallywsapiproxy"};return Ext.merge(defaultConfig,proxyConfig)},getLookbackProxy:function(proxyConfig){return Ext.apply({},proxyConfig,{type:"rallylookbackproxy"})},_attachSecurityToken:function(conn,opts,eOpts){(opts.action&&"read"!==opts.action||opts.method&&"GET"!==opts.method)&&(opts.params=opts.params||{},opts.params.key=Rally.env.IoProvider.getSecurityToken())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.env.Environment",{context:null,constructor:function(config){Ext.apply(this,config)},getContext:function(){return this.context},getGlobalContext:function(){return this.getContext()},getServer:function(){return this.server||(this.server=Ext.create("Rally.env.Server")),this.server},getIoProvider:function(){return this.ioProvider||(this.ioProvider=Ext.create("Rally.env.IoProvider")),this.ioProvider},getMessageBus:function(){return this.messageBus||(this.messageBus=Ext.create("Rally.MessageBus")),this.messageBus}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.TimeboxComboBox",{extend:Rally.ui.combobox.ComboBox,config:{storeConfig:{limit:1/0,context:{projectScopeDown:!1,projectScopeUp:!1},remoteFilter:!1,autoLoad:!0},listConfig:{itemTpl:new Ext.XTemplate('<div style="text-overflow: ellipsis; overflow: hidden; white-space: nowrap;" class="timebox-name<tpl if="isSelected"> timebox-item-selected</tpl>">{formattedName}</div><div class="timebox-dates<tpl if="isSelected"> timebox-item-selected</tpl>"><tpl if="formattedStartDate">{formattedStartDate} &ndash; {formattedEndDate}</tpl></div>'),minWidth:406,maxWidth:406,cls:"timebox-list",shadow:"drop"},showArrows:!0,startDateField:"StartDate",endDateField:"EndDate",displayField:"formattedName",width:350,editable:!1,queryMode:"local",noEntryText:"Unscheduled",defaultToCurrentTimebox:!0},constructor:function(config){this.callParent(arguments),this.comboBoxPreviousNextArrowsPlugin&&(this.rendered?this.comboBoxPreviousNextArrowsPlugin.enableDisableArrows():this.on("afterrender",function(){this.comboBoxPreviousNextArrowsPlugin.enableDisableArrows()},this))},initComponent:function(){this.showArrows&&(this.pickerOffset=[21,0],this.displayTpl=Ext.create("Ext.XTemplate",'<tpl for=".">{formattedName}<tpl if="formattedStartDate"> ({formattedStartDate} - {formattedEndDate})</tpl></tpl>')),this.callParent(arguments),this.store.on("add",this._onStoreAdd,this),this.on("change",this._onChange,this),this.on("expand",this._onExpand,this)},_onExpand:function(){if(!this.tooltip){var tooltipConfig={target:this.getPicker().getEl(),delegate:"."+Ext.baseCSSPrefix+"boundlist-item",anchor:"top",html:"",showDelay:700,listeners:{beforeshow:function(tooltip){if(!tooltip.target.isVisible())return!1;var timeboxDiv=Ext.get(tooltip.triggerElement).down(".timebox-name");tooltip.update(timeboxDiv.getHTML())},scope:this}};Ext.isSafari&&(tooltipConfig.anchorOffset=-3,tooltipConfig.minWidth="auto !important"),this.tooltip=Ext.create("Ext.tip.ToolTip",tooltipConfig)}},getQueryFromSelected:function(){return Ext.create("Rally.app.TimeboxScope",{record:this.getRecord(),type:this.store.model.typePath}).getQueryFilter()},setProject:function(project){this.reloadStoreWithNewProject(project)},getRecord:function(){return null===this.getValue()?null:this.callParent(arguments)},_onStoreLoad:function(store){try{store.suspendEvents(),this.callParent(arguments),this._decorateRecords()}finally{store.resumeEvents()}this.picker&&this.picker.refresh()},_onStoreAdd:function(store,records){this._decorateRecords()},_onChange:function(comboBox,newValue,oldValue){var newRecord=this.store.findRecord(this.valueField,newValue),oldRecord=this.store.findRecord(this.valueField,oldValue);newRecord?(newRecord.set("isSelected",!0),this._setUnscheduledIsSelected(!1)):this._setUnscheduledIsSelected(!0),oldRecord&&oldRecord.set("isSelected",!1)},_setUnscheduledIsSelected:function(selected){var valueField=this.valueField,noEntryValue=this.noEntryValue,unscheduled=_.find(this.store.data.getRange(),function(record){return record.get(valueField)===noEntryValue},this);unscheduled&&unscheduled.set("isSelected",selected)},getDefaultValue:function(){return this.callParent()||this._findCurrentTimebox()},_decorateRecords:function(){var selected,store=this.store;store&&(selected=this.getDefaultValue(),store.each(function(record){record.get("formattedName")===this.noEntryText?record.set("Name",this.noEntryText):record.get("formattedName")===this.clearText?record.set("Name",this.clearText):record.set("formattedName",record.get("Name")),record.set("formattedStartDate",Rally.util.DateTime.formatDate(record.get(this.startDateField))),record.set("formattedEndDate",Rally.util.DateTime.formatDate(record.get(this.endDateField))),record.set("isSelected",record.get(this.valueField)===(selected&&selected._ref?selected._ref:selected))},this))},_findCurrentTimebox:function(){if(this.getDefaultToCurrentTimebox()){var now=new Date,current=null;return this.store.each(function(timebox){timebox.get(this.startDateField)<=now&&timebox.get(this.endDateField)>=now&&(!current||timebox.get(this.endDateField)<current.get(this.endDateField))&&(current=timebox)},this),current?current.get(this.valueField):null}},_onObjectCreate:function(record,component){var recordTypeName=Rally.data.ModelTypes.getTypeByName(record.self.typePath).toLowerCase(),scopeTypeName=Rally.data.ModelTypes.getTypeByName(this.scopeType).toLowerCase(),typeMatch=recordTypeName===scopeTypeName,scopeComboBox=this.timeboxComboBox,currentScopeRecord=scopeComboBox&&scopeComboBox.getRecord();typeMatch&&Rally.util.Ref.getRelativeUri(record.get("Project")._ref)===Rally.util.Ref.getRelativeUri(Rally.environment.getContext().getProject()._ref)&&(scopeComboBox.store.add(record),scopeComboBox&&!currentScopeRecord&&scopeComboBox.setValue(record.get("_ref")))},onDestroy:function(){this.tooltip&&(Ext.destroy(this.tooltip),delete this.tooltip),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.plugin.PreviousNextArrows",{extend:Ext.AbstractPlugin,alias:"plugin.rallycomboboxpreviousnextarrows",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},arrowUserAction:"Arrow value changed",init:function(comboBox){this.comboBox=comboBox,comboBox.showArrows&&(comboBox.comboBoxPreviousNextArrowsPlugin=this,comboBox.renderSelectors.leftArrow=".combobox-left-arrow",comboBox.renderSelectors.rightArrow=".combobox-right-arrow",Ext.override(comboBox,{getSubTplMarkup:this.getSubTplMarkup,getFieldStyle:this.getFieldStyle}),this.leftArrowFn=this._onArrowClick(comboBox.invertArrows===!0?this._incrementSelectedIndex:this._decrementSelectedIndex,"leftArrow"),this.rightArrowFn=this._onArrowClick(comboBox.invertArrows===!0?this._decrementSelectedIndex:this._incrementSelectedIndex,"rightArrow"),comboBox.on("afterrender",this._onComboBoxAfterRender,this),comboBox.on("change",this._onComboBoxChange,this),comboBox.store.on("load",this.enableDisableArrows,this,{single:!0}))},destroy:function(){this.comboBox.un("afterrender",this._onComboBoxAfterRender,this),this.comboBox.un("change",this._onComboBoxChange,this),this.comboBox.leftArrow&&(this.comboBox.leftArrow.destroy(),delete this.comboBox.leftArrow),this.comboBox.rightArrow&&(this.comboBox.rightArrow.destroy(),delete this.comboBox.rightArrow),delete this.comboBox},enableDisableArrows:function(){var cb=this.comboBox;cb.getStore().getCount()?(this._shouldDisableLeftArrow()?cb.leftArrow.addCls("rly-disabled"):cb.leftArrow.removeCls("rly-disabled"),this._shouldDisableRightArrow()?cb.rightArrow.addCls("rly-disabled"):cb.rightArrow.removeCls("rly-disabled")):(cb.leftArrow.addCls("rly-disabled"),cb.rightArrow.addCls("rly-disabled"))},getFieldStyle:function(){var style=this.callParent();return Ext.isIE?style.replace(/width:\s?100%;/,""):style},getSubTplMarkup:function(){var markup=this.callParent(arguments),beforeMarkup=Ext.DomHelper.markup({tag:"td",cls:"combobox-left-arrow icon-chevron-left",style:{width:"21px",display:"table-cell"}}),afterMarkup=Ext.DomHelper.markup({tag:"td",cls:"combobox-right-arrow icon-chevron-right",style:{width:"21px",display:"table-cell"}}),trBeginIndex=markup.indexOf(">",markup.indexOf("<tr")),trEndIndex=markup.indexOf("</tr>");return markup.substring(0,trBeginIndex+1)+beforeMarkup+markup.substring(trBeginIndex+1,trEndIndex)+afterMarkup+markup.substring(trEndIndex,markup.length)},_onComboBoxAfterRender:function(){this.comboBox.leftArrow.on("click",this.leftArrowFn,this),this.comboBox.rightArrow.on("click",this.rightArrowFn,this)},_onComboBoxChange:function(){this.enableDisableArrows()},_shouldDisableLeftArrow:function(){return this.comboBox.invertArrows===!0?this.getSelectedIndex()===this.comboBox.getStore().getCount()-1:0===this.getSelectedIndex()},_shouldDisableRightArrow:function(){return this.comboBox.invertArrows===!0?0===this.getSelectedIndex():this.getSelectedIndex()===this.comboBox.getStore().getCount()-1},_onArrowClick:function(changeValueFn,arrowProperty){var me=this,cb=me.comboBox;return function(e,target,eOpts){cb[arrowProperty].hasCls("rly-disabled")||(me.recordAction({description:cb.arrowUserAction,component:cb}),changeValueFn.apply(me))}},_incrementSelectedIndex:function(){this.setSelectedIndex(this.getSelectedIndex()+1)},_decrementSelectedIndex:function(){this.setSelectedIndex(this.getSelectedIndex()-1)},setSelectedIndex:function(index){var store=this.comboBox.getStore(),count=store.getCount();if(count&&index>=0&&index<count){var record=store.getAt(index);this.comboBox.setValue(record),this.comboBox.fireEvent("select",this.comboBox,record)}},getSelectedIndex:function(){return this.comboBox.getStore().indexOf(this.comboBox.findRecordByValue(this.comboBox.getValue()))}})}(),function(){var Ext=window.Ext4||window.Ext,START_DATE_FIELD="ReleaseStartDate",END_DATE_FIELD="ReleaseDate";Ext.define("Rally.ui.combobox.ReleaseComboBox",{extend:Rally.ui.combobox.TimeboxComboBox,alias:"widget.rallyreleasecombobox",config:{name:"Release",storeConfig:{fetch:["Name",START_DATE_FIELD,END_DATE_FIELD,"ObjectID","State","PlannedVelocity"],sorters:[{property:START_DATE_FIELD,direction:"DESC"},{property:END_DATE_FIELD,direction:"DESC"}],model:Ext.identityFn("Release")},listConfig:{emptyText:"No Releases Defined"},startDateField:START_DATE_FIELD,endDateField:END_DATE_FIELD,onChangeUserAction:"Release change via combo box",componentCls:"rui-triggerfield rally-release-combobox"},constructor:function(config){this.mergeConfig(config),this.plugins=this.plugins||[],this.plugins.push({ptype:"rallycomboboxpreviousnextarrows",arrowUserAction:"Release change via arrow button"}),this.callParent([this.config])},initComponent:function(){var autoLoadStore=this.storeConfig&&this.storeConfig.autoLoad;this.callParent(arguments),autoLoadStore||this.onReady()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.plugin.RealtimeUpdate",{extend:Ext.AbstractPlugin,alias:"plugin.rallycomboboxrealtimeupdate",mixins:{messageable:Rally.Messageable},config:{realtimeContext:void 0},init:function(comboBox){this.realtimeContext||Ext.Error.raise('"realtimeContext" config parameter was not defined.'),this.callParent(arguments),this.comboBox=comboBox,this.subscribe(Rally.Message.objectCreate,this._onObjectCreate,this)},destroy:function(){this.callParent(arguments),this.unsubscribe(Rally.Message.objectCreate,this._onObjectCreate,this)},_onObjectCreate:function(record,component){var comboBox=this.comboBox,comboBoxModel=comboBox.store.model,recordTypeName=Rally.data.ModelTypes.getTypeByName(record.self.typePath).toLowerCase(),scopeTypeName=comboBoxModel&&Rally.data.ModelTypes.getTypeByName(comboBoxModel.typePath).toLowerCase(),typeMatch=recordTypeName===scopeTypeName;if(typeMatch&&Rally.util.Ref.getRelativeUri(record.get("Project")._ref)===Rally.util.Ref.getRelativeUri(this.realtimeContext.getProject()._ref)){comboBox.getStore().add(record);var noItemsCount=comboBox.allowNoEntry?1:0;comboBox.getStore().getCount()===noItemsCount+1&&(comboBox.setValue(record.get("_ref")),comboBox.fireEvent("select",comboBox,record))}}})}(),function(){var Ext=window.Ext4||window.Ext,START_DATE_FIELD="StartDate",END_DATE_FIELD="EndDate";Ext.define("Rally.ui.combobox.IterationComboBox",{extend:Rally.ui.combobox.TimeboxComboBox,alias:"widget.rallyiterationcombobox",config:{name:"Iteration",storeConfig:{fetch:["Name",START_DATE_FIELD,END_DATE_FIELD,"ObjectID","State","PlannedVelocity"],sorters:[{property:START_DATE_FIELD,direction:"DESC"},{property:END_DATE_FIELD,direction:"DESC"}],model:Ext.identityFn("Iteration")},listConfig:{emptyText:"No Iterations Defined"},startDateField:START_DATE_FIELD,endDateField:END_DATE_FIELD,onChangeUserAction:"Iteration change via combo box",avoidUnscheduledIteration:!1,componentCls:"rui-triggerfield rally-iteration-combobox"},constructor:function(config){this.mergeConfig(config),this.plugins=this.plugins||[],this.plugins.push({ptype:"rallycomboboxpreviousnextarrows",arrowUserAction:"Iteration change via arrow button"}),this.callParent([this.config])},setDefaultValue:function(){this.callParent(arguments),this.isDestroyed||this._shouldAvoidUnscheduledIteration()&&this.setValue(this.store.getAt(1).get(this.valueField))},_shouldAvoidUnscheduledIteration:function(){if(this.avoidUnscheduledIteration&&this.store.getCount()){var currentValue=this.getValue();return currentValue===this.noEntryValue&&currentValue!==this.stateValue&&this.store.getCount()>1}return!1}})}(),function(){var Ext=window.Ext4||window.Ext,userEditorFn=function(field){return{xtype:"rallyownereditor",field:{xtype:"rallyusersearchcombobox",autoExpand:!0,autoSelect:!1,autoSelectCurrentItem:!1,selectOnTab:!0,listConfig:{width:200}}}},allowedValuesEditorFn=function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyfieldvaluecombobox",autoExpand:!0,field:field,storeConfig:{autoLoad:!1}}}},stringEditorFn=function(field){return field.hasAllowedValues()?allowedValuesEditorFn(field):{xtype:"rallytextfield",removeNameAttribute:!0}},decimalEditorFn=function(field){return Rally.ui.renderer.GridEditorFactory.getDecimalEditorConfig(field,{xtype:"rallynumberfield"})},editorByPermissionsFn=function(field){return Rally.environment.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()?this.string(field):null};Ext.define("Rally.ui.renderer.GridEditorFactory",{singleton:!0,getEditor:function(field){var config,fieldName=field.name;return config=this.editorRenderers[fieldName]?this.editorRenderers[fieldName](field):field.attributeDefinition&&this.editorRenderers[field.attributeDefinition.AttributeType.toLowerCase()]?this.editorRenderers[field.attributeDefinition.AttributeType.toLowerCase()](field):this.defaultEditor,this.addValidationHandling(config,field),config},defaultEditor:void 0,addValidationHandling:function(config,field){var validations={validateOnChange:!0,validateOnBlur:!0,plugins:["rallyfieldvalidationui"]},fieldName=field.name;this.fieldValidations[fieldName]&&_.defaults(validations,this.fieldValidations[fieldName](field)),_.defaults(config&&config.field?config.field:config,validations)},getDecimalEditorConfig:function(field,config){var defaultConfig={minValue:0,allowDecimals:!0};return("long"===field.attributeDefinition.SchemaType||field.attributeDefinition.MaxFractionalDigits<=0)&&(defaultConfig.allowDecimals=!1),field.attributeDefinition.MaxLength>-1&&(defaultConfig.enforceMaxLength=!0,defaultConfig.maxLength=field.attributeDefinition.MaxLength,defaultConfig.maxValue=Math.pow(10,field.attributeDefinition.MaxLength)-1,defaultConfig.allowDecimals&&(defaultConfig.maxLength=defaultConfig.maxLength+field.attributeDefinition.MaxFractionalDigits+1,defaultConfig.decimalPrecision=field.attributeDefinition.MaxFractionalDigits,defaultConfig.maxValue+=(Math.pow(10,field.attributeDefinition.MaxFractionalDigits)-1)/Math.pow(10,field.attributeDefinition.MaxFractionalDigits))),_.defaults(config||{},defaultConfig)},fieldValidations:{Name:function(field){return{allowBlank:!1,maxLength:field.attributeDefinition.MaxLength}}},editorRenderers:{collectionEditorCfg:{Milestone:{xtype:"rallymilestoneeditor"},CustomMultiValue:{xtype:"rallycollectioneditor"}},text:function(field){
var editor={xtype:"textarea",cls:"rally-textarea-component",enterIsSpecial:!0,grow:!0,growMin:18,growAppend:""};return field&&field.attributeDefinition&&Ext.apply(editor,{enforceMaxLength:!0,maxLength:field.attributeDefinition.MaxLength}),editor},string:stringEditorFn,collection:function(field){if(field.attributeDefinition.AllowedValueType){var allowedTypeName=field.attributeDefinition.AllowedValueType._refObjectName;if(this.collectionEditorCfg.hasOwnProperty(allowedTypeName))return this.collectionEditorCfg[allowedTypeName]}else if(field.isMultiValueCustom()&&Rally.ui.renderer.GridEditorFactory.enableMultiValueCustomFields&&Rally.ui.renderer.GridEditorFactory.enableMultiValueCustomFields())return _.merge({field:{field:field}},this.collectionEditorCfg.CustomMultiValue);return this.defaultEditor},boolean:function(field){return{xtype:"rallycombobox",autoExpand:!0,displayField:"name",valueField:"value",editable:!1,storeType:"Ext.data.Store",storeConfig:{remoteFilter:!1,fields:["name","value"],data:[{name:"Yes",value:!0},{name:"No",value:!1}]}}},decimal:decimalEditorFn,integer:decimalEditorFn,float:decimalEditorFn,rank:decimalEditorFn,quantity:decimalEditorFn,rating:allowedValuesEditorFn,state:allowedValuesEditorFn,date:function(field){return{xtype:"rallydatefield",format:Rally.util.DateTime.getUserExtDateFormat(),validateOnChange:!1}},WIPLimit:function(field){return Rally.ui.renderer.GridEditorFactory.getDecimalEditorConfig(field,{xtype:"rallynumberfield",minValue:-1})},FormattedID:function(){return{xtype:"rallytextfield",removeNameAttribute:!0}},DeletedBy:userEditorFn,Owner:userEditorFn,SubmittedBy:userEditorFn,Tester:userEditorFn,User:userEditorFn,PlanEstimate:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="plan-estimate-editor",editor.hideTrigger=!0,editor},PreliminaryEstimate:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallycombobox",allowNoEntry:!field.required,editable:!1,name:field.name,storeConfig:{autoLoad:!0,model:field.name,remoteFilter:!0}}}},RefinedEstimate:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="refined-estimate-editor",editor.hideTrigger=!0,editor},TaskEstimates:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="task-estimate-editor",editor.hideTrigger=!1,editor},Actuals:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="task-actuals-editor",editor.hideTrigger=!0,editor},ToDo:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="task-todo-editor",editor.hideTrigger=!1,editor},TaskRemainingTotal:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="task-todo-editor",editor.hideTrigger=!1,{xtype:"rallytaskremainingtotaleditor",field:editor}},Estimate:function(field){var editor=decimalEditorFn.call(this,field);return editor.cls="task-estimate-editor",editor.hideTrigger=!0,editor},Phone:editorByPermissionsFn,Project:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyprojectcombobox",validateOnChange:!1}}},Iteration:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyiterationcombobox",name:field.name,autoExpand:!0,autoSelectCurrentItem:!1,allowNoEntry:!0,showArrows:!1,editable:!0,typeAhead:!0,forceSelection:!0,selectOnFocus:!0,defaultToCurrentTimebox:!1,storeConfig:{autoLoad:!1}}}},Release:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyreleasecombobox",name:field.name,autoExpand:!0,autoSelectCurrentItem:!1,allowNoEntry:!0,allowUnscheduled:!0,showArrows:!1,editable:!0,typeAhead:!0,forceSelection:!0,selectOnFocus:!0,defaultToCurrentTimebox:!1,storeConfig:{autoLoad:!1}}}},ScheduleState:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyfieldvaluecombobox",autoExpand:!0,editable:!1,field:field,listeners:{beforeselect:function(combo){combo.ownerCt.editingPlugin&&combo.ownerCt.editingPlugin.getActiveRecord().set({Blocked:!1,Ready:!1})}},selectOnFocus:!1,storeConfig:{autoLoad:!1}}}},State:function(field){return{xtype:"rallyrecordcontexteditor",field:{xtype:"rallyfieldvaluecombobox",autoExpand:!0,field:field,storeConfig:{autoLoad:!1}}}},NetworkID:editorByPermissionsFn,Role:editorByPermissionsFn,Department:editorByPermissionsFn,OfficeLocation:editorByPermissionsFn,CostCenter:editorByPermissionsFn,DisplayColor:function(field){return{xtype:"rallycombobox",typeAhead:!0,allowNoEntry:!0,noEntryText:"None",noEntryValue:"",selectOnFocus:!0,autoExpand:!0,displayField:"name",valueField:"value",store:Ext.create("Ext.data.Store",{fields:["name","value"],data:Rally.util.Colors.DISPLAY_COLOR_PALETTE})}},TargetProject:function(field){return{xtype:"rallymilestoneprojecteditor",field:{xtype:"rallymilestoneprojectcombobox",autoExpand:!0}}},Type:function(field){if("OBJECT"===field.attributeDefinition.AttributeType){var piFilters=Rally.data.wsapi.Filter.and([{property:"Parent.Name",operator:"=",value:"Portfolio Item"},{property:"Creatable",operator:"=",value:"true"}]),filters=piFilters.or(Rally.data.wsapi.Filter.or([{property:"Name",operator:"=",value:"Defect"},{property:"Name",operator:"=",value:"Hierarchical Requirement"},{property:"Name",operator:"=",value:"Task"},{property:"Name",operator:"=",value:"Test Case"},{property:"Name",operator:"=",value:"Milestone"}]));return{xtype:"rallycombobox",editable:!0,typeAhead:!0,forceSelection:!0,selectOnFocus:!0,autoExpand:!0,storeConfig:{autoLoad:!0,model:Ext.identityFn("TypeDefinition"),limit:1/0,remoteFilter:!0,sorters:{property:"ObjectID",direction:"Asc"},fetch:["DisplayName","ObjectID"],filters:filters},name:field.name,displayField:"DisplayName",valueField:"_ref"}}return allowedValuesEditorFn(field)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.blockedreason.BlockedReasonHelper",{statics:{getTemplate:function(){return Ext.create("Ext.XTemplate",['<div class="{className} {editableClass} {requiredClass}">','<div class="rally-blocked-reason-template">',"<tpl if=\"blockedReason !== ''\">","{blockedReason}","<tpl else>",'<span class="empty">None</span>',"</tpl>","</div>","</div>"])}},getEditorField:function(targetEl,fieldMaxLength,config){var defaultConfig={xtype:"textarea",cls:"rally-textarea-component blocked-reason-editor",enterIsSpecial:!0,enforceMaxLength:!0,maxLength:fieldMaxLength,growAppend:"",width:targetEl.getWidth(),height:this.editorHeight,emptyText:"Why is this blocked?"};return Ext.merge(Rally.ui.renderer.GridEditorFactory.editorRenderers.text(),defaultConfig,config)},getEditorConfig:function(parentEl,edField,config){var defaultConfig={cls:"rally-card-editor",field:edField,shadow:!1,alignment:"br-br",completeOnEnter:!0,cancelOnEsc:!0,listeners:{complete:this._onEditorComplete,canceledit:this._onCancelEdit,specialkey:this._onSpecialKey,scope:this}};return Ext.merge(defaultConfig,config)},_onSpecialKey:function(editor,field,event){event.getKey()===Ext.EventObject.TAB&&(editor.completeEdit(),event.preventDefault())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardBlockedReason",{extend:Ext.AbstractPlugin,alias:"plugin.rallycardblockedreason",mixins:[Rally.ui.blockedreason.BlockedReasonHelper,Ext.util.Observable],tplCls:"rally-blocked-reason-content",_editOnRender:!1,inheritableStatics:{getTpl:function(tplCls){return this.tpl||(this.tpl=Rally.ui.blockedreason.BlockedReasonHelper.getTemplate(tplCls)),this.tpl}},init:function(card){this.callParent(arguments),this.card=card,card.blockedReasonPlugin=this,!this.isBlockedOrBlockedReasonHidden()&&this._isCardEditable()&&(this.mon(this.card,"afterrender",this._onAfterRender,this),this.mon(this.card,"rerender",this._onReRender,this),this.mon(this.card,"statechange",this._onCardStateChange,this),this.mon(this.card,"blocked",this._onCardBlocked,this))},destroy:function(){this.card&&(delete this.card.blockedReasonPlugin,delete this.card),this.callParent(arguments)},getHtml:function(){return this._shouldDisplayBlockedReason()?this.self.getTpl(this.tplCls).apply({blockedReason:this.card.getRecord().get("BlockedReason"),editableClass:this._isCardEditable()?"editable":"",requiredClass:this._editOnRender?"required":"",className:this.tplCls}):""},_onCardStateChange:function(){this.activeEditor&&this.activeEditor.cancelEdit()},_onCardBlocked:function(){this._editOnRender=!0},_onAfterRender:function(){this._attachClickListenerToBlockedReason()},_onReRender:function(){if(this._attachClickListenerToBlockedReason(),!this.activeEditor&&this._editOnRender){var targetEl=this.card.getEl().down("."+this.tplCls+" .rally-blocked-reason-template");targetEl&&this.startEdit()}},startEdit:function(){if(!this.activeEditor&&this.card.getEl().isVisible(!0)){var containerEl=this.card.getEl().down("."+this.tplCls),targetEl=containerEl.createChild({tag:"div",cls:"editor-container"}),field=this.card.getRecord().getField("BlockedReason"),fieldMaxLength=field?field.attributeDefinition.MaxLength:256,value=this.card.getRecord().get("BlockedReason"),edField=this.getEditorField(targetEl,fieldMaxLength,{grow:!0,growMin:24}),editorConfig=this.getEditorConfig(null,edField,{cls:"rally-card-editor",label:field.attributeDefinition?field.attributeDefinition.Name:"Blocked Reason",parentEl:targetEl,hideEl:!1,offsets:Ext.isWebKit?[0,3]:[0,0]});this.card.contentEditingPlugin.setEditingContext("BlockedReason",edField),this.activeEditor=this.activeEditor||Ext.create("Ext.Editor",editorConfig),Ext.defer(function(){var blockedReasonEl=this._getBlockedReasonEl();blockedReasonEl&&blockedReasonEl.hide(),this.activeEditor.startEdit(targetEl,value)},1,this)}},_getBlockedReasonEl:function(){return this.card.getEl().down("."+this.tplCls+" .rally-blocked-reason-template")},_cardBlocked:function(){this.card.getRecord().get("Blocked")===!1&&(this._editOnRender=!0)},_onEditorComplete:function(editor,newValue,oldValue,eOpts){this.card.contentEditingPlugin.editorCompleteHandler(editor,newValue,oldValue,eOpts,"BlockedReason"),this.completeEdit()},_onCancelEdit:function(){this.completeEdit()},_resetEditor:function(){this.activeEditor&&this.activeEditor.destroy(),this.activeEditor=null,this.card.getEl()&&this.card.getEl().down("."+this.tplCls).removeCls("required");var blockedReasonEl=this._getBlockedReasonEl();blockedReasonEl&&blockedReasonEl.show()},completeEdit:function(){this._editOnRender=!1,this._resetEditor()},_attachClickListenerToBlockedReason:function(){var blockedIconEl=this.card.getEl().down(".rally-card-icons .card-blocked-icon");blockedIconEl&&this.mon(blockedIconEl,"click",this._cardBlocked,this),this._shouldDisplayBlockedReason()&&this.mon(this.card.getEl().down(".rui-card-content"),"click",this.startEdit,this,{delegate:"."+this.tplCls+".editable",stopEvent:!0})},_shouldDisplayBlockedReason:function(){return!this.isBlockedOrBlockedReasonHidden()&&(this.card.getRecord().get("Blocked")===!0||""!==this.card.getRecord().get("BlockedReason"))},isBlockedOrBlockedReasonHidden:function(){return this._isFieldHidden("Blocked")||this._isFieldHidden("BlockedReason")},_isFieldHidden:function(fieldName){var field=this.card.getRecord().self.getField(fieldName);return!field||field.custom||field.hidden},_isCardEditable:function(){return this.card.getRecord().get("updatable")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardAge",{extend:Ext.AbstractPlugin,alias:"plugin.rallycardage",inheritableStatics:{},init:function(cmp){this.callParent(arguments),this._addField()},_addField:function(){var me=this,cmp=me.cmp;this.cmp.addField({name:cmp.ageFieldName,renderTpl:function(){var age=me._getAge();return age>=cmp.showAge?['<div class="',["status-value",cmp.ageFieldName,"age"].join(" "),'">',"<span>",age.toString()," ",Ext.util.Inflector.pluralize(cmp.ageIntervalUnit),"</span>","</div>"].join(""):""},isStatus:!0,hasValue:function(){var record=cmp.getRecord();return void 0!==record.raw[cmp.ageFieldName]||record.get(cmp.ageFieldName)}})},_getAge:function(){var cmp=this.cmp,lastUpdate=cmp.getRecord().get(cmp.ageFieldName);return Ext.isEmpty(lastUpdate)?0:Rally.util.DateTime.getDifference(new Date,Rally.util.DateTime.fromIsoString(lastUpdate),cmp.ageIntervalUnit)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.CardEditorFactory",{singleton:!0,nonEditableFields:["Milestones","Owner","Tags"],getEditor:function(field){var defaultEditorField=this._getDefaultEditor(field);if(defaultEditorField&&this._isEditable(field)){var typeEditorConfig=this._getTypeSpecificConfig(field),cardEditorConfig=this._getFieldSpecificConfig(field),editor=Ext.merge(defaultEditorField,typeEditorConfig,cardEditorConfig);return editor}},_getDefaultEditor:function(field){var defaultEditor=Rally.ui.renderer.GridEditorFactory.getEditor(field);return defaultEditor&&defaultEditor.field&&defaultEditor.field.xtype?defaultEditor.field:defaultEditor},_isEditable:function(field){return!field.readOnly&&field.attributeDefinition&&!_.contains(this.nonEditableFields,field.name)},_getTypeSpecificConfig:function(field){var editorConfig={minWidth:70};return _.contains(["quantity","integer","decimal","boolean"],field.attributeDefinition.AttributeType.toLowerCase())?editorConfig.maxWidth=70:field.hasAllowedValues()?(editorConfig.storeConfig={autoLoad:!0},editorConfig.maxWidth=150):_.contains(["string","text"],field.attributeDefinition.AttributeType.toLowerCase())?Ext.apply(editorConfig,{xtype:"textarea",cls:"rally-textarea-component",enterIsSpecial:!0,grow:!0,growMin:24,enforceMaxLength:!0,growAppend:"",maxLength:field.attributeDefinition.MaxLength}):"date"===field.attributeDefinition.AttributeType.toLowerCase()&&(editorConfig.minWidth=95,editorConfig.maxWidth=95),editorConfig},_getFieldSpecificConfig:function(field){return this._editorConfigs[field.name]},_editorConfigs:{Estimate:{hideTrigger:!0,minWidth:18},PlanEstimate:{minWidth:18},PreliminaryEstimate:{minWidth:75,queryMode:"local",listeners:{focus:function(el){el.expand()},select:function(el){el.up().completeEdit()}}},RefinedEstimate:{minWidth:18}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardEditing",{alias:"plugin.rallycardediting",extend:Ext.AbstractPlugin,mixins:{observable:Ext.util.Observable,messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},nonContentEditableFields:["Owner","PlanEstimate","Estimate"],editableCls:"editable",_validationTooltips:{},constructor:function(config){this.addEvents("beforeedit","canceledit","inlineedit","inlineeditsaved"),this.callParent(arguments),this.mixins.observable.constructor.call(this)},init:function(card){card.contentLeftPlugin&&(this.card=card,card.contentEditingPlugin=this,this.mon(card,"afterrender",this._onAfterRender,this),this.mon(card,"rerender",this._onAfterRender,this),card.relayEvents(this,["beforeedit","canceledit","inlineedit","inlineeditsaved"]))},destroy:function(){this.card&&(this.mun(this.card,"afterrender",this._onAfterRender,this),this.mun(this.card,"rerender",this._onAfterRender,this),delete this.card.contentEditingPlugin,delete this.card),this.activeEditor&&(this.activeEditor.destroy(),delete this.activeEditor),this.detachListeners(),_.each(_.keys(this._validationTooltips),this._cleanupValidation,this)},getActiveEditorInputId:function(){return this.activeEditor.field.inputEl.id},getActiveEditor:function(){return this.activeEditor},detachListeners:function(){this.card&&this.card.getRecord().get("updatable")!==!1&&this.card.getEl().un("click",this._onFieldStartEdit,this)},getEditingContext:function(){return this.context||{}},_getEditorConfigFor:function(fieldName,targetEl){if(_.contains(["PlanEstimate","Estimate","PreliminaryEstimate"],fieldName))return{alignment:"br-br",offsets:[targetEl.getPadding("r")+targetEl.getBorderWidth("r"),targetEl.getPadding("b")+targetEl.getBorderWidth("b")]}},_onAfterRender:function(){this.card.getRecord().get("updatable")!==!1&&(this.card.getEl().on("click",this._onFieldStartEdit,this,{delegate:".field-content."+this.editableCls,stopEvent:!0,buffer:1}),this._markEditableFields())},_markEditableFields:function(){Ext.Array.forEach(this.card.getDisplayedFields(),function(fieldName,fieldIdx){this._markFieldEditable(fieldName)},this)},_markFieldEditable:function(fieldName){var field=this.card.getRecord().getField(fieldName),fieldEl=this.card.getEl().down(".field-content."+fieldName);field&&this._isFieldEditable(field)&&fieldEl&&(fieldEl.addCls(this.editableCls),this.fieldElementNameMap||(this.fieldElementNameMap={}),this.fieldElementNameMap[fieldEl.id]=fieldName)},_isFieldEditable:function(field){return!!Rally.ui.cardboard.CardEditorFactory.getEditor(field)},_getEditorFieldWidth:function(targetEl){var fieldLabelEl=targetEl.down(".rui-field-label"),fieldValueEl=targetEl.down(".rui-field-value"),isCardEstimateField=targetEl.up(".card-estimate-field");return isCardEstimateField?fieldValueEl.parent().getWidth():fieldLabelEl&&fieldLabelEl.getX()!==fieldValueEl.getX()?fieldValueEl.parent().getWidth()-fieldLabelEl.getWidth():fieldValueEl.getWidth()},_onFieldStartEdit:function(evt,target){if(!(this._editSaveInProgress||this.activeEditor&&this.context.fieldName===this.fieldElementNameMap[target.id])){var edField,card=this.card,targetEl=Ext.get(target),fieldName=this.fieldElementNameMap[target.id],record=card.getRecord(),value=record.get(fieldName),valueOrRef=value&&value._ref?value._ref:value,field=record.getField(fieldName),fieldValueEl=targetEl.down(".rui-field-value"),fieldWidth=this._getEditorFieldWidth(targetEl),config=Rally.ui.cardboard.CardEditorFactory.getEditor(field)||{};if(this.recordAction({description:"clicked card field "+fieldName,component:card}),edField=Ext.widget(Ext.applyIf(config,{width:fieldWidth,cls:fieldName,value:valueOrRef,context:card.getContext()})),this._originalFieldHeight=targetEl.getHeight(),edField.on("validitychange",function(field,isValid){this.card.fireEvent("validitychange",this,field,isValid)},this),this.setEditingContext(fieldName,edField),fieldValueEl.isVisible()){var editorConfig={cls:"rally-card-editor",field:edField,shadow:!1,alignment:"tl-tl",offsets:[0,-1],label:field.attributeDefinition?field.attributeDefinition.Name:fieldName,completeOnEnter:!0,cancelOnEsc:!0,cancelOnDetach:!1,parentEl:fieldValueEl.parent().createChild({tag:"div",cls:"editor-container"}),hideEl:!0,listeners:{complete:Ext.bind(this._onEditorComplete,this,[fieldName],!0),canceledit:Ext.bind(this._onCancelEdit,this,[fieldName],!0)}};this._cleanupValidation(fieldName);var editorConfigOverride=this._getEditorConfigFor(fieldName,targetEl)||{};editorConfig=Ext.apply(editorConfig,editorConfigOverride),this.activeEditor=Ext.create("Ext.Editor",editorConfig),this.fireEvent("beforeedit",this.activeEditor,this.getEditingContext()),this.activeEditor.startEdit(fieldValueEl,valueOrRef),edField.autoSize(),edField.on("autosize",Ext.bind(this._onAutosize,this,[fieldName],!0))}}},_cleanupValidation:function(fieldName){var validationTooltip=this._validationTooltips[fieldName];validationTooltip&&(validationTooltip.target.removeCls("rally-invalid-card-field"),validationTooltip.destroy(),delete this._validationTooltips[fieldName])},_onAutosize:function(textarea,height,eOpts,fieldName){height>0&&this._setCardFieldHeight(fieldName,height)},_setCardFieldHeight:function(fieldName,height){var el=this.card.contentLeftPlugin.getFieldEl(fieldName);el&&(el.hasCls("type-string")||el.hasCls("type-text"))&&(height=height||el.getAttribute("scrollHeight")+el.getBorderWidth("tb"),el.setHeight(height))},setEditingContext:function(fieldName,field){var card=this.card,record=card.getRecord();this.context={card:card,record:record,fieldName:fieldName,field:field,value:record.get(fieldName)}},editorCompleteHandler:function(editor,newValue,oldValue,eOpts,fieldName){this._onEditorComplete(editor,newValue,oldValue,eOpts,fieldName)},_onEditorComplete:function(editor,newValue,oldValue,eOpts,fieldName){if(this._setCardFieldHeight(fieldName),editor===this.activeEditor&&(this.activeEditor=null),this._destroyEditor(editor),String(newValue).trim()!==String(oldValue).trim()){var record=this.card.getRecord();this.recordLoadBegin({description:"saving record",component:this.card}),record.set(fieldName,newValue),this.fireEvent("inlineedit",this,this.context),this.card.contentLeftPlugin.refreshField(fieldName),this._editSaveInProgress=!0,record.save({callback:Ext.bind(this._onRecordSave,this,[fieldName,editor],!0),params:{fetch:record.store?record.store.fetch:[fieldName]},scope:this,requester:this.card})}},_onRecordSave:function(refreshedRecord,operation,success,fieldName,editor){this.card.fireEvent("datachanged",this.card,refreshedRecord,operation),delete this._editSaveInProgress,success?this.publish(Rally.Message.objectUpdate,refreshedRecord,[fieldName],this.card):this._handleFailure(refreshedRecord,operation,success,fieldName),this._ensureEditorDestroyed(editor),this.recordLoadEnd({component:this.card}),this.fireEvent("inlineeditsaved",refreshedRecord,operation,this.card.getRecord(),fieldName)},_handleFailure:function(refreshedRecord,operation,success,fieldName){var record=this.card.getRecord();if(record.set(fieldName,record.modified[fieldName]),this.card.contentLeftPlugin.refreshField(fieldName),this._setCardFieldHeight(fieldName,this._originalFieldHeight),operation.error&&operation.error.errors){var fieldErrors=_.filter(operation.error.errors,function(error){return/Validation error: (.*)/.test(error)},this);if(fieldErrors.length){var fieldEl=this.card.contentLeftPlugin.getFieldEl(fieldName);fieldEl.addCls("rally-invalid-card-field"),this._validationTooltips[fieldName]=Ext.create("Rally.ui.tooltip.ToolTip",{target:fieldEl,anchor:"top",mouseOffset:[5,0],html:fieldErrors.join(", ")})}else Rally.ui.notify.Notifier.showError({message:Ext.String.format("{0}: {1} -- {2}",record.get("FormattedID"),record.getField(fieldName).displayName,operation.error.errors.join(", "))})}this.publish(Rally.Message.recordUpdateFailure)},_onCancelEdit:function(editor,field,evt,eOpts,fieldName){this._ensureEditorDestroyed(editor),this._setCardFieldHeight(fieldName,this._originalFieldHeight)},_ensureEditorDestroyed:function(editor){editor===this.activeEditor&&(Ext.isObject(this.activeEditor)&&this._destroyEditor(this.activeEditor),this.activeEditor=null)},_destroyEditor:function(editor){var parentEl=editor.parentEl;editor.destroy(),parentEl.remove()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.Menu",{requires:[],alias:"widget.rallymenu",extend:Ext.menu.Menu,componentCls:"rally-menu no-icon",plain:!0,shadow:"drop",shadowOffset:5,minWidth:0,initComponent:function(){this.callParent(arguments),this.on("hide",this._onHide,this)},_onHide:function(){this.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.RecordMenu",{extend:Rally.ui.menu.Menu,alias:"widget.rallyrecordmenu",config:{items:[]},inheritableStatics:{filterPredicate:function(items){return _.filter(items,function(item){return!item.predicate||item.predicate.call(item,item.record)})}},initComponent:function(){var items=_.map(this.items,this._getInstantiatedComponent,this),filteredItems=this.self.filterPredicate(items);_.each(_.difference(items,filteredItems),function(item){item&&item.destroy&&item.destroy()}),this.items=this._collapseSeparators(filteredItems),this.callParent(arguments)},_getInstantiatedComponent:function(item){var component=item;return!item.isComponent&&item.xtype&&(component=Ext.ComponentManager.create(item,item.xtype)),Ext.apply(component,{context:this.context})},_collapseSeparators:function(items){for(var index=items.length-1;index>=0;index--){var item=items[index],previousIndex=index-1,previousItem=items[previousIndex];if(item&&"menuseparator"===item.xtype)if(previousItem)if("menuseparator"===previousItem.xtype)this._destroyItemAtIndex(items,index);else{var laterItems=_(items).drop(index+1).compact().value();_.isEmpty(laterItems)&&this._destroyItemAtIndex(items,index)}else this._destroyItemAtIndex(items,index)}return _.compact(items)},_destroyItemAtIndex:function(items,index){items[index].destroy(),items[index]=null}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RecordMenuItem",{extend:Ext.menu.Item,alias:"widget.rallyrecordmenuitem",clickHideDelay:1,config:{record:void 0,handler:function(){},predicate:function(record){return!0},text:""},constructor:function(config){this.initConfig(config),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddChildMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddchild",config:{text:"Add Child...",cls:"artifact-icon icon-story"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveChildren]),config.handler=config.handler||this._onAddChildClicked,this.initConfig(config),this.callParent(arguments)},_getChildType:function(){var field=this.record.getField("Children")||this.record.getField("UserStories");return field.attributeDefinition.AllowedValueType._refObjectName},_getCpoid:function(record){var project=record.get("Project")||{_ref:record.self.context.project};return Rally.util.Ref.getOidFromRef(project._ref)},_onAddChildClicked:function(){window.detail&&(window.detail.refreshContent=!1);var childType=this._getChildType(),record=this.record,params=this._buildParamsForEditor(record);Rally.data.wsapi.ModelFactory.getModel({type:childType,context:record.self.context}).then(function(ChildModel){params.typeDef=ChildModel.typeDefOid,Rally.nav.Manager.create(childType,params)})},_buildParamsForEditor:function(parent){var ref=parent.get("_ref"),params={parent:parent.get("ObjectID"),parentTypeDef:parent.self.typeDefOid,cpoid:this._getCpoid(parent)};return this._isPortfolioItemParent(parent)?params.PortfolioItem=ref:params.Parent=ref,!_.contains(parent.get("_type"),"portfolioitem")&&parent.get("Iteration")&&(params.Iteration=parent.get("Iteration")._ref),params},_isPortfolioItemParent:function(record){return record.self.typePath.match(/^portfolioitem/)&&0===record.self.ordinal}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.PopoverFactory",{alias:"widget.rallypopoverfactory",singleton:!0,_lastRequestedAsyncBakeId:void 0,bake:function(options){if(!(!options.record||options.record&&options.record.isSearch()))return this._onRecordLoad(options.record,options);var type=options.type||options.record.data._type,oid=options.oid||options.record.get("ObjectID"),bakingId=this._lastRequestedAsyncBakeId=(new Date).getTime();Rally.data.ModelFactory.getModel({type:type,success:function(model){model.load(oid,{success:function(record){bakingId===this._lastRequestedAsyncBakeId&&this._onRecordLoad(record,options)},scope:this})},scope:this})},_onRecordLoad:function(record,options){if(this.popovers[options.field])return options.record=record,this.popovers[options.field](options)},popovers:{Discussion:function(config){return Ext.create("Rally.ui.popover.DiscussionPopover",this._getConfig(config))},UserStory:function(config){return Ext.create("Rally.ui.popover.UserStoryPopover",this._getConfig(config))},Task:function(config){return Ext.create("Rally.ui.popover.TaskPopover",this._getConfig(config))},Defect:function(config){return"testset"===config.type||config.record&&config.record.isTestSet()?Ext.create("Rally.ui.popover.TestCaseDefectPopover",this._getConfig(config)):Ext.create("Rally.ui.popover.DefectPopover",this._getConfig(config))},TestCase:function(config){return Ext.create("Rally.ui.popover.TestCasePopover",this._getConfig(config))},Description:function(config){return Ext.create("Rally.ui.popover.DescriptionPopover",this._getConfig(config))},Owner:function(config){return Ext.create("Rally.ui.popover.OwnerPopover",this._getConfig(config))},Color:function(config){return Ext.create("Rally.ui.popover.ColorPopover",this._getConfig(config))},PercentDoneByStoryCount:function(config){return Ext.create("Rally.ui.popover.PercentDonePopover",this._getConfig(config))},PercentDoneByStoryPlanEstimate:function(config){return Ext.create("Rally.ui.popover.PercentDonePopover",this._getConfig(config))},PredecessorsAndSuccessors:function(config){return Ext.create("Rally.ui.popover.DependenciesPopover",this._getConfig(config))},WorkProduct:function(config){return Ext.create("Rally.ui.popover.WorkProductPopover",this._getConfig(config))},_getConfig:function(config){return Ext.merge({context:{workspace:config.record.get("Workspace")._ref,project:null}},config)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddDefectMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemadddefect",config:{text:"Add Defect...",cls:"artifact-icon icon-defect"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveDefects]),config.handler=config.handler||this._onAddDefectClicked,this.initConfig(config),this.callParent(arguments)},_onAddDefectClicked:function(){var targetEl=Ext.get(this.owningEl||this.getEl());this.popover&&this.popover.destroy(),this.popover=Rally.ui.popover.PopoverFactory.bake({target:targetEl,field:"Defect",record:this.record,autoShow:!0,offsetFromTarget:[{x:0,y:-5},{x:5,y:0},{x:0,y:5},{x:-5,y:0}],placement:this.popoverPlacement})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddExistingTestCasesMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddexistingtestcases",config:{text:"Add Existing Test Cases...",cls:"artifact-icon icon-test-case"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.isTestSet]),config.handler=config.handler||this._onMenuItemClicked,this.initConfig(config),this.callParent(arguments)},_onMenuItemClicked:function(){this.view.fireEvent("addexisting",this.view,this.record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddTaskMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddtask",config:{text:"Add Task...",cls:"artifact-icon icon-task"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveTasks]),config.handler=config.handler||this._onAddTaskClicked,this.initConfig(config),this.callParent(arguments)},_recordPredicate:function(record){return record.isUpdatable()&&this._isEligibleArtifact(record)},_onAddTaskClicked:function(){var targetEl=Ext.get(this.owningEl||this.getEl());this.popover&&this.popover.destroy(),this.popover=Rally.ui.popover.PopoverFactory.bake({target:targetEl,field:"Task",record:this.record,autoShow:!0,offsetFromTarget:[{x:0,y:-5},{x:5,y:0},{x:0,y:5},{x:-5,y:0}],placement:this.popoverPlacement})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddTestCaseMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddtestcase",config:{text:"Add Test Case...",cls:"artifact-icon icon-test-case"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveTestCases]),config.handler=config.handler||this._onAddTestCaseClicked,this.initConfig(config),this.callParent(arguments)},_onAddTestCaseClicked:function(){var targetEl=Ext.get(this.owningEl||this.getEl());this.popover&&this.popover.destroy(),
this.popover=Rally.ui.popover.PopoverFactory.bake({target:targetEl,field:"TestCase",record:this.record,autoShow:!0,offsetFromTarget:[{x:0,y:-5},{x:5,y:0},{x:0,y:5},{x:-5,y:0}],placement:this.popoverPlacement})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.CopyMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemcopy",mixins:{messageable:Rally.Messageable},config:{text:"Copy",handler:function(){this._onCopyClicked()},predicate:function(record){var typePath=(record.self.typePath||"").toLowerCase();return record.self.isArtifact()&&"defectsuite"!==typePath&&record.get("creatable")},beforeAction:null,afterAction:null,actionScope:null},clientMetrics:[{method:"_onCopyClicked",description:"clicked copy menu item"}],_onCopyClicked:function(){var originalRecord=this.getRecord();_.isFunction(this.beforeAction)&&this.beforeAction.call(this.actionScope||window,originalRecord)===!1||Rally.data.util.Record.copyAndSaveRecord(originalRecord,{success:function(copiedRecord,operation){var me=this,result=Ext.callback(this.afterAction,this.actionScope,[copiedRecord,originalRecord,operation]),associatedRecords=this._getAssociatedRecords(originalRecord,copiedRecord);result&&_.isFunction(result.then)?result.then(function(){me.publish(Rally.Message.objectCreate,copiedRecord,me,associatedRecords)}):this.publish(Rally.Message.objectCreate,copiedRecord,this,associatedRecords)},failure:function(record,operation){Ext.callback(this.afterAction,this.actionScope,[null,originalRecord,operation])},scope:this},{Name:"(copy of) "+originalRecord.get("Name")})},_getAssociatedRecords:function(originalRecord,copiedRecord){return originalRecord.parentNode&&originalRecord.parentNode.parentNode?[originalRecord.parentNode]:[]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.CopyUserMenuItem",{alias:"widget.rallyrecordmenuitemcopyuser",extend:Rally.ui.menu.item.RecordMenuItem,config:{text:"Copy...",handler:function(){this._onCopyClicked()},predicate:function(record){return record.get("creatable")&&"user"===record.self.typeName}},clientMetrics:[{method:"_onCopyClicked",description:"clicked copy user menu item"}],_onCopyClicked:function(){Rally.nav.Manager.copy(this.getRecord())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.ViewController",{extend:Deft.mvc.ViewController,init:function(){this.callParent(arguments);var viewObserver=this.observe&&this.observe.view;viewObserver&&this.addObserver("view",viewObserver)},mergeControl:function(){this.control=Ext.merge({},this.superclass.control,this.control)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Filter",{singleton:!0,NUM_ARTIFACT_TYPES:4,hasFilters:function(filters){return(1!==_.size(filters)||!filters.modelFilter||!this._allArtifactsShown(filters.modelFilter))&&_.size(filters)>0},_allArtifactsShown:function(modelFilter){return Ext.create("Rally.data.wsapi.Filter",modelFilter).toString().match(/TypeDefOid/g).length===this.NUM_ARTIFACT_TYPES},getFilterNames:function(filters){var fields=_.unique(_.map(filters,function(f){for(var property=f.property;_.isObject(property);)property=property.property;return property=property.replace(/TypeDefOid/,"ArtifactType"),property.replace(/([A-Z])/g," $1").replace(/^\s|\s$/g,"")}));return filters.modelFilter&&this._allArtifactsShown(filters.modelFilter)&&(fields=_.without(fields,"Artifact Type")),fields.join(", ")},split:function(filter){var splitRecursive=function(subFilter){return _.isObject(subFilter.property)&&_.isObject(subFilter.value)&&subFilter.operator===filter.operator?splitRecursive(subFilter.property).concat(splitRecursive(subFilter.value)):[subFilter.clone()]};return splitRecursive(filter)},removeNonapplicableTypeSpecificFilters:function(filters,models){return _.compact(_.map(filters,function(filter){if("OR"===filter.operator){var filteredSubFilters=this.removeNonapplicableTypeSpecificFilters(this.split(filter),models);if(0===filteredSubFilters.length)return!1;filter=Rally.data.wsapi.Filter.or(filteredSubFilters)}if(this._allPropertiesBelongToSomeType(this._collectFilterProperties(filter),models))return filter},this))},findInvalidSubFilters:function(filters,models){return _(filters).map(this._getSubFilters,this).flatten().filter(function(subFilter){return!this._propertyBelongsToSomeType(subFilter.property.split(".")[0],models)},this).map(function(filter){return Ext.create("Rally.data.wsapi.Filter",filter)},this).value()},_collectFilterProperties:function(filter){return _.map(this._getSubFilters(filter),function(subFilter){return subFilter.property.split(".")[0]})},_getSubFilters:function(filter){var subFilters=[],filterTraversal=function(filter){_.isString(filter.property)&&!_.contains(subFilters,filter.property)&&"TypeDefOid"!==filter.property?subFilters.push(filter):(_.isObject(filter.property)&&filterTraversal(filter.property),_.isObject(filter.value)&&filterTraversal(filter.value))};return filterTraversal(filter),subFilters},_allPropertiesBelongToSomeType:function(properties,models){return _.all(properties,function(property){return this._propertyBelongsToSomeType(property,models)},this)},_propertyBelongsToSomeType:function(property,models){return _.some(models,function(model){var field=model.getField(property)||model.getField(Ext.String.capitalize(property||""));return field&&!field.virtual})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.filter.FilterCollection",{constructor:function(){this.permanentFilters={},this.tempFilters={}},toString:function(){var filtersToString="",filtersToArray=this.toArray();return 2===filtersToArray.length?filtersToString=filtersToArray[0].and(filtersToArray[1]).toString():1===filtersToArray.length&&(filtersToString=filtersToArray[0].toString()),filtersToString},toArray:function(){var tempFilters,permFilters,filters=[];return Ext.Object.getSize(this.permanentFilters)>0&&(permFilters=this._combineFilters(this.permanentFilters),filters.push(permFilters)),Ext.Object.getSize(this.tempFilters)>0&&(tempFilters=this._combineFilters(this.tempFilters),filters.push(tempFilters)),filters},addPermanentFilter:function(filter){return this._addFilter(this.permanentFilters,filter)},clearAllFilters:function(){Ext.Object.clear(this.permanentFilters),Ext.Object.clear(this.tempFilters)},addTempFilter:function(filter){return this._addFilter(this.tempFilters,filter)},isTempFilterAlreadyApplied:function(filter){var wspaiFilter=this._toWsapiFilter(filter),foundFilter=this.tempFilters[wspaiFilter.itemId];return!(!foundFilter||foundFilter.toString()!==wspaiFilter.toString())},removeTempFilterByKey:function(filterKey){_.each(Ext.Array.from(filterKey),function(key){delete this.tempFilters[key]},this)},isTempFiltered:function(){return Rally.util.Filter.hasFilters(this.tempFilters)},clearTempFilters:function(){Ext.Object.clear(this.tempFilters)},clone:function(){var clone=Ext.create("Rally.data.filter.FilterCollection");return clone.permanentFilters=Ext.clone(this.permanentFilters),clone.tempFilters=Ext.clone(this.tempFilters),clone},_addFilter:function(collection,filter){var newFilter;return _.each(Ext.Array.from(filter),function(f){newFilter=collection[f.itemId]=Ext.apply({itemId:"default"},f)},this),newFilter},_combineFilters:function(filters){return Rally.data.wsapi.Filter.and(_.map(filters,this._toWsapiFilter,this))},_toWsapiFilter:function(filter){return filter instanceof Rally.data.wsapi.Filter||(filter=Ext.create("Rally.data.wsapi.Filter",filter)),filter}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.FieldFetchMapper",{inheritableStatics:{genericFieldMap:{Defects:["Defects","DefectStatus"],Discussion:["Discussion:summary","LatestDiscussionAgeInMinutes"],Feature:[{name:"Feature",properties:["FormattedID"]}],Milestones:["Milestones","Project"],Parent:[{name:"Parent",properties:["FormattedID"]},{name:"PortfolioItem",properties:["FormattedID"]}],PercentDoneByStoryCount:["PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","LeafStoryCount","LeafStoryPlanEstimateTotal","ActualEndDate","PlannedStartDate","PlannedEndDate","AcceptedLeafStoryPlanEstimateTotal","AcceptedLeafStoryCount","UnEstimatedLeafStoryCount","Notes","PortfolioItemTypeOrdinal","LateChildCount","Release"],PercentDoneByStoryPlanEstimate:["PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","LeafStoryCount","LeafStoryPlanEstimateTotal","ActualEndDate","PlannedStartDate","PlannedEndDate","AcceptedLeafStoryPlanEstimateTotal","AcceptedLeafStoryCount","UnEstimatedLeafStoryCount","Notes","PortfolioItemTypeOrdinal","LateChildCount","Release"],PredecessorsAndSuccessors:["Predecessors","Successors"],PreliminaryEstimate:[{name:"PreliminaryEstimate",properties:["Value","Name"]}],Project:[{name:"Project",properties:["ObjectID","Name"]}],ScheduleState:["ScheduleState","Blocked","Ready","ScheduleStatePrefix"],State:["State","Blocked","Ready"],TaskActualTotal:["TaskActualTotal","Actuals"],TaskEstimateTotal:["TaskEstimateTotal","Estimate"],TaskRemainingTotal:["TaskRemainingTotal","ToDo","State"],Tasks:["Tasks","TaskStatus"],TestCases:["TestCases","TestCaseStatus"],Type:["Type","DisplayName"],UserStories:["LeafStoryPlanEstimateTotal","DirectChildrenCount"]},modelSpecificFieldMap:{defectsuite:{State:["ClosedDefectCount","TotalDefectCount"],LastVerdict:["LastVerdict","PassingTestCaseCount","TestCaseCount"]},milestone:{FormattedID:["DisplayColor"]},testset:{LastVerdict:["LastVerdict","PassingTestCaseCount","TestCaseCount"]},hierarchicalrequirement:{LastVerdict:["LastVerdict","PassingTestCaseCount","TestCaseCount"]},defect:{LastVerdict:["LastVerdict","PassingTestCaseCount","TestCaseCount"]},testcase:{LastBuild:["LastResult","Build","LastBuild"],LastVerdict:["LastResult","Verdict","LastVerdict"],LastRun:["LastResult","Date","LastRun"]}},getFetchFields:function(fields,options){return options=options||[],_(fields).map(function(field){return this._getFetchForField(field,options)},this).flatten().uniq().value()},getFieldMappings:function(){return _.clone(this.genericFieldMap)},_getModelSpecificFetchFields:function(fieldName,modelNames){return _(modelNames).map(function(modelName){var modelSpecificConfig=this.modelSpecificFieldMap[modelName.toLowerCase()];return modelSpecificConfig&&modelSpecificConfig[fieldName]||[]},this).flatten().uniq().value()},_getGenericFetchFields:function(fieldName){return this.getFieldMappings()[fieldName]||[]},_getFetchForField:function(field,options){try{var fieldName=Ext.String.capitalize(_.isObject(field)?field.name:field),fieldFetchConfigs=this._getModelSpecificFetchFields(fieldName,options.modelNames).concat(this._getGenericFetchFields(fieldName)),fetchFields=_.reduce(fieldFetchConfigs,function(results,fetchConfig){fetchConfig=_.isObject(fetchConfig)?fetchConfig:{name:fetchConfig};var properties=fetchConfig.properties||[];return options.useShallowFetch&&properties.length?results.concat(fetchConfig.name+"["+properties.join(";")+"]"):results.concat(fetchConfig.name).concat(properties)},[],this);return 0===fetchFields.length?_.isArray(field.fetch)?field.fetch:[fieldName]:fetchFields}catch(e){return[]}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.RefreshViewOnColumnChangePlugin",{requires:[],extend:Ext.AbstractPlugin,alias:"plugin.rallyrefreshviewoncolumnchangeplugin",init:function(view){this.view=view,this.view.headerCt.on("columnshow",this._onColumnShow,this),this.view.headerCt.on("columnhide",this._onColumnHide,this)},destroy:function(){this.view.headerCt.un("columnshow",this._onColumnShow,this),this.view.headerCt.un("columnhide",this._onColumnHide,this)},_onColumnShow:function(headerCt,header){this._applyStylesToCellsForHeader(header,{display:""}),this.view.doComponentLayout()},_onColumnHide:function(headerCt,header){this._applyStylesToCellsForHeader(header,{display:"none"}),this.view.doComponentLayout()},_applyStylesToCellsForHeader:function(header,styles){var cells=this._getCellsInColumn(header);Ext.Array.each(cells,function(el){Ext.fly(el).down("div").applyStyles(styles)})},_getCellsInColumn:function(header){return this.view.getEl().query(header.getCellSelector())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.CellClsDecorator",{extend:Ext.util.Observable,singleton:!0,invalidCls:"rally-invalid-cell",invalidModelAttr:"_validationPluginIsValid",getCellCls:function(record,col){var isNotValid=col&&col.field&&record[this.invalidModelAttr]&&record[this.invalidModelAttr][col.field.getName()];return isNotValid?this.invalidCls:""},markCellInvalid:function(grid,record,column){var invalidAttrs=record[this.invalidModelAttr]||{};invalidAttrs[column.field.getName()]=!0,record[this.invalidModelAttr]=invalidAttrs;try{var cell=grid.getView().getCell(record,column);cell.addCls(this.invalidCls)}catch(e){}},markCellValid:function(grid,record,column){Ext.isObject(record[this.invalidModelAttr])&&delete record[this.invalidModelAttr][column.field.getName()];try{var cell=grid.getView().getCell(record,column);cell.removeCls(this.invalidCls)}catch(e){}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.GridView",{extend:Ext.grid.View,alias:"widget.rallygridview",mixins:{messageable:Rally.Messageable},stripeRows:!0,deferEmptyText:!1,forceFit:!0,publishLoadMessages:!0,plugins:["rallyrefreshviewoncolumnchangeplugin"],constructor:function(config){if(!config.emptyText){var type=config.store&&config.store.model&&config.store.model.typePath;config.emptyText=Rally.ui.EmptyTextFactory.get(type)}config.plugins=this.plugins.concat(Ext.Array.from(config.plugins)),this.callParent(arguments),this.publishLoadMessages&&this.on("viewready",this._onViewReady,this,{single:!0}),this.getSelectionModel().on("select",this._onSelect,this),this.on("render",function(){this.el.dom.tabIndex=0},this)},getCellCls:function(record,column){return Rally.ui.grid.CellClsDecorator.getCellCls(record,column)},getRowClass:function(record){return Rally.util.Test.toBrowserTestCssClass("row",record.getId())},_onViewReady:function(){var store=this.getStore();store&&store.isLoading()?this.mon(store,"load",function(){this.publish(Rally.Message.gridLoaded)},this,{single:!0}):this.publish(Rally.Message.gridLoaded),this.on("refresh",this._onRefresh,this)},_onRefresh:function(){this.publish(Rally.Message.gridLoaded)},_onSelect:function(){this._selectedNodes&&(this._selectedNodes.removeCls("interactable"),delete this._selectedNodes),this._selectedNodes=Ext.create("Ext.dom.CompositeElementLite",this.getSelectedNodes()),this._selectedNodes.addCls("interactable")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RowKeyboardNavigation",{onEditorEnter:function(editingPlugin,field,e){var view=this.views[0],position=this._getPosition(editingPlugin,view),direction=e.shiftKey?"up":"down",newPosition=this._nextEditablePosition(position,direction,e);field.onEditorEnter&&field.onEditorEnter(e),this._concludeEditorKeyboardNavigation(editingPlugin,newPosition)},onEditorTab:function(editingPlugin,e){var position=this._getPosition(editingPlugin,this.view),direction=e.shiftKey?"left":"right",newPosition=this._nextEditablePosition(position,direction,e);this._concludeEditorKeyboardNavigation(editingPlugin,newPosition,this._gridSibling(direction))},_concludeEditorKeyboardNavigation:function(editingPlugin,newPosition,elementToFocusOn){newPosition?editingPlugin.startEditByPosition(newPosition):(editingPlugin.getActiveEditor().completeEdit(),elementToFocusOn&&elementToFocusOn.focus())},_nextEditablePosition:function(position,direction,e){do position=this.view.walkCells(position,direction,e,this.preventWrap);while(position&&this._cellIsReadOnly(position.columnHeader,position.record));return position},_cellIsReadOnly:function(columnHeader,record){if(record.isWsapiModel){var field=record.getField(columnHeader.dataIndex),cellIsEditable=columnHeader.getEditor()&&_.isFunction(columnHeader.getEditor().isNotEditable)&&columnHeader.getEditor().isNotEditable(record);return!field||field.readOnly||!columnHeader.getEditor()||cellIsEditable}return!columnHeader.getEditor()},_gridSibling:function(direction){var parent=this.view.el.parent(),siblingToFocusOn="left"===direction?parent.prev():parent.next();return siblingToFocusOn},_getPosition:function(editingPlugin,view){var record=editingPlugin.getActiveRecord(),header=editingPlugin.getActiveColumn();return view.getPosition(record,header)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.CheckboxModel",{requires:[],extend:Ext.selection.CheckboxModel,alias:"selection.rallycheckboxmodel",mixins:{keyboardnav:Rally.ui.grid.RowKeyboardNavigation},statics:{rowCheckboxSelector:"."+Ext.baseCSSPrefix+"grid-row-checker",headerCheckboxCls:Ext.baseCSSPrefix+"column-header-checkbox",highlightRowCls:Ext.baseCSSPrefix+"grid-row-highlighted"},mode:"MULTI",checkOnly:!0,injectCheckbox:1,constructor:function(){this.callParent(arguments),this.on("beforeselect",this._onBeforeSelect,this)},bindStore:function(store){this.callParent(arguments),store&&store.on("datachanged",this._renderHeaderCheckbox,this)},renderer:function(value,metaData,record,rowIndex,colIndex,store,view){return this._recordIsSelectable(record)?this.callParent(arguments):this.renderEmpty()},processSelection:function(view,record,item,index,e){var checker=e.getTarget(this.checkSelector);this.checkOnly&&!checker||(e.ctrlKey=!0,this.selectWithEvent(record,e))},selectAll:function(suppressEvent){var origSelectionLength=this.getSelection().length;this.bulkChange=!0,_.each(this._getSelectableRecords(),function(record){this.doSelect(record,!0,suppressEvent)},this),delete this.bulkChange,this.maybeFireSelectionChange(this.getSelection().length!==origSelectionLength)},beforeViewRender:function(){this.callParent(arguments),this.view.cls="grid-view-bulk-edit"},_renderHeaderCheckbox:function(){this._getSelectableRecords().length>0&&this.view.headerCt.child("gridcolumn[isCheckerHd]").addCls(this.self.headerCheckboxCls)},getHeaderConfig:function(){return Ext.apply(this.callParent(arguments),{cls:""})},onEditorTab:function(editingPlugin,e){this.mixins.keyboardnav.onEditorTab.call(this,editingPlugin,e)},onEditorEnter:function(editingPlugin,field,e){this.mixins.keyboardnav.onEditorEnter.call(this,editingPlugin,field,e)},selectByPosition:function(position){if(this.view.getEl().select("tr").removeCls(this.self.highlightRowCls),position.row){var rowEl=this.view.getEl().down("#"+this.view.getRowId(position.row));rowEl&&rowEl.addCls(this.self.highlightRowCls)}},onRowClick:function(view,record,item,index,e){if(Ext.get(view.getNodes()).removeCls(this.self.highlightRowCls),!e.getTarget(this.self.rowCheckboxSelector)){var row=Ext.get(view.getNodeByRecord(record)),rowExpander=row.up("."+Ext.baseCSSPrefix+"grid-row"),node=rowExpander?rowExpander:row;node.addCls(this.self.highlightRowCls)}this.callParent(arguments)},_onBeforeSelect:function(checkboxModel,record){return this._recordIsSelectable(record)},_recordIsSelectable:function(record){return(record.self.isArtifact()||record.self.isTimebox()||"attachment"===record.self.typePath)&&record.get("updatable")},_getSelectableRecords:function(){return _.filter(this.store&&this.store.getRange(),this._recordIsSelectable)},updateHeaderState:function(){var hdSelectStatus=this.selected.getCount()===this._getSelectableRecords().length&&this.selected.getCount()>0;this.toggleUiHeader(hdSelectStatus)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.CellRendererFactory",{singleton:!0,createRendererFunction:function(column){var me=this,rendererFunction=column&&column.initialConfig.renderer,isCellEditable=column&&column.initialConfig.isCellEditable;return function(value,metaData,record,rowIndex,colIndex,store,view){metaData.tdCls=me._getCls(record,rowIndex,colIndex,column,view),column&&column.hidden&&(metaData.style="display:none");var recordField=column.dataIndex&&record.getField?record.getField(column.dataIndex):null;if(!recordField||recordField.hidden)return"--";if(!me._isEditableField(recordField,record)||Ext.isFunction(isCellEditable)&&!isCellEditable(value,record)||(metaData.tdCls+=" rally-edit-cell"),Ext.isFunction(rendererFunction))return rendererFunction.apply(this,arguments);if(Ext.isFunction(column.renderer)){var fieldRenderer=Rally.ui.renderer.RendererFactory.getFieldRenderer(record,column.dataIndex);return fieldRenderer?fieldRenderer(value,metaData,record,rowIndex,colIndex,store,view):Rally.ui.renderer.RendererFactory.renderRecordField(record,column.dataIndex,column.context)}return value}},_isEditableField:function(recordField,record){return(!recordField.readOnly||this._isCollectionField(recordField))&&record.get("updatable")},_isCollectionField:function(recordField){return recordField.isCollection&&recordField.isCollection()},_getCls:function(record,rowIndex,colIndex,column,view){column||(column=view.headerCt.getHeaderAtIndex(colIndex));var text=column.btColId||column.dataIndex||"col",sanitizedText=text.replace(" ","-").toLowerCase();return[Rally.util.Test.toBrowserTestCssClass(text,record.getId()),Rally.util.Test.toBrowserTestCssClass(text),"rally-grid-cell-"+sanitizedText,sanitizedText,view.getCellCls(record,column)].join(" ")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.FieldColumn",{extend:Ext.grid.column.Template,alias:"widget.rallyfieldcolumn",sortableCls:"rally-column-sortable",modelField:void 0,printable:!0,constructor:function(){this.callParent(arguments),this.renderer=Rally.ui.grid.CellRendererFactory.createRendererFunction(this)},initComponent:function(){this.tpl="",null===this.dataIndex&&(this.dataIndex=this.modelField.name),this.flex&&this.width&&delete this.flex,this.callParent(arguments),this.sortable&&(this.cls=Rally.util.String.appendWithSeparator(this.cls,this.sortableCls))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.ManageIterationsGridColumnConfig",{requires:[],PlannedVelocity:function(){return{editor:{decimalPrecision:3,maxValue:99999.999,maxLength:9}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.PortfolioItemGridColumnConfig",{requires:[],ValueScore:function(){return{editor:{minValue:0,allowBlank:!1}}},RiskScore:function(){return{editor:{minValue:0,allowBlank:!1}}},PercentDoneByStoryPlanEstimate:function(){return{text:"% Done By Story Plan Estimate"}},PercentDoneByStoryCount:function(){return{text:"% Done By Story Count"}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.FieldColumnFactory",{singleton:!0,defaultFlexValue:2,maximumDefaultFlexValue:5,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable,ManageIterationsGridColumnConfig:Rally.ui.grid.ManageIterationsGridColumnConfig,PortfolioItemGridColumnConfig:Rally.ui.grid.PortfolioItemGridColumnConfig},getColumnConfigFromField:function(field,model){var columnConfig=this.defaultRenderer(field,model);this[field.name]?Ext.merge(columnConfig,this[field.name](field,model)):field.custom&&field.attributeDefinition.Constrained&&"COLLECTION"===field.attributeDefinition.AttributeType&&Ext.merge(columnConfig,this.CustomMultiValue(field,model)),columnConfig=Ext.applyIf(columnConfig,this._getSharedColumnConfig(field,model)),columnConfig.editor&&(columnConfig.tdCls=columnConfig.tdCls||"",columnConfig.tdCls+=" editable");var btid=Rally.util.Test.toBrowserTestCssClass("grid-header",field.name);return btid&&(columnConfig.componentCls=columnConfig.componentCls||"",columnConfig.componentCls+=" "+btid),columnConfig},_getSharedColumnConfig:function(field){return{modelField:field,xtype:"rallyfieldcolumn"}},isFieldBlacklistedForEditingOnGrids:function(field,model){return!(!model||!_.contains(this.getBlacklistedEditorsForType(model.typePath),field.name))},getBlacklistedEditorsForType:function(typePath){return _.clone(this.nonEditableFieldsForType[typePath])||[]},getDefaultFieldsForType:function(typePath){typePath=Rally.data.ModelTypes.getTypeByName(typePath).toLowerCase();var fields=this.defaultFields[typePath]||[];return 0===fields.length&&(Rally.data.ModelTypes.isPortfolioItem(typePath)?fields=this.defaultFields.portfolioitem:Rally.data.ModelTypes.isArtifact(typePath)&&(fields=this.defaultFields.artifact)),_.clone(fields)},getDefaultFieldsForTypes:function(typePaths){return _(typePaths).map(this.getDefaultFieldsForType,this).flatten().union().value()},getDefaultFlexForField:function(fieldName,existingFlex){var flex=existingFlex;if(_.isFunction(this[fieldName])){var config=this[fieldName]({},{});config.flex&&(flex=config.flex)}return(_.isUndefined(flex)||flex>this.maximumDefaultFlexValue)&&(flex=this.defaultFlexValue),flex},_blackListedFields:{task:["Attachments","BuildDefinitions","Changesets","ObjectID","ObjectUUID","RevisionHistory","SchemaVersion","Subscription","TaskIndex","VersionId","Workspace"],defaultBlackList:["Actuals","Attachments","Blocker","BuildDefinitions","Changesets","Children","ClosedDefectCount","Editors","GrossEstimateConversionRatio","Iterations","LastResult","LandingPage","ObjectID","ObjectUUID","PassingTestCaseCount","PortfolioItem","Predecessors","Releases","RevisionHistory","ScheduleStatePrefix","SchemaVersion","ShortDisplayName","Subscription","Successors","TaskIndex","TeamMembers","TeamMemberships","TestCaseCount","TotalDefectCount","UserIterationCapacities","UserPermissions","UserProfile","VersionId","Workspace"]},getBlackListedFieldsForType:function(type){var lowerType=type.toLowerCase();return this._blackListedFields[lowerType]?this._blackListedFields[lowerType]:this._blackListedFields.defaultBlackList},getBlackListedFieldsForTypes:function(types){return _(types).map(this.getBlackListedFieldsForType,this).flatten().union().value()},defaultRenderer:function(field){return{text:Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(field),dataIndex:field.name,flex:this.defaultFlexValue,editor:field.editor,tdCls:"wrap-text",sortable:field.sortable,handleWidth:10}},defaultFields:{artifact:["FormattedID","Name","Release","Iteration","ScheduleState","Project","Owner"],build:["BuildDefinition","Number","CreationDate","Duration","Message","Start","Status","Uri"],builddefinition:["Name","CreationDate","Description","LastBuild","LastStatus","Project","Uri"],change:["PathAndFilename","Changeset","Action","Base","CreationDate","Extension","Uri"],changeset:["Name","CreationDate","Message","Revision","SCMRepository","CommitTimestamp","Uri"],defect:["FormattedID","Name","Requirement","Severity","Priority","State","FixedInBuild","SubmittedBy","Owner"],defectsuite:["FormattedID","Name","State","Priority","Severity","Project","Owner"],hierarchicalrequirement:["FormattedID","Name","Release","Iteration","ScheduleState","PlanEstimate","TaskEstimateTotal","TaskRemainingTotal","Project","Owner"],iteration:["Name","Theme","StartDate","EndDate","Project","PlannedVelocity","PlanEstimate","TaskEstimateTotal","TaskRemainingTotal","TaskActualTotal","State"],milestone:["FormattedID","DisplayColor","Name","TargetDate","TotalArtifactCount","TargetProject"],portfolioitem:["FormattedID","Name","Release","State","PercentDoneByStoryPlanEstimate","PercentDoneByStoryCount","Project","Owner"],program:["Name","CreationDate","Description","Owner"],project:["Name","CreationDate","Description","Notes","Owner","Parent","State"],release:["Name","Theme","ReleaseStartDate","ReleaseDate","Project","PlannedVelocity","PlanEstimate","TaskEstimateTotal","TaskRemainingTotal","TaskActualTotal","State"],scmrepository:["Name","CreationDate","Description","SCMType","Uri"],task:["FormattedID","Name","WorkProduct","Release","Iteration","State","Estimate","ToDo","Actuals","Owner"],testcase:["FormattedID","Name","WorkProduct","Type","Priority","Owner","LastVerdict","LastRun","Project"],testcaseresult:["Build","CreationDate","Date","Duration","Notes","TestCase","TestSet","Tester","Verdict"],user:["UserName","FirstName","LastName","DisplayName","Disabled","SubscriptionPermission"],useriterationcapacity:["User","Capacity","CreationDate","Iteration","Load","Project","TaskEstimates"],userprofile:["CreationDate","DateFormat","DateTimeFormat","DefaultDetailPageToViewingMode","DefaultProject","DefaultWorkspace","EmailNotificationEnabled","SessionTimeoutSeconds","SessionTimeoutWarning","TimeZone","WelcomePageHidden"]},nonEditableFieldsForType:{release:["GrossEstimateConversionRatio"],task:["TaskIndex"]},Discussion:function(){return{width:70,sortable:!1}},DisplayColor:function(){return{width:70}},DragAndDropRank:function(){return{align:"center"}},FormattedID:function(){return{minWidth:100,align:"left",cls:"formatted-id-column-header"}},Estimate:function(field){return this._getUnitRenderer(field)},Load:function(){return{align:"center",minWidth:75}},Name:function(){return{flex:5,minWidth:150}},Owner:function(){return{flex:3,minWidth:150}},PortfolioItem:function(){return{hidden:!0}},PredecessorsAndSuccessors:function(){return{align:"center"}},ScheduleState:function(field){return{minWidth:120,maxWidth:150}},State:function(field){return{minWidth:90}},ToDo:function(field){return this._getUnitRenderer(field)},TaskRemainingTotal:function(field){var renderer=this._getUnitRenderer(field);return renderer.isCellEditable=function(value,record){return record.isTask()&&"Completed"!==record.get("State")},renderer},_getUnitRenderer:function(field){var unit=Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.TaskUnitName;return{text:Ext.String.format("{0}&nbsp;({1})",field.displayName,unit.charAt(0)),tooltip:unit,tooltipType:"title"}},Custom:function(field,model){return Ext.apply(Rally.ui.grid.FieldColumnFactory.defaultRenderer(field),{sortable:"scopedattributedefinition"===model.typePath})},Required:function(field,model){return Ext.apply(Rally.ui.grid.FieldColumnFactory.defaultRenderer(field),{sortable:"scopedattributedefinition"===model.typePath})},AttributeType:function(field,model){return Ext.apply(Rally.ui.grid.FieldColumnFactory.defaultRenderer(field),{sortable:!1})},SharedAcrossWorkItems:function(field){return Ext.apply(Rally.ui.grid.FieldColumnFactory.defaultRenderer(field),{sortable:!1})},Tags:function(field){var me=this;return{listeners:{click:function(grid,cellElement,rowIndex,cellIndex,event,record){return event.stopEvent(),me.recordAction({description:"edit tags clicked",component:grid}),Ext.create("Rally.ui.popover.TagEditorPopover",{placement:["bottom","top","right","left"],target:cellElement,record:record,clientMetricsParent:grid}),!1}}}},CustomMultiValue:function(field){var me=this,theField={name:field.name,displayName:field.displayName};return{editor:!0,listeners:{click:function(grid,cellElement,rowIndex,cellIndex,event,record){return event.stopEvent(),!!record.getField(theField.name)&&(me.recordAction({description:"edit mvcf clicked",component:grid}),Ext.create("Rally.ui.popover.MvcfEditorPopover",{placement:["bottom","top","right","left"],target:cellElement,record:record,field:theField,clientMetricsParent:grid,readOnly:!record.isUpdatable()}),!1)}}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.GridColumnCfgTransformer",{singleton:!0,transformForModel:function(model){return _.curry(this.transform)(model)},transform:function(model,columnCfgs){var columns=_.map(columnCfgs,function(columnCfg){if(Ext.isString(columnCfg)||columnCfg.dataIndex){var fieldName=columnCfg.dataIndex||columnCfg;if(Ext.isString(fieldName)&&Ext.isFunction(model.getField)){var field=model.getField(fieldName);if(_.isUndefined(field))return null;var builtConfig=Rally.ui.grid.FieldColumnFactory.getColumnConfigFromField(field,model);return Ext.isObject(columnCfg)&&Ext.apply(builtConfig,columnCfg),builtConfig}}return columnCfg});return _.compact(columns)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.InvalidGridColumnCfgFilterer",{requires:[],singleton:!0,filterForModel:function(model){return _.curry(this.filter)(model)},filter:function(model,columnCfgs){return _.filter(columnCfgs,function(column){return Ext.isString(column)&&(column=column.split(":")[0]),
!!Ext.isObject(column)||Ext.isString(column)&&model.getField&&model.getField(column)},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.PredecessorsAndSuccessorsColumnTransformer",{singleton:!0,transformForModel:function(model){return _.curry(this.transform)(model)},transform:function(model,columnCfgs){return _.compact(_.map(columnCfgs,function(column){var fieldName;return Ext.isString(column)?"Successors"===column?null:fieldName="Predecessors"===column&&model.hasField("PredecessorsAndSuccessors")?"PredecessorsAndSuccessors":column:column},this))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RankColumnTransformer",{singleton:!0,transformForModel:function(model){return _.curry(this.transform)(model)},transform:function(model,columnCfgs){return _.map(columnCfgs,function(column){return Ext.isString(column)&&Rally.data.Ranker.isRankField(column)?Rally.data.Ranker.getRankField(model):column},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RankDragHandleColumn",{extend:Ext.grid.column.Column,require:["Rally.util.Test"],alias:"widget.rallyrankdraghandlecolumn",draggableCls:"rank-cell",btColId:"RankDragHandle",menuDisabled:!0,minWidth:20,maxWidth:20,resizable:!1,printable:!1,renderer:function(value,metaData,record){return metaData.tdCls=Rally.util.Test.toBrowserTestCssClass("rankdraghandle")+" "+Rally.util.Test.toBrowserTestCssClass("rankdraghandle",record.get("ObjectID")),record.get("updatable")&&(metaData.tdCls+=" rank-cell"),""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeRankDragHandleColumn",{extend:Ext.grid.column.Column,require:["Rally.util.Test","Rally.util.Type"],alias:"widget.rallytreerankdraghandlecolumn",inheritableStatics:{getRequiredFetchFields:function(grid){return["DisplayColor"]}},draggableCls:"rank-cell",btColId:"RankDragHandle",menuDisabled:!0,flex:-1,minWidth:6,maxWidth:6,padding:0,resizable:!1,printable:!1,cls:"rank-drag-handle-column-header",renderer:function(value,metaData,record){metaData.tdCls=Rally.util.Test.toBrowserTestCssClass("rankdraghandle")+" "+Rally.util.Test.toBrowserTestCssClass("rankdraghandle",record.get("ObjectID"))+" "+Rally.util.Type.getTypeOrParentType(record.get("_type")).toLowerCase(),record.get("updatable")&&(metaData.tdCls+=" rank-cell");var displayColor=record.get("DisplayColor");return metaData.tdAttr=displayColor?'style="background-color: '+displayColor+' !important;"':"",'<div class="rank-cell-handle icon-five-dots"></div>'}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RowActionColumn",{alias:"widget.rallyrowactioncolumn",extend:Ext.grid.column.Column,inheritableStatics:{gearIconModelTypesBlacklist:["build","builddefinition","change","changeset","program","project","scmrepository","testcaseresult","useriterationcapacity","userprofile"],getRequiredFetchFields:function(grid){return grid.enableBulkEdit&&["Project","Tags"]||[]}},clientMetrics:{event:"click",description:"clicked gear menu"},sortable:!1,hideable:!1,resizable:!1,draggable:!1,menuDisabled:!0,flex:-1,minWidth:Ext.isIE9?22:26,maxWidth:Ext.isIE9?22:26,printable:!1,tdCls:"rally-cell-row-action",cls:"row-action-column-header",config:{rowActionsFn:null,menuOptions:{},scope:null},constructor:function(){this.callParent(arguments),this.renderer=this._renderGearIcon},initComponent:function(){this.callParent(arguments),this.on("click",this._showMenu,this)},onDestroy:function(){this.menu&&(this.menu.destroy(),delete this.menu),this.callParent(arguments)},_renderGearIcon:function(value,metaData,record){metaData.tdCls=Rally.util.Test.toBrowserTestCssClass("row-action",Rally.util.Ref.getOidFromRef(record.get("_ref")));var gearIconHtml='<div class="row-action-icon icon-gear"/>';return"recyclebinentry"===record.self.typePath?record.get("updatable")?gearIconHtml:"":_.contains(Rally.ui.grid.RowActionColumn.gearIconModelTypesBlacklist,record.self.typePath)?"":gearIconHtml},_showMenu:function(view,el){var defaultOptions,selectedRecord=view.getRecord(Ext.fly(el).parent("tr")),checkedRecords=view.getSelectionModel().getSelection(),grid=view.panel;defaultOptions={cls:Rally.util.Test.toBrowserTestCssClass("row-gear-menu-"+selectedRecord.getId())+" row-gear-menu",view:view,context:grid.getContext(),record:selectedRecord,showInlineAdd:grid.enableInlineAdd,owningEl:el.parentElement,popoverPlacement:["bottom","top"],rankRecordHelper:{findRecordToRankAgainst:function(options){grid.findRankedRecord(options)},getMoveToPositionStore:function(options){return grid.getMoveToPositionStore(options)}},onBeforeRecordMenuCopy:function(record){return grid.onBeforeRecordMenuCopy(record)},onRecordMenuCopy:function(copiedRecord,originalRecord,operation){return grid.onRecordMenuCopy(copiedRecord,originalRecord,operation)},onBeforeRecordMenuDelete:function(record){return grid.onBeforeRecordMenuDelete(record)},onRecordMenuDelete:function(record){return grid.onRecordMenuDelete(record)},onBeforeRecordMenuRankHighest:function(record){return grid.onBeforeRecordMenuRankHighest(record)},onBeforeRecordMenuRankLowest:function(record){return grid.onBeforeRecordMenuRankLowest(record)},onRecordMenuRemove:function(record){return grid.onRecordMenuRemove(record)},shouldRecordBeRankable:function(record){return grid.shouldRecordBeRankable(record)},shouldRecordBeExtremeRankable:function(record){return grid.shouldRecordBeExtremeRankable(record)}},grid.enableBulkEdit&&_.contains(checkedRecords,selectedRecord)?this.menu=Ext.create("Rally.ui.menu.bulk.RecordMenu",Ext.apply({clientMetricsParent:grid,context:grid.getContext(),records:checkedRecords,store:grid.store,onBeforeAction:function(){view.loadMask&&_.isFunction(view.loadMask.disable)&&view.loadMask.disable(),grid.setLoading("Updating..."),grid.suspendLayouts()},onActionComplete:function(successfulRecords,unsuccessfulRecords,changes){grid.refreshAfterBulkAction(successfulRecords,changes).then({success:function(){grid.resumeLayouts(),grid.setLoading(!1),view.loadMask&&_.isFunction(view.loadMask.enable)&&view.loadMask.enable(),grid.getSelectionModel().deselect(successfulRecords),grid.getSelectionModel().select(unsuccessfulRecords),_.each(successfulRecords,grid.highlightRowForRecord,grid),grid.publish(Rally.Message.bulkUpdate,successfulRecords,changes,grid)}})}},grid.bulkEditConfig)):this.rowActionsFn?this.menu=Ext.create("Rally.ui.menu.RecordMenu",Ext.apply({items:this.rowActionsFn.call(this.scope||this,selectedRecord)},defaultOptions)):this.menu=this._getDefaultRecordMenu(selectedRecord,defaultOptions),this.menu.showBy(Ext.fly(el).down(".row-action-icon"))},_getDefaultRecordMenu:function(selectedRecord,defaultOptions){var menu,menuOptions=Ext.merge(defaultOptions,this.menuOptions||{});return menu="testcase"===selectedRecord.self.typePath?Ext.create("Rally.ui.menu.TestCaseRecordMenu",menuOptions):"recyclebinentry"===selectedRecord.self.typePath?Ext.create("Rally.ui.menu.RecycleBinEntryRecordMenu",menuOptions):Ext.create("Rally.ui.menu.DefaultRecordMenu",menuOptions)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.ColumnBuilder",{statics:{ICON_FIELDS:["Defects","Discussion","DisplayColor","Milestones","PredecessorsAndSuccessors","Tags","Tasks","TestCases"],ICON_HEADER_FIELDS:{PredecessorsAndSuccessors:"predecessor"}},constructor:function(){this.autoAddAllModelFieldsAsColumns=!0,this.showRowActionsColumn=!0},withEditingEnabled:function(enableEditing){return this.enableEditing=enableEditing,this},withRankingEnabled:function(enableRanking){return this.enableRanking=enableRanking,this},withAllColumnsStateful:function(allColumnsStateful){return this.allColumnsStateful=allColumnsStateful,this},withDefaultColumns:function(columns){return this.allColumnsStateful?this.defaultColumns=_.sortBy(columns,function(column,index){var columnName=_.isObject(column)?column.dataIndex:column;return"FormattedID"===columnName?-1:index}):this.defaultColumns=columns,this},withSortableColumns:function(sortable){return this.sortable=sortable,this},withDisableColumnMenus:function(disableColumnMenus){return this.disableColumnMenus=disableColumnMenus,this},withRankColumn:function(rankColumnDataIndex){return this.rankColumnDataIndex=rankColumnDataIndex,this},withSummaryColumns:function(columns){return this.summaryColumns=Ext.Array.from(columns),this},shouldAutoAddAllModelFieldsAsColumns:function(value){return this.autoAddAllModelFieldsAsColumns=value,this},shouldShowRowActionsColumn:function(value){return _.isObject(value)?(this.showRowActionsColumn=!0,this.rowActionColumnConfig=value):this.showRowActionsColumn=value,this},shouldResetFlexValuesToDefaults:function(resetFlexValues){return this.resetFlexValues=!!resetFlexValues,this},withEditorsDisabledForColumns:function(disabledEditorColumns){return this.disabledEditorColumns=disabledEditorColumns,this},withTreeEnabled:function(treeEnabled){return this.treeEnabled=treeEnabled,this},withContext:function(context){return this.context=context,this},build:function(model){return _.compose(this._setContext,this._resetFlexValues,this._stripTagsFromColumnText,this._augmentColumnConfigs,this._removeSortableFromUnsortableColumns,this._removeHiddenColumns,this._disabledEditorColumnsAsNeeded,_.curry(this._alignColumns)(model),_.curry(this._addModelColumns)(model),Rally.ui.grid.GridColumnCfgTransformer.transformForModel(model),Rally.ui.grid.PredecessorsAndSuccessorsColumnTransformer.transformForModel(model),Rally.ui.grid.InvalidGridColumnCfgFilterer.filterForModel(model),Rally.ui.grid.RankColumnTransformer.transformForModel(model),this._addSummaryToColumns,this._transformColumnLabels,this._insertRankingDragHandle,this._insertRowActionsColumn,_.curry(this._insertRankColumn)(model)).call(this,Ext.clone(this.defaultColumns)||[])},buildCmps:function(model){return _.map(this.build(model),Ext.widget)},_insertRankingDragHandle:function(columns){return this.enableRanking&&Ext.Array.insert(columns,0,[{xtype:this.treeEnabled?"rallytreerankdraghandlecolumn":"rallyrankdraghandlecolumn"}]),columns},_insertRowActionsColumn:function(columns){return this.showRowActionsColumn&&Ext.Array.insert(columns,0,[_.merge({xtype:"rallyrowactioncolumn"},this.rowActionColumnConfig)]),columns},_shouldSetColumnAlignment:function(model,column){var dataIndex=column.dataIndex,field=!column.align&&dataIndex&&model.getField&&model.getField(dataIndex);return field&&_.isFunction(field.getType)},_alignColumns:function(model,columns){return _.map(columns,function(column){if(this._shouldSetColumnAlignment(model,column)){var type=model.getField(column.dataIndex).getType();"boolean"===type||_.contains(this.self.ICON_FIELDS,column.dataIndex)?column.align="center":_.contains(["quantity","decimal","integer","collection"],type)&&(column.align="right")}return column},this)},_transformColumnLabels:function(columns){return _.map(columns,function(column){return _.isString(column)&&Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(column)&&(column={dataIndex:column}),_.isObject(column)&&column.hasOwnProperty("dataIndex")&&(this.self.ICON_HEADER_FIELDS[column.dataIndex]?(column.cls="picto icon-"+this.self.ICON_HEADER_FIELDS[column.dataIndex],column.text="&nbsp;&nbsp;&nbsp;&nbsp;"):column.hasOwnProperty("text")||this._setFieldLabelOnColumnConfig(column)),column},this)},_removeHiddenColumns:function(columns){return _.filter(columns,function(column){return!column.modelField||!column.modelField.hidden})},_addModelColumns:function(model,alreadyAddedColumns){var columns=alreadyAddedColumns;if(this.autoAddAllModelFieldsAsColumns){var blackListedFields=Rally.ui.grid.FieldColumnFactory.getBlackListedFieldsForType(model.typePath),alreadyAddedFields=_(alreadyAddedColumns).pluck("modelField").compact().valueOf(),notAddedVisibleFields=_(model.getFields()).filter(this._isVisibleField).difference(alreadyAddedFields).value(),columnsAlreadyExist=!Ext.isEmpty(alreadyAddedFields),modelColumns=_(notAddedVisibleFields).map(function(field){var column=Rally.ui.grid.FieldColumnFactory.getColumnConfigFromField(field,model);return column.hidden=columnsAlreadyExist||_.contains(blackListedFields,field.name),column.dataIndex&&(this._setFieldLabelOnColumnConfig(column),column.text||(column.hidden=!0)),column},this).value(),specialColumns=["FormattedID","Name"];modelColumns.sort(function(columnA,columnB){var specialColumnIndexA=_.indexOf(specialColumns,columnA.dataIndex),specialColumnIndexB=_.indexOf(specialColumns,columnB.dataIndex);return columnA.dataIndex&&columnB.dataIndex&&specialColumnIndexA!==specialColumnIndexB?specialColumnIndexA===-1?1:specialColumnIndexB===-1?-1:specialColumnIndexA<specialColumnIndexB?-1:1:columnA.text<columnB.text?-1:columnA.text>columnB.text?1:0}),columns=columns.concat(modelColumns)}return columns},_setFieldLabelOnColumnConfig:function(column){var fieldLabel=Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(column.dataIndex);fieldLabel&&(column.text=fieldLabel)},_stripTagsFromColumnText:function(columns){return _.each(columns,function(column){column.dataIndex&&this.self.ICON_HEADER_FIELDS[column.dataIndex]||(column.text=Ext.util.Format.stripTags(column.text))},this)},_disabledEditorColumnsAsNeeded:function(columns){return _.each(columns,function(column){(!this.enableEditing||_.isArray(this.disabledEditorColumns)&&this.disabledEditorColumns.indexOf(column.dataIndex)>-1)&&(delete column.editor,column.tdCls&&(column.tdCls=column.tdCls.replace("editable","")))},this),columns},_augmentColumnConfigs:function(columns){return _.map(columns,function(column){var newCol=Ext.applyIf(column,{listeners:{render:function(col){var grid=col.up("rallygrid")||col.up("rallytreegrid");grid&&Ext.Function.interceptBefore(col,"toggleSortState",function(){var colText=col.textEl.getHTML();grid.recordAction({description:"column sorting changed",miscData:{column:colText}}),grid.recordLoadBegin({description:"grid reload due to sort",miscData:{column:colText}}),grid.on("load",function(){grid.recordLoadEnd()},{single:!0})})}},sortable:this.sortable,menuDisabled:this.disableColumnMenus});return this.sortable===!1&&(newCol.sortable=!1),newCol},this)},_removeSortableFromUnsortableColumns:function(columns){var unsortables=["rallytreerankdraghandlecolumn","rallyrowactioncolumn"];return _.map(columns,function(column){var attrDefinition=((column||{}).modelField||{}).attributeDefinition||{},isMultiValueCustomField=attrDefinition.Custom&&"COLLECTION"===attrDefinition.AttributeType;return(isMultiValueCustomField||_.contains(unsortables,column.xtype))&&(column.sortable=!1),column})},_isVisibleField:function(field){return!field.hidden},_insertRankColumn:function(model,columns){return model.isTask&&model.isTask()&&(columns=_.filter(columns,function(column){return"Rank"!==column})),this.rankColumnDataIndex&&(columns=_.filter(columns,function(column){return column!==this.rankColumnDataIndex},this),columns.unshift({xtype:"rallyfieldcolumn",text:"Rank",dataIndex:this.rankColumnDataIndex,draggable:!1,resizable:!1,width:45,sortable:!0})),columns},_addSummaryToColumns:function(columns){return _.map(columns,function(originalColumn){var updatedColumn=_.isString(originalColumn)?{dataIndex:originalColumn}:originalColumn,summaryColumn=_.find(this.summaryColumns,function(summaryColumn){return updatedColumn.dataIndex===summaryColumn.field});return summaryColumn?_.assign(updatedColumn,{summaryRenderer:function(value){return"<span class='rollup'>"+value+" "+summaryColumn.units+"</span>"},summaryType:summaryColumn.type}):originalColumn},this)},_resetFlexValues:function(columns){return this.resetFlexValues&&_.each(columns,this._resetFlexValueForColumn),columns},_resetFlexValueForColumn:function(column){column.flex=Rally.ui.grid.FieldColumnFactory.getDefaultFlexForField(column.dataIndex,column.flex)},_setContext:function(columns){return _.each(columns,function(column){column.context=this.context},this),columns}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.PagingToolbar",{extend:Ext.Component,alias:"widget.rallypagingtoolbar",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},clientMetrics:[{method:"movePrevious",description:"page change to previous"},{method:"moveNext",description:"page change to next"}],border:!1,cls:"grid-pager",config:{store:void 0,pageSizes:[25,50,100,200],comboboxConfig:{}},renderSelectors:{firstEl:".nav-links .rly-first",prevEl:".nav-links .rly-prev",nextEl:".nav-links .rly-next",lastEl:".nav-links .rly-last",pageSizeEl:".page-size-links"},renderTpl:new Ext.XTemplate('<tpl if="pageSizes.length &gt; 1">','<div class="page-size-links">','<div class="page-size-label">SHOW</div>','<div class="page-size-combobox-container"></div>',"</div>","</tpl>",'<div class="nav-links">','<span class="rly-first"></span> ','<span class="rly-prev"></span> ','<span class="range">',"{start}-{end}",'<tpl if="total &gt; 0">'," of {total}","</tpl>","</span> ",'<span class="rly-next"></span> ','<span class="rly-last"></span> ',"</div>"),constructor:function(config){this.callParent(arguments),this.addEvents("change","beforechange")},initComponent:function(){this.callParent(),this.on("beforerender",this._onBeforeRender,this),this.bindStore(this.store)},onRender:function(){this.callParent(arguments),this._reRender(),this.el.dom.tabIndex=0},onDestroy:function(){this._cleanupAdditionalComponents(),this.callParent(arguments)},_addPageSizeCombobox:function(){this.pageSizeEl&&(this.pagingComboBox=Ext.create("Rally.ui.combobox.ComboBox",Ext.apply({cls:"page-size-combobox",itemId:"pageSizeBox",listeners:{select:this.changePageSize,scope:this},store:Ext.create("Ext.data.Store",{fields:["value","display"],data:this._generatePageSizeData()}),queryMode:"local",displayField:"display",valueField:"value",renderTo:this.pageSizeEl.down(".page-size-combobox-container"),width:50,value:this.renderData.pageSize},this.comboboxConfig)))},_addButtons:function(){var disableBack=1===this.renderData.currentPage,disableForward=this.renderData.currentPage>=this.renderData.pageCount;this.firstButton=this._addButton("firstButton","First",this.moveFirst,disableBack,this.firstEl),this.prevButton=this._addButton("prevButton","Prev",this.movePrevious,disableBack,this.prevEl),this.nextButton=this._addButton("nextButton","Next",this.moveNext,disableForward,this.nextEl),this.lastButton=this._addButton("lastButton","Last",this.moveLast,disableForward,this.lastEl)},_addButton:function(itemId,text,clickFn,disabled,renderEl){return Ext.create("Rally.ui.Button",{itemId:itemId,text:text,cls:"secondary rly-small",listeners:{click:clickFn,scope:this},disabled:disabled,renderTo:renderEl})},_cleanupAdditionalComponents:function(){Ext.destroy(this.pagingComboBox,this.firstButton,this.prevButton,this.nextButton,this.lastButton)},_generatePageSizeData:function(){return _.map(this.pageSizes,function(size){return{display:size,value:size}})},_reRender:function(){this.rendered===!0&&(this._cleanupAdditionalComponents(),this.renderData=this._getPageData(),this.renderTpl.overwrite(this.getTargetEl(),this.renderData),this.applyRenderSelectors(),this._addPageSizeCombobox(),this._addButtons(),this.fireEvent("change",this,this.renderData))},_onFirstLoad:function(){this._reRender(),this.mon(this.getStore(),"load",this._onSubsequentLoads,this)},_onSubsequentLoads:function(){this._reRender(),this._recordMetricsEnd()},movePrevious:function(){var store=this.getStore(),prev=store.currentPage-1;prev>0&&this.fireEvent("beforechange",this,prev)!==!1&&(this._recordMetricsBegin("loading previous page"),store.previousPage())},moveNext:function(){var store=this.getStore(),total=this._getPageData().pageCount,next=store.currentPage+1;next<=total&&this.fireEvent("beforechange",this,next)!==!1&&(this._recordMetricsBegin("loading next page"),store.nextPage())},moveFirst:function(){var store=this.getStore(),currentPage=store.currentPage;currentPage>1&&this.fireEvent("beforechange",this,1)!==!1&&(this._recordMetricsBegin("loading first page"),this.getStore().loadPage(1))},moveLast:function(){var store=this.getStore(),currentPage=store.currentPage,lastPage=this._getPageData().pageCount;currentPage<lastPage&&this.fireEvent("beforechange",this,lastPage)!==!1&&(this._recordMetricsBegin("loading last page"),this.getStore().loadPage(lastPage))},changePageSize:function(combobox,newSize){if(newSize=newSize[0].get("value"),this._isCurrentPageSize(newSize))return!1;var store=this.getStore();store.pageSize=newSize,store.currentPage=1,this.ownerCt.refresh();var listView=this.up("rallylistview");return listView&&listView.storePageSize(newSize),this._reRender(),!0},_onBeforeRender:function(){this.renderData=this._getPageData()},_isCurrentPageSize:function(size){return this.getStore().pageSize===size},_getPageData:function(){var store=this.getStore();if(!store)return{total:0,currentPage:0,pageCount:0,pageSize:0,start:0,end:0,pageSizes:0};var totalCount=store.getTotalCount()||0,start=(store.currentPage-1)*store.pageSize+1;return 0===totalCount&&(start=0),{total:totalCount,currentPage:store.currentPage,pageCount:Math.ceil(totalCount/store.pageSize),pageSize:store.pageSize,start:start,end:Math.min(store.currentPage*store.pageSize,totalCount),pageSizes:this.getPageSizes()}},_recordMetricsBegin:function(description){this.loadingPage=!0,this.recordLoadBegin({description:description,component:this.getStore().requester||this})},_recordMetricsEnd:function(){this.loadingPage&&(this.recordLoadEnd({component:this.getStore().requester||this}),this.loadingPage=!1)},bindStore:function(store){store&&(store=Ext.data.StoreManager.lookup(store),this.mon(store,"load",this._onFirstLoad,this,{single:!0}),this.setStore(store))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.RowModel",{requires:[],extend:Ext.selection.RowModel,alias:"selection.rallyrowmodel",mixins:{keyboardnav:Rally.ui.grid.RowKeyboardNavigation},onKeyDown:function(){this.mixins.keyboardnav.onKeyDown.call(this,arguments)},onKeyUp:function(){this.mixins.keyboardnav.onKeyUp.call(this,arguments)},onEditorTab:function(editingPlugin,e){this.mixins.keyboardnav.onEditorTab.call(this,editingPlugin,e)},onEditorEnter:function(editingPlugin,field,e){this.mixins.keyboardnav.onEditorEnter.call(this,editingPlugin,field,e)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.Validation",{extend:Ext.AbstractPlugin,alias:"plugin.rallygridvalidation",init:function(grid){grid.editingPlugin&&(this.grid=grid,grid.validationPlugin=this,this._initEvents())},_initEvents:function(){this.grid.on("inlineeditsaved",this._onInlineEditSaved,this),this.grid.editingPlugin.on("beforeedit",this._onBeforeEdit,this)},_onInlineEditSaved:function(plugin,records,operation,record,column){operation.success?this._processValidationEvent(record,column,!0,""):this._onInlineEditFailed(plugin,operation,record,column)},_onInlineEditFailed:function(plugin,operation,record,column){var fieldName=column.field.getName();record.set(fieldName,record.modified[fieldName]),this._processValidationEvent(record,column,!1,operation.error.errors[0])},_processValidationEvent:function(record,column,isValid,errorMessage){var cellValidation={grid:this.grid,record:record,column:column,isValid:isValid,errorMessage:Rally.data.util.Record.removeValidationCruft(Rally.data.util.Record.makeErrorMessageMoreUserFriendly(errorMessage))};this.grid.fireEvent("cellvalidationchange",cellValidation)},_onBeforeEdit:function(editor,object,eOpts){object.column.field.originalValue=this._getOriginalValue(object),this._processValidationEvent(object.record,object.column,!0)},_getOriginalValue:function(object){var field=object.column.field;return!Ext.isFunction(object.column.field.transformOriginalValue)&&object.column.field.field&&(field=object.column.field.field),Ext.isFunction(field.transformOriginalValue)?field.transformOriginalValue(object.originalValue):object.originalValue}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.CellValidationUi",{extend:Ext.AbstractPlugin,alias:"plugin.rallycellvalidationui",init:function(grid){grid.validationPlugin&&(this.grid=grid,this.errorTooltips={},this._initEvents())},destroy:function(){this._clearErrorElements(),this.callParent(arguments)},_initEvents:function(){this.grid.on("storeload",this._clearErrorElements,this),this.grid.getView().on("itemremove",this._clearRowErrorElements,this),this.grid.on("destroy",this._clearErrorElements,this),this.grid.on("cellvalidationchange",this._onCellValidationChange,this)},_clearRowErrorElements:function(record){_.forEach(this.errorTooltips,function(value,key){key.match(record.getId())&&(value.destroy(),delete this.errorTooltips[key])},this)},_clearErrorElements:function(){_.invoke(this.errorTooltips,"destroy"),this.errorTooltips={};var store=this.grid.getStore();store&&_.isFunction(store.each)&&store.each(function(record){delete record[Rally.ui.grid.CellClsDecorator.invalidModelAttr]})},_destroyCellTooltip:function(cellValidation){var errorId=this._getErrorId(cellValidation);this.errorTooltips[errorId]&&(this.errorTooltips[errorId].destroy(),delete this.errorTooltips[errorId])},_onCellValidationChange:function(cellValidation){cellValidation.isValid?this._onCellValid(cellValidation):this._onCellInvalid(cellValidation)},_onCellValid:function(cellValidation){Rally.ui.grid.CellClsDecorator.markCellValid(cellValidation.grid,cellValidation.record,cellValidation.column),this._destroyCellTooltip(cellValidation)},_onCellInvalid:function(cellValidation){Rally.ui.grid.CellClsDecorator.markCellInvalid(cellValidation.grid,cellValidation.record,cellValidation.column),this.errorTooltips[this._getErrorId(cellValidation)]=Ext.create("Rally.ui.tooltip.ToolTip",{target:this.grid.getView().getCell(cellValidation.record,cellValidation.column),anchor:"top",cls:"rally-grid-error-message",html:Rally.util.Error.getUserFriendlyError(cellValidation.errorMessage)})},_getErrorId:function(cellValidation){return cellValidation.record.getId()+(cellValidation.column.field.name||cellValidation.column.field.getName())+"-validation-error-tooltip"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.DragDrop",{extend:Ext.grid.plugin.DragDrop,alias:"plugin.rallydragdrop",rankEnabledCls:"rank-enabled",clientMetrics:[{event:"drop",description:"artifact ranked by drag/drop"},{method:"_onInitDrag",description:"artifact drag rank start"}],init:function(cmp){this.cmp=cmp,this.cmp.mon(this.cmp.getStore(),"load",this._onStoreLoad,this),this.cmp.on("drop",this._onDrop,this),this.cmp.on("columnshow",this._setupRankColumn,this),this.callParent(arguments)},destroy:function(){this.cmp&&this.cmp.getEl()&&Ext.dd.ScrollManager.unregister(this.cmp.getEl()),this.callParent(arguments)},enable:function(){this._showRankColumn(),this.callParent(arguments)},disable:function(){this._hideRankColumn(),this.callParent(arguments)},onViewRender:function(){this._setupViewScroll(),this._setupRankColumn(),this._enableDragDrop()},_setupViewScroll:function(){var el=this.cmp.getEl();el.ddScrollConfig={ddGroup:"GridDD",vthresh:30,hthresh:-1,frequency:350,increment:50},Ext.dd.ScrollManager.register(el)},_setupRankColumn:function(){var rankCol=this._getRankColumn();if(rankCol){var rankField=Rally.data.Ranker.getRankField(this.cmp.getStore().model);rankCol.getSortParam=function(){return rankField}}},_enableDragDrop:function(){var _onBeforeDrag=Ext.bind(this._onBeforeDrag,this),onBeforeDrag=function(){if(this.callParent(arguments)===!1||_onBeforeDrag.apply(this,arguments)===!1)return!1};this.dragZone=Ext.create("Rally.ui.grid.dragdrop.DragZone",{view:this.cmp,ddGroup:this.dragGroup||this.ddGroup,dragText:this.dragText,onBeforeDrag:onBeforeDrag}),this.dropZone=Ext.create("Rally.ui.grid.dragdrop.DropZone",{view:this.cmp,ddGroup:this.dropGroup||this.ddGroup})},_getRankColumn:function(){var rankCol=this.cmp.headerCt.items.getAt(0);return rankCol instanceof Rally.ui.grid.RankDragHandleColumn?rankCol:null},_userDraggingRankCell:function(event){var rankCol=this._getRankColumn();return!(!rankCol||!event.getTarget("."+rankCol.draggableCls))},_setConstraints:function(){var dragDrop=this.dragZone;dragDrop.setInitPosition();var el=this.cmp.getEl(),gridCmp=Ext.getCmp(el.up(".rally-grid").id),headerEl=gridCmp.headerCt.getEl(),xy=el.getXY(),top=dragDrop.initPageY-xy[1],padding=3;dragDrop.setXConstraint(0,0),dragDrop.setYConstraint(top,el.getHeight()-top-headerEl.getHeight()-padding)},_showRankColumn:function(){this.cmp.hasCls(this.rankEnabledCls)||this.cmp.addCls(this.rankEnabledCls)},_hideRankColumn:function(){this.cmp.removeCls(this.rankEnabledCls)},_onBeforeDrag:function(dragData){return!!this._userDraggingRankCell(dragData.event)&&void this._onInitDrag()},_onInitDrag:function(){this.dropZone&&this.dropZone.onInitDrag(this.dragZone),this._setConstraints()},_onStoreLoad:function(){Rally.data.Ranker.isDnDRankable(this.cmp.getStore())?this.enable():this.disable()},_onDrop:function(rowEl,dropData,overModel,dropPosition,opts){var droppedRecord=dropData.records[0];droppedRecord._dragAndDropped=!0,this.cmp.ownerCt.setLoading(!0),Rally.data.Ranker.rankRelative({recordToRank:dropData.records[0],relativeRecord:overModel,position:dropPosition,saveOptions:{callback:this._onRank,scope:this}})},_onRank:function(record,operation){delete record._dragAndDropped,this.cmp.ownerCt.setLoading(!1)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.CellEditing",{extend:Ext.grid.plugin.CellEditing,alias:"plugin.rallycellediting",mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},publishMessages:!0,clicksToEdit:1,onEnterKey:Ext.emptyFn,onEscKey:function(){return this.callParent(arguments),!0},init:function(){this.callParent(arguments),this.grid.addEvents("inlineedit","inlineeditsaved"),this.mon(this.grid,"edit",this._saveInlineEdit,this),this.mon(this.grid.store,"remove",this._onRecordRemoved,this),this.mon(this,"beforeedit",this._onBeforeEdit,this)},getEditor:function(record,column){var editor=this.callParent(arguments);return editor.completeOnEnter=!1,editor.record=record,editor._beforeCompleteListenerAdded||(editor.on("beforecomplete",this._onBeforeStart,this),editor._beforeCompleteListenerAdded=!0),editor.offsets=[0,1],editor},showEditor:function(ed,context,value){var superclassShowEditorFn,WORKSPACE_TIMEZONE_TOGGLE=Rally.environment.useWorkspaceTimeZone;WORKSPACE_TIMEZONE_TOGGLE&&value instanceof Date&&(value=Rally.util.DateTime.convertForEditing(value)),Ext.isFunction(ed.prepareEditor)?(superclassShowEditorFn=Ext.bind(this.superclass.showEditor,this,[ed,context,value]),ed.prepareEditor(context,superclassShowEditorFn)):(this._resetFieldIfNeeded(ed.field,context.record,context.field),this.callParent([ed,context,value]))},onEditComplete:function(ed,value,startValue){var WORKSPACE_TIMEZONE_TOGGLE=Rally.environment.useWorkspaceTimeZone;WORKSPACE_TIMEZONE_TOGGLE&&value instanceof Date&&(value=Rally.util.DateTime.convertFromEditing(value)),this.callParent([ed,value,startValue])},_resetFieldIfNeeded:function(editorField,record,columnFieldName){if(editorField&&editorField.setField&&record&&record.getField&&columnFieldName){var newField=record.getUnmappedField?record.getUnmappedField(columnFieldName):null;newField||(newField=record.getField(columnFieldName)),newField&&editorField.setField(newField)}},onSpecialKey:function(editor,field,e){var sm,keyCode=e.getKey();keyCode!==e.ENTER||editor.completeOnEnter?keyCode===e.TAB&&this.recordAction({component:this.grid,description:"typed tab on grid cell"}):(this.recordAction({component:this.grid,description:"typed enter on grid cell"}),e.stopEvent(),sm=this.grid.getSelectionModel(),sm.onEditorEnter(this,field,e)),this.callParent(arguments)},onCellClick:function(view,cell,colIdx,record,row,rowIdx,e){!this._eventTargetIsNotALink(e)||e.browserEvent&&e.browserEvent.returnValue===!1||(this.recordAction({component:this.grid,description:"clicked grid cell"}),this.callParent(arguments))},_eventTargetIsNotALink:function(e){return Ext.isEmpty(e.getTarget())||Ext.isEmpty(e.getTarget().dom)||"a"!==e.getTarget().dom.nodeName.toLowerCase();
},_onRecordRemoved:function(store,record){var activeEditor=this.getActiveEditor();activeEditor&&(activeEditor.record===record?activeEditor.cancelEdit():(activeEditor.realign(!0),activeEditor.field.doAlign&&activeEditor.field.doAlign()))},_onBeforeEdit:function(editor,e){var field;if(e.record.getField)return field=e.record.getField(e.field),!(!field||field.readOnly||field.hidden||!e.record.get("updatable")||this._isMultiValueCustomField(field.attributeDefinition))},_abortInlineEdit:function(event){return event.column.field.abortInlineEdit&&event.column.field.abortInlineEdit(event)},_isMultiValueCustomField:function(attr){return attr&&attr.Constrained&&attr.Custom&&"COLLECTION"===attr.AttributeType},_saveInlineEdit:function(editor,event){this._abortInlineEdit(event)&&event.record.set(event.field,event.originalValue);var changes=event.record.getChanges();if(!Ext.Object.isEmpty(changes)){var grid=this.grid,record=this.context.record,column=this.context.column;grid.suspendLayouts(),grid.fireEvent("inlineedit",this,editor,event),event.record.save({requester:grid,callback:function(savedRecord,operation){var success=operation.success,grid=this.grid;if(this.publishMessages)if(success){var associatedRecords;grid&&grid.store&&grid.store.isCollectionStore&&(associatedRecords=grid.store.record),this.publish(Rally.Message.objectUpdate,savedRecord,_.keys(changes),this,[associatedRecords]),this.publish(Rally.Message.recordUpdateSuccess,savedRecord)}else this.publish(Rally.Message.recordUpdateFailure);grid&&(grid.fireEvent("inlineeditsaved",this,savedRecord,operation,record,column),success&&"Rally.ui.grid.Grid"===Ext.getClassName(grid)&&grid.highlightRowForRecord(savedRecord),grid.resumeLayouts())},scope:this,params:{fetch:grid.getAllFetchFields()}})}},_onBeforeStart:function(editor){var retval=!(editor.field&&editor.field.store&&editor.field.store.loading);return retval||editor.hideEdit(),retval},getActiveEditorInputId:function(){return this.getActiveEditor().field.inputEl.id}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.ObjectUpdateListener",{extend:Ext.AbstractPlugin,alias:"plugin.rallyobjectupdatelistener",mixins:{messageable:Rally.Messageable},init:function(cmp){this.cmp=cmp,this.subscribe(Rally.Message.objectCreate,this._onObjectCreate,this),this.subscribe(Rally.Message.objectUpdate,this._onObjectUpdate,this),this.subscribe(Rally.Message.objectDestroy,this._onObjectDestroy,this)},destroy:function(){this.unsubscribe(Rally.Message.objectCreate,this._onObjectCreate,this),this.unsubscribe(Rally.Message.objectUpdate,this._onObjectUpdate,this),this.unsubscribe(Rally.Message.objectDestroy,this._onObjectDestroy,this)},_updateStoreRecords:function(changedObject,changedFields,cmp,specifiedAssociatedRecords){var foundRecord,store=cmp.store,associatedRecords=this._getAssociatedRecords(changedObject,specifiedAssociatedRecords);_.isFunction(store.findExactRecord)&&(foundRecord=store.findExactRecord(changedObject)),foundRecord?cmp.updateExistingRecord(foundRecord,changedFields):_.isEmpty(associatedRecords)&&cmp.insertRecordIfShould(changedObject),cmp.updateAssociatedRecords(associatedRecords)},_onObjectCreate:function(changedObject,cmp,specifiedAssociatedRecords){this._shouldProcessObjectModification(changedObject,cmp)&&this.cmp.insertRecordIfShould(changedObject,this._getAssociatedRecords(changedObject,specifiedAssociatedRecords))},_onObjectUpdate:function(changedObject,changedFields,cmp,specifiedAssociatedRecords){this._shouldProcessObjectModification(changedObject,cmp)&&this._updateStoreRecords(changedObject,changedFields,this.cmp,specifiedAssociatedRecords)},_onObjectDestroy:function(changedObject,cmp){if(this._shouldProcessObjectModification(changedObject,cmp)){var removedRecord,store=this.cmp.store;if(_.isFunction(store.findExactRecord)){removedRecord=store.findExactRecord(changedObject),removedRecord&&store.remove(removedRecord);var associatedRecords=store.getAssociatedRecords(changedObject);this.cmp.updateAssociatedRecords(associatedRecords)}}},_getAssociatedRecords:function(changedObject,specifiedAssociatedRecords){var associatedRecords=[],store=this.cmp.store;if(_.isFunction(store.findExactRecord)){var specifiedAssociatedRecordsInStore=_.compact(_.map(specifiedAssociatedRecords||[],store.findExactRecord,store)),calculatedAssociatedRecordsInStore=store.getAssociatedRecords(changedObject);associatedRecords=_.union(specifiedAssociatedRecordsInStore,calculatedAssociatedRecordsInStore)}return associatedRecords},_shouldProcessObjectModification:function(changedObject,cmp){return"Rally.ui.grid.TreeGrid"===Ext.getClassName(this.cmp)?changedObject.isWsapiModel:this.cmp.store&&!(cmp&&cmp.grid&&cmp.grid.id===this.cmp.id)&&changedObject.isWsapiModel}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Animation",{singleton:!0,highlight:function(el,options){var callback=Ext.isObject(options)?Ext.bind(options.callback,options.scope||this,[el]):Ext.emptyFn;Ext.isIE8?this._showHideHighlight(el,callback):this._animateHighlight(el,callback)},_getColor:function(){return Rally.util.Colors.lime},_getDuration:function(){return 500},_animateHighlight:function(el,callback){var anim={duration:this._getDuration(),listeners:{afteranimate:callback}};el.highlight(this._getColor(),anim)},_showHideHighlight:function(el,callback){var colorProp="background-color",color=el.getStyle(colorProp);el.setStyle(colorProp,this._getColor()),Ext.defer(this._hideHighlight,this._getDuration(),this,[el,colorProp,color,callback])},_hideHighlight:function(el,colorProp,color,callback){el.setStyle(colorProp,color),callback()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.dom.ElementMovementDetector",{extend:Ext.util.Observable,constructor:function(){this.callParent(arguments),this.addEvents("move","detach")},start:function(el){this._watch(el,el.getX(),el.getY())},stop:function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),delete this.timeoutId)},_watch:function(el,originalX,originalY){var x=el.getX(),y=el.getY();x===originalX&&y===originalY?this.timeoutId=Ext.defer(this._watch,100,this,[el,originalX,originalY]):0===x&&0===y?(this.stop(),this.fireEvent("detach")):(this.stop(),this.fireEvent("move"))}})}(),function(){var Ext=window.Ext4||window.Ext,activePopovers=[];Ext.define("Rally.ui.popover.Popover",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallypopover",mixins:[Rally.Messageable],autoShow:!0,componentCls:"rly-popover dark-container",header:!0,preventFocusOnActivate:!0,shouldHidePopoverOnBodyClick:!1,shouldHidePopoverOnIframeClick:!1,autoCenter:!1,closable:!0,shadow:!1,target:void 0,targetSelector:void 0,targetTriggeredCls:void 0,owner:void 0,placement:void 0,offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],viewportPadding:[0,0,0,0],targetPosition:["b-t","l-r","t-b","r-l"],chevronPosition:["t-b","r-l","b-t","l-r"],chevronOffset:[{x:0,y:-14},{x:14,y:0},{x:0,y:14},{x:-8,y:0}],showChevron:!0,chevronPrefixCls:"",titleIconCls:"",inheritableStatics:{MASK_CLS:"popover-mask",DEFAULT_PLACEMENT:["right","left","top","bottom"]},initComponent:function(){this.callParent(arguments),this.placement=this.placement||this.self.DEFAULT_PLACEMENT,this.on("resize",this.alignToTarget,this),this.on("show",this._markActive,this),this.on("hide",this._markInactive,this),this.on("destroy",this._markInactive,this),Ext.EventManager.onWindowResize(this._onWindowResize,this),this.shouldHidePopoverOnBodyClick&&Ext.getBody().on("click",this._onBodyClick,this,{capture:!0}),this.shouldHidePopoverOnIframeClick&&(Rally.environment.getMessageBus().subscribe(Rally.Message.iframeLoaded,this._bindToIframeClick,this),Ext.Array.each(Ext.query("iframe"),this._bindToIframeClick,this)),this.addEvents(["align","closedbyoutsideclick","targetclick"]),this.target=Ext.get(this.target)},_bindToIframeClick:function(iframe){iframe&&iframe.contentWindow&&iframe.contentWindow.Ext&&iframe.contentWindow.Ext.getBody().on("click",this._onBodyClick,this,{capture:!0})},_unBindToIframeClick:function(iframe){iframe&&iframe.contentWindow&&iframe.contentWindow.Ext&&iframe.contentWindow.Ext.getBody().un("click",this._onBodyClick,this)},_onBodyClick:function(event){this._clickedInPopover(event)||this._clickedOnTarget(event)||(this.fireEvent("closedbyoutsideclick"),this.destroy()),this._clickedOnTarget(event)&&(this.fireEvent("targetclick",this),event.preventDefault(),event.stopPropagation())},_clickedOnTarget:function(event){return Ext.get(event.getTarget())===Ext.get(this.target)},_clickedInPopover:function(event){var parentSelector="."+this.componentCls.replace(" ","."),popover=Ext.get(event.getTarget()).findParent(parentSelector);return popover&&popover.id&&Ext.getCmp(popover.id)},alignToTarget:function(){!this._isTargetInDom()&&Ext.isEmpty(this.targetSelector)||this._positionPopoverAndChevron()},afterShow:function(){this.callParent(arguments),this.classAddedToMask=!1,this.modal&&(this.mon(this._getMaskEl(),"click",this._onMaskClicked,this),this._getMaskEl().hasCls(this.self.MASK_CLS)||(this.classAddedToMask=!0,this._getMaskEl().addCls(this.self.MASK_CLS))),this.focus(),this._positionPopoverAndChevron(),this.targetTriggeredCls&&this.target.addCls(this.targetTriggeredCls),this.titleIconCls&&this.getHeader().titleCmp.addCls(this.titleIconCls)},_isActive:function(){return _.last(activePopovers)===this},_markActive:function(){activePopovers.push(this)},_markInactive:function(){_.remove(activePopovers,{id:this.id})},_destroyMovementDetector:function(){this.elMovementDetector&&(this.elMovementDetector.stop(),delete this.elMovementDetector)},_onMaskClicked:function(){this._isActive()&&this.destroy()},beforeDestroy:function(){this.modal&&this.zIndexManager&&this.classAddedToMask===!0&&this._getMaskEl().removeCls(this.self.MASK_CLS),this.shouldHidePopoverOnBodyClick&&Ext.getBody().un("click",this._onBodyClick,this),this.shouldHidePopoverOnIframeClick&&(Rally.environment.getMessageBus().unsubscribe(Rally.Message.iframeLoaded,this._bindToIframeClick,this),Ext.Array.each(Ext.query("iframe"),this._unBindToIframeClick,this)),this.callParent(arguments)},onDestroy:function(){this.targetTriggeredCls&&this.target.removeCls(this.targetTriggeredCls),this.un("resize",this.alignToTarget,this),Ext.EventManager.removeResizeListener(this._onWindowResize,this),this._destroyMovementDetector(),this.chevron&&this.chevron.destroy(),this.callParent(arguments)},_getMaskEl:function(){return this.zIndexManager.mask},getPlacement:function(){var placement=_.result(this,"placement");return Ext.Array.from(placement)},_positionPopoverAndChevron:function(){var index,chevronOrientation;if(this.targetSelector){if(this._restoreTarget(),this._targetNotInDom())return void this.destroy();this.targetXY=this.target.getXY()}var direction=_.find(this.getPlacement(),this._showDirection,this);direction?(index=this._orientationIndexMap[direction],chevronOrientation=this._chevronOrientationMap[direction]):(index=this._orientationIndexMap[this.getPlacement()[0]],chevronOrientation=this._chevronOrientationMap[this.getPlacement()[0]]),this._positionPopover(index),this._showChevron(chevronOrientation,this.chevronPosition[index],[this.chevronOffset[index].x,this.chevronOffset[index].y]),this.targetSelector&&(this.elMovementDetector&&this._destroyMovementDetector(),this.elMovementDetector=Ext.create("Rally.dom.ElementMovementDetector",{listeners:{move:this.alignToTarget,detach:this.alignToTarget,scope:this}}),this.elMovementDetector.start(this.target)),this.fireEvent("align",this)},_showDirection:function(direction){switch(direction){case"right":return this.canShowRight();case"left":return this.canShowLeft();case"top":return this.canShowTop();case"bottom":return this.canShowBottom()}return!1},_positionPopover:function(index){this.alignTo(this.target,this.targetPosition[index],[this.offsetFromTarget[index].x,this.offsetFromTarget[index].y]),this.viewportPadding&&this._adjustToViewport()},_adjustToViewport:function(){this._move(this._determineViewportAdjustment(Ext.getBody().getViewSize(),Ext.getBody().getScroll()))},_determineViewportAdjustment:function(viewportSize,viewportScroll){result={x:0,y:0};var rightLimit=viewportSize.width-this.viewportPadding[this._orientationIndexMap.right]+viewportScroll.left,leftLimit=this.viewportPadding[this._orientationIndexMap.left]+viewportScroll.left,topLimit=this.viewportPadding[this._orientationIndexMap.top]+viewportScroll.top,bottomLimit=viewportSize.height-this.viewportPadding[this._orientationIndexMap.bottom]+viewportScroll.top;return this._getRight()>rightLimit?result.x=rightLimit-this._getRight():this._getLeft()<leftLimit&&(result.x=-this._getLeft()+leftLimit),this._getTop()<topLimit?result.y=-this._getTop()+topLimit:this._getBottom()>bottomLimit&&(result.y=bottomLimit-this._getBottom()),result},_move:function(offset){var p=this.getPosition();this.setPosition(p[0]+offset.x,p[1]+offset.y)},_isTargetInDom:function(){return!this._targetNotInDom()},_targetNotInDom:function(){return!this.target.dom||0===this.target.getX()&&0===this.target.getY()},_restoreTarget:function(){if(this._targetNotInDom()){var targetEl,lastOffset,newOffset;try{Ext.Array.each(Ext.getBody().query(this.targetSelector),function(el){el=Ext.get(el);var region=el.getRegion();newOffset=Math.abs(region.getOutOfBoundOffsetX(this.targetXY[0])+region.getOutOfBoundOffsetY(this.targetXY[1])),(!Ext.isDefined(lastOffset)||newOffset<lastOffset)&&(targetEl=el),lastOffset=newOffset},this),targetEl&&(this.target=targetEl)}catch(e){this._destroyMovementDetector()}}},_showChevron:function(orientation,pos,offset){if(this.showChevron&&!this.chevron&&(this.chevron=Ext.create("Ext.Component",{cls:this.chevronPrefixCls+" popover-chevron icon-"+orientation,floating:!0,autoShow:!0,shadow:!1,listeners:{click:{element:"el",fn:this._onChevronClick,scope:this}}})),this.chevron){var chevronEl=this.chevron.getEl();chevronEl.removeCls(["icon-up","icon-down","icon-left","icon-right"]),chevronEl.addCls("icon-"+orientation),this.chevron.alignTo(this.getEl(),pos,offset),this.chevron.toFront()}},_onChevronClick:function(){this.destroy()},_placementContains:function(direction){var placement=this.getPlacement();return 0===placement.length||_.contains(placement,direction)},_orientationIndexMap:{top:0,right:1,bottom:2,left:3},_chevronOrientationMap:{top:"down",right:"left",bottom:"up",left:"right"},_getLeft:function(){return this.getPosition()[0]},_getRight:function(){return this.getPosition()[0]+this.getWidth()},_getTop:function(){return this.getPosition()[1]},_getBottom:function(){return this.getPosition()[1]+this.getHeight()},_canFitAboveOrBelow:function(direction){var targetCenter=this.target.getLeft()+(this.target.getRight()-this.target.getLeft())/2,xOffset=this.offsetFromTarget[this._orientationIndexMap[direction]].x,leftEdge=targetCenter-this.getWidth()/2+xOffset,rightEdge=targetCenter+this.getWidth()/2+xOffset;return leftEdge>=Rally.util.Window.getScrollX()&&rightEdge<=Rally.util.Window.getWidth()-Rally.util.Window.getScrollX()},_canFitLeftOrRight:function(direction){var targetCenter=this.target.getTop()+(this.target.getBottom()-this.target.getTop())/2,topEdge=targetCenter-this.getHeight()/2,bottomEdge=targetCenter+this.getHeight()/2;return topEdge>=Rally.util.Window.getScrollY()&&bottomEdge<=Rally.util.Window.getHeight()-Rally.util.Window.getScrollY()},canShowTop:function(){return this._placementContains("top")&&this._canFitAboveOrBelow("top")&&this.target.getTop()-Rally.util.Window.getScrollY()-this.offsetFromTarget[this._orientationIndexMap.top].y>=this.getHeight()},canShowRight:function(){return this._placementContains("right")&&this._canFitLeftOrRight("right")&&Rally.util.Window.getWidth()-(this.target.getRight()-Rally.util.Window.getScrollX())-this.offsetFromTarget[this._orientationIndexMap.right].x>=this.getWidth()},canShowBottom:function(){return this._placementContains("bottom")&&this._canFitAboveOrBelow("bottom")&&Rally.util.Window.getHeight()-(this.target.getBottom()-Rally.util.Window.getScrollY())-this.offsetFromTarget[this._orientationIndexMap.bottom].y>=this.getHeight()},canShowLeft:function(){return this._placementContains("left")&&this._canFitLeftOrRight("left")&&this.target.getLeft()-Rally.util.Window.getScrollX()-this.offsetFromTarget[this._orientationIndexMap.left].x>=this.getWidth()},_onWindowResize:function(){this.alignToTarget()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.blockedreason.BlockedReasonViewController",{extend:Rally.ui.ViewController,mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},observe:{view:{unblock:"unblock",saveBlockedReason:"saveBlockedReason",startEdit:"startEdit",cancelEdit:"cancelEdit",beforeDestroy:"beforeDestroy"}},unblock:function(record){this._save(record,"Blocked",!1)},_changed:!1,beforeDestroy:function(startedInEdit,record){startedInEdit&&!this._changed&&this.publish(Rally.Message.objectUpdate,record,["Blocked","BlockedReason"],this)},saveBlockedReason:function(record,newValue,oldValue,noOp){noOp===!0?(this.publish(Rally.Message.blockedReasonPopoverNoOpSave,"BlockedReason",newValue),this.getView().destroyView()):(newValue="undefined"!=typeof newValue?newValue:"",String(newValue).trim()!==String(oldValue).trim()?this._save(record,"BlockedReason",newValue):(this.publish(Rally.Message.objectUpdate,record,["BlockedReason"],this),this.getView().destroyView()))},startEdit:function(record,startingReason){var field=record?record.getField("BlockedReason"):null,fieldMaxLength=field?field.attributeDefinition.MaxLength:256,value="string"==typeof startingReason?startingReason:record.get("BlockedReason");this.getView().startEdit(value,fieldMaxLength)},cancelEdit:function(){this.getView().cancelEdit()},_save:function(record,fieldName,fieldValue){record.set(fieldName,fieldValue),this._saveRecord(record,fieldName).then({success:function(record){this._saveComplete(record,fieldName)},failure:function(error){this._saveError(error),record.reject()},scope:this}).always(function(){this.getView().destroyView()},this)},_saveRecord:function(record,fieldName){var deferred=new Deft.Deferred;return record.save({requester:this.getView(),success:function(){deferred.resolve(record)},failure:function(record,operation){deferred.reject(operation.error.errors[0])},params:{fetch:record.store?record.store.fetch:[fieldName,"WorkProduct"]},scope:this}),deferred.promise},_saveComplete:function(record,fieldName){this._changed=!0,this.publish(Rally.Message.objectUpdate,record,[fieldName],this)},_saveError:function(error){Rally.ui.notify.Notifier.showError({message:"An error occurred while saving your changes. "+error})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.blockedreason.BlockedReason",{extend:Ext.container.Container,alias:"widget.rallyblockedreason",mixins:[Rally.Messageable,Rally.ui.blockedreason.BlockedReasonHelper,Rally.clientmetrics.ClientMetricsRecordable],cls:"blocked-reason-container",controller:"Rally.ui.blockedreason.BlockedReasonViewController",isEditing:!1,record:null,noOp:!1,startingReason:void 0,tplCls:void 0,editorBottomPadding:3,editorRightPadding:5,editorHeight:63,clientMetrics:[{beginEvent:"unblock",endEvent:"editorclosed",description:"unblocked the work product"},{beginEvent:"saveBlockedReason",endEvent:"editorclosed",description:"saved the blocked reason on the work product"}],initComponent:function(){this.callParent(arguments),this.addEvents(["unblock","saveBlockedReason","startEdit","cancelEdit","beforeDestroy","editorclosed"])},constructor:function(config){var blockedReason,editableClass,showButton;this.mergeConfig(config),this._startedInEdit=this.isEditing,this.noOp?(blockedReason=this.startingReason||"",editableClass="editable",showButton=!0):(blockedReason=this.record.get("BlockedReason"),editableClass=this.record.get("updatable")?"editable":"",showButton=this.record.get("updatable")),this.items=[{xtype:"component",itemId:"blockedReasonComponent",style:"overflow:hidden",height:this.editorHeight+2*this.editorBottomPadding+1,tpl:Rally.ui.blockedreason.BlockedReasonHelper.getTemplate(),data:{blockedReason:blockedReason,editableClass:editableClass,requiredClass:"",className:"rally-blocked-reason-content-popover"}}],this.callParent(arguments),showButton&&(this.button=this.add(this._getButtonConfig()).getLeft())},destroyView:function(){this._resetEditor(),this.fireEvent("editorclosed",this)},destroy:function(){this.fireEvent("beforeDestroy",this._startedInEdit,this.record),this._resetEditor(),this.callParent(arguments)},afterRender:function(){this.callParent(arguments),this.mon(this.getEl().down("."+this.tplCls),"click",function(){this.fireEvent("startEdit",this.record,this.startingReason)},this)},startEdit:function(value,fieldMaxLength){this.isEditing=!0,this._updateButtonText(),this._addTextField(value,fieldMaxLength)},cancelEdit:function(){this._resetEditor(),this.focus(null,200)},_startedInEdit:!1,_onButtonClick:function(){this._isEditing()&&this.activeEditor?this.activeEditor.completeEdit():this.fireEvent("unblock",this.record)},_addTextField:function(value,fieldMaxLength){var targetEl=this.getEl().down("."+this.tplCls+" div"),parentEl=targetEl.parent(),edField=this.getEditorField(targetEl,fieldMaxLength),editorConfig=this.getEditorConfig(parentEl,edField);this.activeEditor=Ext.create("Ext.Editor",editorConfig),this.activeEditor.startEdit(targetEl,value),this._adjustEditorPosition()},_onEditorComplete:function(editor,newValue,oldValue){this.fireEvent("saveBlockedReason",this.record,newValue,oldValue,this.noOp)},_onCancelEdit:function(){this.fireEvent("cancelEdit")},_resetEditor:function(){this.isEditing=!1,this.activeEditor&&(this.activeEditor.cancelEdit(),this.activeEditor.destroy()),this._updateButtonText()},_adjustEditorPosition:function(){var el=this.getEl().down("."+this.tplCls);el&&this.activeEditor&&this.activeEditor.getHeight()>0&&this.activeEditor.setPosition([this.activeEditor.getPosition()[0],el.getTop()+this.editorBottomPadding])},_updateButtonText:function(){if(this.button){var buttonText=this._getButtonText();this.button.setText(buttonText),this.button.userAction="clicked "+buttonText}},_getButtonText:function(){return this._isEditing()?"Done":"Unblock"},_isEditing:function(){return this.isEditing},_getButtonConfig:function(){var buttonConfig={xtype:"rallybutton",text:this._getButtonText(),itemId:"left",cls:"rly-left primary rly-small",style:{"margin-top":"5px;"},listeners:{click:this._onButtonClick,scope:this}};return{xtype:"rallyleftright",items:[buttonConfig]}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.BlockedReasonPopover",{alias:"widget.rallyblockedreasonpopover",extend:Rally.ui.popover.Popover,mixins:[Rally.Messageable],clientMetrics:[{event:"show",description:"blockedreason popover opened"},{method:"onHide",description:"blockedreason popover closed"},{beginMethod:"_fetchRecord",endMethod:"_onDataRetrieved",description:"fetching the record"}],cls:"blocked-reason-popover",width:320,offsetFromTarget:[{x:0,y:-10},{x:15,y:0},{x:0,y:10},{x:-15,y:0}],header:!1,config:{isEditing:!1,record:null,oid:null,type:null,noOp:!1,startingReason:null},constructor:function(config){Ext.apply(this.config,config),this.callParent(arguments),this._needToFetchRecord(config)?this._fetchRecord(config):this._addBlockedReasonComponent()},afterLayout:function(event){this.callParent(arguments),event.layoutCount===event.triggerCount&&(this.fireEvent("rendercomplete"),this.isEditing&&this.getComponent("blockedReasonContainer").fireEvent("startEdit",this.record,this.startingReason))},_needToFetchRecord:function(config){return!this.noOp&&(!(config.record&&config.record.store&&config.record.store.fetch)||(!this._hasFetchField(config.record.store,"Blocked")||!this._hasFetchField(config.record.store,"BlockedReason")&&(!config.record.data||""===config.record.data.BlockedReason)))},_hasFetchField:function(store,fieldName){return _.indexOf(store.fetch,fieldName)!==-1},_blockedReasonConfig:function(record){var me=this;return{xtype:"rallyblockedreason",itemId:"blockedReasonContainer",record:record,isEditing:this.isEditing,noOp:this.noOp,startingReason:this.startingReason,contentHeight:"100%",tplCls:"rally-blocked-reason-content-popover",listeners:{editorclosed:function(){me.destroy()}}}},_fetchRecord:function(config){this.oid=config.oid||config.record.get("ObjectID"),Rally.data.ModelFactory.getModel({wsapiVersion:"v2.x",type:config.type||config.record.get("_type"),requester:this,success:this._onModelRetrieved,scope:this})},_onModelRetrieved:function(model){model.load(this.oid,{fetch:["Blocked","BlockedReason","WorkProduct"],callback:this._onDataRetrieved,scope:this})},_onDataRetrieved:function(result,operation){operation.wasSuccessful()&&result?(this.record=result,this._addBlockedReasonComponent()):this.destroy(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_addBlockedReasonComponent:function(){this.add(this._blockedReasonConfig(this.record))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.BlockedReasonPopoverPlugin",{extend:Ext.AbstractPlugin,alias:"plugin.rallyblockedreasonpopoverplugin",mixins:{messageable:Rally.Messageable,observable:Ext.util.Observable},init:function(grid){this.grid=grid,this.grid.mon(this.grid,"viewready",this._attachPopovers,this,{single:!0})},_attachPopovers:function(){this.mun(this.grid,"cellClick",this._onClick,this,{stopEvent:!0}),this.mon(this.grid,"cellClick",this._onClick,this,{stopEvent:!0})},_onClick:function(view,cell,colIdx,record,row,rowIdx,event){var el=Ext.get(cell),targetEl=Ext.get(event.getTarget());if(this._isClickableBlockedIcon(targetEl)&&this.eventInProcess!==!0){this.eventInProcess=!0;var blocked=record.get("Blocked");if(!blocked&&!record.get("updatable"))return;var target="#"+el.up("."+Ext.baseCSSPrefix+"grid-row").id+" .blocked, #"+el.up("."+Ext.baseCSSPrefix+"grid-row").id+" .blockable";this._blockOrUnblockIfNeeded(record,blocked).then({success:function(args){this._shouldShowPopover(record)?this._createPopover(args.record,blocked,target,rowIdx):this.publish(Rally.Message.objectUpdate,args.record,["Blocked"])},failure:function(args){this._showFailure(args.error)},scope:this}).always(function(){this.eventInProcess=!1},this)}},_isClickableBlockedIcon:function(targetEl){return targetEl.hasCls("clickable")&&(targetEl.hasCls("blockable")||targetEl.hasCls("blocked"))},_blockOrUnblockIfNeeded:function(record,blocked){var deferred=new Deft.Deferred,blockIt=this._needsToBeBlocked(record,blocked),unblockIt=this._needsToBeUnblocked(record,blocked);if(blockIt||unblockIt)if(record.dirty){var task=new Ext.util.DelayedTask(function(){this._setAndSaveRecord(deferred,record,blockIt)},this);task.delay(200)}else this._setAndSaveRecord(deferred,record,blockIt);else deferred.resolve({record:record});return deferred.promise},_setAndSaveRecord:function(deferred,record,blocked){record.set("Blocked",blocked),this._save(deferred,record)},_save:function(deferred,record){record.save({success:function(updatedRecord){deferred.resolve({record:updatedRecord}),this._attachPopovers()},failure:function(updatedRecord,operation){var error=operation.error.errors[0];record.reject(),deferred.reject({error:error}),this._attachPopovers()},params:{fetch:record.store?record.store.fetch:[fieldName]},scope:this})},_createPopover:function(record,blocked,target,rowIndex){var el=Ext.get(Ext.query(target)[0]);el.removeCls("blockable").addCls("blocked");var targetData=this._getTarget(el,blocked,rowIndex);Ext.create("Rally.ui.popover.BlockedReasonPopover",{target:targetData.target,targetSelector:targetData.targetSelector,record:record,isEditing:this._needsToBeBlocked(record,blocked)})},_showFailure:function(error){Rally.ui.notify.Notifier.showError({message:"An error occurred while saving your changes. "+error,timeout:5e3})},_shouldShowPopover:function(record){return!record.self.getField("BlockedReason").hidden},_needsToBeUnblocked:function(record,blocked){return record.get("updatable")&&blocked&&!this._shouldShowPopover(record)},_needsToBeBlocked:function(record,blocked){return record.get("updatable")&&!blocked},_getRecordFor:function(el){var row=el.up("."+Ext.baseCSSPrefix+"grid-row");return row?this.grid.getStore().getAt(row.dom.rowIndex-1):null},_getTarget:function(el,blocked,rowIndex){if(blocked)return{target:el,targetSelector:el.id};var selector="#"+this.grid.getEl().id+" .x-grid3-row:nth-child("+(rowIndex+1)+") img.blocked";return{target:el,targetSelector:selector}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.ColorPopover",{alias:"widget.rallycolorpopover",extend:Rally.ui.popover.Popover,clientMetrics:[{event:"show",description:"popover opened"}],id:"color-popover",cls:"color-popover",width:Ext.isIE7?160:140,data:[],header:!1,saveOnBlur:!0,initComponent:function(){this.addEvents("select"),this.tpl=Ext.DomHelper.createTemplate(this._createColorOptions()),this.callParent(arguments)},onRender:function(){this.callParent(arguments),this._initializeColors(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_initializeColors:function(){_.each(this.getEl().query(".palette-color"),function(color){var colorElement=Ext.get(color);colorElement.on("click",this._onColorClick,this);var recordDisplayColor=this.record.get("DisplayColor")?this.record.get("DisplayColor").toLowerCase():"";colorElement.getColor("background-color").toLowerCase()===recordDisplayColor&&colorElement.addCls("selected")},this)},_createColorOptions:function(){return _.map(Rally.util.Colors.DISPLAY_COLOR_PALETTE,function(color){return{tag:"div",cls:"palette-color",style:{backgroundColor:color.value}}}).concat(this._createNoColorOption())},_createNoColorOption:function(){return{tag:"div",cls:"palette-color no-color-container clear-color",children:[{tag:"div",cls:"line-color clear-color"},{tag:"div",cls:"background-color clear-color"}]}},_onColorClick:function(e){var el=Ext.get(Ext.isIE?e.target:e.currentTarget);el.addCls("selected");var selectedColor=el.hasCls("clear-color")?null:el.getColor("background-color");this.fireEvent("select",this,selectedColor),this.saveOnBlur?(this.record.set("DisplayColor",selectedColor),this.record.save({success:function(record){this.destroy(),this.publish(Rally.Message.objectUpdate,record,["DisplayColor"],this)},scope:this})):this.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.ColorPickerPlugin",{extend:Ext.AbstractPlugin,alias:"plugin.rallycolorpickerplugin",mixins:{messageable:Rally.Messageable,observable:Ext.util.Observable},init:function(grid){this.grid=grid,this.grid.mon(this.grid,"viewready",this._attachPopovers,this,{single:!0})},_attachPopovers:function(){this.mun(this.grid,"cellClick",this._onClick,this,{stopEvent:!0}),this.mon(this.grid,"cellClick",this._onClick,this,{stopEvent:!0})},_onClick:function(view,cell,colIdx,record){var cellEl=Ext.get(cell);record.get("updatable")&&this._isEditingColor(cellEl)&&this._createPopover(record,cellEl)},_createPopover:function(record,target){this.popover=Rally.ui.popover.PopoverFactory.bake({field:"Color",target:target,targetSelector:"."+target.dom.className,record:record,autoShow:!0})},_isEditingColor:function(targetEl){return targetEl.hasCls("displaycolor")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.clickhandler.ClickHandlerInterface",{shouldHandleClick:function(view,cell,colIdx,record,row,rowIdx,event){throw"unimplemented method"},onClick:function(view,cell,colIdx,record,row,rowIdx,event){throw"unimplemented method"}})}(),function(){var Ext=window.Ext4||window.Ext,getDate=function(dateString){return Ext.Date.parse(dateString,"c")||new Date(Date.parse(dateString))},formatDate=function(dateString){var date=getDate(dateString);return Rally.util.DateTime.formatWithDefault(date)},getAcceptedTpl=_.memoize(function(){return Ext.create("Ext.XTemplate","<h3>% DONE</h3>",'<div class="percentDoneLine">',"{[this.renderPercentDoneByStoryPlanEstimate(values)]}",'<div class="percentDoneText">{AcceptedLeafStoryPlanEstimateTotal} of {LeafStoryPlanEstimateTotal} Points Accepted</div>',"</div>",'<div class="percentDoneLine">',"{[this.renderPercentDoneByStoryCount(values)]}",'<div class="percentDoneText">{AcceptedLeafStoryCount} of {LeafStoryCount} User Stories Accepted</div>',"</div>",'<tpl if="UnEstimatedLeafStoryCount &gt; 0">','<div class="dangerNotification percentDoneLine">',"Missing Estimates: ",'<div><b>{UnEstimatedLeafStoryCount} User Stor{[values.UnEstimatedLeafStoryCount == 1? "y" : "ies"]}</b></div>',"</div>","</tpl>",'<tpl if="!PlannedEndDate && !ActualEndDate">','<div class="dangerNotification percentDoneLine">Missing Planned End Date</div>',"</tpl>",{
renderPercentDoneByStoryPlanEstimate:function(recordData){return Ext.create("Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate",{percentDoneName:"PercentDoneByStoryPlanEstimate",height:"15px",width:"50px",isClickable:!1}).apply(recordData)},renderPercentDoneByStoryCount:function(recordData){return Ext.create("Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate",{percentDoneName:"PercentDoneByStoryCount",height:"15px",width:"50px",isClickable:!1}).apply(recordData)}})}),getActualEndDateTpl=_.memoize(function(){return Ext.create("Ext.XTemplate","<hr/>","<h3>ACTUAL END DATE</h3>",'<div class="actualEndDateInfo percentDoneLine">',"{[this.formatDate(values.ActualEndDate)]}",'<tpl if="PlannedEndDate">'," ({[this.getEstimateMessage(values)]})","</tpl></div>",{getEstimateMessage:_.bind(function(values){var message,actualEnd=getDate(values.ActualEndDate),plannedEnd=getDate(values.PlannedEndDate),diff=Rally.util.DateTime.getDifference(plannedEnd,actualEnd,"day");return 0===diff?message="on time":diff>0?message=diff+" day"+(1===diff?"":"s")+" early":(diff=Math.abs(diff),message=diff+" day"+(1===diff?"":"s")+" late"),message},this),formatDate:formatDate})}),getNotesTpl=_.memoize(function(){return Ext.create("Ext.XTemplate","<hr/>","<h3>NOTES</h3>",'<div class="percentDoneLine">{Notes}</div>')}),getReleaseTpl=_.memoize(function(){return Ext.create("Ext.XTemplate","<hr/>","<h3>{Release.Name} ({[this.formatDate(values.Release.ReleaseStartDate)]} - {[this.formatDate(values.Release.ReleaseDate)]})</h3>",'<tpl if="this.shouldShowPlannedEndDateAlert(values)">','<tpl if="this.showUpdateText(values)">','<div class="dangerNotification percentDoneLine">{PortfolioItemTypeName} Planned End Date:',"<div>","<b>{[this.formatDate(values.PlannedEndDate)]}</b> ",'<tpl if="values.canUpdate">','<a class="update-link">Update to {[this.formatDate(values.Release.ReleaseDate)]}</a>',"</tpl>","</div>","</div>","</tpl>",'<tpl if="this.showViewText(values)">','<div class="dangerNotification percentDoneLine">{PortfolioItemTypeName} Planned Start &amp; End Dates ',"({[this.formatDate(values.PlannedStartDate)]} - {[this.formatDate(values.PlannedEndDate)]}) exist"," outside of the Release End Date.",'<tpl if="values.canUpdate">','<a class="detail-link">View</a>',"</tpl>","</div>","</tpl>","</tpl>",{formatDate:formatDate,showUpdateText:function(percentDoneData){var start=percentDoneData.PlannedStartDate;return!start||getDate(start)<=getDate(percentDoneData.Release.ReleaseDate)},showViewText:function(percentDoneData){return!this.showUpdateText(percentDoneData)},shouldShowPlannedEndDateAlert:function(percentDoneData){return percentDoneData.instance._shouldShowReleaseSection(percentDoneData)}})}),getLateChildTpl=_.memoize(function(){return Ext.create("Ext.XTemplate",'<tpl if="this.shouldShowLateChildAlert(values)">','<div class="dangerNotification percentDoneLine">Assigned to later releases or iterations:',"<div>","<b>{LateChildCount} {[this.getUserStoriesText(values.LateChildCount)]}</b> ",'<a class="late-story-view-link">View</a>',"</div>","</div>","</tpl>",{getUserStoriesText:function(lateChildCount){return lateChildCount>1?"User Stories":"User Story"},shouldShowLateChildAlert:function(percentDoneData){return percentDoneData.instance._shouldShowLateChildAlert(percentDoneData)}})});Ext.define("Rally.ui.popover.PercentDonePopover",{extend:Rally.ui.popover.Popover,mixins:[Rally.Messageable],clientMetrics:[{method:"_onClickUpdatePlannedEndDate",description:"clicked to update planned end date from "+window.location.href},{beginMethod:"_onClickUpdatePlannedEndDate",endMethod:"_onPlannedEndDateUpdated",description:"updated planned end date"}],config:{percentDoneData:{PercentDoneByStoryPlanEstimate:0,PercentDoneByStoryCount:0,ActualEndDate:void 0,PlannedStartDate:void 0,PlannedEndDate:void 0,AcceptedLeafStoryPlanEstimateTotal:0,LeafStoryPlanEstimateTotal:0,AcceptedLeafStoryCount:0,LeafStoryCount:0,UnEstimatedLeafStoryCount:0,Notes:void 0,PortfolioItemTypeOrdinal:void 0,LateChildCount:0},canUpdate:!1,legacyPage:!1,oid:null,piRef:null,percentDoneName:"PercentDoneByStoryCount",width:320,manageHeight:!1},id:"percentDonePopover",cls:"percentDonePopover",constructor:function(config){this.id+=Ext.Date.now().toString(),Ext.getElementById(this.id)||(this.initConfig(config),config.items={itemId:"percentDonePopoverContent",xtype:"component",html:this._buildContent(this.config.percentDoneData),listeners:{afterrender:function(){this._hasReleaseData(this.config.percentDoneData)?(this._setTitle(),this._attachActions(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)):this._retrievePortfolioItemType()},scope:this}},this.callParent(arguments))},updateContent:function(percentDoneData){var popoverContent=this.down("#percentDonePopoverContent");if(popoverContent){this.config.percentDoneData=Ext.applyIf(percentDoneData||{},this.config.percentDoneData);var content=this._buildContent(this.config.percentDoneData);popoverContent.update(content),this._setTitle(),this._attachActions()}},_setTitle:function(){this.setTitle(Rally.util.HealthColorCalculator.calculateHealthColorForPortfolioItemData(this.config.percentDoneData,this.getPercentDoneName()).label)},_buildContent:function(percentDoneData){var html="";return percentDoneData.instance=this,percentDoneData.canUpdate=this.config.canUpdate,html+='<div class="percentDoneContainer">',html+=getAcceptedTpl().apply(percentDoneData),Ext.isEmpty(percentDoneData.ActualEndDate)||(html+=getActualEndDateTpl().apply(percentDoneData)),this._shouldShowReleaseSection(percentDoneData)&&(html+=getReleaseTpl().apply(percentDoneData),this._shouldShowLateChildAlert(percentDoneData)&&(html+=getLateChildTpl().apply(percentDoneData))),this._shouldShowNotes(percentDoneData)&&(html+=getNotesTpl().apply(percentDoneData)),html+="</div>"},_releaseQueried:!1,_retrievePortfolioItemType:function(){Ext.create("Rally.data.wsapi.Store",{autoLoad:!0,model:Ext.identityFn("TypeDefinition"),filters:[{property:"Parent.Name",operator:"=",value:"Portfolio Item"},{property:"Ordinal",operator:"=",value:"0"}],listeners:{load:this._onPortfolioItemTypeRetrieved,scope:this}})},_onPortfolioItemTypeRetrieved:function(typeDefStore){var record=typeDefStore.getAt(0).data;this.config.percentDoneData.PortfolioItemTypeOrdinal=record.Ordinal,this.config.percentDoneData.PortfolioItemTypeName=record.Name,this._retrieveReleaseData(record.TypePath)},_retrieveReleaseData:function(typePath){var fetchFields=["Release","ReleaseDate","ReleaseStartDate","Name","PlannedStartDate","PlannedEndDate","LateChildCount"];Ext.isString(this.config.percentDoneData.Notes)||fetchFields.push("Notes"),this.store=Ext.create("Rally.data.wsapi.Store",{model:typePath,fetch:fetchFields,filters:[{property:"ObjectID",operator:"=",value:this.config.oid||Rally.util.Ref.getOidFromRef(this.config.piRef)}],autoLoad:!0,listeners:{load:this._onReleaseDataRetrieved,scope:this}})},_onReleaseDataRetrieved:function(store){var record=store.getAt(0);this._releaseQueried=!0,record?(this.config.percentDoneData.Release=record.data.Release,this.config.percentDoneData.PlannedStartDate=record.data.PlannedStartDate,this.config.percentDoneData.PlannedEndDate=record.data.PlannedEndDate,this.config.percentDoneData.LateChildCount=record.data.LateChildCount,this.config.canUpdate=record.self.getPermissionLevels(record.data._p).updatable,Ext.isString(this.config.percentDoneData.Notes)||(this.config.percentDoneData.Notes=record.data.Notes),this.updateContent({Release:record.data.Release})):this.updateContent(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_attachActions:function(){this.getEl().select("a.update-link").on("click",this._onClickUpdatePlannedEndDate,this),this.getEl().select("a.detail-link").on("click",this._onClickViewDetail,this),this.getEl().select("a.late-story-view-link").on("click",this._onClickLateStories,this)},_onClickUpdatePlannedEndDate:function(evt,el){Ext.get(el).removeAllListeners().setStyle({color:"gray",cursor:"default"}).update(el.innerHTML.replace("Update","Updating")+"...");var record=this.store.getAt(0);record.set("PlannedEndDate",record.data.Release.ReleaseDate),record.save({success:this._onPlannedEndDateUpdated,scope:this})},_onClickViewDetail:function(){var data=this.store.getAt(0);this.destroy(),window.location=Rally.nav.Manager.getDetailUrl(data)},_onClickLateStories:function(){var record=this.store.getAt(0),filters=this._filterPopover(record.data),target=this.target,targetSelector=this.targetSelector;this.destroy();var reloadStoreCallback;Rally.ui.popover.PopoverFactory.bake({target:target,targetSelector:targetSelector,record:record,field:"UserStory",autoShow:!1,title:"User Stories Assigned to Later Releases or Iteration",items:[{gridConfig:{storeConfig:{filters:filters},listeners:{viewready:function(grid){reloadStoreCallback=_.bind(this._reloadStore,this,grid),this.subscribe(Rally.Message.recordUpdateSuccess,reloadStoreCallback)},destroy:function(grid){this.unsubscribe(Rally.Message.recordUpdateSuccess,reloadStoreCallback)},scope:this}}}]}).show()},_filterPopover:function(record){return[{property:"Feature",operator:"=",value:record._ref},{property:"DirectChildrenCount",operator:"=",value:0},Rally.data.wsapi.Filter.or([{property:"Iteration.EndDate",operator:">",value:record.Release.ReleaseDate},{property:"Release.ReleaseDate",operator:">",value:record.Release.ReleaseDate}])]},_onPlannedEndDateUpdated:function(record){this.config.legacyPage&&this.publish(Rally.app.Message.legacyPageRefreshRequest),this.publish(Rally.Message.objectUpdate,record,["PlannedEndDate"],this),this.publish(Rally.Message.recordUpdateSuccess,record),this.updateContent({PlannedEndDate:record.data.PlannedEndDate})},_hasReleaseData:function(data){return this._releaseQueried||Ext.isObject(data.Release)&&Ext.isNumber(data.PortfolioItemTypeOrdinal)&&Ext.isString(data.Notes)},_shouldShowNotes:function(data){return this._hasReleaseData(data)&&!Ext.isEmpty(data.Notes)},_shouldShowReleaseSection:function(data){return this._hasReleaseData(data)&&Ext.isObject(data.Release)&&data.Release.ReleaseDate&&0===data.PortfolioItemTypeOrdinal&&data.PlannedEndDate&&getDate(data.Release.ReleaseDate.toString())<getDate(data.PlannedEndDate.toString())},_shouldShowLateChildAlert:function(data){return data.LateChildCount>0},_reloadStore:function(grid,record){var scope=this._createEditorScope(grid);scope.activeRecordPosition!==-1&&grid.editingPlugin.cancelEdit(),grid.store.reload({callback:function(){if(scope.activeRecordPosition!==-1){var newPosition=grid.store.find("_ref",scope.activeRecord.data._ref);newPosition===-1&&(newPosition=scope.activeRecordPosition),newPosition<grid.store.getCount()&&grid.editingPlugin.startEdit(grid.store.data.items[newPosition],scope.activeColumn)}}})},_createEditorScope:function(grid){var scope={};return scope.editor=grid.editingPlugin,scope.activeColumn=scope.editor.getActiveColumn(),scope.activeRecord=scope.editor.getActiveRecord(),scope.activeRecordPosition=scope.activeRecord&&scope.activeRecord.data?grid.store.find("_ref",scope.activeRecord.data._ref):-1,scope}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.clickhandler.PercentDoneClickHandler",{extend:Rally.ui.grid.plugin.clickhandler.ClickHandlerInterface,fields:[{lowerCase:"percentdonebystorycount",camelCase:"PercentDoneByStoryCount"},{lowerCase:"percentdonebystoryplanestimate",camelCase:"PercentDoneByStoryPlanEstimate"}],shouldHandleClick:function(view,cell,colIdx,record,row,rowIdx,event){var cellEl=Ext.get(cell),targetEl=Ext.get(event.target);return this._isPercentDoneCell(cellEl)&&this._isClickOnProgressBar(targetEl)},onClick:function(view,cell,colIdx,record,row,rowIdx,event){var cellEl=Ext.get(cell);this._showPopover(record,cellEl,this._getFieldName(cellEl))},_isPercentDoneCell:function(cellEl){return _(this.fields).map(function(field){return cellEl.hasCls(field.lowerCase)}).any()},_isClickOnProgressBar:function(targetEl){return targetEl.hasCls("progress-bar-container")||null!==targetEl.up(".progress-bar-container")},_showPopover:function(record,targetEl,fieldName){Ext.create("Rally.ui.popover.PercentDonePopover",{target:targetEl.down(".progress-bar-container"),targetSelector:this._getSelectorFor(record.data.FormattedID,fieldName),percentDoneData:record.data,percentDoneName:fieldName,piRef:record.data._ref})},_getFieldName:function(cellEl){var matchingFields=_.filter(this.fields,function(field){return cellEl.hasCls(field.lowerCase)});return matchingFields.length?matchingFields[0].camelCase:""},_getSelectorFor:function(formattedID,fieldName){return"."+formattedID+"-"+fieldName}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tooltip.StateToolTip",{extend:Ext.tip.ToolTip,config:{target:void 0,delegate:".schedule-state",anchor:"top",html:"",showDelay:700},cls:"state-tooltip",inheritableStatics:{DEFAULT_MOUSE_OFFSET_X:-15,DEFAULT_MOUSE_OFFSET_Y:0},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.on("beforeshow",this._onBeforeShow,this)},_onBeforeShow:function(tooltip){tooltip.mouseOffset=[this.self.DEFAULT_MOUSE_OFFSET_X,this.self.DEFAULT_MOUSE_OFFSET_Y]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.clickhandler.ScheduleStateClickHandler",{extend:Rally.ui.grid.plugin.clickhandler.ClickHandlerInterface,mixins:{messageable:Rally.Messageable,observable:Ext.util.Observable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},grid:void 0,constructor:function(config){Ext.apply(this,config),this.grid.mon(this.grid,"viewready",this._addTooltip,this,{single:!0}),this.grid.mon(this.grid,"destroy",this._destroyTooltip,this),this.callParent(arguments)},_destroyTooltip:function(){this.tooltip&&(this.tooltip.destroy(),delete this.tooltip)},shouldHandleClick:function(view,cell,colIdx,record,row,rowIdx,event){var targetEl=Ext.get(event.target),valueToUpdate=targetEl.getAttribute("state-data");return this._isStateCell(Ext.get(cell))&&this._isUpdatable(record)&&targetEl.hasCls("clickable-state")&&valueToUpdate},onClick:function(view,cell,colIdx,record,row,rowIdx,event){var cellEl=Ext.get(cell),targetEl=Ext.get(event.target),valueToUpdate=targetEl.getAttribute("state-data"),fieldToUpdate=this._getFieldToUpdate(cellEl);if(fieldToUpdate){if(record.dirty){var task=new Ext.util.DelayedTask(function(){this._setStateOnRecord(record,fieldToUpdate,valueToUpdate)},this,null,(!1));task.delay(200)}else this._setStateOnRecord(record,fieldToUpdate,valueToUpdate);return!1}},_isStateCell:function(cellEl){return cellEl.hasCls("rally-grid-cell-schedulestate")||cellEl.hasCls("rally-grid-cell-state")},_isUpdatable:function(record){return record.get("updatable")},_getFieldToUpdate:function(cellEl){return cellEl.hasCls("rally-grid-cell-schedulestate")?"ScheduleState":cellEl.hasCls("rally-grid-cell-state")?"State":void 0},_setStateOnRecord:function(record,fieldToUpdate,value){var changedFields=[fieldToUpdate,"ScheduleStatePrefix"];this.recordAction({component:this,description:"Schedule State clicked - save"}),record.set(fieldToUpdate,value),record.set("Blocked",!1),record.set("Ready",!1),changedFields=_.union(changedFields,_.keys(record.getChanges())),record.save({success:function(savedRecord){var associatedRecords;this.grid.store.isCollectionStore&&(associatedRecords=this.grid.store.record),this.publish(Rally.Message.objectUpdate,savedRecord,changedFields,this,[associatedRecords]),this.publish(Rally.Message.recordUpdateSuccess,savedRecord)},failure:function(updatedRecord,operation){this._showFailure(operation.error.errors[0])},params:{fetch:record.store.fetch},scope:this})},_showFailure:function(error){Rally.ui.notify.Notifier.showError({message:"An error occurred while saving your changes. "+error,timeout:5e3})},_addTooltip:function(){this.tooltip=Ext.create("Rally.ui.tooltip.StateToolTip",{target:this.grid.getView().getEl(),listeners:{beforeshow:function(tooltip){var triggerEl=Ext.get(tooltip.triggerElement),stateValue=triggerEl.getAttribute("state-data");triggerEl.hasCls("current-state")||!triggerEl.up(".rally-edit-cell")?tooltip.update(stateValue):tooltip.update("Move to "+stateValue)},scope:this}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.ClickHandlerPlugin",{extend:Ext.AbstractPlugin,alias:"plugin.rallyclickhandlerplugin",mixins:{messageable:Rally.Messageable,observable:Ext.util.Observable},handlers:void 0,init:function(grid){this.grid=grid,this.mon(this.grid,"viewready",this._attachClickListener,this,{single:!0}),this.handlers=[],this.handlers.push(Ext.create("Rally.ui.grid.plugin.clickhandler.PercentDoneClickHandler",{grid:grid})),grid.enableScheduleStateClickable&&this.handlers.push(Ext.create("Rally.ui.grid.plugin.clickhandler.ScheduleStateClickHandler",{grid:grid}))},_attachClickListener:function(){this.mun(this.grid,"beforecellclick",this._onClick,this,{stopEvent:!0}),this.mon(this.grid,"beforecellclick",this._onClick,this,{stopEvent:!0})},_onClick:function(view,cell,colIdx,record,row,rowIdx,event){return _(this.handlers).filter(function(handler){return handler.shouldHandleClick(view,cell,colIdx,record,row,rowIdx,event)}).map(function(handler){return handler.onClick(view,cell,colIdx,record,row,rowIdx,event)}).every()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.DataStoreCreateable",{mixins:[Rally.app.Scopeable],storeConfig:{},store:null,model:[],models:null,storeBuilderType:"Rally.data.DataStoreBuilder",constructor:function(config){Ext.apply(this,config)},buildStore:function(config,forceCreate){return _.isEmpty(this.store)||forceCreate?(config=_.assign(_.assign({context:this.getDataContext()},this.storeConfig),config),Ext.isEmpty(config.model)&&!Ext.isEmpty(this.model)&&(config.model=this.model),Ext.isEmpty(config.models)&&!Ext.isEmpty(this.models)&&(config.models=this.models),config.requester=this,Ext.create(this.storeBuilderType).build(config)):Deft.Promise.when(this.store)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.filter.StoreFilterable",{filter:function(filter,clearFilterKeys,ignoreDefaultFilters){this.filterCollection||(this.filterCollection=Ext.create("Rally.data.filter.FilterCollection"),this.store.filters&&this.filterCollection.addPermanentFilter(this.store.filters.getRange())),clearFilterKeys===!0?this.filterCollection.clearTempFilters():clearFilterKeys&&this.filterCollection.removeTempFilterByKey(clearFilterKeys),ignoreDefaultFilters===!0&&this.filterCollection.clearAllFilters(),filter&&this.filterCollection.addTempFilter(filter);var filters=this.filterCollection.toArray();filters.length>0?(this.store.clearFilter(!0),this.store.filter(filters)):this.store.clearFilter(),this.fireEvent("filterchange",this,this.filterCollection.toArray())},clearTemporaryFilters:function(){this.filter(null,!0)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.Grid",{extend:Ext.grid.Panel,alias:"widget.rallygrid",cls:"rally-grid",mixins:{messageable:Rally.Messageable,dataStoreCreateable:Rally.data.DataStoreCreateable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable,stateful:Ext.state.Stateful,scopeable:Rally.app.Scopeable,filterable:Rally.data.filter.StoreFilterable},clientMetrics:[{endEvent:"viewready",description:"initial load"},{event:"filterchange",description:"filter changed"},{beginEvent:"filterchange",endEvent:"load",description:"grid reload due to filter"},{event:"select",description:"row(s) selected"},{event:"deselect",description:"row(s) deselected"},{beginMethod:"refresh",endEvent:"load",description:"grid refreshed"}],statics:{DEFAULT_PAGE_SIZE:25},config:{enableRanking:!1,defaultSortToRank:!1,listenForObjectUpdates:!0,enableEditing:!0,editingConfig:{publishMessages:!0},enableValidationUi:!0,enableBulkEdit:!1,bulkEditConfig:{},enableBlockedReasonPopover:!0,enableScheduleStateClickable:!0,autoAddAllModelFieldsAsColumns:!1,showRowActionsColumn:!0,rowActionColumnConfig:null,columnCfgs:[],showPagingToolbar:!0,pagingToolbarCfg:{},storeConfig:{pageSize:25,remoteFilter:!0,remoteSort:!0},disableColumnMenus:!0,selType:"rallyrowmodel",viewConfig:{plugins:[]},context:void 0,onBeforeRecordMenuCopy:Ext.emptyFn,onRecordMenuCopy:Ext.emptyFn,onBeforeRecordMenuDelete:Ext.emptyFn,onRecordMenuDelete:Ext.emptyFn,onBeforeRecordMenuRankHighest:Ext.emptyFn,onBeforeRecordMenuRankLowest:Ext.emptyFn,onRecordMenuRemove:Ext.emptyFn,disableEditorForColumns:[]},border:0,bodyBorder:0,viewType:"rallygridview",plugins:[],stateful:!1,constructor:function(config){this.mergeConfig(config),this.dockedItems=[],this.stateful&&!this.stateId&&(this.stateId=this.getAppContextOrEnvironmentContext().getScopedStateId("grid")),this.plugins=this._setupPlugins(config),this.callParent(arguments)},initComponent:function(){this.initState(),this.addEvents("load","write","beforerecorddestroy","deleterequestcompleted","dataloadexception","filterchange","columnshow"),this.showPagingToolbar&&this.dockedItems.push(Ext.apply({itemId:"pagingToolbar",xtype:"rallypagingtoolbar",dock:"bottom"},this.pagingToolbarCfg)),this.enableBulkEdit&&(this.selType="rallycheckboxmodel",this.selModel={injectCheckbox:this.enableRanking?1:0}),this.store?_.isFunction(this.store.model)?this._configureWithStore(this.store):(this.columns=[],this.store.hydrateModel().then({success:function(){this._onStoreBuilt(this.store)},scope:this})):(this.columns=[],this._buildStoreAndConfigureColumns()),this.on("sortchange",this._persistSorterForStoreRebuild,this),this.on("afterrender",this._onAfterRender,this,{single:!0}),this.callParent(arguments)},getState:function(){var state={},statefulColumns=_.filter(this.columns,this._isStatefulColumn);return state.columns=_.map(statefulColumns,function(column){var initialConfig=column.initialConfig;return{xtype:initialConfig.xtype,dataIndex:initialConfig.dataIndex,text:initialConfig.text,sortable:initialConfig.sortable,flex:column.getSizeModel().width===Ext.layout.SizeModel.configured?null:initialConfig.flex,width:column.getWidth()}},this),state.sorters=_.map(this.getStore().sorters.getRange(),function(sorter){return{property:sorter.property,direction:sorter.direction}}),state},applyState:function(state){state&&(state.columns&&(this.columnCfgs=state.columns),state.sorters&&(this.storeConfig.sorters=_.map(state.sorters,function(sorterState){return Ext.create("Ext.util.Sorter",{property:sorterState.property,direction:sorterState.direction})})))},getFetch:function(){return this.store&&this.store.fetch||[]},refresh:function(options){return this.getStore().load(options)},refreshAfterBulkAction:function(){return this.refresh()},reconfigure:function(newStore,columns){this.callParent(arguments),this._setupStoreHandlers();var pagingToolbar=this.down("#pagingToolbar");pagingToolbar&&pagingToolbar.bindStore(newStore),Ext.isDefined(columns)&&(this.columns=columns)},reconfigureWithModel:function(model){this._saveFilters(this.store),this.store=null,this.model=model,this._buildStoreAndConfigureColumns(),this._applyFilters(this.getStore())},reconfigureWithColumns:function(columnCfgs){this.columnCfgs=columnCfgs,this.reconfigureWithModel(this.model)},buildColumns:function(models){return Ext.create("Rally.ui.grid.ColumnBuilder").withContext(this.getContext()).withEditingEnabled(this.enableEditing).withRankingEnabled(this.enableRanking).withDefaultColumns(this.columnCfgs).withSortableColumns(this.sortableColumns).shouldAutoAddAllModelFieldsAsColumns(this.autoAddAllModelFieldsAsColumns).shouldShowRowActionsColumn(this.showRowActionsColumn&&this.rowActionColumnConfig||this.showRowActionsColumn).withDisableColumnMenus(this.disableColumnMenus).withEditorsDisabledForColumns(this._getDisabledEditorColumns(models)).build(models)},insertRecordIfShould:function(newRecord){this.refresh()},updateExistingRecord:function(changedRecord,changedFields){this._requiresRefresh(changedRecord,changedFields)?this.refresh({clearOnLoad:!0}):this.updateAssociatedRecords([changedRecord])},updateAssociatedRecords:function(existingRecords){this.store.refreshRecords&&this.store.refreshRecords(existingRecords).then({success:function(){_.each(existingRecords,this.highlightRowForRecord,this),this.publish(Rally.Message.gridLoaded)},scope:this})},_getDisabledEditorColumns:function(models){var columns=this.enableBlockedReasonPopover?["Blocked","DisplayColor"]:["DisplayColor"];return columns=_.union(this.disableEditorForColumns,columns)},_requiresRefresh:function(changedObject,fieldNames){return this._orderedFieldWasChanged(fieldNames)&&this._hasChangedObject(changedObject)&&changedObject._dragAndDropped!==!0},_orderedFieldWasChanged:function(fieldNames){return Rally.data.Ranker.isStoreSortedByRankAsc(this.store)&&_.contains(fieldNames,Rally.data.Ranker.getRankField(this.store.model))||_.any(this.store.sorters.getRange(),function(sorter){return!_.isEmpty(sorter.property)&&_.contains(fieldNames,sorter.property)})},_hasChangedObject:function(changedObject){return null!==this.store.getById(changedObject.getId())},_isStatefulColumn:function(column){return!Ext.isEmpty(column.dataIndex)},_setupStoreHandlers:function(){var store=this.getStore();this.mon(store.getProxy(),"exception",function(proxy,response,operation,options){this.fireEvent("dataLoadException",this,operation,response)},this),this.mon(store,"write",this._onWriteRecordDelete,this),this.relayEvents(store,["beforeload","load","write"])},getAllFetchFields:function(){return this.store.fetch},getModels:function(){return[this.store.model]},realignEditor:function(){if(this.editingPlugin){var editor=Ext.isFunction(this.editingPlugin.getActiveEditor)&&this.editingPlugin.getActiveEditor();editor&&editor.realign(!0)}},highlightRowForRecord:function(record){var row=this.getView().getNode(this.store.find("ObjectID",record.get("ObjectID")));row&&Rally.util.Animation.highlight(Ext.fly(row).select("td"))},getMoveToPositionStore:function(options){var storeConfig=Ext.merge(options&&options.storeConfig||{},{model:this.store.model,proxy:this.store.getProxy()}),positionStore=Ext.create(this.store.$className,storeConfig);return Deft.Promise.when(positionStore)},findRankedRecord:function(options){return Rally.data.Ranker.loadExtremeRankedRecord(this.store,{last:!options.highest,metricsCmp:options.requester,storeConfig:options.storeConfig}).then(function(record){return record&&Ext.callback(options.success,options.scope,[record]),record})},shouldRecordBeRankable:function(record){return this.store.indexOf(record)>-1&&this.store.getTotalCount()>1},shouldRecordBeExtremeRankable:function(record){return this.enableRanking&&this.store.indexOf(record)>-1},getRecord:function(x){return this.view.getRecord(x)},_buildFetch:function(){var fetch=["ObjectID","Project","Workspace"],fetchConfig=this.storeConfig.fetch;return Ext.isEmpty(fetchConfig)||(Ext.isString(fetchConfig)&&(fetchConfig=fetchConfig.split(",")),fetch=fetch.concat(fetchConfig)),Ext.each(this.columns,function(column){Ext.isString(column)?fetch.push(column):column.dataIndex?fetch.push(column.dataIndex):column.modelField&&fetch.push(column.modelField.name);var columnClass=column.self||Ext.ClassManager.getByAlias("widget."+column.xtype);columnClass&&Ext.isFunction(columnClass.getRequiredFetchFields)&&(fetch=fetch.concat(columnClass.getRequiredFetchFields(this)))},this),Rally.data.wsapi.FieldFetchMapper.getFetchFields(_.union(this.store.fetch||[],fetch))},_buildStoreAndConfigureColumns:function(config){Ext.merge(this.config.storeConfig,this.storeConfig,config);var storeConfig=this._overrideAutoLoadOnStoreConfig(this.config.storeConfig);this.getContext()&&!storeConfig.context&&(storeConfig.context=this.getContext().getDataContext()),this.buildStore(storeConfig).then({success:this._onStoreBuilt,scope:this})},_overrideAutoLoadOnStoreConfig:function(storeConfig){var storeConfigCopy=Ext.merge({},storeConfig);return storeConfigCopy.autoLoad=!1,storeConfigCopy},_onWriteRecordDelete:function(store,operation,eOpts){"destroy"===operation.action&&(this.fireEvent("deleteRequestCompleted",this,operation.getRecords(),operation),this.refresh())},_addDefaultSorterIfNeeded:function(store){if(store.sorters.getCount()>0)return store;var defaultSorterConfig;if(this.defaultSortToRank&&Rally.data.Ranker.isRankable(store.model)){var rankField=Rally.data.Ranker.getRankField(store.model);defaultSorterConfig=Rally.data.util.Sorter.sorters(rankField+" ASC").pop()}else defaultSorterConfig=Rally.data.util.Sorter.getDefaultSort(store.model.typePath,{asSorter:!0}).pop();return defaultSorterConfig&&store.sorters.add(Ext.create("Ext.util.Sorter",defaultSorterConfig)),store},_configureWithStore:function(store){var columns=this.buildColumns(store.model);this.rendered?this.reconfigure(store,columns):(this.store=store,this.columns=columns,this._setStoreInPagerConfig(store),this._setupStoreHandlers())},_onStoreBuilt:function(store){if(this.view){var emptyText=this.getView().emptyText;this.getView().emptyText="",store.on("beforeload",function(){this.getView().emptyText=emptyText},this,{single:!0})}this._addDefaultSorterIfNeeded(store),this._configureWithStore(store),this._applyFilters(store),store.fetch=this._buildFetch(),this.storeConfig.hasOwnProperty("autoLoad")&&!this.storeConfig.autoLoad||Ext.defer(store.load,10,store,["object"==typeof this.storeConfig.autoLoad?this.storeConfig.autoLoad:void 0]),this.storeConfig.autoLoad=!0},_setStoreInPagerConfig:function(store){if(this.dockedItems){var dockedItems=this.dockedItems.isMixedCollection?this.dockedItems.getRange():this.dockedItems,pagerConfig=_.find(dockedItems,{itemId:"pagingToolbar"});pagerConfig&&(pagerConfig.store=store)}},_applyFilters:function(store){if(this.filterCollection){var newStoreFilters=Ext.create("Ext.util.MixedCollection");newStoreFilters.addAll(this.filterCollection.toArray()),store.filters=newStoreFilters}},_saveFilters:function(store){this.filterCollection||store.filters&&store.filters.getCount()>0&&(this.filterCollection=Ext.create("Rally.data.filter.FilterCollection"),_.each(store.filters.getRange(),function(f){f.itemId=f.toString()}),this.filterCollection.addPermanentFilter(store.filters.getRange()))},_persistSorterForStoreRebuild:function(){this.storeConfig.sorters=this.getStore().sorters.getRange()},_setupPlugins:function(config){var plugins=config.plugins||[];return this.listenForObjectUpdates&&plugins.push({ptype:"rallyobjectupdatelistener"}),plugins.push({ptype:"rallycolorpickerplugin"}),this.enableEditing&&(plugins.push(Ext.apply({ptype:"rallycellediting",messageBus:this._getMessageBus()},config.editingConfig)),this.enableValidationUi&&(plugins.push({ptype:"rallygridvalidation"}),plugins.push({ptype:"rallycellvalidationui"}))),this.enableBlockedReasonPopover&&plugins.push({ptype:"rallyblockedreasonpopoverplugin"}),plugins.push({ptype:"rallyclickhandlerplugin"}),this.enableRanking&&(config.viewConfig=config.viewConfig||{},config.viewConfig.plugins=config.viewConfig.plugins||[],config.viewConfig.plugins.push({ptype:"rallydragdrop"})),_.uniq(plugins,"ptype")},_onAfterRender:function(){this.relayEvents(this.headerCt,["columnshow"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.selection.CheckboxModel",{extend:Ext.selection.CheckboxModel,alias:"widget.rallycheckboxmodel",constructor:function(config){this.callParent(arguments),this.showHeaderCheckbox="SINGLE"!==this.mode},renderer:function(value,metaData,record,rowIndex,colIndex,store,view){return"SINGLE"===this.mode?'<div class="'+Ext.baseCSSPrefix+'grid-row-single-checker">&#160;</div>':this.callParent(arguments)},doSingleSelect:function(record){this.isRowSelectable(record)&&this.callParent(arguments)},doMultiSelect:function(records){records=_.filter(Ext.isArray(records)?records:[records],this.isRowSelectable,this),records.length&&this.callParent([records].concat(_.rest(arguments)))},isRowSelectable:function(record){return!0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.ArtifactChooserDialog",{
extend:Rally.ui.dialog.Dialog,alias:"widget.rallyartifactchooserdialog",alternateClassName:["Rally.ui.dialog.SolrArtifactChooserDialog"],clientMetrics:[{method:"_search",description:"chooser search performed"},{event:"artifactchosen",description:"artifact chosen"}],height:400,width:600,layout:"fit",closable:!0,draggable:!0,config:{title:"Choose an Artifact",artifactTypes:[],multiple:!1,storeConfig:{context:{project:null},sorters:[{property:"FormattedID",direction:"DESC"}]},columns:[{text:"ID",dataIndex:"FormattedID",renderer:_.identity},"Name"],selectionButtonText:"Done",gridConfig:{},selectedRef:void 0,selectedRecords:void 0,initialSelectedRecords:void 0,showRadioButtons:!0},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},selectionCache:[],initComponent:function(){this.callParent(arguments),this.addEvents("artifactchosen"),this.addCls(["chooserDialog","chooser-dialog"])},destroy:function(){this._destroyTooltip(),this.callParent(arguments)},beforeRender:function(){this.callParent(arguments),this.addDocked({xtype:"toolbar",dock:"bottom",padding:"0 0 10 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",cls:"primary rly-small",disabled:!0,handler:function(){this.fireEvent("artifactchosen",this,this.getSelectedRecords()),this.onArtifactChosen()},itemId:"doneButton",scope:this,text:this.selectionButtonText,userAction:"clicked done in dialog"},{xtype:"rallybutton",text:"Cancel",cls:"secondary rly-small",handler:this.close,scope:this,ui:"link"}]}),this.introText&&this.addDocked({xtype:"component",componentCls:"intro-panel",html:this.introText}),this.addDocked({xtype:"toolbar",itemId:"searchBar",dock:"top",border:!1,padding:"0 0 10px 0",items:this.getSearchBarItems()}),this.buildGrid(),this.selectionCache=this.getInitialSelectedRecords()||[]},getSelectedRecords:function(){return this.multiple?this.selectionCache:this.selectionCache[0]},getGridModels:function(){return this.artifactTypes},getSearchBarItems:function(){return[{xtype:"triggerfield",cls:"rui-triggerfield chooser-search-terms",emptyText:"Search Keyword or ID",enableKeyEvents:!0,flex:1,itemId:"searchTerms",listeners:{keyup:function(textField,event){event.getKey()===Ext.EventObject.ENTER&&this._search()},afterrender:function(field){field.focus()},scope:this},triggerBaseCls:"icon-search chooser-search-icon"}]},getStoreFilters:function(){return[]},buildGrid:function(){this.grid&&this.grid.destroy();var me=this,selectionConfig={mode:this.multiple?"SIMPLE":"SINGLE",allowDeselect:!0};this.grid=Ext.create("Rally.ui.grid.Grid",Ext.Object.merge({autoAddAllModelFieldsAsColumns:!1,columnCfgs:this.columns,enableEditing:!1,enableColumnHide:!1,enableColumnMove:!1,model:this.getGridModels(),selModel:this.showRadioButtons||this.multiple?Ext.create("Rally.ui.selection.CheckboxModel",Ext.apply(selectionConfig,{enableKeyNav:!1,isRowSelectable:function(record){return me._isArtifactEditable(record)}})):Ext.create("Ext.selection.RowModel",selectionConfig),showRowActionsColumn:!1,storeConfig:this._getStoreConfig(),viewConfig:{emptyText:Rally.ui.EmptyTextFactory.get("defaultText"),publishLoadMessages:!1,getRowClass:function(record){return Rally.util.Test.toBrowserTestCssClass("row",record.getId())+(me._isArtifactEditable(record)?"":" disabled-row")}}},this.config.gridConfig)),this.mon(this.grid,{beforeselect:this._onGridSelect,beforedeselect:this._onGridDeselect,load:this._onGridLoad,scope:this}),this.add(this.grid),this._onGridReady()},onArtifactChosen:function(){this.close()},_addTooltip:function(){this._destroyTooltip(),this.tooltip=Ext.create("Rally.ui.tooltip.ToolTip",{target:this.grid.getEl(),html:"You don't have permission to edit this item.",delegate:".disabled-row",anchor:"top",showDelay:0,showOnClick:!0})},_destroyTooltip:function(){this.tooltip&&this.tooltip.destroy()},_getStoreConfig:function(){var storeConfig=_.cloneDeep(this.getInitialConfig().storeConfig);return this._getSearchTerms()&&(storeConfig.search=this._getSearchTerms()),storeConfig.filters=(storeConfig.filters||[]).concat(this.getStoreFilters()),storeConfig},_enableDoneButton:function(){this.down("#doneButton").setDisabled(!this.selectionCache.length)},_findRecordInSelectionCache:function(record){return _.findIndex(this.selectionCache,function(cachedRecord){return cachedRecord.get("_ref")===record.get("_ref")})},_onGridSelect:function(selectionModel,record){if(this._isArtifactEditable(record)){var index=this._findRecordInSelectionCache(record);index===-1&&(this.multiple||(this.selectionCache=[]),this.selectionCache.push(record)),this._enableDoneButton()}},_onGridDeselect:function(selectionModel,record){var index=this._findRecordInSelectionCache(record);index!==-1&&this.selectionCache.splice(index,1),this._enableDoneButton()},_onGridReady:function(){return this.grid.rendered?this.grid.getStore().isLoading()?void this.mon(this.grid,"load",this._onGridReady,this,{single:!0}):(this._onGridLoad(),void this.center()):void this.mon(this.grid,"afterrender",this._onGridReady,this,{single:!0})},_isArtifactEditable:function(record){return Rally.environment.getContext().getPermissions().isProjectEditor(record.get("Project"))},_onGridLoad:function(){var defaultSelection=Ext.Array.from(this.selectedRef||this.selectedRecords);if(defaultSelection.length){var selectedRecords=_.compact(_.map(defaultSelection,function(ref){var recordIndex=this.grid.getStore().find("_ref",ref);return recordIndex>=0?this.grid.getStore().getAt(recordIndex):null},this));selectedRecords.length&&this.grid.getSelectionModel().select(selectedRecords)}else{var store=this.grid.store,records=[];_.each(this.selectionCache,function(record){var recordIndex=store.find("_ref",record.get("_ref"));if(recordIndex!==-1){var storeRecord=store.getAt(recordIndex);records.push(storeRecord)}}),records.length&&this.grid.getSelectionModel().select(records)}this._addTooltip(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_search:function(){var terms=this._getSearchTerms(),store=this.grid.getStore();terms?store.search=terms:delete store.search,store.loadPage(1)},_getSearchTerms:function(){var textBox=this.down("#searchTerms");return textBox&&textBox.getValue()}})}(),function(){var Ext=window.Ext4||window.Ext,maxAddBatchSize=25;Ext.define("Rally.ui.dialog.CopyTasksFromChooserDialogViewController",{extend:Rally.ui.ViewController,clientMetrics:{method:"_onCopyTasksFromClicked",description:"copy tasks from menu item clicked"},mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},observe:{view:{artifactchosen:"_onArtifactChosen"}},init:function(){if(this.callParent(arguments),this.view.getRecord())this.targetRef=this.view.getRecord().getRef().getRelativeUri();else{var artifactType=this.view.getTargetType(),targetOid=this.view.getTargetOid();this.targetRef=Rally.util.Ref.getRefFromTypeAndOid(artifactType,targetOid)}},_onArtifactChosen:function(dialog,selectedRecord){selectedRecord&&this._createTaskStoreForSelectedRecord(selectedRecord.getRef().getRelativeUri())},_createTaskStoreForSelectedRecord:function(sourceRef){Ext.create("Rally.data.wsapi.Store",{autoLoad:!0,fetch:!0,model:Ext.identityFn("Task"),context:{project:null},filters:{property:"WorkProduct",value:sourceRef,operator:"="},listeners:{load:this._onTaskLoad,scope:this}})},_onTaskLoad:function(store,copyFromTasks){var copyToRecord,me=this;this._ensureRecord().then(function(record){return copyToRecord=record,me._getCopyToTasksStore(copyToRecord)}).then(function(copyToTasksStore){var copiedTasks=me._copyTasks(copyFromTasks,copyToTasksStore.getTotalCount());me._persistCopiedTasks(copiedTasks,copyToTasksStore,copyToRecord,copiedTasks)})},_ensureRecord:function(){var record=this.view.getRecord(),deferred=new Deft.Deferred;return record?deferred.resolve(record):this.view.grid.store.model.load(this.view.getTargetOid(),{success:function(record){deferred.resolve(record)},failure:function(record,operation){Rally.data.util.Record.showWsapiErrorNotification(record,operation),deferred.reject(Rally.data.util.Record.getWsapiOperationErrorMessage(operation))},scope:this}),deferred.promise},_getCopyToTasksStore:function(record){var tasksStore=record.getCollection("Tasks",{pageSize:1});return tasksStore.load().then(function(){return tasksStore})},_copyTasks:function(copyFromTasks,numberOfTasksInCopyToArtifact){return _.map(copyFromTasks,function(record){var copiedTask=Rally.data.util.Record.copyRecord(record);return copiedTask.set("WorkProduct",this.targetRef),copiedTask.set("TaskIndex",record.get("TaskIndex")+numberOfTasksInCopyToArtifact),copiedTask.set("Tags",_.map(record.get("Tags")._tagsNameArray,function(tag){return{_ref:tag._ref}})),copiedTask},this)},_persistCopiedTasks:function(copiedTasks,tasksStore,copyToRecord,allTasks){var batch=_.first(copiedTasks,maxAddBatchSize),remaining=_.rest(copiedTasks,maxAddBatchSize);tasksStore.add(batch),tasksStore.sync({success:function(){_.isEmpty(remaining)?this._refreshView(allTasks):this._persistCopiedTasks(remaining,tasksStore,copyToRecord,allTasks)},failure:function(batch,options){Rally.data.util.Record.showWsapiErrorNotification(copyToRecord,batch.operations[0])},scope:this})},_refreshView:function(copiedTasks){var alm="alm";if(Rally[alm]&&this.view.getTargetType()){var currentToken=Rally[alm].navigation.NavigationStore.getToken();Rally[alm].navigation.NavigationActionCreators.setToken(currentToken,!0)}else this._publishUpdate(copiedTasks)},_publishUpdate:function(copiedTasks){var copyToRecord=this.view.getRecord().copy(),collection=copyToRecord.get("Tasks");collection&&_.isFunction(copyToRecord.updateCollectionCount)&&copyToRecord.updateCollectionCount("Tasks",collection.Count+copiedTasks.length),Rally.environment.getMessageBus().publish(Rally.Message.objectUpdate,copyToRecord,["Tasks"],this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.CopyTasksFromChooserDialog",{extend:Rally.ui.dialog.ArtifactChooserDialog,alias:"widget.rallycopytasksfromchooserdialog",mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},controller:"Rally.ui.dialog.CopyTasksFromChooserDialogViewController",config:{record:void 0,targetOid:void 0,targetType:void 0,targetDisplayName:void 0,title:void 0,columns:[{text:"ID",dataIndex:"FormattedID",renderer:_.identity},"Name","Project",{dataIndex:"Tasks",renderer:function(value){return value.Count}}]},constructor:function(config){if(config=config||{},config.record?config.artifactTypes=[config.record.getRef().getType()]:config.artifactTypes=[config.targetType],!config.title){var chooseString="Choose an item to copy tasks from...";config.title=(config.targetDisplayName?config.targetDisplayName+": ":"")+chooseString}_.isString(config.targetOid)&&(config.targetOid=parseInt(config.targetOid,10)),config.storeConfig=Ext.merge({sorters:[{property:"FormattedID",direction:"DESC"}],filters:[{property:"Tasks.ObjectID",value:null,operator:"!="},{property:"ObjectID",value:config.targetOid||config.record.getId(),operator:"!="}]},config.storeConfig),this.callParent([config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.CopyTasksFromMenuItemViewController",{extend:Rally.ui.ViewController,mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},observe:{view:{click:"_onCopyTasksFromClicked"}},_onCopyTasksFromClicked:function(){window.detail&&(window.detail.refreshContent=!1),Ext.create("Rally.ui.dialog.CopyTasksFromChooserDialog",this._getChooserConfig())},_getChooserConfig:function(){var record=this.view.getRecord(),workspace=record.get("Workspace");return workspace=workspace?Rally.util.Ref.getRelativeUri(workspace):record.store&&record.store.context&&record.store.context.workspace?record.store.context.workspace:Rally.environment.getContext().getWorkspace()._ref,{autoShow:!0,record:record,targetDisplayName:record.get("FormattedID")||record.get("_refObjectName"),storeConfig:{context:{workspace:workspace}}}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.CopyTasksFromMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemcopytasksfrom",controller:"Rally.ui.menu.item.CopyTasksFromMenuItemViewController",config:{text:"Copy Tasks From...",cls:"artifact-icon icon-copy-from"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveTasks]),this.initConfig(config),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.DeletionConfirmationHelper",{singleton:!0,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},confirmUserStoryDeletionIfThereAreChildren:function(options){this.recordLoadBegin({description:"Checking if record has children",miscData:{id:options.record.getId()}});var dataStore=Ext.create("Rally.data.wsapi.Store",{model:Ext.identityFn("HierarchicalRequirement"),autoLoad:!1,fetch:["DirectChildrenCount","FormattedID"],filters:[{property:"ObjectID",value:options.record.getId()}],requester:this});dataStore.load({callback:function(records,operation,successful){this.recordLoadEnd(),this._processWsapiResponse(records,operation,successful,options)},scope:this})},getStoryHasChildrenMessage:function(record){return"Are you sure you want to delete "+record.get("FormattedID")+" and its children?"},_processWsapiResponse:function(records,operation,successful,options){if(successful||Ext.callback(options.failure,options.scope,[options.record,operation]),Ext.isEmpty(records))return Ext.callback(options.success,options.scope);var msg=options.confirmMessageWhenNoChildren,record=records[0];return record.get("DirectChildrenCount")>0&&(msg=this.getStoryHasChildrenMessage(record)),msg?this._displayConfirmation(msg,options):void Ext.callback(options.success,options.scope)},_displayConfirmation:function(msg,options){return Ext.create("Rally.ui.dialog.ConfirmDialog",{title:"Are you sure?",message:msg,confirmLabel:"Delete",listeners:{confirm:function(){Ext.callback(options.success,options.scope)}}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.DeleteMenuItem",{alias:"widget.rallyrecordmenuitemdelete",extend:Rally.ui.menu.item.RecordMenuItem,mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},config:{text:"Delete",handler:function(){this._onDeleteClicked()},beforeAction:null,afterAction:null,actionScope:null,showConfirmation:!0},constructor:function(config){config.predicate=config.predicate||function(record){return record.get("deletable")&&!_.contains(record.self.typePath,"attributedefinition")&&this._enabledForModelType(record)},this.initConfig(config),this.callParent([config])},_enabledForModelType:function(record){switch(record.get("_type")){case"recyclebinentry":return Rally.environment.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin();case"milestone":return!Rally.ui.MilestoneTargetProjectPermissionsHelper.shouldDisableEditing(record);default:return!0}},_onDeleteClicked:function(){Ext.isFunction(this.beforeAction)&&this.beforeAction.call(this.actionScope||window,this.record)===!1||("hierarchicalrequirement"===this.record.get("_type")?Rally.data.util.DeletionConfirmationHelper.confirmUserStoryDeletionIfThereAreChildren({success:this._deleteRecord,failure:this._onFailure,scope:this,record:this.record}):this.record.self.isRecyclable()||"recyclebinentry"===this.record.self.typePath||!this.showConfirmation?this._deleteRecord():Ext.create("Rally.ui.dialog.DeleteConfirmDialog",Ext.apply({listeners:{confirm:this._deleteRecord,scope:this},record:this.record},this.config.deleteConfirmConfig)))},_deleteRecord:function(){this.recordLoadBegin({description:"Deleting record",miscData:{id:this.record.getId()}});var associatedRecords=_.compact([this.record.parentNode]);this.record.store&&this.record.store.isCollectionStore&&associatedRecords.push(this.record.store.record),this.record.destroy({success:function(record,operation){Rally.ui.notify.Notifier.showDelete(this.record,null,this.actionScope),Ext.callback(this.afterAction,this.actionScope,[this.record,operation])},failure:this._onFailure,callback:function(record,operation){(operation.wasSuccessful()||Rally.data.util.Record.isObjectDoesNotExistWsapiError(operation))&&this.publish(Rally.Message.objectDestroy,this.record,this,associatedRecords),this.recordLoadEnd()},scope:this,requester:this})},_onFailure:function(record,operation){Rally.data.util.Record.showWsapiErrorNotification(this.record,operation),Ext.callback(this.afterAction,this.actionScope,[this.record,operation])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.EditModeContext",{singleton:!0,config:{defaultDetailPageToViewingMode:!1},VIEW_MODE:"view_mode",EDIT_MODE:"edit_mode",_isTemporaryViewMode:function(){return this.VIEW_MODE===this.getTemporaryEditMode().mode},_isTemporaryEditMode:function(){return this.EDIT_MODE===this.getTemporaryEditMode().mode},getTemporaryEditMode:function(){var storage=Rally.state.SessionStorage.getInstance();return storage.get("detailPage.editMode")?storage.get("detailPage.editMode"):{}},clearTemporaryEditMode:function(){var storage=Rally.state.SessionStorage.getInstance();storage.clear("detailPage.editMode")},setTemporaryEditMode:function(record,editable){var mode=editable?this.EDIT_MODE:this.VIEW_MODE,storage=Rally.state.SessionStorage.getInstance();storage.set("detailPage.editMode",{uuid:record.get("_refObjectUUID"),oid:record.get("ObjectID"),mode:mode})},isPageEditable:function(record){return!Rally.data.util.Record.isReadOnly(record)&&(!!record.phantom||(!!this._isTemporaryEditMode()||!this._isTemporaryViewMode()&&!this.getDefaultDetailPageToViewingMode()))},loadDefaultDetailPageToViewingModePreference:function(){var preferencePromise=Rally.data.ModelFactory.getModel({type:"UserProfile"}).then({success:function(model){var userProfileId=Rally.environment.getContext().getUser().UserProfile.ObjectID;return model.load(userProfileId).then({success:function(record){return this.setDefaultDetailPageToViewingMode(record.get("DefaultDetailPageToViewingMode")),this.getDefaultDetailPageToViewingMode()},scope:this})},scope:this});return preferencePromise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.DetailHelper",{alias:"widget.rallydetailhelper",mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},singleton:!0,features:{},hasEDP:function(record){return record.isUserStory()||record.isDefect()||record.isTask()||record.isPortfolioItem()||record.isMilestone()},projectScopeChanged:function(record){var recordProject=record.get("Project"),recordProjectRef=Rally.util.Ref.getRelativeUri(recordProject);if(recordProjectRef){var modelContext=record.self.context;return!modelContext||Rally.util.Ref.getRelativeUri(modelContext.project)!==recordProjectRef}return!1},syncModelProject:function(record,onSuccess,scope){var recordProject=record.get("Project");Rally.data.ModelFactory.getModel({context:{project:"string"==typeof recordProject?recordProject:recordProject._ref},type:record.self.typeName,success:function(model){record.self=model,_.isFunction(onSuccess)&&onSuccess.call(this,record)},scope:scope})},updateRecord:function(record,field){this.getController().updateRecordFromField(record,field)},isFieldEmpty:function(field){return _.isFunction(field.isEmpty)?field.isEmpty():Ext.isEmpty(field.getValue())},getCountOfEmptyRequiredFieldEditors:function(){return Ext.dom.Query.select(".requiredField.empty").length},getCountOfUnsetRequiredFields:function(record){var count=0;return _.forEach(record.self.getFields(),function(field){this.isUnsetRequiredField(field,record)&&count++},this),count},isUnsetRequiredField:function(field,record){var fieldRequired=this.isDetailPageFieldRequired(field,record),fieldIsUnset=this.isUnsetField(record,field),hasDefaultValue=this.isFieldWithDefaultValue(field);return fieldRequired&&fieldIsUnset&&!hasDefaultValue},isUnsetField:function(record,field){return""===record.get(field.name)},isFieldWithDefaultValue:function(field){return field.editor&&_.contains(["rallycombobox","rallyfieldvaluecombobox"],field.editor.xtype)},isFieldRequired:function(field,record){return this.isFieldEditable(field,record)&&field.required},isFieldEditable:function(recordField,record){return(!Rally.data.util.Record.isParent(record)||!recordField||"Iteration"!==recordField.name&&"Release"!==recordField.name&&"PlanEstimate"!==recordField.name)&&(recordField&&_.isFunction(recordField.isMultiValueCustom)&&recordField.isMultiValueCustom()?this.isRecordEditable(record)&&(record.get("updatable")||record.phantom):this.isRecordEditable(record)&&recordField&&!recordField.readOnly&&(record.get("updatable")||record.phantom))},isDetailPageFieldEditable:function(recordField,record){return this.isFieldEditable(recordField,record)&&Rally.ui.detail.EditModeContext.isPageEditable(record)},isDetailPageFieldRequired:function(field,record){return this.isFieldRequired(field,record)&&Rally.ui.detail.EditModeContext.isPageEditable(record)},isRecordEditable:function(record){return!Rally.data.util.Record.isReadOnly(record)},isAttributeEnabled:function(record,attributeName){var field=record.getField(attributeName);return Ext.isDefined(field)&&field.name===attributeName&&!field.hidden},isRecordParent:function(record){return!!Rally.ui.detail.DetailHelper.isAttributeEnabled(record,"Children")&&!!record.getCollection("Children").getTotalCount()},getController:function(){return this.controller},setController:function(controller){this.controller=controller},setFeatures:function(context){context&&context.featureToggles&&context.featureToggles.toggles&&(this.features=context.featureToggles.toggles)},featureEnabled:function(feature){return this.features[feature]},parseHash:function(hashToken){return this.parseSlug(this._slugFromHash(hashToken))},_slugFromHash:function(hashToken){return hashToken.replace(/\/.*?(\/.*)/,"$1")},parseSlug:function(slug){var hash=slug.split("?")[0],params=slug.split("?")[1],hashValues=hash.split("/"),hashInfo={model:hashValues[2],config:Rally.ui.detail.DetailHelper._queryStringToConfigObject(params)},indexAdjustment=Rally.ui.detail.DetailHelper._captureModelAndAdjustIndex(hashInfo,hashValues);return Rally.ui.detail.DetailHelper._captureSectionOrOid(hashInfo,hashValues,indexAdjustment),hashInfo},_queryStringToConfigObject:function(query){return query?Ext.urlDecode(query):{}},_captureSectionOrOid:function(hashInfo,hashValues,indexAdjustment){"new"===hashValues[3+indexAdjustment]?hashInfo.section=hashValues[3+indexAdjustment]:hashInfo.oid=hashValues[3+indexAdjustment],hashValues[4+indexAdjustment]&&(hashInfo.section=hashValues[4+indexAdjustment])},_captureModelAndAdjustIndex:function(hashInfo,hashValues){return"portfolioitem"===hashInfo.model?(hashInfo.model=hashInfo.model+"/"+hashValues[3],1):0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.EditMenuItem",{alias:"widget.rallyrecordmenuitemedit",extend:Rally.ui.menu.item.RecordMenuItem,config:{predicate:function(record){return record.isUpdatable()||Rally.ui.detail.DetailHelper.hasEDP(record)},handler:function(){var params=Ext.apply(this.params||{},{typeDef:this.record.self.typeDefOid});Rally.ui.detail.DetailHelper.hasEDP(this.record)?Rally.nav.Manager.showDetail(this.record,params):(window.detail&&(window.detail.refreshContent=!1),Rally.nav.Manager.edit(this.record,params))},text:"Edit..."}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.InlineAddChildMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuiteminlineaddchild",config:{text:"Add Child Inline...",cls:"artifact-icon icon-children"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.mustPassSomePredicates([Rally.predicate.RecordPredicates.canHaveChildren,Rally.predicate.RecordPredicates.canHaveTasks,Rally.predicate.RecordPredicates.canHaveDefects,Rally.predicate.RecordPredicates.canHaveTestCases])]),config.handler=config.handler||this._onAddChildClicked,this.initConfig(config),this.callParent(arguments)},_onAddChildClicked:function(){this.view.fireEvent("inlineadd",this.view,this.record,{action:"inlineaddchild"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.InlineAddPeerMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuiteminlineaddpeer",config:{text:"Add Peer Inline...",cls:"artifact-icon icon-peer"},constructor:function(config){config=config||{},config.handler=config.handler||this._onAddPeerClicked,config.predicate=config.predicate||function(record){return record.get("updatable")||record.get("deletable")||record.get("creatable")},this.initConfig(config),this.callParent(arguments),this.view&&this.view.store&&this.view.store.treeStore&&(Rally.data.Ranker.isStoreSortedByRank(this.view.store.treeStore)||this.disable())},_onAddPeerClicked:function(){this.view.fireEvent("inlineadd",this.view,this.record,{action:"inlineaddpeer"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.MoveToPositionMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemmovetoposition",config:{text:"Move to Position...",handler:function(){this._onMoveToPositionClicked()},rankRecordHelper:{findRecordToRankAgainst:Ext.emptyFn,getMoveToPositionStore:Ext.emptyFn}},constructor:function(config){config=config||{},Ext.isObject(config.rankRecordHelper)?Ext.isFunction(config.rankRecordHelper.getMoveToPositionStore)||Ext.Error.raise("rankRecordHelper.getMoveToPositionStore must be specified when creating a Rally.ui.menu.item.MoveToPositionMenuItem"):Ext.Error.raise("rankRecordHelper must be specified when creating a Rally.ui.menu.item.MoveToPositionMenuItem"),config.predicate=config.predicate||Rally.predicate.RecordPredicates.isRankable,config.handler=config.handler||this._onMoveToPositionClicked,this.initConfig(config),this.callParent(arguments)},_getStoreConfig:function(record){var storeConfig={autoLoad:!0,sorters:Rally.data.util.Sorter.sorters(Rally.data.Ranker.getRankField(this.record.self)+" ASC"),filters:[{property:"ObjectID",operator:"!=",value:this.record.get("ObjectID")}]};return record.isScheduledTestCase()&&Ext.apply(storeConfig,{url:this.record.store.url||Rally.environment.getServer().getWsapiUrl()+Rally.util.Ref.getRelativeUri(record.parentNode)+"/ScheduledTestCases",sorters:[],filters:[],fetch:["Name","FormattedID","TestCase"],useCompositeArtifacts:!0,alwaysSortedByRankAsc:!0,listeners:{load:function(store){store.filterBy(function(record){return record.getId()!==this.record.getId()},this)},scope:this}}),storeConfig},_onMoveToPositionClicked:function(){this.rankRecordHelper.getMoveToPositionStore.call(this.rankRecordHelper.scope,{recordBeingRanked:this.record,storeConfig:this._getStoreConfig(this.record)}).then({success:function(positionStore){var chooserConfig={componentCls:"rally-move-to-position-dialog",autoShow:!0,title:this.text,introText:"Choose a new position for "+this.record.get("FormattedID"),showRadioButtons:!1,gridConfig:{store:positionStore},columns:[{dataIndex:"DragAndDropRank",width:80},{text:"ID",dataIndex:"FormattedID",renderer:_.identity,width:100},"Name"],listeners:{artifactChosen:this._rankAbove,scope:this}};this.record.isScheduledTestCase()&&(chooserConfig.gridConfig.sortableColumns=!1,chooserConfig.columns.shift()),Ext.create("Rally.ui.dialog.ArtifactChooserDialog",chooserConfig)},scope:this})},_rankAbove:function(dialog,otherRecord){Rally.data.Ranker.rankRelative({recordToRank:this.record,relativeRecord:otherRecord,position:"after",notificationMessage:"Moved {0} below {1}"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RankExtremeMenuItemViewController",{extend:Rally.ui.ViewController,mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},observe:{view:{click:"_onRankExtremeClicked"}},_isRankHighest:function(){return"highest"===this.getView().rankPosition},_onRankDone:function(record,operation){var view=this.getView();this.recordLoadEnd({component:view}),Ext.callback(view.afterAction,view.actionScope,[record,operation])},_onRankRecordFound:function(rankRecord){var view=this.getView(),recordToRank=view.record,rankHighest=this._isRankHighest();rankRecord.getId()===recordToRank.getId()?this._rankExtreme(recordToRank):Rally.data.Ranker.rankRelative({recordToRank:recordToRank,relativeRecord:rankRecord,position:rankHighest?"before":"after",notificationMessage:"{0} is now ranked "+view.rankPosition+".",saveOptions:{callback:this._onRankDone,scope:this}})},_rankExtreme:function(record){var saveOptions={callback:this._onRankDone,scope:this};this._isRankHighest()?Rally.data.Ranker.rankToTop(record,{saveOptions:saveOptions}):Rally.data.Ranker.rankToBottom(record,{saveOptions:saveOptions})},_onRankExtremeClicked:function(){var view=this.getView(),recordToRank=view.record;if(!Ext.isFunction(view.beforeAction)||view.beforeAction.call(view.actionScope,recordToRank)!==!1){this.recordLoadBegin({description:"ranking item "+view.rankPosition,component:view});var options={recordBeingRanked:recordToRank,highest:this._isRankHighest(),success:this._onRankRecordFound,failure:function(operation){Rally.data.util.Record.showWsapiErrorNotification(recordToRank,operation),this._onRankDone(recordToRank,operation)},requester:view,storeConfig:{pageSize:1},scope:this};if(recordToRank.isScheduledTestCase()){var url=recordToRank.store.url||Rally.environment.getServer().getWsapiUrl()+Rally.util.Ref.getRelativeUri(recordToRank.parentNode)+"/ScheduledTestCases";Ext.apply(options,{storeConfig:{url:url,sorters:[],filters:[],pageSize:options.highest?1:Rally.data.wsapi.Store.wsapiMaxPageSize,limit:options.highest?1:1/0}})}view.rankRecordHelper.findRecordToRankAgainst.call(view.rankRecordHelper.scope,options)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RankExtremeMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemrankextreme",controller:"Rally.ui.menu.item.RankExtremeMenuItemViewController",config:{recordRankOptions:{success:Ext.emptyFn,failure:Ext.emptyFn,scope:window},beforeAction:null,afterAction:null,actionScope:null,rankRecordHelper:null},constructor:function(config){config=config||{},Ext.isObject(config.rankRecordHelper)||Ext.Error.raise("rankRecordHelper must be specified when creating a Rally.ui.menu.item.RankExtremeMenuItem"),Ext.isFunction(config.rankRecordHelper.findRecordToRankAgainst)||Ext.Error.raise("rankRecordHelper.findRecordToRankAgainst must be specified when creating a Rally.ui.menu.item.RankExtremeMenuItem"),config.rankPosition&&"highest"!==config.rankPosition&&"lowest"!==config.rankPosition&&Ext.Error.raise('rankPosition must be specified as "highest" or "lowest"'),config.predicate=config.predicate||Rally.predicate.RecordPredicates.isRankable,config.rankPosition=config.rankPosition||"highest",config.text="Rank "+Ext.String.capitalize(config.rankPosition),this.initConfig(config),this.callParent([config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RemoveMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemremove",mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},config:{text:"Remove",collectionStore:null,handler:function(){this._onRemoveClicked()},beforeAction:null,afterAction:null,actionScope:null,predicate:function(record){var parentNodeIsValidRecord=record.parentNode&&!!record.parentNode.getId();return record.get("updatable")&&(this.collectionStore||parentNodeIsValidRecord);
}},_onRemoveClicked:function(){_.isFunction(this.beforeAction)&&this.beforeAction.call(this.actionScope||window,this.record)===!1||this._removeRecord()},_removeRecord:function(){return this.collectionStore?(this.recordLoadBegin({description:"Updating record collection",miscData:{id:this.collectionStore.record.getId()}}),void(this.collectionStore.isLoading()?this.collectionStore.on("load",this._removeAndSync,this,{single:!0}):this._removeAndSync())):this._createStoreAndRemoveRecord()},_removeAndSync:function(){this.collectionStore.remove(this.record),this.collectionStore.sync({callback:this._onCallback,success:this._onSuccess,failure:this._onFailure,scope:this,requester:this})},_createStoreAndRemoveRecord:function(){var parentRecord=this.record.parentNode,childField=parentRecord.self.getCollectionFieldFor(this.record.self).name,operation=new Ext.data.Operation({action:"destroy",records:[this.record]}),callback=function(operation){var record=operation.getRecords()[0];operation.wasSuccessful()?this._onSuccess(record,operation):this._onFailure(record,operation),this._onCallback()};this.collectionStore=parentRecord.getCollection(childField),this.collectionStore.proxy.model=parentRecord.self,this.collectionStore.proxy.reader.model=parentRecord.self,this.recordLoadBegin({description:"Updating record collection",miscData:{id:this.collectionStore.record.getId()}}),this.collectionStore.proxy.destroy(operation,callback,this)},_onCallback:function(){this.recordLoadEnd(),Ext.callback(this.afterAction,this.actionScope,[this.record])},_onSuccess:function(){var updatedRecord=this.collectionStore.record.copy();updatedRecord.self.load(updatedRecord.getId(),{callback:function(record){this.publish(Rally.Message.objectUpdate,record,null,this),Rally.ui.notify.Notifier.showRemove(this.record,this.collectionStore.record)},scope:this})},_onFailure:function(record,operation){Rally.data.util.Record.showWsapiErrorNotification(this.collectionStore.record,operation)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RunTestSetMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemruntestset",config:{text:"Run Test Set",params:{}},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isTestSet]),config.handler=config.handler||this._onMenuItemClicked,this.initConfig(config),this.callParent(arguments)},_onMenuItemClicked:function(){Rally.nav.Manager.showDetail(this.record,this.params)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.ShowDetailsMenuItem",{alias:"widget.rallyrecordmenuitemshowdetails",extend:Rally.ui.menu.item.RecordMenuItem,config:{predicate:function(record){return record.self.isTimebox()&&!record.isMilestone()||record.self.isUser()&&record.isUpdatable()},handler:function(){Rally.nav.Manager.showDetail(this.record,Ext.apply(this.params||{},{typeDef:this.record.self.typeDefOid}))},text:"Show Details..."}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.SplitMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemsplit",config:{text:"Split...",handler:function(){this._onSplitClicked()}},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.isUserStory]),this.initConfig(config),this.callParent(arguments)},clientMetrics:[{method:"_onSplitClicked",description:"split menu item clicked"}],_onSplitClicked:function(){Rally.nav.Manager.split(this.record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.WatchMenuItem",{alias:"widget.rallyrecordmenuitemwatch",extend:Rally.ui.menu.item.RecordMenuItem,mixins:[Rally.clientmetrics.ClientMetricsRecordable],config:{record:null,handler:function(){var me=this;this._isWatching?this.api.unwatch(this.getRecord()).then(function(results){me.setWatching(!1)}):this.api.watch(this.getRecord()).then(function(results){me.setWatching(!0)})},text:"Watch",enableBetaBadge:!1},cls:"watches-menu-item",constructor:function(config){if(config.predicate=config.predicate||Rally.predicate.RecordPredicates.isArtifact,this.initConfig(config),this.api=new Rally.data.notifications.Api,this.enableBetaBadge){var tpl=_.isArray(this.renderTpl)?this.renderTpl.join(""):this.renderTpl.html;this.renderTpl=Ext.create("Ext.XTemplate",tpl+'<span class="rly-badge beta"><span class="badge-m">Beta</span></span>')}this.callParent(arguments),this.api.checkIfWatching(this.getRecord(),{scope:this,success:function(isWatching){this.setWatching(isWatching),this.enable()},failure:function(response){this.disable()}})},setWatching:function(isWatching){this._isWatching=isWatching,this._updateWatchTextInMenu(isWatching)},_updateWatchTextInMenu:function(isWatching){isWatching=!!isWatching,this.ownerCt&&this.ownerCt.suspendLayouts(),this.setText(isWatching?"Unwatch":"Watch"),this.ownerCt&&this.ownerCt.resumeLayouts()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.plugins.ArtifactFilterPlugin",{extend:Ext.AbstractPlugin,init:function(){this.callParent(arguments),this.cmpGetStoreFilters=this.cmp.getStoreFilters,this.cmp.getStoreFilters=Ext.bind(this.getStoreFilters,this),this.cmpGetSearchBarItems=this.cmp.getSearchBarItems,this.cmp.getSearchBarItems=Ext.bind(this.getSearchBarItems,this),this.cmp.columns=_.union(this.cmp.columns,this.getAdditionalColumns())},getAdditionalColumns:Ext.emptyFn,getSearchBarItem:Ext.emptyFn,getSearchBarItems:function(){var items=_.union(this.cmpGetSearchBarItems.call(this.cmp),_.compact([this.getSearchBarItem()])),unlabeledItems=_.filter(items,function(item){return!item.fieldLabel});return unlabeledItems.length!==items.length&&_.each(unlabeledItems,function(item){Ext.apply(item,{labelAlign:"top",labelSeparator:"",fieldLabel:"&nbsp;"})}),items},getStoreFilters:function(){return this.cmpGetStoreFilters.call(this.cmp)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.ProjectComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyprojectcombobox",config:{displayField:"_refObjectName",editable:!0,emptyText:"Filter by Project...",forceSelection:!0,preventMark:!0,selectOnFocus:!0,typeAhead:!0,autoExpand:!0,dataFilterFn:function(){return!0},onlyShowEditableProjects:!1,abortInlineEdit:function(event){return null===event.value},validator:function(value){return!this.validateOnChange||(!!Rally.util.Ref.isRefUri(this.getValue())||"This value is not a valid project reference.")}},constructor:function(config){this.mergeConfig(config),config.store||(this.store=this._buildStore()),this.callParent([this.config])},setContextFromRecord:function(record){this.store.loadData(this._getProjects(record.get("Workspace")))},_getProjects:function(workspace){workspace=workspace||Rally.environment.getContext().getWorkspace();var userProjectPermissions=_.filter(Rally.environment.getContext().getPermissions().userPermissions,function(userPermission){return"project"===Rally.util.Ref.getTypeFromRef(userPermission)&&Rally.util.Ref.getOidFromRef(userPermission.Workspace)===workspace.ObjectID});this.getOnlyShowEditableProjects()&&(userProjectPermissions=_.filter(userProjectPermissions,function(userPermission){return Rally.environment.getContext().getPermissions().isProjectEditor(userPermission)}));var projectValues=_.map(userProjectPermissions,function(userPermission){return{_refObjectName:userPermission._refObjectName,_ref:Rally.util.Ref.getRelativeUri(userPermission),_uuidRef:"/project/"+userPermission._refObjectUUID}});return _.filter(_.sortBy(projectValues,"_refObjectName"),this.dataFilterFn)},_buildStore:function(){return Ext.create("Ext.data.JsonStore",{autoDestroy:!0,autoLoad:!0,fields:["_refObjectName","_uuidRef","_ref"],data:this._getProjects(),proxy:{type:"memory"}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.plugins.ArtifactProjectFilter",{alias:"plugin.rallyartifactprojectfilter",extend:Rally.ui.dialog.plugins.ArtifactFilterPlugin,getAdditionalColumns:function(){return["Project"]},getSearchBarItem:function(){return _.merge({xtype:"rallyprojectcombobox",allowClear:!0,clearText:"-- Clear Filter --",cls:"artifact-project-filter-combo",defaultSelectionPosition:null,onlyShowEditableProjects:!0,fieldLabel:this.fieldLabel||"Project",itemId:"projectChooser",labelAlign:"top",listeners:{select:this.cmp.buildGrid,scope:this.cmp},margin:"0 0 0 10px",width:200},this.comboBoxConfig)},getStoreFilters:function(){var storeFilters=this.callParent(),projectChooser=this.cmp.down("#projectChooser");return projectChooser&&projectChooser.getValue()&&storeFilters.push({property:"Project",value:projectChooser.getValue()}),storeFilters}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddExistingDefectsMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddexistingdefects",mixins:[Rally.Messageable],config:{text:"Add Existing Defect...",cls:"artifact-icon icon-defect"},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveDefects]),config.handler=config.handler||this._onMenuItemClicked,this.initConfig(config),this.callParent(arguments)},_onMenuItemClicked:function(){this.record.getCollection("Defects",{autoLoad:!0,listeners:{load:{fn:function(collectionStore){Ext.create("Rally.ui.dialog.ArtifactCollectionChooserDialog",{collectionStoreToAddTo:collectionStore,plugins:["rallyartifactprojectfilter"],selectionButtonText:"Add",context:this.context,storeConfig:{context:{workspace:this.context.getWorkspaceRef(),project:null},filters:[{property:"DefectSuites",operator:"!contains",value:Rally.util.Ref.getRelativeUri(this.record)}]},title:"Choose Defects"})},scope:this,single:!0}},pageSize:1})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.DefaultRecordMenu",{extend:Rally.ui.menu.RecordMenu,alias:"widget.rallydefaultrecordmenu",mixins:{messageagble:Rally.Messageable},config:{record:null,showAddTasks:!0,showAddDefects:!0,showAddTestCases:!0,showCopyTasksFrom:!0,showCopyMenuItem:!0,showInlineAdd:!1,owningEl:void 0,onBeforeRecordMenuCopy:Ext.emptyFn,onRecordMenuCopy:Ext.emptyFn,onBeforeRecordMenuDelete:Ext.emptyFn,onRecordMenuDelete:Ext.emptyFn,onBeforeRecordMenuRankHighest:Ext.emptyFn,onBeforeRecordMenuRankLowest:Ext.emptyFn,onRecordMenuRemove:Ext.emptyFn,rankRecordHelper:{findRecordToRankAgainst:Ext.emptyFn,getMoveToPositionStore:Ext.emptyFn}},initComponent:function(){this.items=this._getMenuItems(),this.callParent(arguments)},_getMenuItems:function(){var record=this.getRecord(),items=[],popoverPlacement=this.popoverPlacement||Rally.ui.popover.Popover.DEFAULT_PLACEMENT;return this.showInlineAdd?(items.push({xtype:"rallyrecordmenuiteminlineaddchild",view:this.view,record:record}),items.push({xtype:"rallyrecordmenuiteminlineaddpeer",view:this.view,record:record}),items.push({xtype:"rallyrecordmenuitemaddexistingtestcases",view:this.view,record:record}),items.push({xtype:"rallyrecordmenuitemaddexistingdefects",view:this.view,record:record})):(this.showAddTasks!==!1&&items.push({xtype:"rallyrecordmenuitemaddtask",record:record,owningEl:this.owningEl,popoverPlacement:popoverPlacement}),this.showAddDefects!==!1&&items.push({xtype:"rallyrecordmenuitemadddefect",record:record,owningEl:this.owningEl,popoverPlacement:popoverPlacement}),this.showAddTestCases!==!1&&items.push({xtype:"rallyrecordmenuitemaddtestcase",record:record,owningEl:this.owningEl,popoverPlacement:popoverPlacement}),this.showAddChildMenuItem!==!1&&items.push({xtype:"rallyrecordmenuitemaddchild",record:record})),this.showCopyTasksFrom!==!1&&items.push({xtype:"rallyrecordmenuitemcopytasksfrom",record:record}),items.push({xtype:"menuseparator",margin:0,padding:0}),items.push({xtype:"rallyrecordmenuitemshowdetails",record:record},{xtype:"rallyrecordmenuitemedit",record:record},{xtype:"rallyrecordmenuitemruntestset",record:record,actionScope:this}),this.showCopyMenuItem!==!1&&items.push({xtype:"rallyrecordmenuitemcopy",record:record,beforeAction:this.getOnBeforeRecordMenuCopy(),afterAction:this.getOnRecordMenuCopy(),actionScope:this}),items.push({xtype:"rallyrecordmenuitemcopyuser",record:record}),items.push({xtype:"menuseparator",margin:0,padding:0}),this.showRankMenuItems===!1||_.isFunction(this.shouldRecordBeExtremeRankable)&&!this.shouldRecordBeExtremeRankable(record)||(items.push({xtype:"rallyrecordmenuitemrankextreme",rankRecordHelper:this.getRankRecordHelper(),rankPosition:"highest",record:record,beforeAction:this.getOnBeforeRecordMenuRankHighest(),actionScope:this},{xtype:"rallyrecordmenuitemrankextreme",rankRecordHelper:this.getRankRecordHelper(),rankPosition:"lowest",record:record,beforeAction:this.getOnBeforeRecordMenuRankLowest(),actionScope:this}),_.isFunction(this.shouldRecordBeRankable)&&!this.shouldRecordBeRankable(record)||items.push({xtype:"rallyrecordmenuitemmovetoposition",record:record,rankRecordHelper:this.getRankRecordHelper()}),items.push({xtype:"menuseparator",margin:"0 0 0 0",padding:"0 0 0 0"})),this.showSplitMenuItem!==!1&&items.push({xtype:"rallyrecordmenuitemsplit",record:record},{xtype:"menuseparator",margin:"0 0 0 0",padding:"0 0 0 0"}),this.showWatchMenuItem!==!1&&Rally.data.notifications.Api.enabled&&items.push({xtype:"rallyrecordmenuitemwatch",record:record,actionScope:this,enableBetaBadge:!0},{xtype:"menuseparator",margin:"0 0 0 0",padding:"0 0 0 0"}),this.collectionStore&&_.isFunction(this.shouldBeRemovable)&&this.shouldBeRemovable(record)&&items.push({xtype:"rallyrecordmenuitemremove",actionScope:this,afterAction:this.onRecordMenuRemove,collectionStore:this.collectionStore,record:record}),this.showDeleteMenuItem!==!1&&items.push({xtype:"rallyrecordmenuitemdelete",record:record,beforeAction:this.getOnBeforeRecordMenuDelete(),afterAction:this.getOnRecordMenuDelete(),actionScope:this}),items}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardIcons",{alias:"plugin.rallycardicons",extend:Ext.AbstractPlugin,mixins:{messageagble:Rally.Messageable},clientMetrics:[{method:"_onBlockedIconClick",description:"blocked icon clicked"},{method:"_onReadyIconClick",description:"ready icon clicked"}],inheritableStatics:{getTpl:function(){return this.tpl||(this.tpl=Ext.create("Ext.XTemplate",['<tpl if="hasIcons">','<div class="rally-card-icons-ct">','<tpl if="(hasReadyField && isReady) || (hasBlockedField && isBlocked)">','<div class="rally-card-icons indicator">','<tpl if="(hasBlockedField && isBlocked)">','<div class="indicator-icon icon-blocked"></div>',"<tpl else>",'<div class="indicator-icon icon-ready"></div>',"</tpl>","<tpl else>",'<div class="rally-card-icons" style="visibility: hidden;">',"</tpl>",'<tpl if="showPlusIcon"><div class="rally-card-icon card-plus-icon icon-add" title="New..." role="img"></div></tpl>','<tpl if="showGearIcon"><div class="rally-card-icon card-gear-icon icon-gear" title="Actions..." role="img"></div></tpl>','<tpl if="hasReadyField"><div class="rally-card-icon card-ready-icon<tpl if="isReady"> rly-active</tpl> icon-ok" role="img"></div></tpl>','<tpl if="hasBlockedField"><div class="rally-card-icon card-blocked-icon<tpl if="isBlocked"> rly-active</tpl> icon-blocked" role="img"></div></tpl>','<tpl if="showColorIcon"><div class="rally-card-icon card-color-icon icon-color" title="Card Color" role="img"></div></tpl>',"</div>","</div>","</tpl>"])),this.tpl}},config:{showPlusIcon:!0,showGearIcon:!0,showColorIcon:!1,showReadyIcon:!0,showBlockedIcon:!0,gearMenuConfig:{showEditMenuItem:!0,showCopyMenuItem:!0,showAddChildMenuItem:!0,showRankMenuItems:!0,showSplitMenuItem:!0,showDeleteMenuItem:!0}},init:function(card){this.callParent(arguments),this.card=card,card.iconsPlugin=this,this.card.on("ready",this._onReady,this)},destroy:function(){this.card&&(this.detachListeners(),delete this.card.iconsPlugin,delete this.card),this.plusIconEl&&(Ext.EventManager.removeAll(this.plusIconEl),delete this.plusIconEl),this.callParent(arguments)},detachListeners:function(){if(this.card){var cardEl=this.card.getEl(),el=cardEl&&cardEl.down(".rally-card-icons");if(el){var readyIconEl=el.down(".card-ready-icon"),blockedIconEl=el.down(".card-blocked-icon");readyIconEl&&readyIconEl.un("click",this._onReadyIconClick,this),blockedIconEl&&blockedIconEl.un("click",this._onBlockedIconClick,this)}}},getHtml:function(){var record=this.card.getRecord(),hasReady=this.showReadyIcon&&this._isIconActiveFor("Ready"),hasBlocked=this.showBlockedIcon&&this._isIconActiveFor("Blocked"),hasIcons=hasReady||hasBlocked||this.showColorIcon||this.showGearIcon||this.showPlusIcon;return hasIcons?(this.card.on("afterrender",this._onAfterCardRender,this),this.card.on("rerender",this._onAfterCardRender,this),this.card.on("show",this._fixStyles,this),this.self.getTpl().apply({hasReadyField:hasReady,hasBlockedField:hasBlocked,hasIcons:hasIcons,showPlusIcon:this.showPlusIcon&&this._getPlusMenuItems().length>0,isBlocked:hasBlocked&&!!record.get("Blocked"),isReady:hasReady&&!!record.get("Ready"),showGearIcon:this.showGearIcon,showColorIcon:this.showColorIcon,formattedId:record.get("FormattedID"),name:record.get("Name")})):""},_isIconActiveFor:function(fieldName){var record=this.card.getRecord(),active=record.isFieldVisible(fieldName);return active&&"Blocked"===fieldName&&(active=!record.isCustomField("Blocked")),active},_toggleState:function(fieldName){var record=this.card.getRecord(),newValue=!record.get(fieldName),otherStateFieldName="Blocked"===fieldName?"Ready":"Blocked";record.set(fieldName,newValue),newValue&&this._isIconActiveFor(otherStateFieldName)&&record.getField(otherStateFieldName)&&record.set(otherStateFieldName,!1),record.save({success:this._onToggleStateSuccess,failure:this._onToggleStateFailure,scope:this})},_onToggleStateSuccess:function(record){this.card.fireEvent("statechange"),this.publish(Rally.Message.objectUpdate,record,["Ready","Blocked"],this.card)},_onToggleStateFailure:function(record,operation){record.reject(),Rally.data.util.Record.showWsapiErrorNotification(this.card.getRecord(),operation)},_onReadyIconClick:function(e){this._toggleState("Ready")},_onBlockedIconClick:function(e){this._toggleState("Blocked")},_onReady:function(){var card=this.card;this._fixStyles();var el=card.getEl();_.isUndefined(el)||el.hover(this._onCardMouseOver,this._onCardMouseOut,this)},_onAfterCardRender:function(){var card=this.card,cardEl=card.getEl(),el=cardEl.down(".rally-card-icons"),iconEls=el.query(".rally-card-icon"),readyIconEl=el.down(".card-ready-icon"),blockedIconEl=el.down(".card-blocked-icon");this.plusIconEl=el.down(".card-plus-icon"),this.gearIconEl=el.down(".card-gear-icon"),this.colorIconEl=el.down(".card-color-icon"),iconEls.length&&(Ext.fly(iconEls[0]).addCls("rly-left"),Ext.fly(iconEls[iconEls.length-1]).addCls("rly-right")),readyIconEl&&(readyIconEl.on("click",this._onReadyIconClick,this),this._setReadyIconTooltip(readyIconEl)),blockedIconEl&&(blockedIconEl.on("click",this._onBlockedIconClick,this),this._setBlockedIconTooltip(blockedIconEl)),this.plusIconEl&&this.plusIconEl.on("click",this._onPlusTriggerClick,this),this.gearIconEl&&this.gearIconEl.on("click",this._onGearTriggerClick,this),this.colorIconEl&&this.colorIconEl.on("click",this._onColorTriggerClick,this),this._fixStyles()},_setReadyIconTooltip:function(readyIconEl){var iconEl=readyIconEl||this.card.getEl().down(".card-ready-icon");if(iconEl){var record=this.card.getRecord(),text=record.get("Ready")?"Mark as Not Ready to Pull":"Mark as Ready to Pull";iconEl.set({title:text,"aria-label":text+" "+record.get("FormattedID")+": "+record.get("Name")})}},_setBlockedIconTooltip:function(blockedIconEl){var iconEl=blockedIconEl||this.card.getEl().down(".card-blocked-icon");if(iconEl){var record=this.card.getRecord(),text=record.get("Blocked")?"Unblock":"Block";iconEl.set({title:text,"aria-label":text+" "+record.get("FormattedID")+": "+record.get("Name")})}},_onCardMouseOver:function(){var dragGhost=Ext.DomQuery.selectNode("."+Ext.baseCSSPrefix+"dd-drag-proxy.cardboard");dragGhost&&Ext.fly(dragGhost).isVisible()||this.card.getEl().isMasked()||(this._removeIndicator(),this._setIconsVisibility(!0),delete this.shouldHideIconBar)},_onCardMouseOut:function(){this.menu||this.colorPopoverPlugin?this.shouldHideIconBar=!0:(this._setIconsVisibility(!1),this._setIndicator())},_setIconsVisibility:function(visible){if(this.card&&this.card.getEl()){var targetEl=Ext.get(this.card.getEl().down(".rally-card-icons"));targetEl.setVisibilityMode(Ext.dom.Element.VISIBILITY),targetEl.setVisible(visible),visible&&targetEl.setStyle("opacity",1)}},_onPlusTriggerClick:function(e){var menu=this._getPlusMenu();menu.showBy(e.target,"tl-bl",[1,0])},_onGearTriggerClick:function(e){var menu=this._getGearMenu();menu.showBy(e.target,"tl-bl",[0,0])},_onColorTriggerClick:function(e){this.colorPopoverPlugin=this.card.popoverPlugin,this.colorPopoverPlugin&&this.colorPopoverPlugin.showColor({target:Ext.get(e.target),listeners:{destroy:function(){this._setIconsVisibility(!1),this.colorPopoverPlugin&&delete this.colorPopoverPlugin},afterrender:function(){this._setIconsVisibility(!0)},scope:this}})},_getPlusMenu:function(){return this.menu||(this.menu=Ext.widget("rallyrecordmenu",{cls:Rally.util.Test.toBrowserTestCssClass("card-plus-menu-"+this.card.getRecord().get("ObjectID"))+" card-plus-menu",items:this._getPlusMenuItems(),listeners:{destroy:this._destroyMenu,scope:this}})),this.menu},_destroyMenu:function(menu,eOpts){this.menu&&(delete this.menu,this.shouldHideIconBar&&this._setIconsVisibility(!1))},_getPlusMenuItems:function(){var cardRecord=this.card.getRecord(),items=[],hasTasksField=cardRecord.getField("Tasks"),hasDefectsField=cardRecord.getField("Defects"),hasTestCasesField=cardRecord.getField("TestCases"),hasDiscussionsField=cardRecord.getField("Discussion");return hasTasksField&&items.push({text:"Tasks",cls:"artifact-icon icon-task",record:cardRecord,handler:this._onTasksClick,scope:this}),hasDefectsField&&!hasDefectsField.virtual&&items.push({text:"Defects",cls:"artifact-icon icon-defect",record:cardRecord,handler:this._onDefectsClick,scope:this}),hasTestCasesField&&items.push({text:"Test Cases",cls:"artifact-icon icon-test-case",record:cardRecord,handler:this._onTestCasesClick,scope:this}),hasDiscussionsField&&items.push({text:"Discussion",cls:"artifact-icon icon-comment",record:cardRecord,handler:this._onDiscussionClick,scope:this}),items},_onTasksClick:function(){var popoverPlugin=this.card.popoverPlugin;popoverPlugin&&popoverPlugin.showTasks()},_onDefectsClick:function(){var popoverPlugin=this.card.popoverPlugin;popoverPlugin&&popoverPlugin.showDefects()},_onDiscussionClick:function(){var popoverPlugin=this.card.popoverPlugin;popoverPlugin&&popoverPlugin.showDiscussion()},_onTestCasesClick:function(){var popoverPlugin=this.card.popoverPlugin;popoverPlugin&&popoverPlugin.showTestCases()},_getGearMenu:function(){return this.menu||(this.menu=Ext.widget("rallydefaultrecordmenu",Ext.apply({record:this.card.getRecord(),cls:Rally.util.Test.toBrowserTestCssClass("card-gear-menu-"+this.card.getRecord().getId())+" card-gear-menu",showAddTasks:!1,showAddDefects:!1,showAddTestCases:!1,onBeforeRecordMenuCopy:Ext.bind(function(){this.card.setLoading(!0)},this),onRecordMenuCopy:Ext.bind(function(record,originalRecord,operation){this.card.setLoading(!1),operation.wasSuccessful()?this.card.fireEvent("cardcopied",this.card,record):Rally.data.util.Record.isObjectDoesNotExistWsapiError(operation)&&this.card.destroy()},this),onBeforeRecordMenuDelete:Ext.bind(function(){this.card.setLoading(!0)},this),rankRecordHelper:this.card.rankRecordHelper,listeners:{destroy:this._destroyMenu,scope:this}},this.getGearMenuConfig()))),this.menu},_setIndicator:function(){this._isCardBlockedOrReady()&&(this.card.getEl().down(".rally-card-icons").addCls("indicator"),this._setIconsVisibility(!0))},_removeIndicator:function(){this._isCardBlockedOrReady()&&this.card.getEl().down(".rally-card-icons").removeCls("indicator")},_isCardBlockedOrReady:function(){return this.card.shouldShowBlockedBorder()||this.card.shouldShowReadyBorder()},_fixStyles:function(){Ext.isIE9&&this._setIndicator()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CardPopover",{alias:"plugin.rallycardpopover",extend:Ext.AbstractPlugin,mixins:[Rally.clientmetrics.ClientMetricsRecordable],init:function(card){this.card=card,this.card.popoverPlugin=this,this.card.on("rerender",this._onRerender,this),this.card.on("fieldclick",this._onFieldClick,this)},destroy:function(){this.card&&(delete this.card.popoverPlugin,delete this.card),this.popover&&(this.popover.destroy(),delete this.popover),this.callParent(arguments)},showDescription:function(){Ext.getElementById("description-popover")||(this.recordAction({description:"showing card description "}),this._createPopover({context:this.card.context,field:"Description",offsetFromTarget:[{x:0,y:-10},{x:12,y:0},{x:0,y:10},{x:-15,y:0}],target:this.card.getEl().down(".formatted-id-template"),targetSelector:"."+this.card.getCardRecordCls()+" .formatted-id-template"}))},showTasks:function(){this._createPopover({field:"Task"})},showDiscussion:function(){this._createPopover({field:"Discussion"})},showDefects:function(){this._createPopover({field:"Defect"})},showUserStories:function(){var popoverConfig={field:"UserStory",offsetFromTarget:[{x:0,y:-8},{x:15,y:0},{x:5,y:15},{x:-15,y:0}],target:this.card.getEl().down(".field-content.UserStories"),targetSelector:"."+this.card.getCardRecordCls()+" .field-content.UserStories",listViewConfig:{addNewConfig:{ignoredRequiredFields:["Name","State","WorkProduct","Project","ScheduleState"]}}},fieldDefinition=_.find(this.card.getFieldDefinitions(),function(field){return"UserStories"===field.name});fieldDefinition&&fieldDefinition.popoverConfig&&(popoverConfig=Ext.merge(popoverConfig,fieldDefinition.popoverConfig)),this._createPopover(popoverConfig)},showTestCases:function(){this._createPopover({field:"TestCase"})},showOwner:function(){this._createPopover({field:"Owner",target:this.card.getEl().down(".card-owner-img"),targetSelector:"."+this.card.getCardRecordCls()+" .card-owner-img"})},showPercentDoneByStoryCount:function(){return this._showProgressPopover("PercentDoneByStoryCount")},showPercentDoneByStoryPlanEstimate:function(){return this._showProgressPopover("PercentDoneByStoryPlanEstimate")},showColor:function(config){this._createPopover(Ext.apply({field:"Color",placement:"bottom",offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:4,y:10},{x:0,y:0}]},config))},showPredecessorsAndSuccessors:function(){return this._createPopover({field:"PredecessorsAndSuccessors",offsetFromTarget:[{x:0,y:-8},{x:15,y:0},{x:5,y:15},{x:-15,y:0}],target:this.card.getEl().down(".field-content.PredecessorsAndSuccessors")})},_createPopover:function(popoverCfg){this.card.select(),this.popover&&this.popover.destroy(),this.popover=Rally.ui.popover.PopoverFactory.bake(Ext.apply({target:this.card.getEl(),targetSelector:"."+this.card.getCardRecordCls(),record:this.card.getRecord(),offsetFromTarget:[{x:0,y:-8},{x:15,y:0},{x:5,y:8},{x:-15,y:0}],autoShow:!1},popoverCfg)),this.popover.on("destroy",this._onPopoverDestroy,this),this.popover.on("afterrender",this._onPopoverAfterRender,this),this.popover.show()},_onPopoverDestroy:function(){this.card&&this.card.deselect(),delete this.popover},_onPopoverAfterRender:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_onFieldClick:function(fieldName){var fn=this["show"+fieldName];Ext.isFunction(fn)&&fn.call(this)},_showProgressPopover:function(progressFieldName){var cardEl=this.card.getEl(),record=this.card.getRecord();this._createPopover({field:progressFieldName,target:cardEl.down(".field-"+progressFieldName+".progress-bar-container"),targetSelector:"#"+cardEl.id+" .field-"+progressFieldName+".progress-bar-container",percentDoneData:record.data,percentDoneName:"PercentDoneByStoryCount",piRef:record.data._ref})},_onRerender:function(){this.popover&&(this.popover.alignToTarget(),this.popover.down(".rallylistview")&&this.popover.down(".rallylistview").realignGridEditor())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.Highlightable",{highlight:function(opts){var el=this.getEl();el&&!this._highlighting&&(this._highlighting=!0,Rally.util.Animation.highlight(el,{callback:function(){delete this._highlighting,opts&&opts.callback&&Ext.callback(opts.callback,opts.scope||this)},scope:this}))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.Card",{alias:"widget.rallycard",extend:Ext.Component,cls:"rui-card",mixins:{messageagble:Rally.Messageable,highlightable:Rally.ui.Highlightable},ownerColumn:null,inheritableStatics:{getFetchFields:function(){return["Owner","FormattedID","Blocked","BlockedReason","Ready","Name","Tags","DisplayColor","Project"]},defaultFields:["Name"]},selected:!1,config:{record:void 0,fields:[],customFieldConfig:null,editable:!1,showPlusIcon:!0,showGearIcon:!0,showEditMenuItem:!0,showCopyMenuItem:!0,showAddChildMenuItem:!0,showRankMenuItems:!0,showSplitMenuItem:!0,showDeleteMenuItem:!0,showColorIcon:!1,showReadyIcon:!0,showBlockedIcon:!0,context:void 0,showAge:-1,ageFieldName:null,ageIntervalUnit:"day",skipDefaultFields:!0},constructor:function(config){config=config||{};var fields=config.fields||[];config.skipDefaultFields||(fields=Ext.Array.merge(this.self.defaultFields,fields)),config.fields=fields,this.mergeConfig(config),this._mergeCustomFieldConfig(),this.plugins=this.config.plugins||this.setupPlugins(),delete this.config.plugins,this.callParent([this.config]),this.record.get("updatable")&&this.editable&&this.addCls("editable")},initComponent:function(){this.addEvents("blocked","select","deselect","statechange","datachanged","rerender","aftercardhighlight","cardcopied","ready"),this.callParent(arguments),this.addCls(Rally.util.Type.getTypeOrParentType(this.getRecord().get("_type")).toLowerCase()),this.addCls(this.getCardRecordCls()),this.on("beforerender",this._onBeforeRender,this),this.on("statechange",this._displayState,this)},getCardRecordCls:function(){return"card-"+this.getRecord().getId()},addField:function(field){this.getFields().push(field),this.rendered&&this.contentLeftPlugin.addField(Ext.isObject(field)?field:{name:field})},hasField:function(fieldName){return _.some(this.getFields(),function(field){return Ext.isString(field)&&field===fieldName||field.name===fieldName})},reRender:function(highlight){_.forEach(this.plugins,function(plugin){Ext.isFunction(plugin.detachListeners)&&plugin.detachListeners()}),this.getEl().update(this._buildHtml()),this._displayState(),this.scrollToCard(),this._addListeners(),highlight!==!1&&this.highlight({callback:function(){this.fireEvent("aftercardhighlight",this)},scope:this}),this.fireEvent("rerender",this)},select:function(){this.isSelected()||(this.selected=!0,this.publish(Rally.Message.objectFocus,this.getRecord(),this),this.fireEvent("select",this))},isSelected:function(){return this.selected===!0},deselect:function(){this.isSelected()&&(this.selected=!1,this.fireEvent("deselect",this))},onDestroy:function(){this.isSelected()&&this.deselect(),this.callParent(arguments)},shouldShowReadyBorder:function(){return this.isReady()&&this.showReadyIcon},isReady:function(){var record=this.getRecord();return record.isFieldVisible("Ready")&&record.get("Ready")},shouldShowBlockedBorder:function(){return this.isBlocked()&&this.showBlockedIcon},isBlocked:function(){var record=this.getRecord();return record.isFieldVisible("Blocked")&&!record.isCustomField("Blocked")&&record.get("Blocked")},getDisplayedFields:function(){var fields=[];return _.forEach(this.plugins||[],function(plugin){
Ext.isFunction(plugin.getDisplayedFields)&&Ext.Array.push(fields,plugin.getDisplayedFields())},this),_.unique(fields)},getFieldNames:function(){return _.pluck(this.getFieldDefinitions(),"name")},getFieldDefinitions:function(){return _.map(this.getFields(),function(field){return this._getFieldObject(field)},this)},_getFieldObject:function(field){return Ext.isString(field)?{name:field}:field},_mergeCustomFieldConfig:function(){var fields=this.getFields()||[];this.customFieldConfig&&0!==fields.length&&(_.each(fields,function(field,fieldIndex){field=this._getFieldObject(field);var customFieldConfig=this.customFieldConfig[field.name];customFieldConfig&&(fields[fieldIndex]=Ext.merge(field,customFieldConfig))},this),this.fields=fields)},_displayState:function(){this.removeCls(["blocked","ready"]),this.shouldShowBlockedBorder()&&this.addCls("blocked"),this.shouldShowReadyBorder()&&this.addCls("ready")},_onBeforeRender:function(){this._displayState(),this.html=this._buildHtml()},_buildHtml:function(){var html=[],artifactColorDiv={tag:"div",cls:"artifact-color"};return this.record.get("DisplayColor")&&(artifactColorDiv.style={backgroundColor:this.record.get("DisplayColor")}),html.push(Ext.DomHelper.createHtml(artifactColorDiv)),html.push('<div class="card-table-ct"><table class="card-table"><tr>'),Ext.Array.push(html,_.invoke(_.compact([this.contentLeftPlugin,this.contentRightPlugin]),"getHtml")),html.push("</tr></table>"),this.iconsPlugin&&html.push(this.iconsPlugin.getHtml()),html.push("</div>"),html.join("\n")},afterRender:function(){this._addListeners(),Ext.isIE7&&this.getEl().setStyle("opacity",""),this.callParent(arguments)},scrollToCard:function(){if(this.isSelected()&&!this.cardWithinView()){var window=Ext.isIE||Ext.isGecko?Ext.get(document.documentElement):Ext.getBody();window.scrollTo("top",this.getEl().getY())}},_addListeners:function(){this.getEl().on("click",this.select,this)},cardWithinView:function(){return this.cardAboveBottomOfWindow()&&this.cardBelowTopOfWindow()},cardAboveBottomOfWindow:function(){var cardBottom=this.getEl().getY()+this.getEl().getHeight(),windowBottom=Rally.util.Window.getScrollY()+Rally.util.Window.getHeight();return cardBottom<=windowBottom},cardBelowTopOfWindow:function(){var cardTop=this.getEl().getY(),windowTop=Rally.util.Window.getScrollY();return cardTop>=windowTop},setupPlugins:function(){var plugins=[{ptype:"rallycardpopover"},{ptype:"rallycardblockedreason"},{ptype:"rallycardcontentleft"},{ptype:"rallycardcontentright"}];return this.record.get("updatable")&&(this.editable&&plugins.push({ptype:"rallycardediting"}),plugins.push({ptype:"rallycardicons",showPlusIcon:this.showPlusIcon,showGearIcon:this.showGearIcon,showColorIcon:this.showColorIcon,showReadyIcon:this.showReadyIcon,showBlockedIcon:this.showBlockedIcon,gearMenuConfig:{showEditMenuItem:this.showEditMenuItem,showCopyMenuItem:this.showCopyMenuItem,showAddChildMenuItem:this.showAddChildMenuItem,showRankMenuItems:this.showRankMenuItems,showSplitMenuItem:this.showSplitMenuItem,showDeleteMenuItem:this.showDeleteMenuItem}})),this.showAge>-1&&plugins.push({ptype:"rallycardage"}),_.uniq(plugins,"ptype")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.AttachmentUploader",{mixins:{messageable:Rally.Messageable,observable:Ext.util.Observable},config:{record:void 0},statics:{legacyAttachmentEndpoint:"/slm/ax/uploadAttachment.sp"},constructor:function(config){this.initConfig(config),this.addEvents("uploadprogress","uploaded","failure","recordloaded"),this.mixins.observable.constructor.call(this,config),this.xhr=Ext.Ajax.getXhrInstance(),this.supportsAjaxUploadWithProgress()&&this._initHTML5FileUpload(),this.callParent(arguments)},_initHTML5FileUpload:function(){this.xhr.upload.addEventListener("progress",Ext.bind(this._uploadProgress,this),!1),this.xhr.addEventListener("load",Ext.bind(this._uploadCompleted,this),!1)},uploadAttachment:function(file){var record=this.getRecord(),cpoid=record&&record.get("Project")?Rally.util.Ref.getRefObject(record.get("Project")).getOid():null,requestParam=cpoid?"?cpoid="+cpoid:"",url=this.self.legacyAttachmentEndpoint+requestParam,formData=new FormData;formData.append("file",file),this.xhr.open("POST",url,!0),this.xhr.send(formData)},uploadAttachmentsOldSchool:function(form){var connection=Ext.create("Ext.data.Connection");connection.upload(form,this.self.legacyAttachmentEndpoint,void 0,{success:this._handleResponseOldEndpoint,scope:this})},_handleResponseOldEndpoint:function(response){var text=response.responseXML&&response.responseXML.body?response.responseXML.body.innerHTML:response.responseText;this._handleResponseText(text)},_uploadProgress:function(event){if(event.lengthComputable){var percentComplete=Math.round(100*event.loaded/event.total);this.fireEvent("uploadprogress",percentComplete)}else this.fireEvent("uploadprogress")},_uploadCompleted:function(event){this._handleResponseText(event.target.responseText)},_handleResponseText:function(responseText){var attachmentOid=this._parseAttachmentOidFromResponse(responseText);attachmentOid?(this.fireEvent("uploaded",attachmentOid),this._addAttachmentToRecord(attachmentOid,responseText)):this.fireEvent("failure",this._parseErrorFromResponse(responseText))},_parseAttachmentOidFromResponse:function(html){var matches=html.match(/attachment\.([0-9]+)\.enclosure/);return matches&&matches[1]},_parseFilenameFromResponse:function(html){var matches=html.match(/\"\/slm\/attachment\/\d+\/(.*?)\"/);return matches&&decodeURIComponent(matches[1]).replace(/\+/g," ")},_parseErrorFromResponse:function(html){var response=Ext.JSON.decode(html,!0);return response&&response.success===!1&&response.errors?response.errors.message:"There was an unknown error when uploading your file."},_addAttachmentToRecord:function(attachmentOid,responseText){this._loadAttachmentRecord(attachmentOid)},_loadAttachmentRecord:function(attachmentOid){Rally.data.ModelFactory.getModel({type:"Attachment",success:function(model){model.load(attachmentOid,{success:function(attachmentRecord){this.fireEvent("recordloaded",attachmentRecord)},scope:this})},scope:this})},_buildItemConfig:function(attachmentOid,filename){var record=this.getRecord();return{ObjectID:attachmentOid,Name:filename,Record:record,get:function(property){return this[property]},destroy:function(callback){record.newAttachments=_.without(record.newAttachments,this),callback.success()}}},supportsAjaxUploadWithProgress:function(){return this._supportsAjaxUploadProgressEvents()&&this._supportsFileAPI()},_supportsFileAPI:function(){var fileInput=document.createElement("input");return fileInput.type="file","files"in fileInput},_supportsAjaxUploadProgressEvents:function(){return!!(this.xhr&&"upload"in this.xhr&&"onprogress"in this.xhr.upload)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.DownloadMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemdownload",config:{text:"Download"},constructor:function(config){config.handler=config.handler||this._onDownloadClicked,this.initConfig(config),this.callParent(arguments)},_getWindow:function(){return window},_onDownloadClicked:function(){var oid=this.record.get("ObjectID"),filename=this.record.get("Name"),w=this._getWindow();w.location.href="/slm/attachment/"+oid+"/"+filename}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.DragAndDropZone",{constructor:function(config){this.callParent(arguments),this._dragZoneElement=config.dragZoneElement,this._dropZoneElement=config.dropZoneElement,this._isEventTypeValid=config.isEventTypeValid||function(){return!0},this._onDragEnterCallback=config.onDragEnterCallback,this._onDragLeaveCallback=config.onDragLeaveCallback,this._onDropCallback=config.onDropCallback,this._dragCollection=[],this._onDragEnter=Ext.bind(this._onDragEnter,this),this._onDragLeave=Ext.bind(this._onDragLeave,this),this._onDragOver=Ext.bind(this._onDragOver,this),this._onDrop=Ext.bind(this._onDrop,this),this._initEventHandlers()},_initEventHandlers:function(){this._dragZoneElement.addEventListener("dragenter",this._onDragEnter,!0),this._dragZoneElement.addEventListener("dragleave",this._onDragLeave,!0),this._dropZoneElement.addEventListener("dragover",this._onDragOver,!1),this._dropZoneElement.addEventListener("drop",this._onDrop,!0)},_onDragEnter:function(e){this._isEventTypeValid(e)&&(0===this._dragCollection.length&&(e.stopPropagation(),e.preventDefault(),this._onDragEnterCallback(e)),_.contains(this._dragCollection,e.target)||this._dragCollection.push(e.target))},_onDragLeave:function(e){this._isEventTypeValid(e)&&(_.remove(this._dragCollection,function(val){return val===e.target}),0===this._dragCollection.length&&this._onDragLeaveCallback(e))},_onDragOver:function(e){this._isEventTypeValid(e)&&(e.stopPropagation(),e.preventDefault())},_onDrop:function(e){this._isEventTypeValid(e)&&(this._dragCounter=0,e.stopPropagation(),e.preventDefault(),this._onDropCallback(e))},destroy:function(){this._dragZoneElement.removeEventListener("dragenter",this._onDragEnter),this._dragZoneElement.removeEventListener("dragleave",this._onDragLeave),this._dropZoneElement.removeEventListener("dragover",this._onDragOver),this._dropZoneElement.removeEventListener("drop",this._onDrop)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.AttachmentsField",{alias:"widget.rallydetailattachmentsfield",extend:Ext.container.Container,mixins:{messageable:Rally.Messageable},componentCls:"detail-attachments-field",layout:{type:"vbox",align:"center",pack:"center",defaultMargins:"10 0 10 0"},width:"100%",config:{store:void 0,record:void 0,editable:!0,maskOnDisable:!1,plugins:[],isDestroyed:!1},minHeight:100,initComponent:function(){this.callParent(arguments),this.addEvents("filesselected","filesselectedoldschool","recordloaded"),this.enableBubble(["filesselected","filesselectedoldschool","recordloaded"]),this.subscribe(this,Rally.Message.attachmentAssociated,this._onAttachmentAssociated,this),this.subscribe(this,Rally.Message.attachmentUploadFailed,this._onFailure,this),this.on("destroy",function(){this.isDestroyed=!0},this),this.getStore().model?this._draw():(this.getStore().on("load",this._draw,this,{single:!0}),this.getStore().load()),this.getStore().on("remove",this._redraw,this)},_supportsFileAPI:function(){return!0},onBoxReady:function(){this.getEditable()&&this._supportsFileAPI()&&(this._dragAndDropZone=Ext.create("Rally.ui.detail.DragAndDropZone",{dragZoneElement:Ext.query("body")[0],dropZoneElement:Ext.query(".detail-attachments-field")[0],onDragEnterCallback:Ext.bind(this._onDragEnter,this),onDragLeaveCallback:Ext.bind(this._onDragExit,this),onDropCallback:Ext.bind(this._onDropped,this),isEventTypeValid:function(event){return event.dataTransfer&&_.contains(event.dataTransfer.types,"Files")}})),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.callParent(arguments)},_onAttachmentAssociated:function(){this.unmask(),this._redraw(!0)},_redraw:function(shouldReload){shouldReload?this.getStore().reload({scope:this,callback:this._draw}):this._draw()},_draw:function(){this.isDestroyed||(this.getStore().getCount()>0?(this._drawGrid(),this.removeCls("no-attachments")):(this._hideGrid(),this.addCls("no-attachments")),this.editable&&this._drawDropZone())},_getGearActions:function(record){var actions=[],editable=this.editable;return record.phantom||actions.push({xtype:"rallyrecordmenuitemdownload",record:record}),editable&&actions.push({xtype:"rallyrecordmenuitemdelete",record:record}),actions},_drawGrid:function(){if(this.grid)this.grid.show();else{var grid=Ext.create("Rally.ui.grid.Grid",{itemId:"attachmentsListBody",enableBulkEdit:!0,bulkEditConfig:{showDownload:!0,showRemove:!1},enableEditing:this.editable,componentCls:"attachments-list",showRowActionsColumn:!1,width:"100%",showPagingToolbar:!1,listenForObjectUpdates:!1,columnCfgs:[{xtype:"rallyrowactioncolumn",resizable:!1,rowActionsFn:function(record){return this._getGearActions(record)},scope:this},{xtype:"templatecolumn",resizable:!1,text:"Name",dataIndex:"Name",editor:void 0,width:"30%",tpl:"<a class='attachment-dnld-link' href='/slm/attachment/{ObjectID}/{[encodeURIComponent(values.Name)]}'>{Name}</a>"},{text:"Description",resizable:!1,dataIndex:"Description",width:"40%"},{xtype:"templatecolumn",resizable:!1,text:"When",dataIndex:"CreationDate",width:"20%",tpl:"{_CreatedAt}"}],store:this.getStore()});this.grid=this.insert(0,grid)}},_hideGrid:function(){this.grid&&this.grid.hide()},_drawDropZone:function(){if(!this.footer){var fileInput='<input class="attachment-upload-button" name="file" type="file" multiple/>';Ext.isIE9m&&(fileInput='<input class="attachment-upload-button" name="file" type="file" size="1"/>'),this.footer=this.add({itemId:"attachmentsListDropzone",cls:"attachments-list-dropzone",width:"100%",xtype:"component",renderTpl:['<span class="attachments-upload-section no-attachments">','<span class="icon-upload"></span>','<span class="attachments-upload-label"><span class="hide-for-ie">Drag and Drop Attachments here or </span>','<form class="add-attachment">',fileInput,'<a class="attachments-upload-link">select files <span class="color-for-ie">from your computer</span></a>',"</form>","</span>","</span>"],renderSelectors:{fileUploadButton:".attachment-upload-button"},listeners:{change:{element:"el",delegate:".attachment-upload-button",fn:this._onFileSelected,scope:this},click:{element:"el",delegate:".attachments-upload-link",fn:this._onUploadLinkClicked,scope:this}}})}this.getStore().getCount()>0?this.footer.removeCls("no-attachments"):this.footer.addCls("no-attachments")},_onUploadLinkClicked:function(e){return e.preventDefault(),!1},_onFileSelected:function(event){event.target&&event.target.files?event.target.files.length>0&&(this.mask("Uploading Attachments"),this.fireEvent("filesselected",event.target.files)):(this.mask("Uploading Attachments"),this.fireEvent("filesselectedoldschool",this._getAttachmentFormEl()))},_getAttachmentFormEl:function(){return this.getEl().down(".add-attachment")},_getWindow:function(){return window},_downloadAll:function(){var w=this._getWindow();_.each(this.grid.store.data.items,function(record){var oid=record.get("ObjectID"),filename=record.get("Name");w.open("/slm/attachment/"+oid+"/"+filename)})},_onDragEnter:function(){this.getMaskTarget()&&this.mask("Drop Attachments Here","no-spinner")},_onDragExit:function(){this.getMaskTarget()&&this.unmask()},_onDropped:function(e){this.getMaskTarget()&&(this.unmask(),this.mask("Uploading Attachments")),this.fireEvent("filesselected",e.dataTransfer.files)},_onFailure:function(record,message){this.getMaskTarget()&&this.unmask()},isEmpty:function(){return!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailWebLinkPopover",{extend:Rally.ui.popover.Popover,alias:"widget.rallydetailweblinkpopover",cls:"detailweblinkpopover",config:{record:void 0,field:void 0,delegate:void 0},shouldHidePopoverOnBodyClick:!1,shouldHidePopoverOnIframeClick:!1,header:!1,layout:{type:"vbox",align:"stretch"},initComponent:function(){this.callParent(arguments);var weblink=this.getRecord().get(this.getField().name),labelWidth=34,inputWidth=350;this.labelAndButtonContainer=this.add({xtype:"container",flex:1,layout:"hbox"}),this.labelField=this.labelAndButtonContainer.add({width:inputWidth,xtype:"rallytextfield",fieldLabel:"LABEL:",labelWidth:labelWidth,labelAlign:"right",value:weblink.DisplayString,listeners:{change:{fn:this._fieldsChanged,scope:this}}}),this.cancelButton=this.labelAndButtonContainer.add({width:60,cls:"secondary medium dark",xtype:"rallybutton",text:"Cancel",margin:"0 0 0 10",listeners:{click:{fn:this._cancel,scope:this}}}),this.doneButton=this.labelAndButtonContainer.add({width:60,cls:"primary medium",xtype:"rallybutton",text:"Done",margin:"0 0 0 10",listeners:{click:{fn:this._apply,scope:this}}}),this.linkContainer=this.add({xtype:"container",flex:1,layout:"auto"}),this.linkIdField=this.linkContainer.add({width:inputWidth,xtype:"rallytextfield",fieldLabel:"ID:",labelWidth:labelWidth,labelAlign:"right",value:weblink.LinkID,listeners:{change:{fn:this._fieldsChanged,scope:this}}}),this.on("hide",this._apply,this)},_cancel:function(){this.canceling=!0,this.destroy()},_apply:function(){return this.canceling?void delete this.canceling:(this.getDelegate().fieldChanged({DisplayString:this.labelField.getValue(),LinkID:this.linkIdField.getValue()}),void this.destroy())},_fieldsChanged:function(){var isApplyDisabled=""!==Ext.util.Format.trim(this.labelField.getValue())&&""===Ext.util.Format.trim(this.linkIdField.getValue());this.doneButton.setDisabled(isApplyDisabled)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailWebLinkField",{extend:Ext.container.Container,alias:"widget.rallydetailweblinkfield",bubbleEvents:["select","change","replaceview"],cls:"detail-link-field",config:{record:void 0,field:void 0},layout:{type:"hbox",align:"stretch"},maskOnDisable:!1,initComponent:function(){this.callParent(arguments),this.linkText=this.add({xtype:"component",tpl:'<a href="{url}" target="_blank">{text}</a>',height:29,padding:"0 8 0 8",cls:"ellipses",flex:1}),this._shouldOpenInNewPage(this.getField())||this.linkText.addListener({el:{click:this._openPageInIframe,scope:this}}),this._updateLink(),Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(this.getField(),this.getRecord())&&(this.editIcon=this.add({cls:"edit-button",xtype:"component",html:'<span aria-hidden="true" class="picto icon-edit"></span>',width:22})),this.on("afterrender",this._installClickHandler,this)},_installClickHandler:function(){this.getEl().on("click",function(e){e.target.href||this._showPopover()},this)},_shouldOpenInNewPage:function(field){return 0===field.attributeDefinition.DisplayPreference},_openPageInIframe:function(e){this.fireEvent("replaceview",this.linkUrl),e.preventDefault()},_updateLink:function(){var weblink=this.getRecord().get(this.getField().name),url=this.getField().attributeDefinition.URL.replace("${id}",weblink.LinkID);this.linkUrl=url,this.linkText.update({url:url,text:this._getDisplayText(weblink)})},_getDisplayText:function(weblink){return""===Ext.util.Format.trim(weblink.DisplayString||"")?weblink.LinkID:weblink.DisplayString},_showPopover:function(){this.popover&&this.popover.isVisible()||(this.popover=Ext.create("Rally.ui.detail.view.DetailWebLinkPopover",{record:this.getRecord(),field:this.getField(),target:this.getEl(),placement:"bottom",offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:0,y:7},{x:0,y:0}],delegate:this}))},fieldChanged:function(data){var record=this.getRecord(),name=this.getField().name,currentValue=record.get(name);_.isEmpty(currentValue)&&(currentValue={DisplayString:"",LinkID:""}),_.isEqual(currentValue,data)||(record.set(name,data),this._updateLink(),this.fireEvent("change"),this.fireEvent("select"))},getSubmitData:function(){var data={};return data[this.getField().name]=this.getValue(),data},getValue:function(){return this.getRecord().get(this.getField().name)},getName:function(){return this.getField().name},isEmpty:function(){var value=this.getValue();return!value||_.isEmpty(value.LinkID)&&_.isEmpty(value.DisplayString)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailNumberField",{extend:Rally.ui.NumberField,alias:"widget.rallydetailnumberfield",config:{field:void 0},NUMBER_REGEX:/^\d*\.?\d*$/,constructor:function(config){config=Rally.ui.renderer.GridEditorFactory.getDecimalEditorConfig(config.field,config),this.callParent(arguments)},getSubmitValue:function(){return this.rawToValue(this.callParent(arguments))},rawToValue:function(rawValue){return!_.isEmpty(rawValue)&&this.NUMBER_REGEX.test(rawValue)?Number(rawValue):""===rawValue?null:rawValue},getSubmitData:function(){var data={};return data[this.getField().name]=this.getSubmitValue(),data}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.plugins.OnObjectUpdate",{extend:Ext.AbstractPlugin,alias:"plugin.rallydetailonobjectupdate",mixins:{messageable:Rally.Messageable},init:function(component){this.callParent(arguments),this.subscribe(component,Rally.Message.objectUpdate,this._onObjectUpdate,this),this.setCmp(component)},_onObjectUpdate:function(record){var cmp=this.getCmp(),originalRecord=_.isFunction(cmp.getRecord)?cmp.getRecord():cmp.record;!originalRecord.phantom&&this._shouldRespondToObjectUpdate(originalRecord,record)&&_.isFunction(cmp.onObjectUpdate)&&cmp.onObjectUpdate(record)},_objectsMatch:function(record1,record2){return Rally.util.Ref.getRelativeUri(record1.get("_ref"))===Rally.util.Ref.getRelativeUri(record2.get("_ref"))},_shouldRespondToObjectUpdate:function(originalRecord,updatedRecord){return this._objectsMatch(originalRecord,updatedRecord)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.FieldRenderer",{extend:Ext.Component,alias:"widget.rallyfieldrenderer",cls:"fieldRenderer",config:{field:void 0,record:void 0},constructor:function(config){this.initConfig(config),this.renderTpl=Rally.ui.renderer.RendererFactory.getRenderTemplate(this.field),this.renderData=this.record.data,this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.StateField",{extend:Ext.container.Container,alias:"widget.rallydetailstatefield",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],cls:"rally-detail-schedulestate-field",editable:!0,config:{record:void 0,field:void 0},bubbleEvents:["select","change"],maskOnDisable:!1,constructor:function(config){this.initConfig(config),this.fieldName=config.field.name,this._setData(config.record),this._updateEditableState(config.record),this.callParent(arguments)},_setData:function(record){this._type=record.data._type,this.Blocked=record.get("Blocked"),this.Ready=record.get("Ready"),this.ScheduleStatePrefix=record.get("ScheduleStatePrefix"),this.isDirty=!1,this[this.fieldName]=record.get(this.fieldName),this.comboBox&&this.comboBox.setValue(record.get(this.fieldName))},getValue:function(){return this.comboBox.getValue()},setValue:function(value){this.comboBox.setValue(value)},getSubmitData:function(){var data={};return data[this.fieldName]=this.getValue(),data},isEmpty:function(){return!1},initComponent:function(){var field=this.getField();this.on("afterrender",this._onAfterRender,this),this.callParent(arguments),this.meter=this._getMeter(),this._updateClickListener(),this.comboBox=Ext.create("Rally.ui.combobox.FieldValueComboBox",{name:field.name,value:this.getRecord().get(this.fieldName),field:field,style:{display:"none"},cls:"rally-schedulestate-combo",bubbleEvents:["select","load"],allowInitialValue:!0,listeners:{blur:this._onComboBoxBlur,load:this._onComboBoxStoreLoad,scope:this}}),this.comboBox.store.getCount()?this._onComboBoxStoreLoad():this.comboBox.store.on("load",this._onComboBoxStoreLoad,this),this.comboBox.on("change",this._onComboBoxChange,this),this.add([this.meter,this.comboBox]),this.subscribe(Rally.Message.objectWillUpdate,this._recordBeganUpdating,this),this.on("destroy",this._onDestroy,this)},_recordBeganUpdating:function(){this._recordIsUpdating=!0},_onDestroy:function(){this.tooltip&&this.tooltip.destroy(),this.comboBox&&this.comboBox.destroy()},_onAfterRender:function(){this.tooltip=Ext.create("Rally.ui.tooltip.StateToolTip",{target:this.getEl(),listeners:{beforeshow:function(tooltip){tooltip.update(this._getTooltip(Ext.get(tooltip.triggerElement)))},scope:this}})},_getTooltip:function(triggerEl){var stateValue=triggerEl.getAttribute("state-data");return triggerEl.hasCls("current-state")||this.hasCls("readonly")?stateValue:"Move to "+stateValue},_onComboBoxChange:function(combo,newValue,oldValue,eOpts){this[this.fieldName]=newValue,this._updateMeter(),this.fireEvent("change",this,newValue,oldValue,eOpts)},_onComboBoxBlur:function(){this._showHideWithoutLayout(this.meter,this.comboBox)},_onComboBoxStoreLoad:function(){Ext.isEmpty(this[this.fieldName])&&(this[this.fieldName]=this.comboBox.getValue()),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_getMeter:function(){return Ext.create("Ext.Component",{renderTpl:Ext.create("Rally.ui.detail.view.DetailScheduleStateTemplate",{field:this.getField()}),renderData:this,cls:"rally-detail-schedulestate-meter"})},_updateClickListener:function(){var listener={click:this._onMeterClick,element:"el",scope:this};this.editable?(this.meter.on(listener),this.meter.addCls("editable"),this.removeCls("readonly")):(this.meter.un(listener),this.meter.removeCls("editable"),this.addCls("readonly"))},_updateEditableState:function(record){this.editable=!this._hasChildren(record)&&Rally.ui.detail.EditModeContext.isPageEditable(record)},_hasChildren:function(record){return record.get("Children")&&record.get("Children").Count>0},_onMeterClick:function(e,target){if(this.isDirty=!0,this._recordIsUpdating)return void(this._pendingSave=function(){this._onMeterClick(e,target)});var targetEl=Ext.get(target),value=targetEl.getAttribute("state-data");targetEl.hasCls("clickable-state")&&value?(this.comboBox.setValue(value),this.comboBox.fireEvent("select",this.comboBox,value)):(this._showHideWithoutLayout(this.comboBox,this.meter),this.comboBox.expand(),this.comboBox.focus())},onObjectUpdate:function(updatedRecord){this._recordIsUpdating=!1,this._pendingSave&&(this._pendingSave(),delete this._pendingSave),this._setData(updatedRecord),this._updateEditableState(updatedRecord),this._updateMeter(),this._updateClickListener(),this._showHideWithoutLayout(this.meter,this.comboBox)},_showHideWithoutLayout:function(toShow,toHide){toShow.getEl().setStyle("display","block"),toHide.getEl().setStyle("display","none")},_updateMeter:function(){if(this.meter&&this.meter.getEl()){var html=this.meter.renderTpl.renderStates(this,this.getField().getAllowedStringValues()),el=this.meter.getEl().down(".schedule-state-wrapper");el.setHTML(html),this._showHideWithoutLayout(this.meter,this.comboBox)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailReadOnlyRefreshingField",{extend:Ext.AbstractPlugin,alias:"plugin.rallydetailreadonlyrefreshingfield",mixins:{messageable:Rally.Messageable},init:function(component){this.subscribe(component,Rally.Message.objectUpdate,this._refresh,component)},_refresh:function(record){this.setValue(record.get(this.getName()))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.ReadyButton",{extend:Rally.ui.Button,alias:"widget.rallyreadybutton",cls:"detail-ready-button",iconCls:"icon-ready",pressedCls:"ready",enableToggle:!0,onRender:function(){this.isDisabled()||this.setToolTipText(this.pressed?"Not Ready":"Ready"),this.callParent()},toggleHandler:function(button,state){button.setToolTipText(state?"Not Ready":"Ready")},isEmpty:function(){return!1},getValue:function(){return this.pressed},getSubmitData:function(){return{Ready:this.getValue()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.progressbar.ProgressBarTemplate",{requires:[],extend:Ext.XTemplate,width:"100%",height:"20px",percentDoneName:"percentDone",showDangerNotificationFn:function(){return!1},calculateColorFn:Ext.emptyFn,isClickable:!1,showOnlyIfInProgress:!1,generateLabelTextFn:function(recordData){return this.calculatePercent(recordData)+"%"},config:{shouldShowPercentDone:function(recordData){var value=recordData[this.percentDoneName];return _.isString(value)&&(value=+value),!!Ext.isNumber(value)&&(!this.showOnlyIfInProgress||value>0)},getContainerClass:function(recordData){return recordData&&recordData.FormattedID?recordData.FormattedID+"-"+this.percentDoneName:""},getClickableClass:function(){return this.isClickable?"clickable":""},getDimensionStyle:function(){return"width: "+this.width+"; height: "+this.height+"; line-height: "+this.height+";display: inline-block"},calculateWidth:function(recordData){var percentDone=this.calculatePercent(recordData);return percentDone>100?"100%":percentDone+"%"},calculatePercent:function(recordData){var percentDone=recordData[this.percentDoneName];return Math.round(100*percentDone)}},constructor:function(config){var templateConfig=config&&config.template||['<tpl if="this.shouldShowPercentDone(values)">','<div class="progress-bar-container field-{[this.percentDoneName]} {[this.getClickableClass()]} {[this.getContainerClass(values)]}" style="{[this.getDimensionStyle()]}">','<div class="rly-progress-bar" style="background-color: {[this.calculateColorFn(values)]}; width: {[this.calculateWidth(values)]}; "></div>','<tpl if="this.showDangerNotificationFn(values)">','<div class="progress-bar-danger-notification"></div>',"</tpl>",'<div class="progress-bar-label">',"{[this.generateLabelTextFn(values)]}","</div>","</div>","</tpl>"];return templateConfig.push(this.config),templateConfig.push(config),this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate",{extend:Rally.ui.renderer.template.progressbar.ProgressBarTemplate,config:{calculateColorFn:function(recordData){var colorObject=Rally.util.HealthColorCalculator.calculateHealthColorForPortfolioItemData(recordData,this.percentDoneName);return colorObject.hex},isClickable:!0},constructor:function(config){return this.initConfig(config),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.progressbar.PercentDoneByStoryCountTemplate",{requires:[],extend:Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate,config:{height:"15px",percentDoneName:"PercentDoneByStoryCount",showDangerNotificationFn:function(recordData){return!recordData.PlannedEndDate&&!recordData.ActualEndDate},showOnlyIfInProgress:!1},constructor:function(config){return this.initConfig(config),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.progressbar.PercentDoneByStoryPlanEstimateTemplate",{requires:[],extend:Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate,config:{height:"15px",percentDoneName:"PercentDoneByStoryPlanEstimate",showDangerNotificationFn:function(recordData){return!recordData.PlannedEndDate&&!recordData.ActualEndDate||recordData.UnEstimatedLeafStoryCount>0},showOnlyIfInProgress:!1},constructor:function(config){return this.initConfig(config),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.MilestonesField",{extend:Ext.container.Container,alias:"widget.rallydetailmilestonesfield",mixins:{messageable:Rally.Messageable},cls:"rally-detail-milestones-field",editable:!0,config:{record:void 0,field:void 0},readOnly:!1,maskOnDisable:!1,constructor:function(config){config.readOnly||(this.plugins=["rallydetailonobjectupdate"]),this.callParent(arguments)},getSavedIndicatorTarget:function(){return this.picker},isEmpty:function(){return!1},initComponent:function(){this.callParent(arguments);var recordProject=this.record.get("Project"),contextProject=Rally.environment.getContext().getProject(),projectRef=Rally.util.Ref.getRefUri(recordProject)||Rally.util.Ref.getRefUri(contextProject);this.readOnly||(this.picker=Ext.create("Rally.ui.picker.MilestonePicker",{currentProject:projectRef,hideTrigger:!0,matchFieldWidth:!1,showSearchIcon:!0,showCloseButton:!0,value:this.record.get("Milestones"),emptyText:"",submitValue:!1}),this.add(this.picker),this.picker.on("blur",this._onPickerBlur,this)),this._value=this._getValueFromRecord(this.record),this.viewer=Ext.create("Ext.Component",{data:this.record.data,tpl:Ext.create("Rally.ui.renderer.template.PillTemplate",{collectionName:"Milestones",iconCls:"icon-milestone",cls:"milestone-pill"})}),this.add(this.viewer)},onBoxReady:function(){this.viewer.update(this.record.data)},getSubmitData:function(){return{Milestones:this.getValue()}},getValue:function(){
return this._value},_onPickerBlur:function(){var pickerValues=this.picker.getValue();this.viewer.update(this._buildMilestoneValues(pickerValues)),this._value=_.map(pickerValues,function(value){return{_ref:value.data._ref}}),this.picker.resetOriginalValue(),this.fireEvent("blur",{field:this.field,scope:this})},_buildMilestoneValues:function(pickerValues){var objs=_.reduce(pickerValues,function(result,milestone){return result.concat(milestone)},[],this);return{Milestones:objs}},onObjectUpdate:function(updatedRecord){this.picker.resetOriginalValue(),this.picker.isExpanded&&this.picker.blur(),this.picker.setValue(updatedRecord.get("Milestones")),this.viewer.update(updatedRecord.data),this._value=this._getValueFromRecord(updatedRecord)},_getValueFromRecord:function(record){return _.map(record.get("Milestones")._tagsNameArray,function(value){return{_ref:value._ref}})}})}(),function(){function constrainedComboBox(field,record,config){return Ext.widget(Ext.apply({xtype:"rallyfieldvaluecombobox",name:field.name,value:record.get(field.name),field:field,editable:!1,allowNoEntry:defaultAllowNoEntry(field,record),useNullForNoEntryValue:!0,allowInitialValue:!record.phantom,plugins:[{xclass:"Rally.ui.detail.plugins.LoadingMonitor"}]},config))}function milestoneField(field,record,readOnly){return Ext.create("Rally.ui.detail.view.MilestonesField",{field:field,record:record,readOnly:readOnly})}function buildTimeboxFilter(timebox){var filter=Ext.create("Rally.data.wsapi.Filter",{property:"State",operator:"!=",value:"Accepted"});return timebox&&_.isString(timebox._refObjectName)&&(filter=filter.or(Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"=",value:timebox._refObjectName}))),filter}function buildNameEditor(field,record){var placeholder=record.self.displayName+" Name";return Ext.create("Rally.ui.detail.SimpleTextDetailField",{name:field.name,value:record.get(field.name),placeholder:placeholder,indicatorFoldUnder:!0,clientMetrics:{event:"blur",description:"field blur"}})}function buildNameRenderer(field,record){return Ext.create("Ext.form.field.Display",{name:field.name,value:record.get(field.name),cls:"edp-name-renderer"})}var Ext=window.Ext4||window.Ext,userSearchComboBox=function(field,record){var project=Rally.data.util.Record.getProject(record),currentUser=record.get(field.name);return _.isObject(currentUser)&&(currentUser=currentUser._ref),Ext.create("Rally.ui.combobox.UserSearchComboBox",{project:project,name:field.name,value:currentUser,bubbleEvents:["select"],triggerWrapCls:"fullwidth",plugins:[{xclass:"Rally.ui.detail.plugins.LoadingMonitor"}]})},buildNumberField=function(field,record){return Ext.create("Rally.ui.detail.view.DetailNumberField",{name:field.name,displayName:field.displayName,value:record.get(field.name),field:field,hideTrigger:!0,clientMetrics:{event:"blur",description:"field blur"}})},buildAttachmentsField=function(field,record,config){return Ext.create("Rally.ui.detail.view.AttachmentsField",_.merge({field:field,record:record,store:Rally.ui.detail.DetailHelper.getController()?Rally.ui.detail.DetailHelper.getController().getAttachmentsStore():null,editable:Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record),clientMetrics:{event:"blur",description:"field blur"}},config))},buildPercentDoneBy=function(percentDoneTemplateName,field,record){var tpl=Ext.create(percentDoneTemplateName);return Ext.create("Ext.Component",{data:record.data,tpl:tpl,maskOnDisable:!1,cls:"percent-done",listeners:{afterrender:function(){var el=this.getEl();el.on("click",function(){Ext.create("Rally.ui.popover.PercentDonePopover",{target:el,percentDoneData:Ext.applyIf({Notes:"",Release:record.get("Release")||{},PortfolioItemTypeOrdinal:record.self.ordinal},record.data),percentDoneName:field.name})})}}})},buildDisplayColorField=function(field,record){return Ext.create("Rally.ui.detail.view.DisplayColorField",{field:field,record:record,editable:Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)})},buildStateField=function(field,record){return Ext.create("Rally.ui.detail.view.StateField",{field:field,record:record})},buildTargetProjectEditor=function(field,record){var project=record.get(field.name);return record.phantom&&!project&&(project=Rally.environment.getContext().getProject()),Ext.create("Rally.ui.detail.view.TargetProjectField",{name:field.name,milestoneRecord:record,value:Rally.util.Ref.getRelativeUri(project),editable:Rally.ui.MilestoneTargetProjectPermissionsHelper.canEdit(record)})},defaultAllowNoEntry=function(field,record){return!field.required||!record.get(field.name)};Ext.define("Rally.ui.detail.view.DetailEditorFactory",{singleton:!0,getEditor:function(field,record,config){var editor;return editor=_.isFunction(field.isMultiValueCustom)&&field.isMultiValueCustom()?this.getMultiValueCustomFieldEditor(field,record,config):this.fieldEditors[field.name]?this.fieldEditors[field.name](field,record,config):field.attributeDefinition&&this.typeEditors[field.attributeDefinition.AttributeType.toLowerCase()]?this.getEditorByType(field,record,config):this.defaultRenderer(field,record,config),editor.disabledCls+=" readonly",Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)||(editor.editable=!1,editor.setDisabled(!0)),editor.addCls("detailFieldEditor"),editor},getMultiValueCustomFieldEditor:function(field,record,config){return config=_.merge(config?_.clone(config):{},{field:field,record:record,readOnly:!Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)}),Ext.create("Rally.ui.detail.view.MultiValueField",config)},getEditorByType:function(field,record){return this.typeEditors[field.attributeDefinition.AttributeType.toLowerCase()](field,record)},defaultRenderer:function(field,record){return Ext.create("Rally.ui.TextField",{name:field.name,value:record.get(field.name)})},fieldEditors:{Actuals:buildNumberField,Attachments:buildAttachmentsField,DisplayColor:buildDisplayColorField,Estimate:buildNumberField,Name:function(field,record){return Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)?buildNameEditor(field,record):buildNameRenderer(field,record)},Iteration:function(field,record){var currentIteration=record.get(field.name);return Ext.create("Rally.ui.combobox.IterationComboBox",{name:field.name,value:currentIteration,allowNoEntry:defaultAllowNoEntry(field,record),showArrows:!1,defaultSelectionToFirst:!0,defaultToCurrentTimebox:!1,width:210,emptyText:"Loading...",storeConfig:{remoteFilter:!0,filters:[buildTimeboxFilter(currentIteration)],context:{project:Rally.data.util.Record.getProject(record),projectScopeUp:!1,projectScopeDown:!1}},plugins:[{xclass:"Rally.ui.detail.plugins.LoadingMonitor"}]})},Milestones:function(field,record){var readOnly=!Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record);return milestoneField(field,record,readOnly)},Owner:function(field,record){return userSearchComboBox(field,record)},LastVerdict:function(field,record){return Ext.create("Ext.Component",{data:record.data,maskOnDisable:!1,style:{border:0},tpl:["{[this.getValue(values)]}",{getValue:function(recordData){var passing=recordData.PassingTestCaseCount,total=recordData.TestCaseCount;return _.isNumber(total)?"Pass: "+passing+"/"+total:recordData[field.name]}}]})},PercentDoneByStoryPlanEstimate:function(field,record){return buildPercentDoneBy("Rally.ui.renderer.template.progressbar.PercentDoneByStoryPlanEstimateTemplate",field,record)},PercentDoneByStoryCount:function(field,record){return buildPercentDoneBy("Rally.ui.renderer.template.progressbar.PercentDoneByStoryCountTemplate",field,record)},PlanEstimate:buildNumberField,PreliminaryEstimate:function(field,record){return constrainedComboBox(field,record)},Projects:function(field,record,config){var options={field:field,record:record};return config&&Ext.applyIf(options,config),Ext.create("Rally.ui.detail.view.ProjectsField",options)},Project:function(field,record){var project=record.get(field.name);record.phantom&&!project&&(project=Rally.environment.getContext().getProject());var onlyShowEditableProjects=!0;return Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)||(onlyShowEditableProjects=!1),Ext.create("Rally.ui.combobox.ProjectComboBox",{name:field.name,value:Rally.util.Ref.getRelativeUri(project),onlyShowEditableProjects:onlyShowEditableProjects,validateOnChange:!0})},Rank:buildNumberField,Ready:function(field,record){return Ext.create("Rally.ui.detail.view.ReadyButton",{itemId:"readyButton",pressed:record.get("Ready")})},Release:function(field,record){var currentRelease=record.get(field.name);return Ext.create("Rally.ui.combobox.ReleaseComboBox",{name:field.name,value:currentRelease,allowNoEntry:defaultAllowNoEntry(field,record),showArrows:!1,defaultSelectionPosition:"first",defaultToCurrentTimebox:!1,width:210,emptyText:"Loading...",storeConfig:{remoteFilter:!0,filters:[buildTimeboxFilter(currentRelease)],context:{project:Rally.data.util.Record.getProject(record),projectScopeUp:!1,projectScopeDown:!1}},plugins:[{xclass:"Rally.ui.detail.plugins.LoadingMonitor"}]})},ScheduleState:buildStateField,State:function(field,record){return record.isPortfolioItem()?constrainedComboBox(field,record):record.isDefect()?constrainedComboBox(field,record):record.isTask()?buildStateField(field,record):Rally.ui.detail.view.DetailEditorFactory.getEditorByType(field,record)},SubmittedBy:function(field,record){return userSearchComboBox(field,record)},TargetProject:buildTargetProjectEditor,ToDo:buildNumberField},typeEditors:{boolean:function(field,record){var choices=Ext.create("Ext.data.Store",{fields:["value","display"],data:[{value:!0,display:"Yes"},{value:!1,display:"No"}]});return Ext.create("Rally.ui.combobox.ComboBox",{name:field.name,store:choices,queryMode:"local",displayField:"display",valueField:"value",value:record.get(field.name),defaultSelectionPosition:"last"})},date:function(field,record){var plugins=[];_.contains(["CreationDate","OpenedDate","ClosedDate"],field.name)&&plugins.push("rallydetailreadonlyrefreshingfield");var value=record.get(field.name);return Rally.environment.useWorkspaceTimeZone&&Ext.isDate(value)&&(value=Rally.util.DateTime.convertForEditing(value)),Ext.create("Rally.ui.DateField",{format:Rally.util.DateTime.getUserExtDateFormat(),validateOnChange:!1,name:field.name,value:value,clientMetrics:{event:"select",description:"field select"},plugins:plugins})},decimal:function(field,record){return Ext.create("Rally.ui.detail.view.DetailNumberField",{name:field.name,value:record.get(field.name),field:field,keyNavEnabled:!1,mouseWheelEnabled:!1,fieldStyle:"border-right-width: 1px; background-color: light-green;",clientMetrics:{event:"blur",description:"field blur"}})},integer:function(field,record){return Ext.create("Rally.ui.detail.view.DetailNumberField",{name:field.name,value:record.get(field.name),field:field,clientMetrics:{event:"blur",description:"field blur"}})},object:function(field,record){return field.attributeDefinition.Constrained?Ext.create("Rally.ui.combobox.ComboBox",{name:field.name,value:record.get(field.name),editable:!1,storeConfig:{autoLoad:!0,model:field.attributeDefinition.SchemaType,initialValue:record.get(field.name)?record.get(field.name)._refObjectName:""},allowNoEntry:defaultAllowNoEntry(field,record)}):Ext.create("Rally.ui.TextField",{name:field.name,value:record.get(field.name),clientMetrics:{event:"blur",description:"field blur"}})},quantity:function(field,record){return Ext.create("Rally.ui.detail.view.DetailNumberField",{name:field.name,value:record.get(field.name),field:field,hideTrigger:!0,keyNavEnabled:!1,mouseWheelEnabled:!1,fieldStyle:"border-right-width: 1px; background-color: light-blue;",clientMetrics:{event:"blur",description:"field blur"}})},rating:function(field,record){return field.attributeDefinition.Constrained?constrainedComboBox(field,record,{allowNoEntry:!field.required||"None"===record.get(field.name),ratingNoEntryString:"-- No Entry --",noEntryValue:"None",useNullForNoEntryValue:!1}):Ext.create("Rally.ui.TextField",{name:field.name,value:record.get(field.name),clientMetrics:{event:"blur",description:"field blur"}})},string:function(field,record){return field.attributeDefinition.Constrained?constrainedComboBox(field,record):Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record)?Ext.create("Rally.ui.TextField",{name:field.name,value:record.get(field.name),width:"100%",clientMetrics:{event:"blur",description:"field blur"}}):Ext.create("Ext.Component",{cls:"detail-link-field ellipses",height:31,marginTop:0,width:"100%",padding:"0 8 0 8",opacity:1,html:record.get(field.name),maskOnDisable:!1})},text:function(field,record){var editor,isEditable=Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(field,record);return editor=isEditable?Ext.create("Rally.ui.richtext.RichTextEditor",{controller:Rally.ui.detail.DetailHelper.getController(),field:field,record:record,name:field.name,value:record.get(field.name),growToFitContent:!0,allowImageUpload:!0,toolbarAlwaysEnabled:!1,showUndoButton:!0,disableUndoButtonWithToolbar:!1,indicatorFoldUnder:!0,clientMetrics:{event:"blur",description:"field blur"},useLinkBubble:!0,listeners:{focus:function(){var focusedField=Ext.ComponentQuery.query("rallydetailfieldcontaineredpcomplete[focused=true]")[0];if(focusedField){var editor=focusedField.editor;editor!==this&&(focusedField.clearSelection(),editor.hasFocus=!1,editor.fireEvent("blur"),editor.collapse&&editor.collapse())}},blur:function(){var fields=Ext.ComponentQuery.query("rallydetailfieldcontaineredpcomplete"),previouslyFocusedField=_.find(fields,function(field){if(field.editor)return field.editor.hasFocus},this);previouslyFocusedField&&previouslyFocusedField.focusField()},imageuploaded:function(imageInfo){var controller=Rally.ui.detail.DetailHelper.getController();controller&&controller._handleImageUpload(imageInfo)}}}):Ext.create("Rally.ui.richtext.RichTextEditorReadOnly",{html:record.get(field.name)}),Rally.ui.detail.DetailHelper.getController()&&Rally.ui.detail.DetailHelper.getController().on("recordupdate",function(record){editor.setValue(record.get(field.name))}),editor},web_link:function(field,record){return Ext.create("Rally.ui.detail.view.DetailWebLinkField",{field:field,record:record})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailRendererFactory",{singleton:!0,getRenderTemplate:function(field,record){var renderer=null;return renderer=this.fieldRenderers[field.name]?this.fieldRenderers[field.name](field,record):field.attributeDefinition&&this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()]?this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()](field,record):Rally.ui.renderer.RendererFactory.getRenderTemplate(field)},fieldRenderers:{State:function(field,record){return record.self.isPortfolioItem()?Rally.ui.renderer.RendererFactory.getRenderTemplate(field):Ext.create("Rally.ui.renderer.template.ScheduleStateTemplate",{field:field})}},typeRenderers:{boolean:function(field,record){return Ext.create("Rally.ui.renderer.template.BooleanYesNoTemplate",{fieldName:field.name})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.field.ClickToEditFieldContainer",{extend:Ext.container.Container,alias:"widget.rallyclicktoeditfieldcontainer",cls:"detailFieldContainer",config:{record:void 0,field:void 0,editMode:!1,clickToEdit:!1,cancelOnEsc:!0,completeOnEnter:!0},fieldName:void 0,singleEdit:!1,bubbleEvents:["fieldupdated","fieldchanged","beforefieldedit","tabbed"],constructor:function(config){this.initConfig(config),this.callParent(arguments),this.fieldName=this.getField().name},initComponent:function(){this.addEvents("fieldupdated","beforefieldedit","tabbed","afterdraw"),this.callParent(arguments),this.addCls(this._getFieldDescriptorCls()),this.getClickToEdit()&&this._isFieldEditable()&&this.addCls("editableField"),this._isFieldEditable()||this.addCls("readonly"),this._isFieldRequired()&&this.addCls("requiredField"),this.addCls(this._getEditorTypeClass()),this.draw(),this.on("afterrender",this._onAfterRender,this)},_onTabDown:function(){this.fireEvent("tabbed",this)},_onAfterRender:function(){this.getClickToEdit()&&this.getEl().on("click",this.goToEditMode,this)},draw:function(){this.beforeDraw(),this._drawField(),this.afterDraw()},getValue:function(){return this.getRecord().get(this.fieldName)},beforeDraw:function(){},afterDraw:function(){this.fireEvent("afterdraw",this.getEditMode())},_drawField:function(){this.removeCls("viewMode").removeCls("editMode"),this.getEditMode()&&this._isFieldEditable()?(this.addCls("editMode"),this._drawEditMode()):(this.addCls("viewMode"),this._drawViewMode())},_getFieldDescriptorCls:function(){return"detailField-"+this.getField().name.toLowerCase()},_drawViewMode:function(){this.add({xtype:"component",cls:"fieldContainerView",itemId:"field-view",html:Rally.ui.detail.view.DetailRendererFactory.getRenderTemplate(this.getField(),this.getRecord()).apply(this.getRecord().data)})},_drawEditMode:function(){this.editor=Rally.ui.detail.view.DetailEditorFactory.getEditor(this.getField(),this.getRecord()),Ext.isString(this.editor)?this.add({xtype:"component",html:this.editor}):(this.add(this.editor),this._wireEditorEvents(),this.singleEdit&&this.editor.focus())},_wireEditorEvents:function(){this.editor.on("select",this._fireFieldChanged,this),this.editor.on("blur",this._fireFieldChanged,this),this.singleEdit&&(this.editor.getEl()&&(this.cancelOnEsc||this.completeOnEnter)&&(this.editor.getEl().on("keyup",function(event){event.getKey()===Ext.EventObject.ESC&&this.cancelOnEsc?this.refresh(this.record):event.getKey()===Ext.EventObject.ENTER&&this.completeOnEnter&&this._fireFieldUpdated()},this),this.editor.getEl().on("keydown",function(event){event.getKey()===Ext.EventObject.TAB&&(this._fireFieldUpdated(),this._onTabDown())},this)),this.getRecord().phantom||(this.editor.on("select",this._fireFieldUpdated,this),this.editor.on("blur",this._fireFieldUpdated,this)))},_fireFieldUpdated:function(){this.fieldUpdatedEventAlreadyFired||this._shouldSuppressFieldUpdatedEvent()||(this.fieldUpdatedEventAlreadyFired=!0,this.fireEvent("fieldupdated",{field:this.editor||this,success:this.refresh,failure:function(){this.fieldUpdatedEventAlreadyFired=!1},scope:this}))},_fireFieldChanged:function(){this.getRecord().set(this.editor.getSubmitData()),this.fireEvent("fieldchanged")},_shouldSuppressFieldUpdatedEvent:function(){return this.editor&&this.editor.closureEditor&&this.editor.closureEditor.inModalMode()},refresh:function(record){this.fieldUpdatedEventAlreadyFired=!1,this.record=record,Ext.defer(function(){this.goToViewMode()},1,this)},goToViewMode:function(){this.singleEdit=!1,this._clearSelection(),this.setEditMode(!1),this.removeAll(),delete this.editor,this.draw()},goToEditMode:function(){!this.getEditMode()&&this._isFieldEditable()&&(this._clearSelection(),this.fireEvent("beforefieldedit",this),this.setEditMode(!0),this.singleEdit=!0,this.removeAll(),this.draw())},_clearSelection:function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var sel=window.getSelection();sel.removeAllRanges()}},_isFieldEditable:function(){return Rally.ui.detail.DetailHelper.isFieldEditable(this.getField(),this.getRecord())},_isFieldRequired:function(){return Rally.ui.detail.DetailHelper.isFieldRequired(this.getField(),this.getRecord())},_getEditorTypeClass:function(){var editor=Rally.ui.detail.view.DetailEditorFactory.getEditor(this.getField(),this.getRecord());return editor&&!Ext.isString(editor)?this._getEditorClassFromXType(editor.getXType()):""},_getEditorClassFromXType:function(xtype){var editorClass="";return xtype.indexOf("combobox")!==-1?editorClass="combobox":xtype.indexOf("numberfield")===-1&&xtype.indexOf("textfield")===-1&&xtype.indexOf("texteditor")===-1||(editorClass="textfield"),editorClass},getActiveEditorInputId:function(){return this.editor.inputField.id},getActiveEditor:function(){return this.editor}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.ColumnHeader",{extend:Ext.Container,alias:"widget.rallycardboardcolumnheader",cls:"column-header",items:{xtype:"container",itemId:"headerTitle",cls:"column-header-title"},config:{editable:!1,record:void 0,fieldToDisplay:void 0,headerTpl:"",headerData:{}},initComponent:function(){this.callParent(arguments),Ext.isString(this.headerTpl)&&(this.headerTpl=Ext.create("Ext.XTemplate",this.headerTpl))},afterRender:function(){this.callParent(arguments);var _this=this;this.record&&this.fieldToDisplay&&(this.fieldContainer=this.getHeaderTitle().add({xtype:"rallyclicktoeditfieldcontainer",cls:"columnTitle",record:this.record,field:this.record.getField(this.fieldToDisplay),clickToEdit:this.editable,listeners:{fieldupdated:function(options){this.record.set(_this.fieldToDisplay,options.field.getSubmitData()[_this.fieldToDisplay]),this.record.save(options)}}})),this.getHeaderTitle().add({xtype:"container",cls:"columnTpl",html:this.headerTpl.apply(this.headerData)})},getHeaderValue:function(){return this.record&&this.fieldToDisplay?this.record.get(this.fieldToDisplay):this.headerTpl.apply(this.headerData)},getHeaderTitle:function(){return this.down("#headerTitle")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.LSCacheProvider",{extend:Ext.state.Provider,namespace:"",timeout:20,constructor:function(config){Ext.apply(this,config),this.callParent(arguments)},get:function(key,defaultValue){lscache.setBucket(this.namespace);var val=lscache.get(key);return Ext.isDefined(val)?val:defaultValue},set:function(key,value){namespace=this.namespace,timeout=this.timeout,lscache.setBucket(namespace),lscache.set(key,value,timeout),this.fireEvent("statechange",this,key,value)},clear:function(key){lscache.setBucket(this.namespace),lscache.remove(key),this.fireEvent("statechange",this,key,null)},clearAll:function(){lscache.setBucket(this.namespace),lscache.flush(),this.fireEvent("statechange",this,null,null)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.RecordValueStorage",{stateProvider:null,enableCache:!0,versionProperty:"VersionId",constructor:function(config){Ext.apply(this,config),this._canUseCache()&&!this.stateProvider&&(this.stateProvider=Ext.create("Rally.state.LSCacheProvider",{namespace:"recordValueStorage",timeout:null}))},getValue:function(record,key){if(this._canUseCache()){var cacheKey=this._getCacheKey(record,key);return this.stateProvider.get(cacheKey,void 0)}},setValue:function(record,key,value){this._canUseCache()&&!Ext.isEmpty(value)&&(this._clearOldVersions(record,key),this.stateProvider.set(this._getCacheKey(record,key),Ext.encode(value)))},clearValue:function(record,key,version){this._canUseCache()&&this.stateProvider.clear(this._getCacheKey(record,key,version))},_clearOldVersions:function(record,key){for(var objectVersion=this._getObjectVersion(record),i=0;i<objectVersion;i++)this.clearValue(record,key,i)},_getObjectVersion:function(record){return record.get(this.versionProperty)||"0"},_getCacheKey:function(record,key,version){return[record.getId().toString(),version?version.toString():this._getObjectVersion(record),key].join(":")},_canUseCache:function(){return this.enableCache&&"undefined"!=typeof window.localStorage}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.calculator.FieldCalculator",{mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},fieldName:null,calculator:null,fieldCache:"Rally.state.RecordValueStorage",constructor:function(config){Ext.apply(this,config),Ext.isString(this.fieldCache)&&(this.fieldCache=Ext.create(this.fieldCache))},calculate:function(records){var deferred=new Deft.Deferred,fieldCache=this.fieldCache,fieldName=this.fieldName,completeRecords=[],incompleteRecords=[],startTime=(new Date).getTime();return _.forEach(records||[],function(record){var value=fieldCache.getValue(record,fieldName);Ext.isEmpty(value)?incompleteRecords.push(record):(record.set(fieldName,value),completeRecords.push(record))}),this._reportCacheMetrics(completeRecords.length,incompleteRecords.length,startTime),0===incompleteRecords.length?deferred.resolve({records:records,calculatedRecords:[]}):this.calculator.call(this,incompleteRecords).then({success:function(){this._valuesCalculated(incompleteRecords),deferred.resolve({records:records,calculatedRecords:incompleteRecords})},scope:this}),deferred.promise.always(function(){this.recordLoadEnd()},this),deferred.promise},_reportCacheMetrics:function(hits,misses,startTime){if(hits||misses){var metrics={fieldName:this.fieldName,hits:hits,misses:misses};this.recordLoadBegin({description:"field cache",startTime:startTime,miscData:metrics})}},_valuesCalculated:function(incompleteRecords){var fieldCache=this.fieldCache,fieldName=this.fieldName;_.forEach(incompleteRecords||[],function(record){fieldCache.setValue(record,fieldName,record.get(fieldName))})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.calculator.LastUpdateCalculator",{extend:Rally.data.calculator.FieldCalculator,lastUpdateField:null,revisionModelName:"Revision",historyFieldName:"RevisionHistory",descriptionFieldName:"Description",creationDateFieldName:"CreationDate",batchSize:Ext.isIE?15:30,constructor:function(){this.callParent(arguments),this.fieldName||(this.fieldName=this.lastUpdateField.name+"LastUpdate")},calculator:function(incompleteRecords){incompleteRecords=Ext.Array.clone(incompleteRecords);var idx,deferred=new Deft.Deferred,batchCount=Math.ceil(incompleteRecords.length/this.batchSize),batchContext={incompleteRecords:incompleteRecords,batchCount:batchCount,deferred:deferred};for(idx=0;idx<batchCount;idx++)this._calculateBatch(Ext.Array.splice(incompleteRecords,0,Math.min(this.batchSize,incompleteRecords.length)),batchContext);return deferred.promise},_calculateBatch:function(records,batchContext){var store=this._createStore(records);store.loadPages({callback:function(revisions){this._onLoad(revisions,records),batchContext.batchCount--,batchContext.batchCount<1&&batchContext.deferred.resolve(batchContext.incompleteRecords)},scope:this})},_createStore:function(records){var historyField=this.historyFieldName,historyFilters=Ext.Array.map(records,function(record){return{property:historyField,operator:"=",value:record.get(historyField)._ref}});return Ext.create("Rally.data.wsapi.Store",{model:this.revisionModelName,autoLoad:!1,pageSize:Rally.data.wsapi.Store.wsapiMaxPageSize,fetch:[this.historyFieldName,this.creationDateFieldName],filters:[{property:this.descriptionFieldName,operator:"contains",value:this.lastUpdateField.displayName.toUpperCase()},Rally.data.wsapi.Filter.or(historyFilters)],sorters:[{property:this.creationDateFieldName,direction:"DESC"}]})},_onLoad:function(revisions,incompleteRecords){var revisionsByHistory={};_.forEach(revisions||[],function(revision){var revisionKey=revision.get(this.historyFieldName)._ref;revisionsByHistory.hasOwnProperty(revisionKey)||(revisionsByHistory[revisionKey]=revision.get(this.creationDateFieldName))},this),_.forEach(incompleteRecords||[],function(record){this._calculateLastUpdate(record,revisionsByHistory)},this)},_calculateLastUpdate:function(record,revisions){var lastUpdate=revisions[record.get(this.historyFieldName)._ref];lastUpdate||(lastUpdate=record.get(this.creationDateFieldName)),record.set(this.fieldName,Rally.util.DateTime.toIsoString(lastUpdate))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.CardRecordProcessor",{extend:Ext.AbstractPlugin,alias:"plugin.rallycardboardcardrecordprocessor",init:function(cmp){this.callParent(arguments),this.cmp.recordProcessor=this},process:function(records){var deferred=new Deft.Deferred,promises=[];if(this.cmp.isCardAgeEnabled()&&records.length>0){var cardAgePromise=this._calculateCardAge(records);cardAgePromise&&promises.push(cardAgePromise)}return promises.length>0?Deft.Promise.all(promises).then(function(){deferred.resolve(records)}):deferred.resolve([]),deferred.promise},_calculateCardAge:function(records){var cmp=this.cmp,lastUpdateField=records[0].self.getField(cmp.attribute);if(lastUpdateField){var calculator=Ext.create("Rally.data.calculator.LastUpdateCalculator",{lastUpdateField:lastUpdateField});return cmp.cardConfig.ageFieldName=calculator.fieldName,calculator.calculate(records).then(function(calculatedResult){return calculatedResult.calculatedRecords})}return Deft.Promise.when(records)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.ColumnCardCounter",{alias:"plugin.rallycolumncardcounter",extend:Ext.AbstractPlugin,cardCount:0,headerTpl:'<div class="column-card-count">({cardCount})</div>',constructor:function(config){this.callParent(arguments),Ext.isString(this.headerTpl)&&(this.headerTpl=Ext.create("Ext.XTemplate",this.headerTpl))},init:function(cmp){this.callParent(arguments),this.cmp=cmp,this.cmp.on("addcard",this.increment,this),this.cmp.on("removecard",this.decrement,this),this.cmp.on("storeload",this.onStoreLoad,this),this.cmp.on("afterrender",this.refresh,this)},destroy:function(){this.cmp&&delete this.cmp},increment:function(){this.cardCount++,this.refresh()},decrement:function(){this.cardCount--,this.refresh()},onStoreLoad:function(store){this.cardCount=store.getTotalCount(),this.refresh()},refresh:function(){var cardCountCt=this.cmp.getColumnHeader().getHeaderTitle().down("#countContainer");cardCountCt?cardCountCt.update(this.headerTpl.apply(this.getHeaderData())):(cardCountCt=Ext.widget({xtype:"container",itemId:"countContainer",html:this.headerTpl.apply(this.getHeaderData())}),this.cmp.getColumnHeader().getHeaderTitle().add(cardCountCt))},getHeaderData:function(){return{cardCount:this.cardCount}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.ColumnWIP",{alias:"plugin.rallycolumnwipcontent",extend:Rally.ui.cardboard.plugin.ColumnCardCounter,wipLimit:-1,headerTpl:'<div class="column-card-count">{cardCount} of {wipLimit}</div>',refresh:function(){this.cmp.rendered&&this.cmp.getColumnHeader()&&(this.callParent(arguments),this._handleWipLimit())},getHeaderData:function(){return Ext.apply({wipLimit:this._isInfiniteWip()?"&#8734;":this.wipLimit},this.callParent(arguments))},_overWipLimit:function(){return!this._isInfiniteWip()&&this.cardCount>this.wipLimit},_handleWipLimit:function(){this._overWipLimit()?(this.cmp.getColumnHeaderCell().addCls("over-capacity"),_.invoke(this.cmp.getContentCellContainers(),"addCls","over-capacity")):(this.cmp.getColumnHeaderCell().removeCls("over-capacity"),_.invoke(this.cmp.getContentCellContainers(),"removeCls","over-capacity"))},_isInfiniteWip:function(){return this.wipLimit===-1||""===this.wipLimit}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.SafeExting",{singleton:!0,clone:function(item){if(!Ext.enumerables)return Ext.clone(item);var type,i,j,k,clone;if(null===item||void 0===item)return item;if(item.nodeType&&item.cloneNode)return item.cloneNode(!0);if(type=Object.prototype.toString.call(item),"[object Date]"===type)return new Date(item.getTime());if("[object Array]"===type)for(i=item.length,clone=[];i--;)clone[i]=Rally.util.SafeExting.clone(item[i]);else if("[object Object]"===type&&item.constructor===Object&&(clone={},_.forIn(item,function(value,key){clone[key]=Rally.util.SafeExting.clone(value)}),Ext.enumerables))for(j=Ext.enumerables.length;j--;)k=Ext.enumerables[j],item.hasOwnProperty(k)&&(clone[k]=item[k]);return clone||item},mergeOwnProperties:function(dest,src){Ext.Object.each(src,function(key,newValue){var currentValue=dest[key];dest[key]=Ext.isObject(currentValue)&&Ext.isObject(newValue)?Ext.merge({},currentValue,newValue):newValue})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.CardFieldFetch",{extend:Rally.data.wsapi.FieldFetchMapper,inheritableStatics:{getFieldMappings:function(){return Ext.apply(Rally.data.wsapi.FieldFetchMapper.getFieldMappings(),{
Children:["Children:summary"],Defects:["Defects:summary[State;Owner]","DefectStatus"],Tasks:["Tasks:summary[State;ToDo;Owner;Blocked]","TaskStatus"],TestCases:["TestCaseStatus","PassingTestCaseCount","TestCaseCount"]})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.Column",{extend:Ext.Component,alias:"widget.rallycardboardcolumn",mixins:{messageable:Rally.Messageable,datastoreCreateable:Rally.data.DataStoreCreateable,filterable:Rally.data.filter.StoreFilterable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},inheritableStatics:{HIDDEN_CLS:"rly-hidden"},cls:"column",clientMetrics:[{beginMethod:"_queryForData",endEvent:"load",description:"column loaded"},{beginMethod:"loadMoreRecords",endMethod:"_onStoreLoad",description:"autoload records"}],columnHeader:null,ownerCardboard:null,config:{cardConfig:{xtype:"rallycard"},columnHeaderConfig:{xtype:"rallycardboardcolumnheader"},enableWipLimit:!1,wipLimit:-1,value:void 0,valueField:void 0,displayField:void 0,record:void 0,enableCrossColumnRanking:!1,enableRanking:!0,enableCrossRowDragging:!0,dropControllerConfig:!0,autoLoadCardThreshold:5,autoLoadPollingDelay:100,fields:[],additionalFetchFields:[],context:void 0,models:[],requiresModelSpecificFilters:!0},constructor:function(config){this.mergeConfig(config),Ext.isEmpty(this.model)&&!Ext.isEmpty(this.models)&&(this.model=this.models),this.plugins=this.plugins||[],this.initConfig(config),this.enableWipLimit&&this.plugins.push({ptype:"rallycolumnwipcontent",wipLimit:this.wipLimit}),this.plugins.push("rallycardboardcardrecordprocessor"),this._initDropController(),this.callParent([this.config])},initComponent:function(){this.addEvents("cardpickedup","beforecarddroppedsave","aftercarddroppedsave","load","ready","filter","cardinvalid","cardupdated","cardready","beforecardrender"),this.callParent(arguments),this._cardsByRow={},this._setLoading(!0),this._queryForData(),this.on("afterrender",this._addScrollListener,this),this.on("hide",function(){this.on("show",this.autoLoadCards,this,{single:!0})},this)},refresh:function(newConfig){this.clearCards(),this.store=null,Rally.util.SafeExting.mergeOwnProperties(this,newConfig),this._queryForData()},loadStore:function(){this._setLoading(!0),this._initStoreFilters(),delete this._hasStoppedLoadingRecords,this.store.load({callback:function(record,operation){operation.success||Rally.ui.notify.Notifier.showError({message:Rally.data.util.Record.getWsapiOperationErrorMessage(operation)+" If you have entered a query please verify that it is valid."})}},this)},getStore:function(){return this.store},mayRank:function(){var sorter=this.store.sorters.last();return Rally.data.Ranker.isRankField(sorter.property)&&"ASC"===sorter.direction&&this.enableRanking},_initDropController:function(){var dropControllerConfig=this.dropControllerConfig;if(dropControllerConfig){var defaultConfig={ptype:"rallycolumndropcontroller"},pluginConfig=Ext.isObject(dropControllerConfig)?dropControllerConfig:defaultConfig;this.plugins=this.plugins||[],this.plugins.push(pluginConfig)}},_addScrollListener:function(){Ext.isGecko&&this.on("scroll",function(event,element){this._scrollToTop(element)},this,{single:!0}),this.on("scroll",function(){this.autoLoadCards()},this);var scrollElement=this.getScrollElement();scrollElement&&this.mon(Ext.fly(scrollElement),"scroll",this._onScroll,this),this.mon(Ext.fly(window),"scroll",this._onScroll,this)},_onScroll:function(event,element){this.fireEvent("scroll",this,element)},_scrollToTop:function(domElement){var scrollElement=this.getScrollElement(),scrollDom=scrollElement&&scrollElement.dom;scrollDom&&scrollDom===domElement||(scrollElement=window),scrollElement.scrollTo("top",0)},autoLoadCards:function(){return this._waitForAutoLoad?void(this._queueAutoLoad=!0):(!this.isLoading()&&this._shouldAutoLoadMoreRecords()&&this.loadMoreRecords(),this._waitForAutoLoad=!0,void Ext.defer(function(){delete this._waitForAutoLoad,this._queueAutoLoad&&(delete this._queueAutoLoad,this.autoLoadCards())},this.autoLoadPollingDelay,this))},getAllFetchFields:function(){var requiredFetchFields=[this.attribute,"ObjectID","Workspace"],cardClass=Ext.ClassManager.get(Ext.ClassManager.getNameByAlias("widget."+this.cardConfig.xtype));this.isCardAgeEnabled()&&(requiredFetchFields.push("VersionId"),requiredFetchFields.push("RevisionHistory"),requiredFetchFields.push("CreationDate"));var sorters=this.store&&this.store.sorters.getRange()||this.storeConfig&&this.storeConfig.sorters||[];Ext.isEmpty(sorters)&&sorters.push(this._getDefaultSorter());var allFields=_.compact(_.union(requiredFetchFields,this.additionalFetchFields,cardClass.getFetchFields(),this.fields,this.storeConfig.fetch||[],_.pluck(sorters,"property")));return Rally.ui.cardboard.CardFieldFetch.getFetchFields(allFields,{useShallowFetch:this.storeConfig.useShallowFetch,modelNames:_.compact(_.pluck(this.model,"typePath"))})},isCardAgeEnabled:function(){return this.cardConfig.showAge>-1},show:function(){this.getColumnHeaderCell()&&this.getColumnHeaderCell().removeCls(this.self.HIDDEN_CLS),_.invoke(this.getContentCellContainers(),"removeCls",this.self.HIDDEN_CLS),this.callParent(arguments)},hide:function(){this.callParent(arguments),this.getColumnHeaderCell()&&this.getColumnHeaderCell().addCls(this.self.HIDDEN_CLS),_.invoke(this.getContentCellContainers(),"addCls",this.self.HIDDEN_CLS)},getStoreFilter:function(model){return{property:this.attribute,operator:"=",value:this.getValue()}},_getModelScopedFilters:function(models){if(this.requiresModelSpecificFilters){var filters=_.map(models,function(model){var filter=Ext.create("Rally.data.wsapi.Filter",{property:"TypeDefOid",value:model.typeDefOid,operator:"="}),modelFilters=this.getStoreFilter(model);return Ext.isEmpty(modelFilters)||(filter=_.reduce(Ext.Array.from(modelFilters),function(result,modelFilter){return result.and(modelFilter)},filter)),filter},this);return _.reduce(filters,function(result,filter){return Ext.isEmpty(result)?filter:result.or(filter)},null,this)}return[this.getStoreFilter()]},_initStoreFilters:function(){var filters=this._mergeConfigFilters(this._getFiltersForModels());this.filterCollection&&(this.filterCollection.addPermanentFilter(filters),filters=this.filterCollection.toArray()),this.store.setFilter(filters)},_getFiltersForModels:function(){return Ext.isEmpty(this.store.models)?this.getStoreFilter(this.store.model):this._getModelScopedFilters(this.store.models)},_mergeConfigFilters:function(filters){filters=Ext.Array.from(filters);var configFilters=this.storeConfig.filters;return Ext.isEmpty(configFilters)||(filters=filters.concat(_.map(Ext.Array.from(configFilters),Ext.clone))),_.each(filters,function(f){f instanceof Rally.data.wsapi.Filter?f.itemId=f.toString():Ext.isObject(f)&&(f.itemId=Ext.create("Rally.data.wsapi.Filter",f).toString())}),filters},_queryForData:function(){return this.buildStore(this._getStoreConfig()).then({success:this._onStoreBuilt,scope:this})},_createAndAddCardsFromStore:function(store){if(!this.isDestroyed){var records=[];store.each(function(record){this.isMatchingRecord(record)&&records.push(record)},this),this.createAndAddCards(records),this.fireEvent("load",this,records),this._columnReady()}},_onStoreBuilt:function(store){this.store=store,this.store.on("load",this._onStoreLoad,this),store.getCount()?this._createAndAddCardsFromStore(store):this.storeConfig.hasOwnProperty("autoLoad")&&!this.storeConfig.autoLoad||this.loadStore()},_onStoreLoad:function(store,records,successful,options){if(options=options||{},records=records||[],!this.rendered)return void this.on("afterrender",Ext.bind(this._onStoreLoad,this,[store,records,successful,options]),{single:!0});var clearExistingCards=successful&&store.clearOnPageLoad&&!this._loadingMoreRecords;delete this._loadingMoreRecords,clearExistingCards&&this.clearCards(),0===records.length&&(this._hasStoppedLoadingRecords=!0),this.fireEvent("storeload",store,records,successful,options),this.isDestroyed||(successful?(records=_.filter(records,function(record){return this.isMatchingRecord(record)&&(clearExistingCards||!this._isCardRendered(record))},this),this.createAndAddCards(records),this._shouldAutoLoadMoreRecords()?this.loadMoreRecords():(this.fireEvent("load",this,records),this._columnReady())):(this._setLoading(!1),this._columnReady()))},_isCardRendered:function(record){return _.some(this.getCards(),function(card){return card.record.getId()===record.getId()},this)},_shouldAutoLoadMoreRecords:function(){if(this._hasMoreRecords()&&this.isVisible()){var cards=this.getCards();if(0===cards.length)return!0;var thresholdCard=cards[cards.length-this.autoLoadCardThreshold]||cards[0];return thresholdCard.cardAboveBottomOfWindow()}return!1},getScrollElement:function(){return this.ownerCardboard&&this.ownerCardboard.getScrollElement&&this.ownerCardboard.getScrollElement()},isLoading:function(){return this._loading},_setLoading:function(loading){this._loading=loading},loadMoreRecords:function(){return this._hasMoreRecords()?(this._setLoading(!0),this._loadingMoreRecords=!0,void this.store.nextPage({addRecords:!0})):void this._setLoading(!1)},_hasMoreRecords:function(){var totalCount=this.store.getTotalCount()||0;return!this._hasStoppedLoadingRecords&&totalCount>this.store.getCount()},_getBrowserTestCls:function(){return Rally.util.Test.toBrowserTestCssClass(this.getColumnHeader().getHeaderValue()||this.getValue())},_addBrowserTestCls:function(){_.invoke(this.getContentCells(),"addCls",this._getBrowserTestCls()),this.getColumnHeaderCell().addCls(this._getBrowserTestCls())},afterRender:function(){this.callParent(arguments),this.drawHeader(),this._addBrowserTestCls()},_getInsertIndex:function(card){var row=this.getRowFor(card),cards=this.getCardsInRow(row),records=_.invoke(cards,"getRecord"),record=card.getRecord();return records.push(record),this._sortRecords(records),_.findIndex(records,function(r){return record.getId()===r.getId()})},_sortRecords:function(records){this.store.sorters.length&&records.sort(this.store.sorters.last().sort)},_getStoreConfig:function(){var defaultPageSize=15,sorters=Ext.isEmpty(this.storeConfig.sorters)?[this._getDefaultSorter()]:this.storeConfig.sorters;return{sorters:sorters,fetch:this.getAllFetchFields(),search:this.storeConfig.search,pageSize:this.storeConfig.pageSize||defaultPageSize,useShallowFetch:this.storeConfig.useShallowFetch}},_getDefaultSorter:function(){return{property:Rally.data.Ranker.RANK_FIELDS.MANUAL,direction:"ASC"}},_getSortProperty:function(){return this.store&&this.store.sorters&&this.store.sorters.getCount()?this.store.sorters.getAt(0).property:Rally.data.Ranker.RANK_FIELDS.MANUAL},getColumnHeader:function(){return this.columnHeader},getColumnHeaderCell:function(){return Ext.get(this.headerCell)},getHeaderTitle:function(){return this.getColumnHeader().down("#headerTitle")},onRowAdded:function(row){this.fireEvent("rowadd",this,row),this.isHidden()&&(this.hide(),row.hideColumn(this))},getRows:function(){return this.ownerCardboard.getRows()},getRowFor:function(card){return this.ownerCardboard.getRowFor(card)},getContentCells:function(){return _.invoke(this.getRows(),"getContentCellFor",this)},getContentCellContainers:function(){return _.invoke(this.getContentCells(),"parent")},drawHeader:function(){if(!this.getColumnHeader()){var config={renderTo:this.getColumnHeaderCell()};config=Ext.merge({},config,this.columnHeaderConfig),this.columnHeader=Ext.widget(config)}},clearCards:function(){_.each(this.getCards(),function(card){this.removeCard(card,!0)},this),this._cardsByRow={}},getCards:function(){return _.reduce(this.getRows(),function(memo,row){return memo.concat(this.getCardsInRow(row))},[],this)},getCardsInRow:function(row){var cardsInRow=this._cardsByRow[row.getRowValue()];return cardsInRow&&cardsInRow.getRange()||[]},findCardInfo:function(searchCriteria){var foundCard=null;return searchCriteria=searchCriteria.get?searchCriteria.getId():searchCriteria,_.forEach(this.getCards(),function(card){if(card.getRecord().getId()===searchCriteria||card.getEl()===searchCriteria||card.getEl()===Ext.get(searchCriteria)){var row=this.getRowFor(card);return foundCard={record:card.getRecord(),index:_.indexOf(this.getCardsInRow(row),card),card:card,row:row},!1}},this),foundCard},getCard:function(record){var result=this.findCardInfo(record);return result?result.card:null},getRecords:function(type){var records=[];return Ext.each(this.getCards(),function(card){var record=card.getRecord();(Ext.isEmpty(type)||record.get("_type")===type)&&records.push(record)}),records},isMatchingRecord:function(record){var recordValue=record.get(this.attribute),field=record.getField(this.attribute),typePath=record.self.typePath,models=this.store.models||Ext.Array.from(this.store.model),supportedTypes=_.pluck(models,"typePath");if(!field||!_.contains(supportedTypes,typePath))return!1;var columnValue=this.getValue();return Ext.isFunction(field.convert)&&(columnValue=field.convert(columnValue,record)),columnValue===recordValue||Rally.util.Ref.isRefUri(columnValue)&&Rally.util.Ref.getRelativeUri(recordValue)===Rally.util.Ref.getRelativeUri(columnValue)},createAndAddCard:function(record,index,highlight,cardConfig){var card;return this.isMatchingRecord(record)&&(this.recordProcessor.process([record]),card=this._createCard(record,cardConfig),this.addCard(card,index,highlight)),card},_createCard:function(record,cardConfig){this.fields&&this.fields.length>0&&(Ext.isObject(cardConfig)||(cardConfig={}),cardConfig.fields=Ext.Array.union(this.cardConfig.fields||[],this.fields||[]));var config=Ext.merge({},this.cardConfig,{record:record},cardConfig),card=Ext.widget(config.xtype,config);return card.rankRecordHelper={_addColumnFilters:function(storeConfig){var row=card.ownerColumn.getRowFor(card);storeConfig.filters=Ext.Array.merge(storeConfig.filters||[],card.ownerColumn.store.filters.getRange()),card.ownerColumn.getRows().length>1&&storeConfig.filters.push({property:row.fieldDef.name,operator:"=",value:row.getRowValue()})},findRecordToRankAgainst:function(options){options=options||{};var extremeLoadOptions={last:!options.highest,metricsCmp:options.requester,storeConfig:{}};return this.rankRecordHelper._addColumnFilters(extremeLoadOptions.storeConfig),Rally.data.Ranker.loadExtremeRankedRecord(this.ownerColumn.store,extremeLoadOptions).then(function(record){return Ext.callback(options.success,options.scope,[record]),record})},getMoveToPositionStore:function(options){options=options||{};var store=this.ownerColumn.store;return Ext.merge(options,{storeConfig:{model:store.model,context:store.context}}),this.rankRecordHelper._addColumnFilters(options.storeConfig),Deft.Promise.when(Ext.create(store.self,options.storeConfig))},scope:card},card},addCard:function(card,index,highlight){var record=card.getRecord();return this.assign(record),this._renderCard(card,index),highlight&&card.highlight(),this.fireEvent("addcard"),card.fireEvent("ready",card),card},_getContentContainerForCard:function(card){var row=this.getRowFor(card);return row.getContentCellFor(this)},_renderCard:function(card,index){this.fireEvent("beforecardrender",card,this),card.rendered?(card.ownerColumn&&card.ownerColumn.removeCard(card,!1),index=this._insertCardAtIndex(card,index),this._setCardOwnerColumn(card)):(Ext.isNumber(index)||(index=this._getInsertIndex(card)),this._setCardOwnerColumn(card),card.render(this._getContentContainerForCard(card),index)),this._addCardToCollection(card,index),this._relayCardEvents(card),this.fireEvent("cardready",card,this)},_insertCardAtIndex:function(card,index){var row=this.getRowFor(card),cards=this.getCardsInRow(row),cardEl=card.getEl(),containerEl=row.getContentCellFor(this);return index=Ext.isNumber(index)?index:this._getInsertIndex(card)||0,0===cards.length?containerEl.insertFirst(cardEl):index>=cards.length?cardEl.appendTo(containerEl):this._insertCardBeforeOther(card,cards[index]),index},_insertCardBeforeOther:function(card,otherCard){otherCard!==card&&card.getEl().insertBefore(otherCard.getEl())},_setCardOwnerColumn:function(card){card.ownerColumn=this,card.on("destroy",function(){card.ownerColumn=null},this,{single:!0})},_relayCardEvents:function(card){card._columnRelays&&card._columnRelays.destroy(),card._columnRelays=this.relayEvents(card,["select","deselect","datachanged","cardcopied"])},_addCardToCollection:function(card,index){var key=this._getCardKey(card),row=this.getRowFor(card),cards=this._cardsByRow[row.getRowValue()];cards||(cards=Ext.create("Ext.util.MixedCollection"),this._cardsByRow[row.getRowValue()]=cards),Ext.isNumber(index)?cards.insert(index,key,card):cards.add(key,card),this.mon(card,"destroy",function(){this._removeCardFromCollection(card)},this,{single:!0})},_removeCardFromCollection:function(card){_.each(this._cardsByRow,function(cards){return!cards.removeAtKey(this._getCardKey(card))},this)},_getCardKey:function(card){var key=card.record.getId();return key||Ext.Error.raise("card.record.id not found"),key},assign:function(record){record.set(this.attribute,this.getValue())},removeCard:function(card,destroy){var foundCardInfo=card.card||this.findCardInfo(card.record||card);foundCardInfo&&(destroy!==!1?foundCardInfo.card.destroy():foundCardInfo.card.getEl().parent().dom.removeChild(foundCardInfo.card.getEl().dom),this._removeCardFromCollection(foundCardInfo.card)),this.fireEvent("removecard"),card.ownerColumn=null},refreshCard:function(record,options){var deferred=new Deft.Deferred,foundCard=record.card?record:this.findCardInfo(record);if(options=options||{},foundCard){var card=foundCard.card;return this.refreshRecord(record,function(records){if(0===records.length)this.fireEvent("cardinvalid",this,card);else if(1===records.length){var refreshedRecord=records[0];card.setRecord(refreshedRecord),this._rerenderCard(card),(options.rerank||!this._cardIsInCorrectRow(card)||options.shouldSort)&&this.addCard(card,null,!0),Ext.callback(options.callback,options.scope,[card]),this.fireEvent("cardupdated",foundCard.card),deferred.resolve(card)}},this)}return deferred.resolve(),deferred.promise},refreshNeighboringTaskIndices:function(record){var row=this.getRowFor(record),cards=this.getCardsInRow(row),store=this.store,refreshStoreConfig={model:store.model,context:store.context,filters:store.filters.getRange(),sorters:store.sorters.getRange(),limit:cards.length,fetch:["TaskIndex"]};row.isDefault||refreshStoreConfig.filters.push({property:row.fieldDef.name,value:row.getRowValue()});var refreshStore=Ext.create(store.self,refreshStoreConfig);return refreshStore.load().then({success:function(){_.each(cards,function(card){var refreshedRecord=refreshStore.getById(card.getRecord().getId());refreshedRecord&&refreshedRecord.getId()!==record.getId()&&(card.getRecord().set("TaskIndex",refreshedRecord.get("TaskIndex")),this.addCard(card,null,!1))},this)},scope:this})},_cardIsInCorrectRow:function(card){return card.getEl().parent().dom===this._getContentContainerForCard(card).dom},refreshRecord:function(record,callback){var deferred=Ext.create("Deft.promise.Deferred"),promise=deferred.promise;return this.recordLoadBegin({description:"refreshing record"}),this.store.reloadRecord(record,{requester:this,fetch:this.getAllFetchFields(),useShallowFetch:this.storeConfig.useShallowFetch}).then({success:function(refreshedRecord){refreshedRecord.join(this.store),Ext.callback(callback,this,[[refreshedRecord]]),deferred.resolve(refreshedRecord)},failure:function(operation){Ext.callback(callback,this,[[]]),deferred.reject(operation)},scope:this}),promise.always(function(){this.recordLoadEnd()},this),promise},createAndAddCards:function(records){this.recordProcessor&&this.recordProcessor.process(records),Ext.suspendLayouts();var cards=records.map(this._createCard,this);_.each(cards,function(card){this._renderCard(card)},this),Ext.resumeLayouts(!0),_.each(cards,function(card){card.fireEvent("ready",card)})},_rerenderCard:function(card){this.recordProcessor.process([card.getRecord()]).then(function(renderedRecords){card.reRender()})},_columnReady:function(){return this.rendered?(this._setLoading(!1),void this.fireEvent("ready",this)):void this.on("afterrender",this._columnReady,this)},onDestroy:function(){this.clearCards(),this.store&&this.store.un&&this.store.un("load",this._onStoreLoad,this);var header=this.getColumnHeader();header&&header.destroy(),this.callParent(arguments)},getMinWidth:function(){return 170}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.print.Print",{alias:"plugin.rallyprint",extend:Ext.AbstractPlugin,config:{defaultTitle:void 0,detailViewDisabled:!1},inheritableStatics:{topToolbarTpl:Ext.create("Ext.Template",'<div class="send-to-printer noprint">','<a href="#" onclick="window.print(); return false;">Send to Printer</a>',"</div>",{compiled:!0}),headerTpl:Ext.create("Ext.Template",'<div class="header">','<div class="title">{title}</div>','<div class="subtitle">{subtitle}</div>',"</div>",{compiled:!0}),footerTpl:Ext.create("Ext.Template",'<div class="footer">','<div class="printed-by">Printed by {user}</div>','<div class="powered-by">Powered by {company}</div>',"</div>",{compiled:!0})},constructor:function(config){return this.initConfig(config),this.callParent(arguments)},init:function(component){component.openPrintPage=Ext.bind(this.openPrintPage,this)},openPrintPage:function(printOptions){this.printOptions=printOptions,this.printWindow=window.open(Rally.environment.getServer().getContextUrl()+"/blank.html","printwindow","scrollbars=yes"),this.printWindow.name="",this._waitForWindow(this.printWindow,Ext.bind(this._injectPageStructure,this))},print:function(){Ext.create("Rally.ui.dialog.PrintDialog",{autoShow:!0,items:{xtype:"form",border:!1,buttonAlign:"center",cls:"form-panel",items:[{xtype:"container",layout:{type:"hbox",align:"top"},items:[{xtype:"component",cls:"print-format-label",html:"Format: ",width:200},{xtype:"container",items:[{xtype:"radio",width:200,boxLabelCls:"print-summary-radio",boxLabel:"Summary",name:"format",inputValue:"summary",checked:!0},{xtype:"radio",width:200,boxLabelCls:"print-details-radio",boxLabel:"Details",name:"format",inputValue:"details",disabled:this.detailViewDisabled,listeners:{change:{fn:function(checkbox,checked){checkbox.up("rallyprintdialog").down("#printComboBox")[checked?"enable":"disable"]()}}}},{xtype:"combo",cls:"print-config-combo",itemId:"printComboBox",name:"detailType",style:{paddingTop:"10px"},width:110,disabled:!0,editable:!1,queryMode:"local",displayField:"name",valueField:"abbr",store:Ext.create("Ext.data.Store",{fields:["abbr","name"],data:[{abbr:"oneperpage",name:"One per Page"},{abbr:"continuously",name:"Continuously"}]}),value:"oneperpage"}]}]},{xtype:"textfield",labelAlign:"right",labelWidth:150,labelPad:15,width:350,style:{paddingTop:"20px"},fieldLabel:"Title",name:"title",value:this._getDefaultTitle()},{xtype:"textfield",labelAlign:"right",labelWidth:150,labelPad:15,width:350,fieldLabel:"Subtitle",name:"subtitle"}]},listeners:{print:{fn:function(printDialog){this.openPrintPage(printDialog.down("form").getValues())},scope:this}}})},_afterContentLoad:function(){this.printWindow&&this.printWindow.location&&this.printWindow.location.href&&this.printWindow.location.href.indexOf("print=false")===-1&&this.printWindow.print()},_getDefaultTitle:function(){return Ext.isFunction(this.defaultTitle)?this.defaultTitle.apply(this.component):this.defaultTitle},_waitForWindow:function(waitForWindow,fn){var loadingWindowInterval=window.setInterval(function(){waitForWindow.isLoaded&&(window.clearInterval(loadingWindowInterval),fn.call(this))},100)},_injectPageStructure:function(){this._injectCSS(),this.printWindow.document.title=this.printOptions.title,Ext.isIE&&(this.printWindow.document.body.id="print-dialog-window"),this.getPageContent(function(html){this._injectContent(html,"div",{class:"print-page"}),Ext.Function.defer(this._afterContentLoad,500,this)},this)},getPageContent:function(callback,scope){var html=this.getTopToolbar()+this.getHeader()+this.getContent()+this.getFooter();Ext.callback(callback,scope,[html])},getTopToolbar:function(){return this.self.topToolbarTpl.apply()},getHeader:function(){return this.self.headerTpl.apply(this.printOptions)},getContent:function(){return""},getFooter:function(){var user=Rally.environment.getContext().getUser().getDisplayString();return this.self.footerTpl.apply({user:user,company:"CA Technologies"})},_injectContent:function(html,elementType,attributes,container){elementType=elementType||"div",container=container||this.printWindow.document.getElementsByTagName("body")[0];var element=this.printWindow.document.createElement(elementType);return Ext.Object.each(attributes,function(key,value){"class"===key?element.className=value:element.setAttribute(key,value)}),html&&(element.innerHTML=html),container.appendChild(element)},_injectCSS:function(){var head=this.printWindow.document.getElementsByTagName("head")[0];Ext.each(Ext.query("link"),function(stylesheet){this._injectContent("","link",{rel:"stylesheet",href:stylesheet.href,type:"text/css"},head)},this),Ext.each(Ext.query("style"),function(style){this._injectContent(style.innerHTML,"style",{type:"text/css"},head)},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.Print",{extend:Rally.ui.plugin.print.Print,alias:"plugin.rallycardboardprinting",init:function(component){this.callParent(arguments),this.component=component},_getHtmlContent:function(dom){var el=Ext.DomHelper.createDom({});return el.appendChild(Ext.clone(dom)),el.innerHTML},getContent:function(){return this._getHtmlContent(this.component.getEl().dom)},getHeader:function(){return""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.row.Body",{extend:Ext.Component,autoEl:"tr",cls:"row-body",config:{columns:[]},renderTpl:Ext.create("Ext.XTemplate",'<tpl for="columns">','<td class="card-column">','<div class="column-content"></div>',"</td>","</tpl>"),initComponent:function(){this.renderData={columns:this.columns},this.callParent(arguments)},getContentCells:function(){return _.map(this.getEl().dom.childNodes,function(childNode){return Ext.get(childNode.childNodes[0])})},getContentCellFor:function(column){return this.getContentCells()[this._indexOfColumn(column)]},_indexOfColumn:function(column){return _.indexOf(this.columns,column)},removeColumn:function(column){var indexOfColumn=this._indexOfColumn(column);Ext.removeNode(this.getContentCells()[indexOfColumn].dom.parentNode)},addColumn:function(column,index){var cells=_.invoke(this.getContentCells(),"parent"),referenceEl=cells[index],tdCell=Ext.fly(Ext.DomHelper.createDom({tag:"td",cls:"card-column"}));tdCell.createChild({tag:"div",cls:"column-content"}),referenceEl?tdCell.insertBefore(referenceEl):tdCell.insertAfter(_.last(cells))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.row.Header",{extend:Ext.Component,alias:"widget.rallycardboardrowheader",autoEl:"tr",cls:"row-header",config:{columns:[],value:null,fieldDef:null,context:null},renderTpl:Ext.create("Ext.XTemplate",'<td class="row-header-cell" colspan="{columnCount}">','<div class="row-header-title">{title}</div>',"</td>"),renderSelectors:{tdEl:"td"},initComponent:function(){this.renderData={columnCount:this._getVisibleColumnCount(),title:this._getTitle()},this.callParent(arguments)},onColumnsUpdated:function(){this._updateColSpan()},_updateColSpan:function(){this.tdEl.set({colspan:this._getVisibleColumnCount()})},_getVisibleColumnCount:function(){return _.reject(this.columns,function(column){return column.isHidden()}).length},_getTitle:function(){var value=this.getValue();if(Ext.isObject(value)){var objectValue=value._refObjectName;if(value.FormattedID){var tpl=Ext.create("Rally.ui.renderer.template.FormattedIDTemplate",{showIcon:!0,showHover:!1});value=tpl.apply(value)+": "+objectValue}else value=objectValue}if(_.isUndefined(value)||_.isNull(value)||""===value)value="-- None --";else if("boolean"===this.getFieldDef().getType()){var booleanValue=value===!0?"Yes":"No";value=this.getFieldDef().displayName+": "+booleanValue}else"PlanEstimate"===this.getFieldDef().name?value+=" "+this.getContext().getWorkspace().WorkspaceConfiguration.IterationEstimateUnitName:"Estimate"===this.getFieldDef().name&&(value+=" "+this.getContext().getWorkspace().WorkspaceConfiguration.TaskUnitName);return value}})}(),function(){var Ext=window.Ext4||window.Ext,fireEventMethod="fireEventArgs";Ext.define("Rally.clientmetrics.ClientMetricsBuilder",{singleton:!0,mixins:[Rally.clientmetrics.ClientMetricsRecordable],disabled:!1,defaultDescription:"no info",build:function(cmp,clientMetricsConfigs,methodDispatcher){cmp.suppressClientMetrics||Ext.isEmpty(clientMetricsConfigs)||(methodDispatcher=methodDispatcher||cmp,Ext.isObject(clientMetricsConfigs)&&(clientMetricsConfigs=[clientMetricsConfigs]),Ext.isArray(clientMetricsConfigs)&&(this._sortConfigs(clientMetricsConfigs),_.each(clientMetricsConfigs,function(clientMetricsConfig){this._setupClientMetrics(clientMetricsConfig,cmp,methodDispatcher)},this)))},_sortConfigs:function(configs){configs.sort(function(configA,configB){return Ext.isString(configA.method)||Ext.isString(configA.event)?1:Ext.isString(configB.method)||Ext.isString(configB.event)?-1:0})},_setupClientMetrics:function(clientMetricsConfig,cmp,methodDispatcher){var description,me=this,hasFilterFunction=Ext.isFunction(clientMetricsConfig.filterEventFn);Ext.isString(clientMetricsConfig.event)?this._interceptBefore(cmp,fireEventMethod,function(eventName){eventName===clientMetricsConfig.event&&(hasFilterFunction&&!me._passesFilterFunction(clientMetricsConfig.filterEventFn,cmp,arguments)||(description=me._getEventDescription(clientMetricsConfig,cmp),me.recordAction({description:description,component:cmp})))}):Ext.isString(clientMetricsConfig.method)?this._interceptBefore(methodDispatcher,clientMetricsConfig.method,function(){description=me._getEventDescription(clientMetricsConfig,cmp),me.recordAction({description:description,component:cmp})}):Ext.isString(clientMetricsConfig.beginEvent)?(this._interceptBefore(cmp,fireEventMethod,function(eventName){eventName===clientMetricsConfig.beginEvent&&(hasFilterFunction&&!me._passesFilterFunction(clientMetricsConfig.filterEventFn,cmp,arguments)||(description=me._getEventDescription(clientMetricsConfig,cmp),me.recordLoadBegin({description:description,component:cmp})))}),Ext.isString(clientMetricsConfig.endMethod)?this._interceptAfter(methodDispatcher,clientMetricsConfig.endMethod,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),me.recordLoadEnd(options)}):Ext.isString(clientMetricsConfig.endEvent)&&cmp.on(clientMetricsConfig.endEvent,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),this.recordLoadEnd(options)},this)):Ext.isString(clientMetricsConfig.beginMethod)?(this._interceptBefore(methodDispatcher,clientMetricsConfig.beginMethod,function(){description=me._getEventDescription(clientMetricsConfig,cmp),me.recordLoadBegin({description:description,component:cmp})}),Ext.isString(clientMetricsConfig.endMethod)?this._interceptAfter(methodDispatcher,clientMetricsConfig.endMethod,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),me.recordLoadEnd(options)}):Ext.isString(clientMetricsConfig.endEvent)&&cmp.on(clientMetricsConfig.endEvent,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),this.recordLoadEnd(options)},this)):Ext.isString(clientMetricsConfig.endEvent)?(description=this._getEventDescription(clientMetricsConfig,cmp),this.recordLoadBegin({description:description,component:cmp}),cmp.on(clientMetricsConfig.endEvent,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),
this.recordLoadEnd(options)},this)):Ext.isString(clientMetricsConfig.endMethod)&&(description=this._getEventDescription(clientMetricsConfig,cmp),this.recordLoadBegin({description:description,component:cmp}),this._interceptAfter(cmp,clientMetricsConfig.endMethod,function(){var options={component:cmp};clientMetricsConfig.whenLongerThan&&(options.whenLongerThan=clientMetricsConfig.whenLongerThan),me.recordLoadEnd(options)})),clientMetricsConfig.componentReadyEvent&&this._interceptAfter(cmp,fireEventMethod,function(eventName){eventName===clientMetricsConfig.componentReadyEvent&&me.recordComponentReady({component:cmp})})},_passesFilterFunction:function(filterFn,cmp,eventArgs){var filterArgs=Array.prototype.concat(cmp,Array.prototype.slice.call(eventArgs,1));return filterFn.apply(null,filterArgs)},_getEventDescription:function(clientMetricsConfig,cmp){var message;return clientMetricsConfig.descriptionProperty&&(message=cmp[clientMetricsConfig.descriptionProperty],Ext.isFunction(message)&&(message=message.call(cmp))),message||clientMetricsConfig.description||this.defaultDescription},_interceptBefore:function(object,methodName,fn){var method=object[methodName]||Ext.emptyFn;return object[methodName]=function(){return fn.apply(this,arguments),method.apply(this,arguments)},object[methodName]},_interceptAfter:function(object,methodName,fn){var method=object[methodName]||Ext.emptyFn;return object[methodName]=function(){var result=method.apply(this,arguments);return fn.apply(this,arguments),result},object[methodName]}},function(){Ext.Function.interceptBefore(Ext.Component.prototype,"initComponent",function(){!Rally.clientmetrics.ClientMetricsBuilder.disabled&&Ext.isDefined(this.clientMetrics)&&Rally.clientmetrics.ClientMetricsBuilder.build(this,this.clientMetrics)}),Ext.Function.interceptBefore(Ext.Component.prototype,"initPlugin",function(plugin){return!Rally.clientmetrics.ClientMetricsBuilder.disabled&&Ext.isDefined(plugin.clientMetrics)&&Rally.clientmetrics.ClientMetricsBuilder.build(this,plugin.clientMetrics,plugin),plugin}),Ext.Function.interceptBefore(Ext.menu.Item.prototype,"onClick",function(){Rally.clientmetrics.ClientMetricsBuilder.recordAction({description:"clicked menu item"+(this.text?" "+this.text:""),component:this})})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.row.CollapsibleRowHelper",{mixins:[Rally.clientmetrics.ClientMetricsRecordable],clientMetrics:[{method:"_collapse",description:"collapsed row"},{method:"_expand",description:"expanded row"}],config:{row:void 0},constructor:function(config){this.initConfig(config);var row=this.getRow(),header=row.getHeader();header&&header.on("afterrender",this._addCollapseComponents,this),Rally.clientmetrics.ClientMetricsBuilder.build(this,this.clientMetrics)},destroy:function(){var header=this.getRow().getHeader();header&&header.tdEl.un("click",this._handleClick,this);var iconDiv=Ext.get(this.iconDiv);iconDiv&&iconDiv.remove(),this.callParent(arguments)},_addCollapseComponents:function(){var row=this.getRow(),header=row.getHeader();header&&(header.tdEl.on("click",this._handleClick,this,{buffer:200}),row.getCollapsed()&&this._applyCollapsedClasses(),this.iconDiv=Ext.DomHelper.append(header.tdEl,{tag:"div",cls:(row.isCollapsed()?"icon-expand-row":"icon-collapse-row")+" expand-collapse"}))},_applyCollapsedClasses:function(){var header=this.getRow().getHeader();header&&header.tdEl.addCls("collapsed")},_removeCollapsedClasses:function(){var header=this.getRow().getHeader();header&&header.tdEl.removeCls("collapsed")},_handleClick:function(){this.getRow().getCollapsed()?this._expand():this._collapse()},_toggleIcons:function(){var el=Ext.get(this.iconDiv);el.toggleCls("icon-expand-row"),el.toggleCls("icon-collapse-row")},_collapse:function(){this.getRow().collapse().then({success:function(){this._toggleIcons(),this._applyCollapsedClasses()},scope:this})},_expand:function(){this.getRow().expand().then({success:function(){this._toggleIcons(),this._removeCollapsedClasses()},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.row.Row",{statics:{CARD_MIN_HEIGHT:80},mixins:{observable:Ext.util.Observable},config:{columns:[],showHeader:!0,el:void 0,value:null,fieldDef:null,context:null,headerConfig:{xtype:"rallycardboardrowheader"},header:void 0,body:void 0,collapsible:!0,collapsed:!1,sortField:void 0},constructor:function(config){this.mixins.observable.constructor.call(this,config),this.initConfig(config),this.columns=[].concat(this.columns);var cmpConfig={columns:this.columns,value:this.value,fieldDef:this.fieldDef,context:this.context};this.showHeader&&this.setHeader(Ext.widget(Ext.apply(cmpConfig,this.headerConfig))),this.setBody(Ext.create("Rally.ui.cardboard.row.Body",Ext.merge(cmpConfig,{hidden:this.getCollapsed()}))),this.collapsible&&(this.collapsibleRowHelper=Ext.create("Rally.ui.cardboard.row.CollapsibleRowHelper",{row:this})),this.callParent(arguments)},isCollapsible:function(){return this.getCollapsible()},isCollapsed:function(){return this.getCollapsed()},getContentCells:function(){return this.body.getContentCells()},getContentCellContainers:function(){return _.invoke(this.getContentCells(),"parent")},getContentCellFor:function(column){return this.body.getContentCellFor(column)},isMatchingRecord:function(record){var recordValue=record.get(this.getFieldDef().name),rowValue=this.getRowValue();return rowValue===recordValue||Rally.util.Ref.isRefUri(rowValue)&&Rally.util.Ref.getRelativeUri(recordValue)===Rally.util.Ref.getRelativeUri(rowValue)},insert:function(beforeRow){var el=this.getEl();this.body.render(el,beforeRow&&beforeRow.header.getEl()),this.header&&this.header.render(el,this.body.getEl()),_.invoke(this.columns,"onRowAdded",this)},getRowValue:function(){var value=this.getValue();return Ext.isObject(value)&&(value=Rally.util.Ref.getRelativeUri(value)),value},getRowDisplayValue:function(){var value=this.getValue();return Ext.isObject(value)&&(value=value._refObjectName),Ext.isString(value)&&(value=value.toLowerCase()),value},getRowSortValue:function(){return this.getSortField()?this.getValue()[this.getSortField()]:this.getRowDisplayValue()},destroy:function(){this.collapsibleRowHelper&&(this.collapsibleRowHelper.destroy(),delete this.collapsibleRowHelper),this.header&&(this.header.destroy(),delete this.header),this.body&&(this.body.destroy(),delete this.body),this.fireEvent("destroy",this)},removeColumn:function(column){this.header&&this.header.onColumnsUpdated(),this.body.removeColumn(column),Ext.Array.remove(this.columns,column)},hideColumn:function(column){this.header&&this.header.onColumnsUpdated()},showColumn:function(column){this.header&&this.header.onColumnsUpdated()},addColumn:function(column,index){Ext.Array.insert(this.columns,index,[column]),this.header&&this.header.onColumnsUpdated(),this.body.addColumn(column,index),column.onRowAdded(this)},collapse:function(){return this._animating?Deft.Promise.when():(this._setRowHeight(),this._hideCards(),this._animateResizeRow(0).then({success:function(){this.getBody().hide(),this.setCollapsed(!0),this.fireEvent("collapse",this)},scope:this}))},expand:function(){return this._animating?Deft.Promise.when():(this._setRowHeight(0),this._hideCards(),this.getBody().show(),this._animateResizeRow(this._calculateHeight()).then({success:function(){this._setRowHeight("auto"),this._showCards(),this.setCollapsed(!1),this.fireEvent("expand",this)},scope:this}))},_calculateHeight:function(){var minCardHeight=this.self.CARD_MIN_HEIGHT,maxNumCards=this._getMaxNumCards()||1;return minCardHeight*maxNumCards},_getMaxNumCards:function(){var max=0;return _.each(this.columns,function(column){column.getColumnHeaderCell().hasCls("collapsed")||(max=Math.max(max,column.getCardsInRow(this).length))},this),max},_hideCards:function(){_.invoke(this.getContentCells(),"enableDisplayMode"),_.invoke(this.getContentCells(),"hide")},_showCards:function(){_.invoke(this.getContentCells(),"show")},_setRowHeight:function(height){_.each(this.getContentCellContainers(),function(td){td.setHeight(height||td.getHeight())},this)},_animateResizeRow:function(height){this._animating=!0;var animPromises=[];return _.each(this.getContentCellContainers(),function(cell){Ext.isIE10m?animPromises.push(this._immediateResizeCell(cell,height)):animPromises.push(this._animateResizeCell(cell,height))},this),Deft.Promise.all(animPromises).always(function(){delete this._animating},this)},_immediateResizeCell:function(cell,height){var deferred=Ext.create("Deft.Deferred");cell.setHeight(height),deferred.resolve()},_animateResizeCell:function(cell,height){var deferred=Ext.create("Deft.Deferred");return cell.animate({duration:500,to:{height:height+"px"},listeners:{afteranimate:function(){deferred.resolve()},scope:this}}),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mask.Maskable",{maskTarget:void 0,maskMsg:void 0,loadMask:!0,showMask:function(message){if(this.loadMask!==!1){var maskTarget=this._getMaskTargetEl(),maskMsg=message||this.maskMsg;maskTarget&&maskTarget.mask&&maskTarget.mask(maskMsg)}},hideMask:function(){if(this.loadMask!==!1){var maskTarget=Ext.fly(this._getMaskTargetEl());maskTarget&&maskTarget.unmask&&maskTarget.unmask()}},_getMaskTargetEl:function(){var maskTarget=this.maskTarget||this.getEl();return Ext.isString(maskTarget)&&(maskTarget=Ext.query(maskTarget)[0]),Ext.get(maskTarget)},setMaskTarget:function(target){this.maskTarget=target}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.FilterNotifiable",{showNewItemExcludedByFiltersWarning:function(record,clearCurrentFiltersFn){var config={message:(record.get("FormattedID")?'<span class="formatted-id-template">'+record.get("FormattedID")+":</span> ":"")+"Current filters prevent this item from being shown.",allowHTML:!0};_.isFunction(clearCurrentFiltersFn)&&(config.links=[{text:"Clear filters",fn:clearCurrentFiltersFn,args:[record],scope:this}]),Rally.ui.notify.Notifier.showWarning(config)},showItemMovedToPageNotification:function(record,pageNumber,moveToPageFunction){var config={artifact:record,showRank:!1,links:[{text:"View on Page "+pageNumber,fn:moveToPageFunction,args:[record],scope:this}]};Rally.ui.notify.Notifier.showCreate(config)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.CardBoard",{extend:Ext.Component,alias:"widget.rallycardboard",alternateClassName:"Rally.ui.CardBoard",clientMetrics:{beginEvent:"added",endEvent:"load",descriptionProperty:"loadDescription",description:"CardBoard loaded"},mixins:{scopeable:Rally.app.Scopeable,maskable:Rally.ui.mask.Maskable,messageable:Rally.Messageable,filternotification:Rally.ui.filter.FilterNotifiable},plugins:[{ptype:"rallycardboardprinting",pluginId:"print"}],cls:"cardboard",stateful:!0,config:{types:["HierarchicalRequirement"],attribute:"ScheduleState",columnConfig:{xtype:"rallycardboardcolumn",displayField:"Name",valueField:"_ref"},columnHeaderConfig:{xtype:"rallycardboardcolumnheader"},cardConfig:{xtype:"rallycard"},storeConfig:{},columns:void 0,readOnly:!1,enableRanking:!0,enableCrossColumnRanking:!0,ddGroup:"cardboard",context:void 0,models:[],rowConfig:null},constructor:function(config){this.mergeConfig(config),Rally.realtime.Realtime.enabled&&this.plugins.push({ptype:"rallyrealtime"}),this.callParent([this.config])},initComponent:function(){if(this.stateful){var context=this.getAppContextOrEnvironmentContext(),projectRef=context.getProjectRef()||"";this.stateId=context.getScopedStateId(Ext.String.format("project.{0}.cardboard",_.last(projectRef.split("/")))),this.fieldsStateId=this.fieldsStateId||context.getScopedStateId("shownfields"),this._setFieldsFromState()}this.callParent(arguments),this.addEvents("load","columnsretrieved","columnready","aftercolumnrender","cardupdated","columnvisibilitychanged");var fetchFields=this.columnConfig.additionalFetchFields||[];this.columnConfig.additionalFetchFields=Ext.Array.merge(Rally.ui.cardboard.CardFieldFetch.getFetchFields(fetchFields),Rally.ui.cardboard.CardFieldFetch.getFetchFields(this.cardConfig.fields)),this.columnConfig.context=this.context,this.cardConfig.context=this.context,this.subscribe(this,Rally.Message.objectCreate,this._onObjectCreate,this),this.subscribe(this,Rally.Message.objectUpdate,this._onObjectUpdate,this),this.subscribe(this,Rally.Message.objectDestroy,this._onObjectDestroy,this),this.subscribe(this,Rally.Message.bulkImport,function(){this.refresh()},this),this._retrieveModels(this._parseColumnsAndRows),this.on("columnvisibilitychanged",this._calculateMinWidth,this),this.rowsReady=!1,this.on("beforestatesave",function(){return this.rowsReady||!1},this)},getScrollElement:function(){var app=this.up("rallyapp");return app&&app.getEl()},getModel:function(){var models=this.getModels();return 1===models.length?models[0]:Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(models,this.getAppContextOrEnvironmentContext())},filter:function(filter,clearFilterKeys,ignoreDefaultFilters){var columns=this.getColumns();Ext.isEmpty(columns)?(this.filterCollection=this.filterCollection||Ext.create("Rally.data.filter.FilterCollection"),this.filterCollection.clearTempFilters(),this.filterCollection.addTempFilter(filter)):(this._toggleMask(!0),_.invoke(columns,"filter",filter,clearFilterKeys,ignoreDefaultFilters))},getCurrentView:function(){return{fields:this._getCurrentFieldsAsUuids()}},_getCurrentFieldsAsUuids:function(){var model=this.getModel();return _.map(this.columnConfig.fields,function(field){var modelField=model.getField(field);return modelField&&modelField.getUUID()||field},this)},_cleanup:function(){_.each([].concat(this.getColumns()),this.destroyColumn,this),this._clearRows()},_clearRows:function(){_.invoke(this.getRows(),"destroy"),this.rowDefinitions=[]},onDestroy:function(){this._cleanup(),this.callParent(arguments)},onModelsRetrieved:function(success){this._validateGroupByAttribute(this.models)&&success.apply(this,this.models)},_retrieveModels:function(success){Rally.data.ModelFactory.getModels({types:this.types,context:this.context,success:function(models){this.models=_.values(models),this.onModelsRetrieved(success)},scope:this,requester:this})},addColumn:function(columnConfig,index){var column=this._createColumnDefinition(columnConfig);return Ext.Array.insert(this.columnDefinitions,Ext.isNumber(index)?index:this.columnDefinitions.length,[column]),_.invoke(this.getRows(),"addColumn",column,index),column},destroyColumn:function(column){column.destroy(),column.getColumnHeaderCell()&&Ext.removeNode(column.getColumnHeaderCell().dom),_.invoke(this.getRows(),"removeColumn",column),Ext.Array.remove(this.columnDefinitions,column),this.fireEvent("columnvisibilitychanged")},hideColumn:function(column){column.hide(),_.invoke(this.getRows(),"hideColumn",column),this.fireEvent("columnvisibilitychanged")},showColumn:function(column){column.show(),_.invoke(this.getRows(),"showColumn",column),this.fireEvent("columnvisibilitychanged")},_createColumnDefinition:function(columnConfig){var config=Ext.merge({enableCrossColumnRanking:this.enableCrossColumnRanking},Ext.clone(this.columnConfig),columnConfig),enableRanking=this.enableRanking;if(this.context){var workspace=this.context.getWorkspace();workspace&&(enableRanking=enableRanking&&workspace.WorkspaceConfiguration.DragDropRankingEnabled)}var listenersConfig={ready:this._onColumnReady,select:this._onCardSelect,deselect:this._onCardDeselect,cardinvalid:this._onCardInvalid,scope:this};Ext.merge(config,{cardConfig:Ext.clone(this.cardConfig),columnHeaderConfig:Ext.clone(this.columnHeaderConfig),model:this.models,attribute:this.attribute,storeConfig:Ext.clone(this.storeConfig),enableRanking:enableRanking,filterCollection:this.filterCollection?this.filterCollection.clone():void 0,ownerCardboard:this,listeners:listenersConfig,ddGroup:this.ddGroup}),this.readOnly&&(config.dropControllerConfig=!1);var cardConfig=config.cardConfig;columnConfig.cardConfig&&(Ext.Object.merge(cardConfig,columnConfig.cardConfig),cardConfig.fields=Ext.Array.merge(columnConfig.cardConfig.fields||[],this.cardConfig.fields||[]));var storeConfig=config.storeConfig;columnConfig.storeConfig&&(Ext.Object.merge(storeConfig,columnConfig.storeConfig),storeConfig.filters=Ext.Array.merge(columnConfig.storeConfig.filters||[],this.storeConfig.filters||[])),this._hasValidRowField()&&(storeConfig.sorters=this._getRowSorters(storeConfig.sorters),storeConfig.fetch=Ext.Array.merge(this.rowConfig.field,storeConfig.fetch||[]),config.enableCrossRowDragging=this.rowConfig.enableCrossRowDragging!==!1&&!this.rowConfig.fieldDef.readOnly);var sorter=_.last(storeConfig.sorters);return sorter&&!Rally.data.Ranker.isRankField(sorter.property)&&(cardConfig.showRankMenuItems=!1),Ext.widget(config.xtype,config)},_getRowSorters:function(incomingSorters){var sorters=Ext.Array.from(this.rowConfig.sorters);return Ext.isEmpty(sorters)&&(sorters.push({property:this.rowConfig.field,direction:this.rowConfig.sortDirection||"ASC"}),Ext.isEmpty(incomingSorters)?sorters.push({property:this.getAppContextOrEnvironmentContext().getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled?Rally.data.Ranker.RANK_FIELDS.DND:Rally.data.Ranker.RANK_FIELDS.MANUAL,direction:"ASC"}):sorters=sorters.concat(incomingSorters)),sorters},_parseColumnsAndRows:function(){return this.columnConfig.fields=_.map(_.compact(this.columnConfig.fields),function(field){var modelField=this.getModel().getField(field);return modelField?modelField.name:field},this),this._hasValidRowField()&&this.addCls("has-rows"),Deft.Promise.all([this._parseSorters(),this._parseRows()]).then({success:this._parseColumns,scope:this})},_parseRows:function(){if(this.rowConfig){var fieldDef=this.rowConfig.fieldDef=this.getModel().getField(this.rowConfig.field);return this._getAllowedValues(fieldDef).then({success:function(allowedValues){allowedValues&&(this.rowConfig.values=allowedValues.values,allowedValues.sortDirection&&(this.rowConfig.sortDirection=allowedValues.sortDirection))},scope:this})}return Deft.Promise.when()},_getAllowedValues:function(fieldDef){if(fieldDef){if("boolean"===fieldDef.attributeDefinition.AttributeType.toLowerCase())return Deft.Promise.when({values:[!0,!1],sortDirection:"DESC"});if(fieldDef.attributeDefinition.Constrained&&"object"!==fieldDef.attributeDefinition.AttributeType.toLowerCase())return fieldDef.getAllowedValueStore().load().then({success:function(records){var values=_.invoke(records,"get","StringValue");return fieldDef.attributeDefinition.Custom?(Ext.Array.sort(values,function(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a<b?-1:a>b?1:0}),_.isEmpty(values[0])&&values.push(values.shift())):"rating"!==fieldDef.attributeDefinition.AttributeType.toLowerCase()||values[0]||(values[0]="None"),{values:values}},scope:this})}return Deft.Promise.when()},_parseSorters:function(){var sorters=Ext.Array.from(this.storeConfig.sorters),sorter=_.last(sorters);if(sorter){var fieldName=sorter.property,fieldDef=this.getModel().getField(fieldName);return this._getAllowedValues(fieldDef).then({success:function(allowedValues){if(allowedValues){var values=_.reduce(allowedValues.values,function(result,value,index){return result[value]=index,result},{});sorter.sorterFn=function(a,b){return("DESC"===this.direction?-1:1)*(values[a.get(fieldName)]-values[b.get(fieldName)])},allowedValues.sortDirection&&(sorter.direction=allowedValues.sortDirection)}},scope:this})}return Deft.Promise.when()},_parseColumns:function(){this.columnDefinitions=[],Ext.isArray(this.columns)?(this._toggleMask(!0),_.each(this.columns,this.addColumn,this),this.renderColumns()):this._buildColumnsFromModel()},_buildColumnsFromModel:function(){var model=this.getModel();if(model){var attribute=model.getField(this.attribute);attribute&&attribute.getAllowedValueStore().load({requester:this,callback:function(records,operation,success){var retrievedColumns=_.map(records,function(allowedValue){var displayValue,value=allowedValue.get("StringValue");return value||"rating"!==attribute.attributeDefinition.AttributeType.toLowerCase()?"object"===attribute.attributeDefinition.AttributeType.toLowerCase()&&(displayValue=value,value=allowedValue.get("_ref"),"null"===value&&(value=null)):value="None",{value:value,columnHeaderConfig:{headerTpl:displayValue||value||"None"}}});this.fireEvent("columnsretrieved",this,retrievedColumns),this.columnDefinitions=[],this._toggleMask(!0),_.each(retrievedColumns,this.addColumn,this),this.renderColumns()},scope:this})}},_generateHeaderHtml:function(){return this._generateTableRowHtml({tag:"th"})},_generateTableRowHtml:function(config){var html=_.times(this.columnDefinitions.length,function(){return this._generateTableCellHtml(config)},this).join("");return"<tr>"+html+"</tr>"},_generateTableCellHtml:function(config){return Ext.DomHelper.createHtml(this._getColumnDomHelperConfig(config))},_getColumnDomHelperConfig:function(config){return Ext.apply({cls:"card-column",tag:"td"},config)},renderColumns:function(){this.rendered?this._renderColumns.call(this):this.on("afterrender",function(){this._renderColumns()},this,{single:!0})},_renderColumns:function(){this.columnDefinitions.length>0&&(this._calculateMinWidth(),this.getEl().update(this._getColumnContainerHtml()),this.rowDefinitions=[],this._hasValidRowField()?_.each(this.rowConfig.values,function(rowValue){this._createRow({showHeader:!0,value:rowValue})},this):this._createRow({showHeader:!1,isDefault:!0}),this._addColumnsToDom(),this.fireEvent("aftercolumnrender",this))},_toggleMask:function(show){this.maskTarget||(this.maskTarget=this.getEl()&&this.getEl().down(".cardboard-container")),show?(this.addCls("loading"),this.showMask("Loading...")):(this.removeCls("loading"),this.hideMask())},_getRowKey:function(field,value){return Ext.isObject(value)&&(value=value._ref),Ext.String.format("{0}",value)},_createDefaultRow:function(){this._createRow({showHeader:!1,isDefault:!0})},_createRow:function(rowConfig,applySort){var collapsed=!1;if(this.rowConfig&&this.rowConfig.field&&this.state&&this.state.collapsedRows){var rowKey=this._getRowKey(this.rowConfig.field,rowConfig.value);collapsed=this.state.collapsedRows.hasOwnProperty(rowKey)}var defaultRowConfig={el:this.getEl().down("tbody.columns"),columns:this.columnDefinitions,context:this.getAppContextOrEnvironmentContext(),fieldDef:this.rowConfig&&this.rowConfig.fieldDef,collapsed:collapsed};this.rowConfig&&(this.rowConfig.headerConfig&&(defaultRowConfig.headerConfig=this.rowConfig.headerConfig),this.rowConfig.sortField&&(defaultRowConfig.sortField=this.rowConfig.sortField));var row=Ext.create("Rally.ui.cardboard.row.Row",Ext.apply(defaultRowConfig,rowConfig)),sortIndex=applySort?this._getSortedIndex(row):this.rowDefinitions.length;return this.rowDefinitions.splice(sortIndex,0,row),row.insert(this.rowDefinitions[sortIndex+1]),row.isCollapsible()&&(row.on("collapse",this.saveState,this),row.on("expand",this.saveState,this)),row},applyState:function(state){this._resetCollapsedRowState(state),Ext.state.Manager.set(this.fieldsStateId,this._getCurrentFieldsAsUuids()),this.state=state},_setFieldsFromState:function(){var fields=Ext.state.Manager.get(this.fieldsStateId);fields&&(this.columnConfig.fields=_.flatten(fields.fields||fields))},_resetCollapsedRowState:function(state){state&&this.rowConfig&&state.field!==this.rowConfig.field&&(state.collapsedRows={},state.field=this.rowConfig.field,Ext.state.Manager.set(this.stateId,state))},getState:function(){var rows=this.getRows(),collapsedRows=_.reduce(rows,function(result,row,index){if(row.isCollapsed()){var key=this._getRowKey(row.fieldDef.name,row.getValue());result[key]=key}return result},{},this);return{field:this.rowConfig.field,collapsedRows:collapsedRows}},_getSortedIndex:function(row){if(_.isNull(row.getRowValue()))return this.rowDefinitions.length;var nonNullRows=_.reject(this.rowDefinitions,function(r){return _.isNull(r.getRowValue())});return _.sortedIndex(nonNullRows,row,function(r){return r.getRowSortValue()},this)},_addColumnsToDom:function(){var headerCells=this._getHeaderCells();_.each(this.columnDefinitions,function(colDef,index){this.renderColumn(colDef,{headerCell:headerCells[index]})},this)},_getColumnContainerHtml:function(){return['<div class="cardboard-container">','<table class="column-container">','<thead class="column-headers">',this._generateHeaderHtml(),"</thead>",'<tbody class="columns"></tbody>',"</table>","</div>"].join("")},_getHeaderCells:function(){return this.getEl().query("th.card-column")},createColumnElements:function(afterOrBefore,column){var insertFnName="after"===afterOrBefore?"insertAfter":"insertBefore",thCell=Ext.DomHelper.createDom(this._getColumnDomHelperConfig({tag:"th"}));return Ext.fly(thCell)[insertFnName](column.getColumnHeaderCell()),{headerCell:thCell}},renderColumn:function(column,els){Ext.apply(column,els),column.render(els.headerCell),this.relayEvents(column,["cardpickedup","beforecarddroppedsave","aftercarddroppedsave","cardupdated","cardcopied"])},_onColumnReady:function(column,records){this._columnsLoaded=this._columnsLoaded||0,this._columnsLoaded++,this.fireEvent("columnready",column,this),this._columnsLoaded===this.columnDefinitions.length&&(this._onAllColumnsReady(),this.getRows().length||(this.rowConfig?this._createRow({showHeader:!0,value:null,isBlankSlate:!0}):this._createDefaultRow()))},_onAllColumnsReady:function(){this.fireEvent("load",this),this._toggleMask(!1),delete this._columnsLoaded,this.rowsReady=!0,Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_onCardSelect:function(card){this.selectedCard&&this.selectedCard.deselect(),this.selectedCard=card},_onCardDeselect:function(card){delete this.selectedCard},_onCardInvalid:function(column,card){var record=card.getRecord(),otherColumns=_.reject(this.columnDefinitions,function(colDef){return colDef===column}),promises=_.map(otherColumns,function(column){return column.refreshRecord(record).then({success:function(reloadedRecord){card.setRecord(reloadedRecord),card.reRender(!1),column.addCard(card,null,!0)}})},this);return Deft.promise.Promise.any(promises).then({failure:function(){column.removeCard(card,!0)}})},getColumns:function(){return this.columnDefinitions||[]},getRows:function(){return this.rowDefinitions},getRowFor:function(item){var row,rows=this.getRows(),record=item.isModel?item:item.getRecord();return row=this._hasValidRowField()?_.find(rows,function(row){return row.isMatchingRecord(record)})||this._createRow({showHeader:!0,value:record.get(this.rowConfig.field)},!0):rows[0]||this._createDefaultRow()},addRow:function(item,applySort){var value=item.isModel?item.getData():item;return this._createRow({showHeader:!0,value:value},applySort)},removeRow:function(row){_.each(this.getColumns(),function(col){_.each(col.getCardsInRow(row),function(card){col.removeCard(card)})}),row.destroy(),this.rowDefinitions=Ext.Array.remove(this.rowDefinitions,row)},getCards:function(){return _.reduce(this.columnDefinitions,function(cards,column){return cards[column.getValue()]=column.getCards(),cards},{})},getCardsInRow:function(row){return _.reduce(this.columnDefinitions,function(cards,column){return cards[column.getValue()]=column.getCardsInRow(row),cards},{})},getCardCount:function(opt){return opt=opt||{},_.reduce(this.columnDefinitions,function(sum,column){return opt.includeHiddenColumns||!column.isHidden()?sum+column.getCards().length:sum},0)},getCard:function(record){return _.find(this.columnDefinitions,function(column){return column.getCard(record)})},reconfigureWithFields:function(newConfig){this.refresh(newConfig),Ext.state.Manager.set(this.fieldsStateId,this._getCurrentFieldsAsUuids())},refresh:function(newConfig){Rally.util.SafeExting.mergeOwnProperties(this,newConfig),this._hasValidRowField()&&!this.rowConfig.values&&this._clearRows(),newConfig&&(newConfig.attribute||newConfig.columns||newConfig.rowConfig)?(this._cleanup(),this._retrieveModels(this._parseColumnsAndRows)):newConfig&&newConfig.types?this._retrieveModels(function(){this._refreshColumns({model:this.models,storeConfig:this.storeConfig})}):newConfig&&newConfig.columnConfig?this._refreshColumns(_.extend({storeConfig:this.storeConfig},newConfig.columnConfig)):this._refreshColumns({storeConfig:this.storeConfig})},_refreshColumns:function(config){this._toggleMask(!0),_.invoke(this.columnDefinitions,"refresh",config)},refreshCard:function(searchCriteria,refreshOptions){_.forEach(this.columnDefinitions,function(column){if(column.findCardInfo(searchCriteria))return column.refreshCard(searchCriteria,refreshOptions),!1})},removeCard:function(searchCriteria){_.forEach(this.columnDefinitions,function(column){if(column.findCardInfo(searchCriteria))return column.removeCard(searchCriteria,!0),!1})},addCard:function(record,highlight){if(!Rally.util.Ref.isRefUri(record))return this._addCard(record,highlight);var ref=Ext.create("Rally.util.Ref",record),column=this.columnDefinitions[0],model=_.find(this.models,{typePath:ref.getType()});model&&model.load(ref.getOid(),{fetch:column.getAllFetchFields(),success:function(loadedRecord){return this._addCard(loadedRecord,highlight)},scope:this})},_addCard:function(record,highlight){var card=null;return _.forEach(this.columnDefinitions,function(column){if(this._shouldColumnDisplayRecord(column,record))return card=column.createAndAddCard(record,null,highlight),!1},this),card},_onObjectCreate:function(record,cmp,associatedRecords){this._addRecordAndRefreshAssociatedCards(record,[],associatedRecords)},_onObjectUpdate:function(record,changedFields,cmp,associatedRecords){this._addRecordAndRefreshAssociatedCards(record,changedFields,associatedRecords);var rowToUpdate=this._findRowByValue(record);if(rowToUpdate){var cards=_.flatten(_.values(this.getCardsInRow(rowToUpdate)));record.self.load(record.getId(),{callback:function(r){this.removeRow(rowToUpdate);var row=this.addRow(r.getData(),!0);_.each(_.invoke(cards,"getRecord"),function(record){this._addCard(record,!1)},this),Rally.util.Animation.highlight(row.getHeader().getEl())},scope:this})}},_onObjectDestroy:function(record,cmp,associatedRecords){this.removeCard(record),this._refreshAssociatedCards(record,[],associatedRecords);var rowToUpdate=this._findRowByValue(record);rowToUpdate&&this.removeRow(rowToUpdate)},_findRowByValue:function(record){return _.find(this.getRows(),function(row){return Rally.util.Ref.getRelativeUri(row.getRowValue())===Rally.util.Ref.getRelativeUri(record)})},_addRecordAndRefreshAssociatedCards:function(record,changedFields,associatedRecords){if(this._shouldAddCardToMatchingColumn(record,changedFields)&&this._addCardToMatchingColumn(record),this._refreshAssociatedCards(record,changedFields,associatedRecords),record.isTask()&&this._needsRerank(changedFields)){var column=_.find(this.columnDefinitions,function(column){return column.findCardInfo(record)});column&&column.refreshNeighboringTaskIndices(record)}},_refreshAssociatedCards:function(record,changedFields,associatedRecords){var associatedCards=record.getAssociatedRefs().concat(associatedRecords),associatedRefs=_.map(associatedCards,function(associated){return Rally.util.Ref.getOidFromRef(associated)});_.each(_.uniq(_.compact(associatedRefs)),function(associatedRef){this.refreshCard(associatedRef)},this)},_shouldAddCardToMatchingColumn:function(record,changedFields){var refreshOptions=this._getRefreshOptions(changedFields);return!this._cardRefreshed(record,refreshOptions)&&this._recordIsDisplayedType(record)},_needsRerank:function(changedFields){return _.some(changedFields,Rally.data.Ranker.isRankField,Rally.data.Ranker)},_needsResort:function(changedFields){var sorter=_.last(this.storeConfig.sorters);return sorter&&_.contains(changedFields,sorter.property)},_getRefreshOptions:function(changedFields){var refreshOptions={};return _.isArray(changedFields)&&(this._needsRerank(changedFields)?refreshOptions.rerank=!0:this._needsResort(changedFields)&&(refreshOptions.shouldSort=!0)),refreshOptions},_recordIsDisplayedType:function(record){
return _.find(this.models,{typePath:record.get("_type")})},_cardRefreshed:function(record,refreshOptions){var cardRefreshed=!1;return _.forEach(this.columnDefinitions,function(column){if(column.findCardInfo(record))return column.refreshCard(record,refreshOptions),cardRefreshed=!0,!1}),cardRefreshed},_validateGroupByAttribute:function(models){var attribute=this.attribute,invalidModels=_.filter(models,function(model){return!model.hasField(attribute)}),invalidModelNames=_.pluck(invalidModels,"displayName").join(", ");if(invalidModels.length===models.length){var errorMsg=Ext.String.format("The currently selected Columns field {0} cannot be found or is hidden on {1}. Please update your Columns field setting.",attribute,invalidModelNames);return Rally.ui.notify.Notifier.showError({message:errorMsg}),!1}if(invalidModels.length){var warningMsg=Ext.String.format("The currently selected Columns field {0} cannot be found on {1}. Some card types may not appear.",attribute,invalidModelNames);Rally.ui.notify.Notifier.showWarning({message:warningMsg})}return!0},_addCardToMatchingColumn:function(record){_.forEach(this.columnDefinitions,function(column){if(this._shouldColumnDisplayRecord(column,record))return column.refreshRecord(record).then({success:function(refreshedRecord){this._recordRefreshedForAdd([refreshedRecord],column)},scope:this}),!1},this)},clearTempFilters:function(){this.filter(null,!0)},_shouldColumnDisplayRecord:function(column,record){return column.isMatchingRecord(record)&&record.hasField(this.attribute)},_recordRefreshedForAdd:function(records,column){if(records&&1===records.length){var card=column.createAndAddCard(records[0],null,!0);card&&(this.fireEvent("cardupdated",card),card.fireEvent("ready"))}},_calculateMinWidth:function(){var visibleColumns=this.getVisibleColumns();if(visibleColumns.length>0){var minWidth=_.reduce(visibleColumns,function(totalWidth,column){return totalWidth+column.getMinWidth()},0);this.getEl().setStyle("min-width",minWidth+"px")}},getVisibleColumns:function(){return _.reject(this.columnDefinitions,function(column){return column.isHidden()})},_hasValidRowField:function(){return this.rowConfig&&_.every(this.getModels(),function(model){return model.hasField(this.rowConfig.field)},this)}})}(),function(){var Ext=window.Ext4||window.Ext,origGetPrototypeBody=Ext.data.NodeInterface.getPrototypeBody;Ext.define("Rally.ui.grid.data.NodeInterface",{extend:Ext.data.NodeInterface,statics:Ext.apply(Ext.data.NodeInterface.prototype.self,{noLayoutFields:/^(expanded|loaded|loading|leaf|leafCount)$/,getPrototypeBody:function(){var protoBody=origGetPrototypeBody(),originalDestroy=protoBody.destroy,originalReplaceChild=protoBody.replaceChild,originalOnChildNodesAvailable=protoBody.onChildNodesAvailable;return Ext.apply(protoBody,{save:function(options){options=options||{},options.params=options.params||{},options.params.fetch=options.params.fetch||!0;var store=this.store&&this.store.treeStore||this.store;if(store&&_.isFunction(store.getParentFetch)&&_.isFunction(store.getChildFetch)){var fetchOptions={node:this,fetch:options.params.fetch};options.params.fetch=1===this.getDepth()?store.getParentFetch(fetchOptions):store.getChildFetch(fetchOptions)}return this.self.superclass.save.apply(this,[options])},set:function(name,value){var ret,isInTree=Rally.ui.grid.data.NodeInterface.noLayoutFields.test(name)&&this.store&&this.store.ownerTree,tree=this.store&&this.store.ownerTree;return isInTree&&tree.suspendLayouts(),ret=this.callParent(arguments),isInTree&&tree.resumeLayouts(),ret},destroy:function(silent){return this.parentNode&&this.parentNode.decrementLeafCount(),this._removeChildren(),originalDestroy.apply(this,[silent])},replaceChild:function(newChild,oldChild){return oldChild.replacedByNode=newChild,originalReplaceChild.apply(this,[newChild,oldChild])},onChildNodesAvailable:function(records,recursive,callback,scope){if(!this._isVisible()){var view=this._getView();if(view)return void view.fireEvent("afternonvisibleitemexpand",this)}return originalOnChildNodesAvailable.apply(this,arguments)},updateCollectionCount:function(collectionName,count){var collection=this.get(collectionName);collection&&(collection.Count=count),this.set("dirtyCollection",!0)},incrementLeafCount:function(){this.set("leafCount",(this.get("leafCount")||0)+1),this.set("leaf",!1)},decrementLeafCount:function(){this.set("leafCount",(this.get("leafCount")||1)-1),this.get("leafCount")>1&&this.set("leaf",!0)},resetLeafCount:function(enableHierarchy,expandedCollectionNames){if(enableHierarchy){var leafCount=this._getLeafCount(expandedCollectionNames);this.set("leaf",leafCount<1),this.set("leafCount",leafCount)}else this.set("leaf",!0),this.set("leafCount",0)},_isVisible:function(){var store=this.store;return!store||!_.isFunction(store.isRootNode)||(store.isRootNode(this)||this._getViewNode())},_getView:function(){var grid=this.store&&this.store.ownerTree;return grid&&grid.getView()},_getViewNode:function(){var view=this._getView();return view&&view.getNode(this)},_getLeafCount:function(expandedCollectionNames){var typePath=this.get("_type").toLowerCase(),collectionNames=Ext.Array.from(expandedCollectionNames[typePath]||[]);return _.reduce(collectionNames,function(accumulator,collectionName){var collectionVal=this.get(collectionName);return collectionVal&&collectionVal.Count&&(accumulator+=collectionVal.Count),accumulator},0,this)},_removeChildren:function(){this.suspendEvents(!1),_.each(_.clone(this.childNodes),function(node){node.parentNode.decrementLeafCount(),node.parentNode.removeChild(node,!1)}),this.resumeEvents()}})}})})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.TypeDefinitionFetcher",{config:{clientMetricsParent:void 0},mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},constructor:function(config){this.initConfig(config),this.callParent(arguments)},fetchTypeDefinitions:function(context,successCallback,failureCallback){return this.recordLoadBegin({description:"fetching type definitions",miscData:context}),this._fetchScope(context,failureCallback).then({success:function(result){return this._onScopeLoad(context,result,successCallback,failureCallback)},scope:this})},_onScopeLoad:function(context,result,successCallback,failureCallback){var deferred=Ext.create("Deft.Deferred"),schemaUrl=this._getSchemaUrl(context,result.SchemaVersion),success=function(result){_.isEmpty(result.Errors)?(this.recordLoadEnd(),Ext.callback(successCallback,this,arguments),deferred.resolve(result)):failure(result)},failure=function(result){this.recordLoadEnd(),Ext.callback(failureCallback,this,arguments),deferred.reject(result)},headers={},params={useCompactSchema:!0};return Rally.environment.getIoProvider().httpGet({requester:this,url:schemaUrl,enableQueuing:!0,noQueryScoping:!0,enableCaching:!0,headers:headers,params:params,success:success,failure:failure,scope:this}),deferred.promise},_fetchScope:function(context){var type=this._getTypeFromContext(context),oid=this._getOidFromContext(context);return Rally.data.ScopeLoader.loadScope({type:type,id:oid,requester:this})},_getTypeFromContext:function(context){return context.project?"Project":"Workspace"},_getOidFromContext:function(context){return context.project?Rally.util.Ref.getOidFromRef(context.project):context.workspace&&"null"!==context.workspace?Rally.util.Ref.getOidFromRef(context.workspace):Rally.environment.getContext().getWorkspace().ObjectID},_getSchemaUrl:function(context,schemaVersion){var contextUrl=Rally.environment.getServer().getContextUrl(),schemaUrl=contextUrl+"/schema/"+Rally.environment.getServer().getWsapiVersion(),ctx=context||{};if(ctx.project)schemaUrl+=Rally.util.Ref.getRelativeUri(ctx.project);else if(ctx.workspace){var w=ctx.workspace;"null"===w&&(w=Rally.environment.getContext().getWorkspace()._ref),schemaUrl+=Rally.util.Ref.getRelativeUri(w)}return schemaUrl+"/"+schemaVersion}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.collection.Proxy",{extend:Rally.data.wsapi.Proxy,alias:["proxy.Rally.data.WsapiCollectionProxy","proxy.rallywsapicollectionproxy"],alternateClassName:["Rally.data.WsapiCollectionProxy"],mixins:{proxy:Rally.data.wsapi.ProxyBase},urlMappings:{create:"add",destroy:"remove"},statics:{MAX_ARTIFACTS_PER_OPERATION:25},constructor:function(){this.callParent(arguments)},buildRequest:function(operation){var request=this.callParent(arguments);return request.requester=this.requester,request},buildUrl:function(request){return request.url=this.url,this.urlMappings[request.action]&&(request.url+="/"+this.urlMappings[request.action]),request.url},_overrideMethod:function(request){return"read"===request.action?"GET":"POST"},batch:function(options,listeners){var batch,records,actions,aLen,action,a,me=this,useBatch=me.batchActions;void 0===options.operations&&(options={operations:options,listeners:listeners}),options.batch?Ext.isDefined(options.batch.runOperation)&&(batch=Ext.applyIf(options.batch,{proxy:me,listeners:{}})):options.batch={proxy:me,listeners:options.listeners||{}},batch||(batch=new Ext.data.Batch(options.batch)),batch.on("complete",Ext.bind(me.onBatchComplete,me,[options],0)),actions=me.batchOrder.split(","),aLen=actions.length;var addBatch=function(record){batch.add(new Ext.data.Operation({action:action,records:[record]}))},addBatches=function(recordBatch){useBatch?batch.add(new Ext.data.Operation({action:action,records:recordBatch})):_.each(recordBatch,addBatch)};for(a=0;a<aLen;a++){action=actions[a],records=options.operations[action];var recordBatches=this._splitBatch(records);_.each(recordBatches,addBatches,recordBatches)}return batch.start(),batch},_splitBatch:function(records){var getBatchIndex=function(element,index){return Math.floor(index/this.self.MAX_ARTIFACTS_PER_OPERATION)};return _.chain(records).groupBy(getBatchIndex,this).toArray().value()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.artifact.Proxy",{extend:Rally.data.wsapi.Proxy,alternateClassName:["Rally.data.WsapiArtifactProxy"],alias:"proxy.rallywsapiartifactproxy",appendId:!1,buildRequest:function(operation){return"read"!==operation.action&&operation.records&&operation.records.length?operation.records[0].getProxy().buildRequest(operation):(this.extraParams.types&&(_.isString(operation.fetch)||_.isArray(operation.fetch))&&(operation.fetch=this._getMappedFetchFields(operation.fetch)),this.callParent(arguments))},encodeFilters:function(filters){filters=_.compact(_.map(filters,function(filter){return filter instanceof Rally.data.wsapi.Filter?filter:Rally.data.wsapi.Filter.fromExtFilter(filter)}));var models=_.map(this._getTypes(),function(type){return this.model.getArtifactComponentModel(type)},this);return this.callParent([Rally.util.Filter.removeNonapplicableTypeSpecificFilters(filters,models)])},_getMappedFetchFields:function(fetch){var models=_(this._getTypes()).map(this._getRecordModel,this).compact().value(),typeMappings=_.map(models,function(model){return _.invert(model.getArtifactMappings())}),fetchAsArray=_.isArray(fetch)?fetch:fetch.split(","),fieldMappings=_.transform(fetchAsArray,function(result,field){_.each(typeMappings,function(mapping){mapping[field]&&result.push(mapping[field])})});return _.union(fetchAsArray,fieldMappings)},_getTypes:function(){return this.extraParams.types&&this.extraParams.types.split(",")||_.pluck(this.model.getArtifactComponentModels(),"typePath")},_getRecordModel:function(item){return this.model.getArtifactComponentModel(item.toLowerCase())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.CompactResultHydrator",{hydrate:function(data){return this._hydrate(data,{})},_hydrate:function(data,referencedValues){var transformFunc=_.curry(this._transform)(referencedValues)(data);(_.isArray(data)||_.isPlainObject(data))&&_.each(data,transformFunc,this)},_transform:function(referencedValues,data,value,key){var referencedValue,ref=value&&value._ref;_.isEmpty(ref)||"null"===ref||(referencedValue=referencedValues[ref],referencedValue?data[key]=_.defaults(referencedValue,value):(referencedValues[ref]=value,this._hydrate(value,referencedValues)))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.Reader",{alternateClassName:["Rally.data.WsapiReader"],extend:Ext.data.reader.Json,alias:["reader.rally.data.reader","reader.rallywsapireader"],readRecords:function(data){var result=data.QueryResult||data.CreateResult||data.OperationResult||data,innerResult=result.Results||result.Object;innerResult&&(result[this.root]=innerResult),Rally.data.wsapi.ProxyBase.compact&&Ext.create("Rally.data.wsapi.CompactResultHydrator").hydrate(innerResult||result);var results=this.callParent([result]);return result.Sums&&(results.sums=_.transform(result.Sums,function(result,num,key){result[key]=+num%1===0?num:Ext.Number.toFixed(+num,2)})),results}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.Writer",{extend:Ext.data.writer.Json,alternateClassName:["Rally.data.WsapiWriter"],alias:["writer.rally.data.writer","writer.rallywsapiwriter"],require:"Rally.data.Ranker",writeAllFields:!1,getRecordData:function(record){var data,WORKSPACE_TIMEZONE_TOGGLE=Rally.environment.useWorkspaceTimeZone;return data=record.phantom?_.clone(record.getChanges()):this.callParent(arguments),delete data.ObjectID,Rally.data.Ranker.isDnDEnabled(record.store)&&delete data[Rally.data.Ranker.RANK_FIELDS.MANUAL],Ext.Object.each(data,function(key,value){Ext.isObject(value)&&value._ref?data[key]=Rally.util.Ref.getRelativeUri(value):WORKSPACE_TIMEZONE_TOGGLE&&value instanceof Date&&(data[key]=Rally.util.DateTime.rollToWorkspaceTzAsIsoString(value))}),data}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.artifact.Reader",{extend:Rally.data.wsapi.Reader,alternateClassName:["Rally.data.WsapiArtifactReader"],alias:["reader.rally.data.wsapiartifactreader","reader.rallywsapiartifactreader"],buildExtractors:function(){this.callParent(arguments),this.getRoot=this.getRootOverride},extractData:function(root){var artifactModel=this.model;Ext.isObject(root)&&(root=[root]);try{return _.map(root,function(item){return this._prepareModel(item,artifactModel),this.superclass.extractData.call(this,[item])[0]},this)}finally{this.setModel(artifactModel)}return records},getRootOverride:function(data){var dataModel=_.find(this.model.getArtifactComponentModels(),function(model){if(!model.isPortfolioItem())return _.has(data,model.elementName)});return data[dataModel?dataModel.elementName:this.root]},_prepareModel:function(item,defaultModel){var model;if(!item.isModel){var type=Rally.util.Ref.getTypeFromRef(item);"scheduledtestcase"===type&&(type="testcase"),model=defaultModel.getArtifactComponentModel(type)}if(this.setModel(model||defaultModel),this.model.isTestCase()&&"scheduledtestcase"===Rally.util.Ref.getTypeFromRef(item)){var scheduledTestCase=Ext.clone(item);delete scheduledTestCase.TestCase,Ext.apply(item,item.TestCase),Ext.apply(item,{LastBuild:scheduledTestCase.LastResult&&scheduledTestCase.LastResult.Build,LastRun:scheduledTestCase.LastResult&&scheduledTestCase.LastResult.Date,LastVerdict:scheduledTestCase.LastResult&&scheduledTestCase.LastResult.Verdict,LastResult:scheduledTestCase.LastResult,ScheduledTestCase:scheduledTestCase})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.collection.Writer",{extend:Rally.data.wsapi.Writer,alias:["writer.rally.data.collection.writer","writer.rallywsapicollectionwriter"],alternateClassName:["Rally.data.WsapiCollectionWriter"],writeAllFields:!1,write:function(request){return Ext.merge(request,{params:{order:"ObjectID ASC"},jsonData:{CollectionItems:_.map(_.sortBy(request.records,function(record){return record.getId()||1/0}),function(record){var ref=Rally.util.Ref.getRelativeUri(record);return ref?{_ref:ref}:this.getRecordData(record)},this)}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.ModelFactory",{alternateClassName:["Rally.data.WsapiModelFactory"],singleton:!0,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable,messageable:Rally.Messageable},_modelCache:{},subscribeForSchema:function(){this.subscribe(Rally.Message.schemaFetched,this._cacheSchema,this),this.isSubscribedToMessageBus=!0},getModel:function(options){function onGetModelsSuccess(models){var model=models[options.type];if(model)Ext.callback(options.success,options.scope,[model]),deferred.resolve(model);else{var message="Unable to load type definition for type "+options.type;Ext.callback(options.failure,options.scope,[message]),deferred.reject(message)}}function onGetModelsFailure(message){Ext.callback(options.failure,options.scope,[message]),deferred.reject(message)}var deferred=new Deft.Deferred;return this.getModels({context:options.context,types:[options.type],success:onGetModelsSuccess,failure:onGetModelsFailure,wsapiVersion:options.wsapiVersion,requester:options.requester}),deferred.promise},getModels:function(options){function onFetchSuccess(incomingModels){_.assign(builtModels,incomingModels),Ext.callback(options.success,options.scope,[builtModels]),deferred.resolve(builtModels)}var builtModels={},typeDefMetaDatasToFetch={},deferred=new Deft.Deferred,context=this._getContext(options.context);options.wsapiVersion=options.wsapiVersion||Rally.environment.getServer().getWsapiVersion(),options.types=_.isArray(options.types)?options.types:[options.types];var typeDefMetaDatas=_.map(options.types,function(requestedType){return new Rally.data.TypeDefinitionMetaData({context:context,wsapiVersion:options.wsapiVersion,requested:requestedType})});if(typeDefMetaDatas.forEach(function(typeDefMetaData){var model=this._getCachedModel(typeDefMetaData,options.requester);"undefined"==typeof model?typeDefMetaDatasToFetch[typeDefMetaData.getTypePath().toLowerCase()]=typeDefMetaData:builtModels[typeDefMetaData.getRequested()]=model},this),_.isEmpty(builtModels)){var fetchSuccess=Ext.bind(this._onTypeDefinitionsRetrieved,this,[context,typeDefMetaDatasToFetch,onFetchSuccess,options.requester],0),fetchFailure=Ext.bind(this._handleFailure,this,[typeDefMetaDatasToFetch,options.failure,options.scope,deferred],0),typeDefFetcher=Ext.create("Rally.data.TypeDefinitionFetcher",{wsapiVersion:options.wsapiVersion,clientMetricsParent:options.requester});typeDefFetcher.fetchTypeDefinitions(context,fetchSuccess,fetchFailure)}else Ext.callback(options.success,options.scope,[builtModels],1),deferred.resolve(builtModels);return deferred.promise},getPortfolioItemModels:function(options){if(options=options||{},!Rally.environment.getContext().getSubscription().isModuleEnabled("Rally Portfolio Manager"))return Deft.Promise.when([]);var wsapiVersion=options.wsapiVersion||Rally.environment.getServer().getWsapiVersion();return this.getModel(_.extend({type:"portfolioitem",wsapiVersion:wsapiVersion},options)).then({success:function(model){var context=this._getContext(options.context),typeDefMetaData=new Rally.data.TypeDefinitionMetaData({context:context,wsapiVersion:wsapiVersion,requested:"portfolioitem"}),fqn=typeDefMetaData.getFullyQualifiedName().toLowerCase(),portfolioItemCachedInfos=_.keys(this._modelCache).filter(function(key){return key.toLowerCase().indexOf(fqn)!==-1});return portfolioItemCachedInfos.map(function(piCachedInfo){var typeDefMetaData=new Rally.data.TypeDefinitionMetaData({context:context,wsapiVersion:wsapiVersion,requested:this._modelCache[piCachedInfo].typeDef.TypePath});return this._getCachedModel(typeDefMetaData,options.requester)},this)},scope:this})},clearModels:function(){this._modelCache&&(this._modelCache={})},clearCacheOnAttributeDefinitionChanges:function(){this.subscribe(Rally.Message.objectCreate,this._invalidateAttributeDefinitionCache,this),this.subscribe(Rally.Message.objectUpdate,this._invalidateAttributeDefinitionCache,this)},_invalidateAttributeDefinitionCache:function(records){records=Ext.Array.from(records),_.each(records,function(record){if("AttributeDefinition"===record.self.elementName||"Workspace"===record.self.elementName)return this.clearModels(),!1},this)},_getCachedModel:function(typeDefMetaData,requester){var model,fqn=typeDefMetaData.getFullyQualifiedName(),cachedInfo=this._modelCache[fqn],clientMetricsComponent={singleton:this,clientMetricsParent:requester};return cachedInfo&&(cachedInfo.model?model=cachedInfo.model:cachedInfo.typeDef&&(this.recordLoadBegin({description:"building models lazy",component:clientMetricsComponent,miscData:{typePath:typeDefMetaData.getTypePath().toLowerCase()}}),model=Rally.data.wsapi.ModelBuilder.build(typeDefMetaData,cachedInfo.typeDef),cachedInfo.model=model,this.recordLoadEnd({component:clientMetricsComponent}))),model},_cacheModel:function(typeDefMetaData,typeDefinition){this._modelCache[typeDefMetaData.getFullyQualifiedName()]={typeDef:typeDefinition}},_getContext:function(context){context=context||{},Ext.isFunction(context.getDataContext)&&(context=context.getDataContext());var calculatedContext={};return context.hasOwnProperty("workspace")&&(calculatedContext.workspace=context.workspace),context.hasOwnProperty("project")&&(calculatedContext.project=context.project,calculatedContext.project||(calculatedContext.workspace=calculatedContext.hasOwnProperty("workspace")?calculatedContext.workspace:"/workspace/"+Rally.environment.getContext().getWorkspace().ObjectID,null!==calculatedContext.project&&delete calculatedContext.project)),calculatedContext.workspace||calculatedContext.project||(calculatedContext.project="/project/"+Rally.environment.getContext().getProject().ObjectID),calculatedContext.project&&delete calculatedContext.workspace,calculatedContext},_onTypeDefinitionsRetrieved:function(context,typeDefMetaDatas,successCallback,requester,queryResult){var models={};if(!_.isEmpty(typeDefMetaDatas)){var wsapiVersion=_.values(typeDefMetaDatas)[0].getWsapiVersion(),typeDefs=queryResult.Results,modelsCached=_.some(typeDefMetaDatas,_.partialRight(this._getCachedModel,requester),this);modelsCached||(this.isSubscribedToMessageBus?Rally.environment.getMessageBus().publish(Rally.Message.schemaFetched,typeDefs,context,wsapiVersion):this._cacheSchema(typeDefs,context,wsapiVersion)),_.transform(typeDefMetaDatas,function(acc,typeDefMetaData){var cachedModel=this._getCachedModel(typeDefMetaData,requester);cachedModel&&(acc[typeDefMetaData.getRequested()]=cachedModel)},models,this)}Ext.callback(successCallback,this,[models])},_cacheSchema:function(typeDefs,context,wsapiVersion){_.each(typeDefs,function(typeDefinition){var typeDefMetaData=new Rally.data.TypeDefinitionMetaData({context:context,wsapiVersion:wsapiVersion,requested:typeDefinition.TypePath});this._cacheModel(typeDefMetaData,typeDefinition)},this)},_handleFailure:function(typeDefMetaDatas,failureCallback,failureCallbackScope,deferred){var types=_.invoke(_.values(typeDefMetaDatas),"getRequested"),message="Unable to load type definition for type(s) "+types.join(",");Ext.callback(failureCallback,failureCallbackScope,[message]),Rally.ui.notify.Notifier.showError({message:message}),deferred.reject(message)},buildProxy:function(url,elementName,writerType,wsapiVersion){return Rally.environment.getIoProvider().getProxy({url:url,wsapiVersion:wsapiVersion||Rally.environment.getServer().getWsapiVersion(),batchActions:"rally.data.collection.writer"===writerType,type:this._getProxyType(elementName,writerType),writer:{type:writerType||"rallywsapiwriter",root:elementName},reader:{type:this._getReaderType(elementName),root:elementName,totalProperty:"TotalResultCount"}})},buildProxyUrl:function(typePath,wsapiVersion){return Rally.environment.getServer().getWsapiUrl(wsapiVersion)+"/"+typePath},_getProxyType:function(elementName,writerType){return"rally.data.collection.writer"===writerType?"rallywsapicollectionproxy":"Artifact"===elementName?"rallywsapiartifactproxy":"rallywsapiproxy"},_getReaderType:function(elementName){return"Artifact"===elementName?"rallywsapiartifactreader":"rallywsapireader"}},function(){Rally.data.ModelFactory.registerTypes(_.keys(Rally.data.ModelTypes.types),this)})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.ParentChildMapper",{parentChildTypeMap:null,constructor:function(){this.parentChildTypeMap={hierarchicalrequirement:[{typePath:"defect",collectionName:"Defects",parentField:"Requirement"},{typePath:"task",collectionName:"Tasks",parentField:"WorkProduct"},{typePath:"testcase",collectionName:"TestCases",parentField:"WorkProduct"},{typePath:"hierarchicalrequirement",collectionName:"Children",parentField:"Parent"}],defect:[{typePath:"task",collectionName:"Tasks",parentField:"WorkProduct"},{typePath:"testcase",collectionName:"TestCases",parentField:"WorkProduct"}],defectsuite:[{typePath:"defect",collectionName:"Defects",parentField:"DefectSuites"},{typePath:"task",collectionName:"Tasks",parentField:"WorkProduct"},{typePath:"testcase",collectionName:"TestCases",parentField:"WorkProduct"}],testset:[{typePath:"task",collectionName:"Tasks",parentField:"WorkProduct"},{typePath:"testcase",collectionName:"TestCases",parentField:"TestSets"}],testcase:[{typePath:"defect",collectionName:"Defects",parentField:"TestCase"}],attributedefinition:[{typePath:"allowedattributevalue",collectionName:"AllowedValues",parentField:"AttributeDefinition"}]}},initDynamicTypes:function(context){return context=context||Rally.environment.getContext().getDataContext(),Rally.data.wsapi.ModelFactory.getPortfolioItemModels({context:context,requester:this}).then({success:function(piModels){var typeDefs=piModels.map(function(piModel){return piModel.typeDefinition});this._mergeDynamicTypes(typeDefs)},scope:this})},initDynamicTypesIfRequired:function(models,context){var hasDynamicTypes=_.any(models,function(model){var typePath=_.isString(model)?model:model.typePath;return typePath.match(/^portfolioitem/i)});return hasDynamicTypes?this.initDynamicTypes(context):Deft.Promise.when()},getChildCollections:function(parentTypePath){return this.parentChildTypeMap[parentTypePath.toLowerCase()]||[]},getExpandedCollectionNames:function(){return _.transform(this.parentChildTypeMap,function(acc,val,key){acc[key]=_.pluck(val,"collectionName")},{})},getParentFields:function(childTypePath,parentTypePath){var parentFields={};return childTypePath=this._sanitizeTypePath(childTypePath),_.each(this.parentChildTypeMap,function(childCollections,typePath){parentTypePath&&parentTypePath!==typePath||_.each(childCollections,function(childCollection){if(childCollection.typePath===childTypePath&&childCollection.parentField){var parentField={fieldName:childCollection.parentField,typePath:typePath};parentFields[parentField.fieldName]=parentField}})}),_.values(parentFields)},getParentField:function(parentTypePath,childTypePath){return _.find(this.parentChildTypeMap[this._sanitizeTypePath(parentTypePath)],function(childCollection){return childCollection.typePath===this._sanitizeTypePath(childTypePath)},this).parentField},_sanitizeTypePath:function(typePath){var newTypePath=typePath.toLowerCase().replace(/ /g,"");return"userstory"===newTypePath?"hierarchicalrequirement":newTypePath},isParentType:function(parentType){return _.has(this.parentChildTypeMap,parentType.toLowerCase())},getChildModelTypePaths:function(parentTypes,recursive,grandparentTypes){var children=this._getChildModelTypePaths(parentTypes),recursiveChildren=[];return recursive&&children.length&&(recursiveChildren=_.difference(children,_.compact(parentTypes.concat(grandparentTypes))),children=_.union(children,this.getChildModelTypePaths(recursiveChildren,!0,parentTypes))),children},_getChildModelTypePaths:function(parentTypes){return _.reduce(parentTypes,function(acc,parentType){var childCollections=this.parentChildTypeMap[parentType.toLowerCase()];return childCollections?_.union(acc,_.pluck(childCollections,"typePath")):acc},[],this)},_mergeDynamicTypes:function(typeDefs){var portfolioItemsByOrdinal=_.transform(typeDefs,function(acc,typeDef){var isPortfolioItem=typeDef.TypePath&&typeDef.TypePath.match(/^portfolioitem/i)&&typeDef.Ordinal>-1;isPortfolioItem&&(acc[typeDef.Ordinal]=typeDef)},{});_.each(portfolioItemsByOrdinal,function(typeDef){this._mergePortfolioItemType(typeDef,portfolioItemsByOrdinal)},this)},_mergePortfolioItemType:function(typeDef,portfolioItemsByOrdinal){var typePath=typeDef.TypePath.toLowerCase(),parent=portfolioItemsByOrdinal[typeDef.Ordinal+1],parentTypePath=(parent?parent.TypePath:"portfolioitem").toLowerCase();0===typeDef.Ordinal&&(this.parentChildTypeMap[typePath]=[{typePath:"hierarchicalrequirement",collectionName:"UserStories",parentField:"PortfolioItem"}]),parentTypePath&&(this.parentChildTypeMap[parentTypePath]=[{typePath:typePath,collectionName:"Children",parentField:"Parent"}])}})}(),function(){var Ext=window.Ext4||window.Ext,wsapiMaxPageSize=200;Ext.define("Rally.data.wsapi.TreeStore",{extend:Ext.data.TreeStore,alias:"store.rallywsapitreestore",mixins:{messageable:Rally.Messageable,findRecords:Rally.data.WsapiFindRecords,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},statics:{wsapiMaxPageSize:wsapiMaxPageSize},autoSync:!1,currentPage:1,pageSize:25,childPageSizeEnabled:!1,childPageSize:20,childPageSizeAdditional:200,context:void 0,wsapiVersion:void 0,nodeParam:void 0,model:void 0,parentTypes:[],fetch:void 0,enableHierarchy:!1,childLevelSorters:[],mapper:null,lazyFill:!0,sums:{},enableRootLevelPostGet:!1,constructor:function(config){this.callParent(arguments),0!==this.parentTypes.length&&this.model||Ext.Error.raise("You must configure the tree store with parentTypes and a model"),_.isEmpty(this.mapper)&&(this.mapper=Ext.create("Rally.data.wsapi.ParentChildMapper")),_.isEmpty(this.childLevelSorters)&&(this.childLevelSorters=this._getDefaultChildSorters()),this.addEvents("error","warning","currentpagereset"),this._decorateModels()},getSums:function(){return this.sums},setSums:function(sums){this.sums=sums},isHierarchyEnabled:function(){return this.enableHierarchy===!0},setRootNode:function(root,preventLoad){this.tree.on("rootchange",this._decorateModels,this,{single:!0}),this.callParent([root,preventLoad||!this.autoLoad])},remove:function(records){records=Ext.Array.from(records),this.totalCount-=records.length,_.invoke(records,"remove")},indexOf:function(record){return this.getRootNode().indexOf(record)},insert:function(index,records){records=Ext.Array.from(records),this.totalCount+=records.length;var rootNode=this.getRootNode();_.each(records,function(record){rootNode.insertChild(index,record),rootNode.incrementLeafCount()},this)},getTopLevelNodes:function(){var topLevelNodes=[];return this.each(function(node){1===node.getDepth()&&topLevelNodes.push(node)},this),topLevelNodes},getParentFieldNamesByChildType:function(childType,parentType){var model=this.model.getArtifactComponentModel(childType);return _.transform(this.mapper.getParentFields(childType,parentType),function(acc,field){var typePath=field.typePath,fieldName=field.fieldName,hasFieldModel=this.model.getArtifactComponentModel(typePath)||model.hasField(fieldName);hasFieldModel&&acc.push(fieldName.replace(/\s+/g,""))},[],this)},_getParentFieldNames:function(childTypePaths,parentTypePath){var parentFieldNames=[];return this.enableHierarchy&&_.each(childTypePaths,function(typePath){parentFieldNames=_.union(parentFieldNames,this.getParentFieldNamesByChildType(typePath.toLowerCase(),parentTypePath))},this),parentFieldNames},_getChildTypePaths:function(parentTypes){return this.enableHierarchy?_.intersection(this._getStoreTypePaths(),this.mapper.getChildModelTypePaths(parentTypes)):[]},_getStoreTypePaths:function(){return _.isFunction(this.model.getArtifactComponentModels)?_.pluck(this.model.getArtifactComponentModels(),"typePath"):[this.model.typePath]},isRootNode:function(node){return _.isEmpty(node)||isNaN(node.get("ObjectID"))},_getDefaultChildSorters:function(){return[{property:"TaskIndex",direction:"ASC"},{property:Rally.data.Ranker.getRankField(this.model),direction:"ASC"}]},_getCollectionFetchNames:function(typePaths){
var collectionFetchNames=_.reduce(typePaths,function(acc,typePath){return _.union(acc,_.pluck(this.mapper.getChildCollections(typePath),"collectionName"))},[],this);return _.contains(collectionFetchNames,"Tasks")&&collectionFetchNames.push("TaskIndex"),collectionFetchNames},_decorateModels:function(){var models=this.model;_.isFunction(models.getArtifactComponentModels)&&(models=models.getArtifactComponentModels()),_.each(Ext.Array.from(models),Rally.ui.grid.data.NodeInterface.decorate,Rally.ui.grid.data.NodeInterface)},_errors:[],load:function(options){this.recordLoadBegin({description:"tree store load",component:this.requester}),this._hasErrors=!1,options=this._configureLoad(options),options.originalCallback=options.callback;var deferred=Ext.create("Deft.Deferred"),me=this;return options.callback=function(records,operation,success){me.dataLoaded=!0,me.isRootNode(options.node)&&operation.resultSet&&operation.resultSet.sums&&me.setSums(operation.resultSet.sums),me._pageIsEmpty(operation)?me._reloadEmptyPage(options).then({success:function(records){me._resolveLoadingRecords(deferred,records,options,operation,success)},failure:function(){me._rejectLoadingRecord(deferred,options,operation)}}):me._resolveLoadingRecords(deferred,records,options,operation,success)},this._isViewReady()&&this._beforeInitialLoad(options),this.callParent([options]),deferred.promise},_rejectLoadingRecord:function(deferred,options,operation){delete options.callback,deferred.reject(operation)},_resolveLoadingRecords:function(deferred,records,options,operation,success){delete options.callback,options.originalCallback&&Ext.callback(options.originalCallback,options.scope||this,[records,operation,success]),deferred.resolve(records)},_beforeInitialLoad:function(options){var grid=this.ownerTree,view=grid.getView();this._isChildLoad(options)?view.loadMask&&(view.loadMask.bindStore(null),view.loadMask.destroy(),view.loadMask=!1):(grid.setLoading(!0),this.on("load",function(){grid.setLoading(!1)},this,{single:!0}))},_isViewReady:function(){var grid=this.ownerTree;return grid&&grid.view},_isChildLoad:function(options){return!(!options||!options.node||this.isRootNode(options.node))},_reloadEmptyPage:function(options){this._resetCurrentPage();var newOpts=_.clone(options);return delete newOpts.start,delete newOpts.callback,this.load(newOpts)},_configureLoad:function(options){if(Ext.isFunction(options)&&(options={callback:options}),options=options||{},this._isChildLoad(options)?(this.enableHierarchy||Ext.Error.raise("You cannot load child nodes if hierarchy is not enabled."),this._configureProxy(this._getChildTypePaths([options.node.self.typePath])),this._configureChildLoad(options),options.fetch=this.getChildFetch(options)):(this._configureProxy(this.parentTypes),this._configureRootLevelLoad(options),options.fetch=this.getParentFetch({fetch:options.fetch||this.fetch}),_.isEmpty(this.summaryFields)||(options.fetch=options.fetch.concat("sum:["+this.summaryFields.join(",")+"]"))),options.requester=this,options.clearOnLoad===!1){var clearOnLoad=this.clearOnLoad;this.clearOnLoad=!1,this.on("load",function(){this.clearOnLoad=clearOnLoad},this,{single:!0})}return options},_configureChildLoad:function(options){options.context=_.clone(this.context||{}),options.context.project=null,options.context.projectScopeUp=!0,options.context.projectScopeDown=!0,options.node.isTestSet()?(options.url=Rally.environment.getServer().getWsapiUrl()+Rally.util.Ref.getRelativeUri(options.node)+"/ScheduledChildren",options.filters=[],options.sorters=[]):(options.sorters=this.childLevelSorters||this._getDefaultChildSorters(),options.filters=this._getChildNodeFilters(options.node)),this.childPageSizeEnabled&&(options.params=options.params||{},options.params.pagesize=this.getChildPageSize(options.node),options.params.start=options.start||0)},_configureRootLevelLoad:function(options){options.params=options.params||{},options.params.pagesize=this.pageSize,options.params.start=this.pageSize*(this.currentPage-1),options.context=this.context,options.enablePostGet=this.enableRootLevelPostGet},_getChildNodeFilters:function(node){var parentType=node.self.typePath,childTypes=this._getChildTypePaths([parentType]),parentFieldNames=this._getParentFieldNames(childTypes,parentType);return parentFieldNames.length?[Rally.data.wsapi.Filter.or(_.map(parentFieldNames,function(parentFieldName){return{property:parentFieldName,operator:"=",value:node.get("_ref")}}))]:[]},filter:function(filters){this.fireEvent("beforefilter",this),this.filters.addAll(filters),this._resetCurrentPage(),this.load()},clearFilter:function(suppressEvent){this._resetCurrentPage(),this.filters.clear(),suppressEvent||this.load()},getAt:function(id){return this.getNodeById(id)},getTotalCount:function(){return this.totalCount},getChildPageSize:function(node){return node.hasChildNodes()?this._getChildPageSizeAdditional():this.childPageSize},_getChildPageSizeAdditional:function(){return Ext.isIE||!this.childPageSizeAdditional?this.childPageSize:this.childPageSizeAdditional},nextPage:function(){this._setCurrentPage(this.currentPage+1),this.load()},previousPage:function(){this._setCurrentPage(this.currentPage-1),this.load()},loadPage:function(pageNum){this._setCurrentPage(pageNum),this.load()},clearData:function(){var rootNode=this.getRootNode();rootNode&&(rootNode.suspendEvents(),rootNode.removeAll(!1),rootNode.resumeEvents())},_setCurrentPage:function(pageNum){var maxPage=Math.ceil(this.getTotalCount()/this.pageSize);this.currentPage=Math.min(Math.max(pageNum,1),maxPage)},_resetCurrentPage:function(){this.dataLoaded===!0&&(this.fireEvent("currentpagereset"),this.currentPage=1)},_hasErrors:!1,hasErrors:function(){return this._hasErrors},_pageIsEmpty:function(operation){var resultSet=operation.getResultSet();return resultSet&&this.currentPage>1&&this.isRootNode(operation.node)&&0===resultSet.count},onProxyLoad:function(operation){if(_.isEmpty(operation.warnings)||this.fireEvent("warning",this,operation.warnings,operation),operation.error&&operation.error.errors&&operation.error.errors.length>0?(this._hasErrors=!0,this.fireEvent("error",operation.error.errors)):operation.getResultSet()&&this.isRootNode(operation.node)&&(this.totalCount=operation.getResultSet().total),!this.clearOnLoad&&operation.node===this.getRootNode()){var recordsById=_.indexBy(operation.getRecords(),function(record){return record.getId()});_.each(Ext.clone(operation.node.childNodes),function(childNode){var record=recordsById[childNode.getId()];if(record){if(record.get("VersionId")!==childNode.get("VersionId")){var newData=_(record.raw).keys().reduce(function(accum,key){return accum[key]=record.get(key),accum},{});childNode.set(newData),childNode.commit()}}else childNode.remove(!1)})}this.recordLoadEnd(),this.recordLoadBegin({description:"tree store after load callParent"}),_.invoke(operation.getRecords(),"resetLeafCount",this.enableHierarchy,this.mapper.getExpandedCollectionNames()),this.callParent(arguments),this.recordLoadEnd(),this.ownerTree&&this.ownerTree.fireEvent("afterproxyload")},each:function(fn,scope){this._treeWalkingEach(fn,this.tree.root,scope,!0)},_treeWalkingEach:function(fn,node,scope,ignoreNode){return _.each(node.childNodes,function(childNode){if(this._treeWalkingEach(fn,childNode,scope)===!1)return!1},this),ignoreNode===!0||fn.call(scope||node,node)},getNodeById:function(id){return this.callParent(arguments)||this.findExactRecord(id)},findExactRecord:function(record){var recordId=Rally.util.Ref.getOidFromRef(record)||record;return this.getRootNode().findChild(this.model.prototype.idProperty,recordId,!0)},findAllRecordsWithId:function(id){var records=[];return this.each(function(record){record.getId()===id&&records.push(record)}),records},_configureProxy:function(typePaths){this.proxy=this.model.getProxy(),Rally.data.ModelTypes.isCompositeModel(this.model)&&this.proxy.setExtraParam("types",typePaths.join(","))},getChildFetch:function(options){var childTypes=this._getChildTypePaths([options.node.self.typePath]),fetch=this._getFetchWithCollections(options.fetch||this.fetch,childTypes);if(fetch===!0)return!0;options.node.isTestSet()&&fetch.push("TestCase");var sorterProperties=_.pluck(Ext.Array.from(options.sorters||[]),"property");return _.union(fetch,sorterProperties)},getParentFetch:function(options){var parentTypes=this.parentTypes;return this._getFetchWithCollections(options.fetch,parentTypes)},_getFetchWithCollections:function(fetch,typePaths){return!(fetch!==!0&&fetch&&!_.isEmpty(fetch))||(_.isString(fetch)&&(fetch=fetch.split(",")),fetch=_.union(fetch,["ObjectID","VersionId"]),this.enableHierarchy&&(fetch=_.union(fetch,this._getCollectionFetchNames(typePaths),this._getParentFieldNames(typePaths))),this.model.isTask()&&fetch.push("TaskIndex"),fetch)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.TreeStoreBuilder",{extend:Rally.data.DataStoreBuilder,build:function(config){return config=_.clone(config||{}),config.storeType="Rally.data.wsapi.TreeStore",this.callParent([config])},loadModels:function(config){return config.mapper||(config.mapper=Ext.create("Rally.data.wsapi.ParentChildMapper")),this.callParent([config]).then({success:function(models){return config.mapper.initDynamicTypesIfRequired(models,config.context).then({success:function(){return this._setupTreeModel(this._getComponentModels(models),config)},scope:this})},scope:this})},_getComponentModels:function(models){return _.reduce(models,function(result,model){return _.isFunction(model.getArtifactComponentModels)?result.concat(model.getArtifactComponentModels()):result.concat(model)},[])},_setupTreeModel:function(models,config){var modelsToLoad=[],allTypes=_.pluck(models,"typePath"),parentTypes=_.filter(allTypes,config.mapper.isParentType,config.mapper);return config.enableHierarchy=config.enableHierarchy&&parentTypes.length>0,config.enableHierarchy?(config.parentTypes=parentTypes,modelsToLoad=this._getChildModelsToLoad(config)):config.parentTypes=allTypes,modelsToLoad.length>0?this._loadChildModels(modelsToLoad,models,config):Deft.Promise.when(models)},_getChildModelsToLoad:function(config){return _.difference(config.mapper.getChildModelTypePaths(config.parentTypes,!0),config.parentTypes)},_loadChildModels:function(modelsToLoad,loadedModels,config){return Rally.data.ModelFactory.getModels({context:config.context,types:modelsToLoad,requester:config.requester||this}).then({success:function(newModels){return _.union(loadedModels,_.values(newModels))}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.PagingToolbar",{extend:Rally.ui.grid.PagingToolbar,alias:"widget.rallytreepagingtoolbar",_onSubsequentLoads:function(store,node,records,successful,options){var hasTopLevelRecord=_.any(records,function(record){var isChildRecord=record.get("depth")>1;return!isChildRecord});hasTopLevelRecord&&this._reRender(),this._recordMetricsEnd()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.FormattedIDTreeColumn",{extend:Ext.tree.Column,alias:"widget.rallyformattedidtreecolumn",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},clientMetrics:[{event:"expandall",description:"expand all clicked"},{event:"collapseall",description:"collapse all clicked"}],renderTpl:['<div class="icon-expandall expand-all-button ',Ext.baseCSSPrefix,'column-header-inner"></div>','<div id="{id}-titleEl" role="presentation" {tipMarkup}class="',Ext.baseCSSPrefix,"column-header-inner",'<tpl if="empty"> ',Ext.baseCSSPrefix,'column-header-inner-empty</tpl> formatted-id-column-header-inner">','<span id="{id}-textEl" class="',Ext.baseCSSPrefix,"column-header-text",'{childElCls}">',"{text}","</span>",'<tpl if="!menuDisabled">','<div id="{id}-triggerEl" role="presentation" class="',Ext.baseCSSPrefix,"column-header-trigger",'{childElCls}"></div>',"</tpl>","</div>","{%this.renderContainer(out,values)%}"],bubbleEvents:["expandall","collapseall"],expandAllActive:!1,afterRender:function(){this.buttonEl=this.getEl().down(".expand-all-button"),this.buttonEl.on("click",this._onButtonClick,this),this._createTooltip()},_createTooltip:function(){this.tip=Ext.create("Ext.tip.ToolTip",{target:this.buttonEl,html:"Expand All",anchor:"top",anchorOffset:-6,listeners:{beforeshow:function(tip){tip.update(this.expandAllActive?"Collapse All":"Expand All")},scope:this}})},destroy:function(){var el=this.getEl();el&&el.select(".expand-all-button").un("click",this._onButtonClick,this),this.tip&&this.tip.destroy(),this.callParent(arguments)},_onButtonClick:function(){this.expandAllActive?this._collapseAll():this._expandAll()},_expandAll:function(){this.buttonEl.removeCls("icon-expandall"),this.buttonEl.addCls("icon-collapseall"),this.fireEvent("expandall",this),this.expandAllActive=!0},_collapseAll:function(){this.buttonEl.removeCls("icon-collapseall"),this.buttonEl.addCls("icon-expandall"),this.fireEvent("collapseall",this),this.expandAllActive=!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.view.NoData",{showNoData:function(config){if(this.getTargetEl()){this._removeNoDataContainer();var tpl=Ext.create("Ext.XTemplate",['<div class="no-data-container">','<div class="primary-message">{[this.getPrimaryText(values)]}</div>','<div class="secondary-message">{[this.getSecondaryText(values)]}</div>','<tpl if="noDataHelpLink && noDataHelpLink.url">','<div class="secondary-message">If it is unclear why you have no results,<br/>our <a href="{noDataHelpLink.url}" ',"title=\"{[values.noDataHelpLink.title || 'Help Page']}\" ",'target="_blank">help page</a> may provide an explanation.</div>',"</tpl>","</div>",{getPrimaryText:function(options){return options.primaryText||"Based on your selections, no "+Ext.util.Inflector.pluralize(options.itemName)+" were found."},getSecondaryText:function(options){return options.secondaryText||"You may have applied too many filters. Or, you may be at a Workspace or Project scope that prevents your items from being shown."}}]);Ext.core.DomHelper.insertHtml("beforeEnd",this.getTargetEl().dom,tpl.apply(_.merge({itemName:"work item"},config)))}},_removeNoDataContainer:function(){var noDataContainer=this.getTargetEl().down(".no-data-container");noDataContainer&&noDataContainer.remove()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeView",{extend:Ext.tree.View,alias:"widget.rallytreeview",mixins:{messageable:Rally.Messageable,noData:Rally.ui.view.NoData},statics:{childNodeCls:"node-child"},initComponent:function(){this.addEvents("beforenewtemplate","afternonvisibleitemexpand","afternonvisibleitemcollapse"),this.relayEvents(this.getTreeStore(),["load"],"store"),this.mon(this.getTreeStore(),"expand",this._expandHandler,this),this.mon(this.getTreeStore(),"error",this._errorHandler,this),this.on("itemadd",this._onItemAddOrRemove,this),this.on("itemremove",this._onItemAddOrRemove,this),this.callParent(arguments)},getCellCls:function(record,column){return Rally.ui.grid.CellClsDecorator.getCellCls(record,column)},getRowClass:function(record){var extraCls=record.parentNode.isRoot()?"":" "+Rally.ui.grid.TreeView.childNodeCls;return Rally.util.Test.toBrowserTestCssClass("row",record.getId())+extraCls},refresh:function(){this.fireEvent("beforenewtemplate"),this.callParent(arguments)},onAdd:function(store,records,index){this._isBuffered()?this._bufferedOnAdd(store,records,index):this.callParent([store,records,index])},doAdd:function(records,index){return this._isBuffered()?this._bufferedDoAdd(records,index):this.callParent([records,index])},onRemove:function(ds,records,indexes){this._isBuffered()?this._bufferedOnRemove(ds,records,indexes):this.callParent([ds,records,indexes])},getFirstVisibleNode:function(nodes){var viewRange=this.getViewRegion(),firstVisibleNode=null;return _.each(nodes,function(node){var nodeEl=this.getNode(node),nodeDomElement=nodeEl&&Ext.fly(nodeEl),nodeY=nodeEl&&nodeDomElement.getY()+nodeDomElement.getHeight();if(nodeEl&&nodeY>viewRange.y)return firstVisibleNode=node,!1},this),firstVisibleNode},onCollapse:function(parent){this.all.getCount()&&Ext.Array.contains(parent.stores,this.store)&&this.getNode(parent)||this.fireEvent("afternonvisibleitemcollapse",parent),this.callParent(arguments)},_bufferedOnRemove:function(ds,records,indexes){var empty,i,me=this;if(me.viewReady){if(empty=0===me.store.getCount(),empty&&!indexes.length)me.refresh();else for(i=indexes.length-1;i>=0;--i)this._indexIsWithinBufferedRange(indexes[i])?me.doRemove(records[i],indexes[i]):this._indexIsLowerThanBufferedRange(indexes[i])&&this.all.shiftIndexesLeftByOne();if(me.hasListeners.itemremove)for(i=indexes.length-1;i>=0;--i)me.fireEvent("itemremove",records[i],indexes[i])}},onFillComplete:function(treeStore,fillRoot,newNodes){var me=this,store=me.store,start=store.indexOf(newNodes[0]);store.resumeEvents(),newNodes.length&&start!==-1&&(me.onAdd(me.store,newNodes,start),me.refreshPartner())},onBeforeExpand:function(parent,records,index){var animWrap,me=this;me.rendered&&me.all.getCount()&&me.animate&&me.getNode(parent)&&(animWrap=me.getAnimWrap(parent,!1),animWrap?animWrap.collapsing&&animWrap.targetEl.select(me.itemSelector).destroy():animWrap=me.animWraps[parent.internalId]=me.createAnimWrap(parent),animWrap.expanding=!0,animWrap.collapsing=!1)},onExpand:function(parent){var animWrap,animateEl,targetEl,me=this,queue=me.animQueue,id=parent.getId(),node=me.getNode(parent),index=node?me.indexOf(node):-1;return me.singleExpand&&me.ensureSingleExpand(parent),index===-1?void this.fireEvent("afternonvisibleitemexpand",parent):(animWrap=me.getAnimWrap(parent,!1),me.refreshSize(),animWrap?(animateEl=animWrap.animateEl,targetEl=animWrap.targetEl,animateEl.stopAnimation(),queue[id]=!0,Ext.on("idle",function(){animateEl.dom.style.height="0px"},null,{single:!0}),animateEl.animate({from:{height:0},to:{height:targetEl.getHeight()},duration:me.expandDuration,listeners:{afteranimate:function(){var items=targetEl.query(me.itemSelector);items.length&&animWrap.el.insertSibling(items,"before",!0),animWrap.el.remove(),me.animWraps[animWrap.record.internalId]=queue[id]=null}},callback:function(){parent.isExpandingOrCollapsing=!1,me.fireEvent("afteritemexpand",parent,index,node)}}),void(animWrap.isAnimating=!0)):(parent.isExpandingOrCollapsing=!1,void me.fireEvent("afteritemexpand",parent,index,node)))},_expandHandler:function(node,children){this.getTreeStore().getRootNode()!==node&&0===children.length&&(this.refresh(),this.getTreeStore().hasErrors()||Rally.ui.notify.Notifier.showWarning({message:node.get("FormattedID")+" no longer has children."}))},_errorHandler:function(errors){_.each(errors,function(error){Rally.ui.notify.Notifier.showError({message:error})})},_onItemAddOrRemove:function(){_.each(this._getNodes(),function(node){_.each(this._getRankCells(node),function(rankCell){rankCell&&""!==rankCell.getHTML()&&rankCell.setHTML(Rally.ui.grid.DragAndDropRankColumnRenderer.getRankValue(this.getRecord(node),this.getStore()))},this)},this)},_getRankCells:function(node){return _.compact([Ext.fly(node).down("td.rally-grid-cell-taskindex ."+Ext.baseCSSPrefix+"grid-cell-inner"),Ext.fly(node).down("td.rally-grid-cell-draganddroprank ."+Ext.baseCSSPrefix+"grid-cell-inner")])},_getNodes:function(){return this._isBuffered()?_.values(this.all.elements):this.getNodes()},_bufferedOnAdd:function(ds,records,index){this._indexIsWithinBufferedRange(index)&&(Ext.view.AbstractView.prototype.onAdd.call(this,ds,records,index),this.bufferedRenderer.treeViewAdd(),this.doStripeRows(index),this._updateSelectionModel(records,index))},_isBuffered:function(){return this.bufferedRenderer&&this.all.getCount()},_bufferedDoAdd:function(records,index){var sibling,relation,all=this.all,nodes=this.bufferRender(records,index,!0);return 0===index?(sibling=all.item(index),relation="before"):(sibling=all.item(index-1),relation="after"),sibling&&sibling.insertSibling(nodes,relation,!0),all.insert(index,nodes),nodes},_updateSelectionModel:function(records,index){var nextIndex,isNextRowSelected,isNextRowFocused,me=this,selModel=me.selModel;me.rendered&&selModel.isRowModel&&!records[0].isCollapsedPlaceholder&&(nextIndex=index+records.length,isNextRowSelected=selModel.isRowSelected(nextIndex),isNextRowFocused=me.indexOf(selModel.lastFocused)===nextIndex,(isNextRowSelected||isNextRowFocused)&&me.onRowDeselect(index),isNextRowSelected&&me.onRowSelect(nextIndex),selModel.isRowSelected(index)&&me.onRowSelect(index)),me.selModel.onLastFocusChanged(null,me.selModel.lastFocused,!0)},_indexIsWithinBufferedRange:function(index){var all=this.all;return _.has(all,"startIndex")&&_.has(all,"endIndex")&&index>=all.startIndex&&index<=all.endIndex+1},_indexIsLowerThanBufferedRange:function(index){var all=this.all;return _.has(all,"startIndex")&&index<all.startIndex},autoSizeColumn:function(header,allowWrapping,allowShrinking){if(allowWrapping=allowWrapping!==!1,allowShrinking=allowShrinking!==!1,Ext.isNumber(header)&&(header=this.getGridColumns()[header]),header){if(header.isGroupHeader)return void header.autoSize();var newWidth=this.getContentWidth(header,allowWrapping);allowShrinking||(newWidth=Math.max(header.getWidth(),newWidth)),newWidth!==header.getWidth()&&(delete header.flex,header.setWidth(newWidth))}},getContentWidth:function(header,allowWrapping){allowWrapping=allowWrapping!==!1;var maxWidth,me=this,cells=me.el.query(header.getCellInnerSelector()),originalWidth=header.getWidth(),i=0,ln=cells.length,columnSizer=me.body.select(me.getColumnSizerSelector(header)),max=Math.max,widthAdjust=4,minAllowedWidth=40;ln>0&&(Ext.supports.ScrollWidthInlinePaddingBug&&(widthAdjust+=me.getCellPaddingAfter(cells[0])),me.columnLines&&(widthAdjust+=Ext.fly(cells[0].parentNode).getBorderWidth("lr")),(Ext.isGecko||Ext.isWindows&&Ext.isSafari)&&(widthAdjust+=4)),columnSizer.setWidth(1),header.titleEl.setStyle("text-overflow","clip"),maxWidth=header.textEl.dom.offsetWidth+header.titleEl.getPadding("lr"),header.titleEl.setStyle("text-overflow","");for(var cell,cellEl;i<ln;i++)cell=cells[i],cellEl=Ext.fly(cell),allowWrapping||(cellEl.setStyle("text-overflow","clip"),cellEl.setStyle("white-space","nowrap"),cellEl.setStyle("height","20px")),maxWidth=max(maxWidth,cell.scrollWidth),allowWrapping||(cellEl.setStyle("height",""),cellEl.setStyle("white-space",""),cellEl.setStyle("text-overflow",""));return maxWidth+=widthAdjust,maxWidth=max(maxWidth,minAllowedWidth),columnSizer.setWidth(originalWidth),maxWidth}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.ColumnAutoSizer",{extend:Ext.AbstractPlugin,alias:"plugin.rallycolumnautosizerplugin",expandIconWidth:20,idIconWidth:18,characterWidth:7,cellPadding:6,minHierarchyDepth:3,maxFormattedIdWidth:0,init:function(cmp){this.callParent(arguments),cmp.on("itemexpand",this._onItemExpand,this),cmp.on("afterexpandall",this._reset,this),cmp.on("afterstateexpand",this._reset,this),cmp.on("reconfigure",this._reset,this)},_reset:function(){this.maxFormattedIdWidth=0,this._onItemExpand()},_onItemExpand:function(){var maxWidth=this._getWidestFormattedId();maxWidth>this.maxFormattedIdWidth&&(maxWidth+=2*this.characterWidth,this._autoSizeCols(maxWidth),this.maxFormattedIdWidth=maxWidth)},_getWidestFormattedId:function(){var maxWidth=0;return this.cmp.getStore().each(function(record){var width=this._getFormattedIdWidth(record);width>maxWidth&&(maxWidth=width)},this),maxWidth},_autoSizeCols:function(maxIdWidth){Ext.suspendLayouts(),this._sizeFormattedIdCol(maxIdWidth),Ext.resumeLayouts(!1)},_sizeFormattedIdCol:function(width){var col=this._getColumnForAutosizeByDataIndex("FormattedID");col&&(delete col.flex,col.setWidth(width))},_getColumnForAutosizeByDataIndex:function(dataIndex){var columns=this.cmp.columns,colIndex=_.findIndex(columns,{dataIndex:dataIndex});return colIndex>=0&&colIndex<columns.length-1?columns[colIndex]:void 0},_getFormattedIdWidth:function(record){var formattedId=record.get("FormattedID")||"",width=this.idIconWidth+formattedId.length*this.characterWidth;if(this.cmp.getStore().enableHierarchy){var depth=record.get("depth")||1;width+=Math.max(depth,this.minHierarchyDepth)*this.expandIconWidth}return width}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.FormattedIDHoverable",{extend:Ext.AbstractPlugin,alias:"plugin.rallyboardformattedidhoverable",mixins:[Rally.clientmetrics.ClientMetricsRecordable],init:function(cmp){this.callParent(arguments),this._delayedTask=Ext.create("Ext.util.DelayedTask",this._showPopover,this),this.cmp.on("afterrender",function(){this.cmp.getEl().on("mouseover",this._onMouseOver,this,{delegate:".formatted-id-link"}),this.cmp.getEl().on("mouseout",this._onMouseOut,this,{delegate:".formatted-id-link"})},this,{single:!0})},_onMouseOver:function(event,target){this._delayedTask.delay(500,null,null,[target])},_onMouseOut:function(){this._delayedTask.cancel()},_showPopover:function(target){var el=Ext.get(target),tr=el.up(this.cmp.view.getDataRowSelector()),record=this.cmp.getRecord(tr);if(record&&!Ext.getElementById("description-popover")){var targetRef=el.dom.href&&_.last(el.dom.href.split("/detail/")),targetOid=targetRef&&Rally.util.Ref.getOidFromRef(targetRef),popoverOptions={context:this.cmp.context,field:"Description",target:el,targetSelector:"#"+el.id};targetOid&&record.get("ObjectID")!==targetOid?(popoverOptions.oid=targetOid,popoverOptions.type=Rally.util.Ref.getTypeFromRef(targetRef)):popoverOptions.record=record,this.recordAction({description:"showing formatted id hover on grid"}),Rally.ui.popover.PopoverFactory.bake(popoverOptions)}},destroy:function(){this._delayedTask&&this._delayedTask.cancel()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.TreeGridChildPager",{extend:Ext.AbstractPlugin,alias:"plugin.rallytreegridchildpager",pagerTemplate:new Ext.XTemplate('<tr class="load-more-children-row {pagerCls} {prefix}grid-row" tabindex="-1">','<td class="left-cell" colspan="{leftColCount}"></td>','<td class="pager-cell {prefix}grid-cell {prefix}grid-td" colspan="{colSpan}" style="padding-left: {paddingLeft}px">',"<span>Showing {loadedCount} of {leafCount} children of {FormattedID}.</span>&nbsp;&nbsp;",'<a href="javascript:void(0)">{[this.getLinkPrefix(values)]} remaining work items</a>',"</td>","</tr>",{getLinkPrefix:function(data){return data.totalRemaining<=data.nextPageSize?"Show all":"Show the next "+data.nextPageSize+" of "+data.totalRemaining}}),init:function(cmp){this.callParent(arguments),this.cmp.addEvents(["childpageload"]),this.cmp.getView().addEvents(["bufferedscroll"]),this.cmp.on("childpageload",this._onChildPageLoad,this),this.cmp.on("afterchildadd",this._onAfterChildAdd,this),this.cmp.on("itemmove",this._onItemMove,this),this.cmp.on("collapseall",this._onCollapseAll,this),this.cmp.mon(this.cmp.getView(),"afteritemcollapse",this._onAfterItemCollapse,this),this.cmp.mon(this.cmp.getView(),"afteritemexpand",this._onAfterItemExpand,this),this.cmp.mon(this.cmp.getView(),"bufferedscroll",this._onBufferedScroll,this),this.cmp.mon(this.cmp.getStore(),"remove",this._onChildItemDelete,this),this.cmp.mon(this.cmp.getStore(),"insert",this._onChildItemsChange,this)},destroy:function(){this.cmp.un("childpageload",this._onChildPageLoad,this),this.cmp.un("afterchildadd",this._onAfterChildAdd,this),this.cmp.un("itemmove",this._onItemMove,this),this.cmp.un("storebeforecollapse",this._onAfterItemCollapse,this),this.cmp.un("collapseall",this._onCollapseAll,this),this.callParent(arguments)},_showPager:function(parentRecord,afterDom){var data=parentRecord.raw,formattedIdIdx=_.findIndex(this.cmp.columns,{dataIndex:"FormattedID"});if(afterDom){data.paddingLeft=60+16*this._getNodeDepth(parentRecord),data.prefix=Ext.baseCSSPrefix,data.leftColCount=formattedIdIdx,data.loadedCount=this._getLoadedCount(parentRecord),data.nextPageSize=Math.min(this.cmp.getStore().getChildPageSize(parentRecord),parentRecord.get("leafCount")-data.loadedCount),data.totalRemaining=parentRecord.get("leafCount")-data.loadedCount,data.pagerCls=this._getRecordPagerCls(parentRecord),data.colSpan=this.cmp.columns.length-data.leftColCount+1,data.moreText=data.nextPageSize>1?"children":"child",data.leafCount=parentRecord.get("leafCount");var el=Ext.get(this.pagerTemplate.insertAfter(afterDom,data));el.addClsOnOver(Ext.baseCSSPrefix+"grid-row-highlighted"),el.on("click",function(ext){ext.stopEvent(),this.cmp.fireEvent("childpageload",this.cmp,parentRecord)},this)}},_getNodeDepth:function(node){for(var parent=node.parentNode,depth=0;parent;)parent=parent.parentNode,depth++;return depth},_hidePager:function(parentRecord,recurse){recurse&&_.isArray(parentRecord.childNodes)&&_.each(parentRecord.childNodes,function(childNode){this._hidePager(childNode,recurse)},this);var pagerEls=this.cmp.getEl().query("."+this._getRecordPagerCls(parentRecord));_.each(pagerEls,function(el){Ext.get(el).destroy()})},_getRecordPagerCls:function(record){return"parent-id-"+record.get("ObjectID")},_onChildPageLoad:function(cmp,parentRecord){cmp.getStore().load({clearOnLoad:!1,node:parentRecord,start:this._getLoadedCount(parentRecord)}).then({success:function(childNodes){childNodes.length?(this._togglePager(parentRecord),this._toggleRecursivelyUp(parentRecord)):this._hidePager(parentRecord)},scope:this})},_getLoadedCount:function(parentRecord){return _.isArray(parentRecord.childNodes)?parentRecord.childNodes.length:0},_storeHasMoreChildPages:function(parentRecord){var loadedCount=this._getLoadedCount(parentRecord);return parentRecord.get("leafCount")>loadedCount},_togglePager:function(node){if(!this.cmp.getStore().isRootNode(node)&&this._getLoadedCount(node)>0&&(this._hidePager(node),node.isExpanded()&&this._storeHasMoreChildPages(node))){var afterDom=this._getInsertAfterDom(node);afterDom&&this._showPager(node,afterDom)}},_getInsertAfterDom:function(node){for(var childPagerEl,lastVisibleDescendant,view=this.cmp.getView(),viewEl=view.getEl();node&&!_.isEmpty(node.childNodes);)if(node=_.last(node.childNodes),node.isVisible()&&(lastVisibleDescendant=node),childPagerEl=viewEl.down("."+this._getRecordPagerCls(node)))return childPagerEl;return view.getNode(lastVisibleDescendant)},_toggleAllPagers:function(node){Ext.suspendLayouts(),node&&(_.each(node.childNodes,function(childNode){this._toggleAllPagers(childNode)},this),this.cmp.getStore().isRootNode(node)||this._togglePager(node)),Ext.resumeLayouts(!1)},_onBufferedScroll:function(newRecords){_.each(newRecords,function(newRecord){this._toggleRecursivelyUp(newRecord)},this)},_toggleRecursivelyUp:function(record){var parentRecord=record.parentNode;this._getNodeDepth(record)>1&&this._isLastVisibleChild(record,parentRecord)&&(this._toggleRecursivelyUp(parentRecord),this._storeHasMoreChildPages(parentRecord)&&this._togglePager(parentRecord))},_isLastVisibleChild:function(record,parentRecord){var lastRecord=_.last(parentRecord.childNodes);return lastRecord.getId()===record.getId()},_onAfterChildAdd:function(cmp,parentNode){this._toggleAllPagers(parentNode)},_onAfterItemExpand:function(node){this._toggleAllPagers(node.parentNode)},_onItemMove:function(node){this._toggleAllPagers(node.parentNode)},_onCollapseAll:function(){var childNodes=this.cmp.getRootNode().childNodes,store=this.cmp.getStore();childNodes&&_.each(childNodes,function(node){node.isExpanded()&&node.childNodes.length>=store.childPageSize&&this._hidePager(node,!0)},this)},_onAfterItemCollapse:function(parentNode){this._toggleAllPagers(parentNode.parentNode)},_onChildItemDelete:function(parentNode,childNode,moved){moved!==!0&&(parentNode.childNodes&&parentNode.childNodes.length>0&&parentNode.set("leaf",!1),this._onChildItemsChange(parentNode,childNode))},_onChildItemsChange:function(parentNode,childNode){childNode&&!childNode.replacedByNode&&(this._hidePager(childNode,!0),this.cmp.getStore().isRootNode(parentNode)||this._togglePager(parentNode))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.StoreUpdater",{alias:"plugin.rallystoreupdater",require:["Rally.util.Ref","Deft.promise.Deferred","Rally.data.wsapi.Filter","Rally.ui.grid.data.NodeInterface"],
mixins:{messageable:Rally.Messageable},constructor:function(config){_.extend(this,config||{}),this.store.id||(this.store.id=this._generateStoreId()),this.subscribe(Rally.Message.objectCreate,this._onObjectCreate,this),this.subscribe(Rally.Message.objectUpdate,this._onObjectUpdate,this),this.subscribe(Rally.Message.objectDestroy,this._onObjectDestroy,this),this.subscribe(Rally.Message.bulkUpdate,this._onBulkUpdate,this)},destroy:function(){this.unsubscribe(Rally.Message.objectCreate,this._onObjectCreate,this),this.unsubscribe(Rally.Message.objectUpdate,this._onObjectUpdate,this),this.unsubscribe(Rally.Message.objectDestroy,this._onObjectDestroy,this),this.unsubscribe(Rally.Message.bulkUpdate,this._onBulkUpdate,this)},_generateStoreId:function(){var lastStoreId=this.self.lastStoreId||0;return lastStoreId++,this.self.lastStoreId=lastStoreId,"updatable-store-"+lastStoreId.toString()},_onBulkUpdate:function(updatedRecords,changeObject,updatingCmp){var promises=[],refsToRefresh=[],topLevelRefsToRefresh=[],topLevelRecords=[],store=this.store,changedFields=_.keys(changeObject);updatingCmp&&updatingCmp.suspendLayouts&&updatingCmp.suspendLayouts(),store.suspendEvents(!0),_.each(updatedRecords,function(record){this._isTopLevelRecord(record)?(topLevelRefsToRefresh.push(record.get("_ref")),topLevelRecords.push(record)):refsToRefresh.push(record.get("_ref")),refsToRefresh=_.union(refsToRefresh,this._getRefsToRefresh(record,[]))},this),refsToRefresh.length&&promises.push(this._refreshRecords(refsToRefresh)),topLevelRefsToRefresh.length&&promises.push(this._refreshTopLevelBulkRecords(topLevelRefsToRefresh,topLevelRecords,changedFields)),promises.push(this._removeRecordsFromOldParents(updatedRecords,changedFields)),this._handleUpdate(promises,!1,"afterbusbulkupdate",updatedRecords,[],updatingCmp)},_onObjectUpdate:function(updatedRecord,updatedFields,updatingCmp,associatedRecords){var promises=[],store=this.store,refsToRefresh=this._getRefsToRefresh(updatedRecord,associatedRecords);store.suspendEvents(!0),promises.push(this._updateRecord(updatedRecord,updatedFields)),promises.push(this._removeRecordsFromOldParents([updatedRecord],updatedFields)),refsToRefresh.length&&promises.push(this._refreshRecords(refsToRefresh)),this._handleUpdate(promises,!1,"afterbusupdate",updatedRecord,refsToRefresh,updatingCmp)},_onObjectDestroy:function(removedRecord,removingCmp,associatedRecords){var store=this.store,recordsToRemove=store.findAllRecordsWithId(removedRecord.getId()),refsToRefresh=this._getRefsToRefresh(removedRecord,associatedRecords);store.suspendEvents(!0),_.each(recordsToRemove,function(recordToRemove){recordToRemove.parentNode&&recordToRemove.parentNode.decrementLeafCount(),store.remove(recordToRemove)}),this._handleUpdate(refsToRefresh.length?[this._refreshRecords(refsToRefresh)]:[],!1,"afterbusremove",removedRecord,refsToRefresh,removingCmp)},_onObjectCreate:function(createdRecord,creatingCmp,associatedRecords){var checkIfRecordExcluded,addRecordPromises=[],store=this.store,refsToRefresh=this._getRefsToRefresh(createdRecord,associatedRecords);store.suspendEvents(!0),addRecordPromises.push(this._addRecordToTopLevelIfMatchesFilter(createdRecord,creatingCmp)),addRecordPromises.push(this._addAsChild(createdRecord,refsToRefresh)),checkIfRecordExcluded=Deft.Promise.all(addRecordPromises).then({success:function(args){var addedChildren=args[1],gridboard=creatingCmp&&_.isFunction(creatingCmp.up)&&creatingCmp.up("rallygridboard"),grid=gridboard&&"grid"===gridboard.toggleState&&gridboard.getGridOrBoard();addedChildren.length||grid&&grid.store!==this.store||this._fireExcludeByFilterIfNotFound(createdRecord)},scope:this}),this._handleUpdate([checkIfRecordExcluded],!0,"afterbuscreate",createdRecord,refsToRefresh,creatingCmp)},_handleUpdate:function(promises,expandAfter,afterEvent,changedRecord,associatedRefs,cmp){var store=this.store,associatedRecords=_.reduce(associatedRefs,function(acc,ref){return _.union(acc,store.findAllRecordsWithId(Rally.util.Ref.getOidFromRef(ref)))},[],this);promises.length||promises.push(Deft.Promise.when(!0)),Deft.Promise.all(promises).then({success:function(){return this._refreshScheduledTestCases(_.filter(associatedRecords.concat(changedRecord),function(associatedRecord){return associatedRecord.isScheduledTestCase()&&store.findAllRecordsWithId(associatedRecord.getId()).length}))},scope:this}).always(function(){"afterbusbulkupdate"===afterEvent&&cmp&&cmp.resumeLayouts&&cmp.resumeLayouts(),store.resumeEvents(),expandAfter&&_.each(associatedRecords,function(associatedRecord){associatedRecord.isExpanded()||associatedRecord.expand()},this),store.fireEvent(afterEvent,store,changedRecord,associatedRecords,cmp)})},_refreshScheduledTestCases:function(scheduledTestCases){if(scheduledTestCases.length)return Ext.create("Rally.data.wsapi.Store",{model:scheduledTestCases[0].self,context:{workspace:this.store.context.workspace,project:null},fetch:["TestCase","LastResult","Build","Date","Verdict"],filters:[Rally.data.wsapi.Filter.or(_.map(scheduledTestCases,function(stc){return{property:"ObjectID",value:Rally.util.Ref.getOidFromRef(stc.raw.ScheduledTestCase)}}))]}).load({url:Rally.environment.getServer().getWsapiUrl()+"/scheduledtestcase"}).then({success:function(records){_.each(records,function(record){var testCase=record.raw.TestCase,allTestCases=this.store.findAllRecordsWithId(Rally.util.Ref.getOidFromRef(testCase));_.each(allTestCases,function(testCase){if(Rally.util.Ref.getOidFromRef(testCase.raw.ScheduledTestCase)===record.getId()){var lastResult=record.get("LastResult");testCase.set({LastResult:lastResult,LastBuild:lastResult&&lastResult.Build,LastRun:lastResult&&lastResult.Date,LastVerdict:lastResult&&lastResult.Verdict}),testCase.commit()}})},this)},scope:this})},_addRecordToTopLevelIfMatchesFilter:function(record,cmp){return this._loadStoreRecords([record],!0).then({success:function(records){var store=this.store,existsAtTopLevel=!1;if(records.length){if(existsAtTopLevel=_.any(store.findAllRecordsWithId(records[0].getId()),function(storeRecord){return 1===storeRecord.get("depth")}),!existsAtTopLevel){var rankSorter=this._getRankSorter(store);if(rankSorter){var peerInsertPosition=this._getInsertPositionForInlinePeerAdd(cmp),targetPage=this._addRecordToStoreWhenSortedByRank(store,records[0],rankSorter,peerInsertPosition);targetPage!==store.currentPage&&record.set("targetPage",targetPage)}else store.insert(0,records[0])}return records}},scope:this})},_getInsertPositionForInlinePeerAdd:function(cmp){var store=this.store,root=store.getRootNode&&store.getRootNode();return root&&cmp&&"rallyinlineaddnew"===cmp.xtype&&cmp.siblingRecord&&Rally.data.Ranker.isStoreSortedByRank(store)?root.indexOf(cmp.siblingRecord)+1:void 0},_getRankSorter:function(store){return _.find(store.sorters.items,function(sorter){return sorter&&("DragAndDropRank"===sorter.property||"TaskIndex"===sorter.property)})},_addRecordToStoreWhenSortedByRank:function(store,record,rankSorter,peerInsertPosition){var targetPage=this._getTargetPage(store,record,rankSorter,peerInsertPosition),insertPosition=this._getInsertPosition(store,record,rankSorter,peerInsertPosition);return targetPage===store.currentPage&&store.insert(insertPosition,record),targetPage},_getInsertPosition:function(store,record,rankSorter,peerInsertPosition){var insertPosition="ASC"===rankSorter.direction?store.getRootNode().childNodes.length:0;return Ext.isNumeric(peerInsertPosition)&&(insertPosition=peerInsertPosition),insertPosition},_getTargetPage:function(store,record,rankSorter,peerInsertPosition){var totalCount=store.getTotalCount(),pageCount=Math.max(Math.ceil(totalCount/store.pageSize),1),targetPage="ASC"===rankSorter.direction?pageCount:1;return Ext.isNumeric(peerInsertPosition)&&(targetPage=store.currentPage),targetPage},_addAsChild:function(childRecord,parentRefs){return _.isEmpty(parentRefs)?Deft.Promise.when([]):this._refreshRecords(parentRefs).then({success:function(refreshedParents){var addedChild,addedChildren=[];return _.each(refreshedParents,function(refreshedParent){addedChild=this._cloneRecord(childRecord),addedChildren.push(addedChild),this._appendChildRecord(addedChild,refreshedParent),this._filterEpicStoryOnIterationFilteredStore(addedChild,refreshedParent)},this),addedChildren},scope:this})},_fireExcludeByFilterIfNotFound:function(record){var notInStore=!this.store.findAllRecordsWithId(record.getId()).length,targetPage=record.get("targetPage"),notOnPage=targetPage&&targetPage!==this.store.currentPage;notInStore&&(notOnPage?this.store.fireEvent("movetopage",record,record.get("targetPage")):this.store.fireEvent("excludebyfilter",record))},_filterEpicStoryOnIterationFilteredStore:function(childRecord,parentRecord){this._isTopLevelRecord(parentRecord)&&childRecord.isUserStory()&&parentRecord.isUserStory()&&this._areFieldsFiltered(["Iteration"])&&(parentRecord.parentNode.decrementLeafCount(),parentRecord.parentNode.removeChild(parentRecord))},_appendChildRecord:function(childRecord,parentRecord){parentRecord.isLoaded()&&this._isChildOfParent(childRecord,parentRecord)&&(parentRecord.insertChild(0,childRecord),this._removeTasksFromParentStories(childRecord,parentRecord))},_removeTasksFromParentStories:function(childRecord,parentRecord){if("hierarchicalrequirement"===childRecord.self.typePath&&"hierarchicalrequirement"===parentRecord.self.typePath){var nodesToRemove=_.filter(parentRecord.childNodes,function(childNode){return"task"===childNode.self.typePath});_.each(nodesToRemove,function(nodeToRemove){parentRecord.decrementLeafCount(),parentRecord.removeChild(nodeToRemove)})}},_isChildOfParent:function(childRecord,parentRecord){var parentFields=this.store.mapper.getParentFields(childRecord.self.typePath,parentRecord.self.typePath);return _.any(parentFields,function(parentField){var parentVal=childRecord.get(parentField.fieldName);return _.isObject(parentVal)&&parentVal._ref===parentRecord.get("_ref")})},_resetLeafCount:function(record){var store=this.store;record.resetLeafCount(store.enableHierarchy,store.mapper.getExpandedCollectionNames())},_cloneRecord:function(record){var model=_.isFunction(this.store.model.getArtifactComponentModels)&&this.store.model.getArtifactComponentModel(record.self.typePath)||record.self||this.store.model,clonedRecord=Ext.create(model,_.cloneDeep(record.data));return Rally.ui.grid.data.NodeInterface.decorate(clonedRecord),this._resetLeafCount(clonedRecord),clonedRecord},_getRefsToRefresh:function(record,associatedRecords){return _(associatedRecords||[]).map(function(associatedRecord){return associatedRecord&&associatedRecord.isModel&&associatedRecord.get("_ref")}).union(record.getAssociatedRefs(),this._getParentRecords(record),this._getAssociatedRecordsOfParentNodes(record)).compact().value()},_getAssociatedRecordsOfParentNodes:function(record){return _(record.getAssociatedRefs().map(function(ref){return this._getParentRecords(ref)},this)).flatten().value()},_getParentRecords:function(record){return _.map(this.store.findAllRecordsWithId(Rally.util.Ref.getOidFromRef(record)),function(childRecord){return childRecord.parentNode&&childRecord.parentNode.isModel&&!childRecord.parentNode.isRoot()&&childRecord.parentNode})},_refreshTopLevelBulkRecords:function(refsToRefresh,updatedRecords,changedFields){return this._loadStoreRecords(refsToRefresh,!0).then({success:function(records){var fieldsAreFiltered=this._areFieldsFiltered(changedFields),recordsToRemove=[];fieldsAreFiltered&&(recordsToRemove=this._getRecordsToRemove(updatedRecords,records)),recordsToRemove.length&&_.each(recordsToRemove,this._removeRecord,this);var refreshedRecords=this._updateRefreshedRecords(records);return _.each(refreshedRecords,function(record){fieldsAreFiltered&&this._addRecordToTopLevelIfMatchesFilter(record),this._updateRank(record,changedFields),!this._isDroppedRecord(record)&&this._areFieldsSorted(record,changedFields)&&this._sortParent(record)},this),refreshedRecords},scope:this})},_getRecordsToRemove:function(bulkUpdatedRecords,visibleRecords){return _.reduce(bulkUpdatedRecords,function(result,bulkUpdatedRecord){var bulkUpdatedRef=bulkUpdatedRecord.get("_ref"),isUpdatedRecordFiltered=_.every(visibleRecords,function(visibleRecord){return visibleRecord.get("_ref")!==bulkUpdatedRef});return isUpdatedRecordFiltered&&result.push(bulkUpdatedRecord),result},[],this)},_refreshRecords:function(records){return this._loadStoreRecords(records,!1).then({success:this._updateRefreshedRecords,scope:this})},_removeRecordsFromOldParents:function(records,changedFields){var refsToUpdate=[];return _.each(records,function(record){var existingRecords=this.store.findAllRecordsWithId(record.getId());_.each(existingRecords,function(existingRecord){var parentNode=existingRecord.parentNode,parentFields=_.pluck(this.store.mapper.getParentFields(existingRecord.self.typePath,parentNode.self.typePath),"fieldName"),parentHasChanged=0!==parentNode.get("depth")&&_.intersection(changedFields,parentFields).length>0;parentHasChanged&&(refsToUpdate=_.union(refsToUpdate,[parentNode.get("_ref")]),parentNode.decrementLeafCount(),parentNode.removeChild(existingRecord),parentNode.commit())},this)},this),refsToUpdate.length?this._refreshRecords(refsToUpdate):Deft.Promise.when([])},_updateRecord:function(updatedRecord,changedFields){return this._areFieldsFiltered(changedFields)&&(this._isTopLevelRecord(updatedRecord)?this._removeRecordIfDoesNotMatchFilter(updatedRecord):this._addRecordToTopLevelIfMatchesFilter(updatedRecord)),this._updateRank(updatedRecord,changedFields),this._updateRefreshedRecords([updatedRecord],changedFields),!this._isDroppedRecord(updatedRecord)&&this._areFieldsSorted(updatedRecord,changedFields)&&this._sortParent(updatedRecord),Deft.Promise.when(updatedRecord)},_updateRank:function(updatedRecord,changedFields){if(_.contains(changedFields,"TaskIndex")){var newTaskIndex=updatedRecord.get("TaskIndex"),existingRecord=this.store.findExactRecord(updatedRecord);if(existingRecord){var nodes=existingRecord.parentNode.childNodes;_.each(nodes,function(record){record.getId()!==updatedRecord.getId()&&this._setTaskIndex(record,updatedRecord.oldTaskIndex,newTaskIndex)},this)}}},_setTaskIndex:function(record,oldTaskIndex,newTaskIndex){var direction=newTaskIndex>oldTaskIndex,taskIndex=record.get("TaskIndex");_.isNumber(taskIndex)&&(direction?taskIndex>=oldTaskIndex&&taskIndex<=newTaskIndex&&record.set("TaskIndex",taskIndex-1):taskIndex>=newTaskIndex&&taskIndex<=oldTaskIndex&&record.set("TaskIndex",taskIndex+1))},_isTopLevelRecord:function(record){var matchingRecords=this.store.findAllRecordsWithId(record.getId());return _.any(matchingRecords,function(record){return 1===record.get("depth")})},_removeRecordIfDoesNotMatchFilter:function(record){return this._loadStoreRecords([record],!0).then({success:function(records){records.length<1&&this._removeRecord(record)},scope:this})},_removeRecord:function(record){var store=this.store,rootNode=store.getRootNode(),nodeToRemove=_.find(rootNode.childNodes,function(childRecord){return childRecord.getId()===record.getId()});nodeToRemove&&(rootNode.decrementLeafCount(),rootNode.removeChild(nodeToRemove)),this._fireExcludeByFilterIfNotFound(record)},_areFieldsFiltered:function(changedFields){if(_.isEmpty(changedFields))return!0;var filter=_.reduce(this.store.filters.getRange(),function(acc,filter){return acc+":"+Rally.data.wsapi.Filter.fromExtFilter(filter).toString()},"");return _.any(changedFields,function(field){return filter.match("\\("+field)})},_updateRefreshedRecords:function(refreshedRecords,changedFields){var updatedRecords=[];return _.each(refreshedRecords,function(refreshedRecord){var allRecordsToUpdate=this.store.findAllRecordsWithId(refreshedRecord.getId());_.each(allRecordsToUpdate,function(recordToUpdate){this._updateRecordInStore(recordToUpdate,refreshedRecord,changedFields),updatedRecords.push(recordToUpdate)},this)},this),updatedRecords},_updateRecordInStore:function(recordToUpdate,newRecord,changedFields){var newData=_.cloneDeep(newRecord.data),nodeProps=["dirtyCollection","depth","expanded","loading","loaded","leaf","leafCount"],requiresRefreshChildren=this._requiresRefreshChildren(recordToUpdate,newRecord),requiresRefreshTestSetScheduledChildren=this._requiresRefreshTestSetScheduledChildren(recordToUpdate,changedFields);_.each(nodeProps,function(nodeProp){delete newData[nodeProp]}),changedFields?_.each(changedFields,function(fieldName){newData.hasOwnProperty(fieldName)&&recordToUpdate.get(fieldName)!==newData[fieldName]&&recordToUpdate.set(fieldName,newData[fieldName])},this):recordToUpdate.set(newData),this._resetLeafCount(recordToUpdate),recordToUpdate.commit(),requiresRefreshChildren?this._refreshChildren(recordToUpdate):requiresRefreshTestSetScheduledChildren&&recordToUpdate.parentNode.set("dirtyCollection",!0)},_requiresRefreshChildren:function(oldRecord,newRecord){var recordInStore=this.store.getById(newRecord.getId()),isDirty=newRecord.get("dirtyCollection")||recordInStore&&recordInStore.get("dirtyCollection"),isExpanded=oldRecord.get("expanded"),newLeafCount=newRecord.get("leafCount"),leafCountChanged=newLeafCount!==oldRecord.get("leafCount");return isExpanded&&(isDirty||leafCountChanged)},_requiresRefreshTestSetScheduledChildren:function(oldRecord,changedFields){return oldRecord.parentNode.isTestSet()&&_.contains(changedFields,Rally.data.Ranker.getRankField(oldRecord.self))},_refreshChildren:function(record){record.isLoaded()&&(this.store.resumeEvents(),record.isLeaf()&&record.removeAll(!1),this.store.load({clearOnLoad:!0,node:record}))},_loadStoreRecords:function(records,topLevel){var deferred=Ext.create("Deft.promise.Deferred"),params={fetch:!0,query:this._getLoadRecordsFilter(records,topLevel).toString()};if((this.store.fetch&&"artifact"===this.store.model.typeName||this.store.model.isArtifact())&&(params.types=this._getLoadRecordTypePaths(topLevel),_.isFunction(this.store.getParentFetch)&&_.isFunction(this.store.getChildFetch))){var fetch=this.store.getParentFetch({fetch:this.store.fetch});_.each(records,function(record){record.isModel&&(fetch=this.store.getChildFetch({fetch:fetch,node:record}))},this),params.fetch=_.unique(fetch)}var operation=new Ext.data.Operation({action:"read",params:params,limit:records.length,requester:this}),callback=function(operation){operation.success?(_.each(operation.getRecords(),this._resetLeafCount,this),deferred.resolve(operation.getRecords())):deferred.reject(operation.error)};return this.store.model.getProxy().read(operation,callback,this),deferred.promise},_getLoadRecordTypePaths:function(topLevel){var store=this.store;return topLevel?store.parentTypes.join(","):_.isFunction(store.model.getArtifactComponentModels)?_.pluck(store.model.getArtifactComponentModels(),"typePath").join(","):store.model.typePath},_getLoadRecordsFilter:function(records,topLevel){var objectIdFilters=_.map(Ext.Array.from(records),function(record){return new Rally.data.wsapi.Filter({property:"ObjectID",operator:"=",value:Rally.util.Ref.getOidFromRef(record)})}),objectIdFilter=Rally.data.wsapi.Filter.or(objectIdFilters);return topLevel?Rally.data.wsapi.Filter.and(this.store.filters.getRange().concat(objectIdFilter)):objectIdFilter},_isDroppedRecord:function(record){return record._dragAndDropped&&this._isRecordFromStore(record)},_isRecordFromStore:function(record){return!_.isEmpty(record.stores)&&this._storeContainsRecord(record)},_storeContainsRecord:function(record){return _.any(record.stores,function(store){return store.id===this.store.id},this)},_areFieldsSorted:function(record,fieldNames){return _.contains(fieldNames,Rally.data.Ranker.getRankField(record.self))},_sortParent:function(record){var matchingRecords=this.store.findAllRecordsWithId(record.getId());_.each(matchingRecords,function(matchingRecord){matchingRecord.parentNode&&this._sortChildren(matchingRecord.parentNode)},this)},_sortChildren:function(parent){var store=this.store,sorters=store.isRootNode(parent)?store.sorters:store.childLevelSorters;sorters.isMixedCollection&&(sorters=sorters.getRange()),parent.sort(this._buildSortFunc(sorters),!1,!1)},_buildSortFunc:function(sorters){var sortFunc=this._sortFunc;return function(o1,o2){var idx,result=0;for(idx=0;idx<sorters.length;idx++)if(result=sortFunc(o1,o2,sorters[idx]),0!==result)return result;return result}},_sortFunc:function(o1,o2,sorter){var result=0,multiplier=1,v1=o1.data[sorter.property],v2=o2.data[sorter.property],isEmpty1=!_.isNumber(v1),isEmpty2=!_.isNumber(v2);return isEmpty1&&!isEmpty2?result=-1:!isEmpty1&&isEmpty2&&(result=1),0!==result?("TaskIndex"===sorter.property&&(multiplier=-1),result*multiplier):(result=v1>v2?1:v1<v2?-1:0,"DESC"===sorter.direction&&(multiplier=-1),result*multiplier)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.TreeGridObjectUpdateListener",{extend:Ext.AbstractPlugin,alias:"plugin.rallytreegridobjectupdatelistener",init:function(cmp){var store=cmp.getStore();this.storeUpdater||(this.storeUpdater=Ext.create("Rally.data.StoreUpdater",{store:store})),store.on("afterbusupdate",this._onAfterBusUpdate,this),store.on("afterbuscreate",this._onAfterBusUpdate,this),store.on("afterbusremove",this._onAfterBusUpdate,this),store.on("afterbusbulkupdate",this._onAfterBusBulkUpdate,this)},destroy:function(){this.storeUpdater&&this.storeUpdater.destroy(),this.callParent(arguments)},_onAfterBusBulkUpdate:function(store,updatedRecords){this._onAfterBusUpdate(store,null,updatedRecords)},_onAfterBusUpdate:function(store,changedRecord,updatedRecords){var cmp=this.cmp,recordsToHighlight=_.isEmpty(changedRecord)?[]:[changedRecord];updatedRecords&&(recordsToHighlight=_.union(recordsToHighlight,updatedRecords)),cmp.highlightRowForRecord(recordsToHighlight)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.TreeDragDropRowProxy",{extend:Ext.dd.StatusProxy,alias:"widget.rallytreegriddragdropproxy",renderTpl:'<div id="{id}-ghost" class="drag-ghost"></div>',activeCls:"drag-active",reset:function(clearGhost){var el,gridPanelEl,clonedRowDom,clonedRowEl,formattedIdColumn,html,formattedIdAndIcon="";clearGhost?(this._clearActiveRow(),this.ghost.update(""),this._gridPanelEl&&this._gridPanelEl.removeCls("grabbing")):(el=Ext.get(this.dragZone.dragData.item),gridPanelEl=el.up(".rally-grid"),clonedRowDom=el.dom.cloneNode(!0),this._gridPanelEl=gridPanelEl,gridPanelEl.addCls("grabbing"),clonedRowDom.id=clonedRowDom.id+"-drag-clone",clonedRowEl=Ext.get(clonedRowDom),formattedIdColumn=clonedRowEl.down(".formatted-id-template"),formattedIdColumn&&(formattedIdAndIcon=this._getIconAndFormattedId(formattedIdColumn)),this._setActiveRow(),html=Ext.String.format('<div class="icon-five-dots"></div><div class="drag-ghost-content">Move <span class="formatted-id">{0}</span></div>',formattedIdAndIcon),this.ghost.update(html)),this.callParent(arguments)},update:Ext.emptyFn,_getIconAndFormattedId:function(formattedIdColumn){var textNodes,idLink=formattedIdColumn.down("a.formatted-id-link"),formattedId="";return idLink?formattedId=idLink.dom.innerHTML:(textNodes=_.filter(formattedIdColumn.dom.childNodes,function(node){return node.nodeType===formattedIdColumn.dom.TEXT_NODE}),textNodes.length>0&&(formattedId=textNodes[0].nodeValue)),formattedId},_setActiveRow:function(){var trEl=Ext.get(this.dragZone.dragData.item);this._addClass(trEl,this.activeCls)},_clearActiveRow:function(){var trEl=Ext.get(this.dragZone.dragData.item);this._removeClass(trEl,this.activeCls)},_removeClass:function(trEl,className){_.each(trEl.query("td"),function(tdDom){Ext.fly(tdDom).removeCls(className)})},_addClass:function(trEl,className){_.each(trEl.query("td"),function(tdDom){Ext.fly(tdDom).addCls(className)})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.TreeDragZone",{extend:Ext.tree.ViewDragZone,mixins:{observable:Ext.util.Observable},config:{view:null,draggableCls:null,rankEnabledCls:null},constructor:function(config){config.proxy=Ext.create("Rally.ui.grid.dragdrop.TreeDragDropRowProxy",{id:config.view.el.dom.parentNode.id+"-drag-status-proxy",dragZone:this,animRepair:config.animRepair||this.animRepair}),this.mixins.observable.constructor.call(this,config),this.addEvents("initdrag"),this.callParent([config])},autoOffset:function(){var itemEl=Ext.get(this.dragData.item),x=itemEl.down("td").getWidth()/2,y=itemEl.getHeight()/2;this.setDelta(x,y)},onInitDrag:function(x,y){var selectionModel=this.view.getSelectionModel();selectionModel.deselectAll(),this._setConstraints(),this.callParent(arguments)},onBeforeDrag:function(dragData){return!!this._elementIsDraggable()&&(this.fireEvent("initdrag"),!0)},onDragOut:Ext.emptyFn,_elementIsDraggable:function(){return this.view.hasCls(this.rankEnabledCls)},_setConstraints:function(){this.setInitPosition();var el=this.view.getEl(),headerEl=this.view.headerCt.getEl(),xy=el.getXY(),top=this.initPageY-xy[1],padding=3;this.setXConstraint(0,el.getWidth()-this.proxy.ghost.getWidth()),this.setYConstraint(top,el.getHeight()-top-headerEl.getHeight()-padding)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.TreeDropZone",{extend:Ext.tree.ViewDropZone,indicatorCls:Ext.baseCSSPrefix+"grid-drop-indicator",onNodeOver:function(node,dragZone,e,data){var position=this.getPosition(e,node);return this.isValidDropPoint(node,position,dragZone,e,data)?(this.positionIndicator(node,data,e),this.valid?this.dropAllowed:this.dropNotAllowed):(this.valid=!1,this.dropNotAllowed)},onNodeDrop:function(){return this.view.getSelectionModel().deselectAll(),this.callParent(arguments)},clearRowNodePositions:function(){this.viewEl=Ext.get(this.getEl()),this.yScrollOffset=this.viewEl.getScroll().top},getPosition:function(e,node){var fragment,y=e.getPageY(),region=Ext.fly(node).getRegion();return fragment=(region.bottom-region.top)/2,y>=region.top&&y<region.top+fragment?"before":"after"},isValidDropPoint:function(node,position,dragZone,e,data){var view=this.view,dropRecord=view.getRecord(node),dragRecord=view.getRecord(data.item);if(dropRecord&&dragRecord){var isTopLevel=dropRecord.parentNode&&dropRecord.parentNode.isRoot(),parentsMatch=dropRecord.parentNode===dragRecord.parentNode,typesMatch=dropRecord.self.typePath===dragRecord.self.typePath;return parentsMatch&&(isTopLevel||typesMatch)}return this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.TreeViewDragDrop",{extend:Ext.tree.plugin.TreeViewDragDrop,alias:"plugin.rallytreeviewdragdrop",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},statics:{increaseDndVerticalThreshold:!1},config:{rankEnabledCls:"rank-enabled"},init:function(view){this.view=view,this.view.mon(this.view,"storeload",this._onStoreLoad,this),this.view.mon(this.view,"drop",this._onDrop,this),this.callParent(arguments)},enable:function(){this._showRankColumn(),this.callParent(arguments)},disable:function(){this._hideRankColumn(),this.callParent(arguments)},onViewRender:function(){this._enableDragDrop()},_enableDragDrop:function(){var rankColumn=this._getRankColumn(),ranker=Rally.data.Ranker,treeStore=this.view.getTreeStore();rankColumn&&(this.dragTracker=Ext.create("Ext.dd.DragTracker",{el:this.view.getEl(),delegate:"."+Ext.baseCSSPrefix+"grid-data-row",autoStart:!0,captureEvent:!1,preventDefault:!1,listeners:{mousedown:function(tracker,e){this.activeButton=e.button},dragstart:function(tracker,e){ranker.isDnDRankable(treeStore)||0!==this.activeButton||(ranker.isDnDEnabled(treeStore)&&!ranker.isStoreSortedByRankAsc(treeStore)&&Rally.ui.notify.Notifier.showWarning({message:"Items cannot be reordered unless sorted by rank ascending.",duration:1e4}),delete this.activeButton,this.endDrag(e))}}}),this.dragZone=Ext.create("Rally.ui.grid.dragdrop.TreeDragZone",{view:this.view,ddGroup:this.dragGroup||this.ddGroup,dragText:this.dragText,rankEnabledCls:this.rankEnabledCls,draggableCls:this._getRankColumn().draggableCls,beforeDragDrop:_.bind(this._beforeDragDrop,this),beforeInvalidDrop:_.bind(this._beforeInvalidDrop,this),containerScroll:{vthresh:Rally.ui.grid.plugin.TreeViewDragDrop.increaseDndVerticalThreshold?100:30,hthresh:-1,frequency:350,increment:50},scrollEl:this.view.getEl(),listeners:{initdrag:this._onInitDrag,scope:this}}),this.dropZone=Ext.create("Rally.ui.grid.dragdrop.TreeDropZone",{view:this.view,ddGroup:this.dropGroup||this.ddGroup}))},_getRankColumn:function(){var rankCol=this.view.headerCt.items.getAt(0);return rankCol instanceof Rally.ui.grid.TreeRankDragHandleColumn?rankCol:null},_showRankColumn:function(){this.view.hasCls(this.rankEnabledCls)||this.view.addCls(this.rankEnabledCls)},_hideRankColumn:function(){this.view.removeCls(this.rankEnabledCls)},_onInitDrag:function(){this.dropZone&&this.dropZone.clearRowNodePositions()},_onStoreLoad:function(){Rally.data.Ranker.isDnDRankable(this.view.getTreeStore())?this.enable():this.disable()},_beforeDragDrop:function(){this.recordAction({description:"starting treegrid drag and drop"}),this.recordLoadBegin({description:"treegrid drag and drop"})},_beforeInvalidDrop:function(){this.recordLoadEnd()},_onDrop:function(rowEl,dropData,overModel,dropPosition,opts){var droppedRecord=dropData.records[0];droppedRecord._dragAndDropped=!0,this.view.ownerCt.setLoading(!0),Rally.data.Ranker.rankRelative({recordToRank:droppedRecord,relativeRecord:overModel,position:dropPosition,saveOptions:{callback:this._onRank,scope:this}})},_onRank:function(record,operation){this.recordLoadEnd(),delete record._dragAndDropped,this.view.ownerCt.setLoading(!1)},destroy:function(){Ext.destroy(this.dragTracker,this.dragZone,this.dropZone)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.ViewVisibilityListener",{extend:Ext.AbstractPlugin,alias:"plugin.rallyviewvisibilitylistener",mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},scrollBufferSize:125,init:function(cmp){cmp.addEvents(["visibilitychange"]),cmp.on("refresh",this._onRefresh,this),cmp.on("resize",this._onRefresh,this),cmp.on("afteritemexpand",this._onRefresh,this),cmp.on("afteritemcollapse",this._onRefresh,this),cmp.on("afterrender",this._addScrollListener,this)},_getVisibleNodes:function(){var cmp=this.cmp,visibleNodes=[],el=cmp.getEl(),elTop=el.getY(),elBottom=elTop+el.getHeight();return elTop-=this.scrollBufferSize,elBottom+=this.scrollBufferSize,cmp.getStore().each(function(node){var nodeEl=Ext.fly(cmp.getNode(node)),nodeY=nodeEl&&nodeEl.getY(),nodeIsWithinVisibleBuffer=nodeEl&&nodeY>elTop&&nodeY<elBottom;nodeIsWithinVisibleBuffer&&visibleNodes.push(node)},this),visibleNodes},_fireVisible:function(){this.cmp.fireEvent("visibilitychange",this,this._getVisibleNodes())},_addScrollListener:function(){this.cmp.getEl().on("scroll",this._onScroll,this,{buffer:250})},_onRefresh:function(){this.cmp.getEl()&&this.cmp.getEl().down("."+Ext.baseCSSPrefix+"grid-row")&&this._fireVisible()},_onScroll:function(){this.recordAction({description:"scrolled grid"}),this._fireVisible()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.feature.SummaryRow",{extend:Ext.grid.feature.AbstractSummary,alias:"feature.summaryrow",dockedSummaryCls:Ext.baseCSSPrefix+"docked-summary",panelBodyCls:Ext.baseCSSPrefix+"summary-",scrollPadProperty:"padding-right",dock:"top",init:function(grid){var me=this;this.grid=grid,this.callParent(arguments),grid.headerCt.on({afterlayout:this.updateSummaryRow,scope:this}),grid.headerCt.afterComponentLayout=Ext.Function.createSequence(grid.headerCt.afterComponentLayout,function(){var scrollWidth,width=this.getFullWidth(),innerCt=me.summaryBar.innerCt;grid.getView().hasVerticalScroll()&&(scrollWidth=Ext.getScrollbarSize().width,width-=scrollWidth,innerCt.down("table").setStyle(me.scrollPadProperty,scrollWidth+"px")),innerCt.setWidth(width)}),grid.on({beforerender:{fn:this._onGridBeforeRender,single:!0},afterrender:{fn:this._onGridAfterRender,single:!0},afterproxyload:{fn:this._afterProxyLoad,single:!0},scope:this}),grid.mon(grid.store,"beforeload",this._onStoreBeforeLoad,this);
},updateSummaryRow:function(){var view=this.grid.getView(),record=this._createSummaryRecord(view);if(view.rendered){this.summaryBar.setVisible(this.showSummaryRow);var oldRowDom=this.summaryBar.el.down("."+this.summaryRowCls,!0),newRowDom=view.createRowElement(record,-1);if(Ext.fly(newRowDom).addCls(this.summaryRowCls),oldRowDom){var p=oldRowDom.parentNode;p.insertBefore(newRowDom,oldRowDom),p.removeChild(oldRowDom);var partner=this.lockingPartner;partner&&partner.grid.rendered&&!this.calledFromLockingPartner&&(partner.calledFromLockingPartner=!0,partner.updateSummaryRow(),partner.calledFromLockingPartner=!1)}this._onColumnHeaderLayout()}},getSummary:function(store,type,field){return"sum"===type&&store.getSums().hasOwnProperty(field)?store.getSums()[field]:""},_afterProxyLoad:function(){this._resumeRequestsForSummaryRowData(),this.updateSummaryRow(),this.grid.store.on("insert",function(store,record){this._onStoreInsertUpdateOrRemove(store,record,"insert")},this),this.grid.store.on("update",function(store,record){this._onStoreInsertUpdateOrRemove(store,record,"update")},this),this.grid.store.on("remove",function(store,record){this._onStoreInsertUpdateOrRemove(store,record,"remove")},this),this.grid.on("storebeforefilter",this._onStoreBeforeFilter,this),this.grid.on("storeafterbusbulkupdate",this._onAfterBusBulkUpdate,this),this.grid.on("storeafterbusupdate",this._onAfterBusUpdate,this),this.grid.on("storeafterbuscreate",this._onAfterBusInsert,this),this.grid.on("pagingtoolbarbeforechange",this._onPagingToolbarBeforeChange,this),this.grid.on("afterproxyload",this.updateSummaryRow,this)},_isChildNodeWithSummaryColumnChange:function(record,column,checkRecordModified){var isChildNodeWithThisColumnUpdate=!1;if(!this.grid.store.isRootNode(record)){var typeMappings=record.getArtifactMappings();typeMappings&&_.each(typeMappings,function(value,key){if(value===column){var hasUpdate=checkRecordModified?record.isModified(key):this._isNodeWithSummaryColumnChange(record,key,!1);if(hasUpdate)return isChildNodeWithThisColumnUpdate=!0,!1}},this)}return isChildNodeWithThisColumnUpdate},_isNodeWithSummaryColumnChange:function(record,column,checkRecordModified){return checkRecordModified?record.isModified(column):_.isNumber(record.get(column))&&record.get(column)>0},_onStoreInsertUpdateOrRemove:function(store,record,action){var actionMappings={insert:{event:"storeafterbuscreate",checkRecordModified:!1},update:{event:"storeafterbusupdate",checkRecordModified:!0},remove:{event:"storeafterbusremove",checkRecordModified:!1}};_.each(this.grid.getSummaryColumns(),function(column){if(this._isNodeWithSummaryColumnChange(record,column.dataIndex,actionMappings[action].checkRecordModified)||this._isChildNodeWithSummaryColumnChange(record,column.dataIndex,actionMappings[action].checkRecordModified))return this.grid.on(actionMappings[action].event,this._onStoreDataChanged,this,{single:!0}),!1},this)},_onStoreBeforeFilter:function(){this.grid.on("afterproxyload",this.updateSummaryRow,this,{single:!0})},_isNotTreeGridEditor:function(cmp){return cmp&&cmp.cmp&&cmp.cmp.id!==this.grid.id},_isOldEditor:function(cmp){return _.isEmpty(cmp)},_onAfterBusUpdate:function(store,records,associatedRecords,cmp){(this._isOldEditor(cmp)||this._isNotTreeGridEditor(cmp))&&this._onStoreDataChanged()},_onAfterBusBulkUpdate:function(store,records,associatedRecords,cmp){this._onStoreDataChanged()},_onAfterBusInsert:function(store,insertedRecord){insertedRecord.store||this._onStoreDataChanged()},_onPagingToolbarBeforeChange:function(){this._suspendRequestsForSummaryRowData(),this.grid.on("afterproxyload",this._resumeRequestsForSummaryRowData,this,{single:!0})},_resumeRequestsForSummaryRowData:function(){this._shouldUpdateSummaryRow=!0},_suspendRequestsForSummaryRowData:function(){this._shouldUpdateSummaryRow=!1},_onStoreBeforeLoad:function(store,operation){store.isRootNode(operation.node)&&(this._loadOperation=operation)},_onGridBeforeRender:function(){var view=this.grid.getView(),tableCls=[this.summaryTableCls];view.columnLines&&(tableCls[tableCls.length]=view.ownerCt.colLinesCls),this.summaryBar=this.grid.addDocked({childEls:["innerCt"],renderTpl:['<div id="{id}-innerCt" role="presentation">','<table cellPadding="0" cellSpacing="0" class="'+tableCls.join(" ")+'">','<tr class="'+this.summaryRowCls+'"></tr>',"</table>","</div>"],style:{overflow:"hidden"},itemId:"summaryBar",cls:[this.dockedSummaryCls,this.dockedSummaryCls+"-"+this.dock],xtype:"component",dock:this.dock,weight:1e7})[0]},_onGridAfterRender:function(){var view=this.grid.getView();this.grid.body.addCls(this.panelBodyCls+this.dock),view.mon(view.el,{scroll:this._onViewScroll,scope:this})},_onStoreDataChanged:function(){if(this._loadOperation)if(this._shouldUpdateSummaryRow){var readOperation=Ext.create("Ext.data.Operation",{action:"read",params:Ext.clone(this._loadOperation.params)});readOperation.params.pagesize=1,readOperation.params.start=1,this.grid.store.getProxy().read(readOperation,this._afterProxyRead,this)}else this._resumeRequestsForSummaryRowData()},_afterProxyRead:function(op){op.success&&op.resultSet.sums&&(this.grid.store.setSums(op.resultSet.sums),this.updateSummaryRow())},_onViewScroll:function(){this.summaryBar.el.dom.scrollLeft=this.grid.getView().el.dom.scrollLeft},_createSummaryRecord:function(view){var columns=view.headerCt.getVisibleGridColumns(),summaryRecord=this.summaryRecord||(this.summaryRecord=Ext.create(this.grid.store.model,view.id+"-summary-record"));return summaryRecord.beginEdit(),_.each(columns,function(column){column.dataIndex&&summaryRecord.set(column.dataIndex,this.getSummary(this.grid.store,column.summaryType,column.dataIndex))},this),summaryRecord.endEdit(!0),summaryRecord.commit(!0),summaryRecord.isSummary=!0,summaryRecord},_onColumnHeaderLayout:function(){var el,view=this.grid.getView(),columns=view.headerCt.getVisibleGridColumns(),summaryEl=this.summaryBar.el;_.each(columns,function(column){el=summaryEl.down(view.getCellSelector(column)),el&&(column.hidden?el.setDisplayed(!1):(el.setDisplayed(!0),el.setWidth(column.width||(column.lastBox?column.lastBox.width:100))))},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.data.ColumnFetchBuilder",{build:function(config){var getFetchForColumn=_.curry(this._getFetchForColumn),columnFetch=_.flatten(_.map(config.columns,getFetchForColumn(config),this)),fetch=this._getFetchFromConfig(config),allFetch=_.union(Ext.Array.from(fetch),columnFetch);return Rally.data.wsapi.FieldFetchMapper.getFetchFields(allFetch,config)},_getFetchForColumn:function(config,column){var fetch=[],fieldName=this._getFieldName(column),columnClass=column.self||Ext.ClassManager.getByAlias("widget."+column.xtype);return _.isString(fieldName)&&fetch.push(fieldName),columnClass&&_.isFunction(columnClass.getRequiredFetchFields)&&(fetch=fetch.concat(columnClass.getRequiredFetchFields(config.grid))),fetch},_getFieldName:function(column){return column.dataIndex?column.dataIndex:column},_getFetchFromConfig:function(config){return config&&config.fetch||[]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.BufferedRenderer",{extend:Ext.grid.plugin.BufferedRenderer,alias:"plugin.rallybufferedrenderer",init:function(cmp){this.callParent([cmp]),cmp.on("aftercollapsebatch",this._afterCollapseBatchHandler,this),cmp.on("storebeforecollapse",this._beforeRowCollapse,this),cmp.getStore().on("sort",this._scrollToTop,this),cmp.getStore().on("currentpagereset",this._scrollToTop,this),cmp.getStore().on("load",this._onLoad,this)},getFirstVisibleRowIndex:function(){var target=this.scrollTop,yLocation=this.bodyTop,result=-1;return _.forIn(this.view.all.elements,function(rowEl,index){if(yLocation+=Ext.fly(rowEl).getHeight(),yLocation>=target)return result=Number(index),!1}),result===-1?this._estimateFirstVisibleRowIndex():result},getLastVisibleRowIndex:function(){var target=this._getViewBottom(),yLocation=this.bodyTop,result=-1;if(this.bodyTop>this.scrollTop)return this._estimateLastVisibleRowIndex();if(_.forIn(this.view.all.elements,function(rowEl,index){if(yLocation+=Ext.fly(rowEl).getHeight(),yLocation>=target)return result=Number(index),!1}),result===-1){for(result=this.view.all.endIndex,target+=this.trailingBufferZone*this.rowHeight;yLocation<target;)result+=this.trailingBufferZone,yLocation+=this.trailingBufferZone*this.rowHeight;return Math.min(this._getLastRowIndexFromStore(),result)}return result},treeViewAdd:function(){this.rowHeight=this._getAverageRowHeight(),this.stretchView(this.view,this._isLastRowVisible()?this._getViewBottom():this.getScrollHeight())},renderRange:function(start,end,forceSynchronous){this.callParent(arguments),this.view.fireEvent("afterrenderrange",start,end)},_getViewBottom:function(){return this.scrollTop+this.view.getHeight()},_getAverageRowHeight:function(){var view=this.view;return Math.floor(view.body.getHeight()/view.all.getCount())},_beforeRowCollapse:function(nodeToCollapse){this._willLastRowComeIntoView(nodeToCollapse)&&this._keepCollapsingRowUnderCursor(nodeToCollapse)},_keepCollapsingRowUnderCursor:function(nodeToCollapse){var heightOfChildRows=nodeToCollapse.childNodes.length*this.rowHeight;this.stretchView(this.view,this._getViewBottom()+heightOfChildRows)},_willLastRowComeIntoView:function(nodeToCollapse){var indexOfRowThatWillComeIntoViewOnCollapse=this.getLastVisibleRowIndex()+nodeToCollapse.childNodes.length;return indexOfRowThatWillComeIntoViewOnCollapse>=this._getLastRowIndexFromStore()},_getLastRowIndexFromStore:function(){return this.view.getStore().getCount()-1},_isLastRowVisible:function(){return this.getLastVisibleRowIndex()===this._getLastRowIndexFromStore()},_afterCollapseBatchHandler:function(grid){var firstVisibleNode=grid.firstVisibleNode;this._loadRowsIfReachingBottomOfNodeCache(),firstVisibleNode&&(this.stretchView(this.view,this.getScrollHeight()),this.scrollTo(0))},_loadRowsIfReachingBottomOfNodeCache:function(){var down=1;this.handleViewScroll(down)},_onLoad:function(store,record){record.isRoot()&&this._onRootNodeLoad(store)},_onRootNodeLoad:function(store){var isDifferentPage=!_.isUndefined(this.lastPage)&&this.lastPage!==store.currentPage,isDifferentPageSize=!_.isUndefined(this.lastPageSize)&&this.lastPageSize!==store.pageSize;(isDifferentPage||isDifferentPageSize)&&this._scrollToTop(),this.lastPage=store.currentPage,this.lastPageSize=store.pageSize},_scrollToTop:function(){var all=this.view.all;if(all&&all.endIndex>-1)try{this.scrollTo(0),this._resetScrollPosition()}catch(e){this.view.refresh()}else this._resetScrollPosition(),this.cmp.rendered&&this.view.refresh()},_resetScrollPosition:function(){this.setBodyTop(0),this.position=0,this.scrollTop=0},_estimateFirstVisibleRowIndex:function(){var numberOfRowsScrolled,distanceScrolled;return this.rowHeight||(this.rowHeight=this._getAverageRowHeight()),distanceScrolled=this.scrollTop-this.bodyTop,numberOfRowsScrolled=Math.floor(distanceScrolled/this.rowHeight),Math.min(this._getLastRowIndexFromStore(),this.view.all.startIndex+numberOfRowsScrolled)},_estimateLastVisibleRowIndex:function(){return this.rowHeight||(this.rowHeight=this._getAverageRowHeight()),Math.floor(this._getViewBottom()/this.rowHeight)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.IconComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyiconcombobox",config:{cls:"rally-icon-combobox",iconClsField:"iconCls"},initComponent:function(){Ext.apply(this,{scope:this,listConfig:{scope:this,iconClsField:this.iconClsField,getInnerTpl:function(){return'<tpl for="."><span class="rally-icon-combo-list-icon {'+this.iconClsField+'}"></span><span class="rally-icon-combo-list-text">{'+this.displayField+"}</span></tpl>"}},fieldSubTpl:['<div class="{hiddenDataCls}" role="presentation"></div>','<div class="rally-icon-combo-wrap"><input id="{id}" type="{type}" {inputAttrTpl}','<tpl if="value"> value="{value}"</tpl>','<tpl if="name"> name="{name}"</tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="size"> size="{size}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>','class="{fieldCls} {typeCls}" autocomplete="off" /></div>',{compiled:!0,disableFormats:!0}]}),this.callParent(arguments)},onRender:function(){this.callParent(arguments),this.el.down("input").addCls("rally-icon-combo-input"),this.icon=Ext.core.DomHelper.append(this.el.down("div[class=rally-icon-combo-wrap]"),{tag:"div",style:"position:absolute"},!0),this.mon(this.icon,"click",this.expand,this)},_setIconCls:function(){if(this.rendered){var record=this.store.findRecord(this.valueField,this.getValue());record&&this.icon.addCls("rally-icon-combo-icon "+record.get(this.iconClsField))}else this.on("render",this._setIconCls,this,{single:!0})},setValue:function(){this.callParent(arguments),this._setIconCls()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.AddNewEditorFactory",{singleton:!0,getAdditionalFieldsEditorConfig:function(recordType,context){var methodName="_getConfigFor"+Ext.String.capitalize(recordType);return _.isFunction(this[methodName])?this[methodName](context):[]},getAdditionalAddNewConfig:function(recordType){var rt=recordType&&recordType.toLowerCase();return"iteration"===rt||"release"===rt?{ignoredRequiredFields:["GrossEstimateConversionRatio","Name","Project","State","ReleaseDate","EndDate","StartDate","ReleaseStartDate"],listeners:{beforecreate:function(addNew,record){record.set("State","Planning")}}}:{}},_getConfigForMilestone:function(context){return[{xtype:"rallydatefield",emptyText:"Select Date",name:"TargetDate",flex:.7},{xtype:"rallymilestoneprojectcombobox",context:context,flex:1,name:"TargetProject",value:Rally.util.Ref.getRelativeUri(context.getProject())}]},_getConfigForIteration:function(){return this._getConfigForTimebox("StartDate","EndDate","Select End Date")},_getConfigForRelease:function(){return this._getConfigForTimebox("ReleaseStartDate","ReleaseDate","Select Release Date")},_getConfigForTimebox:function(startDateFieldName,endDateFieldName,endDateEmptyText){return[{xtype:"rallydatefield",allowBlank:!1,emptyText:"Select Start Date",name:startDateFieldName,paramName:"startDate",flex:.7},{xtype:"rallydatefield",allowBlank:!1,emptyText:endDateEmptyText,name:endDateFieldName,paramName:"endDate",flex:.7}]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.AddNew",{extend:Ext.Container,cls:"add-new",alias:"widget.rallyaddnew",mixins:[Rally.Messageable],clientMetrics:[{beginEvent:"beforecreate",endEvent:"create",description:"record added"},{event:"beforeeditorshow",description:"record add show editor"}],config:{recordTypes:[],ignoredRequiredFields:["Name","Project","Owner"],newButtonText:"+ Add New",disableAddButton:!1,showAddWithDetails:!0,fieldLabel:void 0,showFieldLabel:!0,showRank:!0,openEditorAfterAddFailure:!0,context:void 0,collectionStore:void 0,alwaysExpanded:!1,minWidth:500,additionalFields:[],expanded:!1,parentRecord:void 0,collapseOnCreate:!1,showNameField:!0,requiredFieldValues:void 0,enableValidationNotifications:!0},stateEvents:["expand","collapse"],constructor:function(config){config=config||{},config.ignoredRequiredFields=_.union(this.ignoredRequiredFields,config.ignoredRequiredFields),this.mergeConfig(config),this._addTypeSpecificConfig(),this.callParent([this.config])},getState:function(){return{expanded:this.expanded}},applyState:function(state){this.callParent(arguments),this._bypassFocus=this.expanded||this.alwaysExpanded},initComponent:function(){this.items=this._buildItems(),this.callParent(arguments),this.addEvents("beforecreate","beforeeditorshow","create","error","expand","collapse","recordtypechange"),this.down("#expandButton").setText(this.newButtonText),this._getSelectedTypeInfo(),this.down("#expandButton").on("click",this._onExpandClicked,this),this.alwaysExpanded&&this.fireEvent("expand",this,{}),_.each(this._getAdditionalFields(),function(field){field.on({select:this.toggleAddButton,change:this.toggleAddButton,specialKey:this._onAdditionalFieldSpecialKey,scope:this})},this)},_addTypeSpecificConfig:function(){this.config=Ext.merge(this.config,Rally.ui.AddNewEditorFactory.getAdditionalAddNewConfig(this.getSelectedRecordType()))},_initControlsForLoadedTypes:function(){var typeComboBox=this.down("#type");typeComboBox&&(typeComboBox.getStore().each(function(record){record.set("displayName",this._getTypeDisplayName(record.get("type")))},this),typeComboBox.setValue(typeComboBox.getValue())),this.disabled||this.down("#expandButton").setDisabled(!1),this.setFieldLabel(this.fieldLabel||this._getFieldLabelFromType()),this._checkAddWithDetailsOnly(this.models[this.getSelectedRecordType()])},_getFieldLabelFromType:function(){return"New "+(1===this.recordTypes.length?this._getTypeDisplayName(this.recordTypes[0]):"")},_getTypeDisplayName:function(type){var model=this.models[type];return model?Rally.util.Type.getModelDisplayName(model):type},_buildItems:function(){return[{itemId:"expandButton",xtype:"rallybutton",cls:"new primary rly-small",userAction:"AddNew expanded",margin:"3 0 2 0",disabled:!0},{itemId:"parentContainer",xtype:"container",cls:"expanded-container",minWidth:this.minWidth,layout:{type:"hbox",align:"middle",defaultMargins:{right:2,left:2}},items:this.buildChildItems(),listeners:{afterrender:this._focusName,show:this._focusName,scope:this}}]},_showRecordTypes:function(){return this.recordTypes.length>1},beforeRender:function(){var expanded=this.expanded||this.alwaysExpanded;this.down("#expandButton").hidden=expanded,this.down("#parentContainer").hidden=!expanded,this.callParent(arguments)},buildChildItems:function(){var items=this._getFieldConfigs();return items=items.concat(this.getAdditionalFields()),items=items.concat(this._getAdditionalFieldsForType()),items=items.concat(this.getButtonConfigs())},_getFieldConfigs:function(){var items=[{itemId:"label",xtype:"label"}];if(this._showRecordTypes()){var data=_.map(this.recordTypes,function(recordType){return{type:recordType,displayName:recordType}},this),comboCfg=Ext.merge({itemId:"type",xtype:"rallycombobox",flex:1,minWidth:50,maxWidth:100,matchFieldWidth:!0,store:{fields:["type","displayName"],data:data},listeners:{change:this._onRecordTypeChanged,scope:this},valueField:"type",displayField:"displayName",value:this.recordTypes[0],queryMode:"local",editable:!1},this.comboCfg||{});items.push(comboCfg)}return this.showNameField&&items.push({itemId:"nameField",xtype:"rallytextfield",plugins:["rallyfieldvalidationui"],emptyText:"Name",flex:1,minWidth:100,maxWidth:300,enableKeyEvents:!0,listeners:{specialKey:this._onTextFieldSpecialKey,keyup:this.toggleAddButton,scope:this}}),items},getButtonConfigs:function(){var items=[{itemId:"addButton",xtype:"rallybutton",text:"Add",cls:"add primary rly-small",userAction:"New record added",disabled:!0,listeners:{click:this.onAddClicked,scope:this}}];return this.showAddWithDetails&&items.push({itemId:"addWithDetails",xtype:"rallybutton",text:"Add with Details",cls:"add-with-details secondary rly-small",userAction:"Editing new record with details",listeners:{click:this._onAddWithDetailsClicked,scope:this}}),this.alwaysExpanded||items.push({itemId:"collapseButton",xtype:"rallybutton",border:!1,frame:!1,icon:Rally.environment.getServer().getImagesPath()+"/double-chevron-left.png",cls:"rly-collapse",userAction:"AddNew collapsed",listeners:{click:this.collapse,scope:this}}),items},_onExpandClicked:function(){this.expanded=!0,this.fireEvent("expand",this,{}),this.down("#parentContainer").show(),this.down("#expandButton").hide()},_setUserSpecificFields:function(record){var currentUserRef=Rally.environment.getContext().getUser()._ref;"defect"===this.getSelectedRecordType().toLowerCase()?record.set("SubmittedBy",currentUserRef):record.self.getField("Owner")&&(record.get("Owner")===Rally.util.User.noOwnerValue&&record.set("Owner",null),_(this.getAdditionalFields()).pluck("name").contains("Owner")||record.set("Owner",currentUserRef))},_focusName:function(){!this._bypassFocus&&this.showNameField&&this.getNameField().focus(!1,!0),delete this._bypassFocus},onAddClicked:function(){var record=Ext.create(this.models[this.getSelectedRecordType()]),params={fetch:!0};if(this.requiredFieldValues&&_.each(this.requiredFieldValues,function(requiredFieldValue){record.set(requiredFieldValue.fieldName,requiredFieldValue.value)}),this.showNameField&&record.set("Name",this.getNameField().getValue()),_.each(this._getAdditionalFieldsWithValues(),function(field){field.name&&field.isValid()&&record.set(field.name,field.getValue())},this),record.self.getField("Project")&&record.set("Project",Rally.util.Ref.getRelativeUri(this._getProject())),this._setUserSpecificFields(record),this.fireEvent("beforecreate",this,record,params)!==!1){Rally.ui.notify.Notifier.showStatus({message:"Creating "+record.self.displayName+"..."});var collectionStore=this.getCollectionStore();collectionStore?(collectionStore.add(record),collectionStore.sync({requester:this,callback:function(batch){this._onAddOperationCompleted(record,batch.operations[0])},scope:this,params:params})):record.save({requester:this,callback:this._onAddOperationCompleted,scope:this,params:params})}},_getProject:function(){var project=this._getContext().getProject(),parentProject=this.parentRecord&&this.parentRecord.get("Project");return parentProject||project},_onAddOperationCompleted:function(record,operation){operation.wasSuccessful()?(Rally.ui.notify.Notifier.showCreate({artifact:record,showRank:this.showRank&&this.context&&this.context.getWorkspace&&this.context.getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled}),this.getEl()&&(this.clearFormFields(),this.toggleAddButton(),this._focusName()),this.fireEvent("create",this,record,operation),this.publish(Rally.Message.objectCreate,record,this,this.getAssociatedRecords()),this.collapseOnCreate&&this.collapse()):this._onAddFailure(record,operation)},getAssociatedRecords:function(){return this.getCollectionStore()?[this.getCollectionStore().record]:void 0},_onAddFailure:function(record,operation){var message,errors=operation.error&&operation.error.errors,isValidationError=errors&&Ext.Array.some(errors,function(error){return error.indexOf("Validation error")>-1}),isAuthorizationError=!isValidationError&&errors&&Ext.Array.some(errors,function(error){return error.indexOf("Not authorized")>-1});message=isValidationError&&this.openEditorAfterAddFailure?this._getValidationOpenEditorMessage():errors[0],this.fireEvent("error",this,{message:message}),isAuthorizationError?Rally.ui.notify.Notifier.showError({message:message}):this.openEditorAfterAddFailure?(this._onAddWithDetailsClicked(),Rally.ui.notify.Notifier.showStatus({message:message})):isValidationError?this.enableValidationNotifications?Rally.ui.notify.Notifier.showError({message:this._getValidationError(operation)}):Rally.ui.notify.Notifier.hide():Rally.data.util.Record.showWsapiErrorNotification(record,operation)},_getValidationError:function(operation){return Rally.data.util.Record.removeValidationCruft(Rally.data.util.Record.getWsapiOperationErrorMessage(operation))},_getValidationOpenEditorMessage:function(){var typeName=this.getSelectedRecordType().toLowerCase();return Ext.String.format("Adding a new {0} requires the completion of additional fields (indicated in red) based on your company's policy.",typeName)},_onAddWithDetailsClicked:function(){var params=this._buildParamsForEditor();this.fireEvent("beforeeditorshow",this,params),Rally.nav.Manager.create(this.getSelectedRecordType().replace(/ /g,""),params),this.clearFormFields(),this.toggleAddButton()},_buildDateParam:function(field){var value=field.getValue();return Rally.environment.useSystemTimezone?moment(value).format():Rally.environment.useWorkspaceTimeZone?moment(Rally.util.DateTime.convertFromEditing(value)).format():Rally.util.DateTime.formatWithDefault(value,Rally.environment.getContext())},_buildParamsForEditor:function(){var model=this.models[this.getSelectedRecordType()],params={defaultName:this.showNameField?this.getNameField().getValue():"",typeDef:model.typeDefOid};_.each(this._getAdditionalFieldsWithValues(),function(field){var preventMark=field.preventMark;if(field.preventMark=!0,field.name&&field.isValid()){var paramValue=field.getValue();"rallydatefield"===field.xtype&&(paramValue=this._buildDateParam(field)),params[field.paramName||field.name]=paramValue}field.preventMark=preventMark},this),params.Owner===Rally.util.User.noOwnerValue&&(params.Owner="none");var project=this._getProject();return model.hasField("Project")&&(params.cpoid=Rally.util.Ref.getOidFromRef(project),params.Project=Rally.util.Ref.getRelativeUri(project)),this.context&&Rally.environment.getContext()&&this.context.getWorkspaceRef()!==Rally.environment.getContext().getWorkspaceRef()&&(params.cpoid=Rally.util.Ref.getOidFromRef(project),params.wsoid=Rally.util.Ref.getOidFromRef(project.Workspace)),params},collapse:function(){this.expanded=!1,this.fireEvent("collapse",this,{}),this.down("#parentContainer").hide(),this.down("#expandButton").show(),this.clearFormFields()},getSelectedRecordType:function(){if(this.isVisible()){var typePicker=this.down("#type");return typePicker?typePicker.getValue():this.recordTypes[0]}return this.recordTypes[0]},_getContext:function(){return this.context||Rally.environment.getContext()},_getSelectedTypeInfo:function(){var deferred=new Deft.Deferred,context=this._getContext();return Rally.data.ModelFactory.getModels({types:this.recordTypes,context:Ext.isFunction(context.getDataContext)?context.getDataContext():context,success:function(model){this._onSelectedModelsRetrieved(model),deferred.resolve()},scope:this,requester:this}),deferred.promise},_onSelectedModelsRetrieved:function(models){this.isDestroyed||(this.models=models,this.addCls("interactable"),this._initControlsForLoadedTypes(),this.fireEvent("ready",this))},_onRecordTypeChanged:function(combobox,newValue,oldValue){this._checkAddWithDetailsOnly(this.models[combobox.getValue()]),this.fireEvent("recordtypechange",this,newValue)},_checkAddWithDetailsOnly:function(model){this._hasRequiredFields=_.some(model.getFields(),function(field){return field.required&&!field.readOnly&&!_.contains(this.ignoredRequiredFields,field.name)&&!_.contains(_.pluck(this._getAdditionalFields(),"name"),field.mapping||field.name)},this),this.toggleAddButton()},toggleAddButton:function(){this.down("#addButton")&&(this.disableAddButton||this._hasRequiredFields||!this._allFieldsHaveValidValue()||_.contains(["iteration","release"],this.getSelectedRecordType().toLowerCase())?this.down("#addButton").disable():this.down("#addButton").enable())},_getAdditionalFields:function(){return _.reject(this.down("#parentContainer").query("field"),function(field){return field===this.down("#type")||field===this.getNameField()},this)},_getAdditionalFieldsWithValues:function(){return _.reject(this._getAdditionalFields(),function(field){return!field.isVisible()})},_getAdditionalFieldsForType:function(){return Rally.ui.AddNewEditorFactory.getAdditionalFieldsEditorConfig(this.getSelectedRecordType(),this._getContext())},_allFieldsHaveValidValue:function(){return this._nameValid()&&this._additionalFieldsValid()},_additionalFieldsValid:function(){return _.all(this._getAdditionalFieldsWithValues(),function(field){return field.allowBlank||!Ext.isEmpty(field.getValue())&&field.isValid()})},_nameValid:function(){return!this._hasNameField()||this._nameFieldHasValidValue()},_hasNameField:function(){return this.showNameField},_nameFieldHasValidValue:function(){return!!this.getNameField().getValue()},_onTextFieldSpecialKey:function(cmp,e){if(e.getKey()===e.ENTER)if(cmp.blur(),e.stopEvent(),this.down("#addButton").disabled){var details=this.down("#addWithDetails");details&&!details.disabled&&this._onAddWithDetailsClicked()}else this.onAddClicked()},_onAdditionalFieldSpecialKey:function(cmp,e){cmp.isExpanded||this._onTextFieldSpecialKey(cmp,e)},setFieldLabel:function(newLabel){var label=this.down("#label");this.fieldLabel=newLabel,this.showFieldLabel&&this.rendered&&label&&(this.down("#parentContainer").isHidden()?label.getEl().update(newLabel):label.setText(newLabel))},clearFormFields:function(){this.showNameField&&this.getNameField().reset(),_.invoke(this._getAdditionalFields(),"reset")},getNameField:function(){return this.down("#nameField")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.inlineadd.InlineAddNew",{extend:Rally.ui.AddNew,cls:"inline-add-new",alias:"widget.rallyinlineaddnew",config:{openEditorAfterAddFailure:!1,selectedType:null,defaultValues:{},editorFactory:null,enableAddPlusNewChildStories:!0,alwaysExpanded:!0,width:"100%"},initComponent:function(){_.contains(this.recordTypes,this.selectedType)||(this.selectedType=_.first(this.recordTypes)),this.callParent(arguments)},onRender:function(){this._initializeKeyMap(),this._toggleAddExistingButton(),this.addCls(this._getComponentClsForType(this.selectedType)),this.callParent(arguments)},onDestroy:function(){this.keyMap&&(this.keyMap.destroy(),this.keyMap=null),this.callParent(arguments)},getFieldValues:function(){var values={};return _.each(this._getAdditionalFields(),function(field){values[field.getName()]=field.getValue()}),values.Name=this.getNameField().getValue(),values.selectedType=this.getSelectedType(),values},getAssociatedRecords:function(){return[this.parentRecord]},_initializeKeyMap:function(){this.keyMap=Ext.create("Ext.util.KeyMap",{target:this.el,scope:this,binding:[{key:[Ext.EventObject.ESC],fn:this._onCancelClicked,scope:this},{key:[Ext.EventObject.ENTER,Ext.EventObject.SPACE],fn:this._onEnterOrSpacePressed,scope:this}]})},_getComponentClsForType:function(type){return type.toLowerCase().replace(" ","-")},_getTypeCls:function(type){var typeName=Rally.util.TypeInfo.normalizeTypeName(type),typeInfo=Rally.util.TypeInfo.getTypeInfoByName(typeName);return typeInfo&&typeInfo.icon?typeInfo.icon:""},_getRecordTypes:function(){return _.map(this.recordTypes,function(recordType){return{type:recordType,displayName:recordType.replace(/^PortfolioItem\//,""),iconCls:this._getTypeCls(recordType)}},this)},_getIconComboboxConfig:function(){return{itemId:"type",name:"type",xtype:"rallyiconcombobox",labelAlign:"top",labelPad:10,margin:"0 10px 0 0",fieldLabel:(this.siblingRecord?"PEER":"CHILD")+" TYPE",flex:1,height:40,minWidth:110,maxWidth:110,matchFieldWidth:!0,store:{fields:["type","displayName","iconCls"],data:this._getRecordTypes()},valueField:"type",displayField:"displayName",value:this.selectedType,queryMode:"local",editable:!1,listeners:{change:this._onRecordTypeChanged,scope:this}}},buildChildItems:function(){var items=this._getFieldConfigs();return items=items.concat(this.getButtonConfigs())},_getFieldConfigs:function(){var items=[this._getIconComboboxConfig(),this._getNameFieldEditor(),{xtype:"container",itemId:"additionalFields",layout:{type:"hbox",align:"middle",defaultMargins:{right:4,left:0}},items:this.getAdditionalFields()}];return items},_getNameFieldEditor:function(){var model=this.artifactModel,editor=this.editorFactory.getEditor(model.getField("Name"),this._getEditorConfig("Name"));return editor},_getEditorConfig:function(fieldName,isAdditionalField){var config={context:this.getContext(),listeners:{specialKey:isAdditionalField?this._onAdditionalFieldSpecialKey:this._onTextFieldSpecialKey,keyup:this.toggleAddButton,scope:this}};return _.isUndefined(this.defaultValues[fieldName])||(config.value=this.defaultValues[fieldName]),config},_onRecordTypeChanged:function(combobox,newValue,oldValue){combobox.rendered&&(this.selectedType=newValue,this.getEl().replaceCls(this._getComponentClsForType(oldValue),this._getComponentClsForType(newValue)),this.getNameField().clearInvalid(),this._replaceAdditionalFields(),this._toggleAddExistingButton(),
this.callParent(arguments))},_replaceAdditionalFields:function(){this.suspendLayouts();var cmp=this.down("#additionalFields");cmp.removeAll(),cmp.add(this.getAdditionalFields()),this.resumeLayouts(),this.doLayout()},getAdditionalFields:function(){var fields=this.additionalFields||[];return fields=fields.concat(this.getAdditionalFieldsForType(this.selectedType))},getAdditionalFieldsForType:function(type){var model,fieldNames=[],fieldDefs=[],typeName=Rally.util.TypeInfo.normalizeTypeName(type);switch(typeName){case"userstory":model=this.artifactModel.getArtifactComponentModel("hierarchicalrequirement"),fieldNames=["PlanEstimate","Owner"];break;case"task":model=this.artifactModel.getArtifactComponentModel("task"),fieldNames=["Estimate","Owner"];break;case"defect":model=this.artifactModel.getArtifactComponentModel("defect"),fieldNames=["Priority","Severity"];break;case"testcase":model=this.artifactModel.getArtifactComponentModel("testcase"),fieldNames=["Type","Method"];break;case"portfolioitem":model=this.artifactModel.getArtifactComponentModel(type),fieldNames=["State","PreliminaryEstimate"]}return model&&(fieldDefs=_.map(fieldNames,model.getField,model)),_(fieldDefs).map(function(fieldDef){return this.editorFactory.getEditor(fieldDef,this._getEditorConfig(fieldDef.name,!0))},this).compact().value()},_toggleAddExistingButton:function(){var showAddExisting=this.parentRecord&&this.parentRecord.isTestSet()&&"Test Case"===this.selectedType;this.down("#addExisting").setVisible(showAddExisting)},getButtonConfigs:function(){var items=[{itemId:"addPlusNewButton",xtype:"rallybutton",text:"Create + New",cls:"add-plus-new primary rly-small",userAction:"New record added with create and new",margin:"0 10px 0 60px",disabled:!0,listeners:{click:this._onAddPlusNewClicked,scope:this}},{itemId:"addButton",xtype:"rallybutton",text:"Create",cls:"add secondary rly-small",margin:"0 10px 0 0",userAction:"New record added with create",disabled:!0,listeners:{click:this._onCreateClicked,scope:this}},{itemId:"addWithDetails",xtype:"rallybutton",text:"Add Details",cls:"secondary rly-small add-with-details",margin:"0 10px 0 0",userAction:"Adding new record with details",listeners:{click:this._onAddWithDetailsClicked,scope:this}},{itemId:"addExisting",xtype:"rallybutton",text:"+ Add Existing",cls:"add-existing secondary rly-small",margin:"0 10px 0 0",userAction:"Add existing clicked",listeners:{click:this._onAddExistingClicked,scope:this}},{xtype:"container",margin:0,padding:0,flex:1,style:"top: 0 !important;",items:[{itemId:"cancel",xtype:"rallybutton",cls:"icon-cancel cancel",height:18,userAction:"Cancel inline add",listeners:{click:this._onCancelClicked,scope:this}}]}];return items},toggleAddButton:function(){if(this.down("#addButton")){var enable=!this._hasRequiredFields&&this._allFieldsAreValid(!0);this._updateButtonState("#addButton",enable),enable=!this._isStoryAddingChildStory()&&enable,this._updateButtonState("#addPlusNewButton",enable)}},_isStoryAddingChildStory:function(){return!this.enableAddPlusNewChildStories&&this.parentRecord&&this.parentRecord.isUserStory()&&"User Story"===this.selectedType},_allFieldsAreValid:function(preventMark){var results=!0;return _.each(this.query("field"),function(field){var pm=field.preventMark;field.preventMark=preventMark||pm,field.isValid()||(results=!1),field.preventMark=pm},this),results},getInvalidFields:function(){var results=[];return _.each(this.query("field"),function(field){field.activeError&&results.push(field.name)},this),results},revalidateFields:function(fieldNames){_.each(this.query("field"),function(field){_.contains(fieldNames,field.name)&&field.isValid()},this)},_updateButtonState:function(itemId,enable){var button=this.down(itemId);enable?button.enable():button.disable()},_onCreateClicked:function(){this.on("create",function(){this.fireEvent("collapse",this)},this,{single:!0}),this.onAddClicked()},_onAddPlusNewClicked:function(){this.onAddClicked()},_onAddWithDetailsClicked:function(){this.callParent(arguments),this.fireEvent("collapse",this)},_onCancelClicked:function(){this.fireEvent("collapse",this)},_onAddExistingClicked:function(){this.view.fireEvent("addexisting",this.view,this.parentRecord)},_onTextFieldSpecialKey:function(cmp,e){cmp.isValid(),e.getKey()===e.ENTER&&!this.enableAddPlusNewChildStories&&this.down("#type")&&"User Story"===this.down("#type").getValue()&&this.parentRecord&&this.parentRecord.isUserStory()&&this.on("create",function(){this.fireEvent("collapse",this)},this,{single:!0}),this.callParent(arguments)},clearFormFields:function(){var nameField=this.getNameField();nameField.originalValue="",nameField.reset(),_.each(this._getAdditionalFields(),function(field){field.reset()},this)},_onEnterOrSpacePressed:function(cmp,e){var buttonId=Ext.getCmp(e.target.id)&&Ext.getCmp(e.target.id).itemId;switch(buttonId){case"addPlusNewButton":e.stopEvent(),this._onAddPlusNewClicked();break;case"addButton":e.stopEvent(),this._onCreateClicked();break;case"addWithDetails":e.stopEvent(),this._onAddWithDetailsClicked();break;case"cancel":e.stopEvent(),this._onCancelClicked()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.inlineadd.InlineAddEditorFactory",{singleton:!0,getEditor:function(field,additionalConfig){if(!field.hidden&&!field.readOnly){var defaultEditorField=this._getDefaultEditor(field);if(defaultEditorField){var typeEditorConfig=this._getTypeSpecificConfig(field),editorConfig=this._getFieldSpecificConfig(field),editor=Ext.merge(defaultEditorField,typeEditorConfig,editorConfig,additionalConfig);return editor}}},_getDefaultEditor:function(field){var defaultEditor=Rally.ui.renderer.GridEditorFactory.getEditor(field);return defaultEditor&&defaultEditor.field&&defaultEditor.field.xtype?defaultEditor.field:defaultEditor},_getTypeSpecificConfig:function(field){var editorConfig={name:field.name,minWidth:70,labelAlign:"top",fieldLabel:field.displayName,allowBlank:!field.required,validateOnBlur:!1,labelSeparator:"",height:40,margin:"0 10px 0 0",enableKeyEvents:!0};return _.contains(["quantity","integer","decimal","boolean"],field.attributeDefinition.AttributeType.toLowerCase())?(editorConfig.maxWidth=70,editorConfig.hideTrigger=!1):field.hasAllowedValues()&&(editorConfig.storeConfig={autoLoad:!0}),editorConfig},_getFieldSpecificConfig:function(field){var config={};return"Estimate"===field.name?config={fieldLabel:"TASK EST",minWidth:18}:"PlanEstimate"===field.name?config={fieldLabel:"PLAN EST",minWidth:18}:"Name"===field.name?config={itemId:"nameField",listeners:{focus:function(el){el.getValue()&&(el.inputEl.dom.selectionStart=el.getValue().length)}}}:"Owner"===field.name&&(config={value:Rally.environment.getContext().getUser().getRef(),noEntryValue:Rally.util.User.noOwnerValue}),config}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.RowBody",{extend:Ext.grid.feature.RowBody,alias:"feature.rallyrowbody",onColumnsChanged:function(headerCt){var colspan=headerCt.getVisibleGridColumns().length;colspan&&this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.ArtifactSearchComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyartifactsearchcombobox",config:{editable:!0,typeAhead:!0,queryMode:"remote",minChars:0,forceSelection:!0,selectOnFocus:!0,emptyText:"Search...",allowNoEntry:!0,noEntryText:"-- None --",listConfig:{overflowX:"hidden"},storeConfig:{autoLoad:!1,models:[],pageSize:10,remoteFilter:!0,sorters:{property:"FormattedID",direction:"DESC"}},storeType:"Rally.data.wsapi.artifact.Store"},initComponent:function(){this.listConfig.tpl=this._getItemTpl(),this.displayTpl=this._getDisplayTpl(),this.callParent(arguments)},constructor:function(config){config.value&&Ext.merge(config,{storeConfig:{filters:[{property:"ObjectID",value:Rally.util.Ref.getOidFromRef(config.value)}]}}),this.callParent(arguments)},_getItemTpl:function(){return Ext.create("Ext.XTemplate",'<tpl for=".">','<div class="'+Ext.baseCSSPrefix+'boundlist-item">','<tpl if="values.FormattedID">{FormattedID}: </tpl>',"{_refObjectName:htmlEncode}","</div>","</tpl>")},_getDisplayTpl:function(){return Ext.create("Ext.XTemplate",'<tpl for=".">','<tpl if="values.FormattedID">{FormattedID}: </tpl>',"{_refObjectName:htmlEncode}","</tpl>")},beforeQuery:function(queryPlan){var queryString=queryPlan.query,storeFilters=this.store.filters.getRange(),idFilter=Rally.data.wsapi.Filter.or([{property:"FormattedID",operator:"contains",value:queryString},{property:"Name",operator:"contains",value:queryString}]);return this.store.filters=this.store.filters.filterBy(function(item){return"Name"!==item.property&&"ObjectID"!==item.property}),storeFilters.length?queryString?queryPlan.query=Rally.data.wsapi.Filter.and(storeFilters).and(idFilter).toString():queryPlan.query=Rally.data.wsapi.Filter.and(storeFilters).toString():queryString&&(queryPlan.query=idFilter.toString()),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.plugins.ArtifactTestFolderFilter",{alias:"plugin.rallyartifacttestfolderfilter",extend:Rally.ui.dialog.plugins.ArtifactFilterPlugin,statics:{NO_ENTRY_VALUE:"/testfolder/-1"},getAdditionalColumns:function(){return[{text:"Test Folder",dataIndex:"TestFolder"}]},getSearchBarItem:function(){return{xtype:"rallyartifactsearchcombobox",allowClear:!0,allowNoEntry:!0,clearText:"-- Clear Filter --",emptyText:"Filter by Test Folder...",defaultSelectionPosition:null,itemId:"testFolderChooser",listeners:{select:this.cmp.buildGrid,scope:this.cmp},noEntryText:"-- No Test Folder --",noEntryValue:this.self.NO_ENTRY_VALUE,margin:"0 0 0 10px",storeConfig:{context:this.cmp.storeConfig.context,model:"TestFolder"},storeType:"Rally.data.wsapi.Store",width:200}},getStoreFilters:function(){var storeFilters=this.callParent(),testFolderChooser=this.cmp.down("#testFolderChooser"),testFolderValue=testFolderChooser.getValue();if(testFolderChooser&&testFolderValue){var value=testFolderValue===this.self.NO_ENTRY_VALUE?null:testFolderValue;storeFilters.push({property:"TestFolder",value:value})}return storeFilters}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.InlineAddRowExpander",{extend:Ext.grid.plugin.RowExpander,alias:"plugin.rallyinlineaddrowexpander",mixins:[Rally.Messageable],clientMetrics:[{method:"_onExpandBody",description:"InlineAddNew expanded"},{method:"_onCollapseBody",description:"InlineAddNew collapsed"}],config:{action:"inlineaddchild",rowBodyDivCls:"inline-add-rowbody",rootParentRecord:null},expandOnDblClick:!1,expandOnEnter:!1,selectRowOnExpand:!1,rowBodyTpl:["<div></div>"],init:function(grid){this.callParent(arguments);var view=this.view;view.on("expandbody",this._onExpandBody,this),view.on("collapsebody",this._onCollapseBody,this),view.on("inlineadd",this._onInlineAdd,this),view.on("addexisting",this._onAddExisting,this),view.on("afterrenderrange",this._onAfterRenderRange,this),this.expandedComponentDefaultValues={}},_onAfterRenderRange:function(start,end){if(this.expandedRecord){var needsComponent=_.any(this.view.getNodes(start,end),function(newNode){var wasBuffered=this._isCurrentlyExpandedRecord(this.view.getRecord(newNode)),needsInlineAdd=null===newNode.querySelector(".inline-add-new");return wasBuffered&&needsInlineAdd},this);needsComponent&&this._expandRowbodyForRecord(this.expandedRecord)}},_onExpandBody:function(rowNode,record,expandRow){var view=this.view;record.isExpandable()?this._isInlineAddChild()?record.isExpanded()?this._initializeComponentWithListeners(record,expandRow):(view.on("afteritemexpand",function(){this._initializeComponentWithListeners(record,expandRow)},this,{single:!0}),view.expand(record)):(this._initializeComponentWithListeners(record,expandRow),record.on("expand",this.collapse,this,{single:!0}),record.isExpanded()&&view.collapse(record)):this._initializeComponentWithListeners(record,expandRow)},_initializeComponentWithListeners:function(record,expandRow){this._buildComponent(record,expandRow),this.view.on("refresh",this._onViewRefresh,this),this.view.on("itemupdate",this._onItemUpdate,this),this.grid.on("storebeforecollapse",this._onStoreBeforeCollapse,this),this.grid.headerCt.on("columnresize",this._onColumnResize,this)},_onStoreBeforeCollapse:function(record){this._getRecordIfExpandedRecordIsChild(record)&&this.collapse()},_onCollapseBody:function(){this._unregisterListeners()},_unregisterListeners:function(){this.view.un("refresh",this._onViewRefresh,this),this.view.un("itemupdate",this._onItemUpdate,this),this.grid.un("storebeforecollapse",this._onStoreBeforeCollapse,this),this.grid.headerCt.un("columnresize",this._onColumnResize,this)},_onViewRefresh:function(){this.expandedRecord&&this.view.getNodeByRecord(this.expandedRecord)?this._expandRowbodyForRecord(this.expandedRecord):(this._unregisterListeners(),this._cleanUp())},_onItemUpdate:function(record){this._isCurrentlyExpandedRecord(record)?this._expandRowbodyForRecord(record):this._isNonRootPeerInlineAdd(record)&&(this.view.un("afteritemexpand",this._afterItemExpand,this),this.view.on("afteritemexpand",this._afterItemExpand,this,{single:!0}))},_afterItemExpand:function(record){var childRecord=this._getRecordIfExpandedRecordIsChild(record);childRecord&&this._expandRowbodyForRecord(childRecord)},_isNonRootPeerInlineAdd:function(record){return this._isInlineAddPeer()&&this.expandedRecord.getDepth()>1&&!!this._getRecordIfExpandedRecordIsChild(record)},_getRecordIfExpandedRecordIsChild:function(record){return record.findChildBy(function(child){return this._isCurrentlyExpandedRecord(child)},this,!0)},setCmp:function(grid){this.callParent(arguments);var gridBodyFeatureConfig=_.find(grid.features,{ftype:"rowbody"});gridBodyFeatureConfig.ftype="rallyrowbody",gridBodyFeatureConfig.rowBodyDivCls=this.rowBodyDivCls,gridBodyFeatureConfig.rowExpander=this},createComponent:function(view,record,defaultValues){var recordTypes=[],parentRecord=null,siblingRecord=null,artifactModel=this.grid.getModels()[0];_.isFunction(artifactModel.getArtifactComponentModel)||Ext.Error.raise("You must use an artifact model here or add new won't work.  Currently we need to create component with all models that will be used"),this._isInlineAddChild()?(parentRecord=record,recordTypes=this._getInlineAddChildRecordTypes(record)):(siblingRecord=record,record.parentNode&&!record.parentNode.isRoot()?(parentRecord=record.parentNode,recordTypes=this._getInlineAddPeerRecordTypes(parentRecord,siblingRecord)):(this.rootParentRecord&&(parentRecord=this.rootParentRecord),recordTypes=this._getInlineAddPeerRecordTypes(null,siblingRecord)));var config={editorFactory:Rally.ui.grid.inlineadd.InlineAddEditorFactory,view:view,artifactModel:artifactModel,defaultValues:defaultValues,parentRecord:parentRecord,siblingRecord:siblingRecord,context:this.cmp.context,recordTypes:recordTypes,style:this._getInlineAddNewPadding(view,record),ignoredRequiredFields:["Name","Project","WorkProduct","State","TaskIndex","ScheduleState"]};if(this.expandedComponentDefaultValues&&this.expandedComponentDefaultValues.selectedType)config.selectedType=this.expandedComponentDefaultValues.selectedType;else if(this._isInlineAddChild())switch(parentRecord.self.typePath){case"hierarchicalrequirement":case"defect":config.selectedType="Task";break;case"defectsuite":config.selectedType="Defect";break;case"testset":config.selectedType="Test Case"}else siblingRecord.self.isPortfolioItem()||(config.selectedType=Rally.util.TypeInfo.typeInfos[siblingRecord.self.typePath].typeName);var addNewCmp=Ext.widget("rallyinlineaddnew",Ext.apply(config,this.grid.inlineAddConfig));return addNewCmp.on("beforecreate",this._beforeCreateNewRecord,this),addNewCmp.on("beforeeditorshow",this._beforeEditorShow,this),addNewCmp.on("collapse",this.collapse,this),addNewCmp},_isInlineAddChild:function(){return"inlineaddchild"===this.action},_isInlineAddPeer:function(){return"inlineaddpeer"===this.action},_getInlineAddNewPadding:function(view,record){var rowNode=view.getNodeByRecord(record),artifactIcon=Ext.get(rowNode.querySelector(".artifact-icon")),padding=artifactIcon.getLeft()-view.getEl().getLeft()-12;return this._isInlineAddChild()&&(padding+=15),"padding-left:"+padding+"px;"},addExpander:Ext.emptyFn,beforeReconfigure:Ext.emptyFn,setup:function(rows,rowValues){var rowExpander=this.rowExpander,shouldDestroyExpandedComponent=_.any(rows,function(row){return rowExpander._isCurrentlyExpandedRecord(row)&&rowExpander.expandedComponent},this);shouldDestroyExpandedComponent&&(rowExpander.expandedComponentDefaultValues=rowExpander.expandedComponent.getFieldValues(),rowExpander.expandedComponentDefaultValues.invalidFields=rowExpander.expandedComponent.getInvalidFields(!0),rowExpander.expandedComponent.getNameField().blur(),rowExpander.expandedComponent.destroy(),rowExpander.expandedComponent=null,delete rowExpander.expandedComponent),this.callParent(arguments),rowValues.rowBodyDivCls=this.rowBodyDivCls,this.grid.ownerLockable||(rowValues.rowBodyColspan+=1)},collapse:function(){var expandedRecord=this.expandedRecord;expandedRecord&&(this.view.getNodeByRecord(expandedRecord)?this.toggleRow(this.view.store.indexOf(expandedRecord),expandedRecord):(this.recordsExpanded[expandedRecord.internalId]=!1,this._onCollapseBody())),this._cleanUp()},destroy:function(){this._cleanUp()},_onColumnResize:function(){this.expandedComponent&&this.expandedComponent.doComponentLayout()},_getInlineAddChildRecordTypes:function(record){var recordTypes=[];return record.canHaveTasks()&&recordTypes.push("Task"),record.canHaveDefects()&&recordTypes.push("Defect"),record.canHaveChildren()&&(record.self.isPortfolioItem()&&!record.self.isLowestLevelPortfolioItem()?recordTypes.push(record.getField("Children").attributeDefinition.AllowedValueType._refObjectName):this._addingPeerUnderStoryDoesNotAllowChildStories(record)||recordTypes.push("User Story")),record.canHaveTestCases()&&recordTypes.push("Test Case"),recordTypes},_addingPeerUnderStoryDoesNotAllowChildStories:function(record){return!this._isInlineAddChild()&&record.isUserStory()&&this.grid.inlineAddConfig&&this.grid.inlineAddConfig.enableAddPlusNewChildStories===!1},_getInlineAddPeerRecordTypes:function(parentRecord,siblingRecord){var recordTypes=[];return parentRecord?recordTypes=this._getInlineAddChildRecordTypes(parentRecord):siblingRecord.self.isPortfolioItem()?recordTypes.push(siblingRecord.self.typePath):_.each(this.grid.store.parentTypes,function(type){Rally.util.TypeInfo.typeInfos[type]&&Rally.util.TypeInfo.typeInfos[type].typeName&&recordTypes.push(Rally.util.TypeInfo.typeInfos[type].typeName)}),recordTypes},_beforeEditorShow:function(addNewCmp,params){var parentRecord=addNewCmp.parentRecord,siblingRecord=addNewCmp.siblingRecord;if(parentRecord){var newChildTypePath=addNewCmp.getSelectedRecordType().toLowerCase(),parentFieldName=this._getParentFieldName(parentRecord.self.typePath,newChildTypePath);if("DefectSuites"===parentFieldName)params.defectSuiteOid=parentRecord.getId();else if("TestSets"===parentFieldName)params.testsetOid=parentRecord.getId();else{params[parentFieldName]=parentRecord.get("_ref");var grandParent=parentRecord.get("WorkProduct");"defect"===newChildTypePath&&parentRecord.isTestCase()&&"hierarchicalrequirement"===Rally.util.Ref.getTypeFromRef(grandParent)&&(params.Requirement=Rally.util.Ref.getRelativeUri(grandParent))}parentRecord.isUserStory()&&"user story"===newChildTypePath&&(parentRecord.get("Release")&&(params.Release=parentRecord.get("Release")._ref),parentRecord.get("Iteration")&&(params.Iteration=parentRecord.get("Iteration")._ref))}this._isInlineAddChild()?params.rankTo="BOTTOM":(parentRecord||(siblingRecord.get("Release")&&(params.Release=siblingRecord.get("Release")._ref),siblingRecord.get("Iteration")&&(params.Iteration=siblingRecord.get("Iteration")._ref)),this._setPeerRankParam(addNewCmp,siblingRecord,params))},_getParentFieldName:function(parentType,childType){return"defect"!==parentType||"defectsuite"!==childType&&"defect suite"!==childType?this.mapper.getParentField(parentType,childType):"Defects"},_beforeCreateNewRecord:function(addNewCmp,newRecord,params){var parentRecord=addNewCmp.parentRecord,siblingRecord=addNewCmp.siblingRecord;if(parentRecord){var parentFieldName=this._getParentFieldName(parentRecord.self.typePath,newRecord.self.typePath);if(newRecord.getField(parentFieldName).isCollection())newRecord.set(parentFieldName,[{_ref:parentRecord.get("_ref")}]);else{newRecord.set(parentFieldName,parentRecord.get("_ref"));var grandParent=parentRecord.get("WorkProduct");newRecord.isDefect()&&parentRecord.isTestCase()&&"hierarchicalrequirement"===Rally.util.Ref.getTypeFromRef(grandParent)&&newRecord.set("Requirement",Rally.util.Ref.getRelativeUri(grandParent))}}this._isInlineAddChild()?params.rankTo="BOTTOM":(parentRecord||(siblingRecord.get("Iteration")&&newRecord.set("Iteration",siblingRecord.get("Iteration")._ref),siblingRecord.get("Release")&&newRecord.set("Release",siblingRecord.get("Release")._ref)),this._setPeerRankParam(addNewCmp,siblingRecord,params))},_setPeerRankParam:function(addNewCmp,siblingRecord,params){var newType=addNewCmp.selectedType,siblingType=siblingRecord.get("_type"),store=this.grid.store,ranker=Rally.data.Ranker,siblingRef=siblingRecord.get("_ref"),storeIsRankAsc=ranker.isStoreSortedByRankAsc(store),storeIsRankDesc=ranker.isStoreSortedByRankDesc(store);"Task"===newType&&"task"!==siblingType||"Task"!==newType&&"task"===siblingType?params.rankTo="BOTTOM":"Task"===newType&&"task"===siblingType?storeIsRankAsc?params.taskIndexBelow=siblingRef:storeIsRankDesc&&(params.taskIndexAbove=siblingRef):storeIsRankAsc?params.rankBelow=siblingRef:storeIsRankDesc&&(params.rankAbove=siblingRef)},_cleanUp:function(){this.expandedComponent&&(this.expandedComponent.getNameField().blur(),this.expandedComponent.destroy(),this.expandedComponent=null),this.expandedRecord&&this.expandedRecord.un("expand",this.collapse,this),this.expandedRecord=null,this.expandedRecordPath=null},_isCurrentlyExpandedRecord:function(record){return this.expandedRecordPath&&this.expandedRecordPath===record.getPath()},_expandRowbodyForRecord:function(record){var view=this.view,expandRow=this._getExpanderRow(record);this._isCurrentlyExpandedRecord(record)&&this._buildComponent(record,expandRow),this.view.getNodeByRecord(record)&&this._rowIsHidden(expandRow)&&this.toggleRow(view.store.indexOf(record),record)},_rowIsHidden:function(expandRow){var row=Ext.get(expandRow);return row.hasCls(this.rowCollapsedCls)||row.hasCls(this.rowBodyHiddenCls)},_onAddExisting:function(view,record){(this.expandedComponent&&"Test Case"!==this.expandedComponent.selectedType||!this._isCurrentlyExpandedRecord(record))&&this.collapse(),record.getCollection("TestCases",{autoLoad:!0,listeners:{load:{fn:function(collectionStore){Ext.create("Rally.ui.dialog.ArtifactCollectionChooserDialog",{collectionStoreToAddTo:collectionStore,listeners:{addsuccess:function(){this.collapse()},artifactchosen:function(){record.expand()},scope:this},context:this.grid.getContext(),plugins:["rallyartifacttestfolderfilter",{ptype:"rallyartifactprojectfilter",fieldLabel:"&nbsp;"}],selectionButtonText:"Add",storeConfig:{context:{workspace:this.grid.getContext().getWorkspaceRef(),project:null},filters:[{property:"TestSets",operator:"!contains",value:Rally.util.Ref.getRelativeUri(record)}]},title:"Choose Test Cases"})},scope:this,single:!0}},pageSize:1})},_onInlineAdd:function(view,record,eOpts){this.mapper||(this.mapper=Ext.create("Rally.data.wsapi.ParentChildMapper"),this.mapper.initDynamicTypes(this.grid.getContext().getDataContext()));var isSameAction=this.getAction()===eOpts.action;this.setAction(eOpts.action),this._removeSelectedRowClasses(this.view.getNodeByRecord(record)),this._isCurrentlyExpandedRecord(record)&&this.expandedComponent&&isSameAction?this.expandedComponent.clearFormFields():(this.expandedComponentDefaultValues={},this.collapse(),this._expandRowbodyForRecord(record))},_removeSelectedRowClasses:function(rowNode){var rowContainer=Ext.get(rowNode).up("."+Ext.baseCSSPrefix+"grid-row");rowContainer.removeCls(Rally.ui.grid.CheckboxModel.highlightRowCls),rowContainer.removeCls(Ext.baseCSSPrefix+"grid-row-focused")},_buildComponent:function(record,expandRow){for(var defaultValues=this._getDefaultValues(record),newComponent=this.createComponent(this.view,record,defaultValues),targetRowbody=Ext.DomQuery.selectNode("div."+Ext.baseCSSPrefix+"grid-rowbody",expandRow);targetRowbody.hasChildNodes();)targetRowbody.removeChild(targetRowbody.lastChild);newComponent.render(targetRowbody),newComponent.revalidateFields(defaultValues.invalidFields),defaultValues.invalidFields=[],this.expandedComponent=newComponent,this.expandedRecordPath=record.getPath(),this.expandedRecord=record},_getDefaultValues:function(record){var defaultValues=this._isCurrentlyExpandedRecord(record)?this.expandedComponentDefaultValues:{};return this._isInlineAddChild()&&record.isUserStory()&&record.get("PlanEstimate")&&0===record.get("DirectChildrenCount")&&(defaultValues.PlanEstimate=record.get("PlanEstimate")),defaultValues},_getExpanderRow:function(record){var rowNode=this.view.getNodeByRecord(record);return Ext.fly(rowNode).next(this.rowBodyTrSelector).dom}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.TreeGridRankable",{getMoveToPositionStore:function(options){var storeConfig;return storeConfig=this._isTopLevelNode(options.recordBeingRanked)?this._getRootItemPositionStoreConfig(options):this._getChildItemPositionStoreConfig(options),Ext.create("Rally.data.DataStoreBuilder").build(_.assign({requester:this},storeConfig))},findRankedRecord:function(options){this.recordLoadBegin({description:"Finding record to rank against"});var model,newStore,filters,recordRankField=Rally.data.Ranker.getRankField(options.recordBeingRanked.self);return this._isTopLevelNode(options.recordBeingRanked)?(model=this.store.model,filters=this._getFiltersForTopLevelNodeSiblings()):(model=options.recordBeingRanked.self,filters=this._getFiltersForChildNodeSiblings(options.recordBeingRanked)),newStore=Ext.create("Rally.data.wsapi.artifact.Store",Ext.apply({models:this._getRankableModels(model),filters:filters,pageSize:1,limit:1,requester:this,enableRankFieldParameterAutoMapping:!1,sorters:[{property:recordRankField,direction:options.highest?"ASC":"DESC"}]},options.storeConfig)),newStore.load({callback:function(records,operation,success){if(success){var rankedRecord=options.highest?_.first(records):_.last(records);Ext.callback(options.success,options.scope,[rankedRecord])}else Ext.callback(options.failure,options.scope,[operation]);this.recordLoadEnd()},scope:this})},shouldRecordBeRankable:function(record){var parentNode=this._getParentNode(record);return!!parentNode&&(parentNode.isRoot()?this.store.getTotalCount()>1:this._shouldChildRecordBeRankable(record,parentNode))},shouldRecordBeExtremeRankable:function(record){var parentNode=this._getParentNode(record);return!(!parentNode||!Rally.data.Ranker.isStoreSortedByRank(this.store))&&(!!parentNode.isRoot()||this._shouldChildRecordBeRankable(record,parentNode))},_getParentNode:function(record){return record&&record.parentNode},_shouldChildRecordBeRankable:function(record,parentNode){var type=record.self.typePath,siblingsOfSameType=_.filter(parentNode.childNodes,function(sibling){return sibling!==record&&sibling.self.typePath===type});return siblingsOfSameType.length>0},_getRootItemPositionStoreConfig:function(options){options=options||{};var storeConfig=options.storeConfig||{},filters=this._getFiltersForTopLevelNodeSiblings();return storeConfig.filters=storeConfig.filters?storeConfig.filters.concat(filters):filters,Ext.merge(storeConfig,{models:this.store.parentTypes,sorters:this.store.sorters.getRange()})},_getChildItemPositionStoreConfig:function(options){options=options||{};var storeConfig=options.storeConfig||{},parentFilters=this._getFiltersForChildNodeSiblings(options.recordBeingRanked);return storeConfig.alwaysSortedByRankAsc||(storeConfig.filters=storeConfig.filters?storeConfig.filters.concat(parentFilters):parentFilters,storeConfig.sorters=_.cloneDeep(this.store.childLevelSorters)),Ext.merge(storeConfig,{models:[options.recordBeingRanked.self]})},_getFiltersForTopLevelNodeSiblings:function(){return this.store.filters.getRange()},_getFiltersForChildNodeSiblings:function(record){var parentFieldNames=this.store.getParentFieldNamesByChildType(record.self.typePath,record.parentNode.self.typePath),value=record.parentNode.get("_ref");if(parentFieldNames.length){var parentFilters=_.map(parentFieldNames,function(parentFieldName){return{property:parentFieldName,operator:"=",value:value}});return[Rally.data.wsapi.Filter.or(parentFilters)]}return[]},_isTopLevelNode:function(record){return record.parentNode.isRoot()},_getRankableModels:function(model){return _.isFunction(model.getArtifactComponentModels)?_.reject(model.getArtifactComponentModels(),function(f){return f.isTask()}):[model]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeGrid",{extend:Ext.tree.Panel,alias:"widget.rallytreegrid",cls:"rally-grid",mixins:{messageable:Rally.Messageable,stateful:Ext.state.Stateful,filternotifiable:Rally.ui.filter.FilterNotifiable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable,treeGridRankable:Rally.ui.grid.dragdrop.TreeGridRankable},clientMetrics:[{beginEvent:"collapsebatch",endEvent:"aftercollapsebatch",description:"collapse batch"},{beginEvent:"beforeitemcollapse",endEvent:"afteritemcollapse",description:"item collapse"},{beginEvent:"beforeitemexpand",endEvent:"itemexpand",description:"item expand"},{beginEvent:"storebeforefilter",endEvent:"storeload",description:"reload due to filter change"}],appliedState:void 0,config:{store:void 0,noDataHelpLink:void 0,noDataItemName:void 0,noDataPrimaryText:void 0,noDataSecondaryText:void 0,columnCfgs:[],alwaysShowDefaultColumns:!1,bufferedRenderer:!1,autoAddAllModelFieldsAsColumns:!1,shouldShowRowActionsColumn:!0,rowActionColumnConfig:null,disableColumnMenus:!0,enableBlockedReasonPopover:!0,enableScheduleStateClickable:!0,enableRanking:!0,enableEditing:!0,enableBulkEdit:!0,bulkEditConfig:{},lines:!1,enableValidationUi:!0,editingConfig:{publishMessages:!0},enableInlineAdd:!1,enableSummaryRow:!1,enableTextSelection:!1,inlineAddConfig:{},plugins:[],selModel:{selType:"rallyrowmodel"},context:void 0,rootVisible:!1,viewConfig:{xtype:"rallytreeview",enableTextSelection:!1,animate:!1,loadMask:!1,forceFit:!0,plugins:["rallytreeviewdragdrop","rallyviewvisibilitylistener"]},treeColumnDataIndex:"FormattedID",treeColumnHeader:"ID",treeColumnResizable:!1,treeColumnRenderer:void 0,rankColumnDataIndex:"DragAndDropRank",onBeforeRecordMenuCopy:Ext.emptyFn,onRecordMenuCopy:Ext.emptyFn,onBeforeRecordMenuDelete:Ext.emptyFn,onRecordMenuDelete:Ext.emptyFn,onBeforeRecordMenuRankHighest:Ext.emptyFn,onBeforeRecordMenuRankLowest:Ext.emptyFn,onRecordMenuRemove:Ext.emptyFn,expandTracker:null,variableRowHeight:!0,expandAllInColumnHeaderEnabled:!1,allowExpansionStateToBeSaved:!0,allColumnsStateful:!1},constructor:function(config){this.mergeConfig(config),this.config.viewConfig.enableTextSelection=config.enableTextSelection,this.treeColumnRenderer=this.treeColumnRenderer||this._defaultTreeColumnRenderer,this.plugins=this._setupPlugins(config),this.callParent(arguments)},initComponent:function(){this.store||Ext.Error.raise("A store must be specified in the config"),this.expandTracker||(this.expandTracker=Ext.create("Rally.ui.grid.TreeGridExpandTracker")),this.variableRowHeight||this.addCls("rally-grid-cell-no-wrap"),this.addEvents(["filterchange","expandall","collapseall","afterexpandbatch","aftercollapsebatch","afterchildadd"]),this.store.requester=this.store.requester||this,this.store.clientMetricsParent=this,this.enableBulkEdit&&(this.selType="rallycheckboxmodel",this.selModel={injectCheckbox:this.enableRanking?1:0}),this.listeners&&(this.on(this.listeners),this.listeners=null),this._applyInitialState(),
this._buildDockedItems(),this._buildColumns(),this._applySorters(),this._applyFetch(),this._initView(),this.features=this._setupFeatures(),this.callParent(arguments),this.subscribe(Rally.Message.bulkImport,function(){this.refresh({callback:function(records,operation,success){this.store.sort()},scope:this})},this)},getHeaderResizeTracker:function(){return this.headerCt&&this.headerCt.resizer&&this.headerCt.resizer.tracker},_defaultTreeColumnRenderer:function(value,metaData,record,rowIdx,colIdx,store){return store=store.treeStore||store,Rally.ui.renderer.RendererFactory.getRenderTemplate(store.model.getField("FormattedID")).apply(record.data)},_applySorters:function(){var sorterConfig,rankField,store=this.store;store.sorters.getCount()>0||(Rally.data.Ranker.isRankable(store.model)?(rankField=Rally.data.Ranker.getRankField(store.model),sorterConfig=Rally.data.util.Sorter.sorters(rankField+" ASC").pop()):sorterConfig=Rally.data.util.Sorter.getDefaultSort(store.model.typePath,{asSorter:!0}).pop(),store.sorters.add(Ext.create("Ext.util.Sorter",sorterConfig)))},_applyFetch:function(){this.getStore().fetch=this._buildFetch(),this._shouldShowSummary()&&(this.store.summaryFields=_.pluck(this.getSummaryColumns(),"dataIndex"))},_addStoreListeners:function(){this.relayEvents(this.store,["load","beforeexpand","beforecollapse","beforeload","expand","collapse","currentpagereset","datachanged","excludebyfilter","movetopage","beforefilter","afterbuscreate","afterbusupdate","afterbusbulkupdate","afterbusremove"],"store"),this.on("storeload",this._onStoreLoad,this),this.on("storedatachanged",this._onDataChanged,this),this.on("storeexcludebyfilter",this._onExcludeByFilter,this),this.on("storemovetopage",this._onMoveToPage,this),this._initStateEvents()},_initPager:function(){var pager=this.down("#pagingToolbar");this.relayEvents(pager,["change","beforechange"],"pagingtoolbar"),this._addPageResetListeners()},_initView:function(){return this.rendered?(this.getView().on("rowfocus",this._onRowFocus,this),this._addStoreListeners(),this._initPager(),void this._fireComponentReady()):void this.on("afterrender",this._initView,this,{single:!0})},_initStateEvents:function(){this.on("storeload",function(){this.readyForStateEvents=!0,this.addStateEvents(["columnresize","columnmove","sortchange","reconfigure","pagingtoolbarchange"]),this.recordComponentReady()},this,{single:!0,buffer:100})},_applyInitialState:function(){var id=this.getStateId()||"",state=this.appliedState||Ext.state.Manager.getProvider().get(id)||{};this.applyState(state)},_fireComponentReady:function(){Rally.BrowserTest&&(Rally.BrowserTest.publishComponentReady(this),this.publish(Rally.Message.treeLoaded))},destroy:function(){this._removePageResetListeners(),this.callParent(arguments)},refresh:function(options){return this.store.load(_.assign({node:this.getRootNode(),clearOnLoad:!1},options))},refreshAfterBulkAction:function(){return Deft.Promise.when(!0)},_addPageResetListeners:function(){this.on("storecurrentpagereset",this._resetCurrentPage,this)},_removePageResetListeners:function(){this.un("storecurrentpagereset",this._resetCurrentPage,this)},_getColumnCfgs:function(){return this.columnCfgs},_getColumnName:function(column){return(_.isString(column)?column:column&&column.dataIndex)||""},_isStatefulColumn:function(columnName){if(!this.allColumnsStateful){if(columnName=columnName.toLowerCase(),this.store.enableHierarchy&&columnName===this.treeColumnDataIndex.toLowerCase())return!1;if(this.enableRanking&&columnName===this.rankColumnDataIndex.toLowerCase())return!1}return!0},_getStatefulColumns:function(columnCfgs){return _.filter(columnCfgs,function(columnCfg){var columnName=this._getColumnName(columnCfg);return!_.isEmpty(columnName)&&this._isStatefulColumn(columnName)},this)},addStateEvents:function(){this.readyForStateEvents&&this.callParent(arguments)},getCurrentView:function(){var view=_.pick(this.getState(),["columns","sorters"]);return view.columns=_.map(_.filter(view.columns,{xtype:"rallyfieldcolumn"}),function(c){return _.pick(c,["dataIndex","flex"])}),view},applyState:function(state){if(this.appliedState=state,this.fireEvent("beforestaterestore",this,state),state.columns&&(state.columns=_.reject(state.columns,function(col){return!this._getColumnName(col)},this),_.each(state.columns,this._setColumnFlex,this),state.columns=_.map(state.columns,this._transformUuidsToNames,this),this._applyStatefulColumns(state.columns)),state.pagingToolbar){var store=this.getStore(),pageSize=state.pagingToolbar.pageSize,currentPage=state.pagingToolbar.currentPage;if(this.pagingToolbarCfg){var maxPageSize=_.last(this.pagingToolbarCfg.pageSizes);maxPageSize&&maxPageSize<pageSize&&(pageSize=maxPageSize,currentPage=1)}store.pageSize=pageSize,store.currentPage=currentPage}if(state.sorters){_.each(state.sorters,this._transformUuidsToSorterProperty,this);var sorters=_.transform(state.sorters,function(collection,sorterState){Rally.data.Ranker.isRankField(sorterState.property)&&(sorterState.property=Rally.data.Ranker.getRankField(this.store.model)),collection.add(Ext.create("Ext.util.Sorter",{property:sorterState.property,direction:sorterState.direction}))},Ext.create("Ext.util.MixedCollection"),this);this.getStore().sorters=sorters}state.expandedRowPersistence&&(this.expandedRowPersistenceState=state.expandedRowPersistence),this.fireEvent("staterestore",this,state)},_applyStatefulColumns:function(columns){this.alwaysShowDefaultColumns&&_.each(this.columnCfgs,function(columnCfg){_.any(columns,{dataIndex:this._getColumnName(columnCfg)})||columns.push(columnCfg)},this),this.columnCfgs=columns},_transformUuidsToNames:function(column){var columnName=this._getColumnName(column),field=this._getModelField(columnName);return field&&(column=this._setColumnNameValue(column,field)),column},_setColumnNameValue:function(column,field){return _.isObject(column)?column.dataIndex=field.name:column=field.name,column},_transformUuidsToSorterProperty:function(sorter){var field=this._getModelField(sorter.property);field&&(sorter.property=field.name)},_getPersistableColumnConfig:function(column){var columnConfig=this._getColumnConfigFromColumn(column),field=this._getModelField(columnConfig.dataIndex);return field&&field.getUUID()&&(columnConfig.dataIndex=field.getUUID()),columnConfig},_getPersistableSorter:function(sorterProperty){var field=this._getModelField(sorterProperty);return field&&field.getUUID()||sorterProperty},getState:function(){var state={},statefulColumns=this._getStatefulColumns(this.headerCt.getGridColumns());return state.columns=_.map(statefulColumns,this._getPersistableColumnConfig,this),state.pagingToolbar={pageSize:this.getStore().pageSize,currentPage:this.getStore().currentPage},state.sorters=_.map(this.getStore().sorters.getRange(),function(sorter){return{property:this._getPersistableSorter(sorter.property),direction:sorter.direction}},this),this.allowExpansionStateToBeSaved&&(state.expandedRowPersistence=this.expandedRowPersistenceState),state},saveState:Ext.Function.createBuffered(function(){this.isDestroyed||Ext.state.Stateful.prototype.saveState.apply(this,arguments)},100),_getColumnConfigsBasedOnCurrentOrder:function(columnConfigs){return _(this.headerCt.items.getRange()).map(function(column){return _.contains(columnConfigs,column.dataIndex)?column.dataIndex:_.find(columnConfigs,{dataIndex:column.dataIndex})}).compact().value()},_restoreColumnOrder:function(columnConfigs){var currentColumns=this._getColumnConfigsBasedOnCurrentOrder(columnConfigs),addedColumns=_.filter(columnConfigs,function(config){return!_.find(currentColumns,{dataIndex:config.dataIndex})});return currentColumns.concat(addedColumns)},reconfigureWithColumns:function(columnCfgs,reconfigureExistingColumns,suspendLoad){columnCfgs=this._getStatefulColumns(columnCfgs),reconfigureExistingColumns||(columnCfgs=this._mergeColumnConfigs(columnCfgs,this.columns),columnCfgs=this._restoreColumnOrder(columnCfgs)),this.columnCfgs=columnCfgs,this._buildColumns(!0),this._applyFetch();var summaryRow=this.getView().getFeature("summaryrow");summaryRow&&summaryRow.toggleSummaryRow(this._shouldShowSummary()),this.on("reconfigure",function(){this.headerCt.setSortState()},this,{single:!0}),this.reconfigure(null,this.columns),this.columns=this.headerCt.items.getRange(),suspendLoad||this.getStore().load()},_getColumnConfigFromColumn:function(column){var config={xtype:column.xtype,dataIndex:column.dataIndex,text:column.text,sortable:column.sortable,width:Ext.isFunction(column.getWidth)?column.getWidth():column.width};return this._setColumnFlex(config),config},_setColumnFlex:function(column){column.width?(column.flex=column.width,delete column.width):_.isNumber(column.flex)||(column.flex=Rally.ui.grid.FieldColumnFactory.defaultFlexValue)},_mergeColumnConfigs:function(newColumns,oldColumns){return _.map(newColumns,function(newColumn){var oldColumn=_.find(oldColumns,{dataIndex:this._getColumnName(newColumn)});return oldColumn?this._getColumnConfigFromColumn(oldColumn):newColumn},this)},_getExpandColumnCfg:function(){var xtype=this.expandAllInColumnHeaderEnabled?"rallyformattedidtreecolumn":"treecolumn";return{xtype:xtype,text:this.treeColumnHeader,dataIndex:this.treeColumnDataIndex,draggable:!1,resizable:this.treeColumnResizable,renderer:this.treeColumnRenderer,scope:this,menuDisabled:this.disableColumnMenus,listeners:{beforerender:function(column){column.initialConfig.renderer||(column.origRenderer=Rally.ui.grid.CellRendererFactory.createRendererFunction(column))}}}},_buildColumns:function(isReconfiguring){var rankColumnDataIndex,model=this.getStore().model,disabledEditorColumns=["DisplayColor"].concat(this.enableBlockedReasonPopover?["Blocked"]:[]).concat(Rally.ui.grid.FieldColumnFactory.getBlacklistedEditorsForType(model.typePath)),columnCfgs=_.map(Ext.clone(this._getColumnCfgs()),this._transformUuidsToNames,this),explicitlyConfiguredRankColumn=_.find(columnCfgs,function(column){return this._getColumnName(column).toLowerCase()===this.rankColumnDataIndex.toLowerCase()},this);rankColumnDataIndex=this.rankColumnDataIndex===Rally.data.Ranker.RANK_FIELDS.MANUAL?!!explicitlyConfiguredRankColumn&&this.rankColumnDataIndex:!(!this.enableRanking||this.allColumnsStateful&&!explicitlyConfiguredRankColumn)&&this.rankColumnDataIndex,model.isTask()&&this.enableRanking&&(rankColumnDataIndex="TaskIndex"),rankColumnDataIndex?columnCfgs=_.filter(columnCfgs,function(column){return column!==explicitlyConfiguredRankColumn}):this.rowActionColumnConfig=_.merge({menuOptions:{showRankMenuItems:!1}},this.rowActionColumnConfig);var rowActionOptions=this.shouldShowRowActionsColumn&&this.rowActionColumnConfig?this.rowActionColumnConfig:this.shouldShowRowActionsColumn;if(this.store.enableHierarchy){var treeColumn=_.find(columnCfgs,function(column){return this._getColumnName(column).toLowerCase()===this.treeColumnDataIndex.toLowerCase()},this);this.allColumnsStateful&&!treeColumn||(columnCfgs=[this._getExpandColumnCfg()].concat(_.filter(columnCfgs,function(column){return column!==treeColumn})))}this.columns=Ext.create("Rally.ui.grid.ColumnBuilder").withAllColumnsStateful(this.allColumnsStateful).withDefaultColumns(columnCfgs).withContext(this.getContext()).withSortableColumns(this.sortableColumns).shouldAutoAddAllModelFieldsAsColumns(this.autoAddAllModelFieldsAsColumns).withDisableColumnMenus(this.disableColumnMenus).withEditorsDisabledForColumns(disabledEditorColumns).withEditingEnabled(this.enableEditing).withRankingEnabled(this.enableRanking).withTreeEnabled(!0).withSummaryColumns(this._getSummaryColumnConfig()).withRankColumn(rankColumnDataIndex).shouldShowRowActionsColumn(rowActionOptions).shouldResetFlexValuesToDefaults(isReconfiguring).buildCmps(model)},getAllFetchFields:function(){return this.getStore().fetch},_buildFetch:function(){var fetchConfig=this.getStore().fetch||[];if(fetchConfig===!0)return fetchConfig;var fetchFields=Ext.create("Rally.ui.grid.data.ColumnFetchBuilder").build({grid:this,columns:this.columns,fetch:fetchConfig,modelNames:_.pluck(this.store.models||[this.store.model],"typePath")});return _.union(fetchFields,[this.treeColumnDataIndex])},highlightRowForRecord:function(records){var store=this.getStore(),recordIds=_.uniq(_.map(Ext.Array.from(records),function(record){return record.getId()}));_.each(recordIds,function(recordId){var relatedRecords=store.findAllRecordsWithId(recordId);_.each(relatedRecords,function(relatedRecord){var row=this.getView().getNode(relatedRecord);row&&Rally.util.Animation.highlight(Ext.fly(row).select("td"))},this)},this)},getItemSelector:function(){return this.view.getItemSelector()},getRecord:function(x){return this.view.getRecord(x)},getModels:function(){return[this.store.model]},_getModelField:function(identifier){return this.getModels()[0].getField(identifier)},_setupPlugins:function(config){var plugins=config.plugins||[];return plugins.push({ptype:"rallytreegridobjectupdatelistener"}),plugins.push({ptype:"rallycolorpickerplugin"}),this.enableEditing&&(plugins.push(Ext.apply({ptype:"rallycellediting",messageBus:this._getMessageBus()},this.editingConfig)),this.enableValidationUi&&(plugins.push({ptype:"rallygridvalidation"}),plugins.push({ptype:"rallycellvalidationui"}))),this.enableBlockedReasonPopover&&plugins.push({ptype:"rallyblockedreasonpopoverplugin"}),this.treeColumnResizable||plugins.push({ptype:"rallycolumnautosizerplugin"}),this.bufferedRenderer&&plugins.push({ptype:"rallybufferedrenderer",trailingBufferZone:10,leadingBufferZone:10,variableRowHeight:this.variableRowHeight}),this.store&&this.store.enableHierarchy&&plugins.push({ptype:"rallytreegridchildpager"}),plugins.push({ptype:"rallyclickhandlerplugin"}),this.enableInlineAdd&&plugins.push(Ext.apply({ptype:"rallyinlineaddrowexpander"},this.inlineAddConfig)),Rally.realtime.Realtime.enabled&&plugins.push({ptype:"rallyrealtime"}),plugins.push("rallyboardformattedidhoverable"),_.uniq(plugins,"ptype")},_setupFeatures:function(){return(this.features||[]).concat(this.enableSummaryRow?[{ftype:"summaryrow",id:"summaryrow",showSummaryRow:this._shouldShowSummary()}]:[])},_shouldShowSummary:function(){return this.getSummaryColumns().length>0},_resetCurrentPage:function(){if(this.stateful){var state=Ext.state.Manager.get(this.getStateId());state&&Ext.isObject(state.pagingToolbar)&&(state.pagingToolbar.currentPage=1,Ext.state.Manager.set(this.getStateId(),state))}},_onStoreLoad:function(){this._showNoData(),this._toggleHierarchy()},_onDataChanged:function(){this._showNoData()},_onExcludeByFilter:function(excludedRecord){var store=this.store,models=_.compact(_.flatten([store.model,store.models,_.isFunction(store.model.getArtifactComponentModels)&&store.model.getArtifactComponentModels()])),modelTypes=_.pluck(models,"typePath"),shouldShowWarning=_.contains(modelTypes,excludedRecord.self.typePath);shouldShowWarning&&_.isFunction(this.showNewItemExcludedByFiltersWarning)&&this.showNewItemExcludedByFiltersWarning(excludedRecord)},_onMoveToPage:function(record,pageNumber){if(_.isFunction(this.showItemMovedToPageNotification)){var me=this;this.showItemMovedToPageNotification(record,pageNumber,function(){me.getStore().loadPage(pageNumber)})}},_onRowFocus:function(record){record!==this.lastFocusedRecord&&(this.lastFocusedRecord=record,this.publish(Rally.Message.objectFocus,record,this))},_showNoData:function(){this.store.getRootNode().hasChildNodes()||this.getView().showNoData({itemName:this.noDataItemName,noDataHelpLink:this.noDataHelpLink,primaryText:this.noDataPrimaryText,secondaryText:this.noDataSecondaryText})},_toggleHierarchy:function(){this.getStore().isHierarchyEnabled()?(this.addCls("enable-hierarchy"),this.removeCls("disable-hierarchy")):(this.removeCls("enable-hierarchy"),this.addCls("disable-hierarchy"))},_buildDockedItems:function(){this.dockedItems=this.dockedItems||[],this.dockedItems.push(Ext.apply({itemId:"pagingToolbar",xtype:"rallytreepagingtoolbar",dock:"bottom",store:this.store},this.pagingToolbarCfg))},getSummaryColumns:function(){return _.filter(this.columns,function(column){return column.summaryType})},_getSummaryColumnConfig:function(){if(this.enableSummaryRow){var context=this.context||Rally.environment.getContext(),taskUnitName=context.getWorkspace().WorkspaceConfiguration.TaskUnitName,planEstimateUnitName=context.getWorkspace().WorkspaceConfiguration.IterationEstimateUnitName,parentTypes=_.map(this.store.parentTypes,function(type){return type.toLowerCase()}),parentModels=_.filter(this.store.models||Ext.Array.from(this.store.model),function(model){return _.contains(parentTypes,model.typePath.toLowerCase())});return _.filter([{field:"PlanEstimate",type:"sum",units:planEstimateUnitName},{field:"TaskEstimateTotal",type:"sum",units:taskUnitName},{field:"TaskRemainingTotal",type:"sum",units:taskUnitName},{field:"TaskActualTotal",type:"sum",units:taskUnitName},{field:"LeafStoryPlanEstimateTotal",type:"sum",units:planEstimateUnitName}],function(columnConfig){return _.any(parentModels,function(model){return model.hasField(columnConfig.field)})})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.GridBoard",{extend:Ext.Container,mixins:[Rally.app.Scopeable],alias:"widget.rallygridboard",cls:"rui-gridboard",cardBoardConfig:{},gridConfig:{},storeConfig:{},modelNames:[],stateId:"gridboard",stateful:!0,toggleState:"grid",layout:{type:"auto"},items:[{itemId:"header",xtype:"rallyleftright",padding:"4 10",overflowX:"hidden"}],sharedViewAdditionalCmps:[],useFilterCollection:!0,initComponent:function(){this.plugins=this.plugins||[],this.stateId=this.getAppContextOrEnvironmentContext().getScopedStateId(this.stateId),this.callParent(arguments),this.addEvents(["toggle","load","recordcreate","recordupdate","preferencesaved","modeltypeschange","filtertypeschange","workspacechange"]),this.on("modeltypeschange",function(gridboard,types){this.modelNames=types},this)},afterRender:function(){this.callParent(arguments),this._addGridOrBoard(this.getToggleState())},applyState:function(state){this.toggleState=state.toggleState||"grid"},getState:function(){return{toggleState:this.getToggleState()}},destroy:function(){var grid=null;"grid"===this.getToggleState()&&(grid=this.getGridOrBoard(),grid&&grid.store&&_.isFunction(grid.store.clearData)&&grid.store.clearData()),this.callParent(arguments)},setToggleState:function(toggleState,suppressAddCmp){this.toggleState!==toggleState&&(this.toggleState=toggleState,this.saveState(),this.fireEvent("viewstatesave",this),this.down("#gridOrBoard")&&this.remove("gridOrBoard",!0),suppressAddCmp?this.fireEvent("toggle",toggleState,null,this):this._addGridOrBoard(toggleState))},getToggleState:function(){return this.toggleState},getHeader:function(){return this.down("#header")},getInlineFilterPanel:function(){return this.down("#inlineFilterPanel")},getGridOrBoard:function(){return this.down("#gridOrBoard")},getModelNames:function(){return this.modelNames},getModels:function(){return this.getGridOrBoard().getModels()},applyCustomFilter:function(filterObj){var gridOrBoard=this.getGridOrBoard();this.currentCustomFilter=filterObj,gridOrBoard&&("board"===this.getToggleState()?this._applyBoardFilters(gridOrBoard,filterObj):"grid"===this.getToggleState()?this._applyGridFilters(gridOrBoard,filterObj):"chart"===this.getToggleState()&&this._applyChartFilters(gridOrBoard,filterObj))},setFilter:function(filter,clearFilterKeys){var gridOrBoard=this.getGridOrBoard();gridOrBoard&&_.isFunction(gridOrBoard.filter)&&gridOrBoard.filter(filter,clearFilterKeys)},getFilter:function(){return this.currentFilter},setHeight:function(){this.callParent(arguments);var gridOrBoard=this.getGridOrBoard();gridOrBoard&&gridOrBoard.rendered&&gridOrBoard.getHeight()!==this.getAvailableGridBoardHeight()&&this.getGridOrBoard().setHeight(this.getAvailableGridBoardHeight())},_getSharedViewProperties:function(items){return _.compact(_.map(items,function(p){if(_.isFunction(p.getCurrentView))return p.getCurrentView()}))},getCurrentView:function(){var view=this.getState(),gridOrBoard=this.getGridOrBoard();return _.isFunction(gridOrBoard.getCurrentView)&&Ext.apply(view,gridOrBoard.getCurrentView()),_.each(this._getSharedViewProperties(this.plugins.concat(this.sharedViewAdditionalCmps)),function(v){Ext.apply(view,v)}),view},_setSharedViewProperties:function(items,view){_.each(items||[],function(p){_.isFunction(p.setCurrentView)&&p.setCurrentView(view)},this)},setCurrentView:function(view){this._setSharedViewProperties(this.plugins,view),"grid"===view.toggleState?Ext.state.Manager.set(this._getGridConfig().stateId,_.pick(view,["columns","sorters"])):"board"===view.toggleState&&Ext.state.Manager.set(this._getBoardConfig().fieldsStateId,view.fields),Ext.state.Manager.set(this.stateId,_.pick(view,["toggleState"])),this.fireEvent("viewchange",this)},_addGridOrBoard:function(toggleState){var gridOrBoardOrChart=null;if("board"===toggleState)gridOrBoardOrChart=this._addBoard();else if("grid"===toggleState)gridOrBoardOrChart=this._addGrid();else{if("chart"!==toggleState)throw new Error("Invalid toggleState: "+toggleState);gridOrBoardOrChart=this._addChart()}this.fireEvent("toggle",toggleState,gridOrBoardOrChart,this)},_addBoard:function(){var board=this.add(this._getBoardConfig());return this.mon(board,"load",this._onGridOrBoardLoad,this),this.mon(board,"cardupdated",this._onCardUpdated,this),this.mon(board,"cardcopied",this._onCardCopied,this),board},_addChart:function(){return this.add(this._getChartConfig())},_getChartConfig:function(){var chartConfig=_.merge({itemId:"gridOrBoard",context:this.getContext()},this.chartConfig);_.merge(chartConfig,{storeConfig:this.storeConfig});var filters=[].concat(chartConfig.storeConfig.filters||[]);return this.currentCustomFilter&&(filters=filters.concat(this.currentCustomFilter.filters||[])),chartConfig.storeConfig.filters=filters,this.currentCustomFilter&&this.currentCustomFilter.types&&(chartConfig.storeConfig.models=this.currentCustomFilter.types),chartConfig},getAvailableGridBoardHeight:function(){var excludeHeight=0;return _.each(_.compact([this.getHeader(),this.getInlineFilterPanel()]),function(cmp){excludeHeight+=cmp.getHeight()}),this.getHeight()-excludeHeight-10},_getBoardConfig:function(){var config=Ext.merge({itemId:"gridOrBoard",xtype:"rallycardboard",types:this.modelNames,stateful:!0,fieldsStateId:this.getContext().getScopedStateId("shownfields"),attribute:"ScheduleState",storeConfig:{useCompositeArtifacts:this.modelNames.length>1},context:this.getContext(),cls:"cardboard",cardConfig:{componentCls:"iterationtrackingboard-card",editable:!0,showColorIcon:!0},height:this.getAvailableGridBoardHeight()},this.cardBoardConfig);return this._setBoardConfigFilters(config),config},_setBoardConfigFilters:function(config){if(_.merge(config,{storeConfig:this.storeConfig}),this.useFilterCollection)config.filterCollection=this._getFilterCollection(config.storeConfig&&config.storeConfig.filters);else{var filters=[].concat(config.storeConfig.filters||[]);this.currentCustomFilter&&(filters=filters.concat(this.currentCustomFilter.filters||[])),config.storeConfig.filters=filters,this.currentCustomFilter&&this.currentCustomFilter.types&&(config.types=this.currentCustomFilter.types)}},_getGridConfig:function(){var context=this.getContext()||Rally.environment.getContext(),config=Ext.merge({itemId:"gridOrBoard",xtype:"rallytreegrid",context:context,enableRanking:context.getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled,defaultSortToRank:!0,enableBlockedReasonPopover:!0,stateId:this.stateId+"-grid",stateful:!0,height:this.getAvailableGridBoardHeight()},this.gridConfig);return context.getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled||config.rankColumnDataIndex===Rally.data.Ranker.RANK_FIELDS.TASK||(config.rankColumnDataIndex=Rally.data.Ranker.RANK_FIELDS.MANUAL),_.isEmpty(config.store)&&Ext.Error.raise("No grid store configured"),this.useFilterCollection&&(config.filterCollection=this._getFilterCollection(this._getConfiguredFilters())),config},_getConfiguredFilters:function(extraFilters){var isBoard="board"===this.getToggleState(),isChart="chart"===this.getToggleState(),isGrid="grid"===this.getToggleState(),filters=_.compact(Ext.Array.merge(this.storeConfig&&this.storeConfig.filters,isBoard&&this.cardBoardConfig.storeConfig&&this.cardBoardConfig.storeConfig.filters,isGrid&&this.gridConfig.storeConfig&&this.gridConfig.storeConfig.filters,isChart&&this.chartConfig.storeConfig&&this.chartConfig.storeConfig.filters,extraFilters));return filters},_addGrid:function(){var grid=this.add(this._getGridConfig());return this.mon(grid,"afterproxyload",this._onGridLoad,this),!this.useFilterCollection&&this.currentCustomFilter&&this._applyGridFilters(grid,this.currentCustomFilter),grid},_fireViewStateSave:function(){this.fireEvent("viewstatesave",this)},_applyGridFilters:function(grid,filterObj){_.isEmpty(filterObj.types)||_.isEqual(grid.store.parentTypes,filterObj.types)||(this.fireEvent("filtertypeschange",filterObj.types),grid.store.parentTypes=filterObj.types),grid.store.clearFilter(!0),grid.store.filter(this._getConfiguredFilters(filterObj.filters||[],filterObj.types||[]))},_applyBoardFilters:function(board,filterObj){board.refresh({types:filterObj.types,storeConfig:{filters:this._getConfiguredFilters(filterObj.filters||[],filterObj.types||[])}})},_applyChartFilters:function(chart,filterObj){chart.refresh({storeConfig:{models:filterObj.types,filters:this._getConfiguredFilters(filterObj.filters||[],filterObj.types||[])}})},_onGridLoad:function(){this._registerViewStateChangeEvents(),this._onGridOrBoardLoad()},_onGridOrBoardLoad:function(){this.fireEvent("load",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_registerViewStateChangeEvents:function(){if("grid"===this.getToggleState()){var grid=this.getGridOrBoard();if(grid.on("sortchange",this._fireViewStateSave,this),grid.on("columnmove",this._fireViewStateSave,this),_.isFunction(grid.getHeaderResizeTracker)){var tracker=grid.getHeaderResizeTracker();tracker&&tracker.on("dragend",this._fireViewStateSave,this)}}},_onCardCopied:function(cmp,record){this.fireEvent("recordcreate",record)},_onCardUpdated:function(card){this.fireEvent("recordupdate",card.getRecord())},_getFilterCollection:function(filters){var filterCollection=Ext.create("Rally.data.filter.FilterCollection");return filters&&filterCollection.addPermanentFilter(filters),filterCollection}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardActionsMenu",{alias:"plugin.rallygridboardactionsmenu",extend:Ext.AbstractPlugin,menuItems:[],buttonConfig:{},init:function(cmp){this.cmp=cmp,this._addButton()},_addButton:function(){this.cmp.getHeader().getRight().add(Ext.merge(this.buttonConfig,{xtype:"rallybutton",style:{float:"right"},cls:"secondary rly-small",frame:!1,itemId:"actions-menu-button",listeners:{click:this._onClick,scope:this}}))},_onClick:function(button){var menu=Ext.widget({xtype:"rallymenu",items:this.menuItems});menu.showBy(button.getEl()),button.toolTip&&button.toolTip.hide()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardControlShowable",{headerPosition:"right",showInGridMode:!0,showInBoardMode:!0,showInChartMode:"disable",getControlCmpConfig:function(){return!1},getControlInsertPosition:function(){return!1},getControlCmp:function(){return this.controlCmp},showControl:function(){return this.cmp.on("toggle",this._showOrHideControl,this),this._showOrHideControl()},_getControlCt:function(){var header=this.cmp.getHeader();return"right"===this.headerPosition?header.getRight():header.getLeft()},_showOrHideControl:function(){var showInStateProp="showIn"+Ext.String.capitalize(this.cmp.getToggleState()||"")+"Mode",show=this[showInStateProp];return this.controlCmp||this._createControlCmp(),this.controlCmp&&(show?("disable"===show||this.getControlCmpConfig().disabled?this.controlCmp.disable():this.controlCmp.enable(),this.controlCmp.show()):this.controlCmp.hide()),this.controlCmp},_createControlCmp:function(){var controlCmpConfig=this.getControlCmpConfig();if(controlCmpConfig){Ext.isFunction(controlCmpConfig.hide)||(controlCmpConfig.hidden=!0,controlCmpConfig.style=Ext.merge({float:this.headerPosition},controlCmpConfig.style));var insertPosition=this.getControlInsertPosition();Ext.isNumber(insertPosition)?this.controlCmp=this._getControlCt().insert(insertPosition,controlCmpConfig):this.controlCmp=this._getControlCt().add(controlCmpConfig)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardAddNew",{alias:"plugin.rallygridboardaddnew",extend:Ext.AbstractPlugin,mixins:[Rally.app.Scopeable,Rally.ui.gridboard.plugin.GridBoardControlShowable],addNewControlConfig:{},headerPosition:"left",ignoredRequiredFields:["Name","Project","ScheduleState","State"],init:function(cmp){this.cmp=cmp,this.cmp.addNewPlugin=this,this.customConfig=cmp.addNewPluginConfig||{},this.context=this.context||this.customConfig.context||this.cmp.getContext();var control=this.showControl();control&&control.on({beforecreate:this._onAddNewBeforeCreate,beforeeditorshow:this._onAddNewBeforeEditorShow,create:this._onAddNewCreate,scope:this})},getControlCmpConfig:function(){if(this._shouldShowAddNew())return this._getAddNewConfig()},_shouldShowAddNew:function(){var modelNames=_.map(this.cmp.modelNames,function(modelName){return modelName.toLowerCase()});return _.contains(modelNames,"user")?this._canCreateUsers():this.getProjectRef()?this.isProjectEditor():this.getPermissions().isWorkspaceOrSubscriptionAdmin(this.getWorkspaceRef())},_canCreateUsers:function(){var permissions=Rally.environment.getContext().getPermissions(),subscription=Rally.environment.getContext().getSubscription();return permissions.isSubscriptionAdmin()||subscription.WorkspaceAdminsCanCreateUsers&&permissions.isWorkspaceAdminInAnyWorkspace()||subscription.ProjectAdminsCanCreateUsers&&permissions.isProjectAdminInAnyWorkspace()},_getAddNewConfig:function(){return Ext.merge({xtype:"rallyaddnew",context:this.context,recordTypes:this.cmp.getModelNames(),ignoredRequiredFields:this.ignoredRequiredFields,rankTo:"BOTTOM"},this.customConfig,this.addNewControlConfig)},_getAddNewParams:function(){var rankScope=this.getRankScope(),params={rankTo:this._getAddNewConfig().rankTo};return rankScope&&(params.rankScope=rankScope),params},_onAddNewBeforeCreate:function(addNew,record,params){if(this._isTimeboxScoped()){var iterationRef=this.getIterationRef();iterationRef&&record.set("Iteration",iterationRef);var releaseRef=this.getReleaseRef();releaseRef&&record.set("Release",releaseRef),Ext.apply(params,this._getAddNewParams(record))}},_onAddNewBeforeEditorShow:function(addNew,params){if(params.Iteration="u",params.Release="u",this._isTimeboxScoped()){var iterationRef=this.getIterationRef();iterationRef&&(params.Iteration=iterationRef);var releaseRef=this.getReleaseRef();releaseRef&&(params.Release=releaseRef),Ext.apply(params,this._getAddNewParams())}},_isTimeboxScoped:function(){return!!this.getContext().getTimeboxScope},_isWorkspaceScoped:function(){return null===this.getContext().getProject()},_onAddNewCreate:function(addNew,record){this.cmp.fireEvent("recordcreate",record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.filter.controller.FilterPopoverController",{extend:Deft.mvc.ViewController,control:{filterDone:{click:"_onFilterDone"},filterContainer:{}},invalidFilterItems:null,init:function(){this.callParent(arguments),this.invalidFilterItems=[],_.each(this.getFilterContainer().getRefItems(),function(filterItem){filterItem.on("valid",this._onValid,this),filterItem.on("invalid",this._onInvalid,this)},this)},_onFilterDone:function(button,event){this.getView().fireEvent("filter",this.getView(),this._getFilters(),this._getClearFilterKeys()),this.getView().destroy()},_getFilterFields:function(){return this.getFilterContainer().getRefItems()},_getClearFilterKeys:function(){var filterKeys=[];return _.transform(Ext.Array.from(this._getFilterFields()),function(result,filterField){
filterField&&Ext.isFunction(filterField.getFilter)&&filterField.itemId&&filterKeys.push(filterField.itemId)},{},this),filterKeys},_getFilters:function(){var filters=_.transform(Ext.Array.from(this._getFilterFields()),function(result,filterField){if(filterField&&Ext.isFunction(filterField.getFilter)){var filter=filterField.getFilter(),filterId=filterField.itemId;filter&&((Ext.isEmpty(filterId)||result.hasOwnProperty(filterId))&&Ext.Error.raise("Filter field components must have a unique itemId."),filter.itemId=filterId,filter.isActiveFilter=!Ext.isDefined(filterField.isActiveFilter)||filterField.isActiveFilter,result[filterId]=filter)}},{},this);return _.values(filters)},_onValid:function(component){this.invalidFilterItems=_.pull(this.invalidFilterItems,component),0===this.invalidFilterItems.length&&this.getFilterDone().enable()},_onInvalid:function(component){this.invalidFilterItems.push(component),this.getFilterDone().disable()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.filter.view.FilterPopover",{extend:Rally.ui.popover.Popover,controller:"Rally.ui.popover.filter.controller.FilterPopoverController",alias:"widget.rallyfilterpopover",cls:"filter-popover",itemId:"rallyfilterpopover",chevronPrefixCls:"filter-popover-chevron icon-left",placement:"right",chevronPosition:["t-b","r-tl","b-t","l-tr"],targetPosition:["b-t","tl-r","t-b","tr-l"],offsetFromTarget:[{x:0,y:0},{x:12,y:-20},{x:0,y:0},{x:0,y:0}],chevronOffset:[{x:0,y:0},{x:14,y:20},{x:0,y:0},{x:0,y:0}],items:[{xtype:"rallyleftright",itemId:"header",title:"Filters"},{xtype:"container",layout:"vbox",itemId:"filterContainer",cls:"filter-container",items:[]}],filterItems:[],filter:{},header:!1,initComponent:function(){this.callParent(arguments),this.down("#header").getRight().add({xtype:"rallybutton",itemId:"filterDone",text:"Done",cls:"primary button rly-small rly-right"}),this.addEvents(["filter"]),this.down("#filterContainer").add(this._getItems())},_getItems:function(){var items=this._configureFilterItems();return _.transform(items,function(result,filterItem){var item=Ext.ComponentManager.create(filterItem);(item.filterLabel||item.filterHelpId)&&result.push(this._getLabelContainer(item)),result.push(item)},[],this)},_getLabelContainer:function(filterableComponent){var items=[];return filterableComponent.filterLabel&&items.push({xtype:"label",text:filterableComponent.filterLabel,cls:"filter-label"}),filterableComponent.filterHelpId&&items.push({xtype:"rallybutton",iconCls:"icon-help",cls:"tertiary controls button picto dark",_filterHelpId:filterableComponent.filterHelpId,listeners:{click:{fn:function(cmp,e){Rally.util.Help.launchHelp({id:filterableComponent.filterHelpId}),Ext.EventManager.stopEvent(e)}}}}),{xtype:"container",items:items,margin:"5 0 0 0"}},_configureFilterItems:function(){return _.map(this.filterItems,function(filterItem){return Ext.isObject(filterItem)||(filterItem={xtype:filterItem}),filterItem.storeFilter=this.filter,filterItem.width=290,filterItem.padding=0,filterItem.border=0,filterItem},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.controller.FilterButtonController",{extend:Deft.mvc.ViewController,control:{view:{click:"_onClick",beforedestroy:"_onBeforeDestroy"}},init:function(){var view=this.getView();view.fireEvent("filter",view,view.getFilter()),view.on("filter",this._onFilter,this),this._updateButtonColor()},updateState:function(state){this.applyState(state);var view=this.getView();view.stateful&&view.saveState()},applyState:function(state){var deserializedFilter={};state.filter&&(deserializedFilter=_.transform(state.filter,function(result,value,key){result[key]=this._deserializeFilter(value),result[key].itemId=key},{},this)),this.filter=deserializedFilter,this._updateButtonColor()},getState:function(){var serializedFilter=_.transform(this.filter,function(result,value,key){result[key]=this._serializeFilter(value)},{},this);return{filter:serializedFilter}},getFilter:function(){return _.values(this.filter)},_createPopover:function(){return Ext.create("Rally.ui.popover.filter.view.FilterPopover",{context:this.getView().context,target:this.getView().getEl(),filterItems:this.getView().items,filter:this.filter})},_serializeFilter:function(filter){return{itemId:filter.itemId,isActiveFilter:filter.isActiveFilter,queryString:filter.toString()}},_deserializeFilter:function(filter){if(_.isString(filter))return Rally.data.wsapi.Filter.fromQueryString(filter);var wsapiFilter=Rally.data.wsapi.Filter.fromQueryString(filter.queryString);return wsapiFilter.itemId=filter.itemId,wsapiFilter.isActiveFilter=filter.isActiveFilter,wsapiFilter},_hasActiveFilter:function(){return _.any(Ext.Array.from(this.getFilter()),function(filter){return filter.isActiveFilter})},_onClick:function(){this.popover=this._createPopover(),this.getView().relayEvents(this.popover,["filter"])},_onFilter:function(cmp,filter){this.filter=_.transform(Ext.Array.from(filter),function(result,filter){result[filter.itemId]=filter},{}),this._updateButtonColor();var view=this.getView();view.stateful&&view.saveState()},_updateButtonColor:function(){var view=this.getView();view&&(this._hasActiveFilter()?view.indicateActiveFilterPresent():view.indicateNoActiveFilterPresent())},_onBeforeDestroy:function(){this.popover&&(this.popover.destroy(),this.popover=null)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.FilterButton",{extend:Rally.ui.Button,controller:"Rally.ui.filter.controller.FilterButtonController",alias:"widget.rallyfilterbutton",iconCls:"icon-filter",itemId:"filterButton",cls:"secondary button picto",clientMetrics:[{event:"click",description:"filter popover opened"}],stateEvents:[],initComponent:function(){this.addEvents(["filter"]),this.callParent(arguments)},getFilter:function(){return this.getController().getFilter()},updateState:function(state){this.getController().updateState(state)},applyState:function(state){this.getController().applyState(state)},getState:function(){return this.getController().getState()},indicateActiveFilterPresent:function(){this.hasCls("primary")||(this.addCls("primary"),this.removeCls("secondary"))},indicateNoActiveFilterPresent:function(){this.hasCls("secondary")||(this.addCls("secondary"),this.removeCls("primary"))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.TagComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallytagcombobox",config:{cls:"rally-tag-combobox",allowNoEntry:!0,noEntryText:"-- No Tag --",fieldLabel:"Filter by Tag",labelSeparator:":",labelWidth:65,labelCls:"tag-filter-label",triggerAction:"query",queryMode:"remote",filterInitialValue:!0,storeConfig:{fetch:["Name","ObjectID"],remoteFilter:!0,model:Ext.identityFn("Tag"),sorters:[{property:"Name"}]},listConfig:{cls:"rally-tag-combobox-boundlist"}},constructor:function(config){if(config=config||{},this.mergeConfig(config),this.config.value&&this.config.filterInitialValue){var initialFilter=Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",operator:"=",value:Rally.util.Ref.getRefObject(this.config.value).getOid()});this.config.storeConfig.filters=[initialFilter]}this.callParent([this.config])},initComponent:function(){var autoLoadStore=this.storeConfig&&this.storeConfig.autoLoad;this.callParent(arguments),autoLoadStore||this.onReady()},doQuery:function(queryString,forceAll,rawQuery){if(""===queryString)return this.callParent(["",!0,rawQuery]);var filter=Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"Contains",value:queryString});this.store.filters=this.store.filters.filterBy(function(item){return"Name"!==item.property}),this.store.filters.add(filter),this.callParent([filter.toString(),!0,rawQuery])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.MilestoneComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallymilestonecombobox",mixins:[Rally.ui.MilestoneListHeadings,Rally.app.Scopeable],config:{allowNoEntry:!1,hideLabel:!0,storeConfig:{autoLoad:!0,model:Ext.identityFn("milestone"),remoteFilter:!0,remoteSort:!1},listConfig:{minWidth:385,cls:"milestone-list",emptyText:"No Milestones Defined",itemTpl:Ext.create("Ext.XTemplate",'<div class="milestone-name">{_refObjectName}</div>','<div class="milestone-date">{[Rally.util.DateTime.formatWithDefault(values.TargetDate)]}</div>','<div class="milestone-raw-date">{TargetDate}</div>')},componentCls:"rui-triggerfield rally-milestone-combobox"},constructor:function(config){config=config||{},this.mergeConfig(config),this.config.storeConfig.filters=_.compact(_.union([this._getProjectFilter()],[this._getValueFilter()],this.config.storeConfig.filters)),this.callParent([this.config])},initComponent:function(){this.storeConfig.sorters=[{sorterFn:Rally.data.util.Sorter.getDefaultSortFn("Milestone")}];var autoLoadStore=this.storeConfig&&this.storeConfig.autoLoad;this.callParent(arguments),autoLoadStore||this.onReady()},createPicker:function(){var picker=this.callParent(arguments);return picker.on({itemadd:function(added,index,nodes,options){this._addListHeaders(picker,options)},show:this._addListHeaders,refresh:this._addListHeaders,scope:this,filterSelectedNodes:!1}),picker},beforeQuery:function(queryPlan){var queryString=queryPlan.query,filter=Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"contains",value:queryString});return this.store.filters=this.store.filters.filterBy(function(item){return"Name"!==item.property&&"ObjectID"!==item.property}),queryString?queryPlan.query=Rally.data.wsapi.Filter.and(this.store.filters.getRange()).and(filter).toString():queryPlan.query=Rally.data.wsapi.Filter.and(this.store.filters.getRange()).toString(),queryPlan.forceAll=!0,this.callParent(arguments)},_getValueFilter:function(){return this.value?Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",value:Rally.util.Ref.getOidFromRef(this.value)}):null},_getProjectFilter:function(){return Rally.data.wsapi.Filter.or([{property:"Projects",operator:"contains",value:Rally.util.Ref.getRelativeUri(this.getProjectRef())},{property:"TargetProject",operator:"=",value:null}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.plugin.CustomFilterRowController",{extend:Ext.AbstractPlugin,alias:"plugin.rallycustomfilterrowcontroller",init:function(view){this.view=view,this.context=view.getContext(),this.initialData=view.initialData||{},this.view.on("afterfieldcomboboxrender",this._onFieldComboboxRendered,this),this.view.on("afterfieldcomboboxselect",this._onFieldComboboxSelected,this)},_clearInitialData:function(){this.initialData={}},_onFieldComboboxRendered:function(row,combobox){Ext.isDefined(this.filterableFields)?this._insertFieldComboboxData(combobox,this.filterableFields):this._getModels(this.view.models).then({success:function(models){this.filterableFields=this._getValidFields(models),this._insertFieldComboboxData(combobox,this.filterableFields)},scope:this})},_insertFieldComboboxData:function(combobox,fields){combobox.store.loadData(fields),this.initialData.field&&combobox.setValue(this.initialData.field)},_onFieldComboboxSelected:function(row,combobox,fieldSelected){this._updateValidOperators(row,fieldSelected),this.view.removeValueField();var editorConfig=this._prepareEditorConfig(this.model,fieldSelected);this.view.addValueField(editorConfig)},_getBaseEditorConfig:function(fieldDef){var editorConfig;return"text"===fieldDef.getType()?editorConfig={xtype:"rallytextfield"}:"Tags"===fieldDef.name?editorConfig={xtype:"rallytagcombobox",allowNoEntry:!1,hideLabel:!0}:"Milestones"===fieldDef.name?editorConfig={xtype:"rallymilestonecombobox"}:!fieldDef.editor&&fieldDef.attributeDefinition.AllowedValueType._ref?(editorConfig={xtype:"rallyartifactsearchcombobox",storeConfig:{models:[fieldDef.attributeDefinition.AllowedValueType._refObjectName],context:{workspace:this.context.getDataContext().workspace,project:null}}},"Requirement"===fieldDef.name&&(editorConfig.storeConfig.models=["userstory"])):(editorConfig=_.clone(fieldDef.editor),editorConfig&&editorConfig.field&&editorConfig.field.xtype&&(editorConfig=editorConfig.field),"rallyusersearchcombobox"===editorConfig.xtype&&(editorConfig.includeWorkspaceUsers=!0)),editorConfig},_prepareEditorConfig:function(model,field){var fieldDef=model.getField(field),baseEditorConfig=this._getBaseEditorConfig(fieldDef),initialValue=this.initialData.value;return baseEditorConfig.allowBlank=!1,"object"===fieldDef.getType()&&(baseEditorConfig.allowBlank=!0),fieldDef.custom&&(baseEditorConfig.allowBlank=!fieldDef.required),"date"===fieldDef.getType()&&initialValue&&(initialValue=Rally.util.DateTime.fromIsoString(initialValue)),Ext.merge(baseEditorConfig,{autoExpand:!1,context:this.context,itemId:"valueField",height:22,width:150,defaultSelectionPosition:null,value:initialValue,storeConfig:{autoLoad:!0}})},_getModels:function(models){var modelsToLoad=[];return _.isArray(models)&&_.any(models,_.isString)?modelsToLoad=this._getModelNames(models):_.isString(models)&&(modelsToLoad=models),modelsToLoad.length>0?this._loadModels(modelsToLoad):Deft.Promise.when(models)},_loadModels:function(modelsToLoad){return Rally.data.ModelFactory.getModels({context:this.view.context||Rally.environment.getContext(),types:modelsToLoad}).then({success:function(models){return _.values(models)}})},_getModelNames:function(models){return _.map(models,function(model){return _.isString(model)?model:model.typeName})},_getValidFields:function(models){this.model=this._getArtifactModel(models);var fields=_(this.model.getFields()).filter(this._shouldShowField,this).sortBy("displayName").value(),fieldCounts=_.countBy(fields,"displayName");return _.map(fields,function(field){var modelNames="";return fieldCounts[field.displayName]>1&&(modelNames=_.pluck(this.model.getModelsForField(field),"displayName").join(", ")),{attributeDefinition:field.attributeDefinition,displayName:Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(field),modelNames:modelNames,name:field.name}},this)},_getArtifactModel:function(models){var context=this.view.context||Rally.environment.getContext();return Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(models,context)},_shouldShowField:function(field){return _.contains(this.view.whiteListFields,field.name)||!field.hidden&&field.attributeDefinition&&field.attributeDefinition.Filterable&&"collection"!==field.getType()&&!_.contains(this.view.blackListFields,field.name)},_updateValidOperators:function(row,value){var field=this.model.getField(value);field.getAllowedQueryOperatorStore().load({requester:this,callback:function(records,operation,success){if(records.length>0&&success){var operatorData=this._buildDataForOperator(records,field),combobox=row.getOperatorCombobox();combobox.store.loadData(operatorData),combobox.setValue(this.initialData.operator?this.initialData.operator.toLowerCase():combobox.store.getAt(0)),this._clearInitialData(),row.fireEvent("rowstatechange",row)}},scope:this})},_buildDataForOperator:function(records,field){var operatorNames=_.map(records,function(record){return record.get("OperatorName")}),validOperatorNames=_.filter(operatorNames,function(operatorName){return"containsall"!==operatorName&&"containsany"!==operatorName});return _.map(validOperatorNames,function(operatorName){return{name:operatorName,displayName:field.isCollection()?operatorName.replace("contains","="):operatorName}}).concat(this.view.additionalOperators||[])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.CustomFilterRow",{extend:Ext.Container,alias:"widget.rallycustomfilterrow",layout:{type:"hbox",defaultMargins:{top:0,right:5,bottom:0,left:0}},bubbleEvents:["rowstatechange","afterfieldcomboboxselect"],controllerPlugin:"rallycustomfilterrowcontroller",config:{models:[],context:void 0,blackListFields:[],whiteListFields:[],initialData:{},boxWidths:{field:150,operator:75,value:150},additionalOperators:[]},initComponent:function(){this.items=this._getItems(),this.plugins=this._getPlugins(),this.callParent(arguments),this._hasInitialData()&&this._setInitialValues()},getFilter:function(){return Ext.create("Rally.data.wsapi.Filter",{property:this.getFieldCombobox().getValue(),operator:this.getOperatorCombobox().getValue(),value:this.getValueField().getValue()})},getFieldCombobox:function(){return this.down("#fieldCombobox")},getOperatorCombobox:function(){return this.down("#operatorCombobox")},getValueField:function(){return this.down("#valueField")},addValueField:function(config){return config=Ext.apply(config,{invalidCls:"rally-invalid",disabled:!0,msgTarget:"none",validateOnChange:!0,width:this.boxWidths.value,listeners:{destroy:this._onValueFieldDestroy,setvalue:this._onValueFieldSetValue,validitychange:this._onValueFieldValidityChange,scope:this}}),this.add(config)},removeValueField:function(){var valueField=this.getValueField();valueField&&valueField.destroy()},_hasInitialData:function(){return!_.isUndefined(this.initialData.field)&&!_.isUndefined(this.initialData.operator)},_setInitialValues:function(){this.getFieldCombobox().on("setvalue",this._onSetInitialFieldValue,this,{single:!0})},isValid:function(){return this.hasFieldSelected()&&this.hasOperatorSelected()&&this.valueFieldIsValid()},hasFieldSelected:function(){return!!this.getFieldCombobox().getValue()},hasOperatorSelected:function(){return!!this.getOperatorCombobox().getValue()},valueFieldIsValid:function(){var valueField=this.getValueField();return valueField&&!valueField.hasActiveError()},_getPlugins:function(){var plugins=Ext.Array.from(this.plugins);return this.controllerPlugin&&(plugins=plugins.concat(Ext.Array.from(this.controllerPlugin))),plugins},_getItems:function(){var items=[{xtype:"rallycombobox",itemId:"fieldCombobox",disabled:!0,autoLoad:!1,defaultSelectionPosition:null,store:Ext.create("Ext.data.Store",{fields:["attributeDefinition","displayName","modelNames","name"]}),displayField:"displayName",emptyText:"Choose Field...",valueField:"name",matchFieldWidth:!0,listeners:{select:this._onFieldSelect,afterrender:this._onFieldAfterRender,expand:this._onFieldExpand,scope:this},width:this.boxWidths.field,listConfig:{itemTpl:new Ext.XTemplate("{displayName}",'<tpl if="this.hasModelNames(values)">','<div class="duplicate-field-model-name">- {modelNames}</div>',"</tpl>",{hasModelNames:function(data){return data.modelNames.length>0}})}},{xtype:"rallycombobox",itemId:"operatorCombobox",disabled:!0,autoLoad:!1,editable:!1,forceSelection:!0,store:Ext.create("Ext.data.Store",{fields:["name","displayName"],listeners:{datachanged:this._onOperatorDataChanged,scope:this}}),displayField:"displayName",valueField:"name",matchFieldWidth:!0,listeners:{setvalue:this._onOperatorSetValue,scope:this},width:this.boxWidths.operator}];return this._hasInitialData()||items.push({xtype:"rallytextfield",itemId:"valueField",disabled:!0,height:22,width:this.boxWidths.value}),items},_onFieldExpand:function(field){field.focus()},_onFieldAfterRender:function(fieldcombobox){this.fireEvent("afterfieldcomboboxrender",this,fieldcombobox)},_onOperatorDataChanged:function(){var combobox=this.getOperatorCombobox();combobox&&(combobox.reset(),combobox.setDisabled(!1))},_onSetInitialFieldValue:function(combo){this._onFieldSelect(combo),this.getFieldCombobox().setDisabled(!1)},_onFieldSelect:function(combo){this.fireEvent("afterfieldcomboboxselect",this,combo,combo.getValue()),this.fireEvent("rowstatechange",this)},_onOperatorSetValue:function(){var valueField=this.getValueField();valueField&&(valueField.setDisabled(!1),this._hasInitialData()||valueField.focus()),this.fireEvent("rowstatechange",this)},_onValueFieldSetValue:function(){this.fireEvent("rowstatechange",this)},_onValueFieldValidityChange:function(field,isValid){isValid?this.fireEvent("rowstatechange",this):this.tooltip?this.tooltip.update(field.activeError):this.tooltip=Ext.create("Rally.ui.tooltip.ToolTip",{target:field.getEl(),anchor:"top",mouseOffset:[5,0],html:field.activeError,listeners:{beforeshow:function(){return field.hasActiveError()}}})},_onValueFieldDestroy:function(){this.tooltip&&(this.tooltip.destroy(),delete this.tooltip)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.CustomFilterPanel",{extend:Ext.form.Panel,alias:"widget.rallycustomfilterpanel",cls:"custom-filter-panel",layout:{type:"vbox"},config:{models:[],context:void 0,blackListFields:[],whiteListFields:[],filters:[],boxWidths:{field:void 0,operator:void 0,value:void 0},additionalOperators:[]},initComponent:function(){this.items=this._getItems(),this.buttons=this._getButtonConfig(),this.callParent(arguments),this.customFilterRows=this.down("#customFilterRows"),this._createFilterRows(),this.on("rowstatechange",this._updatePanelState,this)},getFilters:function(){return _.invoke(this.getValidRows(),"getFilter")},getValidRows:function(){return _.filter(this._getCustomFilterRows(),function(row){return row.isValid()})},_createFilterRows:function(){this.customFilterRows.removeAll(),Ext.batchLayouts(function(){_.each(this.filters,function(filter){this._addNewRow({initialData:{field:filter.property,operator:filter.operator,value:filter.value}})},this),this._padRows()},this)},_getItems:function(){return[{xtype:"container",cls:"custom-filter-header",layout:"column",defaults:{xtype:"component",cls:"filter-panel-label"},items:[{height:1,width:30},{html:"Field",width:this.boxWidths.field+5||155},{html:"Operator",width:this.boxWidths.operator+5||80},{html:"Value",width:this.boxWidths.value+5||155}]},{xtype:"container",itemId:"customFilterRows"}]},_getButtonConfig:function(){return[{xtype:"rallybutton",cls:"secondary rly-small hide-clear-all-for-notifications",itemId:"clearAllFilterRows",text:"Clear all",disabled:!this._hasFilters(),handler:this._onClearAllClick,scope:this},{xtype:"rallybutton",cls:"secondary rly-small add-new-as-plus icon",itemId:"addNewFilterRow",text:"Add new",disabled:!0,handler:this._onAddNewClick,scope:this}]},_addNewRows:function(n){Ext.batchLayouts(function(){_.times(n,function(){this._addNewRow()},this)},this)},_addNewRow:function(rowConfig){this.customFilterRows.add({xtype:"container",layout:"column",items:[{xtype:"rallybutton",iconCls:"icon-minus",cls:"remove-filter-icon",disabled:!0,scale:"large",handler:this._onRowDeleteClick,scope:this},_.extend({xtype:"rallycustomfilterrow",blackListFields:this.blackListFields,whiteListFields:this.whiteListFields,additionalOperators:this.additionalOperators,context:this.context,models:this.models,boxWidths:this.boxWidths},rowConfig)],listeners:{rowstatechange:function(row){this.down("rallybutton").setDisabled(!row.hasFieldSelected())},afterfieldcomboboxselect:{fn:function(){this.validate()},scope:this}}})},validate:function(){this.isValid()},_padRows:function(){var rowsToAdd=3-this.customFilterRows.items.length;rowsToAdd>0&&this._addNewRows(rowsToAdd),this._enableFirstField()},_enableFirstField:function(){var rows=this._getCustomFilterRows();_.each(rows,function(row,index){if(0===index)row.getFieldCombobox().setDisabled(!1);else if(rows[index-1].isValid()&&row.getFieldCombobox().isDisabled())return row.getFieldCombobox().setDisabled(!1),!1})},_onRowDeleteClick:function(cmp){cmp.up("container").destroy(),this._padRows(),this._updateButtonState(),this.focusFirstEmptyField()},focusFirstEmptyField:function(){var field=this.down("#fieldCombobox{getValue()==null}");field&&(field.setDisabled(!1),field.focus())},_onClearAllClick:function(){this.customFilterRows.removeAll(),this._padRows(),this._updateButtonState(),this.focusFirstEmptyField()},_onAddNewClick:function(){this._addNewRow(),this._updateButtonState(),this.focusFirstEmptyField()},_updatePanelState:function(row){this._updateButtonState(),this._updateNextRowState(row)},_updateButtonState:function(){var rows=this._getCustomFilterRows();this._getAddNewButton().setDisabled(!this._allRowsValid(rows)),this._getClearAllButton().setDisabled(!this._hasFilters(rows))},_updateNextRowState:function(row){if(row.isValid()){var container=row.up("container").nextSibling();container&&(container.down("rallycustomfilterrow").getFieldCombobox().setDisabled(!1),container.down("rallybutton").setDisabled(!1))}},_hasFilters:function(rows){return this.filters.length||_(rows).invoke("hasFieldSelected").some()},_allRowsValid:function(rows){return _(rows).invoke("isValid").every()},_getCustomFilterRows:function(){return this.query("rallycustomfilterrow")},_getClearAllButton:function(){return this.down("#clearAllFilterRows")},_getAddNewButton:function(){return this.down("#addNewFilterRow")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.controller.ModelFilterController",{extend:Deft.mvc.ViewController,require:["Rally.data.wsapi.filter.TypeDefFilter","Rally.data.ModelFactory","Rally.ui.CheckboxField","Rally.util.Type"],control:{checkboxContainer:{}},init:function(){this._getModels(this.getView().models).then({success:this._addCheckboxElements,scope:this})},getFilter:function(){return Ext.create("Rally.data.wsapi.filter.TypeDefFilter",{value:this.getSelectedModels()})},_addCheckboxElements:function(models){this.models=_.isFunction(models)?[models]:models,this.getView().models=this.models;var checkboxConfigs=_.map(this.models,this._getModelCheckboxConfig,this);this.getCheckboxContainer().add(checkboxConfigs),this._setCheckboxValues()},_getModels:function(models){var modelsToLoad=[];return _.isArray(models)&&_.any(models,_.isString)?modelsToLoad=this._getModelNames(models):_.isString(models)&&(modelsToLoad=models),modelsToLoad.length>0?this._loadModels(modelsToLoad):Deft.Promise.when(models)},_loadModels:function(modelsToLoad){return Rally.data.ModelFactory.getModels({context:this.context||Rally.environment.getContext(),types:modelsToLoad}).then({success:function(models){return _.values(models)}})},_getModelNames:function(models){return _.map(models,function(model){return _.isString(model)?model:model.typeName})},_getModelCheckboxConfig:function(model){return Ext.create("Rally.ui.CheckboxField",{boxLabel:Rally.util.Type.getModelDisplayName(model),checked:!0,inputValue:model.displayName,listeners:{change:{fn:this._onClick,scope:this}},model:model})},_getCheckboxElements:function(){return this.getCheckboxContainer().items.getRange()},_getSelectedArtifactTypeNames:function(){return _.invoke(_.filter(this._getCheckboxElements(),function(checkbox){return checkbox.getValue()}),"getSubmitValue")},getSelectedModels:function(){var selectedArtifactTypeNames=this._getSelectedArtifactTypeNames();return _.filter(this.getView().models,function(model){return _.find(selectedArtifactTypeNames,function(name){return _.isEqual(model.displayName,name)})})},_setCheckboxValues:function(){var view=this.getView();if(view.selectedTypes)_.each(this._getCheckboxElements(),function(checkbox){checkbox.setValue(_.any(view.selectedTypes,function(selectedType){return checkbox.model.typePath.toLowerCase()===selectedType.toLowerCase()}))},this);else{var filter=view.storeFilter||{},filteredModelOids=this._getModelOidsFromFilter(filter[view.itemId]);_.each(this._getCheckboxElements(),function(checkbox){checkbox.setValue(this._isModelFiltered(filteredModelOids,checkbox.model))},this)}},_isModelFiltered:function(filteredModelOids,model){return Ext.isEmpty(filteredModelOids)||_.contains(filteredModelOids,model.typeDefOid)},_getModelOidsFromFilter:function(filter){var filteredTypeDefOids=[];return filter&&(Ext.isObject(filter.property)&&(filteredTypeDefOids=filteredTypeDefOids.concat(this._getModelOidsFromFilter(filter.property))),Ext.isObject(filter.value)&&(filteredTypeDefOids=filteredTypeDefOids.concat(this._getModelOidsFromFilter(filter.value))),"TypeDefOid"===filter.property&&filter.value&&filteredTypeDefOids.push(filter.value)),_.uniq(filteredTypeDefOids)},_onClick:function(){this._noModelsAreSelected()?this.getView().fireEvent("invalid",this.getView()):this.getView().fireEvent("valid",this.getView())},_noModelsAreSelected:function(){return _.every(this._getCheckboxElements(),function(checkbox){return!checkbox.getValue()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.ModelFilter",{extend:Ext.Container,controller:"Rally.ui.filter.controller.ModelFilterController",alias:"widget.rallymodelfilter",models:[],context:void 0,filterLabel:"show",itemId:"modelFilter",isActiveFilter:!1,initComponent:function(){this.addEvents(["valid","invalid"]),this.items=this._getItems(),this.callParent(arguments)},_getItems:function(){var checkboxContainerConfig={xtype:"fieldcontainer",itemId:"checkboxContainer",cls:"checkbox-container"};return _.merge(checkboxContainerConfig,this.checkboxContainerConfig)},isValid:function(){return _.some(this.query("rallycheckboxfield"),{checked:!0})},getFilter:function(){return this.getController().getFilter()},getSelectedModels:function(){return this.getController().getSelectedModels()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.customfilter.CustomFilterPopover",{extend:Rally.ui.popover.Popover,alias:"widget.rallycustomfilterpopover",clientMetrics:[{event:"show",description:"popover opened"}],cls:"custom-filter-popover",placement:"right",chevronPosition:["t-b","r-tl","b-t","l-tr"],targetPosition:["b-t","tl-r","t-b","tr-l"],offsetFromTarget:[{x:0,y:0},{x:12,y:-20},{x:0,y:0},{x:0,y:0}],chevronOffset:[{x:0,y:0},{x:14,y:20},{x:0,y:0},{x:0,y:0}],minWidth:300,title:"Filters",defaultFocus:"fieldCombobox",config:{models:[],context:void 0,blackListFields:[],whiteListFields:[],types:[],filters:[],showModelFilter:!0},initComponent:function(){this.items=this._getItems(),this.buttons=this._getButtonConfig(),this.callParent(arguments),this.applyButton=this.down("#applyButton"),this.cancelButton=this.down("#cancelButton"),this.down("#fieldCombobox").on("focus",this._focusFirstEmptyField,this,{single:!0})},_focusFirstEmptyField:function(){var panel=this.down("rallycustomfilterpanel");panel&&panel.focusFirstEmptyField()},onRender:function(){this._initializeKeyMap(),this.callParent(arguments)},onDestroy:function(){this.keyMap&&(this.keyMap.destroy(),delete this.keyMap),this.callParent(arguments)},_initializeKeyMap:function(){this.keyMap=Ext.create("Ext.util.KeyMap",{target:this.el,scope:this,binding:[{key:[Ext.EventObject.RETURN],ctrl:!0,fn:this._onApplyClick,scope:this}]})},_getItems:function(){return[{xtype:"rallycustomfilterpanel",itemId:"customFilterPanel",context:this.context,models:this.models,filters:this.filters,blackListFields:this.blackListFields,whiteListFields:this.whiteListFields},{xtype:"container",hidden:!this.showModelFilter||this.models&&this.models.length<=1,cls:"model-filter-container",items:[{xtype:"component",html:"SHOW"},this._getModelFilterConfig()]}]},_getModelFilterConfig:function(){return{xtype:"rallymodelfilter",models:this.models,context:this.context,listeners:{valid:this._onModelFilterValidityChange,invalid:this._onModelFilterValidityChange,scope:this},selectedTypes:this.types}},_onModelFilterValidityChange:function(){var isDisabled=!this.down("rallymodelfilter").isValid();this.applyButton.setDisabled(isDisabled)},_getButtonConfig:function(){return[{xtype:"rallybutton",itemId:"cancelButton",cls:"secondary rly-small",text:"Cancel",handler:this._onCancelClick,scope:this},{xtype:"rallybutton",itemId:"applyButton",cls:"primary rly-small",text:"Apply",handler:this._onApplyClick,scope:this}]},getFilters:function(){return this.down("#customFilterPanel").getFilters()},getTypes:function(){return _.pluck(this.down("rallymodelfilter").getSelectedModels(),"typePath")},_onCancelClick:function(){this.destroy()},_onApplyClick:function(){this.down("#customFilterPanel").validate(),this.fireEvent("customfilter",this,{types:this.getTypes(),filters:this.getFilters(),recordMetrics:!0}),this.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.controller.CustomFilterButtonController",{extend:Deft.mvc.ViewController,control:{view:{click:"_onClick",beforedestroy:"_onBeforeDestroy"}},filters:[],types:[],init:function(){
var view=this.getView(),defaultTypes=view.modelNames||[];(_.isEmpty(this.types)||1===defaultTypes.length)&&(this.types=this._getTypesByNames(view.modelNames)),this._filterValidTypes(),view.fireEvent("customfilter",view,{filters:this.filters,types:this.types}),this._updateButtonColor()},applyState:function(state){var filters=state.filters||[];this.filters=_(filters).map(function(filterString){try{return Rally.data.wsapi.Filter.fromQueryString(filterString)}catch(e){}}).compact().filter(this._isValidRefFilter).value(),state.types&&(this.types=this._getTypesByNames(state.types)),this._filterValidTypes(),this._updateButtonColor()},_isValidRefFilter:function(filter){var refFields=["Owner","SubmittedBy"],refPattern=/^(\/\w+\/\d+)$/;return!_.contains(refFields,filter.property)||refPattern.test(filter.value)||null===filter.value},updateState:function(state){this.applyState(state);var view=this.getView();view.stateful&&view.saveState()},getState:function(){return{types:this.types,filters:_.invoke(this.filters,"toString")}},getFilter:function(){return this.filters},_createPopover:function(){var view=this.getView();return Ext.create("Rally.ui.popover.customfilter.CustomFilterPopover",{blackListFields:view.blackListFields||[],context:view.context,filters:this.filters,models:view.modelNames,showModelFilter:view.showModelFilter,target:view.getEl(),types:this.types,whiteListFields:view.whiteListFields||[],listeners:{customfilter:this._onFilter,scope:this}})},_hasActiveFilter:function(){var types=this.types,modelNames=this.getView().modelNames,hasFieldFilters=this.filters&&this.filters.length>0,hasModelFilters=types&&modelNames&&types.length!==modelNames.length;return hasFieldFilters||hasModelFilters},_onClick:function(){this.popover=this._createPopover()},_onFilter:function(popover,filter){this.types=filter.types,this.filters=filter.filters,this._updateButtonColor();var view=this.getView();view.fireEvent("customfilter",this,filter)},_updateButtonColor:function(){var view=this.getView();view&&(this._hasActiveFilter()?view.indicateActiveFilterPresent():view.indicateNoActiveFilterPresent())},_onBeforeDestroy:function(){this.popover&&(this.popover.destroy(),this.popover=null)},_getTypesByNames:function(modelNames){return _.map(modelNames,function(modelName){return Rally.data.ModelTypes.getTypeByName(modelName).toLowerCase()},this)},_filterValidTypes:function(){var view=this.getView();if(view&&view.modelNames){var typesByName=this._getTypesByNames(view.modelNames);this.types=_.filter(this.types,function(tp){return _.contains(typesByName,tp)})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.CustomFilterButton",{extend:Rally.ui.filter.view.FilterButton,mixins:[Rally.clientmetrics.ClientMetricsRecordable],controller:"Rally.ui.filter.controller.CustomFilterButtonController",alias:"widget.rallycustomfilterbutton",cls:"rly-small gridboard-filter-control",margin:"3 10 3 0",showModelFilter:!0,stateEvents:["customfilter"],constructor:function(config){config.blackListFields=_.union(config.blackListFields,["DirectChildrenCount","DisplayColor","DragAndDropRank","TestCase","TestCaseResult","VersionId"]),config.whiteListFields=_.union(config.whiteListFields,["Tags","Milestones"]),this.callParent([config])},initComponent:function(){this.addEvents(["customfilter"]),this.on("customfilter",this._onCustomFilterApplied),this.callParent(arguments)},getModelNames:function(){return this.modelNames},setModelNames:function(modelNames){this.modelNames=modelNames},setTypes:function(types){this.getController().types=types},setFilters:function(filters){this.getController().filters=filters},getTypes:function(){return this.getController().types},getFilters:function(){return this.getController().filters},_onCustomFilterApplied:function(cmp,args){args&&args.recordMetrics&&(_.forEach(args.filters,function(filter){this.recordAction({description:"custom filter applied",miscData:{filterField:filter.property}})},this),this.recordAction({description:"custom filters applied",miscData:{filterFields:_.pluck(args.filters,"property"),filterFieldsCount:args.filters.length,showTypes:args.types}}))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.filter.FilterModificationator",{singleton:!0,modifyFilters:function(filters,filterChildren,models){return _.map(Ext.Array.from(filters),function(filter){return this._modifyFilter(filter,filterChildren,models)},this)},_modifyFilter:function(filter,filterChildren,models){return"Owner"===filter.property&&filterChildren?this._createChildCollectionOwnerFilter(filter,models):Ext.isDate(filter.value)?this._createDateFilter(filter):filter},_createChildCollectionOwnerFilter:function(filter,models){var collectionProperties=["Tasks","Defects","Children","TestCases"],filters=[filter].concat(_.compact(_.map(collectionProperties,function(collectionName){return this._createCollectionOwnerFilter(filter.value,collectionName,filter.operator,models)},this)));return Rally.data.wsapi.Filter.or(filters)},_createCollectionOwnerFilter:function(owner,collectionName,operator,models){if(this._propertyBelongsToSomeType(collectionName,models))return Ext.create("Rally.data.wsapi.Filter",{property:collectionName+".Owner",operator:operator,value:owner}).and(Ext.create("Rally.data.wsapi.Filter",{property:collectionName+".ObjectID",operator:"!=",value:null}))},_propertyBelongsToSomeType:function(collectionName,models){return!models||_.some(models,function(model){var field=model.getField(collectionName)||model.getField(Ext.String.capitalize(collectionName||""));return field&&!field.virtual})},_createDateFilter:function(filter){var minDate,maxDate,rangeFilter,newFilter=Ext.create("Rally.data.wsapi.Filter",{property:filter.property,operator:filter.operator,value:filter.value}),value=newFilter.value;switch(newFilter.operator){case"=":minDate=value,maxDate=Rally.util.DateTime.add(minDate,"day",1),rangeFilter=Ext.create("Rally.data.wsapi.Filter",{property:newFilter.property,operator:">=",value:Rally.util.DateTime.toIsoString(minDate)}).and(Ext.create("Rally.data.wsapi.Filter",{property:newFilter.property,operator:"<",value:Rally.util.DateTime.toIsoString(maxDate)}));break;case"!=":minDate=value,maxDate=Rally.util.DateTime.add(minDate,"day",1),rangeFilter=Ext.create("Rally.data.wsapi.Filter",{property:newFilter.property,operator:"<",value:Rally.util.DateTime.toIsoString(minDate)}).or(Ext.create("Rally.data.wsapi.Filter",{property:newFilter.property,operator:">=",value:Rally.util.DateTime.toIsoString(maxDate)}));break;case">":newFilter.operator=">=",value=Rally.util.DateTime.add(value,"day",1);break;case"<=":newFilter.operator="<",value=Rally.util.DateTime.add(value,"day",1)}return rangeFilter?rangeFilter:(newFilter.value=Rally.util.DateTime.toIsoString(value),newFilter)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.ArtifactFilter",{alias:"widget.rallyartifactfilter",extend:Rally.ui.combobox.ArtifactSearchComboBox,config:{cls:"rally-artifact-filter",noEntryText:"-- Clear Filter --",emptyText:"Filter by ID or Name",allowClearFilter:!0,defaultSelectionPosition:null,displayTpl:Ext.create("Ext.XTemplate",'<tpl for="."><tpl if="values.FormattedID">{FormattedID}: </tpl>{_refObjectName:htmlEncode}</tpl>')},stateEvents:["select"],initComponent:function(){this.callParent(arguments),this.addEvents("initialvalueset"),this.mon(this.store,"load",this._onStoreLoad,this),this.on("select",this._onSelect,this)},afterRender:function(){this.callParent(arguments),this.fireEvent("initialvalueset",this,this.getFilter())},_onStoreLoad:function(){var initialValue=this.initialValue;if(initialValue){delete this.initialValue;var ref=this.findRecordByValue(initialValue);ref||Ext.create("Rally.data.wsapi.RefsToRecords").convert([initialValue],{requester:this}).then({success:function(addedRecords){addedRecords.length&&(this.store.add(addedRecords[0]),this.setValue(initialValue))},scope:this})}this.allowClearFilter&&this.store.insert(0,{_ref:this.noEntryValue,_refObjectName:this.noEntryText})},getFilter:function(){var value=this.getValue()||this.initialValue||this.noEntryValue;return value===this.noEntryValue?null:(value=value===this.noEntryValue?null:value,Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",operator:"=",value:Rally.util.Ref.getOidFromRef(value)}))},_onSelect:function(){this.getValue()===this.noEntryValue&&(delete this.initialValue,delete this.originalValue,this.reset())},applyState:function(state){this.callParent(arguments),this.initialValue=state.value}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.OwnerFilter",{alias:"widget.rallyownerfilter",extend:Rally.ui.combobox.UserSearchComboBox,config:{cls:"rally-owner-filter",allowClear:!0,clearText:"-- Clear Filter --",clearValue:"/user/-2",emptyText:"Filter by Owner",filterLabel:"owner",pickerOffset:[-1,1],noEntryValue:"/user/-1",includeWorkspaceUsers:!0},stateEvents:["select"],initComponent:function(){this.callParent(arguments),this.addEvents("initalvalueset")},afterRender:function(){this.callParent(arguments),this._onRenderListenForInputFocus(),this.fireEvent("initalvalueset",this,this.getFilter())},getFilter:function(){var value=this.getValue()||this.initialValue||this.clearValue;return value===this.clearValue?null:(value=value===this.noEntryValue?null:value,Ext.create("Rally.data.wsapi.Filter",{property:"Owner",operator:"=",value:value}))},applyState:function(state){this.callParent(arguments),this.initialValue=state.value},setDefaultValue:function(){this.storeMode===this.TEAM_MEMBERSHIP_STORE_MODE&&""!==this.getInputTextValue()&&this.callParent(arguments)},getValidSelectionValue:function(){var value=this.getValue();return value&&this.forceSelection&&!Rally.util.Ref.isRefUri(value)&&(value=null),value},_clearInputEl:function(){var inputEl=this.getInputElement();inputEl&&inputEl.dom&&(inputEl.dom.value="")},_onRenderListenForInputFocus:function(){var inputEl=this.getInputElement();this.mon(inputEl,"click",this._onInputClick,this)},_onInputClick:function(){this._clearInputEl(),this.expand()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.UserComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyusercombobox",config:{editable:!0,typeAhead:!0,queryMode:"remote",minChars:0,forceSelection:!0,selectOnFocus:!0,emptyText:"Search...",allowNoEntry:!0,noEntryText:"-- None --",listConfig:{overflowX:"hidden"},storeConfig:{autoLoad:!1,model:"user",pageSize:10,remoteFilter:!0,sorters:[{property:"UserName",direction:"ASC"}]},displayField:"UserName"},initComponent:function(){this.callParent(arguments),this.getStore()&&this.relayEvents(this.getStore(),["load"],"store")},constructor:function(config){config.value&&Ext.merge(config,{storeConfig:{filters:[{property:"ObjectID",value:Rally.util.Ref.getOidFromRef(config.value)}]}}),this.callParent(arguments)},beforeQuery:function(queryPlan){var queryString=queryPlan.query,storeFilters=this.store.filters.getRange(),idFilter=Rally.data.wsapi.Filter.or([{property:"UserName",operator:"contains",value:queryString},{property:"DisplayName",operator:"contains",value:queryString},{property:"FirstName",operator:"contains",value:queryString},{property:"LastName",operator:"contains",value:queryString},{property:"EmailAddress",operator:"contains",value:queryString}]);return storeFilters.length?queryString?queryPlan.query=Rally.data.wsapi.Filter.and(storeFilters).and(idFilter).toString():queryPlan.query=Rally.data.wsapi.Filter.and(storeFilters).toString():queryString&&(queryPlan.query=idFilter.toString()),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.UserFilter",{alias:"widget.rallyuserfilter",extend:Rally.ui.combobox.UserComboBox,config:{cls:"rally-user-filter",noEntryText:"-- Clear Filter --",emptyText:"Filter by User",allowClearFilter:!0,defaultSelectionPosition:null},stateEvents:["select"],initComponent:function(){this.callParent(arguments),this.addEvents("initialvalueset"),this.mon(this.store,"load",this._onStoreLoad,this),this.on("select",this._onSelect,this)},afterRender:function(){this.callParent(arguments),this.fireEvent("initialvalueset",this,this.getFilter())},_onStoreLoad:function(){var initialValue=this.initialValue;if(initialValue){delete this.initialValue;var ref=this.findRecordByValue(initialValue);ref||Ext.create("Rally.data.wsapi.RefsToRecords").convert([initialValue],{requester:this}).then({success:function(addedRecords){addedRecords.length&&(this.store.add(addedRecords[0]),this.setValue(initialValue))},scope:this})}this.allowClearFilter&&this.store.insert(0,{_ref:this.noEntryValue,UserName:this.noEntryText})},getFilter:function(){var value=this.getValue()||this.initialValue||this.noEntryValue;return value===this.noEntryValue?null:(value=value===this.noEntryValue?null:value,Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",operator:"=",value:Rally.util.Ref.getOidFromRef(value)}))},_onSelect:function(){this.getValue()===this.noEntryValue&&(delete this.initialValue,this.reset())},applyState:function(state){this.callParent(arguments),this.initialValue=state.value}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardCustomFilterControl",{alias:"plugin.rallygridboardcustomfiltercontrol",extend:Ext.AbstractPlugin,mixins:[Rally.ui.gridboard.plugin.GridBoardControlShowable],headerPosition:"left",filterControlConfig:{},filterChildren:!0,showOwnerFilter:!1,showIdFilter:!1,showUserFilter:!1,ownerFilterControlConfig:{},idFilterConfig:{},userFilterConfig:{},containerConfig:{},init:function(cmp){this.callParent(arguments),this.cmp=cmp,this.cmp.useFilterCollection=!1,this.cmp.on("modeltypeschange",this._onTypeChange,this);var control=this.showControl();this.filterButton=control.down("rallycustomfilterbutton"),this.ownerFilter=control.down("rallyusersearchcombobox"),this.idFilter=control.down("rallyartifactfilter"),this.userFilter=control.down("rallyuserfilter")},getControlCmpConfig:function(){var config=Ext.merge({xtype:"container",itemId:"gridBoardFilterControlCt",width:72,layout:"hbox",items:[Ext.merge({xtype:"rallycustomfilterbutton",context:this.cmp.getContext(),listeners:{customfilter:{fn:this._onFilterButtonStateAvailable,single:!0,scope:this}},toolTipConfig:{html:"Filter",anchor:"top",mouseOffset:[-9,-2]},margin:"3 9 3 30"},this.filterControlConfig)]},this.containerConfig);return this.showOwnerFilter&&(config.width+=210,config.items.push(Ext.merge({xtype:"rallyownerfilter",margin:"3px 10px 0px 0px",listConfig:{width:200},context:this.cmp.getContext(),width:200,listeners:{initalvalueset:{fn:this._onOwnerFilterStateAvailable,single:!0},select:this._applyFilter,scope:this}},this.ownerFilterControlConfig))),this.showIdFilter&&(config.width+=260,config.items.push(Ext.merge({xtype:"rallyartifactfilter",margin:"3px 10px 0px 0px",listConfig:{width:250},storeConfig:{models:this.filterControlConfig.modelNames,context:this.cmp.getContext().getDataContext()},width:250,listeners:{initialvalueset:{fn:this._onIdFilterStateAvailable,single:!0},select:this._applyFilter,scope:this}},this.idFilterConfig))),this.showUserFilter&&(config.width+=260,config.items.push(Ext.merge({xtype:"rallyuserfilter",margin:"3px 10px 0px 0px",listConfig:{width:250},storeConfig:{models:this.filterControlConfig.modelNames,context:this.cmp.getContext().getDataContext()},width:250,listeners:{initialvalueset:{fn:this._onUserFilterStateAvailable,single:!0},select:this._applyFilter,scope:this}},this.userFilterConfig))),config},_onFilterButtonStateAvailable:function(){this._filterButtonStateAvailable=!0,this.filterButton.on("customfilter",this._applyFilter,this),this.showOwnerFilter&&!this._ownerFilterStateAvailable||this.showIdFilter&&!this._idFilterStateAvailable||this.showUserFilter&&!this._userFilterStateAvailable||this._applyFilter()},_onOwnerFilterStateAvailable:function(){this._ownerFilterStateAvailable=!0,!this._filterButtonStateAvailable||this.showIdFilter&&!this._idFilterStateAvailable||this._applyFilter()},_onIdFilterStateAvailable:function(){this._idFilterStateAvailable=!0,!this._filterButtonStateAvailable||this.showOwnerFilter&&!this._ownerFilterStateAvailable||this._applyFilter()},_onUserFilterStateAvailable:function(){this._userFilterStateAvailable=!0,!this._filterButtonStateAvailable||this.showUserFilter&&!this._userFilterStateAvailable||this._applyFilter()},_onTypeChange:function(cmp,types){var modelNames=_.map(types,function(type){return type.isModel?type.get("TypePath"):type}),typeNames=this._getTypesByNames(modelNames);this.filterButton.setModelNames(modelNames),this.filterButton.setTypes(typeNames),this.filterButton.setFilters([]),this.filterButton.indicateNoActiveFilterPresent(),this.filterButton.saveState()},_getFilters:function(){return _.union(this.ownerFilter?[this.ownerFilter.getFilter()]:[],this.idFilter?[this.idFilter.getFilter()]:[],this.userFilter?[this.userFilter.getFilter()]:[])},_applyFilter:function(){var filters=_.compact(Ext.Array.merge(this.filterButton.getFilters(),this._getFilters())),modifiedFilters=Rally.data.wsapi.filter.FilterModificationator.modifyFilters(filters,this.filterChildren),filterArgs={types:this.filterButton.getTypes(),filters:modifiedFilters};this.cmp.applyCustomFilter(filterArgs)},_getTypesByNames:function(modelNames){return _.map(modelNames,function(modelName){return Rally.data.ModelTypes.getTypeByName(modelName).toLowerCase()},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardFieldPicker",{alias:"plugin.rallygridboardfieldpicker",extend:Ext.AbstractPlugin,mixins:[Rally.ui.gridboard.plugin.GridBoardControlShowable],gridAlwaysSelectedValues:["FormattedID","Name"],boardAlwaysSelectedValues:["FormattedID","Name","Owner"],gridFieldBlackList:[],boardFieldBlackList:["Blocked","BlockedReason","DisplayColor","DragAndDropRank","PortfolioItemType","Rank","Ready","StateChangedDate"],buttonConfig:{},modelNames:[],margin:"3 9 0 0",constructor:function(config){this.config=_.merge({},this.config||{},config||{}),config=this._updateConfig(config,["boardFieldBlackList","boardAlwaysSelectedValues","gridAlwaysSelectedValues"]),this.callParent([config])},init:function(cmp){this.callParent(arguments),this.cmp=cmp,this.rankingEnabled=this.cmp.gridConfig.enableRanking!==!1&&this._isWorkspaceDnDRanked(),1===this.cmp.modelNames.length&&"task"===this.cmp.modelNames[0].toLowerCase()?this._modifyFieldCollection("gridFieldBlackList",["DragAndDropRank"],!0):(this._modifyFieldCollection("gridAlwaysSelectedValues",["DragAndDropRank"],this.rankingEnabled),this._modifyFieldCollection("gridFieldBlackList",["DragAndDropRank"],!this.rankingEnabled)),this.cmp.mon(this.cmp,"toggle",this._onToggled,this),this.showControl()},_updateConfig:function(initialConfig,fields){return _.reduce(fields,function(config,field){return config[field]=this._getConfigValue(config,field),config},initialConfig||{},this)},_getConfigValue:function(config,field){var configValue=config&&config[field],defaultValue=this[field];return _.isFunction(configValue)?configValue():_.isArray(defaultValue)?_.union(this[field],configValue):configValue},_modifyFieldCollection:function(collectionName,fields,include){_.isFunction(this.getInitialConfig(collectionName))||(this[collectionName]=include?_.union(this[collectionName],fields):_.reject(this[collectionName],function(field){return _.contains(fields,field)}))},getControlCmpConfig:function(){return _.merge({xtype:"rallybutton",itemId:"fieldpickerbtn",cls:"field-picker-btn secondary rly-small",margin:this.margin,iconCls:"icon-add-column",toolTipConfig:{html:this.getTitle(),anchor:"top"},listeners:{click:this._onClick,scope:this}},this.buttonConfig)},_onClick:function(btn){this._createPopover(btn.getEl())},_getPickerConfig:function(){var pickerConfig,gridOrBoard=this.cmp.getGridOrBoard();return pickerConfig="board"===this.cmp.getToggleState()?_.extend({value:gridOrBoard.columnConfig.fields,fieldBlackList:this.boardFieldBlackList,alwaysSelectedValues:this.boardAlwaysSelectedValues,context:this.context},this.fieldPickerConfig):_.extend({value:_.pluck(gridOrBoard.columns,"dataIndex").join(","),fieldBlackList:this.gridFieldBlackList,alwaysSelectedValues:this.gridAlwaysSelectedValues,context:this.context},this.fieldPickerConfig)},_createPopover:function(popoverTarget){this.boardFieldBlackList=_.union(this.boardFieldBlackList,Rally.ui.grid.FieldColumnFactory.getBlackListedFieldsForTypes(this._getModelTypes())),this.gridFieldBlackList=_.union(Rally.ui.grid.FieldColumnFactory.getBlackListedFieldsForTypes(this._getModelTypes()),this.gridFieldBlackList),this.popover=Ext.create("Rally.ui.popover.Popover",{target:popoverTarget,placement:["bottom","left","top","right"],cls:"field-picker-popover",toFront:Ext.emptyFn,buttonAlign:"center",title:this.getTitle(),listeners:{destroy:function(){this.popover=null},scope:this},buttons:[{xtype:"rallybutton",text:"Apply",cls:"field-picker-apply-btn primary rly-small",listeners:{click:function(){this._onApply(this.popover)},scope:this}},{xtype:"rallybutton",text:"Cancel",cls:"field-picker-cancel-btn secondary dark rly-small",listeners:{click:function(){this.popover.close()},scope:this}}],items:[_.extend({xtype:"rallyfieldpicker",cls:"field-picker",itemId:"fieldpicker",modelTypes:this._getModelTypes(),alwaysExpanded:!0,width:200,emptyText:"Search",selectedTextLabel:"Selected",availableTextLabel:"Available",listeners:{specialkey:function(field,e){e.getKey()===e.ESC&&this.popover.close()},scope:this}},this._getPickerConfig())]})},_getModelTypes:function(){return _.pluck(this._getModels(),"typePath")},_getModels:function(){return _.reduce(this.cmp.getModels(),function(accum,model){return"artifact"===model.typePath?accum=accum.concat(model.getArtifactComponentModels()):accum.push(model),accum},[])},_onToggled:function(){this.popover&&this.popover.rendered&&this.down("#popoverheader").setTitle(this.getTitle()),this.cmp.down("#fieldpickerbtn").setToolTipText(this.getTitle())},getTitle:function(){return"board"===this.cmp.getToggleState()?"Show on Cards":"Show Columns"},updateFields:function(fields,suspendLoad){var gridOrBoard=this.cmp.getGridOrBoard();if("grid"===this.cmp.getToggleState())gridOrBoard.reconfigureWithColumns(fields,!1,suspendLoad);else{var boardConfig={columnConfig:{fields:fields}};suspendLoad&&(boardConfig.columnConfig.storeConfig={autoLoad:!1}),gridOrBoard.reconfigureWithFields(boardConfig)}this._updatePickerValue(fields),this.cmp.fireEvent("viewstatesave",this)},_updatePickerValue:function(fields){this.popover&&this.popover.down("rallyfieldpicker")&&this.popover.down("rallyfieldpicker").setValue(fields.join(","))},_onApply:function(popover){var fieldPicker=popover.down("rallyfieldpicker"),fields=_.map(fieldPicker.getValue(),function(field){return field.get("name")});this.updateFields(fields),popover.close()},_isWorkspaceDnDRanked:function(){var dndRanked=!0;try{dndRanked=this.cmp.getContext().getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled}catch(e){}finally{return dndRanked}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardToggleable",{alias:"plugin.rallygridboardtoggleable",extend:Ext.AbstractPlugin,autoRefreshComponentOnToggle:!0,toggleButtonConfig:{},init:function(cmp){this.cmp=cmp,this._addToggleButtons()},_addToggleButtons:function(){this.cmp.getHeader().getRight().add(_.merge({itemId:"toggle",xtype:"rallygridboardtoggle",toggleState:this.cmp.getToggleState(),style:{float:"right"},listeners:{toggle:this._onToggle,scope:this}},this.toggleButtonConfig))},_onToggle:function(button,toggleState){this.cmp.setToggleState(toggleState,!this.autoRefreshComponentOnToggle)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.Export",{singleton:!0,buildCsvExportUrl:function(cmp){var params=this._getScopeParams(cmp),type="artifact";return cmp.is("rallycardboard")?this._getCardBoardParams(cmp,params):cmp.is("rallychart")?(type=cmp.loadedStores.model.typePath,this._getChartParams(cmp,params)):(type=cmp.store.model.typePath,this._getGridParams(cmp,params,type)),Rally.environment.getServer().getWsapiUrl()+"/"+type+".csv?"+Ext.Object.toQueryString(params)},buildXmlExportUrl:function(cmp){var cmpType="rallycardboard"===cmp.xtype?cmp.types[0]:cmp.store.parentTypes[0],type=Rally.util.TypeInfo.getTypeInfoByName(cmpType).prefix;return Rally.environment.getServer().getContextUrl()+"/"+type+"/exportXml.sp?"+Ext.Object.toQueryString(this._getScopeParams(cmp))},_getScopeParams:function(cmp){var context=cmp.store&&cmp.store.context||cmp.getContext().getDataContext();return{workspace:context.workspace,project:context.project,projectScopeDown:context.projectScopeDown,projectScopeUp:context.projectScopeUp}},_getChartParams:function(cmp,params){var store=cmp.loadedStores,models=[store.model];"artifact"===store.model.typePath&&(models=_.values(store.model.getArtifactComponentModels()),params.types=_.pluck(models,"typePath").join(","));var filters=Rally.util.Filter.removeNonapplicableTypeSpecificFilters(store.filters.getRange(),models);return params.query=this._getQueryParam(filters),params.order=this._getOrderParam(store.sorters.getRange()),params.fetch=store.fetch.join(","),params},_getCardBoardParams:function(cmp,params){var firstColumnStore=_.first(cmp.getColumns()).store,models=_.map(cmp.types,firstColumnStore.model.getArtifactComponentModel,firstColumnStore.model),filters=Rally.util.Filter.removeNonapplicableTypeSpecificFilters(cmp.storeConfig.filters,models);return params.fetch=this._getFetchParam(cmp.columnConfig.fields,cmp),params.order=this._getOrderParam(firstColumnStore.sorters.getRange()),params.types=cmp.types.join(","),params.query=this._getQueryParam(filters),params},_getGridParams:function(cmp,params,type){params.fetch=this._getFetchParam(cmp.columnCfgs,cmp),params.order=this._getOrderParam(cmp.store.sorters.getRange());var filters=cmp.store.filters.getRange();if("artifact"===type){params.types=cmp.store.parentTypes.join(",");var models=_.map(cmp.store.parentTypes,cmp.store.model.getArtifactComponentModel,cmp.store.model);filters=Rally.util.Filter.removeNonapplicableTypeSpecificFilters(filters,models)}return params.query=this._getQueryParam(filters),params},_getFieldsForExport:function(field,cmp){var store=cmp.store||_.first(cmp.getColumns()).store,models=_.isFunction(store.model.getArtifactComponentModels)?store.model.getArtifactComponentModels():[store.model],fields=_.compact(_.invoke(models,"getField",field.dataIndex||field)),virtualField=_.find(fields,function(f){return _.isFunction(f.getFieldsForExport)});return virtualField&&virtualField.getFieldsForExport()},_isFieldVisible:function(field,cmp){var store=cmp.store||_.first(cmp.getColumns()).store,models=_.isFunction(store.model.getArtifactComponentModels)?store.model.getArtifactComponentModels():[store.model],fields=_.compact(_.invoke(models,"getField",field.dataIndex||field));return _.any(fields,function(field){return field&&!field.hidden})},_getFetchParam:function(fields,cmp){return"FormattedID,"+_(fields).map(function(field){return this._getFieldsForExport(field,cmp)||field.dataIndex||field},this).flatten().filter(function(field){return"DragAndDropRank"!==field&&this._isFieldVisible(field,cmp)},this).value().join(",")},_getOrderParam:function(sorters){return _.map(sorters,function(sorter){return sorter.property+" "+sorter.direction}).join(",")},_getQueryParam:function(filters){return(Rally.data.wsapi.Filter.and(filters)||"").toString()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.TreeGridExpandedRowPersistence",{extend:Ext.AbstractPlugin,alias:"plugin.rallytreegridexpandedrowpersistence",expandedNodes:[],expandAllActive:!1,visibleNodes:[],visibleNodeRefs:[],expandDelay:0,allowExpansionStateToBeSaved:!0,init:function(cmp){this.callParent(arguments),this.expandDelay=Ext.isIE?2500:250,this.cmp.on("staterestore",this._onStateRestore,this),this.cmp.on("storebeforeexpand",this._beforeItemExpand,this),this.cmp.on("storebeforecollapse",this._beforeItemCollapse,this),this.cmp.getView().on("visibilitychange",this._onVisibilityChange,this),this.cmp.on("expandall",this._onExpandAll,this),this.cmp.on("collapseall",this._onCollapseAll,this),this.cmp.on("afteritemcollapse",this._afterCollapse,this),cmp.appliedState&&this._onStateRestore(cmp,cmp.appliedState)},_saveState:function(){this.cmp.expandedRowPersistenceState={expandedNodes:this._getExpandedBranchNodes()},this.allowExpansionStateToBeSaved&&this.cmp.saveState()},_onStateRestore:function(cmp,state){state.expandedRowPersistence&&(this.expandedNodes=state.expandedRowPersistence.expandedNodes||[],this.expandAllActive=!1)},_beforeItemExpand:function(node){var ref=node.get("_ref");ref&&(this.expandedNodes=_.union(this.expandedNodes,[ref]),this._saveState())},_beforeItemCollapse:function(node){var ref=node.get("_ref");ref&&(this.expandedNodes=_.without(this.expandedNodes,ref),this._trackCollapsingNodes())},_onExpandAll:function(){this.expandAllActive=!0,this.expandedNodes=_.invoke(this._getParentNodesInStore(),"get","_ref"),this._expandNodes(this.visibleNodes,!0),this._saveState()},_onCollapseAll:function(){this.expandedNodes=[],this._startExpand("collapse"),this.isCollapsingAll=!0,this._trackCollapsingNodes(),this.cmp.collapseAll(this._afterCollapseAll,this)},_afterCollapseAll:function(){this.isCollapsingAll=!1,this._afterCollapse()},_afterCollapse:function(){this._stopExpand("collapse")},_resumeEventsAndLayouts:function(){this.cmp.resumeEvents(),this.cmp.resumeLayouts(!1)},_suspendEventsAndLayouts:function(){this.cmp.suspendLayouts(),this.cmp.suspendEvents(!1)},_trackCollapsingNodes:function(){var grid=this.cmp,view=grid.getView();grid.firstVisibleNode=void 0,this.isCollapsingAll&&(grid.firstVisibleNode=view.getFirstVisibleNode(this._getTopLevelNodes())),this.expandAllActive=!1,this._saveState()},_onVisibilityChange:function(cmp,nodes){this.visibleNodes=nodes,this.visibleNodeRefs=_.invoke(nodes,"get","_ref"),this.expandAllActive?(this._setExpandedNodes(),this._expandNodes(nodes,!0)):this._expandNodes(this._getPersistedNodesToExpand(nodes))},_setExpandedNodes:function(){this.expandedNodes=_(this._getParentNodesInStore()).invoke("get","_ref").union(this.expandedNodes).value()},_expandNodes:function(nodes,isExpandAll){var node,grid=this.cmp,expandTracker=grid.expandTracker;nodes=_.filter(nodes,this._isVisibleUnexpandedParentNode,this),nodes.length&&(node=nodes.shift(),this._startExpand("expand"),expandTracker.whenExpanded([node],grid.getView(),this._getExpandableNodeRefs()).then({success:function(expandedNodes){this._stopExpand("expand",expandedNodes),isExpandAll&&!this.expandAllActive&&this._collapseNode(node)},scope:this}),grid.expandNode(node,!1))},_collapseNode:function(node){this.expandedNodes=_.difference(this.expandedNodes,[node.get("ref")]),this._startExpand("collapse"),this._trackCollapsingNodes(),this.cmp.collapseNode(node,!1,this._afterCollapse,this)},_getExpandableNodeRefs:function(){return _.intersection(this.expandedNodes,this.visibleNodeRefs)},_startExpand:function(action){this.cmp.fireEvent(action+"batch",this),this._suspendEventsAndLayouts()},_stopExpand:function(action,nodes){this._resumeEventsAndLayouts(),this.cmp.fireEvent("after"+action+"batch",this.cmp,nodes)},_getExpandedBranchNodes:function(){return _.intersection(this.expandedNodes,this._getValidNodeRefs())},_getValidNodeRefs:function(){return _.invoke(this._getParentNodesInStore(),"get","_ref")},_getParentNodesInStore:function(){var parentNodes=[];return this.cmp.getStore().each(function(node){this._isParentNode(node)&&parentNodes.push(node)},this),parentNodes},_getTopLevelNodes:function(){return this.cmp.getStore().getTopLevelNodes()},_getNodesToCollapse:function(){return _.filter(this._getParentNodesInStore(),this._shouldCollapseNode,this)},_getPersistedNodesToExpand:function(nodes){return _.filter(nodes,function(node){return _.contains(this.expandedNodes,node.get("_ref"));
},this)},_shouldExpandNode:function(node){return!node.isExpanded()&&this._isNodeVisible(node)},_shouldCollapseNode:function(node){return node.isExpanded()&&this._isNodeVisible(node)},_isNodeVisible:function(node){return _.contains(this.visibleNodeRefs,node.get("_ref"))},_isVisibleUnexpandedParentNode:function(node){return this._isParentNode(node)&&this._isNotLoadingNode(node)&&this._shouldExpandNode(node)},_isParentNode:function(node){return!node.get("leaf")},_isNotLoadingNode:function(node){return!node.isLoading()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.GridBoardApp",{extend:Rally.app.App,plugins:["rallygridboardappresizer"],actionMenuItems:[],enableGridBoardToggle:!1,enableAddNew:!0,enableImport:!0,enableCsvExport:!0,enablePrint:!0,enableRanking:!0,isWorkspaceScoped:!1,modelNames:[],modelsContext:null,printHeaderLabel:"",statePrefix:null,toggleState:"grid",allowExpansionStateToBeSaved:!0,initEvents:function(){this.callParent(arguments),this.addEvents("gridboardadded")},launch:function(){this._loadGridBoardPreference(),this.loadModelNames().then({success:function(modelNames){this.modelNames=modelNames,this.rendered?this.loadGridBoard():this.on("afterrender",this.loadGridBoard,this,{single:!0})},scope:this})},loadModelNames:function(){return Deft.Promise.when(this.modelNames)},_loadGridBoardPreference:function(){var gridboardPrefs=this.getSetting(this.getStateId("gridboard"));gridboardPrefs&&(gridboardPrefs=Ext.JSON.decode(gridboardPrefs),this.toggleState=gridboardPrefs.toggleState||this.toggleState)},loadGridBoard:function(){return Rally.data.ModelFactory.getModels({context:this.modelsContext||this.getContext(),types:this.modelNames,requester:this}).then({success:function(models){return this.models=_.transform(models,function(result,value){result.push(value)},[]),this.modelNames=_.keys(models),"grid"===this.toggleState?this.getGridStores().then({success:function(stores){this.addGridBoard(stores),this.publishComponentReady()},scope:this}):"board"===this.toggleState?this.getCardBoardColumns().then({success:function(columns){this.addGridBoard({columns:columns}),columns&&0!==columns.length||(this.showNoColumns(),this.publishComponentReady())},scope:this}):(this.addGridBoard(),void this.publishComponentReady())},scope:this})},showNoColumns:function(){this.add({xtype:"container",cls:"no-type-text",html:"<p>This Type has no states defined.</p>"})},addGridBoard:function(options){this.gridboard&&this.gridboard.destroy(),this.gridboard=Ext.create("Rally.ui.gridboard.GridBoard",this.getGridBoardConfig(options)),this.gridboard.on("modeltypeschange",this.onTypesChange,this),this.gridboard.on("toggle",this._onGridBoardToggle,this),this.gridboard.on("filtertypeschange",this.onFilterTypesChange,this),this.add(this.gridboard),this.fireEvent("gridboardadded",this.gridboard)},_onGridBoardToggle:function(toggleState,gridOrBoard){this.toggleState=toggleState,gridOrBoard||this.loadGridBoard()},onTypesChange:function(gridboard,newTypes){this.modelNames=_.map(newTypes,function(type){return type.isModel?type.get("TypePath"):type}),this.loadGridBoard()},getCardBoardColumns:function(){return Deft.Promise.when([])},getGridStores:function(){return this._getTreeGridStore()},_getTreeGridStore:function(){return Ext.create("Rally.data.wsapi.TreeStoreBuilder").build(_.merge({autoLoad:!1,childPageSizeEnabled:!0,context:this._getGridBoardContext().getDataContext(),enableHierarchy:!0,fetch:_.union(["Workspace"],this.columnNames),models:_.clone(this.models),pageSize:25,remoteSort:!0,root:{expanded:!0}},this.getGridStoreConfig())).then({success:function(treeGridStore){return treeGridStore.on("load",this._fireTreeGridReady,this,{single:!0}),{gridStore:treeGridStore}},scope:this})},_fireTreeGridReady:function(){var grid=this.gridboard&&"grid"===this.gridboard.getToggleState()&&this.gridboard.getGridOrBoard();grid?this.onTreeGridReady(grid):this.on("gridboardadded",this._fireTreeGridReady,this,{single:!0})},onTreeGridReady:function(grid){this.publishComponentReady()},getGridStoreConfig:function(){return this.gridStoreConfig||{}},getGridBoardConfig:function(options){return{itemId:"gridboard",stateId:this.getStateId("gridboard"),toggleState:this.toggleState,modelNames:_.clone(this.modelNames),context:this._getGridBoardContext(),addNewPluginConfig:this.getAddNewConfig(),plugins:this.getGridBoardPlugins(options),cardBoardConfig:this.getCardBoardConfig(options),chartConfig:this.getChartConfig(),gridConfig:this.getGridConfig(options),height:this.getHeight()}},getStateId:function(suffix){return this.statePrefix+(suffix?"-"+suffix:"")},getScopedStateId:function(suffix){return this.getContext().getScopedStateId(this.getStateId(suffix))},getAddNewPluginConfig:function(){return{ptype:"rallygridboardaddnew",showInChartMode:!1,context:this.getContext(),addNewControlConfig:this.getAddNewConfig()}},getGridBoardPlugins:function(){var plugins=[],filterControlConfig=this.getFilterControlConfig(),customFilterControlConfig=this.getGridBoardCustomFilterControlConfig(),sharedViewConfig=this.getSharedViewConfig();return this.enableAddNew&&plugins.push(this.getAddNewPluginConfig()),"rallygridboardinlinefiltercontrol"===customFilterControlConfig.ptype?plugins.push(customFilterControlConfig):plugins.push(_.merge({ptype:"rallygridboardcustomfiltercontrol",showInChartMode:!1,containerConfig:{width:42},filterChildren:!1,filterControlConfig:_.merge({margin:"3 9 3 0",modelNames:this.modelNames,stateful:!0,stateId:this.getScopedStateId("custom-filter-button")},filterControlConfig),ownerFilterControlConfig:{stateful:!0,stateId:this.getScopedStateId("owner-filter")},showOwnerFilter:Rally.data.ModelTypes.areArtifacts(this.modelNames)},customFilterControlConfig)),plugins.push(_.merge({ptype:"rallygridboardfieldpicker",showInChartMode:!1,headerPosition:"left"},this.getFieldPickerConfig())),_.isEmpty(sharedViewConfig)||plugins.push(sharedViewConfig),this.enableGridBoardToggle&&plugins.push(this.getGridBoardTogglePluginConfig()),plugins=plugins.concat(this.getActionsMenuConfig()||[])},getGridBoardTogglePluginConfig:function(){return{ptype:"rallygridboardtoggleable"}},getChartConfig:function(){return{}},onFilterTypesChange:function(){},_shouldEnableRanking:function(){return this.enableRanking&&Rally.data.ModelTypes.areArtifacts(this.modelNames)&&this.getContext().getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled},getGridConfig:function(options){var config={xtype:"rallytreegrid",alwaysShowDefaultColumns:!1,bufferedRenderer:!0,columnCfgs:this.getColumnCfgs(),enableBulkEdit:!0,allowExpansionStateToBeSaved:this.allowExpansionStateToBeSaved,enableInlineAdd:Rally.data.ModelTypes.areArtifacts(this.modelNames),enableRanking:this._shouldEnableRanking(),enableSummaryRow:Rally.data.ModelTypes.areArtifacts(this.modelNames),expandAllInColumnHeaderEnabled:!0,plugins:this.getGridPlugins(),stateId:this.getScopedStateId("grid"),stateful:!0,store:options&&options.gridStore,storeConfig:{filters:this.getPermanentFilters()}};return 1!==this.modelNames.length||Rally.data.ModelTypes.isArtifact(this.modelNames[0])||(config.noDataItemName=this.modelNames[0].toLowerCase()),_.merge(config,this.gridConfig)},getPermanentFilters:function(){return[]},getColumnCfgs:function(){return _.isEmpty(this.columnNames)?Rally.ui.grid.FieldColumnFactory.getDefaultFieldsForTypes(this.modelNames):this.columnNames},publishComponentReady:function(){this.fireEvent("contentupdated",this),this.recordComponentReady(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},getGridPlugins:function(){return[{ptype:"rallytreegridexpandedrowpersistence",allowExpansionStateToBeSaved:this.allowExpansionStateToBeSaved}]},getActionsMenuConfig:function(){var importItems=this._getImportItems(),printItems=this._getPrintItems(),exportItems=this._getExportItems(),tooltipTypes=[].concat(importItems.length?"Import":[]).concat(exportItems.length?"Export":[]).concat(printItems.length?"Print":[]),menuItems=this.actionMenuItems.concat(importItems,exportItems,printItems);return 0===tooltipTypes.length||"board"===this.toggleState?[]:[{ptype:"rallygridboardactionsmenu",menuItems:menuItems,buttonConfig:{hidden:"grid"!==this.toggleState,iconCls:"icon-export",toolTipConfig:{html:tooltipTypes.join("/"),anchor:"top",hideDelay:0}}}]},_getGridBoardContext:function(){return this.isWorkspaceScoped?this.getContext().clone({project:null}):this.getContext()},_getImportItems:function(){if(!this.enableImport)return[];var piTypesExist=_.any(this.models,function(model){return model.isPortfolioItem()}),importableTypes=_(this.models).filter(function(model){return!model.isPortfolioItem()&&model.isImportable()},this).map(function(model){return{typePath:model.typePath,displayName:model.displayName}}).concat(piTypesExist?[{typePath:"PortfolioItem",displayName:"Portfolio Item"}]:[]).sortBy("displayName").value();return _.map(importableTypes,function(type){var displayName=Ext.util.Inflector.pluralize(type.displayName);return{text:"Import "+displayName+"...",handler:function(){Ext.widget({xtype:"rallycsvimportdialog",type:type.typePath,title:"Import "+displayName})}}},this)},_getExportItems:function(){var exportItems=[];return this.enableCsvExport&&exportItems.push({text:"Export to CSV...",handler:function(){window.location=Rally.ui.gridboard.Export.buildCsvExportUrl(this.gridboard.getGridOrBoard())},scope:this}),this.xmlExportEnabled()&&exportItems.push({text:"Export to XML...",handler:function(){window.location=Rally.ui.gridboard.Export.buildXmlExportUrl(this.gridboard.getGridOrBoard())},scope:this}),exportItems},_getPrintItems:function(){return this.enablePrint&&"chart"!==this.toggleState?[{text:"Print ...",handler:function(){Ext.create("Rally.ui.grid.TreeGridPrintDialog",{grid:this.gridboard.getGridOrBoard(),treeGridPrinterConfig:{largeHeaderText:this.printHeaderLabel}})},scope:this}]:[]},getAddNewConfig:function(){return _.merge({context:this.getContext(),margin:"0 30 0 0",stateful:!0,stateId:this.getScopedStateId("add-new")},this.addNewConfig)},getFilterControlConfig:function(){return{}},getGridBoardCustomFilterControlConfig:function(){return{}},getSharedViewConfig:function(){return{}},getFieldPickerConfig:function(){return{gridFieldBlackList:Rally.ui.grid.FieldColumnFactory.getBlackListedFieldsForTypes(this.modelNames),boardFieldBlackList:["AcceptedLeafStoryCount","AcceptedLeafStoryPlanEstimateTotal","Blocker","DirectChildrenCount","LastUpdateDate","LeafStoryCount","LeafStoryPlanEstimateTotal","PortfolioItem","UnEstimatedLeafStoryCount"],context:this.getContext()}},getCardBoardConfig:function(){return{}},getHeight:function(){var el=this.getEl();if(el){var height=this.callParent(arguments);return Ext.isIE8?Math.max(height,600):height}return 0},setHeight:function(height){this.callParent(arguments),this.gridboard&&this.gridboard.setHeight(height)},xmlExportEnabled:function(){return!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.util.User",{override:"Rally.util.User",getProfileImageUrl:function(imageSize,userRef){var imagePath=this.callParent(arguments);return Rally.getSdkInfo().apiKey&&(imagePath=Ext.String.format("{0}/css/images/1x1.png#{1}",Rally.environment.getServer().getResourcesPath(),imagePath)),imagePath}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.Printable",{getPrintMenuOption:function(printOptions){return{text:"Print",handler:function(){this.openPrintPage(Ext.apply({title:this.appName},printOptions))},scope:this}},getPrintContent:function(){var el=Ext.DomHelper.createDom({});return el.appendChild(Ext.clone(this.getEl().dom)),el.innerHTML},getPrintHeaderContent:function(){return""},getPrintFooterContent:function(){return""},getPrintTopToolbarContent:function(){return""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.TabbedAppSettings",{extend:Rally.app.AppSettings,addSettingsFields:function(){var settingsTypes=this._getSettingsTypes(),tabPanel=this.down("#scopedSettingsForm").add(this._getTabPanelConfig(_.keys(settingsTypes)));_.forIn(settingsTypes,function(val,key){this.addFieldsToCmp(tabPanel.down("#"+this._getTabPanelId(key)),val)},this)},_getSettingsTypes:function(){var settingsTypes={};return _.each(this._getScopedSettingsFields(),function(settingField){Ext.isEmpty(settingField.settingsType)||(settingsTypes.hasOwnProperty(settingField.settingsType)||(settingsTypes[settingField.settingsType]=[]),settingsTypes[settingField.settingsType].push(settingField))}),settingsTypes},_getTabPanelId:function(settingsTypeKey){return settingsTypeKey+"Tab"},_getTabPanelConfig:function(settingsTypes){settingsTypes.sort();var tabConfigs=_.map(settingsTypes,function(settingsTypeKey){return{title:Ext.String.capitalize(settingsTypeKey),itemId:this._getTabPanelId(settingsTypeKey)}},this);return{xtype:"tabpanel",items:tabConfigs,listeners:{tabchange:function(tabPanel,newTab,oldTab){_.each(oldTab.query("field"),this._sendFieldToBack),_.each(newTab.query("field"),this._bringFieldToFront)},scope:this}}},_sendFieldToBack:function(field){if(Ext.isFunction(field.getPicker)){var picker=field.getPicker();picker&&picker.hide()}},_bringFieldToFront:function(field){if(Ext.isFunction(field.getPicker)){var picker=field.getPicker();picker&&picker.show()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.TimeboxBlankSlate",{extend:Ext.Component,alias:"widget.rallytimeboxblankslate",componentCls:"rui-timebox-blank-slate",mixins:[Rally.app.Scopeable],timeboxType:"Iteration",cls:"blank-slate-msg",initComponent:function(){this.callParent(arguments);var capitalizedLabel=Ext.String.capitalize(this.timeboxType),pluralizedLabel=Ext.util.Inflector.pluralize(capitalizedLabel),html=Ext.String.format("<span>There are no {0} defined.",pluralizedLabel);this.isProjectEditor()&&(html+=Ext.String.format(' <a href="#" class="manage-timebox-link">Add a new {0}</a>.</span>',capitalizedLabel)),this.on("afterrender",function(cmp){var linkEl=cmp.getEl().down(".manage-timebox-link");linkEl&&this.mon(linkEl,"click",this._onManageLinkClick,this)},this),this.html=html},_onManageLinkClick:function(){var context=this.getContext(),timeboxLower=this.timeboxType.toLowerCase();"iteration"===timeboxLower&&context.getSubscription().isHsEdition()||context.getSubscription().isExpressEdition()?Rally.nav.Manager.manageIterations(this.context):Rally.nav.Manager.create(timeboxLower,{project:this.context.getProject().ObjectID})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.TimeboxScopedApp",{extend:Rally.app.App,scopeType:null,noScopeMsg:null,createScopeMsg:null,comboboxConfig:null,supportsUnscheduled:!0,items:[{xtype:"container",cls:"header"}],initComponent:function(){this._hasScope()&&(this.items=[]),this.callParent([])},launch:function(){var context=this.getContext();this._hasScope()?(this.onScopedDashboard=!0,this.onTimeboxScopeChange(context.getTimeboxScope())):(this.onScopedDashboard=!1,this._addScopeComboBox())},isOnScopedDashboard:function(){return this.onScopedDashboard},onTimeboxScopeChange:function(timeboxScope){timeboxScope&&timeboxScope.getType()===this.scopeType&&(this.callParent(arguments),this.down("#unscheduledBlankSlate")&&this.remove(this.down("#unscheduledBlankSlate")),null!==timeboxScope.getRecord()||this.supportsUnscheduled?this.onScopeChange(timeboxScope):this._addUnscheduledBlankSlate())},onScopeChange:Ext.emptyFn,onNoAvailableTimeboxes:Ext.emptyFn,getHeader:function(){return this.down("container[cls=header]")},isShowingBlankSlate:function(){return null!==this.down("#blankSlate")},_hasScope:function(){var context=this.getContext();return context.getTimeboxScope()&&context.getTimeboxScope().getType()===this.scopeType},_addScopeComboBox:function(){var xtype="rally"+this.scopeType+"combobox",defaultComboBoxConfig={xtype:xtype,stateful:!0,stateId:this.getContext().getScopedStateId("scoping"),storeConfig:{context:{project:Rally.util.Ref.getRelativeUri(this.getContext().getDataContext().project),workspace:Rally.util.Ref.getRelativeUri(this.getContext().getDataContext().workspace)}},plugins:[{ptype:"rallycomboboxrealtimeupdate",realtimeContext:this.getContext()}],listeners:{ready:this._onScopeComboBoxReady,select:this._onScopeComboBoxChange,scope:this},allowNoEntry:this.supportsUnscheduled},header=this.getHeader();header&&header.add(Ext.merge(defaultComboBoxConfig,this.comboboxConfig))},_onScopeComboBoxChange:function(comboBox){this._changeScope(comboBox)},_onScopeComboBoxReady:function(comboBox){var noTimeboxesCount=comboBox.allowNoEntry?1:0;comboBox.getStore().getCount()>noTimeboxesCount?this._changeScope(comboBox):this._addBlankSlate()},_changeScope:function(comboBox){var wasShowingBlankSlate=this.isShowingBlankSlate();wasShowingBlankSlate&&this._removeBlankSlate(),this.getContext().setTimeboxScope(Ext.create("Rally.app.TimeboxScope",{record:comboBox.getRecord(),type:this.scopeType})),this.onTimeboxScopeChange(this.getContext().getTimeboxScope())},_removeBlankSlate:function(){this.remove(this.down("#blankSlate"))},_addBlankSlate:function(){this.add({itemId:"blankSlate",xtype:"rallytimeboxblankslate",timeboxType:this.scopeType,context:this.getContext()}),this.onNoAvailableTimeboxes()},_addUnscheduledBlankSlate:function(){this.add({itemId:"unscheduledBlankSlate",xtype:"container",cls:"no-data-container",items:[{xtype:"component",cls:"primary-message",tpl:"No {scopeType} selected.",data:{scopeType:this.scopeType}},{xtype:"component",cls:"secondary-message",tpl:"Select {timebox} above to view {appName}.",data:{timebox:"iteration"===this.scopeType?"an iteration":"a release",appName:this.appName}}]}),this.onNoAvailableTimeboxes()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardCollectionAddRemoveExisting",{alias:"plugin.rallygridboardcollectionaddremoveexisting",extend:Ext.AbstractPlugin,mixins:[Rally.app.Scopeable],init:function(gridboard){this.callParent(arguments),this.isProjectEditor()&&gridboard.getHeader().getLeft().add({xtype:"rallybutton",cls:"secondary rly-small",handler:function(){this.onChooseClick().then({success:function(){Ext.create("Rally.ui.dialog.ArtifactCollectionChooserDialog",Ext.merge({collectionStoreToAddTo:this.collectionStoreToAddTo,listeners:{addsuccess:{fn:this._refreshGridStore,scope:this}}},this.chooserDialogConfig))},scope:this})},margin:"3 9 0 7",scope:this,text:"Choose"}),this.cmpOnRecordMenuCopy=gridboard.gridConfig&&gridboard.gridConfig.onRecordMenuCopy,this.cmpOnRecordMenuRemove=gridboard.gridConfig&&gridboard.gridConfig.onRecordMenuRemove,this.cmpRowActionColumnShouldBeRemovable=gridboard.gridConfig&&gridboard.gridConfig.rowActionColumnConfig&&gridboard.gridConfig.rowActionColumnConfig.menuOptions&&gridboard.gridConfig.rowActionColumnConfig.menuOptions.shouldBeRemovable,_.merge(gridboard,{gridConfig:{onRecordMenuCopy:Ext.bind(this._onRecordMenuCopy,this),onRecordMenuRemove:Ext.bind(this._onRecordMenuRemove,this),rowActionColumnConfig:{menuOptions:{collectionStore:this.collectionStoreToAddTo,shouldBeRemovable:Ext.bind(this._rowActionColumnShouldBeRemovable,this)}}}}),gridboard.on("recordcreate",this._refreshCollectionStore,this)},onChooseClick:function(){return Deft.Promise.when()},_onRecordMenuCopy:function(){Ext.isFunction(this.cmpOnRecordMenuCopy)&&this.cmpOnRecordMenuCopy.call(this.cmp),this._refreshCollectionStore()},_onRecordMenuRemove:function(){Ext.isFunction(this.cmpOnRecordMenuRemove)&&this.cmpOnRecordMenuRemove.call(this.cmp),this._refreshGridStore()},_refreshCollectionStore:function(){this.collectionStoreToAddTo.reload()},_refreshGridStore:function(){this.cmp.getGridOrBoard().refresh()},_rowActionColumnShouldBeRemovable:function(record){var shouldBeRemovable=!Ext.isFunction(this.cmpRowActionColumnShouldBeRemovable)||this.cmpRowActionColumnShouldBeRemovable.call(this.cmp,record);return shouldBeRemovable&&!!this.collectionStoreToAddTo.findRecord("_ref",record.get("_ref"))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.PropertyFieldComboBox",{alias:"widget.rallypropertyfieldcombobox",extend:Rally.ui.combobox.ComboBox,defaultBlackListFields:["DirectChildrenCount","DisplayColor","DragAndDropRank","ObjectUUID","Subscription","TestCase","TestCaseResult","VersionId","ObjectID"],defaultWhiteListFields:[],config:{autoExpand:!0,defaultSelectionPosition:null,displayField:"displayName",valueField:"name",model:void 0,context:void 0,listConfig:{hideMode:"display",itemTpl:new Ext.XTemplate("{displayName}",'<tpl if="this.hasModelNames(values)">','<div class="duplicate-field-model-name">- {modelNames}</div>',"</tpl>",{hasModelNames:function(data){return data.modelNames.length>0}})},blackListFields:[],whiteListFields:[],additionalFields:[]},constructor:function(config){this.mergeConfig(config),this.config.store=this._getFilterableFieldsStore(),this.callParent([this.config])},_getFilterableFieldsStore:function(){return{fields:["displayName","modelNames","name"],data:this._getFilterableFields()}},_getFilterableFields:function(){var fields=_.filter(this._getAllFields(),this._shouldShowField,this);return _(fields).map(function(field){return{displayName:Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(field),modelNames:this._getModelNamesForDuplicates(field,fields),name:field.name}},this).sortBy("displayName").value()},_getAllFields:function(){return _.merge({},this.model.getFields(),this.additionalFields)},_getModelNamesForDuplicates:function(field,fields){var fieldCounts=_.countBy(fields,"displayName");return fieldCounts[field.displayName]>1?_.pluck(this.model.getModelsForField(field),"displayName").join(", "):""},_shouldShowField:function(field){var blackListFields=_.union(this.blackListFields,this.defaultBlackListFields),whiteListFields=_.union(this.whiteListFields,this.defaultWhiteListFields),isBlackListed=_.contains(blackListFields,field.name),isWhiteListed=_.contains(whiteListFields,field.name),isAdditionalField=_.contains(_.map(this.additionalFields,"name"),field.name),isFilterable=!1,isMultiValueCustom=!1;return field.attributeDefinition&&(isFilterable=field.attributeDefinition.Filterable,isMultiValueCustom=field.isMultiValueCustom()),isWhiteListed||isAdditionalField&&!isBlackListed||isMultiValueCustom&&!isBlackListed&&!field.hidden||isFilterable&&!isBlackListed&&!field.hidden&&!field.isCollection()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.FieldPopover",{alias:"widget.rallyfieldpopover",extend:Rally.ui.popover.Popover,id:"field-popover",cls:"field-popover",header:!1,height:300,offsetFromTarget:[{x:0,y:-10},{x:15,y:0},{x:0,y:10},{x:-15,y:0}],config:{fieldComboBoxConfig:{}},initComponent:function(){var me=this;this.callParent(arguments),this.add(Ext.merge({xtype:"rallypropertyfieldcombobox",itemId:"addQuickFilterComboBox",collapse:Ext.emptyFn,enableKeyEvents:!0,margin:"10px 0 0 0",width:180,triggerCls:"icon-search",listConfig:{floating:!1,maxHeight:250,width:180,renderTo:"field-popover-innerCt"},listeners:{afterrender:function(combobox){combobox.expand()},scope:this},onKeyDown:function(e){e.getKey()===Ext.EventObject.ESC&&me.destroy()}},this.fieldComboBoxConfig))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.WorkspaceScopeField",{alias:"widget.rallyworkspacescopefield",extend:Rally.ui.combobox.ComboBox,cls:"workspace-scope-combobox",config:{queryMode:"local",store:{fields:["label","value"],data:[{label:"Current Workspace",value:"current"}]},fieldLabel:"Scope",width:120,displayField:"label",valueField:"value",editable:!1,forceSelection:!0,allowNoEntry:!0,noEntryValue:"/scope/-1",noEntryText:"All Workspaces"},getFilter:function(){return"current"===this.lastValue?new Rally.data.wsapi.Filter({property:"WorkspacePermission",operator:"!=",value:"No Access"}):new Rally.data.wsapi.Filter({property:"ObjectID",operator:"!=",value:null})},reset:function(){this.setValue(this.noEntryValue)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.ArtifactSearchField",{alias:"widget.rallyartifactsearchfield",extend:Rally.ui.TextField,fieldLabel:"Search",emptyText:"Search...",config:{model:void 0,context:void 0},_isValidField:function(model,fieldNames){var validFields=_.pluck(model.getFields(),"name");return fieldNames.every(function(fieldName){return _.contains(validFields,fieldName)})},getFilter:function(){var value=this.lastValue;if(!Ext.isEmpty(value)){var filters=[],models=this.model.getArtifactComponentModels(),onlyNumbers=new RegExp("^(\\d+)$");return onlyNumbers.test(value)&&this._isValidField(this.model,["FormattedID"])&&filters.push({property:"FormattedID",operator:"contains",value:value}),_.each(models,function(model){var prefixPlusNumbers=new RegExp(Ext.String.format("^({0}\\d+)$",model.idPrefix),"i");prefixPlusNumbers.test(value)&&model.isArtifact()?filters.push(Rally.data.wsapi.Filter.and([{property:"TypeDefOid",operator:"=",value:model.typeDefOid},{property:"FormattedID",operator:"contains",value:value}])):prefixPlusNumbers.test(value)&&this._isValidField(model,["FormattedID"])&&filters.push({property:"FormattedID",operator:"contains",value:value})},this),this._isValidField(this.model,["Name"])&&filters.push({property:"Name",operator:"contains",value:value}),this._isValidField(this.model,["Description"])&&filters.push({property:"Description",operator:"contains",value:value}),Rally.data.wsapi.Filter.or(filters)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.UserSearchField",{alias:"widget.rallyusersearchfield",extend:Rally.ui.inlinefilter.ArtifactSearchField,allowBlank:!0,getFilter:function(){var value=this.lastValue;if(!Ext.isEmpty(value))return Rally.data.wsapi.Filter.or([{property:"UserName",operator:"contains",value:value},{property:"DisplayName",operator:"contains",value:value},{property:"EmailAddress",operator:"contains",value:value},{property:"FirstName",operator:"contains",value:value},{property:"LastName",operator:"contains",value:value}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.SearchComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallysearchcombobox",config:{editable:!0,typeAhead:!0,queryMode:"remote",minChars:0,forceSelection:!0,selectOnFocus:!0,emptyText:"Search...",allowNoEntry:!0,noEntryText:"-- None --",listConfig:{overflowX:"hidden"},storeConfig:{autoLoad:!1,models:[],pageSize:10,remoteFilter:!0,sorters:{property:"Name",direction:"DESC"}}},constructor:function(config){if(config=config||{},this.mergeConfig(config),this.config.value){var initialFilter=Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",operator:"=",value:Rally.util.Ref.getOidFromRef(config.value)});this.config.storeConfig.filters=[initialFilter]}this.callParent([this.config])},initComponent:function(){var autoLoadStore=this.storeConfig&&this.storeConfig.autoLoad;this.callParent(arguments),autoLoadStore||this.onReady()},doQuery:function(queryString,forceAll,rawQuery){if(""===queryString)return this.callParent(["",!0,rawQuery]);var filter=Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"contains",value:queryString});this.store.filters=this.store.filters.filterBy(function(item){return"Name"!==item.property}),this.store.filters.add(filter),this.callParent([filter.toString(),!0,rawQuery])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.FilterFieldFactory",{singleton:!0,getFieldConfig:function(model,fieldName,context){var baseEditorConfig=this[fieldName]||{};Ext.applyIf(baseEditorConfig,{name:fieldName,fieldLabel:fieldName,allowBlank:!1});var fieldDef=model.getField(fieldName);return fieldDef&&(baseEditorConfig=Ext.applyIf(this._getBaseEditorConfig(fieldDef,context,model),baseEditorConfig),"object"===fieldDef.getType()&&(baseEditorConfig.allowBlank=!0,baseEditorConfig.triggerCls="icon-search"),"collection"===fieldDef.getType()&&(baseEditorConfig.triggerCls="icon-search"),fieldDef.custom&&(baseEditorConfig.allowBlank=!fieldDef.required),fieldDef.attributeDefinition&&fieldDef.attributeDefinition.Constrained&&("object"!==fieldDef.getType()&&"collection"!==fieldDef.getType()||(baseEditorConfig.valueField="_uuidRef"),fieldDef.custom&&!fieldDef.required&&(baseEditorConfig.allowNoEntry=!0,baseEditorConfig.noEntryValue="/none/-1")),baseEditorConfig.emptyText=Ext.String.format("Filter by {0}...",Rally.ui.renderer.FieldDisplayNameRenderer.getDisplayName(fieldDef))),baseEditorConfig.allowNoEntry&&!baseEditorConfig.noEntryValue&&(baseEditorConfig.noEntryValue="/none/-1"),_.contains(baseEditorConfig.xtype,"combobox")&&Ext.merge(baseEditorConfig,{listeners:{beforerender:function(combobox){combobox.refreshStore()}}}),_.merge({},baseEditorConfig,{autoExpand:!1,context:context,plugins:["rallyfieldvalidationui"],defaultSelectionPosition:null,storeConfig:{autoLoad:!1}})},getInitialValueForLegacyFilter:function(fieldConfig,initialValue){return(fieldConfig.allowNoEntry||fieldConfig.allowBlank)&&(_.isNull(initialValue)||_.isEmpty(initialValue)&&_.isString(initialValue))&&!_.isUndefined(fieldConfig.noEntryValue)?fieldConfig.noEntryValue:initialValue},getFieldConfigForLegacyFilter:function(fieldConfig,initialValue){if(initialValue===fieldConfig.noEntryValue)return fieldConfig;var isRefUri=Rally.util.Ref.isRefUri(initialValue),isRefOid=_.isNumber(Rally.util.Ref.getOidFromRef(initialValue));return isRefUri&&isRefOid&&"_uuidRef"===fieldConfig.valueField?Ext.merge(fieldConfig,{valueField:"_ref"}):fieldConfig},_getBaseEditorConfig:function(fieldDef,context,model){var editorConfig={},numericFieldTypes=["quantity","integer"];if("text"===fieldDef.getType())editorConfig={xtype:"rallytextfield"};else if("Tags"===fieldDef.name)editorConfig={xtype:"rallytagcombobox",allowNoEntry:!1,valueField:"_uuidRef",hideLabel:!0};else if("Milestones"===fieldDef.name)editorConfig={xtype:"rallymilestonecombobox",valueField:"_uuidRef"};else if("Parent"===fieldDef.name&&"Project"===fieldDef.attributeDefinition.SchemaType)editorConfig={xtype:"rallyprojectcombobox",valueField:"_uuidRef",allowNoEntry:!0,noEntryText:"-- No Parent --"};else if(fieldDef.attributeDefinition.Custom===!0&&"COLLECTION"===fieldDef.attributeDefinition.AttributeType){var allowedValueStore=fieldDef.getAllowedValueStore({autoLoad:!1,remoteFilter:!1,remoteSort:!1,limit:1/0});editorConfig={xtype:"rallycombobox",store:allowedValueStore,displayField:"StringValue"}}else!fieldDef.editor&&fieldDef.attributeDefinition.AllowedValueType._ref?(editorConfig={xtype:"rallyartifactsearchcombobox",allowNoEntry:!0,valueField:"_uuidRef",storeConfig:{models:[fieldDef.attributeDefinition.AllowedValueType._refObjectName],context:{workspace:context.getDataContext().workspace,project:null}}},"Requirement"===fieldDef.name?editorConfig.storeConfig.models=["userstory"]:"WorkProduct"===fieldDef.name?this._isTestCase(model)?editorConfig.storeConfig.models=["userstory","defect"]:this._isTask(model)&&(editorConfig.storeConfig.models=["userstory","defect","testset","defectsuite"]):"TestFolder"===fieldDef.name?Ext.merge(editorConfig,{storeType:"Rally.data.wsapi.Store",storeConfig:{model:editorConfig.storeConfig.models[0],models:void 0}}):"BuildDefinition"===fieldDef.name&&Ext.merge(editorConfig,{xtype:"rallysearchcombobox",allowNoEntry:!1,storeConfig:{model:editorConfig.storeConfig.models[0],models:void 0}})):_.contains(numericFieldTypes,fieldDef.getType())?(editorConfig=this._getClonedEditorConfig(fieldDef),editorConfig.hideTrigger=!1):editorConfig=this._getClonedEditorConfig(fieldDef);return Ext.apply(editorConfig,{fieldLabel:fieldDef.displayName}),editorConfig},_getClonedEditorConfig:function(fieldDef){var editorConfig=_.clone(fieldDef.editor);return editorConfig&&editorConfig.field&&editorConfig.field.xtype&&(editorConfig=_.clone(editorConfig.field)),editorConfig},_isTask:function(model){return _.some(_.invoke(this._getModels(model),"isTask"))},_isTestCase:function(model){return _.some(_.invoke(this._getModels(model),"isTestCase"))},_getModels:function(model){return model.getArtifactComponentModels?model.getArtifactComponentModels():[model];
},ScheduleState:{multiSelect:!0,allowClear:!1,getFilter:function(){return Rally.data.wsapi.Filter.or(_.map(this.lastValue,function(value){return{property:"ScheduleState",operator:"=",value:value}},this))}},Owner:{allowNoEntry:!0,noEntryValue:"/user/-1",includeWorkspaceUsers:!0},SubmittedBy:{allowNoEntry:!0,noEntryValue:"/user/-1",includeWorkspaceUsers:!0},ArtifactSearch:{xtype:"rallyartifactsearchfield"},UserSearch:{xtype:"rallyusersearchfield",emptyText:"Filter by Username, Email etc..."},WorkspaceScope:{xtype:"rallyworkspacescopefield",allowClear:!1,value:"/scope/-1"},ModelType:{xtype:"rallymodeltypepicker",fieldLabel:"Type",emptyText:"Filter by Type...",allowClear:!1},Tags:{triggerAction:"all"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.ToggleAdvancedButton",{alias:"widget.rallytoggleadvancedbutton",extend:Rally.ui.Button,cls:"toggle-advanced-button rly-small secondary",config:{advancedCollapsed:!0,numFilters:0},initComponent:function(){this.callParent(arguments),this._updateText(),this.on({advancedcollapse:this._onAdvancedToggle,advancedexpand:this._onAdvancedToggle,scope:this})},_updateText:function(){Ext.suspendLayouts(),this.setText(this.advancedCollapsed?"Advanced Filters":"Hide Advanced"),this.addCls(this.advancedCollapsed?"secondary":"primary"),this.removeCls(this.advancedCollapsed?"primary":"secondary"),Ext.resumeLayouts(!1)},_onAdvancedToggle:function(advancedFilterPanel){this.advancedCollapsed=!!advancedFilterPanel.collapsed,this._updateText()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.ModelTypePicker",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallymodeltypepicker",config:{valueField:"TypePath",displayField:"Name",model:void 0,multiSelect:!0,autoSelect:!1,defaultSelectionPosition:null},constructor:function(config){this.mergeConfig(config),this.config.store=this.config.store||this._getModelTypeStore(),this.callParent([this.config])},_getModelTypeStore:function(){var models=this.model.getArtifactComponentModels()||[this.model];return{fields:["Name","TypePath"],data:_.map(models,function(model){return{Name:model.displayName,TypePath:model.typePath}})}},reset:function(){delete this.originalValue,this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.QuickFilterPanel",{extend:Ext.Container,alias:"widget.rallyquickfilterpanel",mixins:[Rally.clientmetrics.ClientMetricsRecordable],cls:"quick-filter-panel",layout:"column",bubbleEvents:["filterchange"],config:{autoExpand:!1,model:void 0,context:void 0,matchType:"AND",defaultFields:[],fields:[],initialTypes:[],initialFilters:[],toggleAdvancedButtonConfig:{},addQuickFilterConfig:{}},initComponent:function(){this.items=this._getItems(),this.callParent(arguments)},getTypes:function(){var modelTypePicker=_.find(this.fields,{name:"ModelType"});return modelTypePicker?modelTypePicker.getValue():[]},getTypesFilter:function(){var types=this.getTypes(),filterIndex=_.findIndex(this.fields,{name:"ModelType"})+1;return Ext.isEmpty(types)?null:Ext.apply(Rally.data.wsapi.Filter.or(_.map(types,function(type){var typeDefOid=this.model.getArtifactComponentModel(type).typeDefOid;return{property:"TypeDefOid",operator:"=",value:typeDefOid}},this)),{filterIndex:filterIndex})},getFilters:function(){var filters=[];return _.each(this.fields,function(field,index){if("ModelType"!==field.name&&!Ext.isEmpty(field.lastValue)&&!field.hasActiveError()){var lastValue=field.lastValue,isRefUri=Rally.util.Ref.isRefUri(lastValue),isRefOid=_.isNumber(Rally.util.Ref.getOidFromRef(lastValue));if(isRefUri&&isRefOid&&"_ref"===field.valueField&&field.noEntryValue!==lastValue){var record=field.getRecord();if(record){var uuidRef=record.get("_uuidRef");uuidRef&&(lastValue=uuidRef)}}var filter=_.isFunction(field.getFilter)?field.getFilter():Rally.data.wsapi.Filter.fromExtFilter({property:field.name,operator:field.operator,value:lastValue});filter&&(field.allowNoEntry&&field.noEntryValue===lastValue&&(filter.value=null),Ext.apply(filter,{name:field.name,rawValue:lastValue,filterIndex:index+1}),filters.push(filter))}},this),filters},clear:function(){_.each(this.fields,function(field){field.originalValue=void 0,field.reset()},this)},clearInvalidFields:function(){_.each(this.fields,function(field){field.isValid()||field.reset()})},getSelectedFields:function(){return _.map(this.fields,"name")},_getItems:function(){return this._createFields(),this._createToggleAdvancedButton(),this._createAddQuickFilterButton(),this.fields.concat(this.addQuickFilterButton,this.toggleAdvancedButton)},_getOperatorForModelField:function(modelField){var operator="=";return modelField&&modelField.isCollection&&modelField.isCollection()&&(operator="contains"),operator},_createField:function(filterIndex,field,initialValues){var fieldName=field.name||field,modelField=this.model.getField(fieldName),fieldConfig=Rally.ui.inlinefilter.FilterFieldFactory.getFieldConfig(this.model,fieldName,this.context),initialValue=initialValues&&initialValues[fieldConfig.name]&&initialValues[fieldConfig.name].rawValue;return modelField&&modelField.isDate()&&initialValue&&(initialValue=Rally.util.DateTime.fromIsoString(initialValue)),initialValue=Rally.ui.inlinefilter.FilterFieldFactory.getInitialValueForLegacyFilter(fieldConfig,initialValue),fieldConfig=Rally.ui.inlinefilter.FilterFieldFactory.getFieldConfigForLegacyFilter(fieldConfig,initialValue),Ext.applyIf(fieldConfig,{allowClear:!0}),Ext.merge(fieldConfig,{autoExpand:this.autoExpand,allowBlank:!0,clearText:"-- Clear Filter --",hideLabel:!1,fieldLabel:" ",labelAlign:"top",labelSeparator:"",enableKeyEvents:!0,margin:0,cls:this.isCustomMatchType()?"indexed-field":"",beforeLabelTextTpl:['<span class="filter-index">{[this.getFilterIndex()]}</span>',{filterIndex:filterIndex,displayIndex:this.isCustomMatchType(),getFilterIndex:function(){return this.displayIndex?Ext.String.format("({0}) ",this.filterIndex):""}}],model:this.model,context:this.context,operator:this._getOperatorForModelField(modelField),afterSubTpl:'<span class="remove-quick-filter-icon icon-cross"></span>',renderSelectors:{removeIcon:".remove-quick-filter-icon"},listeners:{afterrender:function(field){field.removeIcon.on("click",_.partial(this._removeQuickFilter,field),this)},scope:this}}),_.isUndefined(initialValue)||Ext.merge(fieldConfig,{value:initialValue}),_.isPlainObject(field)&&Ext.apply(fieldConfig,field),1===filterIndex&&(fieldConfig.itemId=this.self.FOCUS_CMP_ITEM_ID),this._shouldApplyFiltersOnSelect(fieldConfig)?Ext.merge(fieldConfig,{autoSelect:!0,listeners:{select:this._applyFilters,scope:this}}):Ext.merge(fieldConfig,{listeners:{change:this._applyFilters,scope:this}}),Ext.widget(fieldConfig)},_createFields:function(){var filterIndex=0,initialValues=_.indexBy(this.initialFilters,"name");Ext.merge(initialValues,{ModelType:{rawValue:this.initialTypes}}),this.fields=_.map(this.fields.length?this.fields:this.defaultFields,function(field){return filterIndex++,this._createField(filterIndex,field,initialValues)},this)},focusFirstField:function(){var focusCmp=_.first(this.fields);focusCmp&&focusCmp.focus(!0)},_removeQuickFilter:function(field){this.recordAction({description:"quick filter removed",miscData:{field:field.name||field}});var arrayIndex=field.beforeLabelTextTpl.filterIndex-1;this.fields[arrayIndex].destroy(),this.fields.splice(arrayIndex,1),this.updateFilterIndices(),this.fireEvent("quickfilterchange",field,this)},_shouldApplyFiltersOnSelect:function(fieldConfig){var field=this.model.getField(fieldConfig.name),attributeDefinition=field&&field.attributeDefinition;return attributeDefinition&&(attributeDefinition.Constrained||"OBJECT"===attributeDefinition.AttributeType)&&!fieldConfig.multiSelect},_onMatchTypeChange:function(matchType){this.updateFilterIndices(matchType.getValue())},isCustomMatchType:function(){return"CUSTOM"===this.matchType},updateFilterIndices:function(matchType){this.matchType=matchType||this.matchType,_.each(this.fields,function(field,index){field.beforeLabelTextTpl.displayIndex=this.isCustomMatchType(),field.beforeLabelTextTpl.filterIndex=index+1,field.beforeLabelTextTpl.overwrite(field.labelEl.down(".filter-index")),this.isCustomMatchType()?field.addCls("indexed-field"):field.removeCls("indexed-field"),Ext.isIE10m&&field.inputEl&&field.setValue(field.getValue())},this)},_applyFilters:function(){this.fireEvent("filterchange",this)},_createToggleAdvancedButton:function(){this.toggleAdvancedButton=Ext.widget(Ext.merge({xtype:"rallytoggleadvancedbutton",listeners:{click:this._onToggleAdvanced,scope:this}},this.toggleAdvancedButtonConfig))},_createAddQuickFilterButton:function(){this.addQuickFilterButton=Ext.widget({xtype:"rallybutton",text:"+ Add Filter",margin:"0 0 10px 0",listeners:{click:this._onAddQuickFilterClick,scope:this}})},_onToggleAdvanced:function(){this.fireEvent("toggleadvanced",this.toggleAdvancedButton)},_onAddQuickFilterClick:function(){var addQuickFilterConfig=Ext.clone(this.addQuickFilterConfig),blackList=_.map(this.fields,"name");addQuickFilterConfig&&addQuickFilterConfig.whiteListFields&&(addQuickFilterConfig.whiteListFields=_.reject(this.addQuickFilterConfig.whiteListFields,function(field){return _.contains(blackList,field)})),this.addQuickFilterPopover=Ext.create("Rally.ui.popover.FieldPopover",{target:this.addQuickFilterButton.getEl(),placement:["bottom","top","left","right"],fieldComboBoxConfig:_.merge({model:this.model,context:this.context,emptyText:"Search filters...",additionalFields:[{name:"ArtifactSearch",displayName:"Search"},{name:"ModelType",displayName:"Type"}],blackListFields:blackList,listeners:{select:function(field,value){var fieldSelected=value[0].raw;this.recordAction({description:"quick filter added",miscData:{field:fieldSelected.name||fieldSelected}}),this.addQuickFilterPopover.close(),this._onAddQuickFilterSelect(fieldSelected)},destroy:function(){delete this.addQuickFilterPopover},scope:this}},addQuickFilterConfig,function(a,b){if(_.isArray(a))return a.concat(b)})})},_onAddQuickFilterSelect:function(field){var index=this.fields.length,newItem=this._createField(index+1,field);this.fields.push(newItem),this.insert(index,newItem),this.fireEvent("quickfilterchange",field,this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.OperatorFieldComboBox",{alias:"widget.rallyoperatorfieldcombobox",extend:Rally.ui.combobox.ComboBox,config:{editable:!1,defaultSelectionPosition:"first",forceSelection:!1,displayField:"displayName",valueField:"name",property:void 0,additionalOperators:[],model:void 0,context:void 0,listeners:{beforerender:function(combobox){combobox.refreshStore()}}},constructor:function(config){this.mergeConfig(config),this.config.store=this._getAllowedQueryOperatorStore(),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.onReady()},_getAllowedQueryOperatorStore:function(){var storeConfig={fields:["name","displayName","OperatorName"],filters:[{property:"OperatorName",operator:"!=",value:"containsall"},{property:"OperatorName",operator:"!=",value:"containsany"}],listeners:{load:function(store,records){_.each(records,function(record){var operatorName=record.get("OperatorName");record.set("name",operatorName),record.set("displayName",store.shouldReplaceOperatorName?operatorName.replace("contains","="):operatorName),record.commit(!1)},this),store.add(this.additionalOperators),store.commitChanges()},scope:this}};if(this.property){var field=this.model.getField(this.property),store=field.getAllowedQueryOperatorStore();store&&(storeConfig.autoLoad=!1,storeConfig.proxy=store.proxy.clone(),storeConfig.shouldReplaceOperatorName=field.isCollection())}return Ext.create("Ext.data.Store",storeConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.AdvancedFilterRow",{alias:"widget.rallyadvancedfilterrow",extend:Ext.Container,layout:"hbox",bubbleEvents:["filterchange"],cls:"advanced-filter-row",config:{context:void 0,model:void 0,autoExpand:!1,name:void 0,operator:void 0,rawValue:void 0,addButtonEnabled:!1,removeButtonEnabled:!1,propertyFieldConfig:{},operatorFieldConfig:{},focusPropertyField:!1},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.items=this._getItems(),this.callParent(arguments),this.on("boxready",function(){this.indexLabel.el.show(),this.focusPropertyField&&this.propertyField.focus()},this,{single:!0})},disableAddRow:function(){this.addRowButton.disable()},enableAddRow:function(){this.addRowButton.enable()},isValid:function(){return this._hasPropertySelected()&&this._hasOperatorSelected()&&this._valueFieldIsValid()},getFilter:function(){if(this.isValid()){var property=this.propertyField.lastValue,operator=this.operatorField.lastValue,valueField=this.valueField,lastValue=Ext.isEmpty(valueField.lastValue)?null:valueField.lastValue,isRefUri=Rally.util.Ref.isRefUri(lastValue),isRefOid=_.isNumber(Rally.util.Ref.getOidFromRef(lastValue));if(isRefUri&&isRefOid&&"_ref"===valueField.valueField&&valueField.noEntryValue!==lastValue){var record=valueField.getRecord();if(record){var uuidRef=record.get("_uuidRef");uuidRef&&(lastValue=uuidRef)}}var filter=Rally.data.wsapi.Filter.fromExtFilter({property:property,operator:operator,value:lastValue});return valueField.allowNoEntry&&valueField.noEntryValue===lastValue&&(filter.value=null),Ext.apply(filter,{name:property,rawValue:lastValue,filterIndex:this.filterIndex}),filter}},setIndex:function(filterIndex){this.filterIndex=filterIndex,this.indexLabel.setText(this._getFilterIndexText(filterIndex)),this.addCls("indexed"),filterIndex>=10?this.addCls("indexed-ten"):this.removeCls("indexed-ten"),this._fixPropertyFieldInIE()},clearIndex:function(){delete this.filterIndex,this.indexLabel.setText(""),this.removeCls("indexed"),this.removeCls("indexed-ten"),this._fixPropertyFieldInIE()},removeIfInvalid:function(){this._valueFieldIsValid()||this._removeRow(!1)},_fixPropertyFieldInIE:function(){Ext.isIE10m&&this.propertyField.inputEl&&this.propertyField.setValue(this.propertyField.getValue())},_createPropertyField:function(){this.propertyField=Ext.widget(Ext.merge({xtype:"rallypropertyfieldcombobox",itemId:"propertyField",autoExpand:this.autoExpand,cls:"indexed-field property-field",width:150,labelAlign:"top",fieldLabel:"FIELD",labelSeparator:"",emptyText:"Choose Field...",value:this.name,model:this.model,context:this.context,listeners:{select:this._onPropertySelect,specialkey:this._onPropertySpecialKey,scope:this}},this.propertyFieldConfig))},_createOperatorField:function(){this.operatorField=Ext.widget(Ext.merge({xtype:"rallyoperatorfieldcombobox",itemId:"operatorField",cls:"operator-field",width:80,autoExpand:this.autoExpand,labelAlign:"top",fieldLabel:"OPERATOR",labelSeparator:"",matchFieldWidth:!0,disabled:!this._hasPropertySelected(),property:this._hasPropertySelected()?this.propertyField.getValue():void 0,value:this.operator,model:this.model,context:this.context,listeners:{select:this._onOperatorSelect,scope:this}},this.operatorFieldConfig))},_createValueField:function(){var field,fieldConfig={},initialValue=this.rawValue;if(this._hasPropertySelected()){var model=this.model,property=this.propertyField.getValue();field=model.getField(property),field.isDate()&&initialValue&&(initialValue=Rally.util.DateTime.fromIsoString(initialValue)),Ext.apply(fieldConfig,Rally.ui.inlinefilter.FilterFieldFactory.getFieldConfig(model,property,this.context)),initialValue=Rally.ui.inlinefilter.FilterFieldFactory.getInitialValueForLegacyFilter(fieldConfig,initialValue),fieldConfig=Rally.ui.inlinefilter.FilterFieldFactory.getFieldConfigForLegacyFilter(fieldConfig,initialValue),this._shouldApplyFiltersOnSelect(property)?Ext.merge(fieldConfig,{autoExpand:this.autoExpand&&this._shouldAutoExpand(field),autoSelect:!0,enableKeyEvents:!0,listeners:{select:this._applyFilters,scope:this}}):field.isDate()?Ext.merge(fieldConfig,{validateOnChange:!0,enableKeyEvents:!0,listeners:{focus:function(datefield){this.autoExpand&&datefield.expand()},blur:this._applyFilters,change:this._applyFilters,select:this._applyFilters,scope:this}}):Ext.merge(fieldConfig,{listeners:{change:this._applyFilters,scope:this}})}Ext.merge(fieldConfig,{xtype:fieldConfig.xtype||"textfield",itemId:"valueField",cls:"value-field",flex:1,labelAlign:"top",fieldLabel:"VALUE",labelSeparator:"",hideLabel:!1,forceSelection:!0,allowBlank:field&&this._allowBlank(field),allowClear:!1,multiSelect:!1,disabled:!this._hasPropertySelected(),isValid:function(preventMark){var isValid,pm=this.preventMark;return preventMark&&(this.preventMark=!0),isValid=this.superclass.isValid.apply(this,arguments),this.preventMark=pm,isValid}}),_.isUndefined(initialValue)||Ext.merge(fieldConfig,{value:initialValue}),this.valueField=Ext.widget(fieldConfig)},_allowBlank:function(field){return!(!field||field.attributeDefinition.Required||field.attributeDefinition.Constrained)&&["date","quantity","integer","string"].indexOf(field.getType())!==-1},_shouldAutoExpand:function(field){return!((field.isObject()||field.isCollection())&&"user"!==field.getAllowedValueType())},_shouldApplyFiltersOnSelect:function(fieldName){var field=this.model.getField(fieldName),attributeDefinition=field&&field.attributeDefinition;return attributeDefinition&&(attributeDefinition.Constrained||field.isObject()||field.isBoolean())},_createAddRowButton:function(){this.addRowButton=Ext.widget({xtype:"rallybutton",itemId:"addRowButton",userAction:"Add filter row clicked",cls:"primary rly-small icon-plus filter-row-control",margin:"0 5px 0 0",disabled:!this.addButtonEnabled,listeners:{click:this._addRow,buffer:200,scope:this}})},_createRemoveRowButton:function(){this.removeRowButton=Ext.widget({xtype:"rallybutton",itemId:"removeRowButton",userAction:"Remove filter row clicked",cls:"primary rly-small icon-minus filter-row-control",margin:"0 10px 0 0",disabled:!1,listeners:{click:this._removeRow,buffer:200,scope:this}})},_getFilterIndexText:function(filterIndex){return Ext.String.format("({0})",filterIndex)},_createIndexLabel:function(){this.indexLabel=Ext.widget({xtype:"label",itemId:"indexLabel",cls:"index-label",hidden:!0,listeners:{el:{click:function(){this.propertyField.expand()},scope:this},afterrender:{fn:function(){this.indexLabel.el.show()},scope:this,single:!0}},text:this._getFilterIndexText(this.filterIndex)})},_getItems:function(){return this._createAddRowButton(),this._createRemoveRowButton(),this._createIndexLabel(),this._createPropertyField(),this._createOperatorField(),this._createValueField(),[this.addRowButton,this.removeRowButton,this.indexLabel,this.propertyField,this.operatorField,this.valueField]},_hasPropertySelected:function(){return!!this.propertyField.getValue()},_hasOperatorSelected:function(){return!!this.operatorField.getValue()},_valueFieldIsValid:function(){var field=this.valueField;return!field.rendered||field.store&&Ext.isEmpty(field.store.getRange())?!!field.allowBlank||!Ext.isEmpty(field.lastValue):field.isValid(!0)},_addRow:function(){this.fireEvent("addrow",this)},_removeRow:function(autoFocus){this.fireEvent("removerow",this,{autoFocus:autoFocus!==!1})},_replaceOperatorField:function(){var deferred=new Deft.Deferred;return delete this.operator,this.operatorField.destroy(),this._createOperatorField(),this.operatorField.store.on("load",function(){deferred.resolve()}),this.add(this.operatorField),deferred.promise},_replaceValueField:function(){return delete this.rawValue,this.valueField.destroy(),this._createValueField(),this.add(this.valueField),Deft.Promise.when()},_onPropertySelect:function(){delete this.name,Deft.Promise.all([this._replaceOperatorField(),this._replaceValueField()]).then({success:function(){this._applyFilters(),this.valueField.focus(!1,200)},scope:this})},_onPropertySpecialKey:function(combo,e){e.getKey()===e.TAB&&this._valueIsAboutToChange(combo)&&e.stopEvent()},_onOperatorSelect:function(){this._applyFilters()},_applyFilters:function(){this.fireEvent("filterchange",this)},_valueIsAboutToChange:function(combo){var picker=combo.getPicker();return picker.highlightedItem&&picker.getRecord(picker.highlightedItem).get(combo.getValueField())!==combo.getValue()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.AdvancedFilterRows",{alias:"widget.rallyadvancedfilterrows",extend:Ext.Container,bubbleEvents:["filterchange"],layout:{type:"vbox",align:"stretch"},cls:"advanced-filter-rows",config:{autoExpand:!1,filterStartIndex:1,matchType:"AND",rowConfig:{},initialFilters:[]},initComponent:function(){this.items=this._getItems(),this.on("filterchange",this._toggleRowButtons,this),this.callParent(arguments)},getFilters:function(){return _(this.rows).invoke("getFilter").compact().value()},clear:function(){_.each(this.rows,function(row){this.remove(row)},this),this.rows=[],this._addRow()},updateFilterIndices:function(matchType,filterStartIndex){this.matchType=matchType,this.filterStartIndex=filterStartIndex||this.filterStartIndex,_.each(this.rows,function(row,i){"CUSTOM"===matchType?row.setIndex(this._getFilterIndex(i)):row.clearIndex()},this)},_getFilterIndex:function(filterIndex){return this.filterStartIndex+filterIndex},_getItems:function(){var items=[];return _.each(this.initialFilters,function(filter,i){var lastRow=i===this.initialFilters.length-1;items.push(Ext.merge(this._getRowConfig(),filter,{addButtonEnabled:lastRow,removeButtonEnabled:!0}))},this),Ext.isEmpty(items)&&items.push(this._getRowConfig()),this.rows=_.map(items,Ext.widget),this.updateFilterIndices(this.matchType),this.rows},_getRowConfig:function(){return Ext.merge({xtype:"rallyadvancedfilterrow",autoExpand:this.autoExpand,model:this.model,context:this.context,focusPropertyField:!1,operatorFieldConfig:this.operatorFieldConfig,propertyFieldConfig:this.propertyFieldConfig,listeners:{addrow:function(){this._addRow(!0)},removerow:this._removeRow,scope:this}},this.rowConfig)},_addRow:function(focusOnAdd){Ext.isEmpty(this.rows)||_.last(this.rows).disableAddRow();var row=Ext.widget(this._getRowConfig());row.focusPropertyField=!!focusOnAdd,this.rows.push(row),this.add(row),this.updateFilterIndices(this.matchType)},_removeRow:function(row,opts){var previousRowIndex=Math.max(0,_.findIndex(this.rows,row)-1);_.remove(this.rows,row),this.remove(row),Ext.isEmpty(this.rows)?this._addRow(opts.autoFocus!==!1):opts.autoFocus&&this.rows[previousRowIndex].valueField&&this.rows[previousRowIndex].valueField.focus();var lastRow=_.last(this.rows);lastRow.isValid()&&lastRow.enableAddRow(),this.updateFilterIndices(this.matchType),lastRow.fireEvent("filterchange",lastRow)},_toggleRowButtons:function(row){row.isValid()&&row===_.last(this.rows)?row.enableAddRow():row.disableAddRow()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.CustomFilterCondition",{extend:Rally.ui.TextField,alias:"widget.rallycustomfiltercondition",plugins:["rallyfieldvalidationui"],fieldLabel:"CUSTOM FILTER CONDITION ",labelSeparator:"",labelAlign:"top",bubbleEvents:["filterchange"],emptyText:"e.g. (1 AND 2) OR 3",cls:"custom-filter-condition",validateOnBlur:!0,validateOnChange:!1,allowBlank:!0,blankText:"This field is required with a Custom Match Filter",hideMode:"visibility",config:{value:""},initComponent:function(){this.afterLabelTextTpl=['<a class="custom-filter-condition-help icon-help" href="',Rally.util.Help.getHelpUrl({id:289}),'" target="_blank">&nbsp;</a>'].join(""),this.callParent(arguments),this.on({blur:this._onBlur,specialkey:this._onSpecialKey,scope:this}),this._previousValue=this.value},clear:function(){this.setValue("")},afterRender:function(){this.callParent(arguments),this.allowBlank=!1},_onBlur:function(){this._applyFilters()},_applyFilters:function(){var value=this.getValue();this._previousValue&&this._previousValue===value||this.fireEvent("filterchange",this),this._previousValue=value},_onSpecialKey:function(cmp,e){e.getKey()===e.ENTER&&this._applyFilters()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.MatchTypeComboBox",{alias:"widget.rallymatchtypecombobox",extend:Rally.ui.combobox.ComboBox,cls:"match-type-combobox",config:{hideLabel:!1,fieldLabel:"Match Filters",labelAlign:"top",queryMode:"local",store:{fields:["label","value"],data:[{label:"All",value:"AND"},{label:"Any",value:"OR"},{label:"Custom",value:"CUSTOM"}]},width:120,displayField:"label",valueField:"value",editable:!1,autoSelect:!0,forceSelection:!0,value:"AND"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.AdvancedFilterPanel",{extend:Ext.panel.Panel,alias:"widget.rallyadvancedfilterpanel",layout:"vbox",cls:"advanced-filter-panel",header:!1,minHeight:50,border:!1,collapseDirection:"bottom",animCollapse:!1,bubbleEvents:["expand","collapse","filterchange"],config:{collapsed:!0,advancedFilterRowsConfig:{},customFilterConditionConfig:{},clearAdvancedButtonConfig:{},matchTypeConfig:{value:"AND"}},clientMetrics:[{event:"expand",description:"Advanced filter panel expanded"},{event:"collapse",description:"Advanced filter panel collapsed"}],initComponent:function(){this.items=this._getItems(),this.on("filterchange",this._onFilterChange,this),this.callParent(arguments)},getFilters:function(){return this.advancedFilterRows.getFilters()},getCustomFilterCondition:function(){return this.customFilterCondition.getValue()},getMatchType:function(){return this.matchType.getValue()},validateCustomFilterCondition:function(){return this.customFilterCondition.isValid()},clear:function(){this.advancedFilterRows.clear(),this.customFilterCondition.clear(),this.matchType.setValue("AND")},removeInvalidRows:function(){_.invoke([].concat(this.advancedFilterRows.rows),"removeIfInvalid")},updateFilterIndices:function(filterStartIndex){this.advancedFilterRows.updateFilterIndices(this.getMatchType(),filterStartIndex)},_getItems:function(){return this.advancedFilterRows=Ext.widget(Ext.merge({xtype:"rallyadvancedfilterrows"},this.advancedFilterRowsConfig)),this.customFilterCondition=Ext.widget(Ext.merge({xtype:"rallycustomfiltercondition"},this.customFilterConditionConfig)),this._createMatchType(),this._createClearAdvancedButton(),[{width:"100%",layout:{type:"hbox",align:"top"},cls:"filters-container",items:[this.advancedFilterRows,{layout:{type:"hbox",align:"top",pack:"end"},flex:1,items:[this.matchType,this.clearAdvancedButton]}]},this.customFilterCondition]},_onMatchTypeChange:function(matchType){var value=matchType.getValue();this.advancedFilterRows.updateFilterIndices(value),this.customFilterCondition.setVisible("CUSTOM"===value),this.customFilterCondition.setDisabled("CUSTOM"!==value),"CUSTOM"===value&&this.customFilterCondition.focus(!1,200),this.fireEvent("matchtypechange",this.matchType),this.fireEvent("filterchange",this),this._toggleClearAdvancedButton()},_createMatchType:function(){this.matchType=Ext.widget(Ext.merge({xtype:"rallymatchtypecombobox",listeners:{change:this._onMatchTypeChange,scope:this}},this.matchTypeConfig))},_createClearAdvancedButton:function(){this.clearAdvancedButton=Ext.widget(Ext.merge({xtype:"rallybutton",itemId:"clearAdvancedButton",cls:"secondary rly-small",text:"Clear Advanced Filters",disabled:!this._hasAdvancedFilters(),margin:"33px 0 0 10px",listeners:{click:this._onClearAdvancedClick,scope:this}},this.clearAdvancedButtonConfig))},_onClearAdvancedClick:function(){this.clear(),this._toggleClearAdvancedButton(),this.fireEvent("filterchange",this)},_hasAdvancedFilters:function(){return this.getCustomFilterCondition()||this.getFilters().length||"AND"!==this.getMatchType()},_toggleClearAdvancedButton:function(){this.clearAdvancedButton.setDisabled(!this._hasAdvancedFilters())},_onFilterChange:function(){this._toggleClearAdvancedButton()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.InlineFilterPanel",{extend:Ext.panel.Panel,alias:"widget.rallyinlinefilterpanel",cls:"inline-filter-panel",header:!1,minHeight:46,padding:"8px 0 0 0",bodyPadding:"7px 5px 5px 5px",collapseDirection:"top",collapsible:!0,animCollapse:!1,config:{inline:!0,collapsed:!0,anchorTargetCmp:void 0,model:void 0,context:void 0,quickFilterPanelConfig:{initialFilters:[]},advancedFilterPanelConfig:{advancedFilterRowsConfig:{},matchTypeConfig:{value:"AND"}}},clientMetrics:[{event:"expand",description:"Inline filter panel expanded"},{event:"collapse",description:"Inline filter panel collapsed"}],constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.items=this._getItems(),this.on("expand",this._onExpand,this),this.on("beforecollapse",this._onBeforeCollapse,this),this.callParent(arguments)},getInlineCollapsed:function(){return!!this.collapsed},getAdvancedCollapsed:function(){return!!this.advancedFilterPanel.collapsed},getTypes:function(){return this.quickFilterPanel.getTypes()},getTypesFilter:function(){return this.quickFilterPanel.getTypesFilter()},getFilters:function(){return[].concat(this.getQuickFilters()).concat(this.getAdvancedFilters())},getQuickFilters:function(){return this.quickFilterPanel.getFilters()},getQuickFilterFields:function(){return this.quickFilterPanel.getSelectedFields()},getAdvancedFilters:function(){return this.advancedFilterPanel.getFilters()},getCustomFilterCondition:function(){return this.advancedFilterPanel.getCustomFilterCondition()},getMatchType:function(){return this.advancedFilterPanel.getMatchType()},onDestroy:function(){_.invoke(_.compact([this.chevronAligner,this.toggleAdvancedButtonRelayedEvents]),"destroy"),this.callParent(arguments)},onResize:function(width,height,oldWidth,oldHeight){this.callParent(arguments),this._alignChevron(),this.fireEvent("inlinefilterresize",this,height,oldHeight)},afterRender:function(){this.callParent(arguments),this.on("afterfilterchange",this._alignChevron,this)},validateCustomFilterCondition:function(){return this.advancedFilterPanel.validateCustomFilterCondition()},_onExpand:function(cmp){cmp===this&&this.quickFilterPanel.focusFirstField()},_onBeforeCollapse:function(cmp){this._removeInvalidFilters(),Ext.isIE10m&&cmp===this&&this.focus()},_removeInvalidFilters:function(){this.advancedFilterPanel.removeInvalidRows(),this.quickFilterPanel.clearInvalidFields()},_getItems:function(){return this._createCloseButton(),this._createQuickFilterPanel(),this._createAdvancedFilterPanel(),this.toggleAdvancedButtonRelayedEvents=this.quickFilterPanel.toggleAdvancedButton.relayEvents(this.advancedFilterPanel,["collapse","expand","filterchange"],"advanced"),[this.closeButton,this.quickFilterPanel,this.advancedFilterPanel]},_createCloseButton:function(){this.closeButton=Ext.widget({xtype:"rallybutton",cls:"inline-filter-panel-close icon-cross",height:18,userAction:"Close (X) filter panel clicked",listeners:{click:function(){this.collapse()},scope:this}})},_createQuickFilterPanel:function(){this.quickFilterPanel=Ext.widget(Ext.merge({xtype:"rallyquickfilterpanel",autoExpand:!Ext.isIE,model:this.model,context:this.context,toggleAdvancedButtonConfig:{advancedCollapsed:this.advancedFilterPanelConfig.collapsed},listeners:{toggleadvanced:this._onToggleAdvanced,quickfilterchange:this._onQuickFilterChange,scope:this}},this.quickFilterPanelConfig))},_createAdvancedFilterPanel:function(){var filterStartIndex=this._getFilterStartIndex(),matchTypeConfig=this.advancedFilterPanelConfig.matchTypeConfig,isMatchTypeCustom="CUSTOM"===matchTypeConfig.value;this.advancedFilterPanel=Ext.widget(Ext.merge({xtype:"rallyadvancedfilterpanel",customFilterConditionConfig:{hidden:!isMatchTypeCustom,maxWidth:753,width:"50%",padding:"0 0 0 47px"},advancedFilterRowsConfig:{autoExpand:!Ext.isIE,model:this.model,context:this.context,filterStartIndex:filterStartIndex,maxWidth:800,width:"50%",padding:0},matchTypeConfig:{autoExpand:!Ext.isIE},listeners:{matchtypechange:this._onMatchTypeChange,scope:this}},this.advancedFilterPanelConfig))},_getFilterStartIndex:function(){return this.quickFilterPanel.fields.length+1;
},_onToggleAdvanced:function(button){this.advancedFilterPanel.toggleCollapse(),(Ext.isIE||Ext.isGecko)&&button.focus()},_alignChevron:function(){this._ensureChevron(),!this.collapsed&&this.anchorTargetCmp.el?(this.chevron.alignTo(this.anchorTargetCmp.el,"t-b",[0,4]),this.chevron.show(),this.chevronAligner.start()):(this.chevron.hide(),this.chevronAligner.stop())},_ensureChevron:function(){!this.chevron&&this.el&&(this.chevron=this.el.createChild({cls:"chevron-up inline-filter-chevron"}),this.chevronAligner=Ext.TaskManager.newTask({run:function(){if(!this.collapsed&&this.anchorTargetCmp.el){var x=this.anchorTargetCmp.el.getX();x!==this.lastX&&(this.lastX=x,this._alignChevron())}},scope:this,interval:250}))},_onMatchTypeChange:function(matchType){this.quickFilterPanel.updateFilterIndices(matchType.getValue())},clear:function(){this.suspendEvents(!1),this.suspendLayouts(),this.quickFilterPanel.clear(),this.advancedFilterPanel.clear(),this.resumeEvents(),this.resumeLayouts(!1),this.updateLayout(),this.fireEvent("filterchange",this)},_onQuickFilterChange:function(){this.quickFilterPanel.updateFilterIndices(),this.advancedFilterPanel.updateFilterIndices(this._getFilterStartIndex()),this.fireEvent("filterchange",this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.CustomFilterConditionParser",{singleton:!0,parse:function(condition,filterMap){var filter=null,errorMessages=[];if(condition=this._balanceParentheses(condition,errorMessages),Ext.isEmpty(errorMessages)&&(filter=this._parseFilter(condition,errorMessages,filterMap)||null,Ext.isEmpty(errorMessages)&&!Ext.isEmpty(filter)))try{filter=Rally.data.wsapi.Filter.fromQueryString(filter)}catch(e){errorMessages.push("The filter condition is malformed")}var isValid=Ext.isEmpty(errorMessages);return{filter:isValid?filter:null,errorMessages:_.unique(errorMessages),isValid:isValid}},_balanceParentheses:function(condition,errorMessages){var substitutionMap={},indexStart=100,fixParensFn=Ext.bind(function(value){return this._addMissingParentheses(value.replace(/\(|\)/g,""))},this);return condition=this._mapSubstitutions(condition,substitutionMap,indexStart,/\(\d+(?:\s+(AND|OR)\s+\d+)+\)/gi,_.identity),condition=this._stripExtraneousParentheses(condition,errorMessages),condition=this._addMissingParentheses(condition),condition=this._unmapSubstitutions(condition,substitutionMap,fixParensFn)},_mapSubstitutions:function(condition,substitutionMap,indexStart,regex,transformFn){for(var index=indexStart+_.keys(substitutionMap).length,replaceFn=function(matched){return substitutionMap[++index]=transformFn(matched),index};regex.test(condition);)condition=condition.replace(regex,replaceFn);return condition},_unmapSubstitutions:function(condition,substitutionMap,transformFn){for(var substitutionFn=function(value,key){condition.indexOf(key)>-1&&(condition=condition.replace(key,transformFn(value)),delete substitutionMap[key])};!_.isEmpty(substitutionMap);)_.each(substitutionMap,substitutionFn,this);return condition},_stripExtraneousParentheses:function(condition,errorMessages){var openedCount=0,closedCount=0;return condition=condition.replace(/\(|\)/g,function(paren){return openedCount+="("===paren?1:0,closedCount+=")"===paren?1:0,""}),openedCount!==closedCount&&errorMessages.push("The parentheses must be balanced"),condition},_addMissingParentheses:function(condition){var substitutionMap={},indexStart=200,wrapParensFn=_.partial(Ext.String.format,"({0})");return condition=this._mapSubstitutions(condition,substitutionMap,indexStart,/\d+\s+AND\s+\d+/gi,wrapParensFn),condition=this._mapSubstitutions(condition,substitutionMap,indexStart,/\d+\s+OR\s+\d+/gi,wrapParensFn),condition=this._unmapSubstitutions(condition,substitutionMap,_.identity)},_parseFilter:function(condition,errorMessages,filterMap){return condition.replace(/\d+/g,function(index){return filterMap.hasOwnProperty(index)?filterMap[index].toString():(errorMessages.push(Ext.String.format("The filter condition referenced by {0} is not valid",index)),index)})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.InlineFilterButton",{extend:Rally.ui.Button,alias:"widget.rallyinlinefilterbutton",mixins:[Rally.clientmetrics.ClientMetricsRecordable],cls:"secondary rly-small",iconCls:"icon-filter",bubbleEvents:["viewstatesave"],stateEvents:["expand","collapse","filterchange"],text:"",userAction:"Filter button clicked",clientMetrics:[{endMethod:"_onModelLoadSuccess",description:"inline filter button loaded"}],config:{context:void 0,modelNames:void 0,filterChildren:!1,inlineFilterPanelConfig:{quickFilterPanelConfig:{defaultFields:[],initialFilters:[]},advancedFilterPanelConfig:{collapsed:!0,advancedFilterRowsConfig:{initialFilters:[]}}},toolTipConfig:{anchor:"top",mouseOffset:[-9,-2]},legacyStateIds:[]},initComponent:function(){this.callParent(arguments),(!this.stateful||this.stateful&&!this._hasState())&&this.applyState(this._transformLegacyFilters()),this.on("click",this._toggleFilterPanel,this,{buffer:200}),this.on("filterchange",this._onFilterChange,this,{buffer:500}),this.on("collapse",this._onCollapse,this)},afterRender:function(){this.callParent(arguments),this.toolTip.on("beforeshow",this._onBeforeShowToolTip,this)},getTypes:function(){var returnSelectedTypes="AND"===this._getMatchType(),selectedTypes=this._getSelectedTypes(),configuredTypes=this._getConfiguredTypes();return selectedTypes.length&&returnSelectedTypes?selectedTypes:configuredTypes},getFilters:function(){return this.inlineFilterPanel.getFilters()},getWsapiFilter:function(){var filters=_.each(this.getFilters(),this._escapeSpecialCharacters,this),matchType=this._getMatchType(),models=_.map(this.getTypes(),function(modelName){return this.model.getArtifactComponentModel(modelName)},this),modificationatedFilters=Rally.data.wsapi.filter.FilterModificationator.modifyFilters(filters,this.filterChildren,models);return"CUSTOM"===matchType?this._getCustomWsapiFilter(_.map(modificationatedFilters,function(filter,index){return Ext.apply(filter,{filterIndex:filters[index].filterIndex})})):"OR"===matchType?this._getOredWsapiFilter(modificationatedFilters):Rally.data.wsapi.Filter.and(modificationatedFilters)},getState:function(){return this.inlineFilterPanel?{collapsed:this.inlineFilterPanel.getInlineCollapsed(),advancedCollapsed:this.inlineFilterPanel.getAdvancedCollapsed(),types:_.map(this.inlineFilterPanel.getTypes(),function(type){return this.model.getArtifactComponentModel(type).typeDefinition._refObjectUUID},this),quickFilters:this._mapFilterNamesToUuids(this.inlineFilterPanel.getQuickFilters()),advancedFilters:this._mapFilterNamesToUuids(this.inlineFilterPanel.getAdvancedFilters()),condition:this.inlineFilterPanel.getCustomFilterCondition(),matchType:this.inlineFilterPanel.getMatchType(),quickFilterFields:this._mapFieldNamesToUuids(this._getQuickFilterFields())}:Ext.state.Manager.get(this.stateId)},_transformLegacyFilter:function(filter){var legacyFilter=Rally.data.wsapi.Filter.fromQueryString(filter);return{name:legacyFilter.property,operator:legacyFilter.operator.toLowerCase(),rawValue:legacyFilter.value}},_shouldBeQuickFilter:function(filter,quickFilters){var quickFilterFields=this.inlineFilterPanelConfig.quickFilterPanelConfig.defaultFields;return"Owner"===filter.name&&"="===filter.operator&&_.contains(quickFilterFields,"Owner")&&!_.find(quickFilters,{name:"Owner"})},_transformLegacyFilters:function(){var quickFilters=[],advancedFilters=[],types=[];return _.each(this.legacyStateIds,function(stateId){var state=Ext.state.Manager.get(stateId)||{},filters=[];state.filters&&(filters=state.filters),state.types&&_.isUndefined(this.model)&&(types=state.types),/owner-filter$/i.test(stateId)&&state.value&&(filters=[Ext.String.format("(Owner = {0})",state.value)]),_.each(filters||[],function(filter){filter=this._transformLegacyFilter(filter),this._shouldBeQuickFilter(filter,quickFilters)?quickFilters.push(filter):advancedFilters.push(filter)},this)},this),{quickFilters:quickFilters,advancedFilters:advancedFilters,types:types}},applyState:function(state){Ext.merge(this,this._transformStateToConfig(state)),this._build(!0)},saveState:function(){this.callParent(arguments),Ext.merge(this,this._transformStateToConfig(this.getState()))},onDestroy:function(){_.invoke(_.compact([this.relayedEvents,this.inlineFilterPanel]),"destroy"),this.callParent(arguments)},clearAllFilters:function(){this.inlineFilterPanel.clear()},_getQuickFilterFields:function(){var quickFilterFields=this.inlineFilterPanel.getQuickFilterFields();return _.isEqual(quickFilterFields,this.inlineFilterPanelConfig.quickFilterPanelConfig.defaultFields)?[]:quickFilterFields},_hasState:function(){return!(!this.stateful||!this.stateId)&&!!Ext.state.Manager.get(this.stateId)},_escapeSpecialCharacters:function(filter){if(_.isObject(filter.property)&&this._escapeSpecialCharacters(filter.property),_.isObject(filter.value)&&this._escapeSpecialCharacters(filter.value),_.isString(filter.value)){var specialCharacters=/"|\\/g;filter.value=filter.value.replace(specialCharacters,"\\$&")}},_getMatchType:function(){return this.inlineFilterPanel.getMatchType()},_isValidFilter:function(filter){var fieldDef=this.model.getField(filter.name),attributeDef=fieldDef&&fieldDef.attributeDefinition,attributeType=attributeDef&&attributeDef.AttributeType;return"OBJECT"!==attributeType||null===filter.rawValue||Rally.util.Ref.isRefUri(filter.rawValue)},_removeInvalidFilters:function(){var inlineFilterPanelConfig=this.inlineFilterPanelConfig,quickFilterPanelConfig=inlineFilterPanelConfig.quickFilterPanelConfig,quickFilters=quickFilterPanelConfig.initialFilters,advancedFilterPanelConfig=inlineFilterPanelConfig.advancedFilterPanelConfig,advancedFilterRowsConfig=advancedFilterPanelConfig.advancedFilterRowsConfig,advancedFilters=advancedFilterRowsConfig.initialFilters;quickFilterPanelConfig.initialFilters=_.filter(quickFilters,this._isValidFilter,this),advancedFilterRowsConfig.initialFilters=_.filter(advancedFilters,this._isValidFilter,this)},_build:function(applyFilters){return this._loadModel().then({success:_.partial(this._onModelLoadSuccess,applyFilters),scope:this})},_onModelLoadSuccess:function(applyFilters){this._mapUuidsToNames(),this._removeInvalidFilters(),this._createInlineFilterPanel(),applyFilters&&this._applyFilters()},_loadModel:function(){return this.model?Deft.Promise.when(this.model):Rally.data.ModelFactory.getModels({context:this.context||Rally.environment.getContext(),types:this.modelNames}).then({success:function(models){this.model=Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(_.values(models),this.context)},scope:this})},_mapUuidsToNames:function(){this.inlineFilterPanelConfig.quickFilterPanelConfig.initialTypes=_.map(this.inlineFilterPanelConfig.quickFilterPanelConfig.initialTypes,function(type){var model=_.find(this.model.getArtifactComponentModels(),function(model){return model.typePath===type||model.typeDefinition._refObjectUUID===type});return model&&model.typePath},this),this.inlineFilterPanelConfig.quickFilterPanelConfig.initialFilters=this._mapFilterUuidsToNames(this.inlineFilterPanelConfig.quickFilterPanelConfig.initialFilters),this.inlineFilterPanelConfig.quickFilterPanelConfig.fields=this._mapFieldUuidsToNames(this.inlineFilterPanelConfig.quickFilterPanelConfig.fields),this.inlineFilterPanelConfig.advancedFilterPanelConfig.advancedFilterRowsConfig.initialFilters=this._mapFilterUuidsToNames(this.inlineFilterPanelConfig.advancedFilterPanelConfig.advancedFilterRowsConfig.initialFilters)},_mapFilterUuidsToNames:function(filters){var fieldsByUuid=this._getFieldsByUuid();return _.map(filters,function(filter){return Ext.apply(filter,{name:(fieldsByUuid[filter.name]||filter).name})})},_mapFieldUuidsToNames:function(fieldNames){var fieldsByUuid=this._getFieldsByUuid(),fields=_.map(fieldNames,function(fieldName){return fieldsByUuid[fieldName]&&fieldsByUuid[fieldName].name||fieldName});return _.reject(fields,function(fieldName){return Rally.util.RegularExpression.uuidOrOidRegularExpression.test(fieldName)})},_getFieldsByUuid:function(){return _.indexBy(_.filter(this.model.getFields(),function(field){return!!field.attributeDefinition}),function(field){return field.attributeDefinition._refObjectUUID})},_mapFilterNamesToUuids:function(filters){return _.map(filters,function(filter){var newFilter={name:this._getFilterFieldUuid(filter.name),operator:filter.operator,rawValue:filter.rawValue};return newFilter},this)},_mapFieldNamesToUuids:function(fieldNames){return _.map(fieldNames,this._getFilterFieldUuid,this)},_getFilterFieldUuid:function(fieldName){var field=this.model.getField(fieldName);return field&&field.attributeDefinition&&field.attributeDefinition._refObjectUUID||fieldName},_createInlineFilterPanel:function(){this.inlineFilterPanel=Ext.widget(Ext.merge({xtype:"rallyinlinefilterpanel",itemId:"inlineFilterPanel",anchorTargetCmp:this,model:this.model,context:this.context},this.inlineFilterPanelConfig)),this.relayedEvents=this.relayEvents(this.inlineFilterPanel,["expand","collapse","inlinefilterresize","filterchange"]),this.fireEvent("inlinefilterready",this.inlineFilterPanel)},_toggleFilterPanel:function(){this.inlineFilterPanel.toggleCollapse()},getTypesAndFilters:function(){return{types:this.getTypes(),filters:_.compact([this.getWsapiFilter()])}},_typesOrFiltersChanged:function(){var previousTypesAndFilters=this._previousTypesAndFilters,currentTypesAndFilters=this.getTypesAndFilters(),previousTypes=previousTypesAndFilters.types.toString(),previousFilters=previousTypesAndFilters.filters.toString(),currentTypes=currentTypesAndFilters.types.toString(),currentFilters=currentTypesAndFilters.filters.toString();return previousTypes!==currentTypes||previousFilters!==currentFilters},_onFilterChange:function(){this._typesOrFiltersChanged()&&(this._recordMetrics(),this._applyFilters()),this.fireEvent("viewstatesave",this)},_recordMetrics:function(){this.recordAction({component:this,description:"Filters changed",miscData:{quickFilters:_.pluck(this.inlineFilterPanel.getQuickFilters(),"name"),advancedFilters:_.pluck(this.inlineFilterPanel.getAdvancedFilters(),"name"),types:this._getSelectedTypes(),customCondition:this.inlineFilterPanel.getCustomFilterCondition(),matchType:this._getMatchType(),quickFilterFields:this._getQuickFilterFields()}})},_applyFilters:function(){this._updateCount(),this.fireEvent("inlinefilterchange",this),this._previousTypesAndFilters=this.getTypesAndFilters()},_getSelectedTypes:function(){return this.inlineFilterPanel.getTypes()},_getConfiguredTypes:function(){return _.map(this.modelNames,function(modelName){return Rally.data.ModelTypes.getTypeByName(modelName).toLowerCase()})},_transformStateToConfig:function(state){var config={inlineFilterPanelConfig:{collapsed:state.collapsed,quickFilterPanelConfig:{matchType:state.matchType,initialTypes:state.types,initialFilters:state.quickFilters,fields:state.quickFilterFields},advancedFilterPanelConfig:{collapsed:state.advancedCollapsed,advancedFilterRowsConfig:{matchType:state.matchType,initialFilters:state.advancedFilters},customFilterConditionConfig:{value:state.condition,validator:Ext.bind(this._validateCustomFilterCondition,this)},matchTypeConfig:{value:state.matchType}}}};return this._removeUndefined(config)},_removeUndefined:function(obj){return _.reduce(obj,function(result,value,key){return _.isPlainObject(value)?result[key]=this._removeUndefined(value):Ext.isDefined(value)&&(result[key]=value),result},{},this)},_updateCount:function(){var filterCount=this.getFilterCount();Ext.suspendLayouts(),filterCount>0?(this.setText(Ext.String.format("{0} Filter{1} Active",filterCount,filterCount>1?"s":"")),this._indicateActiveFilterPresent()):(this.setText(""),this._indicateNoActiveFilterPresent()),Ext.resumeLayouts(!1)},getFilterCount:function(){if(!this.inlineFilterPanel)return 0;var matchType=this._getMatchType(),filterCount=0;if("CUSTOM"!==matchType){var filters=this.getFilters(),types=this._getSelectedTypes();filterCount=filters.length+(types.length?1:0)}else if(this.inlineFilterPanel.validateCustomFilterCondition()){var condition=this.inlineFilterPanel.getCustomFilterCondition(),indices=condition.match(/\d+/g);filterCount=_.unique(indices).length}return filterCount},_indicateActiveFilterPresent:function(){this.hasCls("primary")||(this.addCls("primary"),this.removeCls("secondary"))},_indicateNoActiveFilterPresent:function(){this.hasCls("secondary")||(this.addCls("secondary"),this.removeCls("primary"))},_getTypesFilter:function(){return this.inlineFilterPanel.getTypesFilter()},_getOredWsapiFilter:function(filters){var filter=Rally.data.wsapi.Filter.or(filters),typesFilter=this._getTypesFilter();return filter&&typesFilter&&filter.or(typesFilter)||filter||typesFilter},_getCustomWsapiFilter:function(filters){return this._getParsedCustomFilterCondition(filters,this.inlineFilterPanel.getCustomFilterCondition()).filter},_validateCustomFilterCondition:function(value){var parsed=this._getParsedCustomFilterCondition(this.getFilters(),value);return parsed.isValid||parsed.errorMessages.join("\n")},_getParsedCustomFilterCondition:function(filters,customFilterCondition){var typeFilter=this._getTypesFilter(),filterMap=_.indexBy(_.compact(filters.concat([typeFilter])),"filterIndex");return Rally.ui.inlinefilter.CustomFilterConditionParser.parse(customFilterCondition,filterMap)},_onCollapse:function(){_.forEach(this.inlineFilterPanel.query("field"),function(field){field.validationCmp&&field.validationCmp.hide()})},collapse:function(){this.inlineFilterPanel.collapse()},_onBeforeShowToolTip:function(){var action=this.inlineFilterPanel.collapsed?"Show":"Hide";this.toolTip.update(Ext.String.format("{0} Filters",action))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.inlinefilter.InlineFilterControl",{alias:"widget.rallyinlinefiltercontrol",extend:Ext.container.Container,cls:"inline-filter-control",config:{context:void 0,inlineFilterButtonConfig:{},clearAllButtonConfig:{}},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.items=this._getItems(),this.callParent(arguments)},_getItems:function(){return this._createInlineFilterButton(),this._createClearAllButton(),[this.inlineFilterButton,this.clearAllButton]},_createInlineFilterButton:function(){this.inlineFilterButton=Ext.widget(Ext.merge({xtype:"rallyinlinefilterbutton",itemId:"inlineFilterButton",context:this.context,margin:"3 9 3 30"},this.inlineFilterButtonConfig)),this.inlineFilterButton.on("inlinefilterchange",this._onFilterChange,this)},_createClearAllButton:function(){this.clearAllButton=Ext.widget(Ext.merge({xtype:"rallybutton",itemId:"clearAllButton",cls:"secondary rly-small clear-all-filters-button",text:"Clear All",margin:"3 9 3 -11",hidden:!this._hasFilters(),listeners:{click:this._onClearAllClick,scope:this}},this.clearAllButtonConfig))},_onClearAllClick:function(){this.inlineFilterButton.clearAllFilters()},_onFilterChange:function(){Ext.suspendLayouts(),this._hasFilters()?this.clearAllButton.show():this.clearAllButton.hide(),Ext.resumeLayouts(!1)},_hasFilters:function(){return!!this.inlineFilterButton.getFilterCount()},collapse:function(){this.inlineFilterButton.collapse()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardInlineFilterControl",{alias:"plugin.rallygridboardinlinefiltercontrol",extend:Ext.AbstractPlugin,mixins:[Rally.ui.gridboard.plugin.GridBoardControlShowable],headerPosition:"left",sharedViewState:["types","quickFilters","advancedFilters","matchType","condition","quickFilterFields"],config:{inlineFilterButtonConfig:{},clearAllButtonConfig:{}},init:function(cmp){cmp.useFilterCollection=!1,this.callParent(arguments),this.showControl(),cmp.on("modeltypeschange",this._onModelTypesChange,this)},_updateContainerWidth:function(container){var cmp=this.cmp;if(container&&container.rendered&&cmp&&cmp.rendered){var gridBoardWidth=cmp.getWidth(),rightContainer=container.ownerCt.getRight().getWidth();container.setWidth(gridBoardWidth-rightContainer)}},_onModelTypesChange:function(cmp,newTypes){var existingButton=this.getControlCmp(),container=existingButton.ownerCt,index=container.items.indexOf(existingButton),config=Ext.merge(this.getControlCmpConfig(),{modelNames:_.map(newTypes,function(t){return t.get("TypePath")})});Ext.suspendLayouts(),this._updateContainerWidth(container),container.remove(existingButton,!0),container.insert(index,config),Ext.resumeLayouts(!0)},getControlCmpConfig:function(){return{xtype:"rallyinlinefiltercontrol",itemId:"inlineFilterControl",context:this.context||this.cmp.getContext(),inlineFilterButtonConfig:Ext.merge({listeners:{inlinefilterchange:this._onFilterChange,inlinefilterready:this._onFilterReady,inlinefilterresize:this._onFilterResize,scope:this}},this.inlineFilterButtonConfig),clearAllButtonConfig:this.clearAllButtonConfig}},_onFilterResize:function(inlineFilterPanel,height,oldHeight){this.cmp.suspendLayouts(),height!==oldHeight&&this.cmp.setHeight(),this.cmp.resumeLayouts(!1),this.cmp.updateLayout()},_onFilterReady:function(inlineFilterPanel){this.cmp.insert(1,inlineFilterPanel)},_onFilterChange:function(inlineFilterButton){this.cmp.applyCustomFilter(Ext.apply({recordMetrics:!0},inlineFilterButton.getTypesAndFilters())),inlineFilterButton.inlineFilterPanel.fireEvent("afterfilterchange")},getCurrentView:function(){return _.pick(this.getControlCmp().getComponent("inlineFilterButton").getState(),this.sharedViewState)},setCurrentView:function(view){var inlineFilterButton=this.getControlCmp().getComponent("inlineFilterButton"),stateId=inlineFilterButton.getStateId(),state=_.pick(view,this.sharedViewState);Ext.apply(state,_.pick(inlineFilterButton.getState(),"collapsed","advancedCollapsed")),Ext.state.Manager.set(stateId,state)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.ToggleButtonTemplate",{extend:Ext.XTemplate,statics:{DISABLED_CLS:"toggle-button-disabled"},constructor:function(config){this.callParent(["<tpl>",'<div class="toggle-button-template toggle-button-{[this.getState(values)]} {[this.getDisabledCls()]}">','<div class="toggle-button-handle"></div>','<div class="toggle-button-text">{[this.getState(values)]}</div>',"</div>","</tpl>",{getState:function(values){return values?"on":"off"},getDisabledCls:function(){return config&&config.disabled?this.self.DISABLED_CLS:""}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.SharedViewDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallysharedviewdialog",mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},inheritableStatics:{invalidToggleCls:"rally-invalid-toggle-button-cell"},height:400,width:600,padding:"0 20px 0 20px",autoShow:!0,layout:{type:"vbox",align:"stretch"},cls:"rally-shared-view-dialog",closable:!0,title:"MANAGE SAVED VIEWS...",config:{addNewConfig:{recordTypes:["preference"],showAddWithDetails:!1,showFieldLabel:!1,openEditorAfterAddFailure:!1},enableProjectSharing:!0,additionalFilters:[]},constructor:function(config){this.mergeConfig(config),this.callParent([this.config]),this.grid=this.down("rallygrid"),this.grid.on("viewready",this._attachCellClick,this,{single:!0}),this.grid.on("storeload",this._clearErrorElements,this),this.grid.getView().on("itemupdate",this._clearRowErrorElement,this),this.grid.getView().on("itemremove",this._clearRowErrorElement,this),this.grid.on("destroy",this._clearErrorElements,this),this.errorTooltips={}},initComponent:function(){this.items=this._getItems(),this.dockedItems=this._getDockedItems(),this.callParent(arguments)},_attachCellClick:function(){this.grid.un("cellclick",this._onClick,this,{stopEvent:!0}),this.grid.on("cellclick",this._onClick,this,{stopEvent:!0})},_onClick:function(view,cell,colIdx,record,row,rowIdx,event){var cellEl=Ext.get(cell);if(event.within(cellEl.down(".toggle-button-template")))if(cellEl.hasCls(this.self.invalidToggleCls))cellEl.removeCls(this.self.invalidToggleCls),this._clearRowErrorElement(record);else{var userValue,projectValue;cellEl.hasCls("rally-grid-cell-user")?(projectValue=null,userValue=this._isWorkspaceShared(record)?Rally.util.Ref.getRelativeUri(this.getContext().getUser()):null,this.recordAction({description:"Share in Workspace toggled "+(userValue?"off":"on")})):cellEl.hasCls("rally-grid-cell-project")&&(projectValue=this._isProjectShared(record)?null:Rally.util.Ref.getRelativeUri(this.getContext().getProject()),userValue=projectValue?null:Rally.util.Ref.getRelativeUri(this.getContext().getUser()),this.recordAction({description:"Share in Project toggled "+(projectValue?"on":"off")})),cellEl.down(".toggle-button-template").hasCls(Rally.ui.renderer.template.ToggleButtonTemplate.DISABLED_CLS)||(record.set("User",userValue),record.set("Project",projectValue),record.save({params:{fetch:record.store.fetch},success:function(savedRecord){this.publish(Rally.Message.objectUpdate,savedRecord,["User","Project"],this,[])},failure:function(updatedRecord,operation){this._onClickSaveFailure(updatedRecord,operation,colIdx)},scope:this}))}},_onClickSaveFailure:function(updatedRecord,operation,colIdx){updatedRecord.reject();var gridCell=this.grid.getView().getCell(updatedRecord,this.grid.columns[colIdx]);gridCell.addCls(this.self.invalidToggleCls),this.errorTooltips[updatedRecord.get("ObjectID")]=Ext.create("Rally.ui.tooltip.ToolTip",{target:gridCell.down(".toggle-button-template"),anchor:"top",cls:"rally-grid-error-message",html:Rally.data.util.Record.makeErrorMessageMoreUserFriendly(operation.error.errors[0]),autoShow:!0})},_clearRowErrorElement:function(record){_.forEach(this.errorTooltips,function(value,key){key.match(record.getId())&&(value.destroy(),delete this.errorTooltips[key])},this)},_clearErrorElements:function(){_.invoke(this.errorTooltips,"destroy"),this.errorTooltips={}},_getItems:function(){var me=this;return[Ext.merge({xtype:"rallyaddnew",padding:"14px 0 8px 0",collapseOnCreate:!0,enableValidationNotifications:!1,listeners:{beforecreate:this._onBeforeCreate,create:this._onCreate,error:this._onCreateError,scope:this}},this.addNewConfig),{xtype:"rallygrid",flex:1,context:this.getContext(),rowActionColumnConfig:{rowActionsFn:function(record){return[{text:"Update with Current View",record:record,handler:me._updateView,scope:me},{xtype:"rallyrecordmenuitemdelete",record:record,showConfirmation:!1}]}},columnCfgs:this._getColumns(),storeConfig:this._getStoreConfig(),disableEditorForColumns:["User","Project"]}]},_getStoreConfig:function(){var filters=[Rally.data.wsapi.Filter.and([{property:"AppId",value:this.getContext().getAppId()},{property:"Type",value:"View"},{property:"Workspace",value:Rally.util.Ref.getRelativeUri(this.getContext().getWorkspaceRef())},this._getUserFilters()])];return _.isEmpty(this.additionalFilters)||(filters=filters.concat(this.additionalFilters)),{model:Ext.identityFn("preference"),fetch:["Type","AppId","VersionId"],filters:filters,sorters:[{property:"Name",direction:"ASC"}]}},_getColumns:function(){var columns=["Name"],me=this;return this.enableProjectSharing&&this._isWorkspaceOrSubscriptionOrProjectAdmin()&&columns.push({dataIndex:"Project",text:"Shared With Project",align:"center",sortable:!1,renderer:function(value,metaData,record){return Ext.create("Rally.ui.renderer.template.ToggleButtonTemplate",{disabled:me._isWorkspaceShared(record)}).apply(me._isProjectShared(record)||me._isWorkspaceShared(record))}}),this.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()&&columns.push({dataIndex:"User",text:"Shared With Workspace",align:"center",sortable:!1,renderer:function(value,metaData,record){return Ext.create("Rally.ui.renderer.template.ToggleButtonTemplate").apply(me._isWorkspaceShared(record))}}),columns},_isWorkspaceShared:function(record){return null===record.get("User")&&null===record.get("Project")},_isProjectShared:function(record){return null!==record.get("Project")},_getUserFilters:function(){var filters=[{property:"User",value:Rally.util.Ref.getRelativeUri(this.getContext().getUser())}];return this._isWorkspaceOrSubscriptionOrProjectAdmin()&&filters.push({property:"Project",value:this.getContext().getProjectRef()}),this.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()&&filters.push(Rally.data.wsapi.Filter.and([{property:"User",value:null},{property:"Project",value:null}])),Rally.data.wsapi.Filter.or(filters)},_isWorkspaceOrSubscriptionOrProjectAdmin:function(){return this.getContext().getPermissions().isProjectAdmin(this.getContext().getProject())||this.getContext().getPermissions().isWorkspaceOrSubscriptionAdmin()},_getDockedItems:function(){return[{xtype:"toolbar",dock:"bottom",padding:"0 0 20px 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",itemId:"doneButton",text:"Done",cls:"primary rly-small",margin:"0 0 0 1px",listeners:{click:this._onDoneClicked,scope:this}}]}]},_onDoneClicked:function(){this.close()},_onCreate:function(){this.down("#doneButton").focus()},_onBeforeCreate:function(addNew,record){record.set({Value:this._getCurrentView(),User:Rally.util.Ref.getRelativeUri(this.getContext().getUser()),AppId:this.getContext().getAppId(),Project:null,Type:"View",Workspace:Rally.util.Ref.getRelativeUri(this.getContext().getWorkspace())})},_onCreateError:function(addNew,args){addNew.getNameField().markInvalid(args.message)},_getCurrentView:function(){return Ext.JSON.encode(this.cmp.getCurrentView())},_updateView:function(menuItem){menuItem.record.set("Value",this._getCurrentView()),menuItem.record.save({success:function(record){this.publish(Rally.Message.objectUpdate,record,["Value","VersionId"],this,[])},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext,SORT_INDEXES={userViews:2,defaultViews:3,workspaceViews:4,projectViews:5},GROUP_NAMES=["defaultItems","userViews","defaultViews","workspaceViews","projectViews"];Ext.define("Rally.ui.gridboard.SharedViewComboBox",{extend:Rally.ui.combobox.ComboBox,alias:"widget.rallysharedviewcombobox",mixins:{messageable:Rally.Messageable},config:{emptyText:"Select Saved View...",autoExpand:!0,editable:!0,typeAhead:!0,queryMode:"remote",minChars:0,forceSelection:!0,defaultSelectionPosition:null,displayField:"Name",valueField:"identifier",defaultViews:[],matchFieldWidth:!0,width:210,enableProjectSharing:!0,enableUrlSharing:!1,enableReadingUserPref:!1,additionalFilters:[],suppressViewNotFoundNotification:!1},constructor:function(config){this.mergeConfig(config),this.config.storeConfig=this._getStoreConfig(),this.config.listConfig=this._getListConfig();var id=this._getSharedViewId();id&&(this.config.sharedViewId=id,this.config.value=this._formatSharedViewId(id)),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.sharedViewId&&this.stateful&&!this._hasState()&&this.applyState(this._mockSharedViewState()),this.on("select",this._selectView,this),this.cmp.on("viewstatesave",this._onCmpViewStateSave,this,{buffer:200}),this.on("beforestatesave",function(){return!!this.store.getRange().length},this),this.subscribe(this,Rally.Message.objectCreate,this._onObjectCreate,this),this.subscribe(this,Rally.Message.objectUpdate,this._onObjectChange,this),this.subscribe(this,Rally.Message.objectDestroy,this._onObjectDestroy,this)},onKeyDown:function(e){this.callParent(arguments),e.getKey()===e.ESC&&(this.triggerBlur(),this.doQuery(this.allQuery),this.inputEl.blur())},beforeQuery:function(queryPlan){var queryString=queryPlan.query,storeFilters=this.store&&this.store.filters.getRange(),queryFilter=Rally.data.wsapi.Filter.and(storeFilters);return queryString?(queryFilter=queryFilter.and({property:"Name",operator:"contains",value:queryString}),this._searching=!0):delete this._searching,queryPlan.query=queryFilter.toString(),this.callParent(arguments)},getState:function(){var record=this.getRecord(),state={};return record&&(state.value=record.get("identifier"),this._isSharedView(record)&&(state.objectId=record.get("ObjectID"),
state.versionId=record.get("VersionId"))),state},applyState:function(state){var selectedView=this._hasState()?Ext.state.Manager.get(this.stateId):{};this._shouldOverrideState(state)?Ext.apply(state,this._mockSharedViewState()):this.sharedViewId=Rally.util.Ref.getOidFromRef(state.value)||state.value,this.on("defaultsset",function(){this.setValue(state.value);var currentValue=this.getRecord();currentValue&&this._isDefaultView(currentValue)&&selectedView.value!==this.sharedViewId?this._applyView(this._decodeValue(currentValue)):this.saveState(),delete this.sharedViewId},this,{single:!0}),this._ensureLatestView(state)},saveState:function(){this._applyParameters(),this.callParent(arguments)},onBeforeSelect:function(combo,record){var isDefaultItem=this._isDefaultItem(record);return isDefaultItem&&(this.collapse(),this._createSharedViewDialog(record)),!isDefaultItem},onDestroy:function(){this.dialog&&(this.dialog.destroy(),delete this.dialog),this.callParent(arguments)},onTriggerClick:function(){this._searching?this.callParent(arguments):this.isExpanded?this.collapse():this.expand()},_mockSharedViewState:function(){var state={value:this._formatSharedViewId(this.sharedViewId)};return this._isNonDefaultViewIdentifier()&&(state.objectId=this.sharedViewId,state.versionId=-1),state},_hasState:function(){return!(!this.stateful||!this.stateId)&&!!Ext.state.Manager.get(this.stateId)},_formatSharedViewId:function(id){return(id+"").length>2?"/preference/"+id:id},_shouldOverrideState:function(state){var stateValue=Rally.util.Ref.getOidFromRef(state.value)||state.value;return this.sharedViewId&&this.sharedViewId!==stateValue},_ensureLatestView:function(state){state.objectId&&state.versionId&&this.store.model.load(state.objectId,{fetch:["VersionId","Value"],success:function(record){record&&record.get("VersionId")!==state.versionId&&this.store.on("load",function(){this._applyView(this._decodeValue(record))},this,{single:!0})},scope:this})},_onObjectChange:function(record){this._isViewPreference(record)&&(this.setValue(record.get("_ref")),this.store.reload())},_onObjectCreate:function(record){this._isViewPreference(record)&&(this.store.add(new this.store.model(record.data)),this.setValue(record.get("_ref")),this.picker&&this.picker.refresh())},_onObjectDestroy:function(record){this._isViewPreference(record)&&(this.getValue()===record.get("_ref")&&this._clearParameters(),this.store.reload())},_getProxy:function(){var modelFactory=Rally.data.wsapi.ModelFactory,wsapiVersion=Rally.environment.getServer().getWsapiVersion(),url=modelFactory.buildProxyUrl("Preference",wsapiVersion);return modelFactory.buildProxy(url,"Preference",null,wsapiVersion)},_getStoreConfig:function(){return{autoLoad:!0,remoteFilter:!0,remoteSort:!1,sortOnLoad:!0,proxy:this._getProxy(),fetch:["ObjectID","User","Name","VersionId","Project"],fields:["ObjectID","User","Value","VersionId","Project",{name:"Name",type:"string",sortType:"asUCString"},{name:"groupName",type:"string",convert:function(value,record){return value||(record.get("User")?"userViews":record.get("Project")?"projectViews":"workspaceViews")}},{name:"sortIndex",type:"int",convert:function(value,record){return Ext.isEmpty(value)?SORT_INDEXES[record.get("groupName")]:value}},{name:"identifier",type:"string",convert:function(value,record){return value||record.raw._ref}}],filters:this._getFilters(),sorters:[{property:"sortIndex",direction:"ASC"},{property:"Name",direction:"ASC"}],listeners:{load:this._addDefaultViews,scope:this}}},_getFilters:function(){var context=this.getContext(),filters=[{property:"AppId",operator:"=",value:context.getAppId()},{property:"Type",operator:"=",value:"View"},{property:"Workspace",operator:"=",value:Rally.util.Ref.getRelativeUri(context.getWorkspaceRef())},Rally.data.wsapi.Filter.or([{property:"User",operator:"=",value:Rally.util.Ref.getRelativeUri(context.getUser())},Rally.data.wsapi.Filter.and([{property:"User",operator:"=",value:null},{property:"Project",operator:"=",value:null}]),{property:"Project",operator:"=",value:context.getProjectRef()}])];return _.isEmpty(this.additionalFilters)||(filters=filters.concat(this.additionalFilters)),filters},_getDefaultItems:function(){return[{Name:"Save New View...",identifier:"saveNewView",groupName:"defaultItems",sortIndex:0},{Name:"Manage Saved Views...",identifier:"manageSavedView",groupName:"defaultItems",sortIndex:1}]},_getDefaultViews:function(){var defaultViews=_.map(this.getDefaultViews(),function(defaultView){return _.assign(defaultView,{groupName:"defaultViews",sortIndex:SORT_INDEXES.defaultViews})}),filteredViews=_.filter(defaultViews,function(view){return!this._searching||view.Name.toLowerCase().indexOf(this.getValue().toLowerCase())>=0},this);return filteredViews},_addDefaultViews:function(){this.store&&this.store.add(this._getDefaultItems().concat(this._getDefaultViews())),this._savedViewNotInStore()?this._insertViewIntoStore():this.fireEvent("defaultsset",this),this.picker&&this.picker.refresh()},_savedViewNotInStore:function(){return!this._searching&&this.sharedViewId&&this.store.find("identifier",this._formatSharedViewId(this.sharedViewId))===-1},_insertViewIntoStore:function(){var filters=this._getFilters(),store=this.store;filters.push({property:"ObjectID",value:this.sharedViewId}),store.suspendEvents(!0),this.enableReadingUserPref?store.model.load(this.sharedViewId,{fetch:store.fetch,success:function(record){store.add(record),store.resumeEvents(),this.setValue(record),this.fireEvent("defaultsset",this)},failure:function(){store.resumeEvents(),this._clearParameters(),this.suppressViewNotFoundNotification||(this.suppressViewNotFoundNotification=!1,Rally.ui.notify.Notifier.showWarning({message:"The view you are seeking has been removed or you do not have access to view it."})),this.fireEvent("defaultsset",this)},scope:this}):Ext.create("Rally.data.wsapi.Store",{model:store.model,autoLoad:!0,listeners:{load:function(storeForRecordToInsert,data){if(data.length){var record=_.first(data);store.add(record),store.resumeEvents(),this.setValue(record)}else store.resumeEvents(),this._clearParameters(),Rally.ui.notify.Notifier.showWarning({message:"The view you are seeking has been removed or you do not have access to view it."});this.fireEvent("defaultsset",this)},scope:this},fetch:store.fetch,filters:filters})},_getListConfig:function(){var itemTpl='<div role="option" unselectable="on" class="'+Ext.baseCSSPrefix+'boundlist-item">{'+this.displayField+"}</div>";return{cls:"rally-shared-view-list",loadMask:!1,emptyText:"No matching views",height:400,tpl:['<div class="default-items '+Ext.plainListCls+'">','<tpl for="defaultItems">','<div role="option" unselectable="on" class="default-item '+Ext.baseCSSPrefix+'boundlist-item action-item">{Name}</div>',"</tpl>","</div>",'<div class="view-items '+Ext.plainListCls+'" style="">','<tpl if="userViews.length">','<div class="rally-group-header multi-object-picker-header">My Views</div>','<tpl for="userViews">',itemTpl,"</tpl>","</tpl>",'<tpl if="defaultViews.length">','<div class="rally-group-header multi-object-picker-header">Default Views</div>','<tpl for="defaultViews">',itemTpl,"</tpl>","</tpl>",'<tpl if="workspaceViews.length">','<div class="rally-group-header multi-object-picker-header">Workspace Shared Views</div>','<tpl for="workspaceViews">',itemTpl,"</tpl>","</tpl>",'<tpl if="projectViews.length">','<div class="rally-group-header multi-object-picker-header">Project Shared Views</div>','<tpl for="projectViews">',itemTpl,"</tpl>","</tpl>","</ul>"],collectData:function(records,startIndex){var data=this.superclass.collectData.call(this,records,startIndex);return _.each(GROUP_NAMES,function(groupName){data[groupName]=_.filter(data,{groupName:groupName})},this),data},highlightItem:function(item){this.setHighlightedItem(item);var el=Ext.get(item);if(el){var container=el.up(".view-items");if(container){var itemTop=el.getRegion().top,itemBottom=el.getRegion().bottom,containerTop=container.getRegion().top,containerBottom=container.getRegion().bottom;if(itemTop<containerTop&&item.scrollIntoView(container,!1,!1,!1),itemTop>containerBottom&&item.scrollIntoView(container,!1,!1,!1),itemBottom>containerBottom&&item.scrollIntoView(container,!1,!1,!1),itemTop=el.getRegion().top,itemTop===containerTop){var previousSibling=Ext.get(item.previousSibling);previousSibling&&previousSibling.hasCls("rally-group-header")&&container.scroll("up",previousSibling.getHeight(),!1)}}}}}},_createSharedViewDialog:function(record){this.dialog=Ext.widget({xtype:"rallysharedviewdialog",cmp:this.cmp,enableProjectSharing:this.enableProjectSharing,addNewConfig:{expanded:"saveNewView"===record.get(this.valueField),listeners:{boxready:function(cmp){cmp.expanded&&cmp.getNameField().inputEl.focus(200)}}},additionalFilters:this.additionalFilters,context:this.getContext()})},_onCmpViewStateSave:function(){delete this.originalValue,this.reset()},reset:function(){this._clearParameters(),this.callParent()},_isViewPreference:function(record){return"preference"===record.self.typePath&&"View"===record.get("Type")&&record.get("AppId")===this.getContext().getAppId()},_isSharedView:function(record){return"workspaceViews"===record.get("groupName")||"projectViews"===record.get("groupName")},_isDefaultItem:function(record){return"defaultItems"===record.get("groupName")},_isDefaultView:function(record){return"defaultViews"===record.get("groupName")},_decodeValue:function(record){return Ext.JSON.decode(record.get("Value"),!0)},_isNonDefaultViewIdentifier:function(){return(this.sharedViewId+"").length>2},_getValue:function(record){var deferred=new Deft.Deferred;return this._isDefaultView(record)?deferred.resolve(this._decodeValue(record)):this.store.model.load(record.get("ObjectID"),{fetch:["Value"],success:function(record){deferred.resolve(this._decodeValue(record))},scope:this}),deferred.promise},_applyView:function(view){_.isFunction(this.cmp.setCurrentView)&&(this.saveState(),this.cmp.setCurrentView(view))},_getSharedViewId:function(){if(this.enableUrlSharing){var sharedViewParam=this.getSharedViewParam();if(Ext.isNumeric(sharedViewParam))return+sharedViewParam}},getSharedViewParam:function(){var hash=window.location.hash,matches=hash.match(/sharedViewId=(\d+)/);return matches&&matches[1]},_applyParameters:function(){if(this.enableUrlSharing){var record=this.getRecord();if(record){var identifier=this.getRecord().get("identifier"),viewId=Rally.util.Ref.isRefUri(identifier)?Rally.util.Ref.getOidFromRef(identifier):identifier;Rally.nav.Manager.applyParameters({sharedViewId:viewId},!1)}}},_clearParameters:function(){Rally.nav.Manager.applyParameters({},!1,["sharedViewId"])},_selectView:function(){this._getValue(this.getRecord()).then({success:this._applyView,scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardSharedViewControl",{extend:Ext.AbstractPlugin,alias:"plugin.rallygridboardsharedviewcontrol",mixins:[Rally.ui.gridboard.plugin.GridBoardControlShowable],config:{sharedViewConfig:{defaultViews:[],enableUrlSharing:!1,enableReadingUserPref:!1,suppressViewNotFoundNotification:!1},additionalFilters:[]},headerPosition:"left",init:function(cmp){this.callParent(arguments),this.showControl()},getControlCmpConfig:function(){return Ext.merge({xtype:"rallysharedviewcombobox",cmp:this.cmp,context:this.context||this.cmp.getContext(),margin:"3 0 0 0",enableUrlSharing:this.sharedViewConfig.enableUrlSharing,enableReadingUserPref:this.sharedViewConfig.enableReadingUserPref,additionalFilters:this.additionalFilters,suppressViewNotFoundNotification:this.sharedViewConfig.suppressViewNotFoundNotification},this.sharedViewConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.CollectionGridBoardApp",{alias:"widget.rallycollectiongridboardapp",extend:Rally.app.GridBoardApp,enableAddRemoveExisting:!0,isWorkspaceScoped:!0,parentField:null,parentFieldIsManyToMany:!1,parentProjectField:"Project",rootParentRecord:null,getGridConfig:function(){return _.merge(this.callParent(arguments),{height:100,inlineAddConfig:{rootParentRecord:this.rootParentRecord}})},getAddNewConfig:function(){var config={context:this.record.get(this.parentProjectField)?this.getContext().clone({project:this.record.get(this.parentProjectField)}):this.getContext(),listeners:{beforecreate:function(addNewCmp,newRecord){var value={_ref:this.record.get("_ref")};newRecord.set(this.parentField,this.parentFieldIsManyToMany?[value]:value)},beforeeditorshow:function(addNewCmp,params){params[this.parentField]=this.record.get("_ref")},scope:this}};return Rally.ui.detail.DetailHelper.featureEnabled("S108490_UPGRADE_TO_NEWEST_FILTERING_SHARED_VIEWS_ON_EDP")&&(config.margin=0),Ext.merge(this.callParent(arguments),config)},getPermanentFilters:function(){return[{property:this.parentField,operator:this.parentFieldIsManyToMany?"contains":"=",value:this.record.get("_ref")}]},getGridStores:function(){var promises=[this.callParent(arguments)];return this.collectionField&&promises.push(this._getCollectionStore()),Deft.Promise.all(promises).then({success:function(stores){return _.reduce(stores,function(result,value){return _.merge(result,value)},{})},scope:this})},_getCollectionStore:function(){var deferred=new Deft.Deferred;return this.record.getCollection(this.collectionField,_.merge({autoLoad:!0,listeners:{load:{fn:function(collectionStore){deferred.resolve({collectionStore:collectionStore})},scope:this,single:!0}}},this.getCollectionStoreConfig())),deferred.promise},getCollectionStoreConfig:function(){return{}},getFilterControlConfig:function(){var config=this.callParent(arguments);return config.whiteListFields=_.union(Rally.app.GridBoardApp.milestonesEnabled?["Milestones"]:[],config.whiteListFields),config.blackListFields=_.union([this.parentField],config.blackListFields),config},getFieldPickerConfig:function(){var config=this.callParent(arguments);return config.boardFieldBlackList=_.union([this.parentField],config.boardFieldBlackList),config.gridFieldBlackList=_.union([this.parentField],config.gridFieldBlackList),config},getBlackListFields:function(){return[this.parentField,"PortfolioItemType","ModelType"]},getWhiteListFields:function(){return["Milestones","Tags"]},getQuickFilterFields:function(){return["ArtifactSearch","Owner"]},getGridBoardConfig:function(){return _.merge(this.callParent(arguments),{height:100,listeners:{viewchange:function(){this.loadGridBoard()},scope:this}})},getGridBoardPlugins:function(options){var plugins=this.callParent(arguments),filterPlugin=Rally.ui.detail.DetailHelper.featureEnabled("S108490_UPGRADE_TO_NEWEST_FILTERING_SHARED_VIEWS_ON_EDP")?"rallygridboardinlinefiltercontrol":"rallygridboardcustomfiltercontrol";if(this.enableAddRemoveExisting){var pluginIndex=_.findIndex(plugins,function(plugin){return plugin===filterPlugin||plugin.ptype===filterPlugin});plugins=Ext.Array.insert(plugins,pluginIndex,[_.merge({ptype:"rallygridboardcollectionaddremoveexisting",context:this.context,chooserDialogConfig:{plugins:[this.getArtifactProjectFilterPluginConfig()],storeConfig:{filters:[{property:"ObjectID",operator:"!=",value:this.record.get("ObjectID")},{property:this.parentField,operator:this.parentFieldIsManyToMany?"!contains":"!=",value:Rally.util.Ref.getRelativeUri(this.record)}]},title:"Choose "+this.collectionField},collectionStoreToAddTo:options.collectionStore},this.getAddRemoveExistingPluginConfig())])}return plugins},getAddRemoveExistingPluginConfig:function(){return{}},getArtifactProjectFilterPluginConfig:function(){return{ptype:"rallyartifactprojectfilter"}},getGridBoardCustomFilterControlConfig:function(){if(Rally.ui.detail.DetailHelper.featureEnabled("S108490_UPGRADE_TO_NEWEST_FILTERING_SHARED_VIEWS_ON_EDP")){var blackListFields=this.getBlackListFields(),whiteListFields=this.getWhiteListFields(),quickFilterFields=this.getQuickFilterFields();return{ptype:"rallygridboardinlinefiltercontrol",context:this.context,inlineFilterButtonConfig:{stateful:!0,stateId:this.getScopedStateId("detail-inline-filter"),legacyStateIds:[this.getScopedStateId("owner-filter"),this.getScopedStateId("custom-filter-button")],filterChildren:!1,modelNames:this.modelNames,inlineFilterPanelConfig:{quickFilterPanelConfig:{defaultFields:quickFilterFields,addQuickFilterConfig:{blackListFields:blackListFields,whiteListFields:whiteListFields}},advancedFilterPanelConfig:{advancedFilterRowsConfig:{propertyFieldConfig:{blackListFields:blackListFields,whiteListFields:whiteListFields}}}}}}}return this.callParent(arguments)},getSharedViewConfig:function(){return Rally.ui.detail.DetailHelper.featureEnabled("S108490_UPGRADE_TO_NEWEST_FILTERING_SHARED_VIEWS_ON_EDP")?{ptype:"rallygridboardsharedviewcontrol",context:this.context,sharedViewConfig:{stateful:!0,stateId:this.getScopedStateId("detail-shared-view"),defaultViews:_.map(this._getDefaultViews(),function(view){return Ext.apply(view,{Value:Ext.JSON.encode(view.Value,!0)}),view},this),enableUrlSharing:this.isFullPageApp!==!1}}:{}},_getDefaultViews:function(){return[{Name:"Default View",identifier:1,Value:{toggleState:"grid",columns:_.map(this.getColumnCfgs(),function(columnName){return{dataIndex:columnName}})}}]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.ChildrenGridBoardApp",{extend:Rally.app.apps.CollectionGridBoardApp,loadModelNames:function(){return this.mapper=Ext.create("Rally.data.wsapi.ParentChildMapper"),this.mapper.initDynamicTypes().then({success:function(){var collectionData=_.find(this.mapper.getChildCollections(this.record.get("_type")),function(collection){return collection.collectionName.toLowerCase()===this.collectionField.toLowerCase()},this);return this.modelNames=[collectionData.typePath],this.parentField=collectionData.parentField,this.collectionField=collectionData.collectionName,this.modelNames},scope:this})},getFilterControlConfig:function(){var config=this.callParent(arguments);return _.merge(config,{blackListFields:_.union(config.blackListFields,this._getParentFields())})},getBlackListFields:function(){return _.union(this.callParent(arguments),this._getParentFields())},_getParentFields:function(){return _.pluck(this.mapper.getParentFields(this.modelNames[0]),"fieldName")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.mixins.CollectionGridStorePromisable",{createGridAndCollectionStores:function(options){Deft.Promise.all([options.gridStorePromise,this._getCollectionStore(options.record,options.fieldName)]).then({success:function(stores){options.success.call(options.scope,stores[0],stores[1])}})},_getCollectionStore:function(record,fieldName){var deferred=new Deft.Deferred;return record.getCollection(fieldName,{autoLoad:!0,listeners:{load:{fn:function(collectionStore){deferred.resolve(collectionStore)},scope:this,single:!0}}}),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.DependenciesApp",{alias:"widget.rallydependenciesapp",extend:Rally.app.App,mixins:[Rally.app.apps.mixins.CollectionGridStorePromisable],plugins:["rallygridboardappresizer"],statics:{shouldDestroyTreeStore:!1},defaultColumnNames:["Name","Release","Owner","Project"],constructor:function(config){config.defaultColumnNames=_.union(config.defaultColumnNames,this.defaultColumnNames),this.callParent(arguments)},launch:function(){this.callParent(arguments),Deft.Promise.all([this._addGridBoardContainer("Predecessors","Successors"),this._addGridBoardContainer("Successors","Predecessors")]).then({success:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.fireEvent("contentupdated",this)},scope:this})},_addGridBoardContainer:function(field,inverseField){var deferred=new Deft.Deferred,container=this.add({xtype:"container",cls:field+"-container dependency-container",items:[{xtype:"component",itemId:"dependencyTitle",html:'<div class="sub-page-header">'+field+"</div>"}]});return this.createGridAndCollectionStores({fieldName:field,gridStorePromise:this._getGridStore(),record:this.record,scope:this,success:function(gridStore,collectionStore){var stateId=this.record.get("_type").replace("/","-")+"-detail-dependencies-"+field,scopedStateId=this.getContext().getScopedStateId(stateId);container.add({xtype:"rallygridboard",itemId:"detail-gridboard-"+field,toggleState:"grid",modelNames:this._getModelNames(),context:this.getContext(),shouldDestroyTreeStore:this.self.shouldDestroyTreeStore,stateId:stateId+"-gridboard",plugins:[{ptype:"rallygridboardaddnew",addNewControlConfig:{context:this._createContextForProject(this.record.get("Project")),listeners:{beforecreate:function(addNewCmp,newRecord){newRecord.set(inverseField,[{_ref:this.record.get("_ref")}])},beforeeditorshow:function(addNewCmp,params){params[inverseField]=this.record.get("_ref")},scope:this}}},{ptype:"rallygridboardcollectionaddremoveexisting",context:this._createContextForProject(this.record.get("Project")),chooserDialogConfig:{listeners:{addfailure:function(dialog,batch){var errors=batch.exceptions[0].getError().errors;Rally.ui.notify.Notifier.showError({message:errors[1]||errors[0]})}},plugins:["rallyartifactprojectfilter"],storeConfig:{filters:[{property:"ObjectID",operator:"!=",value:this.record.get("ObjectID")},{property:field,operator:"!contains",value:Rally.util.Ref.getRelativeUri(this.record)},{property:inverseField,operator:"!contains",value:Rally.util.Ref.getRelativeUri(this.record)}]},title:"Choose "+field},collectionStoreToAddTo:collectionStore},this._getGridBoardCustomFilterControlConfig(scopedStateId),{ptype:"rallygridboardfieldpicker",stateId:scopedStateId+"-field-picker",headerPosition:"left",gridFieldBlackList:["PredecessorsAndSuccessors"]}],gridConfig:{xtype:"rallytreegrid",alwaysShowDefaultColumns:!1,columnCfgs:this.defaultColumnNames,enableBulkEdit:!1,pagingToolbarCfg:{pageSizes:[25]},plugins:["rallytreegridexpandedrowpersistence"],rowActionColumnConfig:{menuOptions:{associatedRecord:this.record,showAddChildMenuItem:!1,showAddDefects:!1,showAddTasks:!1,showAddTestCases:!1,showCopyTasksFrom:!1,showSplitMenuItem:!1}},showNewItemExcludedByFiltersWarning:!1,stateId:scopedStateId+"-grid",stateful:!0,storeConfig:{filters:[{property:inverseField,operator:"contains",value:this.record.get("_ref")}]},store:gridStore},listeners:{load:{fn:function(){deferred.resolve()},single:!0}}})}}),deferred.promise},_createContextForProject:function(project){return this.getContext().clone({project:project})},_getGridStore:function(){return Ext.create("Rally.data.wsapi.TreeStoreBuilder").build({context:this._createContextForProject(null).getDataContext(),models:this._getModelNames(),autoLoad:!1,remoteSort:!0,root:{expanded:!0},pageSize:25,enableHierarchy:!0,childPageSizeEnabled:!0,fetch:this.defaultColumnNames})},_getModelNames:function(){return[_.clone(this.record.get("_type"))]},_getGridBoardCustomFilterControlConfig:function(scopedStateId){if(Rally.ui.detail.DetailHelper.featureEnabled("S108490_UPGRADE_TO_NEWEST_FILTERING_SHARED_VIEWS_ON_EDP")){var blackListFields=["PortfolioItemType","ModelType"],whiteListFields=["Milestones","Tags"];return{ptype:"rallygridboardinlinefiltercontrol",inlineFilterButtonConfig:{stateful:!0,stateId:scopedStateId+"-inline-filter",legacyStateIds:[scopedStateId+"-custom-filter-button"],filterChildren:!1,modelNames:this._getModelNames(),inlineFilterPanelConfig:{quickFilterPanelConfig:{defaultFields:["ArtifactSearch","Owner"],addQuickFilterConfig:{blackListFields:blackListFields,whiteListFields:whiteListFields}},advancedFilterPanelConfig:{advancedFilterRowsConfig:{propertyFieldConfig:{blackListFields:blackListFields,whiteListFields:whiteListFields}}}}}}}return{ptype:"rallygridboardcustomfiltercontrol",containerConfig:{width:50},filterChildren:!1,filterControlConfig:{margin:"3 0 3 10",modelNames:this._getModelNames(),stateful:!0,stateId:scopedStateId+"-custom-filter-button",blackListFields:["PortfolioItemType"],whiteListFields:["Milestones"]},showOwnerFilter:!1}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.PortfolioItemHelper",{singleton:!0,getPercentDoneFetchFields:function(){return["PercentDoneByStoryCount","PercentDoneByStoryPlanEstimate","AcceptedLeafStoryCount","AcceptedLeafStoryPlanEstimateTotal","LeafStoryCount","LeafStoryPlanEstimateTotal","UnEstimatedLeafStoryCount","PlannedEndDate","PlannedStartDate","ActualEndDate","ActualStartDate"]},loadTypeOrDefault:function(options){function findDefault(){defaultFlag=!0,typeStore.clearFilter(!0),typeStore.filter([{property:"Creatable",operator:"=",value:"true"},{property:"Parent.Name",operator:"=",value:"Portfolio Item"}])}var defaultFlag=!1,sortDirection=options.defaultToLowest?"ASC":"DESC",typeStore=Ext.create("Rally.data.wsapi.Store",{model:Ext.identityFn("TypeDefinition"),context:options.context||{},fetch:["Name","Ordinal","TypePath"],requester:options.requester||this,sorters:[{property:"OrdinalValue",direction:sortDirection}],listeners:{load:function(store,records){0!==records.length||defaultFlag?0===records.length&&defaultFlag?options.failure&&Ext.isFunction(options.failure)&&options.failure.call(options.scope||this):options.success.call(options.scope||this,options.loadAllTypes?records:records[0]):findDefault()},scope:this}});options.typeRef?typeStore.filter({property:"ObjectID",operator:"=",value:Rally.util.Ref.getOidFromRef(options.typeRef)}):findDefault()},getPortfolioItemTypes:function(options){return options=options||{},Ext.create("Rally.data.wsapi.Store",{model:Ext.identityFn("TypeDefinition"),fetch:["Name","Ordinal","TypePath"],requester:options.requester||this,filters:[{property:"Creatable",operator:"=",value:"true"},{property:"Parent.Name",operator:"=",value:"Portfolio Item"}]}).load()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.ScheduledItemsApp",{extend:Rally.app.apps.CollectionGridBoardApp,collectionField:"Artifacts",columnNames:["Name","ScheduleState","Owner","Project"],parentField:"Milestones",parentFieldIsManyToMany:!0,parentProjectField:"TargetProject",printHeaderLabel:"Scheduled Items",statePrefix:"milestonescheduleditems",loadModelNames:function(){return Rally.data.util.PortfolioItemHelper.getPortfolioItemTypes({requester:this}).then(function(piTypes){return _.map(piTypes,function(type){return type.get("TypePath")}).concat(["userstory","defect"])})},getGridBoardCustomFilterControlConfig:function(){var customFilterControlConfig=this.callParent(arguments);return customFilterControlConfig.inlineFilterPanelConfig&&(customFilterControlConfig.inlineFilterButtonConfig.legacyStateIds=[]),customFilterControlConfig},getAddRemoveExistingPluginConfig:function(){var app=this;return _(this.callParent(arguments)).merge({chooserDialogConfig:{artifactTypes:_.pluck(this.models,"typeName")}}).merge(this.record.get("TargetProject")?{chooserDialogConfig:{storeConfig:{context:{project:this.record.get("TargetProject")._ref,projectScopeDown:!0,projectScopeUp:!1}}},onChooseClick:function(){return app.milestoneProjectOids?Deft.Promise.when():app.record.getCollection("Projects").load().then({success:function(records){app.milestoneProjectOids=_.invoke(records,"get","ObjectID")}})}}:{}).value()},getArtifactProjectFilterPluginConfig:function(){var app=this;return _.merge(this.callParent(arguments),{comboBoxConfig:{dataFilterFn:function(projectData){return!app.milestoneProjectOids||_.contains(app.milestoneProjectOids,Rally.util.Ref.getOidFromRef(projectData))}}})},getCollectionStoreConfig:function(){return _.merge(this.callParent(arguments),{collectionModel:Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(this.models,this.getContext())})},getGridConfig:function(){return _.merge(this.callParent(arguments),{enableRanking:!1})},getFilterControlConfig:function(){return _.merge(this.callParent(arguments),{whiteListFields:[]})},getGridStoreConfig:function(){return _.merge(this.callParent(arguments),{sorters:["FormattedID"]})},getWhiteListFields:function(){return _(this.callParent(arguments)).difference(["Milestones"]).union(["ModelType"]).value()},getQuickFilterFields:function(){return _.union(this.callParent(arguments),["ModelType"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.apps.TasksGridBoardApp",{extend:Rally.app.apps.ChildrenGridBoardApp,isWorkspaceScoped:!1})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.app.plugin.Print",{extend:Rally.ui.plugin.print.Print,alias:"plugin.rallyappprinting",init:function(component){component.self.mixin("printable",Rally.app.Printable),this.callParent(arguments)},getContent:function(){return this.getCmp().getPrintContent()},getHeader:function(){return this.getCmp().getPrintHeaderContent()},getFooter:function(){return this.getCmp().getPrintFooterContent()},getTopToolbar:function(){return this.getCmp().getPrintTopToolbarContent()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.auth.UserPermissions",{constructor:function(userPermissions){this.userPermissions=userPermissions},getProjectToWorkspaceMap:function(){var shouldCache=Rally.environment.narrowJsScriptingValley;if(shouldCache&&this.projectToWorkspaceMap)return this.projectToWorkspaceMap;var projectToWorkspaceMap={};return this.userPermissions.forEach(function(permission){if(permission.Workspace){var projectOid=Rally.util.Ref.getOidFromRef(permission._ref),workspaceOid=Rally.util.Ref.getOidFromRef(permission.Workspace);projectToWorkspaceMap[projectOid]=workspaceOid}}),shouldCache&&(this.projectToWorkspaceMap=projectToWorkspaceMap),projectToWorkspaceMap},isSubscriptionAdmin:function(){var workspaceRef=Rally.environment.getContext().getWorkspace()._ref;return this.isInRoleForScope("Subscription Admin",workspaceRef)},isWorkspaceAdmin:function(workspaceRef){return workspaceRef=workspaceRef||Rally.environment.getContext().getWorkspace()._ref,this.isInRoleForScope("Workspace Admin",workspaceRef)},isWorkspaceAdminInAnyWorkspace:function(){return this._hasRoleInAnyWorkspace("Workspace Admin")},isProjectAdmin:function(projectRef){return projectRef=projectRef||Rally.environment.getContext().getProject()._ref,this.isInRoleForScope("ProjectAdmin",projectRef)},isProjectAdminInAnyProject:function(){return this._hasRoleForAnyProjectInCurrentWorkspace("ProjectAdmin")},isProjectAdminInAnyWorkspace:function(){return this._hasRoleInAnyWorkspace("ProjectAdmin")},hasEditorAccessToAnyProject:function(){return this.isProjectAdminInAnyProject()||this._hasRoleForAnyProjectInCurrentWorkspace("Editor")},isWorkspaceOrSubscriptionAdmin:function(workspaceRef){return this.isSubscriptionAdmin()||this.isWorkspaceAdmin(workspaceRef)},isProjectWorkspaceOrSubscriptionAdmin:function(){return this.isSubscriptionAdmin()||this.isWorkspaceAdmin()||this.isProjectAdmin()},isProjectEditor:function(projectRef){return this.isSubscriptionAdmin()||this.isInRoleForScope("ProjectAdmin",projectRef)||this.isInRoleForScope("Editor",projectRef)},isInRoleForScope:function(role,scopeRef){var permission=this.getPermissionAtScope(scopeRef);return permission&&permission.Role===role},getPermissionAtScope:function(scopeRef){return this._scopeRoleMap=this._scopeRoleMap||this._generateScopeRoleMap(),this._scopeRoleMap[Rally.util.Ref.getRelativeUri(scopeRef)]},_generateScopeRoleMap:function(){for(var map={},i=0,l=this.userPermissions.length;i<l;++i){var userPerm=this.userPermissions[i],ref=Rally.util.Ref.getRelativeUri(userPerm._ref);map[ref]=userPerm}return map},_hasRoleForAnyProjectInCurrentWorkspace:function(accessLevel){var workspaceRef=Rally.environment.getContext().getWorkspace()._ref+".js";return _.some(this.userPermissions,function(perm){return perm.Workspace&&perm.Workspace===workspaceRef&&perm.Role===accessLevel})},_hasRoleInAnyWorkspace:function(accessLevel){return _.some(this.userPermissions,function(perm){return perm.Role===accessLevel})}})}(),function(){var Ext=window.Ext4||window.Ext,_ajaxRequestId="__clientMetricsAjaxRequestId__";Ext.define("Rally.clientmetrics.ClientMetricsAggregator",{mixins:{messageable:Rally.Messageable},constructor:function(config){var ajaxProviders=config.ajaxProviders||[];
delete config.ajaxProviders,this.callParent(arguments),this.aggregator=new RallyMetrics.Aggregator(config),this.messageBus=this.messageBus||Rally.environment.getMessageBus(),this.subscribe(Rally.clientmetrics.Message.startSession,this._onStartSession,this),this.subscribe(Rally.clientmetrics.Message.loadBegin,this._onLoadBegin,this),this.subscribe(Rally.clientmetrics.Message.loadEnd,this._onLoadEnd,this),this.subscribe(Rally.clientmetrics.Message.action,this._onUserAction,this,this.actionOpts||{}),this.subscribe(Rally.clientmetrics.Message.error,this._onError,this,this.actionOpts||{}),this.subscribe(Rally.clientmetrics.Message.componentReady,this._onComponentReady,this),this.subscribe(Rally.clientmetrics.Message.dataBegin,this._onAjaxBeforeRequest,this),this.subscribe(Rally.clientmetrics.Message.dataEnd,this._onAjaxRequestComplete,this),_.isArray(ajaxProviders)&&_.each(ajaxProviders,this._wireAjaxHandlers,this)},destroy:function(){this.aggregator.destroy()},sendAllRemainingEvents:function(){this.aggregator.sendAllRemainingEvents()},addAjaxProvider:function(provider){this._wireAjaxHandlers(provider)},addHandler:function(handler,index){this.aggregator.addHandler(handler,index)},_wireAjaxHandlers:function(provider){provider.on("beforerequest",this._onAjaxBeforeRequest,this),provider.on("requestcomplete",this._onAjaxRequestComplete,this)},_onStartSession:function(options){this.aggregator.startSession(options.status,options.defaultParams)},_onUserAction:function(options){this.aggregator.recordAction(this._translateMessageVersion(arguments))},_onError:function(options){this.aggregator.recordError(options)},_onComponentReady:function(options){this.aggregator.recordComponentReady(options)},_onLoadBegin:function(options){this.aggregator.beginLoad(this._translateMessageVersion(arguments))},_onLoadEnd:function(options){this.aggregator.endLoad(this._translateMessageVersion(arguments))},_onAjaxBeforeRequest:function(connection,options){var requester=this._findRequester(connection,options);if(requester){var metricsData=this.aggregator.beginDataRequest(requester,options.url);metricsData&&(options[_ajaxRequestId]=metricsData.requestId,connection.defaultHeaders=metricsData.xhrHeaders)}options[_ajaxRequestId]||(connection.defaultHeaders={})},_onAjaxRequestComplete:function(connection,response,options){var requester=this._findRequester(connection,options);if(requester){var ajaxRequestId=options[_ajaxRequestId];ajaxRequestId&&this.aggregator.endDataRequest(requester,response,ajaxRequestId)}},_translateMessageVersion:function(messageArgs){messageArgs=_.toArray(messageArgs);var firstParamIsAComponent=!!this.aggregator.getComponentType(messageArgs[0]);return firstParamIsAComponent&&_.isString(messageArgs[1])?{component:messageArgs[0],description:messageArgs[1],miscData:messageArgs[2]||{}}:firstParamIsAComponent&&messageArgs[1]&&_.isString(messageArgs[1].description)?_.extend(messageArgs[1],{component:messageArgs[0]}):firstParamIsAComponent?{component:messageArgs[0]}:messageArgs[0]},_findRequester:function(connection,options){return options.requester||connection.requester||options.operation&&options.operation.requester}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.ErrorListener",{constructor:function(){this.previousHandler=Ext.Error.handle,Ext.Error.handle=this._extErrorHandler},destroy:function(){Ext.Error.handle=this.previousHandler},_extErrorHandler:function(error){return Rally.environment.getMessageBus().publish(Rally.clientmetrics.Message.error,new Error(error.msg)),!0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.Ext4Handler",{getComponentType:function(cmp){if(cmp.$className){if(cmp.clientMetricsComponentTypeProperty){var cmct=cmp[cmp.clientMetricsComponentTypeProperty];return Ext.isFunction(cmct)&&(cmct=cmct.call(cmp)),cmct}var className=cmp.$className,period=className.lastIndexOf(".");return period>=0?className.substring(period+1):className}},getAppName:function(cmp){if(cmp.$className&&Ext.isFunction(cmp.up)){var app=cmp.up("rallyapp");if(app)return app.appName||this.getComponentType(app)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.MonitorWindow",{singleton:!0,logBuffer:50,paused:!1,reportingDiv:null,toggleWindow:function(){this.parentDiv.style.display="block"===this.parentDiv.style.display?"none":"block"},start:function(){this._isReportingDivWritten()?Ext.log("monitor window already in the dom, not recreating"):this._createMonitorDiv()},logEvent:function(event){if(this._isReportingDivWritten()){var newDiv=document.createElement("div"),now=new Date;newDiv.innerHTML=now.getFullYear()+"/"+("0"+(now.getMonth()+1)).slice(-2)+"/"+("0"+now.getDate()).slice(-2)+" "+("0"+now.getHours()).slice(-2)+":"+("0"+now.getMinutes()).slice(-2)+":"+("0"+now.getSeconds()).slice(-2)+"."+("00"+now.getMilliseconds()).slice(-3)+" - "+(event.toString&&event.toString()||event),newDiv.style.whiteSpace="nowrap",newDiv.style.overflow="hidden",newDiv.style["text-overflow"]="ellipsis",newDiv.addEventListener("click",function(event){newDiv.style["background-color"]?setTimeout(function(){newDiv.style["background-color"]=""},100):newDiv.style["background-color"]="yellow",newDiv.style.whiteSpace="nowrap"===newDiv.style.whiteSpace?"pre":"nowrap"}),this.reportingDiv.appendChild(newDiv),newDiv.scrollIntoView(!1)}},_prune:function(){var reportingDiv=this.reportingDiv,childCount=reportingDiv.childNodes&&reportingDiv.childNodes.length||0;childCount>this.logBuffer&&reportingDiv.removeChild(reportingDiv.childNodes[reportingDiv.length])},_createMonitorDiv:function(){if(this.reportingDiv)return this.reportingDiv;try{var div=Ext.DomHelper.append(Ext.getBody(),{tag:"div",style:{position:"absolute",bottom:0,right:0,height:"150px",width:"100%",overflow:"scroll",background:"wheat",opacity:.9,"z-index":100,display:"block"},children:[{tag:"div"}]});this.reportingDiv=div.childNodes[0],this.parentDiv=div}catch(e){Ext.log(e),this.reportingDiv=void 0}return this.reportingDiv},_isReportingDivWritten:function(){return this.reportingDiv}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Ajax",{singleton:!0,inFlight:0,start:function(){Ext.Function.interceptBefore(Ext.Ajax,"request",function(){var requestConfig=arguments[0];requestConfig.monitor={started:(new Date).getTime()},Rally.clientmetrics.monitors.Ajax.inFlight++,Rally.environment.getMessageBus().publish(Rally.Message.ajaxRequests,{type:"XHR start, pending: ",toString:function(){return[this.type,Rally.clientmetrics.monitors.Ajax.inFlight,requestConfig.method,requestConfig.url,requestConfig.params.query].join(" ")}},window);var callback=requestConfig.callback;requestConfig.callback=function(){var requestConfig=arguments[0];Rally.clientmetrics.monitors.Ajax.inFlight++,Rally.environment.getMessageBus().publish(Rally.Message.ajaxRequests,{type:"XHR end, pending: ",toString:function(){return[this.type,Rally.clientmetrics.monitors.Ajax.inFlight,"elapsed time (ms):",(new Date).getTime()-requestConfig.monitor.started].join(" ")}},window),delete requestConfig.monitor,callback&&callback.apply(this,arguments)}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Monitor",{latencyThreshold:500,highLatency:!1,latencyExceededMessage:"Latency threshold exceeded.",latencyThresholdExceeded:function(latency,timeInterval){throw"Unimplemented latencyThresholdExceeded method in subclass of Rally.clientmetrics.monitors.Monitor."},report:function(latency,timeInterval){latency>this.latencyThreshold?(Ext.log(timeInterval+" "+this.latencyExceededMessage+" "+latency),this.latencyThresholdExceeded(latency,timeInterval),this.highLatency=!0):this.highLatency=!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Default",{extend:Rally.clientmetrics.monitors.Monitor,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},latencyThreshold:200,publishThreshold:350,latencyExceededMessage:"Latency threshold exceeded. Custom message.",latencyThresholdExceeded:function(latency,timeInterval){if(document.hasFocus()){var now=(new Date).getTime();Ext.log(timeInterval+" latency exceeded! - "+latency),Rally.environment.getMessageBus().publish(Rally.Message.clientLatency,{latency:latency,time:now,type:"clientLatency",toString:function(){return[this.type," latency: ",this.latency," ts: ",this.time].join("")}},window),latency>=this.publishThreshold&&(this.recordLoadBegin({description:"Client latency (estimated)",startTime:now-latency,miscData:{latencyDetected:latency,latencyInterval:timeInterval}}),this.recordLoadEnd({stopTime:now}))}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.ExtBus",{extend:Rally.clientmetrics.monitors.Monitor,latencyThreshold:400,extMessageBuffer:[],messageBufferSize:25,latencyExceededMessage:"Start tracking Ext message bus messages",constructor:function(){Ext.util.Observable.prototype.fireEvent=Ext.Function.createInterceptor(Ext.util.Observable.prototype.fireEvent,function(evt){this.highLatency&&Ext.log(" *Ext* "+arguments[0]+"\t\t fires: "+evt),this.extMessageBuffer.push({ts:(new Date).getTime(),cls:arguments[1].$className,event:arguments[0]}),this.extMessageBuffer.length>this.messageBufferSize&&(this.extMessageBuffer=this.extMessageBuffer.slice(0,1))},this)},latencyThresholdExceeded:function(latency,timeInterval){Ext.log("ExtMessageBus Dump (starting enhanced logging) : "),Ext.log(this._formatBuffer())},_formatBuffer:function(){for(var formattedLog="",i=0;i<this.extMessageBuffer.length;i++)formattedLog+=this.extMessageBuffer[i].ts+",\t"+this.extMessageBuffer[i].cls+",\t\t"+this.extMessageBuffer[i].event+"\n";return formattedLog}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Layout",{singleton:!0,layoutCount:0,loadTS:null,start:function(){Ext.override(Ext.layout.Context,{run:function(){var layoutMonitor=Rally.clientmetrics.monitors.Layout;null===layoutMonitor.loadTS&&(layoutMonitor.loadTS=layoutMonitor.getNow());var start=layoutMonitor.getNow(),layoutResult=this.callParent();return Rally.environment.getMessageBus().publish(Rally.Message.layout,{layoutTime:layoutMonitor.getNow()-start,layoutCount:++layoutMonitor.layoutCount,type:"layout",toString:function(){return[this.type,"time:",this.layoutTime,"count:",this.layoutCount,"stack:",layoutMonitor.getStack()].join(" ")}},window),layoutMonitor.layoutsDone(),layoutResult}})},layoutsDone:function(){this.layoutsDoneTimeout&&window.clearTimeout(this.layoutsDoneTimeout),this.layoutsDoneTimeout=window.setTimeout(function(){var layoutMonitor=Rally.clientmetrics.monitors.Layout,now=layoutMonitor.getNow();Rally.environment.getMessageBus().publish(Rally.Message.layout,{type:"time between first and last layout: ",toString:function(){return[this.type,":",now-layoutMonitor.loadTS-1500].join(" ")}},window),layoutMonitor.resetCounters()},1500)},resetCounters:function(){var layoutMonitor=Rally.clientmetrics.monitors.Layout;layoutMonitor.loadTS=null,layoutMonitor.layoutCount=0},getNow:function(){return window.performance&&window.performance.now()||(new Date).getTime()},getStack:function(){return(new Error).stack.substring(7)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.MessageBus",{extend:Rally.clientmetrics.monitors.Monitor,latencyThreshold:500,messageBuffer:[],messageBufferSize:25,latencyExceededMessage:"Start tracking rally message bus messages",constructor:function(){Rally.environment.getMessageBus().publish=Ext.Function.createInterceptor(Rally.environment.getMessageBus().publish,function(){this.highLatency&&Ext.log(" *Rally* "+arguments[0]+"\t\t"+this._attemptToGetALoggableValue(arguments[1])),this.messageBuffer.push({ts:(new Date).getTime(),cls:this._attemptToGetALoggableValue(arguments[1]),event:arguments[0]}),this.messageBuffer.length>this.messageBufferSize&&(this.messageBuffer=this.messageBuffer.slice(0,1))},this)},latencyThresholdExceeded:function(latency,timeInterval){Ext.log("RallyMessageBus Dump (starting enhanced logging) : "),Ext.log(this._formatBuffer())},_formatBuffer:function(){for(var formattedLog="",i=0;i<this.messageBuffer.length;i++)formattedLog+=this.messageBuffer[i].ts+",\t"+this.messageBuffer[i].cls+",\t\t"+this.messageBuffer[i].event+"\n";return formattedLog},_attemptToGetALoggableValue:function(loggableObject){if(loggableObject&&loggableObject.description)return loggableObject.description;if(loggableObject&&loggableObject.component){if(loggableObject.component.$className)return loggableObject.component.$className;if(loggableObject.component.clientMetricsParent)return"clientmetrics"}return loggableObject&&loggableObject.$className?loggableObject.$className:"string"==typeof loggableObject?loggableObject:""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Performance",{singleton:!0,collectionInterval:1e3,intervalDelay:200,maxEventBuffer:50,monitors:[],metrics:{meta:[]},eventLoopTimer:{},paused:!1,constructor:function(){Ext.log("Performance constructor")},start:function(){this.eventLoopTimer=setTimeout(this.getTracker(),this.intervalDelay)},stop:function(){clearTimeout(this.eventLoopTimer)},pause:function(){Rally.clientmetrics.monitors.Performance.paused=!Rally.clientmetrics.monitors.Performance.paused},getLog:function(){var response="";for(var second in Rally.clientmetrics.monitors.Performance.metrics)"summary"!==second&&"meta"!==second&&(response+=second+":"+Rally.clientmetrics.monitors.Performance.metrics[second].avg+"<br/>");return"oldest at top (last "+this.maxEventBuffer+" events) <br/>"+response},addMonitor:function(monitor){if("Rally.clientmetrics.monitors.Monitor"!==monitor.superclass.$className)throw"Monitors must extend Rally.clientmetrics.monitors.Monitor.";this.monitors.push(monitor)},getMonitors:function(){return this.monitors},getTracker:function(){return this.tracker||(this.tracker=function(){var startTime=(new Date).getTime(),now=startTime;return function(){if(!Rally.clientmetrics.monitors.Performance.paused){if(Rally.clientmetrics.monitors.Performance.metrics[startTime]||(Rally.clientmetrics.monitors.Performance.metrics[startTime]={avg:0,count:0,sumDelay:0},Rally.clientmetrics.monitors.Performance.metrics.meta.push(startTime)),Rally.clientmetrics.monitors.Performance.metrics[startTime].sumDelay+=(new Date).getTime()-now-Rally.clientmetrics.monitors.Performance.intervalDelay,Rally.clientmetrics.monitors.Performance.metrics[startTime].count++,startTime+Rally.clientmetrics.monitors.Performance.collectionInterval<now){Rally.clientmetrics.monitors.Performance.metrics[startTime].avg=Math.floor(Rally.clientmetrics.monitors.Performance.metrics[startTime].sumDelay/Rally.clientmetrics.monitors.Performance.metrics[startTime].count);for(var monitor in Rally.clientmetrics.monitors.Performance.monitors)if(Rally.clientmetrics.monitors.Performance.monitors.hasOwnProperty(monitor))try{Rally.clientmetrics.monitors.Performance.monitors[monitor].report(Rally.clientmetrics.monitors.Performance.metrics[startTime].sumDelay,startTime)}catch(e){Ext.log(e)}startTime=now}Rally.clientmetrics.monitors.Performance.maxEventBuffer<Rally.clientmetrics.monitors.Performance.metrics.meta.length&&(delete Rally.clientmetrics.monitors.Performance.metrics[Rally.clientmetrics.monitors.Performance.metrics.meta[0]],Rally.clientmetrics.monitors.Performance.metrics.meta=Rally.clientmetrics.monitors.Performance.metrics.meta.slice(1))}this.eventLoopTimer=setTimeout(Rally.clientmetrics.monitors.Performance.getTracker(),Rally.clientmetrics.monitors.Performance.intervalDelay),now=(new Date).getTime()}}()),this.tracker}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.clientmetrics.monitors.Render",{singleton:!0,renderCount:0,renderTS:null,start:function(){Ext.override(Ext.AbstractComponent,{render:function(){var renderMonitor=Rally.clientmetrics.monitors.Render;null===renderMonitor.renderTS&&(renderMonitor.renderTS=renderMonitor.getNow());var start=renderMonitor.getNow(),renderResult=this.callParent(arguments);return Rally.environment.getMessageBus().publish(Rally.Message.render,{renderTime:renderMonitor.getNow()-start,renderCount:++renderMonitor.renderCount,type:"render",toString:function(){return[this.type,"time:",this.renderTime,"count:",this.renderCount,"stack:",renderMonitor.getStack()].join(" ")}},window),renderMonitor.rendersDone(),renderResult}})},rendersDone:function(){this.rendersDoneTimeout&&window.clearTimeout(this.rendersDoneTimeout),this.rendersDoneTimeout=window.setTimeout(function(){var renderMonitor=Rally.clientmetrics.monitors.Render,now=renderMonitor.getNow();Rally.environment.getMessageBus().publish(Rally.Message.render,{type:"time between first and last render: ",toString:function(){return[this.type,":",now-renderMonitor.renderTS-1500].join(" ")}},window),renderMonitor.resetCounters()},1500)},resetCounters:function(){var renderMonitor=Rally.clientmetrics.monitors.Render;renderMonitor.renderTS=null,renderMonitor.renderCount=0},getNow:function(){return window.performance&&window.performance.now()||(new Date).getTime()},getStack:function(){return(new Error).stack.substring(7)}})}(),function(){function stripDc(url){return url.replace(/_dc=(\d)+/g,"")}var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.RequestGrouper",{singleton:!0,enable:function(existingConnection){existingConnection._originalRequest=existingConnection.request,existingConnection.request=this.request,existingConnection.on("requestcomplete",this._onRequestComplete,this),existingConnection.on("requestexception",this._onRequestException,this)},request:function(options){if(options=options||{},"GET"!==options.method||!options.enableQueuing||options.isUpload)return this._originalRequest.apply(this,arguments);var inFlightRequest=_.find(this.requests,function(request){return stripDc(request.options.url)===stripDc(options.url)&&_.isEqual(request.options.params,options.params)&&!request.complete});return inFlightRequest&&inFlightRequest.options.enableQueuing?(inFlightRequest.queue=inFlightRequest.queue||[],inFlightRequest.queue.push(options),inFlightRequest):this._originalRequest.apply(this,arguments)},_resolveQueue:function(response,success,callbackName){if(response.request){response.request.complete=!0;var queue=response.request.queue||[];_.isEmpty(queue)||Ext.defer(function(){_.each(queue,function(groupedRequest){Ext.callback(groupedRequest[callbackName],groupedRequest.scope,[response,groupedRequest]),Ext.callback(groupedRequest.callback,groupedRequest.scope,[groupedRequest,success,response])})},1)}},_onRequestComplete:function(connection,response){this._resolveQueue(response,!0,"success")},_onRequestException:function(connection,response){this._resolveQueue(response,!1,"failure")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.Store",{extend:Ext.data.Store,load:function(options){options=options||{};var originalCallback,me=this,deferred=new Deft.promise.Deferred;return Ext.isFunction(options)?(originalCallback=options,options={}):originalCallback=options.callback,options.callback=function(records,operation,success){originalCallback&&originalCallback.apply(options.scope||me,arguments),me._restoreCallback(options,originalCallback),me._restoreCallback(me.lastOptions,originalCallback),success?deferred.resolve({records:records,operation:operation}):deferred.reject(operation)},this.callParent([options]),deferred.promise},_restoreCallback:function(options,callback){options&&(options.callback=callback)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.custom.Proxy",{extend:Ext.data.proxy.Memory,alias:"proxy.custom",read:function(operation,callback,scope){var sorters,filters,sorterFn,records,reader=this.getReader(),result=reader.read(this.data);scope=scope||this,filters=operation.filters||[],filters.length>0&&(records=[],Ext.each(result.records,function(record){var i,isMatch=!0,length=filters.length;for(i=0;i<length;i++){var filter=filters[i],fn=filter.filterFn,scope=filter.scope||filter;isMatch=isMatch&&(fn.call(scope,record)||this._evaluateFilter(filter,record))}isMatch&&records.push(record)},this),result.records=records,result.totalRecords=result.total=records.length),sorters=operation.sorters||[],sorters.length>0&&(sorterFn=function(r1,r2){var i,result=sorters[0].sort(r1,r2),length=sorters.length;for(i=1;i<length;i++)result=result||sorters[i].sort.call(this,r1,r2);return result},result.records.sort(sorterFn)),void 0!==operation.start&&void 0!==operation.limit&&(result.records=result.records.slice(operation.start,operation.start+operation.limit),result.count=result.records.length),Ext.apply(operation,{resultSet:result}),operation.setCompleted(),operation.setSuccessful(),Ext.callback(callback,scope,[operation],1)},_evaluateFilter:function(filter,record){var value=record;return Ext.Array.each(filter.property.split("."),function(property){return!(!Ext.isDefined(value)||null===value)&&void(value=Ext.isFunction(value.get)?value.get(property):value[property])}),(!filter.operator||"="===filter.operator)&&value===filter.value}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.custom.Store",{extend:Ext.data.Store,mixins:{findRecords:Rally.data.WsapiFindRecords},alias:"store.rallycustom",config:{fields:[],data:[]},remoteSort:!0,proxy:"custom",constructor:function(config){config.fields||(config.fields=[],config.data&&config.data.length>0&&Ext.Object.each(config.data[0],function(key,value){config.fields.push({name:key})},this)),this.callParent(arguments)},findExact:function(property,value,start){return this.mixins.findRecords.findExact.call(this,property,value,start)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.detail.DetailPagePreference",{singleton:!0,detailPagePreferencePrefix:"detailpage.beta",edpJustEnabledKey:"edpJustEnabled",toggleDetailPage:function(artifactType,enabled,callback,scope){if(enabled)try{sessionStorage[this.edpJustEnabledKey]=!0}catch(e){}scope=scope||this;var pref={},name=this.getPreferenceName(artifactType);pref[this.getPreferenceName(artifactType)]=enabled,Rally.data.PreferenceManager.update({filterByUser:!0,filterByName:name,settings:pref,success:callback,scope:scope})},getPreferenceName:function(artifactType){return this.detailPagePreferencePrefix+"."+artifactType},isDetailPageEnabled:function(artifactType,callback,scope){Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:this.getPreferenceName(artifactType),success:function(prefs){var isEnabled=prefs[this.getPreferenceName(artifactType)];callback.apply(scope,["true"===isEnabled])},scope:this})},hasDetailPagePreference:function(artifactType,callback,scope){Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:this.getPreferenceName(artifactType),success:function(prefs){var isEnabled=prefs[this.getPreferenceName(artifactType)];callback.apply(scope,[void 0!==isEnabled])},cache:!1,scope:this})},wasJustEnabled:function(){return!!sessionStorage[this.edpJustEnabledKey]},clearJustEnabled:function(){try{sessionStorage.removeItem(this.edpJustEnabledKey)}catch(e){}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.grouped.Proxy",{extend:Ext.data.proxy.Memory,alias:"proxy.rallygrouped",constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},read:function(operation,callback,scope){var result=this.getReader().read(this.data),records=result.records;this._initBuckets(),Ext.Array.forEach(records,this._putInBucket,this),this._sortEachBucket(),this._addItems(),this._convertEachBucket(),result.records=this._mergeBuckets(),Ext.apply(operation,{resultSet:result}),operation.setCompleted(),operation.setSuccessful(),Ext.callback(callback,scope,[operation])},getGroup:function(title){return this._getBucket(title)},_initBuckets:function(){this._buckets={},Ext.Array.forEach(this.groups,function(group){this._setBucket(group.title,[])},this),this._processed={}},_setBucket:function(title,data){this._buckets[title||""]=data},_getBucket:function(title){return this._buckets[title||""]},_putInBucket:function(record){this._hasBeenProcessed(record)||(Ext.Array.each(this.groups,function(group){if(!group.predicate||group.predicate(record))return this._getBucket(group.title).push(record),!1},this),this._processed[record.get("_ref")]=!0)},_sortEachBucket:function(){var sortBy=this.sortBy,sortFn=function(a,b){var aVal=a.get(sortBy),bVal=b.get(sortBy);return aVal<bVal?-1:aVal===bVal?0:1};Ext.Object.each(this._buckets,function(title,records){records.sort(sortFn)})},_addItems:function(){Ext.Array.forEach(this.addItems||[],function(item){var group=this._getBucket(item.group),items=this._convertItemsToAdd(item.group,item.items);Ext.Array.insert(group,0,items)},this)},_convertItemsToAdd:function(groupName,items){return Ext.Array.map(items,function(item){return new this.model({_ref:item.value,_refObjectName:item.displayName,_groupName:groupName})},this)},_convertEachBucket:function(){Ext.Array.forEach(this.groups,function(group){var currentRecords=this._getBucket(group.title);this._setBucket(group.title,this._convertRecords(currentRecords,group.title))},this)},_convertRecords:function(records,groupName){return Ext.Array.map(records,function(record){return new this.model(Ext.apply(record.data,{_groupName:groupName}))},this)},_hasBeenProcessed:function(record){return this._processed[record.get("_ref")]},_mergeBuckets:function(){var merged=[];return Ext.Array.forEach(this.groups,function(group){merged=merged.concat(this._getBucket(group.title))},this),merged}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.grouped.Store",{extend:Ext.data.Store,constructor:function(){this.fields=["_groupName","_ref","_refObjectName"],this.callParent(arguments)},load:function(config){config&&(config.model=this.model,this.proxy=Ext.create("Rally.data.grouped.Proxy",config)),this.callParent(arguments)},getRecordsInGroup:function(name){return this.proxy.getGroup(name)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.QueryFilter",{requires:[],extend:Ext.util.Filter,statics:{fromExtFilter:function(filter){var operator=filter.operator;return operator||(operator=filter.anyMatch?"Contains":"="),Ext.create("Rally.data.lookback.QueryFilter",{property:filter.property,operator:operator,value:filter.value})},and:function(queries){var anded=null;return Ext.each(queries,function(query){var q=Ext.create("Rally.data.lookback.QueryFilter",query);anded=anded?anded.and(q):q}),anded},or:function(queries){var ored=null;return Ext.each(queries,function(query){var q=Ext.create("Rally.data.lookback.QueryFilter",query);ored=ored?ored.or(q):q}),ored}},config:{operator:"="},root:"data",constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},_getOperator:function(op){return{"!=":"$ne",">":"$gt",">=":"$gte","<":"$lt","<=":"$lte",in:"$in",exists:"$exists"}[op]||op},_joinQuery:function(filter,joinOperator){var other;return other=filter._createQueryString&&filter.operator?filter:Rally.data.lookback.QueryFilter.fromExtFilter(filter),Ext.create("Rally.data.lookback.QueryFilter",{property:this,operator:joinOperator,value:other})},toObject:function(){var obj={};if("="===this.operator)obj[this.property]=this.value;else if("contains"===this.operator.toLowerCase())obj[this.property]=new RegExp(".*"+this.value+".*","i");else if("$and"===this.operator)obj=Ext.merge({},this.property.toObject(),this.value.toObject());else if("$or"===this.operator){var or=[];Ext.Array.each([this.property.toObject(),this.value.toObject()],function(queryObj){queryObj.$or?or=or.concat(queryObj.$or):or.push(queryObj)}),obj.$or=or}else{var value={};value[this._getOperator(this.operator)]=this.value,obj[this.property]=value}return obj},and:function(filter){return this._joinQuery(filter,"$and")},or:function(filter){return this._joinQuery(filter,"$or")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.SnapshotModel",{requires:[],extend:Rally.data.Model,idProperty:"_id",fields:[{name:"_id",displayName:"Snapshot ID",type:"STRING",persist:!1},{name:"ObjectID",displayName:"Object ID",type:"INT",persist:!1},{name:"Project",displayName:"Project OID",type:"INT",persist:!1},{name:"_ValidFrom",displayName:"Valid From",type:"DATE",dateFormat:"c",persist:!1},{name:"_ValidTo",displayName:"Valid To",type:"DATE",dateFormat:"c",persist:!1}]})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.SnapshotRestProxy",{extend:Ext.data.proxy.Rest,alias:["proxy.rally.data.lookback.snapshot.rest","proxy.rallylookbackproxy"],format:"js",filterParam:"find",limitParam:void 0,sortParam:"sort",pageParam:void 0,startParam:void 0,timeout:3e5,find:void 0,reader:{type:"json",root:"Results",totalProperty:"TotalResultCount"},constructor:function(config){config.context=config.context||Rally.environment.getContext().getDataContext(),config.headers=Ext.merge({},this.headers,config.headers),this.mergeConfig(config),this.callParent([this.config]),this.url=this._buildRootUrl(),this.actionMethods=this._buildActionMethods(config.useHttpPost)},_buildRootUrl:function(){return Rally.environment.getServer().getLookbackUrl(this.version)+"/service/rally/workspace/"+Rally.util.Ref.getOidFromRef(this.context.workspace)+"/artifact/snapshot/query"},_buildActionMethods:function(useHttpPost){var readMethod=useHttpPost?"POST":"GET";return{create:"POST",read:readMethod,update:"POST",destroy:"POST"}},buildRequest:function(operation){var request=this.callParent(arguments);return Ext.apply(request.params,{fields:Ext.JSON.encode(this.fetch),hydrate:Ext.JSON.encode(this.hydrate),pagesize:operation.limit,start:operation.start,compress:this.compress,removeUnauthorizedSnapshots:this.removeUnauthorizedSnapshots,find:this.encodeFilters(operation.filters),includeTotalResultCount:this.includeTotalResultCount}),request.params[this.sortParam]||(request.params[this.sortParam]=this.encodeSorters(operation.sorters)),request.noQueryScoping=!0,request},_encodeFilters:function(filters){var query,find=this.find;return filters&&filters.length&&(Ext.each(filters,function(filter){query=query?query.and(filter):filter instanceof Rally.data.lookback.QueryFilter?filter:Rally.data.lookback.QueryFilter.fromExtFilter(filter)}),query=query.toObject()),find&&("string"==typeof find&&(find=Ext.decode(find)),query=query?{$and:[query,find]}:find),query||{}},encodeFilters:function(filters){var implicitFind=this._getImplicitFilters(),find=this._encodeFilters(implicitFind.concat(filters||[]));return Ext.JSON.encode(find)},_getImplicitFilters:function(){var implicitFilters=[];return this._etlDate&&implicitFilters.push({property:"_ValidFrom",operator:"<=",value:this._etlDate}),implicitFilters},encodeSorters:function(sorters){var sortObj={};return Ext.isObject(sorters)&&(sorters=[sorters]),Ext.isArray(sorters)&&sorters.length?(Ext.Array.each(sorters,function(sorter){sortObj[sorter.property]="ASC"===sorter.direction?1:-1}),Ext.JSON.encode(sortObj)):this.sort&&_.keys(this.sort).length?Ext.JSON.encode(this.sort):""},processResponse:function(success,operation,request,response,callback,scope){if(success){var r=this.parseResponse(response);r.Errors&&r.Errors.length>0?success=!1:this._etlDate=r.ETLDate}this.callParent([success,operation,request,response,callback,scope])},parseResponse:function(response){return Ext.JSON.decode(response.responseText)},setException:function(operation,response){this.callParent(arguments);var error=operation.getError()||{};try{Ext.apply(error,{errors:this.parseResponse(response).Errors})}catch(e){}operation.setException(error)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.SnapshotStore",{extend:Rally.data.PageableStore,alias:"store.rallysnapshotstore",defaultFetch:["ObjectID","_ValidFrom","_ValidTo","Project"],config:{pageSize:2e4,context:void 0,fetch:[],hydrate:[],findConfig:void 0,filters:void 0,sortConfig:void 0,compress:!1,
removeUnauthorizedSnapshots:!1,exceptionHandler:function(){},useHttpPost:!1,headers:{},version:"v2.0",includeTotalResultCount:!0},constructor:function(config){var conf=Ext.clone(config||{});conf.fetch=this._buildFetch(conf.fetch),conf.sortConfig=conf.sortConfig||conf.sort||{_ValidFrom:1},delete conf.sort,conf.findConfig=conf.findConfig||conf.find,delete conf.find,this.initConfig(conf),this._setModel(),this.callParent([conf])},_buildFetch:function(fetch){var f=fetch||[];return Ext.isArray(f)&&(f=Ext.Array.union(f,this.defaultFetch)),f},_setModel:function(){this.model=Ext.define("Rally.data.lookback.SnapshotModel-"+Ext.id(),{extend:"Rally.data.lookback.SnapshotModel",fields:Ext.clone(this.getFetch()),proxy:Rally.environment.getIoProvider().getLookbackProxy({context:this.getContext(),fetch:this.getFetch(),hydrate:this.getHydrate(),version:this.getVersion(),headers:this.headers,find:this.findConfig,sort:this.sortConfig,compress:this.compress,removeUnauthorizedSnapshots:this.removeUnauthorizedSnapshots,includeTotalResultCount:this.includeTotalResultCount,listeners:{exception:this.exceptionHandler},useHttpPost:this.useHttpPost})})},load:function(options){options=options||{};var deferred=Ext.create("Deft.Deferred"),me=this,opts=Ext.apply({},{requester:this.requester,callback:function(records,operation,success){Ext.callback(options.callback,options.scope||me,[records,operation,success]),success?deferred.resolve(records):deferred.reject(operation)}},options);return this.callParent([opts]),deferred.promise},_shouldLoadMorePages:function(operation){try{var response=operation.response,responseBody=JSON.parse(response.responseText),hasMore=responseBody.HasMore,limit=this.limit||this.pageSize;return operation.wasSuccessful()&&hasMore&&this.getRange().length<limit}catch(e){return!1}},_afterDoneLoadingAllPages:function(operation,success,callback,scope){this.includeTotalResultCount||(this.totalCount=this.getRange().length),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.calculator.BaseCalculator",{config:{workDays:["Monday","Tuesday","Wednesday","Thursday","Friday"],holidays:[],startDate:void 0,endDate:void 0,timeZone:"GMT"},prepareChartData:function(store){var snapshots=[];return store.each(function(record){snapshots.push(record.raw)}),this.runCalculation(snapshots)},runCalculation:function(snapshots){return{series:snapshots,categories:[]}},constructor:function(config){this.mergeConfig(config),this.lumenize=Rally.data.lookback.Lumenize},_getSnapshotsFromStore:function(store){var snapshots=[];return store&&store.each(function(record){snapshots.push(record.raw)}),snapshots},_getStartDate:function(snapshots){return this.startDate||this._getStartDateFromData(snapshots)},_getEndDate:function(snapshots){return this.endDate||this._getEndDateFromData(snapshots)},_getStartDateFromData:function(snapshots){var firstRecord=snapshots[0];return firstRecord&&firstRecord._ValidFrom?firstRecord._ValidFrom:Ext.Date.format(new Date,"c")},_getEndDateFromData:function(snapshots){var lastRecord=snapshots[snapshots.length-1];return lastRecord&&lastRecord._ValidFrom?lastRecord._ValidFrom:Ext.Date.format(new Date,"c")},_getWorkdays:function(){return this.workDays.join(",")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.calculator.TimeInStateCalculator",{extend:Rally.data.lookback.calculator.BaseCalculator,config:{granularity:"hour",trackLastValueForTheseFields:["_ValidTo","Name"]},runCalculation:function(snapshots){this.startDate=this._getStartDate(snapshots),this.endDate=this._getEndDate(snapshots);var calculatorConfig=this._buildCalculatorConfig(),calculator=new this.lumenize.TimeInStateCalculator(calculatorConfig);return calculator.addSnapshots(snapshots,this.startDate,this.endDate),this.processLumenizeResults(calculator)},processLumenizeResults:function(calculator){var results=calculator.getResults(),data=[];return Ext.each(results,function(snapshot){data.push({x:new Date(snapshot._ValidTo_lastValue).getTime(),y:snapshot.ticks})}),{series:[{data:data,type:"scatter",name:"Results"}]}},_buildCalculatorConfig:function(){return{granularity:this.config.granularity,tz:this.config.timeZone,endBefore:this.endDate,workDayStartOn:{hour:0,minute:0},workDayEndBefore:{hour:23,minute:59},validFromField:"_ValidFrom",validToField:"_ValidTo",uniqueIDField:"ObjectID",trackLastValueForTheseFields:this.config.trackLastValueForTheseFields}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.calculator.TimeSeriesCalculator",{extend:Rally.data.lookback.calculator.BaseCalculator,config:{enableProjections:!1},getDerivedFieldsOnInput:function(){return[]},getMetrics:function(){return[]},getSummaryMetricsConfig:function(){return[]},getDerivedFieldsAfterSummary:function(){return[]},getProjectionsConfig:function(){return{series:[]}},runCalculation:function(snapshots){var calculatorConfig=this._prepareCalculatorConfig(),seriesConfig=this._buildSeriesConfig(calculatorConfig),calculator=this.prepareCalculator(calculatorConfig);return calculator.addSnapshots(snapshots,this._getStartDate(snapshots),this._getEndDate(snapshots)),this._transformLumenizeDataToHighchartsSeries(calculator,seriesConfig)},prepareCalculator:function(calculatorConfig){var config=Ext.Object.merge(calculatorConfig,{granularity:this.lumenize.Time.DAY,tz:this.config.timeZone,holidays:this.config.holidays,workDays:this._getWorkdays()});return new this.lumenize.TimeSeriesCalculator(config)},_prepareCalculatorConfig:function(){var defaultConfig={deriveFieldsOnInput:this.getDerivedFieldsOnInput(),metrics:this.getMetrics(),summaryMetricsConfig:this.getSummaryMetricsConfig(),deriveFieldsAfterSummary:this.getDerivedFieldsAfterSummary()};return this.enableProjections&&(defaultConfig.projectionsConfig=this.getProjectionsConfig()),defaultConfig},_buildSeriesConfig:function(calculatorConfig){for(var aggregationConfig=[],metrics=calculatorConfig.metrics,derivedFieldsAfterSummary=calculatorConfig.deriveFieldsAfterSummary,i=0,ilength=metrics.length;i<ilength;i+=1){var metric=metrics[i];aggregationConfig.push({name:metric.as||metric.field,type:metric.display,dashStyle:metric.dashStyle||"Solid"})}for(var j=0,jlength=derivedFieldsAfterSummary.length;j<jlength;j+=1){var derivedField=derivedFieldsAfterSummary[j];aggregationConfig.push({name:derivedField.as,type:derivedField.display,dashStyle:derivedField.dashStyle||"Solid"})}return aggregationConfig},_transformLumenizeDataToHighchartsSeries:function(calculator,seriesConfig){var results=calculator.getResults(),seriesData=results.seriesData,finalData={series:this.lumenize.arrayOfMaps_To_HighChartsSeries(seriesData,seriesConfig),categories:this._buildCategoriesFromData(seriesData)};return this.enableProjections&&(finalData.projections=results.projections),finalData},_buildCategoriesFromData:function(seriesData){for(var categories=[],i=0,length=seriesData.length;i<length;i++)categories.push(seriesData[i].label);return categories}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.lookback.calculator.TransitionsCalculator",{extend:Rally.data.lookback.calculator.BaseCalculator,config:{asOf:void 0,granularity:"month",fieldsToSum:[],asterixToDateTimePeriod:!0,groupTypes:[{type:"HierarchicalRequirement",as:"User Story"},{type:"Defect",as:"Defect"}]},prepareChartData:function(stores){Ext.isArray(stores)||(stores=[stores]);var snapshots=this._getSnapshotsFromStore(stores[0]),snapshotsToSubtract=this._getSnapshotsFromStore(stores[1]);return this.runCalculation(snapshots,snapshotsToSubtract)},runCalculation:function(snapshots,snapshotsToSubtract){var calculatorConfig=this._prepareCalculatorConfig(),seriesConfig=this._getSeriesConfig();this.startDate=this._getStartDate(snapshots),this.endDate=this._getEndDate(snapshots);var groupedSnapshots=this._aggregateSnapshots(snapshots,snapshotsToSubtract),calculators=this._buildCalculators(groupedSnapshots,calculatorConfig);return this._addSnapshots(groupedSnapshots,calculators),this._transformLumenizeDataToHighchartsSeries(calculators,seriesConfig)},_aggregateSnapshots:function(snapshots,snapshotsToSubtract){var self=this,groupedSnapshots={},storeSnapshot=function(key,snapshot){var type=self._getSnapshotType(snapshot);type&&(groupedSnapshots[type]||(groupedSnapshots[type]={}),groupedSnapshots[type][key]||(groupedSnapshots[type][key]=[]),groupedSnapshots[type][key].push(snapshot))};return Ext.each(snapshots,function(s){storeSnapshot("snapshots",s)}),Ext.each(snapshotsToSubtract,function(s){storeSnapshot("snapshotsToSubtract",s)}),groupedSnapshots},_getSnapshotType:function(snapshot){var types=snapshot._TypeHierarchy;if(!types)throw"TransitionsCalculator requires the _TypeHierarchy field, add it to the Lookback query's 'fetch' clause";for(var i=0,length=this.config.groupTypes.length;i<length;i++){var groupType=this.config.groupTypes[i].type;if(types.indexOf(groupType)>-1)return this.config.groupTypes[i].type}},_getSeriesConfig:function(){return[{name:"count",type:"column"}]},_addSnapshots:function(groupedSnapshots,calculators){var startDate=this.startDate,endDate=this.endDate;Ext.iterate(groupedSnapshots,function(group,groupSnapshots){var calculator=calculators[group],snapshots=groupSnapshots.snapshots,snapshotsToSubtract=groupSnapshots.snapshotsToSubtract;calculator.addSnapshots(snapshots,startDate,endDate,snapshotsToSubtract)})},_buildCalculators:function(groupedSnapshots,calculatorConfig){var Calculator=this.lumenize.TransitionsCalculator,calculators={};return Ext.iterate(groupedSnapshots,function(group){calculators[group]=new Calculator(calculatorConfig)}),calculators},_prepareCalculatorConfig:function(){return{asOf:this.config.asOf,granularity:this.config.granularity,tz:this.config.timeZone,validFromField:"_ValidFrom",validToField:"_ValidTo",uniqueIDField:"ObjectID",fieldsToSum:this.config.fieldsToSum,asterixToDateTimePeriod:this.config.asterixToDateTimePeriod}},_transformLumenizeDataToHighchartsSeries:function(calculators,seriesConfig){return{series:this._collectSeries(calculators,seriesConfig),categories:this._buildCategoriesFromData(calculators)}},_collectSeries:function(calculators,seriesConfig){var self=this,chartSeries=[];return Ext.iterate(calculators,function(type,calculator){var series=self.lumenize.arrayOfMaps_To_HighChartsSeries(calculator.getResults(),seriesConfig)[0];series.name=self._getGroupTypeDisplay(type),chartSeries.push(series)}),chartSeries},_getGroupTypeDisplay:function(typeName){var typeDef=this.lumenize.utils._.filter(this.config.groupTypes,function(typeDefinition){return typeDefinition.type===typeName})[0];return typeDef?typeDef.as:""},_buildCategoriesFromData:function(calculators){for(var calculatorKey=this.lumenize.utils._.keys(calculators)[0],seriesData=calculators[calculatorKey].getResults(),categories=[],i=0,length=seriesData.length;i<length;i++)categories.push(seriesData[i].timePeriod);return categories}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.notifications.NotificationsPagePreference",{singleton:!0,notificationsPagePreference:"notificationspage.beta",toggleNotificationsPage:function(enabled){var pref={};return pref[this.notificationsPagePreference]=enabled,Rally.data.PreferenceManager.update({filterByUser:!0,settings:pref})},checkIfNotificationsPageEnabled:function(){return Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:this.notificationsPagePreference}).then({success:function(prefs){return!!Ext.decode(prefs[this.notificationsPagePreference])},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.ArtifactParentAttributeHelper",{singleton:!0,parentAttributeForChildRecordOf:function(parentRecord){return Rally.data.util.ArtifactParentAttributeHelper._isUserStory(parentRecord)&&parentRecord.get("TaskStatus")&&!_.contains(["","NONE"],parentRecord.get("TaskStatus"))?"WorkProduct":Rally.data.util.ArtifactParentAttributeHelper._isRecordBottomPortfolioLevel(parentRecord)?"PortfolioItem":"Parent"},_isRecordBottomPortfolioLevel:function(record){return 0===record.self.ordinal},_isUserStory:function(record){return"hierarchicalrequirement"===record.get("_type")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.PortfolioItemTypeDefList",{getArray:function(context){return Rally.data.wsapi.ModelFactory.getPortfolioItemModels({context:context,requester:this}).then({success:function(piModels){var typeDefs=piModels.map(function(piModel){return piModel.typeDefinition});return this._mergeDynamicTypes(typeDefs)},scope:this})},_mergeDynamicTypes:function(typeDefs){return _.transform(typeDefs,function(acc,typeDef){var isPortfolioItem=typeDef.TypePath&&typeDef.TypePath.match(/^portfolioitem/i)&&typeDef.Ordinal>-1;isPortfolioItem&&(acc[typeDef.Ordinal]=typeDef)},[])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.Quantity",{singleton:!0,getFloatValue:function(quantity){var value=quantity.replace(/[^\d]+$/,"");return parseFloat(value)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.QueryStringParser",{config:{string:null},constructor:function(config){this.initConfig(config)},operations:/^\s*(=|!=|<=|>=|<|>|AND|OR|[!]?CONTAINS|\(|\))/i,quotes:/^"([^"\\]*(\\.[^"\\]*)*)"/,words:/^\s*([^ \)]+)/,operators:["=","!=","<=",">=","<",">","AND","OR","!CONTAINS","CONTAINS"],convertToStringPropertyMatcher:/.*Name.*/,peek:function(){var matches,string=Ext.String.trim(this.string);return matches=this.operations.exec(string),matches&&matches.length?matches[1]:(matches=this.quotes.exec(string),matches&&matches.length?matches[1]:(matches=this.words.exec(string),matches&&matches.length?matches[1]:""))},consume:function(stringToFind){var string=Ext.String.trim(this.string);this.string=string.substring(string.indexOf(stringToFind)+stringToFind.length)},parseNextTerm:function(){var nextTerm=this.peek();if("("===nextTerm){this.consume("(");var expression=this.applyOperators(this.operators);if(!(expression instanceof Rally.data.wsapi.Filter))throw new Error('Invalid expression starting at "'+expression+'"');return this.consume(")"),expression}return this.consume(nextTerm),nextTerm},applyOperators:function(operators,operator){if(!operators.length)return this.parseNextTerm();operator||(operator=operators[0]);for(var property=this.applyOperators(operators.slice(1));this.peek()===operator;){this.consume(operator);var value=this.applyOperators(operators.slice(1));property=Ext.create("Rally.data.wsapi.Filter",{property:property,operator:operator,value:this._convertToType(value,property)})}return property},_convertToType:function(value,property){return Ext.isString(value)?this.convertToStringPropertyMatcher.test(property)?value.toString():"true"===value.toLowerCase()||"false"!==value.toLowerCase()&&(value.length>0&&!isNaN(+value)?+value:"null"===value?null:value):value},_operatorsToUpperCase:function(string){return string=string.replace(/\)\s+and\s+\(/gi,") AND ("),string=string.replace(/\)\s+or\s+\(/gi,") OR ("),string.replace(/\b(contains)/gi,"CONTAINS")},parseExpression:function(){var originalString=this.string;if(null===this.string)throw new Error("Cannot parse null query: "+originalString);this.string=Ext.String.trim(this.string),this.string=this._operatorsToUpperCase(this.string);var filter=this.parseNextTerm();if(!(filter instanceof Rally.data.wsapi.Filter))throw new Error("Failed to parse query: "+originalString);var trailingQuery=this.parseNextTerm();if(trailingQuery)throw new Error('Failed to parse query: found trailing info at "'+trailingQuery+'". Make sure you wrap the whole query in parentheses.');return filter}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.util.SerialCallbackQueue",{constructor:function(config){this._queues={}},setTimeout:_.bind(setTimeout,window),run:function(){var fn,record="default";1===arguments.length?fn=arguments[0]:(record=arguments[0],fn=arguments[1]),this._queues[record]||(this._queues[record]=[],this._queues[record]._running=!1),this._queues[record]._running?this._queues[record].push(fn):this._run(record,fn)},_run:function(record,fn){this._queues[record]._running=!0;var me=this,called=!1,callback=function(){called=!0,me._queues[record].length>0?me.setTimeout(_.bind(function(){me._run(record,me._queues[record].shift())},me),0):delete me._queues[record]};fn(callback)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.batch.Writer",{extend:Ext.data.writer.Json,alternateClassName:["Rally.data.batch.Writer"],alias:["writer.rally.data.batch","writer.rallywsapibatchwriter"],write:function(request){var method="destroy"===request.action?"DELETE":"PUT";return request.jsonData={Batch:_.map(request.records,function(record){var entry={Path:record.getUri(),Method:method};return"PUT"===method&&(entry.Body={},entry.Body[record.self.typeName]=record.getChanges()),{Entry:entry}})},request}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.batch.Reader",{extend:Ext.data.reader.Json,alternateClassName:["Rally.data.batch.Reader"],alias:["reader.rally.data.batch","reader.rallywsapibatchreader"],root:"BatchResult",readRecords:function(response){var errors=[],successfulRecords=[],data=response[this.root];return _.each(data.Results,function(result){if(result.Errors.length)errors.push(result.Errors[0]);else{var resultingRecord=new this.model(result.Object);successfulRecords.push(resultingRecord)}},this),new Ext.data.ResultSet({total:data.Results.length,count:successfulRecords.length,records:successfulRecords,success:!0,message:_.first(errors)||_.first(data.Errors)})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.batch.Proxy",{extend:Ext.data.proxy.Rest,alternateClassName:["Rally.data.batch.RestProxy"],alias:["proxy.rally.data.batch.rest","proxy.rallywsapibatchproxy"],writer:{type:"rally.data.batch"},reader:{type:"rally.data.batch"},batchActions:!0,appendId:!1,noCache:!1,timeout:6e4,actionMethods:{update:"POST",destroy:"POST"},config:{wsapiVersion:null},constructor:function(){this.callParent(arguments),this.url=Rally.environment.getServer().getWsapiUrl(this.getWsapiVersion())+"/batch"},buildRequest:function(operation){var request=this.callParent(arguments);return Ext.apply(request.params,{includePermissions:!0,fetch:_(operation.records[0].raw).keys().filter(function(key){return!key.match(/^_/)}).value().join(",")}),request},update:function(operation,callback,scope){operation.actionCommitRecordsRe=/$^/,operation.requester=this.requester,this.callParent(arguments)},onBatchComplete:function(batchOptions,batch){var resultSet=batch.operations[0].resultSet;_.each(batchOptions.operations.update,function(record){_.find(resultSet.records,function(resultRecord){return record.get("_ref")===resultRecord.get("_ref")})?record.commit():record.reject()}),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.batch.Store",{extend:Ext.data.Store,alias:["store.batch","store.rallywsapibatchstore"],config:{context:void 0,wsapiVersion:void 0,data:[]},constructor:function(config){var wsapiVersion=config.wsapiVersion,models=_(config.data).pluck("self").uniq().value();if(1===models.length&&this._modelIsNotArtifact(models[0])){var TempBatchStoreModelName="TempBatchStoreModel"+Math.random();config.model=Ext.define(TempBatchStoreModelName,{extend:models[0]})}else config.model=Rally.data.wsapi.ModelBuilder.buildCompositeArtifact(models,config.context||Rally.environment.getContext(),wsapiVersion);config.model.setProxy(Rally.environment.getIoProvider().getProxy({wsapiVersion:wsapiVersion,type:"rally.data.batch.rest",requester:config.requester})),this.callParent(arguments)},_modelIsNotArtifact:function(model){return!model.isArtifact||!model.isArtifact()},sync:function(options){options=options||{};var deferred=Ext.create("Deft.Deferred"),me=this,opts=Ext.apply({},{callback:function(batch,syncOptions){Ext.callback(options.callback,options.scope||me,[batch,syncOptions]),batch.hasException?deferred.reject(batch):deferred.resolve(batch)}},options);return this.callParent([opts]),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.collection.MemoryStore",{extend:Ext.data.Store,alternateClassName:["Rally.data.MemoryCollectionStore"],alias:["store.rallymemorycollectionstore","store.rallywsapicollectionmemorystore"],mixins:{messageable:Rally.Messageable},statics:{queue:Ext.create("Rally.data.util.SerialCallbackQueue",{})},constructor:function(config){config.data=[],config.proxy={type:"memory"},this.initialConfig=config,this.callParent(arguments)},add:function(){this.callParent(Rally.data.wsapi.collection.Store.toRecordsForAdd(this,arguments))},remove:function(records){this.callParent([Rally.data.wsapi.collection.Store.toRecordsForRemove(this,records)])},load:function(options){options=options||{};var me=this,successCallback=function(model){me.model=model,Ext.callback(options.callback,options.scope||me,[me.getRange()]),me.fireEvent("load",me,me.getRange(),!0)};Ext.isString(this.initialConfig.model)?Rally.data.ModelFactory.getModel({type:this.initialConfig.model,success:successCallback,scope:this}):successCallback(this.initialConfig.model)},sync:function(options){options=options||{},this._afterParentCreated(this.record,options),Ext.callback(options.success,options.scope||this)},_afterParentCreated:function(record,options){var deferred=new Deft.Deferred,me=this,theListener=null,fn=function(callback){var collectionStore=record.getCollection(me.initialConfig.fieldName),added=me.getRange();collectionStore.load({callback:function(){me.mun(record,"aftercommit",theListener,me,{single:!0}),collectionStore.add(added);var wrappedOptions=Ext.merge({},options,{callback:function(batch){options.callback&&Ext.callback(options.callback,options.scope||this,[batch]);var success=_.all(batch.operations,function(i){return i.success});success?deferred.resolve(batch):deferred.reject(batch),callback&&callback()}});collectionStore.sync(wrappedOptions)}})};theListener=function(){Rally.data.wsapi.collection.MemoryStore.queue.run(record,fn)},this.mon(record,"aftercommit",theListener,this,{single:!0}),record.addCreationDependency(deferred.promise)},_getModelType:function(model){return Ext.isString(model)?model:model.typeName},hydrateModel:function(){return Rally.data.ModelFactory.getModel({type:this.initialConfig.model,context:this.context,wsapiVersion:this.wsapiVersion,requester:this.requester}).then({success:function(model){return this.model=model,model},failure:function(msg){return Ext.Error.raise(msg),msg},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.collection.MultiStore",{alias:["store.rallymulticollectionstore","store.rallywsapicollectionmultistore"],alternateClassName:["Rally.data.MultiCollectionStore"],constructor:function(config){this.stores=config.stores},getCount:function(){return Ext.Object.getSize(this.stores)},get:function(fieldName){return this.stores[fieldName]},load:function(options){var loadStorePromises=_.map(this.stores,function(store,fieldName){return this._loadStore(this.stores[fieldName],fieldName)},this);Deft.Promise.all(loadStorePromises).then(function(results){options.callback(_.object(results))})},_loadStore:function(store,fieldName){var deferred=new Deft.Deferred;return store.load({callback:function(records,operation,success){deferred.resolve([fieldName,store])}}),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.filter.MultiSelectFilter",{extend:Rally.data.wsapi.Filter,config:{filterProperty:void 0,operator:"=",value:null},statics:{parseRefs:function(filter,property){var refs=[];return filter&&(Ext.isObject(filter.property)&&(refs=refs.concat(this.parseRefs(filter.property,property))),Ext.isObject(filter.value)&&(refs=refs.concat(this.parseRefs(filter.value,property))),filter.property===property&&refs.push(Rally.util.Ref.getRelativeUri(filter.value))),_.uniq(refs)}},constructor:function(config){config=config||{},this.mergeConfig(config);var filter=this._build();config.property=filter.property,config.operator=filter.operator,config.value=filter.value,this.callParent(arguments)},getFilterValue:function(model){throw"getFilterValue must be overridden"},_build:function(){var _this=this,models=Ext.Array.from(this.config.value);return _.reduce(models,function(result,model){var filter=Ext.create("Rally.data.wsapi.Filter",{property:_this.config.filterProperty,operator:_this.config.operator,value:_this.getFilterValue(model)});return result?result.or(filter):filter},null)}})}(),function(){var Ext=window.Ext4||window.Ext,filterProperty="Tags";Ext.define("Rally.data.wsapi.filter.TagFilter",{extend:Rally.data.wsapi.filter.MultiSelectFilter,statics:{parseTagRefs:function(filter){return Rally.data.wsapi.filter.MultiSelectFilter.parseRefs(filter,filterProperty)}},config:{filterProperty:filterProperty,operator:"contains"},getFilterValue:function(model){return model.get("_ref")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.filter.TypeDefFilter",{extend:Rally.data.wsapi.filter.MultiSelectFilter,config:{filterProperty:"TypeDefOid"},getFilterValue:function(model){return model.typeDefOid}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.search.Proxy",{extend:Rally.data.wsapi.Proxy,alias:"proxy.search",reader:{type:"rallywsapireader",totalProperty:"TotalResultCount"},buildUrl:function(request){return request.url=Rally.environment.getServer().getWsapiUrl(this.wsapiVersion)+"/search",this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.data.wsapi.search.ModelFactory",{singleton:!0,modelTypes:["searchable"],getModels:function(options){return{searchable:this.getModel()}},getModel:function(options){var typeDefMetaData=new Rally.data.TypeDefinitionMetaData({context:{workspace:Rally.environment.getContext().getWorkspace()},wsapiVersion:Rally.environment.getServer().getWsapiVersion(),requested:"search"}),typeDefinition={Attributes:[this._getAttribute("FormattedID","FormattedID","ID"),this._getAttribute("STRING","MatchingText","Matching Text"),this._getAttribute("STRING","Name","Name"),this._getAttribute("STRING","Project","Project"),this._getAttribute("DATE","LastUpdateDate","Last Update Date")],TypePath:"search",DisplayName:"Search",Parent:null,ElementName:"Search",Restorable:!1},model=Rally.data.wsapi.ModelBuilder.build(typeDefMetaData,typeDefinition);return model.setProxy({type:"search"}),model.prototype.canHaveChildren=function(){return!1},model.prototype.canHaveTasks=function(){return!1},model.prototype.canHaveDefects=function(){return!1},model.prototype.canHaveTestCases=function(){return!1},model.prototype.canHaveTestCaseResults=function(){return!1},model},_getAttribute:function(type,elementName,name){return{AttributeType:type,ElementName:elementName,Name:name,Required:!1,ReadOnly:!0,Hidden:!1,Custom:!0,Sortable:!1}}},function(){Rally.data.ModelFactory.registerTypes(this.modelTypes,this)})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.dependencies.Loader",{singleton:!0,getIncludes:function(itemType){var nodeLists=[];itemType?nodeLists.push(document.getElementsByTagName(itemType)):(nodeLists.push(document.getElementsByTagName("link")),nodeLists.push(document.getElementsByTagName("script")));for(var includes=[],i=0;i<nodeLists.length;i++)for(var j=0;j<nodeLists[i].length;j++)includes.push(nodeLists[i][j]);return includes},getInclude:function(itemType,itemName){for(var type=itemName?itemType:null,name=itemName?itemName:itemType,includes=this.getIncludes(type),i=0;i<includes.length;i++){var includePath=includes[i].getAttribute("src")||includes[i].getAttribute("href");if("string"==typeof includePath&&includePath.indexOf(name)>-1)return includes[i]}return null},loadStylesheet:function(cssPath,refNode){var css=document.createElement("link");return css.setAttribute("rel","stylesheet"),css.setAttribute("type","text/css"),css.setAttribute("href",cssPath),this._loadResource(css,refNode)},loadScript:function(scriptPath,optionalAttributes){var script=document.createElement("script");return script.setAttribute("type","text/javascript"),script.setAttribute("src",scriptPath),optionalAttributes&&this._setAttributes(script,optionalAttributes),this._loadResource(script,null)},_setAttributes:function(element,attributes){for(var attribute in attributes)attributes.hasOwnProperty(attribute)&&element.setAttribute(attribute,attributes[attribute])},_loadResource:function(el,refNode){var deferred=Ext.create("Deft.Deferred"),callback=function(){deferred.resolve(el)};return el.readyState?el.onreadystatechange=function(){this._calledBack||"complete"!==this.readyState&&"loaded"!==this.readyState||(this._calledBack=!0,callback())}:el.onload=callback,refNode&&refNode.nextSibling?refNode.parentNode.insertBefore(el,refNode.nextSibling):document.getElementsByTagName("head")[0].appendChild(el),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.dependencies.DependencyLoader",{inheritableStatics:{getResources:Ext.emptyFn,load:function(callback,scope){this._inFlight=this._inFlight||{};var cb=Ext.bind(callback,scope);this._inFlight[this.$className]?this._inFlight[this.$className].push(cb):(this._inFlight[this.$className]=[cb],this.loadResources(Ext.clone(this.getResources()),function(){_.invoke(this._inFlight[this.$className],"call"),delete this._inFlight[this.$className]},this))},loadResources:function(resources,callback,scope){if(resources.length>0){var resourcePath,resource=resources.shift(),loadConfig={success:function(){this.loadResources(resources,callback,scope)},scope:this};!resource.needsToLoadFn||resource.needsToLoadFn()?resource.script?(resourcePath=resource.script,Rally.dependencies.Loader.loadScript(resourcePath).then(loadConfig)):resource.stylesheet&&(resourcePath=resource.stylesheet,Rally.dependencies.Loader.loadStylesheet(resourcePath).then(loadConfig)):this.loadResources(resources,callback,scope)}else callback&&callback.call(scope)},stylesheetExists:function(stylesheetName,stylesheets){return stylesheetName=stylesheetName.split("../")[stylesheetName.split("../").length-1],stylesheets=stylesheets||Ext.Array.toArray(document.styleSheets),Ext.Array.some(stylesheets,function(stylesheet){return stylesheet.href&&stylesheet.href.indexOf(stylesheetName)!==-1})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.dependencies.Analytics",{extend:Rally.dependencies.DependencyLoader,statics:{getResources:function(){var server=Rally.environment.getServer(),libraryPath=server.getLibraryPath(),externalDependency=Rally.dependencies.ExternalDependencies&&Rally.dependencies.ExternalDependencies.analytics;return[{script:externalDependency||libraryPath+"/analytics/analytics-all.js",needsToLoadFn:function(){return!window.Highcharts}}]}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.dependencies.GoogleClosure",{extend:Rally.dependencies.DependencyLoader,statics:{getResources:function(){var server=Rally.environment.getServer(),resourcesPath=server.getResourcesPath(),libraryPath=server.getLibraryPath(),externalDependency=Rally.dependencies.ExternalDependencies&&Rally.dependencies.ExternalDependencies.closure;return[{script:externalDependency||libraryPath+"/closure/closure-all.js",needsToLoadFn:function(){return!window.goog}},{stylesheet:resourcesPath+"/css/closure-all.css",needsToLoadFn:function(){return!Rally.dependencies.DependencyLoader.stylesheetExists("closure-all.css")}}]}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.domain.Subscription",{constructor:function(config){Ext.apply(this,config)},isModuleEnabled:function(moduleName){return this.Modules.indexOf(moduleName)>-1},isAnyOfTheseTypes:function(types){var subscriptionType=this.SubscriptionType;return this.isHsEdition()&&(subscriptionType="HS"),Ext.Array.contains(types,subscriptionType)},isPaidSubscription:function(){
return!this.isCommunityEdition()&&!this.isHsEdition()},isCommunityEdition:function(){return"Community"===this.SubscriptionType},isHsEdition:function(){return this.SubscriptionType.indexOf("HS")>=0},isExpressEdition:function(){return"Express_Edition"===this.SubscriptionType},isUnlimitedEdition:function(){return"Unlimited"===this.SubscriptionType}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.domain.User",{constructor:function(config){Ext.apply(this,config)},getRef:function(){return this._ref},getDisplayString:function(){return this._refObjectName},getLandingPage:function(){return this.LandingPage}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.env.Context",{constructor:function(context){this.context=context||{},this.callParent(arguments)},getScopedStateId:function(stateId,preferenceOpts){var stateUtil=Ext.create("Rally.state.ScopedStateUtil"),opts={workspace:this.getWorkspace()._ref,filterByUser:this.getUser()?this.getUser().getRef():null};return Ext.merge(opts,preferenceOpts),stateUtil.getScopedStateId(stateId,opts)},getWorkspace:function(){return this.getScope().workspace},getProject:function(){return this.getScope().project},getProjectRef:function(){return Rally.util.Ref.getRelativeUri(this.getProject())},getWorkspaceRef:function(){return Rally.util.Ref.getRelativeUri(this.getWorkspace())},getUser:function(){var user=this.context.user;if(user)return user instanceof Rally.domain.User?user:Ext.create("Rally.domain.User",user)},getPermissions:function(){return this.context.permissions},getProjectScopeUp:function(){return this.getScope().up},getProjectScopeDown:function(){return this.getScope().down},getScopeStr:function(projectOid){var project=this.getProject(),scopeStr=projectOid||(project&&project.ObjectID?project.ObjectID:"");return scopeStr+=this.getProjectScopeUp()?"u":"",scopeStr+=this.getProjectScopeDown()?"d":""},getDataContext:function(){return{workspace:this.getWorkspace()&&Rally.util.Ref.getRelativeUri(this.getWorkspace()),project:this.getProject()&&Rally.util.Ref.getRelativeUri(this.getProject()),projectScopeUp:this.getProjectScopeUp(),projectScopeDown:this.getProjectScopeDown()}},getSubscription:function(){return Ext.create("Rally.domain.Subscription",this.context.subscription)},getScope:function(){return this.context.scope||{}},getStack:function(){return this.context.stack||{}},getProps:function(){return this.context},getProjectToWorkspaceMap:function(){return this.context.projectToWorkspaceMap},isFeatureEnabled:function(feature){return this.context.featureToggles&&this.context.featureToggles.isEnabled(feature)},clone:function(){return Ext.clone(this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.env.Global",{setup:function(){Ext.Ajax.disableCaching=!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.nav.detail.NavHistory",{mixins:{messageable:Rally.Messageable},singleton:!0,_artifactDetailPageRegex:new RegExp("/detail/\\w+/([a-z0-9]+)","i"),_formattedIDSearchPageRegex:new RegExp("/search\\?keywords=([a-zA-Z0-9]+)$"),init:function(config){this._wentBack=!1,this._returnTargetStack=Ext.create("Rally.nav.detail.SessionStack",{key:"Rally.nav.detail.NavHistory"}),this._returnTargetStack.clear(),this._previousHref=void 0,this._isQuickDetailEnabled=void 0!==config.isQuickDetailEnabled&&config.isQuickDetailEnabled,config.navigationEvent&&(this.unsubscribe(config.navigationEvent,this._handleNavigationChange,this),this.subscribe(config.navigationEvent,this._handleNavigationChange,this))},goBack:function(formattedID){for(this._wentBack=!0;this._shouldSkipTopHref(formattedID);)this._returnTargetStack.pop();this._navigateBack(this._returnTargetStack.pop())},_shouldSkipTopHref:function(formattedID){var href=this._returnTargetStack.peek(),skip=this._isSameArtifact(href,this._getCurrentHref())||this._isArtifactSearchPage(href,formattedID);return skip},reloadAfterSwitchback:function(){this._navigateBack(this._returnTargetStack.peek()),this._reloadPage()},_reloadPage:function(){window.location.reload()},_getCurrentHref:function(){return location.href},_navigateBack:function(hash){hash?location.href=hash:location.href="/"},_handleNavigationChange:function(){this._processNavigationChange(location.href)},_processNavigationChange:function(href){return this._pageNotFound(href)?(this._wentBack=!1,void(this._invalidHref=this._previousHref)):(!this._wentBack&&this._isValidReturnTarget(this._previousHref)&&(this._isArtifactDetailPage(this._previousHref)?this._isSameArtifact(this._previousHref,href)||this._isQuickDetailEnabled||this._returnTargetStack.push(this._previousHref):this._returnTargetStack.push(this._previousHref)),this._wentBack=!1,void(this._previousHref=href))},_pageNotFound:function(href){return href.indexOf("notfounderror")!==-1},_isArtifactDetailPage:function(href){return!!href.match(this._artifactDetailPageRegex)},_isSameArtifact:function(previousHref,currentHref){if(previousHref){var parsedCurrentHref=Rally.ui.detail.view.DetailView.parseUri(currentHref),parsedPreviousHref=Rally.ui.detail.view.DetailView.parseUri(previousHref);return parsedCurrentHref.id===parsedPreviousHref.id}return!1},_isArtifactSearchPage:function(previousHref,formattedID){var matches=this._formattedIDSearchPageRegex.exec(previousHref);return!(!_.isArray(matches)||!matches[1]||matches[1].toLowerCase()!==formattedID.toLowerCase())},_isValidReturnTarget:function(href){return!!href&&!this._isLegacyEditorPage(href)&&!this._isNewDetailPage(href)&&href!==this._invalidHref},_isNewDetailPage:function(href){return!!this._isArtifactDetailPage(href)&&href.indexOf("/new")!==-1},_isLegacyEditorPage:function(href){return href.indexOf(".sp")!==-1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.nav.detail.SessionStack",{constructor:function(config){if(!config.key)throw new Error("config.key required");this.sessionStorageKey=config.key},pop:function(){var stack=this._loadStack();if(0!==stack.length){var value=stack.pop();return this._storeStack(stack),value}},push:function(value){var stack=this._loadStack();stack.push(value),this._storeStack(stack)},peek:function(){var stack=this._loadStack();if(0!==stack.length)return stack[stack.length-1]},clear:function(){this._storeStack([])},_storeStack:function(stack){try{sessionStorage[this.sessionStorageKey]=stack.join(",")}catch(e){}},_loadStack:function(){if(!sessionStorage[this.sessionStorageKey]){try{sessionStorage[this.sessionStorageKey]=[]}catch(e){}return[]}return sessionStorage[this.sessionStorageKey].split(",")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.JsonPIoProvider",{extend:Rally.env.IoProvider,alternateClassName:"Rally.sdk.env.IoProvider",config:{callbackKey:"jsonp"},doRequest:function(request){request.method&&(request.params=request.params||{},request.params._method=request.method),Ext.data.JsonP.request(Ext.apply(request,this.config))},getProxy:function(proxyConfig){return this.callParent([Ext.apply(proxyConfig,{type:"rallywsapijsonpproxy"})])},getLookbackProxy:function(proxyConfig){return Ext.apply({},proxyConfig,{type:"rallylookbackjsonpproxy"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.CorsIoProvider",{extend:Rally.env.IoProvider,constructor:function(){Rally.getSdkInfo().apiKey?Ext.Ajax.on("beforerequest",this._attachApiKey,this):Ext.Ajax.on("beforerequest",this._ensureCredentials,this),this.callParent(arguments)},_attachApiKey:function(conn,opts){opts.headers=Ext.apply({zsessionid:Rally.getSdkInfo().apiKey},opts.headers)},_ensureCredentials:function(conn,opts){opts.withCredentials=!0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.Server",{extend:Rally.env.Server,config:{contextPath:"/slm"},getHashBaseUrl:function(){return this.getBaseUrl()+"/"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.Environment",{extend:Rally.env.Environment,getContext:function(){var context;return this.externalContext?context=this.externalContext:this.rallyEnvironment&&(context=this.rallyEnvironment.getContext().context),context?Ext.create("Rally.env.Context",context):null},getGlobalContext:function(){return this.rallyEnvironment&&this.rallyEnvironment.getContext()||this.getContext()},isExternal:function(){return!this.rallyEnvironment},getServer:function(){if(!this.server){var serverConfig=this.createServerConfig();this.server=Ext.create("Rally.sdk.env.Server",serverConfig)}return this.server},createServerConfig:function(){var sdkInfo=Rally.sdk.Bootstrapper.getSdkInfo(),serverConfig={defaultWsapiVersion:sdkInfo.wsapiVersion,defaultLookbackVersion:sdkInfo.lookbackVersion,resourcesPath:sdkInfo.path+"/rui/resources",libraryPath:sdkInfo.path+"/lib"};if(!this.rallyEnvironment){var baseUrlMatch=/^https?:\/\/.+?\//.exec(sdkInfo.path);sdkInfo.server?serverConfig.baseUrl=sdkInfo.server:baseUrlMatch&&(serverConfig.baseUrl=baseUrlMatch[0].replace(/\/$/,""))}return serverConfig},_requiresJsonP:function(){return!window.location.protocol.match(/^http/)},getIoProvider:function(){return this.ioProvider||(this.ioProvider=this._requiresJsonP()?Ext.create("Rally.sdk.env.JsonPIoProvider"):Ext.create("Rally.sdk.env.CorsIoProvider")),this.ioProvider},getMessageBus:function(){return this.rallyEnvironment?this.rallyEnvironment.getMessageBus():this.callParent()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.notify.NotificationContainer",{extend:Ext.Container,alias:"widget.rallynotificationcontainer",componentCls:"rui-notification-manager",initComponent:function(){this.callParent(arguments),Ext.EventManager.onWindowResize(this._onWindowResize,this)},destroy:function(){this.removeAll(),Ext.EventManager.removeResizeListener(this._onWindowResize,this),this.callParent(arguments)},add:function(config){this.removeAll(),Ext.applyIf(config,{xtype:"rallynotification"}),Ext.merge(config,{listeners:{afterrender:this._positionNotification,destroy:this._collapse,scope:this}}),this.callParent(arguments)},removeAll:function(){this.items.each(function(item){item.animateShowHide=!1}),this.callParent(arguments)},_collapse:function(){this.getEl()&&(this.getEl().setStyle("width","0"),this.getEl().setStyle("height","0"))},_positionNotification:function(notification){this.target&&this.target.isComponent&&this.getEl().setStyle({top:0,position:"absolute"}),this._calcAndSetWidth();var left=0,width=this.getWidth(),notificationWidth=this._sizeNotification(notification),widthDiff=width-notificationWidth;widthDiff>0&&(left=widthDiff/2),notification.getEl().setStyle("margin-right",left.toString()+"px")},_sizeNotification:function(notification){var notificationWidth=notification.getWidth();if((Ext.isIE6||Ext.isIE7)&&notification.closeBtnEl){var closeBtnWidth=0,padding=4,notificationX=notification.getEl().getX(),notificationY=notificationX+notification.getWidth(),messageX=notification.messageEl.getX(),messageY=messageX+notification.messageEl.getWidth(),messageWidth=messageY-notificationX,closeBtnX=notification.closeBtnEl.getX();closeBtnX=closeBtnX>messageY?closeBtnX:messageY,closeBtnWidth=notificationY-closeBtnX,notificationWidth=messageWidth+closeBtnWidth+padding,notification.setWidth(notificationWidth)}return notificationWidth},_calcAndSetWidth:function(){var width=this.target?this._getTargetWidth():Rally.util.Window.getWidth();this.getEl().setStyle("width",width.toString()+"px"),this.getEl().setStyle("left","0px")},_getTargetWidth:function(){var targetId=this.target.isComponent?this.target.getId():this.target,cmp=Ext.select("#"+targetId).first();if(cmp)return cmp.getWidth()},_onWindowResize:function(){this.items.length>0&&(this._calcAndSetWidth(),this.items.each(function(item){this._positionNotification(item)},this))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.notify.NotificationListener",{mixins:{messageable:Rally.Messageable},GLOBAL_NOTIFICATION_TARGET:"content",containers:{},constructor:function(){this.subscribe(Rally.Message.displayNotification,this._onDisplayNotification,this),this.subscribe(Rally.Message.clearNotification,this._onClearNotification,this)},destroy:function(){this.unsubscribe(Rally.Message.displayNotification,this._onDisplayNotification,this),this.unsubscribe(Rally.Message.clearNotification,this._onClearNotification,this)},_onDisplayNotification:function(config){config.cls||(config.cls=Rally.ui.notify.Notification.confirmCls),Ext.isArray(config.cls)&&(config.cls=config.cls.join(" ")),this._applyConfigTarget(config),this._addMessage(config)},_addMessage:function(config){var container=this._getNotificationContainer(config.target);config.target.isComponent&&config.target.on("destroy",function(){this._onClearNotification({target:config.target}),container.destroy()},this),container.add(config)},_onClearNotification:function(config){this._applyConfigTarget(config);var targetId=config.target.isComponent?config.target.getId():config.target,target=this.containers[targetId]||this.containers.main;target&&(config.whenTextEquals?target.items.each(function(item){if(item.message===config.whenTextEquals)return target.removeAll(),!1}):target.removeAll())},_getNotificationContainer:function(target){var targetId=target.isComponent?target.getId():target;if(!this.containers[targetId]){var config={target:target};target.isComponent?config.renderTo=target.getEl():(config.autoRender=!0,config.autoShow=!0),this.containers[targetId]=Ext.create("Rally.ui.notify.NotificationContainer",config)}return this.containers[targetId]},_applyConfigTarget:function(config){if(!config.target){var newTarget=Ext.fly(this.GLOBAL_NOTIFICATION_TARGET)&&this.GLOBAL_NOTIFICATION_TARGET;if(!newTarget){var rallyapp=Ext.ComponentQuery.query("rallyapp")[0];newTarget=rallyapp?rallyapp:Ext.getBody().id}config.target=newTarget}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.listener.ProfileImageLoadListener",{constructor:function(){this.profileImageCache={},Ext.onReady(function(){if(Rally.getSdkInfo().apiKey){var _this=this;Ext.getBody().dom.addEventListener("load",function(e){_this._onLoad(e)},!0)}},this)},destroy:function(){Ext.getBody().dom.removeEventListener("load",this._onLoad,!0)},_onLoad:function(e){var element=e.srcElement||e.target,pattern=/(?:#)(.*\/profile\/image\/\d+.*)/;if("img"===element.tagName.toLowerCase()&&pattern.test(element.src)){var profileSrc=element.src.match(pattern)[1],cachedProfileImage=this.profileImageCache[profileSrc];cachedProfileImage?element.src=cachedProfileImage:Rally.environment.getIoProvider().httpGet({url:profileSrc,params:{format:"dataUri",encoding:"base64"},success:function(response){this.profileImageCache[profileSrc]=element.src=response.responseText},scope:this})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.listener.NavigationRequestListener",{mixins:{messageable:Rally.Messageable},constructor:function(){this.subscribe(Rally.nav.Message.manageIterations,this._showManageIterations,this),this.subscribe(Rally.nav.Message.detail,this._showDetail,this),this.subscribe(Rally.nav.Message.create,this._create,this),this.subscribe(Rally.nav.Message.copy,this._copy,this),this.subscribe(Rally.nav.Message.edit,this._edit,this),this.subscribe(Rally.nav.Message.split,this._split,this),this.subscribe(Rally.nav.Message.goTo,this._goTo,this)},destroy:function(){this.unsubscribe(Rally.nav.Message.manageIterations,this._showManageIterations,this),this.unsubscribe(Rally.nav.Message.detail,this._showDetail,this),this.unsubscribe(Rally.nav.Message.create,this._create,this),this.unsubscribe(Rally.nav.Message.copy,this._copy,this),this.unsubscribe(Rally.nav.Message.edit,this._edit,this),this.unsubscribe(Rally.nav.Message.split,this._split,this),this.unsubscribe(Rally.nav.Message.goTo,this._goTo,this)},_showManageIterations:function(args){this._showUnsupportedMessage("The iteration management dialog is unavailable when running externally.")},_goTo:function(token,args){var hash=token;token.indexOf("#")===-1&&(hash="/#"+hash),window.open(Rally.environment.getServer().getBaseUrl()+hash)},_showDetail:function(item,args){var token=Rally.nav.Manager.getDetailHash(Rally.util.Ref.getRelativeUri(item),args);this._goTo(token)},_create:function(type,args){this._showUnsupportedMessage("The create dialog is unavailable when running externally.")},_copy:function(item){this._showUnsupportedMessage("The copy dialog is unavailable when running externally.")},_edit:function(item,args){this._showUnsupportedMessage("The edit dialog is unavailable when running externally.")},_split:function(record){this._showUnsupportedMessage("The story split dialog is unavailable when running externally.")},_showUnsupportedMessage:function(message){Rally.ui.notify.Notifier.showError({message:message})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.AppScopedStorageProvider",{extend:Ext.state.Provider,appScopedState:{},stateUtil:null,constructor:function(){this.callParent(arguments),this.stateUtil=Ext.create("Rally.state.ScopedStateUtil")},loadAppScopedState:function(preferenceOpts){return Rally.data.PreferenceManager.load(preferenceOpts).then({success:function(state){return this.addAppScopedState(state,preferenceOpts),state},scope:this})},addAppScopedState:function(state,preferenceOpts){var stateScope=this.stateUtil.getScopeString(preferenceOpts);_.forIn(state,function(value,key){var stateParts={stateScope:stateScope,stateId:key};if(Ext.isString(value))try{value=Ext.decode(value)}catch(e){}this._setAppScopedState(stateParts,value)},this)},isAppScopedState:function(name){var stateParts=this.stateUtil.parseScopedStateId(name);return!Ext.isEmpty(stateParts.appID)},get:function(name,defaultValue){var stateParts=this.stateUtil.parseScopedStateId(name),appState=this.appScopedState[stateParts.stateScope];return appState&&appState[stateParts.stateId]?_.cloneDeep(appState[stateParts.stateId]):defaultValue||null},set:function(name,value){if(!_.isEqual(value,this.get(name))){var opts=this.stateUtil.parseScopedStateId(name);opts.filterByName=opts.stateId,opts.settings={},opts.settings[opts.stateId]=Ext.isString(value)?value:Ext.encode(value),Rally.data.PreferenceManager.update(opts),this._setAppScopedState(opts,value),this.fireEvent("statechange",this,name,value)}},clear:function(name){var opts=this.stateUtil.parseScopedStateId(name);opts.filterByName=opts.stateId,Rally.data.PreferenceManager.remove(opts),this._setAppScopedState(opts,null),this.fireEvent("statechange",this,name,null)},_setAppScopedState:function(stateParts,value){var appState=this.appScopedState[stateParts.stateScope];appState||(appState=this.appScopedState[stateParts.stateScope]={}),appState[stateParts.stateId]=value}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.Global",{extend:Rally.env.Global,setup:function(){this.callParent(arguments);var rallyEnvironment=this._getRallyEnvironment();Rally.environment=Ext.create("Rally.sdk.env.Environment",{rallyEnvironment:rallyEnvironment}),rallyEnvironment?Rally.env.IoProvider.setSecurityToken(rallyEnvironment.getIoProvider().self.getSecurityToken()):(this._secureRequests(),this.listeners=[Ext.create("Rally.ui.notify.NotificationListener"),Ext.create("Rally.sdk.listener.NavigationRequestListener"),Ext.create("Rally.sdk.listener.ProfileImageLoadListener")])},tearDown:function(){_.invoke(this.listeners,"destroy"),delete this.listeners,delete Rally.environment,this._origJsonPRequest&&(Ext.data.JsonP.request=this._origJsonPRequest,delete this._origJsonPRequest),this._origAjaxRequest&&(Ext.Ajax.request=this._origAjaxRequest,delete this._origAjaxRequest)},_getRallyEnvironment:function(){var rallyEnvironment=null;return Ext.each([window.parent,window.top],function(w){if(w&&w!==window&&w.Rally&&w.Rally.environment)return rallyEnvironment=w.Rally.environment,!1}),rallyEnvironment},_secureRequests:function(){this._origJsonPRequest=Ext.data.JsonP.request,Ext.data.JsonP.request=this._createRequestOverride(!1,this._origJsonPRequest),this._origAjaxRequest=Ext.Ajax.request,Ext.Ajax.request=this._createRequestOverride(!!Rally.getSdkInfo().apiKey,this._origAjaxRequest)},_createRequestOverride:function(supportsApiKey,originalFn){var me=this;return function(options){!me._isWriteRequest(options)||Rally.env.IoProvider.getSecurityToken()||supportsApiKey?originalFn.call(this,options):me._fetchSecurityTokenBeforeRequest(this,options)}},_isWriteRequest:function(options){return options.action&&"read"!==options.action||options.method&&"GET"!==options.method},_fetchSecurityTokenBeforeRequest:function(provider,options){Rally.env.IoProvider.getSecurityToken()?provider.request(options):this._retrievingSecurityToken?provider.on("securitytokenretrieved",function(){provider.request(options)},null,{single:!0}):(this._retrievingSecurityToken=!0,Rally.environment.getIoProvider().httpGet({type:"security/authorize",success:function(response){Rally.env.IoProvider.setSecurityToken(response.SecurityToken),this._retrievingSecurityToken=!1,provider.request(options),provider.fireEvent("securitytokenretrieved")},scope:this}))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.data.wsapi.JsonPProxy",{extend:Ext.data.proxy.JsonP,alternateClassName:["Rally.sdk.data.WsapiJsonPProxy"],alias:["proxy.rally.data.proxy.wsapijsonp","proxy.rally.data.proxy.jsonp","proxy.Rally.sdk.data.WsapiJsonPProxy","proxy.rallywsapijsonpproxy"],mixins:{proxy:Rally.data.wsapi.ProxyBase},defaultPageSize:200,format:"js",filterParam:"query",limitParam:"pagesize",groupParam:"order",sortParam:"order",pageParam:void 0,autoAppendParams:!1,callbackKey:"jsonp",recordParam:"artifact",buildRequest:function(operation){this.noCache="read"===operation.action,operation.params=operation.params||{},operation.params._method=Rally.data.wsapi.ProxyBase.getMethod(operation.action);var request=this.callParent(arguments);return this.mixins.proxy.buildRequest.call(this,operation,request)},buildUrl:function(request){this.mixins.proxy.buildUrl.call(this,request),"update"!==request.action&&"destroy"!==request.action||(request.url=(request.url||this.url)+"/"+request.records[0].get("ObjectID")),"destroy"===request.action&&delete request.records,request.operation.id&&"create"!==request.action&&(request.url=(request.url||this.url)+"/"+request.operation.id,delete request.params.id);var url=this.callParent(arguments),records=request.records;return Ext.isArray(records)&&records.length>0&&(url=Ext.urlAppend(url,Ext.String.format("{0}={1}",this.recordParam,this.encodeRecords(records)))),url},getUrl:function(){var url=this.callParent(arguments),formatRe=new RegExp("\\."+this.format+"$");return url.match(formatRe)?url:url+"."+this.format},processResponse:function(success,operation,request,response,callback,scope){success=this.mixins.proxy.processResponse.call(this,success,operation,request,response,callback,scope),this.callParent([success,operation,request,response,callback,scope])},setException:function(operation,response){this.mixins.proxy.setException.call(this,operation,response||{Result:{Errors:["Null response.  Invalid security context?"]}})},encodeFilters:function(filters){return this.mixins.proxy.encodeFilters(filters)},encodeSorters:function(sorters){return this.mixins.proxy.encodeSorters(sorters)},parseResponse:function(response){return response},encodeRecords:function(records){var record=records[0],data=this.writer.getRecordData(record),toEncode={};return toEncode[this.model.typePath]=data,window.encodeURIComponent(Ext.JSON.encode(toEncode))},destroy:function(){return this.doRequest.apply(this,arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.data.lookback.JsonPProxy",{extend:Ext.data.proxy.JsonP,alternateClassName:["Rally.data.SnapshotJsonPProxy"],alias:["proxy.snapshotjsonp","proxy.Rally.data.SnapshotJsonPProxy","proxy.rallylookbackjsonpproxy"],format:"js",filterParam:"find",limitParam:void 0,sortParam:"sort",pageParam:void 0,startParam:void 0,autoAppendParams:!1,callbackKey:"jsonp",reader:{type:"json",root:"Results",totalProperty:"TotalResultCount"},timeout:3e5,find:void 0,constructor:function(config){config.context=config.context||Rally.environment.getContext().getDataContext(),config.headers=Ext.merge({},this.headers,config.headers),this.mergeConfig(config),this.callParent([this.config]),this.url=this._buildRootUrl()},_buildRootUrl:function(){return Rally.environment.getServer().getLookbackUrl(this.version)+"/service/rally/workspace/"+Rally.util.Ref.getOidFromRef(this.context.workspace)+"/artifact/snapshot/query"},buildRequest:function(operation){var request=this.callParent(arguments);return Ext.apply(request.params,{fields:this._encodeFetch(),hydrate:this._encodeHydrate(),pagesize:operation.limit,start:operation.start,compress:this.compress,removeUnauthorizedSnapshots:this.removeUnauthorizedSnapshots,find:this.encodeFilters(operation.filters)}),request.params[this.sortParam]||(request.params[this.sortParam]=this.encodeSorters(operation.sorters)),request},_encodeFetch:function(){return Ext.JSON.encode(this.fetch)},_encodeHydrate:function(){return Ext.JSON.encode(this.hydrate)},_encodeFilters:function(filters){var query,find=this.find;return filters&&filters.length&&(Ext.each(filters,function(filter){query=query?query.and(filter):filter instanceof Rally.data.lookback.QueryFilter?filter:Rally.data.lookback.QueryFilter.fromExtFilter(filter)}),query=query.toObject()),find&&("string"==typeof find&&(find=Ext.decode(find)),query=query?{$and:[query,find]}:find),query||{}},encodeFilters:function(filters){var implicitFind=this._getImplicitFilters(),find=this._encodeFilters(implicitFind.concat(filters||[]));return Ext.JSON.encode(find)},_getImplicitFilters:function(){var implicitFilters=[];return this._etlDate&&implicitFilters.push({property:"_ValidFrom",operator:"<=",value:this._etlDate}),implicitFilters},encodeSorters:function(sorters){var sortObj={};return Ext.isObject(sorters)&&(sorters=[sorters]),Ext.isArray(sorters)&&sorters.length?(Ext.Array.each(sorters,function(sorter){sortObj[sorter.property]="ASC"===sorter.direction?1:-1}),Ext.JSON.encode(sortObj)):this.sort&&_.keys(this.sort).length?Ext.JSON.encode(this.sort):""},processResponse:function(success,operation,request,response,callback,scope){if(success){var r=response;r.Errors&&r.Errors.length>0?success=!1:this._etlDate=r.ETLDate}this.callParent([success,operation,request,response,callback,scope])},setException:function(operation,response){var error=operation.getError()||{};operation.setException(Ext.apply(error,{errors:response.Errors}))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.SessionStorage",{singleton:!0,initialize:function(sessionId,reinitialize){this.instance&&!reinitialize||(this.instance=Ext.create("Rally.state.SessionStorageProvider",{prefix:sessionId}),Ext.state.Manager.setProvider(this.instance))},getInstance:function(){if(!this.instance)throw Error("Session storage must be initialized before use - see the initialize() method");return this.instance}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.PersistentStorageProvider",{extend:Ext.state.Provider,appScopedProvider:null,nonScopedProvider:null,loadAppScopedState:function(preferenceOpts){return this.appScopedProvider.loadAppScopedState(preferenceOpts)},addAppScopedState:function(state,preferenceOpts){return this.appScopedProvider.addAppScopedState(state,preferenceOpts)},get:function(name,defaultValue){return this.appScopedProvider.isAppScopedState(name)?this.appScopedProvider.get(name,defaultValue):this.nonScopedProvider.get(name,defaultValue)},set:function(name,value){this.appScopedProvider.isAppScopedState(name)?this.appScopedProvider.set(name,value):this.nonScopedProvider.set(name,value),this.fireEvent("statechange",this,name,value)},clear:function(name){this.appScopedProvider.isAppScopedState(name)?this.appScopedProvider.clear(name):this.nonScopedProvider.clear(name),this.fireEvent("statechange",this,name,null)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.Bootstrapper",{singleton:!0,getIncludes:function(itemType){return Rally.dependencies.Loader.getIncludes(itemType)},getInclude:function(itemType,itemName){return Rally.dependencies.Loader.getInclude(itemType,itemName)},loadStylesheet:function(cssPath,refNode,callback){return Rally.dependencies.Loader.loadStylesheet(cssPath,refNode).then(callback)},loadScript:function(scriptPath,optionalAttributes,callback){return Rally.dependencies.Loader.loadScript(scriptPath,optionalAttributes).then(callback)},_getSdkInclude:function(){return this.getInclude("script","sdk")},_loadResources:function(){var sdkInclude=this._getSdkInclude(),me=this,cssResources=["rui-all_02.css","rui-all_01.css","rui-fonts.css"];Deft.Chain.sequence(_.map(cssResources,function(cssResource){return function(){return me.loadStylesheet(Rally.environment.getServer().getResourcesPath()+"/css/"+cssResource,sdkInclude)}})).then({success:this._callOnReadyFns,scope:this})},_callOnReadyFns:function(){Ext.onReady(function(){for(var fn;this._onReadyFns.length;)(fn=this._onReadyFns.shift())();this._ready=!0,this._readyInProgress=!1},this)},onReady:function(onReady){if(this._ready)return onReady();if(this._readyInProgress)this._onReadyFns.push(onReady);else{this._readyInProgress=!0,this._onReadyFns=[onReady],Rally.environment||Ext.create("Rally.sdk.env.Global").setup(),this._setupGlobalToggles(),this._enableDataRequestGrouping();var context=Rally.environment.getContext(),sdkInfo=this.getSdkInfo(),project=sdkInfo.project,projectScopeUp="true"===sdkInfo.projectScopeUp,projectScopeDown=!Ext.isDefined(sdkInfo.projectScopeDown)||"true"===sdkInfo.projectScopeDown;if(!context||project&&project!=="/project/"+context.getProject().ObjectID||projectScopeDown!==context.getProjectScopeDown()||projectScopeUp!==context.getProjectScopeUp()){var loader=this._getContextLoader();loader.load({project:project,success:function(rawContext){rawContext.scope.up=projectScopeUp,rawContext.scope.down=projectScopeDown,Rally.environment.externalContext=rawContext,this._loadResources()},scope:this})}else this._loadResources()}},_setupGlobalToggles:function(){Rally.environment.useWorkspaceTimeZone=!0},_enableDataRequestGrouping:function(){Rally.data.RequestGrouper.enable(Ext.Ajax)},_getContextLoader:function(){return Ext.create("Rally.sdk.env.RemoteContextLoader")},_addSdkHeaders:function(headers){Ext.Object.each(this.appInfo,function(key,value){headers["X-RallyIntegration"+Ext.String.capitalize(key)]=value})},_wireIoHeaderHandlers:function(){var headers={};this._addSdkHeaders(headers),Rally.data.wsapi.Proxy.prototype.headers=headers,Rally.data.lookback.SnapshotRestProxy.prototype.headers=headers,Rally.sdk.data.wsapi.JsonPProxy.prototype.headers=headers,Rally.sdk.data.lookback.JsonPProxy.prototype.headers=headers},launchApp:function(className,metaData){this.appInfo=metaData||{name:className},this.appInfo.library="AppSDK "+Rally.sdk.Bootstrapper.getSdkInfo().sdkVersion;var me=this;this.onReady(function(){me._loadTimeboxScope(function(timeboxScope){me._launchAppInViewport(className,timeboxScope)})})},destroyApp:function(){var app=this.app,viewport=app.up();viewport.destroy(),delete this.app},getApp:function(){return this.app},_initializeStateProvider:function(){var context=Rally.environment.getContext(),appID=this._findAppID()||"external";Rally.state.SessionStorage.initialize(Rally.state.SessionStorageProvider.APP_PREFIX+appID+"-"+context.getUser().ObjectID+"-"),Ext.state.Manager.setProvider(Ext.create("Rally.state.PersistentStorageProvider",{appScopedProvider:Ext.create("Rally.state.AppScopedStorageProvider"),nonScopedProvider:Rally.state.SessionStorage.getInstance()}))},_cleanup:function(){_.each(Ext.ComponentQuery.query("[floating=true]"),function(cmp){try{cmp.destroy()}catch(e){}})},_launchAppInViewport:function(className,timeboxScope){this._wireIoHeaderHandlers(),this._initializeStateProvider(),this.app=this._createApp(className,timeboxScope);var viewport=Ext.create("Ext.Viewport",{layout:"fit",items:[this.app],listeners:{
destroy:this._cleanup,scope:this}});try{var settingsFields=this.app.getSettingsFields(),options=this.app.getOptions(),isExternal=Rally.environment.isExternal(),shouldShowMenu=isExternal&&options.length+settingsFields.length>0;if(shouldShowMenu){var gearMenu=Ext.create("Ext.Component",{xtype:"component",itemId:"appActionGear",cls:"icon-gear app-menu",renderTo:Ext.getBody(),listeners:{click:function(e,el){var menuItems=[];settingsFields.length&&menuItems.push({text:"Settings",handler:function(){var appSettings=this.app.showSettings();gearMenu.hide(),appSettings.on({save:gearMenu.show,cancel:gearMenu.show,scope:gearMenu})},scope:this}),menuItems.concat(options);var menu=Ext.create("Rally.ui.menu.Menu",{defaultAlign:"tr-br",items:menuItems.concat(options)});menu.showBy(el)},element:"el",scope:this}});viewport.on("destroy",function(){gearMenu.destroy()})}}catch(e){}},_loadTimeboxScope:function(callback){var sdkInfo=this.getSdkInfo();if(sdkInfo.timebox){var type=Rally.util.Ref.getTypeFromRef(sdkInfo.timebox);Rally.util.Ref.getOidFromRef(sdkInfo.timebox)?Rally.data.ModelFactory.getModel({context:Rally.environment.getContext().getDataContext(),type:type,success:function(timeboxModel){timeboxModel.load(Rally.util.Ref.getOidFromRef(sdkInfo.timebox),{success:function(timeboxRecord){callback(Ext.create("Rally.app.TimeboxScope",{type:type,record:timeboxRecord}))}})}}):callback(Ext.create("Rally.app.TimeboxScope",{type:sdkInfo.timebox,record:null}))}else callback()},_createApp:function(className,timeboxScope){return Ext.create(className,{context:this._buildAppContext(timeboxScope)})},_buildAppContext:function(timeboxScope){var context=Rally.environment.getContext(),appID=this._findAppID(),contextValues={workspace:context.getWorkspace(),project:context.getProject(),projectScopeUp:context.getProjectScopeUp(),projectScopeDown:context.getProjectScopeDown(),appID:appID,user:context.getUser(),subscription:context.getSubscription(),permissions:context.getPermissions()};return timeboxScope&&(contextValues.timebox=timeboxScope),Ext.create("Rally.app.Context",{initialValues:contextValues})},_findAppID:function(){var queryParams=Ext.Object.fromQueryString(window.location.search);return queryParams.panelOid},getSdkInfo:function(){function applyQueryStringValues(obj,queryString){for(var queryTokens=queryString.split("&"),j=0;j<queryTokens.length;j++){var nameValuePair=queryTokens[j].split("=");2===nameValuePair.length&&(obj[nameValuePair[0]]=window.decodeURIComponent(nameValuePair[1]))}}var info={wsapiVersion:"v2.0",lookbackVersion:"v2.0",sdkVersion:"2.1"},urlQueryTokens=window.location.href.split("?");urlQueryTokens.length>1&&applyQueryStringValues(info,urlQueryTokens[1]);var sdkScript=this._getSdkInclude();if(sdkScript){var scriptSrc=sdkScript.getAttribute("src"),sourceTokens=scriptSrc.split("?"),pathTokens=sourceTokens[0].split("/");pathTokens.pop(),info.path=pathTokens.join("/"),sourceTokens.length>1&&applyQueryStringValues(info,sourceTokens[1])}return info}},function(){Rally.launchApp=function(app,metaData){Rally.sdk.Bootstrapper.launchApp(app,metaData)},Rally.getApp=function(){return Rally.sdk.Bootstrapper.getApp()},Rally.destroyApp=function(){Rally.sdk.Bootstrapper.destroyApp()},Rally.getSdkInfo=function(){return Rally.sdk.Bootstrapper.getSdkInfo()},Rally.loadScripts=function(scriptPaths,callback,forceNoCache){if(scriptPaths.length>0){var scriptPath=scriptPaths.splice(0,1)[0];forceNoCache&&(scriptPath+=(scriptPath.indexOf("?")===-1?"?":"&")+"_dc="+Math.random()),Rally.sdk.Bootstrapper.loadScript(scriptPath,null,Ext.Function.bind(Rally.loadScripts,Rally,[scriptPaths,callback]))}else Ext.callback(callback)},Rally.onReady=function(onReady){Rally.sdk.Bootstrapper.onReady(onReady)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.sdk.env.RemoteContextLoader",{constructor:function(config){Ext.apply(this,config),this.ioProvider=this.ioProvider||Rally.environment.getIoProvider(),this.callParent(arguments)},_getProjectFetch:function(){return Ext.Array.union(["Name","ObjectID","Workspace","SchemaVersion","State"],this._getWorkspaceConfigurationFetch())},_getWorkspaceConfigurationFetch:function(){return["WorkspaceConfiguration","WorkDays","DragDropRankingEnabled","BuildandChangesetEnabled","TimeZone","DateFormat","DateTimeFormat","IterationEstimateUnitName","ReleaseEstimateUnitName","TaskUnitName"]},_loadProject:function(loadOptions){this.ioProvider.httpGet({item:loadOptions.project,params:{fetch:this._getProjectFetch()},success:function(project){loadOptions.context.scope.project=project,loadOptions.context.scope.workspace=project.Workspace,this._onLoadComplete(loadOptions)},scope:this})},_loadFirstProject:function(loadOptions){this.ioProvider.httpGet({type:"Project",params:{fetch:this._getProjectFetch(),pagesize:1},success:function(result){var projects=result.Results;projects.length&&(loadOptions.context.scope.project=projects[0],loadOptions.context.scope.workspace=projects[0].Workspace,this._onLoadComplete(loadOptions))},scope:this})},_loadUser:function(loadOptions){this.ioProvider.httpGet({type:"User",params:{fetch:Ext.Array.union(["UserName","ObjectID","Name","LandingPage","SubscriptionAdmin","OnPremLdapUsername","UserPermissions","UserProfile","DateFormat","DateTimeFormat","TimeZone","DefaultWorkspace","DefaultProject","Role"],this._getWorkspaceConfigurationFetch())},success:function(user){return loadOptions.context.user=user,loadOptions.project||(loadOptions.context.scope.project=user.UserProfile.DefaultProject,loadOptions.context.scope.workspace=user.UserProfile.DefaultWorkspace,user.UserProfile.DefaultProject)?void this._onLoadComplete(loadOptions):void this._loadFirstProject(loadOptions)},scope:this})},_loadSubscription:function(loadOptions){this.ioProvider.httpGet({type:"Subscription",params:{fetch:["MaximumProjects","SubscriptionType","ProjectHierarchyEnabled","StoryHierarchyEnabled","Modules","ExpirationDate"]},success:function(subscription){loadOptions.context.subscription=subscription,this._onLoadComplete(loadOptions)},scope:this})},_loadPermissions:function(options){this.ioProvider.httpGet({type:"user:current/permissions/all",success:function(result){options.context.permissions=Ext.create("Rally.auth.UserPermissions",result.Results),this._onLoadComplete(options)},failure:function(){options.context.permissions=Ext.create("Rally.auth.UserPermissions",[]),this._onLoadComplete(options)},scope:this})},_onLoadComplete:function(loadOptions){loadOptions.context.subscription&&loadOptions.context.user&&loadOptions.context.permissions&&loadOptions.context.scope.project&&Ext.callback(loadOptions.success,loadOptions.scope,[loadOptions.context])},load:function(loadOptions){var options=Ext.apply({context:{scope:{}}},loadOptions);this._loadUser(options),this._loadSubscription(options),this._loadPermissions(options),loadOptions.project&&this._loadProject(options)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.state.UserScopedCacheProvider",{mixins:[Rally.Messageable,Ext.util.Observable],timeout:45,context:null,namespace:"",constructor:function(config){this.mergeConfig(config),Ext.isEmpty(this.namespace)&&Ext.Error.raise("Namespace is empty"),Ext.isEmpty(this.context)&&Ext.Error.raise("Context is empty")},get:function(){return this._getStorageProvider().get(this._getCacheKey())},set:function(data){this._cacheContent(this._getCacheKey(),data)},clear:function(){this._getStorageProvider().clear(this._getCacheKey())},_getCacheKey:function(){return Rally.util.Ref.getRelativeUri(this.context.getUser())+":"+this.context.getScopeStr()},_cacheContent:function(key,content){this._getStorageProvider().set(key,content)},_getStorageProvider:function(){return this.storageProvider||(this.storageProvider=Ext.create("Rally.state.LSCacheProvider",{timeout:this.timeout,namespace:this.namespace})),this.storageProvider}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.Slider",{requires:[],extend:Ext.slider.Single,alias:"widget.rallyslider",clientMetrics:{event:"dragend",descriptionProperty:"userAction",description:"value changed by dragging"},width:100,decrementSlider:function(times){this._changeValue(Ext.isNumber(times)?-times:-1)},incrementSlider:function(times){this._changeValue(Ext.isNumber(times)?times:1)},_changeValue:function(times){this.setValue(this.getValue()+this.increment*times)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.ButtonSlider",{alias:"widget.rallybuttonslider",extend:Ext.container.Container,layout:{type:"hbox",align:"middle"},width:200,componentCls:"rui-button-slider",config:{leftButtonConfig:void 0,rightButtonConfig:void 0,sliderConfig:void 0,labelText:void 0},constructor:function(config){this.initConfig(config),config=Ext.merge({items:_.compact([this._getLabelConfig(),this._getButtonConfig("left",{handler:this.decrement}),Ext.apply({xtype:"rallyslider",width:100},this.sliderConfig),this._getButtonConfig("right",{handler:this.increment})])},config),this.callParent([config])},_getLabelConfig:function(){return this.labelText?{xtype:"label",text:this.labelText,cls:"rui-label"}:null},_getButtonConfig:function(position,config){return Ext.apply({xtype:"rallybutton",width:32,frame:!1,userAction:position+" button clicked",cls:position+"-button",iconOnly:!0,iconCls:"icon",scope:this},config,this[position+"ButtonConfig"])},decrement:function(times){this.getSlider().decrementSlider(times)},increment:function(times){this.getSlider().incrementSlider(times)},setValue:function(value){this.getSlider().setValue(value)},getValue:function(){return this.getSlider().getValue()},getLeftButton:function(){return this.query(".rallybutton")[0]},getRightButton:function(){return this.query(".rallybutton")[1]},getSlider:function(){return this.down(".rallyslider")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.PercentDone",{extend:Ext.Component,alias:"widget.rallypercentdone",config:{percentDone:0,showDangerNotification:!1},width:100,height:20,constructor:function(config){this.renderTpl=Ext.create("Rally.ui.renderer.template.progressbar.PortfolioItemPercentDoneTemplate",{showDangerNotificationFn:Ext.bind(function(){return this.getShowDangerNotification()},this)}),this.renderData=config,this.mergeConfig(config),this.callParent([this.config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.RadioField",{requires:[],extend:Ext.form.field.Radio,alias:"widget.rallyradiofield",stateEvents:["change"],cls:"rally-radiofield-component",getState:function(){return{checked:this.isChecked(this.getValue())}},applyState:function(state){this.setValue(state.checked)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.SearchField",{extend:Ext.Container,alias:"widget.rallysearchfield",layout:"hbox",cls:"rally-search-field",config:{searchOnKeyup:!0,showSearchButton:!0},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.items=[{xtype:"rallytextfield",itemId:"searchText",cls:"rally-search-text",flex:1,enableKeyEvents:!0,emptyText:"Search",listeners:{specialkey:{fn:this._onTextFieldSpecialKey,scope:this,buffer:400},keyup:this.searchOnKeyup?{fn:this._onTextFieldNonSpecialKey,scope:this}:{},scope:this}}],this.showSearchButton&&this.items.push({xtype:"component",itemId:"searchButton",cls:"icon-search rally-search-button",listeners:{click:{element:"el",fn:this._fireSearch,scope:this}}}),this.addEvents(["search","change"]),this.callParent(arguments);var textField=this.down("#searchText");this.relayEvents(textField,["change"])},getValue:function(){return this.down("#searchText").getValue()},setValue:function(value){this.down("#searchText").setValue(value)},_fireSearch:function(){this.fireEvent("search",this,this.getValue())},_onTextFieldSpecialKey:function(field,e){(e.getKey()===e.ENTER||this._allowedSpecialKey(e))&&this._fireSearch()},_allowedSpecialKey:function(e){var key=e.getKey();return this.searchOnKeyup&&(key===e.BACKSPACE||key===e.DELETE)},_onTextFieldNonSpecialKey:function(field,e){this._fireSearch()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.WebLinkField",{extend:Ext.Container,alias:"widget.rallyweblinkfield",mixins:{field:Ext.form.field.Field},initComponent:function(){this.callParent(arguments),this.addEvents("blur"),this.mixins.field.initField.call(this),this._draw()},_draw:function(){this.displayStringField=this.add({xtype:"textfield",fieldLabel:"Link Label",value:this.value&&this.value.DisplayString?this.value.DisplayString:"",submitValue:!1,listeners:{focus:this._cancelBlur,blur:this._fireDelayedBlur,scope:this}}),this.linkIdField=this.add({xtype:"textfield",fieldLabel:"ID",value:this.value&&this.value.LinkID?this.value.LinkID:"",submitValue:!1,listeners:{focus:this._cancelBlur,blur:this._fireDelayedBlur,scope:this}})},_cancelBlur:function(){this.blurTimeout&&this.blurTimeout.cancel()},_fireDelayedBlur:function(){this.blurTimeout=Ext.create("Ext.util.DelayedTask",function(){this.fireEvent("blur")},this),this.blurTimeout.delay(100)},setValue:function(value){value&&value.DisplayString&&this.displayStringField&&this.displayStringField.setValue(value.DisplayString),value&&value.LinkID&&this.linkIdField&&this.linkIdField.setValue(value.LinkID)},getValue:function(){var value=this.value||{};return value=Ext.clone(value),this.displayStringField&&(value.DisplayString=this.displayStringField.getValue()),this.linkIdField&&(value.LinkID=this.linkIdField.getValue()),value},getSubmitData:function(){var submitData={};return submitData[this.getName()]=this.getValue(),submitData}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.badge.Badge",{extend:Ext.Component,mixins:{toolTippable:Rally.ui.tooltip.ToolTippable},alias:"widget.rallybadge",renderTpl:Ext.create("Ext.XTemplate",'<div class="rly-badge {type}">','<div class="badge-l"><div class="badge-r"><div class="badge-m">{badgeText}</div></div></div>',"</div>"),renderSelectors:{badgeEl:"div.rly-badge"},config:{type:"new",badgeText:void 0,toolTipType:"Rally.ui.badge.BadgeToolTip",toolTipConfig:void 0,toolTipPreferenceKey:void 0},constructor:function(config){this.initConfig(config),this.renderData={type:this.type,badgeText:this.badgeText?this.badgeText:this.type.toUpperCase()},this.callParent(arguments)},getToolTipTargetEl:function(){return this.badgeEl.dom},onDestroy:function(){this.callParent(),this.toolTip&&Ext.destroy(this.toolTip)},onRender:function(){this.callParent(arguments),this.toolTipText?(this.toolTipConfig={html:'<div class="tooltip-text">'+this.toolTipText+"</div>",anchor:"top",showDelay:0},this.buildToolTip()):this.toolTipConfig&&(this.toolTipConfig=Ext.applyIf(this.toolTipConfig,{showDelay:0}),this.buildToolTip())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.badge.BadgeToolTip",{extend:Rally.ui.tooltip.ToolTip,alias:"widget.rallybadgetooltip",config:{delegate:".badge-m",heading:void 0,text:void 0,helpId:void 0,demoVideoId:void 0,optoutDefaults:{handler:void 0,pretext:"For a limited time ",linktext:"switch back",posttext:"."},optinDefaults:{handler:void 0,pretext:void 0,linktext:"Switch to the new behavior",posttext:void 0,switchBackText:void 0},feedbackDefaults:{link:{handler:void 0,pretext:"",linktext:"Share your feedback with us.",posttext:"",url:void 0},dialog:{subject:void 0,title:void 0,text:void 0}},closable:!1,showOnClick:!0},toolTipTpl:Ext.create("Ext.XTemplate",'<tpl if="heading"><h3 class="tooltip-heading">{heading}</h3></tpl>','<tpl if="text"><div class="tooltip-text">{text}</div></tpl>','<tpl if="helpLink"><br/><div class="tooltip-help">{helpLink}</div></tpl>','<tpl if="demoVideoLink"><br/><div class="tooltip-demo">{demoVideoLink}</div></tpl>','<tpl if="feedbackLink"><br/><div class="tooltip-feedback">{feedbackLink}</div></tpl>','<tpl if="optoutLink"><br/><div class="tooltip-optout">{optoutLink}</div></tpl>','<tpl if="optinLink"><br/><div class="tooltip-optin">{optinLink}</div></tpl>'),linkTpl:Ext.create("Ext.XTemplate",'{pretext}<a href="{url}" class="{cls}" target="{target}" onclick="{clicktext}">{linktext}</a>{posttext}'),constructor:function(config){config.optin&&(config.optin=Ext.apply({},config.optin,this.config.optinDefaults)),config.optout&&(config.optout=Ext.apply({},config.optout,this.config.optoutDefaults)),config.feedback&&(this.config.feedbackDefaults.link.handler=this._showFeedbackDialog,config.feedback.link=Ext.apply({},config.feedback.link,this.config.feedbackDefaults.link),config.feedback.dialog=Ext.apply({},config.feedback.dialog,this.config.feedbackDefaults.dialog)),this.callParent(arguments),this.html=this.toolTipTpl.apply(this._buildToolTipConfig())},onRender:function(){this.on("afterrender",this._addClickBehaviors,this),this.callParent(arguments)},_addClickBehaviors:function(){this.optin&&this._registerClickHandler("div.tooltip-optin a",this._optinClickHandler),this.optout&&this._registerClickHandler("div.tooltip-optout a",this._optoutClickHandler),this.feedback&&!this.feedback.link.url&&this._registerClickHandler("div.tooltip-feedback a",this._feedbackClickHandler)},_registerClickHandler:function(queryString,handler){var el=this.getEl()&&this.getEl().down(queryString);el&&this.mon(el,"click",handler,this,{stopEvent:!0})},_optinClickHandler:function(){this.hide(),this.optin.handler()},_optoutClickHandler:function(){this.hide(),this.optout.handler()},_feedbackClickHandler:function(){this.hide(),this.feedback.link.handler.call(this.feedback.dialog)},_showFeedbackDialog:function(){Ext.create("Rally.ui.dialog.FeedbackDialog",{message:this.text,cancelButtonText:"Cancel",title:"Feedback on "+this.title,subject:this.subject,autoShow:!0,action:"feedback",likertEnabled:!1,feedbackId:this.feedbackId})},_buildToolTipConfig:function(){var demoVideoLink;if(this.demoVideoId){var linkTpl=Ext.create("Ext.XTemplate","{pretext}",'<a href="{url}" class="{cls}" target="{target}" onclick="Rally.util.Help.launchHelp({id:{helpId}, demoVideo: true});return false;">{text}</a>',"{posttext}");demoVideoLink=linkTpl.apply({cls:"demo-video",pretext:"",helpId:this.demoVideoId,text:"Watch a demo"})}return{heading:this.heading,text:this.text,helpLink:this._buildHelpLink(),demoVideoLink:demoVideoLink,feedbackLink:this._buildFeedbackLink(),optoutLink:this._buildOptOutLink(),optinLink:this._buildOptInLink()}},_buildHelpLink:function(){return this.helpId?this._buildLink({linktext:"Learn More",clicktext:"Rally.util.Help.launchHelp({id:"+this.helpId+"});return false;"}):null},_buildFeedbackLink:function(){return this.feedback?this._buildLink(this.feedback.link):null},_buildOptOutLink:function(){return this.optout?this._buildLink(this.optout):null},_buildOptInLink:function(){if(this.optin){var link=this._buildLink(this.optin);return this.optin.switchBackText&&(link=link.concat("<br/>",this.optin.switchBackText)),link}return null},_buildLink:function(linkConfig){return this.linkTpl.apply(Ext.apply({url:"#"},linkConfig))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.button.EditMode",{extend:Rally.ui.Button,alias:"widget.rallyeditmode",config:{editMode:!0},cls:"edit-mode-button medium",disabledCls:"rly-disabled",initComponent:function(){this.enableBubble("editmodechange"),this.isDisabled()||(this.menu={componentCls:"edit-button-menu",items:[{text:"Editing",indent:!1,listeners:{click:{fn:function(){this.setEditMode(!0)},scope:this}}},{text:"Viewing",indent:!1,listeners:{click:{fn:function(){this.setEditMode(!1)},scope:this}}}],listeners:{beforeshow:{fn:function(){this.disableToolTip()},scope:this},beforeHide:{fn:function(){this.enableToolTip()},scope:this}}}),this._setEditMode(this.getEditMode()),this.isDisabled()||this.setText('<span class="picto icon-chevron-down"></span>'),this.callParent(arguments)},setEditMode:function(editMode){this.getEditMode()!==editMode&&(this._setEditMode(editMode),this.fireEvent("editmodechange",this,editMode))},_setEditMode:function(editMode){this.editMode=editMode,editMode?this._configureForEditMode():this._configureForViewMode()},_configureForEditMode:function(){this.setIconCls("picto icon-edit"),this.setToolTipText("You are Editing")},_configureForViewMode:function(){this.setIconCls("picto icon-view"),this.isDisabled()?this.setToolTipText("Viewing Only"):this.setToolTipText("You are Viewing")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.PolicyContainer",{extend:Ext.Container,alias:"widget.rallypolicycontainer",config:{policies:"",columnName:"",prefConfig:{},context:void 0,title:"Exit Policy"},cls:"policy",constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.draw()},canEditPolicy:function(){return Rally.environment.getContext().getPermissions().isProjectEditor(this.getContext().getProject()._ref)},draw:function(){this.drawPolicyHeader(),this.drawPolicy()},onEditClick:function(){Ext.create("Rally.ui.dialog.RichTextDialog",{title:"Edit the "+this.getTitle()+' for "'+this.getColumnName()+'" Column',headerItems:[{xtype:"component",cls:"kanbanPolicyRichTextEditorHeader",html:"What needs to be done before an item is ready to leave this column?"}],autoShow:!0,editorMaxHeight:500,text:this.getPolicyText(),listeners:{save:this._onSave,scope:this}})},getPolicyText:function(){return this.getPolicies()},drawPolicyHeader:function(){var me=this;this.add({xtype:"component",itemId:"policyHeader",cls:"policyHeader",renderTpl:Ext.create("Ext.XTemplate",'<span class="policy-label">'+this.getTitle()+"</span>",'<tpl if="this.canEditPolicy()"><a class="editPolicy" href="#">(Edit)</a></tpl>',{canEditPolicy:function(){return me.canEditPolicy()}}),renderSelectors:{editLink:".editPolicy"},listeners:{click:{element:"editLink",fn:this.onEditClick,stopEvent:!0},scope:this}})},drawPolicy:function(){this.down("#policyContainer")&&this.down("#policyContainer").destroy(),this.add({xtype:"component",itemId:"policyContainer",renderTpl:'<div class="policyContent">{policies}</div>',renderData:{policies:this.getPolicyText()}})},_onSave:function(text){var prefConfig=Ext.apply({success:function(){this.setPolicies(text),this.drawPolicy()},scope:this},this.prefConfig);prefConfig.settings[Ext.Object.getKeys(this.prefConfig.settings)[0]]=text,Rally.data.PreferenceManager.update(prefConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.CollapsibleColumns",{alias:"plugin.rallycardboardcollapsiblecolumns",extend:Ext.AbstractPlugin,stateful:!0,statics:{COLLAPSED_WIDTH:25},mixins:[Rally.clientmetrics.ClientMetricsRecordable],clientMetrics:[{method:"_userInitiatedCollapse",description:"collapsed column"},{method:"_userInitiatedExpand",description:"expanded column"}],init:function(column){this.callParent(arguments),this.column=column,this.cardboard=column.ownerCardboard,this.columnExpanded=this._setInitialState(),this.originalGetMinWidth=this.column.getMinWidth,this.column.getMinWidth=Ext.bind(this.getMinWidth,this),this.originalShouldAutoLoadMoreRecords=this.column._shouldAutoLoadMoreRecords,this.column._shouldAutoLoadMoreRecords=Ext.bind(this._shouldAutoLoadMoreRecords,this),this.column.mon(this.column,"afterrender",this._afterColumnRender,this),this.column.mon(this.cardboard,"columnvisibilitychanged",this._onColumnVisibilityChanged,this),this.column.on("rowadd",this._onColumnRowAdd,this)},destroy:function(){this._cleanupColumnNameTooltip(),this.callParent(arguments)},_setInitialState:function(){var columnValue=this.column.getValue()||"nullValue";this.stateId=this.column.getContext().getScopedStateId(columnValue+"-collapsible");var state=Ext.state.Manager.get(this.stateId);return!state||state.expanded},_onColumnClick:function(){this.columnExpanded||this.expand(Ext.isIE10m)},_onColumnRowAdd:function(column,row){var contentCell=row.getContentCellFor(column),contentCellContainer=contentCell.parent();contentCell.setVisibilityMode(Ext.Element.DISPLAY),this._setClassForCollapseState(contentCellContainer,!this.columnExpanded),contentCellContainer.on("click",this._onColumnClick,this)},_setClassesForCollapseState:function(isCollapsed){this.column.getColumnHeaderCell().addCls(isCollapsed?"collapsed":"collapsible").removeCls(isCollapsed?"":"collapsed"),_.each(this.column.getContentCellContainers(),function(cell){this._setClassForCollapseState(cell,isCollapsed)},this)},_setClassForCollapseState:function(cell,isCollapsed){cell.addCls(isCollapsed?"collapsed":"collapsible").addCls("collapsible"),cell.removeCls(isCollapsed?"":"collapsed")},_boardHasRows:function(){return this.cardboard.rowConfig},_afterColumnRender:function(){this.column.on("showpolicy",this._onPolicyChange,this),this.column.on("hidepolicy",this._onPolicyChange,this),this._setClassesForCollapseState(!1),this._addHoverListener(Ext.Array.merge(this.column.getColumnHeaderCell(),this.column.getContentCells())),this.column.getColumnHeader().getEl().setVisibilityMode(Ext.Element.DISPLAY),_.invoke(this.column.getContentCells(),"setVisibilityMode",Ext.Element.DISPLAY),this._addCollapseComponents(),this._boardHasRows()&&this._addHiddenSizingRow(),this.columnExpanded||(this.collapse(!0),this._addColumnNameTooltip())},_addHiddenSizingRow:function(){var columnsTBody=this.column.getEl().up(".cardboard").down(".columns"),sizingCellContainer=columnsTBody.down(".sizing-container");sizingCellContainer||(sizingCellContainer=columnsTBody.insertFirst({tag:"tr",cls:"sizing-container"})),this.sizingCell=sizingCellContainer.appendChild({tag:"td",cls:"sizing-cell"})},_addColumnNameTooltip:function(){this.columnHeaderTooltip||(this.columnHeaderTooltip=Ext.create("Rally.ui.tooltip.ToolTip",{target:this.column.getColumnHeaderCell(),delegate:".collapsed-tooltip-target",hideDelay:100,anchor:"left",mouseOffset:[2,2],html:this.column.getColumnHeader().getHeaderValue()}))},_cleanupColumnNameTooltip:function(){this.columnHeaderTooltip&&(this.columnHeaderTooltip.destroy(),delete this.columnHeaderTooltip)},_addCollapseComponents:function(){var container=Ext.DomHelper.insertFirst(this.column.getColumnHeaderCell(),{tag:"div",cls:"expand-collapse-container"});this._boardHasRows()&&Ext.DomHelper.insertAfter(container,{tag:"div",cls:"collapsed-title-fade collapsed-tooltip-target"}),this.collapseButton=this._createButton(!0,container),this.expandButton=this._createButton(!1,container),this.collapsedTitle=Ext.create("Ext.Component",{cls:"collapsed-title collapsed-tooltip-target",renderTo:Ext.isIE8?this.column.getContentCells()[0]:container,html:this.column.getColumnHeader().getHeaderValue(),hidden:this.columnExpanded,hideMode:"display"})},_createButton:function(isCollapseButton,container){return Ext.create("Rally.ui.Button",{cls:(isCollapseButton?"icon-collapse-column":"icon-expand-column")+" expand-collapse",frame:!1,handler:function(){isCollapseButton?this._userInitiatedCollapse():this._userInitiatedExpand()},renderTo:container,hidden:isCollapseButton?!this.columnExpanded:this.columnExpanded,scope:this})},_addHoverListener:function(cells){_.each(cells,function(cell){cell.on("mouseover",function(){this._modifyHoverClasses("addCls",cells)},this),cell.on("mouseout",function(){this._modifyHoverClasses("removeCls",cells)},this)},this)},_modifyHoverClasses:function(methodName,cells){_.invoke(cells,methodName,["mouseover"])},_onColumnVisibilityChanged:function(){this.columnExpanded&&this.collapseButton.setVisible(!this._isLastExpandedColumn())},getMinWidth:function(){return this.columnExpanded?this.originalGetMinWidth.call(this.column):this.self.COLLAPSED_WIDTH},_shouldAutoLoadMoreRecords:function(){return this.columnExpanded&&this.originalShouldAutoLoadMoreRecords.call(this.column)},_collapseExpandSetup:function(collapsing){this.columnExpanded=!collapsing,this._saveState(),collapsing?(this.collapseButton.hide(),this.collapsedTitle.show(),this.column.getColumnHeader().getEl().hide(),_.invoke(this.column.getContentCells(),"hide"),this._setClassesForCollapseState(!0)):(this.expandButton.hide(),this.collapsedTitle.hide(),this.column.getColumnHeader().getEl().show())},_collapseExpandSuccess:function(collapsing){this.cardboard.fireEvent("headersizechanged",this),this.cardboard.fireEvent("columnvisibilitychanged",this),collapsing?(this.expandButton.show(),this.column.dropControllerPlugin.disable(),Ext.defer(function(){_.invoke(this.column.getContentCellContainers(),"on","click",this._onColumnClick,this),this.column.getColumnHeaderCell().on("click",this._onColumnClick,this)},1,this)):(this.collapseButton.show(),_.invoke(this.column.getContentCells(),"show"),this.column.dropControllerPlugin.enable(),this._setClassesForCollapseState(!1),_.invoke(this.column.getContentCellContainers(),"un","click",this._onColumnClick,this),this.column.getColumnHeaderCell().un("click",this._onColumnClick,this))},_userInitiatedCollapse:function(){this.collapse(Ext.isIE10m)},collapse:function(immediate){if(!this._animating&&!this._isLastExpandedColumn())return this._addColumnNameTooltip(),this._collapseExpandSetup(!0),immediate||this.collapsedTitle.getEl().setOpacity(0),this._resizeColumn(immediate).then({success:function(){this._collapseExpandSuccess(!0)},scope:this})},_userInitiatedExpand:function(){this.expand(Ext.isIE10m)},expand:function(immediate){if(!this._animating)return this._cleanupColumnNameTooltip(),this._collapseExpandSetup(!1),this.column.autoLoadCards(),this._resizeColumn(immediate).then({success:function(){this._collapseExpandSuccess(!1)},scope:this})},_saveState:function(){this.stateful&&Ext.state.Manager.set(this.stateId,{expanded:this.columnExpanded})},_calculateColumnWidth:function(){if(this.columnExpanded){var visibleColumns=this.cardboard.getVisibleColumns(),expandedCount=this._numberOfExpandedColumns(visibleColumns),collapsedCount=visibleColumns.length-expandedCount;return _.each(visibleColumns,function(column){column!==this.column&&this._isColumnExpanded(column)&&column.getColumnHeaderCell().setWidth("auto")},this),(this.cardboard.getWidth()-collapsedCount*this.self.COLLAPSED_WIDTH)/expandedCount}return this.self.COLLAPSED_WIDTH},_numberOfExpandedColumns:function(columns){return _.filter(columns,function(column){return this._isColumnExpanded(column)},this).length},_isColumnExpanded:function(column){var collapsiblePlugin=column.findPlugin(this.ptype);return!collapsiblePlugin||collapsiblePlugin.columnExpanded},_resizeColumn:function(immediate){var width=this._calculateColumnWidth(),animPromises=[];if(immediate){var deferred=Ext.create("Deft.Deferred");animPromises.push(deferred.promise),Ext.defer(function(){deferred.resolve()},1);var els=_.compact(this.column.getContentCellContainers().concat([this.column.getColumnHeaderCell(),this.sizingCell]));_.invoke(els,"setWidth",this.columnExpanded?"auto":width)}else this._animating=!0,animPromises.push(this._animateResize(this.column.getColumnHeaderCell(),width)),_.each(this.column.getContentCellContainers(),function(cell){animPromises.push(this._animateResize(cell,width))},this),this.sizingCell&&animPromises.push(this._animateResize(this.sizingCell,width)),this.columnExpanded||animPromises.push(this._animate(this.collapsedTitle,{from:{top:"-200px",opacity:0},to:{top:"-14px",opacity:1}}));return Deft.Promise.all(animPromises).always(function(){delete this._animating},this)},_isLastExpandedColumn:function(){return this.columnExpanded&&1===this._numberOfExpandedColumns(this.cardboard.getVisibleColumns())},_animate:function(cell,options){var deferred=Ext.create("Deft.Deferred");return cell.animate(Ext.merge({duration:500,listeners:{afteranimate:function(){deferred.resolve()},scope:this}},options)),deferred.promise},_animateResize:function(cell,width){return this._animate(cell,{to:{width:width+"px"}}).then({success:function(){this.columnExpanded&&cell.setWidth("auto")},scope:this})},_onPolicyChange:function(){this._resizeColumn(!0)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.ColumnPolicy",{extend:Ext.AbstractPlugin,alias:"plugin.rallycolumnpolicy",policyCmpConfig:null,app:null,init:function(cmp){
this.callParent(arguments),this.cmp=cmp,this.cmp.addEvents(["showpolicy","hidepolicy"]),this.cmp.on("afterrender",this._onAfterRender,this,{single:!0})},_onAfterRender:function(){this._addPolicyComponent(),this.cmp.on("showpolicy",function(){this._togglePolicy(!0)},this),this.cmp.on("hidepolicy",function(){this._togglePolicy(!1)},this)},_getDefaultPolicyCmpConfig:function(){return Ext.merge({xtype:"rallypolicycontainer",itemId:"policy",context:this.cmp.getContext(),columnName:this.cmp.getColumnHeader().getHeaderValue(),hidden:!0},Ext.isEmpty(this.app)?{}:this._buildPolicyCmpConfigFromApp(this.app))},_addPolicyComponent:function(){this.policyCmpConfig=Ext.merge(this._getDefaultPolicyCmpConfig(),this.policyCmpConfig),this.cmp.getColumnHeader().add(this.policyCmpConfig)},_togglePolicy:function(showPolicy){var policyContainer=this.cmp.getColumnHeader().down("#policy");policyContainer&&(showPolicy?policyContainer.show():policyContainer.hide())},_getPolicyPrefKey:function(app){var policyPrefKey=this._getUnScopedPolicyPrefKey(app),groupBy=app.getSetting("groupByField")||"ungrouped";return groupBy+policyPrefKey},_getUnScopedPolicyPrefKey:function(app){var columnName=(this.cmp.getValue()||"None").toString();return columnName+"Policy"},_getPolicyForColumn:function(app){var policyPrefKey=this._getPolicyPrefKey(app),policy=app.getSetting(policyPrefKey)||app.getSetting(this._getUnScopedPolicyPrefKey(app));return policy||(policy=app.getSetting(policyPrefKey.replace(/^c_/,""))),policy},_buildPolicyCmpConfigFromApp:function(app){var policy=this._getPolicyForColumn(app),prefConfig={appID:app.getAppId(),project:"project"===app.settingsScope?app.getContext().getProject():null,settings:{}};return prefConfig.settings[this._getPolicyPrefKey(app)]=policy,{xtype:"rallypolicycontainer",policies:policy,prefConfig:prefConfig,title:"Exit Agreement"}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.FixedHeader",{alias:"plugin.rallyfixedheadercardboard",extend:Ext.AbstractPlugin,init:function(cmp){cmp._getColumnContainerHtml=Ext.bind(this._getColumnContainerHtml,this),cmp.getScrollElement=Ext.bind(this.getScrollElement,this),cmp.addCls("fixed-header-card-board"),cmp.addEvents("headersizechanged"),cmp.on("headersizechanged",this._setColumnSizes,this),cmp.on("columnready",this._setColumnSizes,this),cmp.on("columnscroll",this._setColumnSizes,this),cmp.on("aftercolumnrender",function(){Ext.EventManager.onWindowResize(this._setColumnSizes,this),this._setColumnSizes(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},this),cmp.on("afterrender",function(){var gridboard=cmp.up("rallygridboard");gridboard&&gridboard.addCls("gridboard-fixed-header-card-board")},this)},_getColumnContainerHtml:function(){return['<div class="column-container">','<div class="fixed-header-card-board-header-container">','<table class="theHeader"><thead><tr>',this._getRowHtml("th",this.cmp.columnDefinitions.length+1),"</tr></thead></table>","</div>",'<div class="fixed-header-card-board-body-container">','<table><tbody class="columns">',"</tbody></table>","</div>","</div>"].join("")},_getRowHtml:function(tag,numItems){return _.times(numItems,function(){return Ext.DomHelper.createHtml({tag:tag,cls:"card-column"})},this).join("")},getScrollElement:function(){return this.cmp.getEl().down(".fixed-header-card-board-body-container")},_setColumnSizes:function(retry){this.cmp.rendered&&(this._adjustLastColumnForScrollBar(),this._setCardboardHeight(retry))},_setCardboardHeight:function(retry){var headerEl,currentParentPadding,newParentPadding,offset=2,cardboardEl=this.cmp.getEl(),panelEl=cardboardEl.up(".x-panel");panelEl&&(offset+=panelEl.getHeight()-panelEl.getHeight(!0));var isFullPageApp=!!cardboardEl.up(".full-page-panel");if(isFullPageApp){var portletDom=cardboardEl.up(".portlet");portletDom&&(offset+=Ext.fly(portletDom).getPadding("b")),offset+=cardboardEl.getY()+this._getFooterHeight(),cardboardEl.setHeight(Math.max(Rally.util.Window.getHeight()-offset,400))}else{var outerContainerEl=cardboardEl.up(".rui-gridboard")||cardboardEl.parent();offset+=this._getSiblingHeights(),cardboardEl.setHeight(outerContainerEl.getHeight()-offset)}headerEl=Ext.get(cardboardEl.query(".fixed-header-card-board-header-container")[0]),currentParentPadding=headerEl.parent().getPadding("b"),newParentPadding=headerEl.getHeight(),headerEl.parent().applyStyles({"padding-bottom":newParentPadding+"px"}),retry!==!0&&0!==currentParentPadding&&currentParentPadding!==newParentPadding&&this._setColumnSizes(!0)},_adjustLastColumnForScrollBar:function(){Ext.fly(_.last(this.cmp._getHeaderCells())).setWidth(this._hasVerticalScrollBar()?Ext.getScrollbarSize().width:0)},_getFooterHeight:function(){return(Ext.fly("footer")?Ext.fly("footer").getHeight():0)+(Ext.fly("devFooter")?Ext.fly("devFooter").getHeight():0)},_hasVerticalScrollBar:function(){var el=this.getScrollElement();return el.dom.scrollHeight>el.dom.clientHeight||"scroll"===el.getStyle("overflowY")},destroy:function(){this.callParent(arguments),Ext.EventManager.removeResizeListener(this._setColumnSizes,this),this.cmp.un("columnready",this._setColumnSizes,this)},_getSiblingHeights:function(){var container=this.cmp.up();if(container){var siblingHeights=_.reduce(container.items.items,function(sum,item){return sum+item.getHeight()},0);return siblingHeights-this.cmp.getHeight()}return 0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.cardboard.plugin.Scrollable",{alias:"plugin.rallyscrollablecardboard",extend:Ext.AbstractPlugin,backwardsButtonConfig:{elTooltip:"Previous Column"},containerEl:void 0,getFirstVisibleScrollableColumn:function(){return this.cmp.getVisibleColumns()[0]},getLastVisibleScrollableColumn:function(){return _.last(this.cmp.getVisibleColumns())},getScrollableColumns:function(){return this.cmp.getColumns()},forwardsButtonConfig:{elTooltip:"Next Column"},init:function(cardboard){cardboard.on("aftercolumnrender",this._onAfterColumnRender,this),cardboard.addEvents("columnscroll")},_onAfterColumnRender:function(){if(0!==this.getScrollableColumns().length){for(Ext.EventManager.onWindowResize(this._sizeButtonsToColumnHeaders,this);this.containerEl&&this.cmp.getWidth()>this.containerEl.getWidth()&&this.cmp.getVisibleColumns().length>1;)this.cmp.hideColumn(this.getLastVisibleScrollableColumn());if(Ext.isIE8){var table=this.cmp.getColumnContainer().dom;table.style.display="inline-table",window.setTimeout(function(){table.style.display=""},0)}this._addScrollButtons()}},destroy:function(){Ext.EventManager.removeResizeListener(this._sizeButtonsToColumnHeaders,this),this.cmp.backwardsButton&&this.cmp.backwardsButton.destroy(),this.cmp.forwardsButton&&this.cmp.forwardsButton.destroy(),this.callParent(arguments)},_addScrollButtons:function(){this.cmp.backwardsButton=Ext.create("Rally.ui.Button",Ext.merge({border:1,cls:"scroll-button scroll-backwards",frame:!1,handler:function(){this._scroll(!1)},hidden:this._isBackwardsButtonHidden(),renderTo:this.getFirstVisibleScrollableColumn().getHeaderTitle().getEl(),scope:this,userAction:"cardboard scrolled backwards"},this.backwardsButtonConfig)),this.cmp.forwardsButton=Ext.create("Rally.ui.Button",Ext.merge({border:1,cls:"scroll-button scroll-forwards",frame:!1,handler:function(){this._scroll(!0)},hidden:this._isForwardsButtonHidden(),renderTo:this.getLastVisibleScrollableColumn().getHeaderTitle().getEl(),scope:this,userAction:"cardboard scrolled forwards"},this.forwardsButtonConfig)),this._sizeButtonsToColumnHeaders()},_isBackwardsButtonHidden:function(){return this.getScrollableColumns()[0]===this.getFirstVisibleScrollableColumn()},_isForwardsButtonHidden:function(){return _.last(this.getScrollableColumns())===this.getLastVisibleScrollableColumn()},_scroll:function(forwards){var newlyVisibleColumn=this.getScrollableColumns()[Ext.Array.indexOf(this.getScrollableColumns(),this._getInsertNextToColumn(forwards))+(forwards?1:-1)];this.cmp.hideColumn(this._getColumnToRemove(forwards)),this.cmp.showColumn(newlyVisibleColumn),this.cmp.fireEvent("columnscroll",this.cmp),this._afterScroll()},_getInsertNextToColumn:function(scrollingForwards){return scrollingForwards?this.getLastVisibleScrollableColumn():this.getFirstVisibleScrollableColumn()},_getColumnToRemove:function(scrollingForwards){return scrollingForwards?this.getFirstVisibleScrollableColumn():this.getLastVisibleScrollableColumn()},_afterScroll:function(){this.cmp.backwardsButton.destroy(),this.cmp.forwardsButton.destroy(),this._addScrollButtons()},_sizeButtonToColumnHeader:function(button,column){button.getEl().setHeight(column.getHeaderTitle().getHeight(!0))},_sizeButtonsToColumnHeaders:function(){this._sizeButtonToColumnHeader(this.cmp.backwardsButton,this.getFirstVisibleScrollableColumn()),this._sizeButtonToColumnHeader(this.cmp.forwardsButton,this.getLastVisibleScrollableColumn())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.carousel.CarouselPane",{extend:Ext.container.Container,alias:"widget.rallycarouselpane",layout:{type:"hbox",align:"stretch"},defaults:{flex:1},cls:"rally-carousel-pane",currentItem:0,enableAnimations:!0,constructor:function(config){this.mergeConfig(config),this.callParent([config])},initComponent:function(){this.addEvents("carouselchange"),this.callParent(arguments)},showNextItem:function(){var nextItem=this._getNextItem();this.showItem(this.getCurrentItem(),nextItem,"l")},showPreviousItem:function(){var previousItem=this._getPreviousItem();this.showItem(this.getCurrentItem(),previousItem,"r")},showItem:function(currentItem,nextItem,direction){if(nextItem){var currentItemWidth=currentItem.el.getWidth(),currentItemNewLeft="l"===direction?currentItemWidth*-1:currentItemWidth;if(this.enableAnimations){nextItem.removeCls("carousel-pane-animate"),nextItem.setLocalX(-1*currentItemNewLeft);var me=this;setTimeout(function(){currentItem.addCls("carousel-pane-animate"),nextItem.addCls("carousel-pane-animate"),currentItem.setLocalX(currentItemNewLeft),nextItem.setLocalX(0),me.fireEvent("animationset",me,nextItem)},15)}else currentItem.setLocalX(currentItemNewLeft),nextItem.setLocalX(0)}else _.each(this.getItems(),function(item){item.setLocalX(currentItem.el.getWidth())},this),currentItem.setLocalX(0),nextItem=currentItem;this._setCurrentItem(nextItem),this.fireEvent("carouselchange",this,nextItem)},getItems:function(){return this.items.items},_getNextItem:function(){var currentIndex=this.getCurrentItemIndex(),totalItems=this.getItems().length;return currentIndex+1>=totalItems?this._getItem(0):this._getItem(currentIndex+1)},_getPreviousItem:function(){var currentIndex=this.getCurrentItemIndex(),totalItems=this.getItems().length;return 0===currentIndex?this._getItem(totalItems-1):this._getItem(currentIndex-1)},_getItem:function(index){return this.getItems()[index]},_numberOfItems:function(){return this.getItems().length},_setCurrentItem:function(item){this.currentItem=item},getCurrentItem:function(){return this.currentItem||this._getFirstItem()},_getFirstItem:function(){return this._getItem(0)},getCurrentItemIndex:function(){var currentItemIndex=this.items.indexOf(this.currentItem);return currentItemIndex>=0?currentItemIndex:0},onRender:function(){this._setCurrentItem(this._getFirstItem());var ownerContainer=this.ownerCt;ownerContainer&&(this.relayEvents(ownerContainer,["resize"],"owner"),this.on({ownerresize:this._syncSizeToOwnerContainer})),this.callParent(arguments)},_syncSizeToOwnerContainer:function(){var ownerContainer=this.ownerCt;if(ownerContainer){var width=ownerContainer.el.getWidth()*this._numberOfItems(),height=ownerContainer.el.getHeight();this.setSize(width,height)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.carousel.Carousel",{extend:Ext.container.Container,alias:"widget.rallycarousel",cls:"rly-carousel",itemId:"carousel",items:[{xtype:"container",itemId:"carousel-header",cls:"carousel-header"},{xtype:"container",itemId:"carousel-panel",cls:"carousel-panel",layout:{type:"hbox",align:"middle",pack:"center"},items:[{xtype:"rallybutton",itemId:"carousel-scroll-backwards-button",cls:"",componentCls:"scroll-button",iconCls:"icon-chevron-left",width:50},{xtype:"container",itemId:"carousel-container",overflowX:"hidden",height:"100%",items:[{xtype:"rallycarouselpane",itemId:"carousel-pane"}]},{xtype:"rallybutton",itemId:"carousel-scroll-forwards-button",cls:"",componentCls:"scroll-button",iconCls:"icon-chevron-right",width:50}]},{xtype:"container",itemId:"carousel-controls",cls:"carousel-controls"},{xtype:"container",itemId:"carousel-footer",cls:"carousel-footer"}],config:{showHeader:!1,headerConfig:{title:"Title For Header Section",text:"Here is some text for the header"},carouselItems:[],showDots:!0,enableAnimations:!0,smallDots:!1,infiniteScroll:!0},constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this._createHeader(),this._createCarouselPanel(),this._createControls(),this.addEvents("carouselmove","currentitemset")},_createHeader:function(){this.header=this.down("#carousel-header"),this.showHeader?(this.header.add({xtype:"component",itemId:"header-title",cls:"title",html:'<span class="title-text">'+this.headerConfig.title+"</span>"}),this.header.add({xtype:"component",itemId:"header-text",cls:"text",html:this.headerConfig.text})):(this.header.destroy(),delete this.header)},_createCarouselPanel:function(){this._createScrollButtons(),this._setCarouselContainerWidth(),this._createCarouselPane(),this.carouselPane.enableAnimations=this.enableAnimations},_createScrollButtons:function(){this.scrollBackButton=this.down("#carousel-scroll-backwards-button"),this.scrollForwardButton=this.down("#carousel-scroll-forwards-button"),this.scrollBackButton.setHandler(this.scrollBack,this),this.infiniteScroll||this.scrollBackButton.addCls("hide-scroll-button"),this.scrollForwardButton.setHandler(this.scrollForward,this)},_setCarouselContainerWidth:function(){var carouselContainer=this.down("#carousel-container");carouselContainer.setWidth(this.width-this.scrollBackButton.width-this.scrollForwardButton.width)},_createCarouselPane:function(){this.carouselPane=this.down("#carousel-pane"),this.carouselPane.add(this.carouselItems)},_createControls:function(){this.controls=this.down("#carousel-controls"),this._createDots()},_createDots:function(){this.showDots!==!1&&(this.currentDotIndex=this.carouselPane.getCurrentItemIndex(),this.dots=_.map(this.carouselPane.getItems(),function(item,itemIndex){return{xtype:"rallybutton",iconCls:"icon-circle",itemId:"carousel-dot-"+itemIndex,componentCls:"carousel-dot",cls:(this.smallDots?"carousel-dot-small":"")+(this.currentDotIndex===itemIndex?" rly-active":""),handler:Ext.bind(function(){var direction=this.carouselPane.getCurrentItemIndex()>itemIndex?"r":"l";this.carouselPane.showItem(this.carouselPane.getCurrentItem(),item,direction),this._updateDots(),this._updateScrollButtons(),this.fireEvent("carouselmove",this)},this)}},this),this.controls.add(this.dots))},scrollBack:function(){this.carouselPane.showPreviousItem(),this._updateDots(),this._updateScrollButtons(),this.fireEvent("carouselmove",this)},scrollForward:function(){this.carouselPane.showNextItem(),this._updateDots(),this._updateScrollButtons(),this.fireEvent("carouselmove",this)},setCurrentItem:function(itemIndex){var item=this.getCarouselItems()[itemIndex];item&&(this.carouselPane.showItem(item),this._updateDots()),this.fireEvent("currentitemset",this)},getCurrentItem:function(){return this.carouselPane.getCurrentItem()},getCurrentItemIndex:function(){return this.carouselPane.getCurrentItemIndex()},getCarouselItems:function(){return this.carouselPane.getItems()},_updateDots:function(){this.showDots!==!1&&(this._getCurrentDot().removeCls("rly-active"),this.currentDotIndex=this.carouselPane.getCurrentItemIndex(),this._getCurrentDot().addCls("rly-active"))},_updateScrollButtons:function(){this.infiniteScroll||(this.scrollBackButton.removeCls("hide-scroll-button"),this.scrollForwardButton.removeCls("hide-scroll-button"),0===this.getCurrentItemIndex()?this.scrollBackButton.addCls("hide-scroll-button"):this.getCurrentItemIndex()===this.getCarouselItems().length-1&&this.scrollForwardButton.addCls("hide-scroll-button"))},_getCurrentDot:function(){return this.down("#carousel-dot-"+this.currentDotIndex)},afterRender:function(){this.callParent(arguments),this._setCarouselPanelSize(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_setCarouselPanelSize:function(){var items=this.getCarouselItems(),width=this.width;width||(width=_.max(_.invoke(items,"getWidth"))+this.scrollForwardButton.getWidth()+this.scrollBackButton.getWidth(),this.setWidth(width),this._setCarouselContainerWidth());var height=_.max(_.invoke(items,"getHeight"));if(this.height){var maxHeight=this.height-this._getActualComponentHeight(this.header)-this._getActualComponentHeight(this.controls);height=maxHeight>height?maxHeight:height}this.down("#carousel-panel").setSize(width,height)},_getActualComponentHeight:function(cmp){return cmp?cmp.getHeight()+cmp.getEl().getMargin("tb"):0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.chart.Chart",{extend:Ext.Container,alias:"widget.rallychart",mixins:[Rally.app.Scopeable],items:[{xtype:"container",itemId:"header",cls:"header"},{xtype:"container",itemId:"chart",cls:"chart",layout:"fit",flex:1}],layout:{type:"vbox",align:"stretch"},clientMetrics:[{beginEvent:"storesConfigured",endEvent:"storesLoaded",description:"rallychart - lookback query time"},{beginEvent:"storesValidated",endEvent:"snapshotsAggregated",description:"rallychart - lookback data aggregated by calculator"},{beginEvent:"readyToRender",endEvent:"chartRendered",description:"rallychart - highcharts rendered"}],config:{updateBeforeRender:void 0,updateAfterRender:void 0,storeConfig:void 0,storeType:"Rally.data.lookback.SnapshotStore",calculatorType:void 0,calculatorConfig:void 0,chartColors:["#E57E3A","#E5D038","#B2E3B6","#3A874F"],chartConfig:void 0,chartData:void 0,queryErrorMessage:"No data was found based on the current chart settings.",aggregationErrorMessage:"No data was returned by the calculator aggregation provided.",authorizationErrorMessage:"Your request requires access to a workspace or project for which you do not have permission. Contact your subscription administrator to request permission.",haltedWorkspaceErrorMessage:"You caught us working! The chart for this workspace is temporarily unavailable. Please check back shortly.",serviceUnavailableErrorMessage:"The Lookback API service is temporarily unavailable. Please check back shortly.",loadMask:!0},beforeDestroy:function(){this._cleanupChartPointer(),this.callParent(arguments)},refresh:function(newConfig){this._cleanupChartPointer(),this.down("#chart").removeAll(!0),delete this.chartData,1===this.storeConfig.length&&(this.storeConfig=this.storeConfig[0]),Ext.merge(this,newConfig),this._loadChart()},initComponent:function(){this.addEvents("storesConfigured","storesLoaded","storesValidated","snapshotsAggregated","readyToRender","chartRendered"),this.callParent(arguments),this._loadExternalDependencies()},getChartWrapper:function(){return this.down("highchart")},getChart:function(){return this.getChartWrapper()&&this.getChartWrapper().chart},_loadExternalDependencies:function(){Rally.dependencies.Analytics.load(function(){Ext.Function.defer(this._loadChart,1,this)},this)},_loadChart:function(){if(this._validateConfiguration()){this.loadMask&&this.getEl().mask("Loading..."),this.chartColors=Ext.Array.clone(this.chartColors);var chartConfig=this.getChartConfig()||{};this._setChartConfigDefaults(chartConfig),this._callUpdateBeforeRender(),this.fireEvent("storesConfigured",this),this.chartData?this._renderChart():(this._setUpCalculator(),this._loadStores())}},_setChartConfigDefaults:function(chartConfig){chartConfig.credits=chartConfig.credits||{},chartConfig.credits.enabled=!1,chartConfig.exporting||(chartConfig.exporting={enabled:!1}),chartConfig.colors=this.chartColors},_callUpdateBeforeRender:function(){"function"==typeof this.updateBeforeRender&&this.updateBeforeRender.apply(this)},_setUpCalculator:function(){this.calculator=Ext.create(this.getCalculatorType(),this.getCalculatorConfig())},_validateConfiguration:function(){var requiredConfigs=["storeConfig","storeType","calculatorType","calculatorConfig","chartConfig"];if(this.chartData)return!0;for(var i=0;i<requiredConfigs.length;i++){var configField=requiredConfigs[i];if(!this[configField])return this._setErrorMessage("Missing required configuration field: "+configField)}return!0},_loadStores:function(){this._wrapStores(),this.loadedStores=[],this.queryValid=!0,this.workspaceHalted=!1,this.serviceUnavailable=!1;for(var i=0;i<this.storeConfig.length;i++)this._loadStore(this.storeConfig[i],i)},_loadStore:function(storeConfig,storeRank){var self=this;Ext.merge(storeConfig,{exceptionHandler:function(proxy,response,operation){200!==response.status&&(self.queryValid=!1),409===response.status?self.workspaceHalted=!0:503===response.status&&(self.serviceUnavailable=!0)}}),storeConfig.limit=storeConfig.limit||1/0;var store=Ext.create(this.storeType,storeConfig);store.rank=storeRank,store.on("load",this._storeLoadHandler,this),store.load()},_storeLoadHandler:function(store){this.loadedStores.push(store),this.loadedStores.length===this.storeConfig.length&&this._onStoresLoaded()},_setErrorMessage:function(message){return this.down("#chart").add({xtype:"displayfield",itemId:"error",value:message}),this._setChartReady(),!1},_setChartReady:function(){this.componentReady=!0,this._callUpdateAfterRender()},_callUpdateAfterRender:function(){"function"==typeof this.updateAfterRender&&this.updateAfterRender.apply(this)},_onStoresLoaded:function(){return this._unmask(),this.fireEvent("storesLoaded",this),this.serviceUnavailable?this._setErrorMessage(this.serviceUnavailableErrorMessage):this.workspaceHalted?this._setErrorMessage(this.haltedWorkspaceErrorMessage):this.queryValid?this._noDataLoaded()?this._setErrorMessage(this.queryErrorMessage):(Ext.Array.sort(this.loadedStores,function(left,right){return left.rank-right.rank}),this._unWrapStores(),this.fireEvent("storesValidated",this),this.chartData=this.calculator.prepareChartData(this.loadedStores),this.fireEvent("snapshotsAggregated",this),this.fireEvent("readyToRender",this),this._validateAggregation(),void this.fireEvent("chartRendered",this)):this._setErrorMessage(this.authorizationErrorMessage)},_wrapStores:function(){Ext.isArray(this.storeConfig)||(this.storeConfig=[this.storeConfig])},_unWrapStores:function(){1===this.loadedStores.length&&(this.loadedStores=this.loadedStores[0])},_noDataLoaded:function(){for(var i=0;i<this.loadedStores.length;i++){var store=this.loadedStores[i];if(store.getCount()>0)return!1}return!0},_unmask:function(){this.loadMask&&this.getEl()&&this.getEl().unmask()},_validateAggregation:function(){return this._haveDataToRender()?void this._renderChart():this._setErrorMessage(this.aggregationErrorMessage)},_isData:function(point){return point>0},_haveDataToRender:function(){for(var seriesData=this.chartData.series,i=0,ilength=seriesData.length;i<ilength;i++)for(var data=seriesData[i].data,j=0,jlength=data.length;j<jlength;j++){if(this._isData(data[j]))return!0;if(Ext.isArray(data[j])&&_.some(data[j],this._isData))return!0}},_renderChart:function(){this._unmask();var chartConfig=this.getChartConfig(),chartEl=this.down("#chart");if(chartEl){chartConfig.xAxis=chartConfig.xAxis||{},chartConfig.xAxis.categories=this.chartData.categories;var me=this,highChartConfig={xtype:"highchart",chartConfig:chartConfig,series:this.chartData.series,initAnimAfterLoad:!1,afterChartRendered:function(chart){try{chart.chartHeight>me.getHeight()&&me.setHeight(chart.chartHeight)}catch(e){}}};chartEl.add(highChartConfig),this._setChartReady()}},_cleanupChartPointer:function(){var chart=this.getChart();chart&&chart.pointer&&chart.pointer.reset()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.FieldComboBox",{requires:[],extend:Rally.ui.combobox.ComboBox,alias:"widget.rallyfieldcombobox",config:{model:void 0,context:void 0,queryMode:"local",editable:!1,valueField:"value",displayField:"name",lastQuery:""},constructor:function(config){return this.mergeConfig(config),this.store=Ext.create("Ext.data.Store",{fields:[this.valueField,this.displayField,"fieldDefinition"],data:[]}),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.on("afterrender",this._onAfterRender,this),this.model&&(Ext.isString(this.model)?this._fetchModel():this._populateStore())},findRecordByValue:function(value){var record=this.findRecord(this.valueField,value);return record||0===(value||"").indexOf("c_")||(record=this.findRecord(this.valueField,"c_"+value)),record},_fetchModel:function(){Rally.data.ModelFactory.getModel({context:this.context,type:this.model,success:this._onModelRetrieved,scope:this})},_onModelRetrieved:function(model){this.model=model,this._populateStore()},_populateStore:function(){if(this.store){var data=_.sortBy(_.map(_.filter(this.model.getFields(),this._isNotHidden),this._convertFieldToLabelValuePair,this),"name");this.store.loadRawData(data),this._onStoreLoad(),this.setDefaultValue(),this.onReady()}},_isNotHidden:function(field){return!field.hidden},_convertFieldToLabelValuePair:function(field){var pair={fieldDefinition:field};return pair[this.valueField]=field.name,pair[this.displayField]=field.displayName,pair},_onAfterRender:function(){this._afterRender=!0,this._storeLoaded&&this.fireEvent("ready",this)},onReady:function(){this._storeLoaded=!0,this._afterRender&&this.fireEvent("ready",this)},refreshWithNewModelType:function(type){this.model=type,this._fetchModel()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.plugin.PreferenceEnabledComboBox",{alias:"plugin.rallypreferenceenabledcombobox",extend:Ext.AbstractPlugin,init:function(cmp){this.callParent(arguments),this.cmpOnReady=cmp.onReady,cmp.onReady=Ext.bind(this._onReady,this),this.cmp.store&&this.cmp.store.getCount()&&this._onReady(),this._loadPreference()},_onReady:function(){return this.preferencesLoaded?(this.prefValue&&this._isPrefValueInStore(this.prefValue)&&this.cmp.setValue(this.prefValue),this.cmp.fireEvent("select",this.cmp,this._getSelectedRecords()),this.cmp.on("select",this._onValueSelect,this),void this.cmpOnReady.call(this.cmp)):void(this.storeLoaded=!0)},_getSelectedRecords:function(){return this.cmp.multiSelect?_.map(this.cmp.getValue(),function(value){return this.cmp.findRecordByValue(value)},this):_.compact([this.cmp.getRecord()])},_onValueSelect:function(){this._savePreference()},_loadPreference:function(){Rally.data.PreferenceManager.load(Ext.apply(this._getPreferenceConfig(),{success:function(prefs){var pref=prefs[this._getPreferenceName()];this.prefValue=this.cmp.multiSelect?Ext.JSON.decode(pref):pref,this.preferencesLoaded=!0,this.storeLoaded&&this._onReady()},scope:this}))},_savePreference:function(){var settings={},value=this.cmp.getValue();settings[this._getPreferenceName()]=this.cmp.multiSelect?Ext.JSON.encode(value):value,Rally.data.PreferenceManager.update(Ext.apply(this._getPreferenceConfig(),{settings:settings}))},_getAppId:function(){return this.cmp.context.get&&this.cmp.context.get("appID")},_getPreferenceConfig:function(){var config={filterByUser:!0,filterByName:this._getPreferenceName()},appId=this._getAppId();return appId?config.appID=appId:config.workspace=this.cmp.context.getWorkspaceRef(),config},_getPreferenceName:function(){return this.preferenceName+(this._getAppId()?"-"+this.cmp.context.getWorkspace().ObjectID:"")},_isPrefValueInStore:function(pref){return _.any(_.isArray(pref)?pref:[pref],function(value){return this.cmp.store.findRecord(this.cmp.valueField,value)},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.PortfolioItemTypeComboBox",{alias:"widget.rallyportfolioitemtypecombobox",extend:Rally.ui.combobox.ComboBox,plugins:[{ptype:"rallypreferenceenabledcombobox",preferenceName:"piTypeCombo"}],constructor:function(config){var defaultConfig={defaultSelectionPosition:"last",cls:Rally.util.Test.toBrowserTestCssClass("portfolio-item-type-combo")+" portfolio-item-type-combo",editable:!1,fieldLabel:"Type:",labelWidth:30,context:Rally.environment.getContext(),storeConfig:{autoLoad:!0,remoteFilter:!0,model:Ext.identityFn("TypeDefinition"),sorters:{property:"Ordinal",direction:"Desc"},filters:[{property:"Parent.Name",operator:"=",value:"Portfolio Item"},{property:"Creatable",operator:"=",value:"true"}]}};config.storeConfig&&(delete config.storeConfig.autoLoad,config.storeConfig.additionalFilters&&(defaultConfig.storeConfig.filters=defaultConfig.storeConfig.filters.concat(config.storeConfig.additionalFilters))),this.callParent([Ext.Object.merge(defaultConfig,config)])},getSelectedType:function(){return this.getTypeFromRef(this.getValue())},getTypeFromRef:function(typeRef){return this.getStore().findRecord("_ref",typeRef)},getTypeWithOrdinal:function(ordinal){return this.getStore().findRecord("Ordinal",ordinal)},getAllTypeNames:function(){return _.map(this.getStore().getRecords(),function(type){return type.get("TypePath")})},getCurrentView:function(){return{piTypePicker:this.getRecord().get("_refObjectUUID")}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.combobox.plugin.LastSelectedCache",{extend:Ext.AbstractPlugin,alias:"plugin.rallytimeboxlastselectedcache",context:null,namespace:"",init:function(cmp){this.callParent(arguments),this.cmp.addEvents(["valueready"]),this.cmp.on("ready",this._updateCache,this),this.cmp.on("change",this._updateCache,this),this._checkCache()},_updateCache:function(){this.cmp.getRecord()&&this._getStorageProvider().set(this.cmp.getRecord().getData())},_getStorageProvider:function(){return this.storageProvider||(this.storageProvider=Ext.create("Rally.state.UserScopedCacheProvider",{context:this.context,namespace:this.namespace})),this.storageProvider},_checkCache:function(){var data=this._getStorageProvider().get(),type=Rally.util.Ref.getTypeFromRef(data);if(!Ext.isEmpty(type)){var modelParams={type:type,context:this.context,scope:this,success:function(model){this._onModelLoad(model,data)}};Rally.data.ModelFactory.getModel(modelParams)}},_onModelLoad:function(model,data){var record=Ext.create(model,data);this.cmp.fireEvent("valueready",this.cmp,record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.datetime.TimeFrame",{extend:Ext.form.FieldContainer,alias:"widget.rallytimeframe",requires:[],mixins:[Ext.form.field.Field],cls:"time-frame-field",timeFrameLabel:"Last",timeFrameLabelWidth:30,timeFrameLabelSeparator:"",minValue:1,maxValue:999,quantityComponent:null,unitsComponent:null,value:{timeFrameQuantity:1,timeFrameUnit:"day"},storeConfig:[["day","Days"],["week","Weeks"],["month","Months"]],initComponent:function(){this.layout={type:"hbox"},this.items=[{xtype:"rallynumberfield",name:"timeFrameQuantity",allowDecimals:!1,labelWidth:this.timeFrameLabelWidth,fieldLabel:this.timeFrameLabel,labelSeparator:this.timeFrameLabelSeparator,minValue:this.minValue,minText:"The minimum value allowed is {0}",maxValue:this.maxValue,maxText:"The maximum value allowed is {0}",allowBlank:!1,blankText:"Please enter a valid value"},{xtype:"rallycombobox",name:"timeFrameUnit",store:this.storeConfig,style:{"margin-left":"7px"},editable:!1,allowBlank:!1,blankText:"Please select a valid unit"}],this.callParent(arguments),this.quantityComponent=this.down("numberfield"),this.unitsComponent=this.down("combobox"),this.initField()},setValue:function(value){return this.value=value,this.quantityComponent.setValue(value.timeFrameQuantity),this.unitsComponent.setValue(value.timeFrameUnit),this},getValue:function(){return this.value={timeFrameQuantity:this.quantityComponent.getValue(),timeFrameUnit:this.unitsComponent.getValue()},this.value},
validate:function(){return this.quantityComponent.validate()&&this.unitsComponent.validate()},getErrors:function(){var errors=[];return Ext.Array.push(errors,this.quantityComponent.getErrors(),this.unitsComponent.getErrors()),errors}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.description.DescriptionRichTextView",{extend:Ext.view.View,alias:"widget.rallydescriptionrichtextview",cls:"description-richtext-view",itemSelector:"div.description",loadMask:!1,detailsField:"Description",detailsFieldBackup:"Notes",initComponent:function(){this._setDetailsField(),this._createTpl(),this.store||(this.store=this._createStore()),this.callParent(arguments)},_createStore:function(){return Ext.create("Rally.data.wsapi.Store",Ext.apply({fetch:["Name","FormattedID","TargetProject",this.detailsField],limit:1,pageSize:1,autoLoad:!0,requester:this},this.storeConfig))},prepareData:function(data){return data.FormattedID=Ext.create("Rally.ui.renderer.template.FormattedIDTemplate").apply(_.merge({context:this.context},data)),data},_setDetailsField:function(){var model=this.storeConfig&&this.storeConfig.model||this.store&&this.store.model;model&&!model.getField(this.detailsField)&&model.getField(this.detailsFieldBackup)&&(this.detailsField=this.detailsFieldBackup)},_createTpl:function(){this.tpl=new Ext.XTemplate("<tpl>",'<div class="header">',"<b>{[values[0].FormattedID]}:</b> {[values[0].Name]}","</div>",'<tpl if="this.hasDetails(values)">','<div class="description">{[this.getDetails(values)]}</div>',"</tpl>","</tpl>"),this.tpl.self.addMembers({hasDetails:Ext.bind(function(data){return data&&data[0]&&!_.isEmpty(data[0][this.detailsField])},this),getDetails:Ext.bind(function(data){return data[0][this.detailsField]},this)})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.CommentEditor",{extend:Ext.panel.Panel,alias:"widget.rallydetailcommenteditor",border:!1,closable:!1,config:{record:void 0},dockedItems:[{xtype:"toolbar",dock:"bottom",layout:{type:"hbox",pack:"center"},ui:"footer",itemId:"footer"}],bubbleEvents:["failure"],constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.addEvents("save","failure","cancel"),this.callParent(arguments),this.drawFooter(),this._loadModel()},drawFooter:function(){this.down("#footer").add([{xtype:"rallybutton",text:"Save",cls:["commentActionButton","commentSave","primary","rly-small"],handler:this._save,scope:this},{xtype:"rallybutton",text:"Cancel",cls:["commentActionButton","commentCancel","secondary","rly-small"],handler:this._cancel,scope:this}])},_loadModel:function(){Rally.data.ModelFactory.getModel({type:"ConversationPost",success:function(model){this.commentModel=model,this._buildEditor()},scope:this})},_buildComment:function(){return Ext.create(this.commentModel,{Workspace:"/workspace/"+Rally.environment.getContext().getWorkspace().ObjectID,Artifact:this.getRecord().get("_ref")})},_buildEditor:function(){if(!this.rendered)return void this.on("afterrender",this._buildEditor,this);var newCommentRecord=this.newCommentRecord=this._buildComment();this.insert(0,{xtype:"rallydetailfieldcontaineredpcomplete",record:newCommentRecord,field:newCommentRecord.getField("Text"),editMode:!0})},_save:function(){this.newCommentRecord.set("Text",this.down(".rallyrichtexteditor").getValue()),this.newCommentRecord.save({callback:function(record,operation){operation.success?this.fireEvent("save",record):this.fireEvent("failure",record,operation.error.errors)},scope:this})},_cancel:function(){this.fireEvent("cancel")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.FastContainer",{extend:Ext.container.Container,alias:"widget.rallyuidetailfastcontainer",constructor:function(){this.callParent(arguments),this._fastComponents=[],this.on("destroy",this._destroyFastComponents,this)},fastAdd:function(config){var component=Ext.ComponentManager.create(config);return component.render(this.getEl()),this._fastComponents.push(component),component},fastRemoveAll:function(){this.getEl().update(""),this._destroyFastComponents()},_destroyFastComponents:function(){_.each(this._fastComponents,function(component){component.destroy()}),this._fastComponents=[]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.DetailList",{extend:Ext.container.Container,alias:"widget.rallydetaillist",componentCls:"detailList detailFieldContainer",config:{record:void 0,modelType:void 0,deletable:!1,headerHtml:void 0},items:[{xtype:"component",itemId:"detailListHeader",cls:"detailListHeader"},{xtype:"rallyuidetailfastcontainer",itemId:"detailListContainer"}],constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.addEvents({attachmentsUpdated:!0}),this.items[0].html=this.getHeaderHtml(),this.callParent(arguments),this.rendered?this._draw():this.on("afterrender",this._draw,this,{single:!0})},reload:function(){this._draw()},_draw:function(){this.store=Ext.create("Rally.data.wsapi.Store",{context:{project:null},model:this.modelType,filters:[{property:"Artifact",value:this.record.self.typePath+"/"+this.record.get("ObjectID")}]}),this.record.phantom?this._drawItems():this.store.load({callback:this._drawItems,scope:this})},_drawItems:function(){if(this.rendered){var listContainer=this.getComponent("detailListContainer");listContainer.fastRemoveAll(listContainer);var attachmentList=this.record.newAttachments?this.record.newAttachments:this.store.data.items;Ext.each(attachmentList,function(attachment){this._drawItem(attachment,listContainer)},this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)}},_drawItem:function(item,container){container.fastAdd(this._getItemConfig(item))},_getItemConfig:function(item){var config={xtype:"component",cls:"detailListItemContainer",renderTpl:this._getRenderTpl(item),renderData:this._getRenderData(item),renderSelectors:{},listeners:{}};return this.getDeletable()&&(config.renderSelectors.deleteDetailListItem=".deleteDetailListItem",config.listeners={afterrender:function(component){component.deleteDetailListItem.on("click",function(){this._deleteItem(item,component)},this)},scope:this}),config},_getRenderTpl:function(item){return""},_getRenderData:function(item){return{}},_deleteItem:function(item,component){var me=this;item.destroy({success:function(){me.fireEvent("attachmentsUpdated",me),component.destroy()}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.SavedIndicator",{extend:Ext.Component,alias:"widget.rallydetailsavedindicator",html:'<div class="fieldSaveIndicator">SAVED</div>',width:40,height:13,yOffset:15,config:{floating:!0,shadow:!1,target:void 0,duration:2e3},initComponent:function(){this.flash(),this.getTarget()&&this.mon(this.getTarget(),"destroy",function(){this.destroy()},this)},flash:function(){if(this.getTarget()&&this.getTarget().getEl()){var targetBox=this.getTarget().getBox(),right=targetBox.right-this.width,top=targetBox.top-this.height;this.getTarget().getEl().addCls("pre-save").addCls("is-saving"),this.showAt([right,top]),this.getEl().down("div").addCls("pre-save"),Ext.defer(function(){this._startFadeOut()},this.duration,this)}},_startFadeOut:function(){this.getEl()&&this.getTarget().getEl()&&(this.getEl().down("div").removeCls("pre-save"),this.getTarget().getEl().removeCls("is-saving"),Ext.defer(function(){this._finishFadeOut()},this.duration,this))},_finishFadeOut:function(){this.getEl()&&this.getTarget().getEl()&&this.getTarget().getEl().removeCls("pre-save"),this.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.FieldContainer",{extend:Ext.container.Container,alias:"widget.rallydetailfieldcontaineredpcomplete",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],cls:"detailFieldContainer editMode",config:{record:void 0,field:void 0,cancelOnEsc:!0,completeOnEnter:!0,showSavedIndicator:!0},clientMetrics:[{event:"fieldupdated",description:"field updated"}],fieldName:void 0,focused:!1,bubbleEvents:["fieldupdated","fieldchanged"],constructor:function(config){this.initConfig(config),this.callParent(arguments),this.fieldName=this.getField().name},initComponent:function(){this.addEvents("fieldupdated","fieldchanged"),this.callParent(arguments),this.addCls(this._getFieldDescriptorCls()),this._isFieldEditable()?this.addCls("editableField"):this.addCls("readonly"),this._isFieldRequired()&&this.addCls("requiredField"),this.draw(),this.addCls(this._getEditorTypeClass(this.editor)),this.on("afterrender",this._onAfterRender,this),this.on("fieldchanged",this._updateEmptyClass,this),this.editor&&this.editor.store&&this.editor.store.on("load",this._updateEmptyClass,this),this.on("bucketexpanded",this._resizeRichText,this),this.on("bucketexpanded",this._fireBucketExpanded,this),this.on("bucketcollapsed",this._fireBucketCollapsed,this)},_onAfterRender:function(){this.editor&&(this._wireEditorEvents(),this.editor.isDisabled()||this._updateEmptyClass())},draw:function(){this.beforeDraw(),this._drawField(),this.afterDraw()},beforeDraw:function(){},afterDraw:function(){},_drawField:function(){this._drawRequiredTriangle(),this._drawEditMode(),this.clearSelection()},focusField:function(){var input=this.getEl().down("input");input&&input.focus(),this.editor.focus(),this.markFocused()},markFocused:function(){this.focused=!0,this.editor.addCls("focused")},unfocusField:function(){var input=this.getEl().down("input");input&&input.blur(),this.unmarkFocused()},unmarkFocused:function(){this.editor.removeCls("focused"),this.focused=!1},_drawRequiredTriangle:function(){this._isFieldRequired()&&this.add({xtype:"component",cls:"requiredTriangle"})},_getFieldDescriptorCls:function(){return"detailField-"+this.getField().name.toLowerCase()},_drawEditMode:function(){this.editor=Rally.ui.detail.view.DetailEditorFactory.getEditor(this.getField(),this.getRecord(),{detailEditorMsgBus:this.detailEditorMsgBus}),this.add(this.editor)},_wireEditorEvents:function(){if(this.editor.on("blur",this._fireFieldChanged,this),this.editor.on("change",this._fireFieldChanged,this),this.editor.on("focus",this.markFocused,this),this.editor.on("blur",this.unmarkFocused,this),this.editor.getEl()){var input=this.editor.getEl().down("input");input&&(input.on("keyup",this._fireFieldChanged,this),(this.cancelOnEsc||this.completeOnEnter)&&input.on("keyup",function(event){event.getKey()===Ext.EventObject.ESC&&this.cancelOnEsc?this.refresh(this.record):event.getKey()===Ext.EventObject.ENTER&&this.completeOnEnter&&this._fireFieldUpdated()},this))}this.getRecord().phantom||(this.editor.on("select",this._fireFieldUpdated,this),this.editor.on("blur",this._fireFieldUpdated,this),"rallyreadybutton"===this.editor.getXType()&&this.editor.on("toggle",this._fireFieldUpdated,this),this.editor.on("collectionsaved",this.handleSuccessfulSave,this))},_fireFieldUpdated:function(){this._updateEmptyClass(),Rally.ui.detail.DetailHelper.updateRecord(this.getRecord(),this.editor),this.getRecord().isModified(this.fieldName)&&(this.fieldUpdatedEventAlreadyFired||this._shouldSuppressFieldUpdatedEvent()||(this.fieldUpdatedEventAlreadyFired=!0,this.fireEvent("fieldupdated",{field:this.editor,failure:function(){this.fieldUpdatedEventAlreadyFired=!1},scope:this})))},handleSuccessfulSave:function(record){var target=this.editor;this.refresh(record),this.editor&&_.isFunction(this.editor.getSavedIndicatorTarget)&&(target=this.editor.getSavedIndicatorTarget()),Ext.create("Rally.ui.detail.view.SavedIndicator",{target:target})},_fireFieldChanged:function(){this.fireEvent("fieldchanged",this)},_shouldSuppressFieldUpdatedEvent:function(){return this.editor&&this.editor.closureEditor&&this.editor.closureEditor.inModalMode()},onObjectUpdate:function(record){this.refresh(record)},refresh:function(record){this.fieldUpdatedEventAlreadyFired=!1,this.record=record},clearSelection:function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var sel=window.getSelection();sel.removeAllRanges()}},_isFieldEditable:function(){return Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(this.getField(),this.getRecord())},_isFieldRequired:function(){return Rally.ui.detail.DetailHelper.isDetailPageFieldRequired(this.getField(),this.getRecord())},_getEditorTypeClass:function(editor){var editorClass="";if(editor&&_.isFunction(editor.getXType)){var xtype=editor.getXType();xtype.indexOf("combobox")!==-1?editorClass="combobox":xtype.indexOf("numberfield")===-1&&xtype.indexOf("textfield")===-1&&xtype.indexOf("texteditor")===-1||(editorClass="textfield")}return editorClass},_storeIsLoaded:function(){return!(this.editor.store&&(this.editor.store.isLoading()||0===this.editor.store.getCount()))},_updateEmptyClass:function(){this.getEl()&&this._storeIsLoaded()&&(Rally.ui.detail.DetailHelper.isFieldEmpty(this.editor)?this.addClass("empty"):this.removeCls("empty"))},getActiveEditorInputId:function(){return this.editor.inputField.id},getActiveEditor:function(){return this.editor},_resizeRichText:function(){this.editor._growToFitContent&&this.editor._growToFitContent()},isDisabled:function(){return this.editor.isDisabled()},setDisabled:function(disabled){disabled?(this.addCls("readonly"),this.removeCls("editableField")):(this.removeCls("readonly"),this.addCls("editableField")),this.editor.setDisabled(disabled)},setValue:function(value){this.editor.setValue(value)},getValue:function(){return this.editor.getValue()},_fireBucketExpanded:function(){this.editor.fireEvent("bucketexpanded")},_fireBucketCollapsed:function(){this.editor.fireEvent("bucketcollapsed")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.FieldsetContainer",{extend:Rally.ui.detail.FieldContainer,alias:"widget.rallydetailfieldsetcontaineredpcomplete",labelCls:"fieldsetContainerLabel",config:{showLabel:!0},autoEl:"fieldset",constructor:function(config){this.initConfig(config),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.getShowLabel()&&this.addCls("hasLabel")},beforeDraw:function(){this.getShowLabel()&&this.add({xtype:"component",autoEl:"legend",cls:this.labelCls,html:this.displayName||this.getField().displayName})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.ResizableColumnTable",{extend:Ext.panel.Panel,alias:"widget.rallydetailresizablecolumntable",layout:{type:"table",columns:1},config:{showInColumns:!0,columnWidth:300},constructor:function(config){this.initConfig(config),this.callParent(arguments)},onBoxReady:function(width,height){this._layoutColumns(width),this.callParent(arguments)},onResize:function(width,height,oldWidth,oldHeight){this._layoutColumns(width),this.callParent(arguments)},_layoutColumns:function(width){if(this.getShowInColumns()){var cols=Math.floor(width/this.getColumnWidth())||1;this.layout.columns!==cols&&(this.layout.columns=cols,this.doComponentLayout())}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.FieldBucket",{extend:Ext.container.Container,alias:"widget.rallydetailfieldbucketedpcomplete",cls:"fieldBucket",layout:"anchor",defaults:{anchor:"0"},_isLayoutRoot:!0,expandIconCls:"icon-chevron-right",collapseIconCls:"icon-chevron-down",statics:{},config:{label:"",fields:void 0,filterFn:Ext.emptyFn,record:void 0,showInColumns:!0,growToFillSpace:!1,showFieldLabels:!0,excludedFields:[],collapse:!1,nextBucket:null},initComponent:function(){this.callParent(arguments),this.drawHeader(),this.drawFields(),this.shouldDisplay()&&this._markRequiredIfNecessary(),this.addEvents("bucketlayout"),this.enableBubble("bucketlayout"),this.on("afterlayout",function(){this.fireEvent("bucketlayout",this)},this)},drawHeader:function(){this.header=this.add({xtype:"component",renderTpl:'<div class="section-header"><div tabindex="0" class="control {collapsedCls}"></div><div class="head">{label}</div></div>',renderData:{label:this.getLabel(),collapsedCls:this.getCollapse()?this.expandIconCls:this.collapseIconCls},renderSelectors:{header:".section-header",control:".control"},listeners:{click:{element:"header",fn:this.toggleCollapse,stopEvent:!0},blur:{element:"control",fn:this._collapseBlurred},focus:{element:"control",fn:this._collapseFocused},keydown:{element:"control",fn:this._keyDownOnControl},scope:this}})},drawFields:function(){Ext.suspendLayouts(),this.getGrowToFillSpace()&&this.setShowInColumns(!1),this.detailFields=this.add({layout:"anchor",defaults:{anchor:"0"},xtype:"container",hidden:!0});var fields=this.getFilteredFields();if(0===fields.length)return void Ext.resumeLayouts(!0);var fieldGroups=this._groupFields(fields);Ext.each(fieldGroups,function(fieldGroup){var showInColumns=this.getShowInColumns();this._isFieldRichText(fieldGroup[0])&&(showInColumns=!1);var table=this._buildTableFrame(showInColumns);Ext.each(fieldGroup,function(field){table.add(this._getFieldComponent(field))},this),this.detailFields.add(table)},this),this.getCollapse()||this.detailFields.show(),Ext.resumeLayouts(!0)},_groupFields:function(fields){var fieldGroups=[[]];return Ext.each(fields,function(field,index){this._isFieldRichText(field)?(0!==fieldGroups[fieldGroups.length-1].length&&fieldGroups.push([]),fieldGroups[fieldGroups.length-1].push(field),index!==fields.length-1&&fieldGroups.push([])):fieldGroups[fieldGroups.length-1].push(field)},this),fieldGroups},_markRequiredIfNecessary:function(){this.getFields()&&this._shouldMarkRequired()&&this.addClass("requiredfieldbucket")},_shouldMarkRequired:function(){var record=this.getRecord();return this.getGrowToFillSpace()&&Rally.ui.detail.DetailHelper.isDetailPageFieldRequired(record.getField(this.getFields()[0]),record)},_isFieldRichText:function(field){return field.attributeDefinition&&"TEXT"===field.attributeDefinition.AttributeType},_buildTableFrame:function(showInColumns){var columnTable=Ext.create("Rally.ui.detail.ResizableColumnTable",{cls:"detailFields",showInColumns:showInColumns,layout:{type:"table",columns:1,tableAttrs:{style:showInColumns?{}:{width:"100%"}}},defaults:{width:showInColumns?280:void 0,cellCls:"detailField"}});return showInColumns||columnTable.addCls("notInColumn"),columnTable},getRecordFields:function(){return this.getFields()?this._getFieldsByConfig():this._getFieldsByFilterFn()},_getFieldsByConfig:function(){var record=this.getRecord(),filteredFields=[];return _.forEach(this.getFields(),function(fieldName){var field=record.getField(fieldName);field&&filteredFields.push(field)}),filteredFields},_getFieldsByFilterFn:function(){var allFields=this.getRecord().self.getFields(),filteredFields=_.filter(allFields,this.getFilterFn()),sortedFields=_.sortBy(filteredFields,this._sortFn);return sortedFields},_sortFn:function(field){var attrDef=field.attributeDefinition;return attrDef&&attrDef._refObjectName?attrDef._refObjectName:field.name},getFilteredFields:function(){var recordFields=this.getRecordFields(),excludedFields=this.getExcludedFields(),availableFields=_.filter(recordFields,function(field){return!_.contains(excludedFields,field.name)},this),nonPortfolioItemFields=_.filter(availableFields,function(field){var allowedValueType=field.attributeDefinition&&field.attributeDefinition.AllowedValueType;if(allowedValueType){var ref=allowedValueType._refObjectName;if("PortfolioItem"===ref.split("/")[0])return!1}return!0}),visibleFields=_.filter(nonPortfolioItemFields,function(field){return!field.hidden});return visibleFields},shouldDisplay:function(){return this.getFilteredFields().length>0||Ext.isDefined(this.config.xtype)},_getFieldComponent:function(field){return Ext.create("Rally.ui.detail.FieldsetContainer",{record:this.getRecord(),field:field,showLabel:this.getShowFieldLabels(),clickToEdit:!0,detailEditorMsgBus:this.detailEditorMsgBus})},getCollapseToggleButton:function(){return this.getEl().down(".control")},toggleCollapse:function(){this._changeToggleViewState(function(){this.getCollapse()?(this.detailFields.show(),this.down("rallydetailfieldcontaineredpcomplete").fireEvent("bucketexpanded")):(this.detailFields.hide(),this.down("rallydetailfieldcontaineredpcomplete").fireEvent("bucketcollapsed")),this.detailEditorMsgBus&&this.detailEditorMsgBus.fireEvent("detail-any-bucket-toggle"),this.setCollapse(!this.getCollapse()),this.getCollapseToggleButton().focus()},this)},_changeToggleViewState:function(callbackWhenViewChanged){this.getCollapse()?this.getCollapseToggleButton().removeCls(this.expandIconCls).addCls(this.collapseIconCls):this.getCollapseToggleButton().removeCls(this.collapseIconCls).addCls(this.expandIconCls),Ext.defer(callbackWhenViewChanged,1,this)},_keyDownOnControl:function(e){e.keyCode!==Ext.EventObject.ENTER&&e.keyCode!==Ext.EventObject.SPACE||(this.toggleCollapse(),e.preventDefault())},focusBucket:function(){this._focusCollapseLink()},_collapseFocused:function(){this.getCollapseToggleButton().addCls("focused")},_collapseBlurred:function(){this.getCollapseToggleButton().removeCls("focused")},_focusCollapseLink:function(){this.getCollapseToggleButton().focus()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.richtext.templates.RichTextEditorTemplatesPlugin",{alias:"plugin.rallyrichtexteditortemplates",extend:Ext.AbstractPlugin,inheritableStatics:{defaultTemplatePrefNamePrefix:"rich-text-templates-default-",templatePrefNamePrefix:"rich-text-templates-template-",getDefaultTemplatePrefName:function(field){return this.defaultTemplatePrefNamePrefix+field.modelType+"-"+field.name},getTemplatePrefName:function(templateId,templateInfoKey){return this.templatePrefNamePrefix+templateId+"-"+templateInfoKey}},init:function(cmp){this.callParent(arguments),this.cmpBuildToolbarButtons=cmp.buildToolbarButtons,cmp.buildToolbarButtons=Ext.bind(this._buildToolbarButtons,this),this.cmpCreateClosureEditor=cmp.createClosureEditor,cmp.createClosureEditor=Ext.bind(this._createClosureEditor,this),cmp.toolbarAlwaysEnabled||cmp.on("blur",this._enableTemplatesButton,this)},_buildToolbarButtons:function(){return this.templatesButton=goog.ui.editor.ToolbarFactory.makeButton("rich-text-editor-templates-button","Templates","Templates"),goog.events.listen(this.templatesButton,goog.ui.Component.EventType.ACTION,this._onTemplatesButtonClick,!1,this),this.cmpBuildToolbarButtons.call(this.cmp).concat([this.templatesButton])},_createClosureEditor:function(){return this.cmpCreateClosureEditor.call(this.cmp).then({scope:this,success:function(){if(this._enableTemplatesButton(),this.cmp.record&&this.cmp.record.phantom||this.cmp.field&&"Discussion"===this.cmp.field.name)return this._loadPrefs(this.self.getDefaultTemplatePrefName(this.cmp.field)).then({scope:this,success:function(defaultTemplateId){if(defaultTemplateId)return this._loadPrefs(this.self.getTemplatePrefName(defaultTemplateId,"value")).then({scope:this,success:function(defaultTemplateValue){this.cmp.closureEditor.setHtml(!1,defaultTemplateValue,!0)}})}})}}).then({scope:this,success:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)}})},_createOrUpdatePrefs:function(prefs){Rally.data.PreferenceManager.update({filterByUser:!0,settings:prefs})},_deletePref:function(name){Rally.data.PreferenceManager.remove({filterByName:name,filterByUser:!0})},_enableTemplatesButton:function(){this.cmp.enableToolbarButton(this.templatesButton)},_loadPrefs:function(nameOrFilters){var isLoadingSinglePref=Ext.isString(nameOrFilters),options={filterByUser:!0};return options[isLoadingSinglePref?"filterByName":"additionalFilters"]=nameOrFilters,Rally.data.PreferenceManager.load(options).then({success:function(prefs){return isLoadingSinglePref?prefs[nameOrFilters]:prefs}})},_onApplyTemplateRequest:function(dialog,value){this.cmp.closureEditor.setHtml(!1,value+"<br /><br />"+this.cmp.getValue()),this.cmp.focus()},_onCreateTemplateRequest:function(dialog,name){var templateId=(new Date).getTime(),prefs={};prefs[this.self.getTemplatePrefName(templateId,"name")]=name,prefs[this.self.getTemplatePrefName(templateId,"value")]=this.cmp.getValue(),this._createOrUpdatePrefs(prefs)},_onDefaultTemplateRequest:function(dialog,templateId){var prefs={};prefs[this.self.getDefaultTemplatePrefName(this.cmp.field)]=templateId,this._createOrUpdatePrefs(prefs)},_onDeleteDefaultTemplateRequest:function(){this._deletePref(this.self.getDefaultTemplatePrefName(this.cmp.field))},_onDeleteTemplateRequest:function(dialog,templateId){_.each(["name","value"],function(templateInfoKey){this._deletePref(this.self.getTemplatePrefName(templateId,templateInfoKey))},this),this._loadPrefs([{property:"Name",operator:"contains",value:this.self.defaultTemplatePrefNamePrefix},{property:"Value",operator:"contains",value:templateId}]).then({scope:this,success:function(prefs){_.forOwn(prefs,function(value,prefName){value===templateId&&this._deletePref(prefName)},this)}})},_onTemplatesButtonClick:function(){this._loadPrefs(Rally.data.wsapi.Filter.or([{property:"Name",operator:"contains",value:this.self.templatePrefNamePrefix}].concat(this.cmp.field?[{property:"Name",value:this.self.getDefaultTemplatePrefName(this.cmp.field)}]:[]))).then({scope:this,success:this._onTemplatePrefsLoaded})},_onTemplatePrefsLoaded:function(templatePrefs){var defaultTemplateId=this.cmp.field&&templatePrefs[this.self.getDefaultTemplatePrefName(this.cmp.field)],templates={};_.forOwn(templatePrefs,function(value,prefName){if(Rally.util.String.startsWith(prefName,this.self.templatePrefNamePrefix)){var templateSpecificInfo=prefName.replace(this.self.templatePrefNamePrefix,""),matches=/(.+?)-(.+)/.exec(templateSpecificInfo),templateId=matches[1],templateInfoKey=matches[2];templates[templateId]=templates[templateId]||{isDefault:templateId===defaultTemplateId,templateId:templateId},templates[templateId][templateInfoKey]=value}},this),Ext.create("Rally.ui.richtext.templates.RichTextEditorTemplatesDialog",{canSetDefaults:!!this.cmp.field,listeners:{applytemplaterequest:this._onApplyTemplateRequest,createtemplaterequest:this._onCreateTemplateRequest,defaulttemplaterequest:this._onDefaultTemplateRequest,deletedefaulttemplaterequest:this._onDeleteDefaultTemplateRequest,deletetemplaterequest:this._onDeleteTemplateRequest,scope:this},templates:_.sortBy(_.values(templates),"name")})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.richtext.RichTextEditor",{extend:Ext.Component,alias:"widget.rallyrichtexteditor",mixins:{field:Ext.form.field.Field},config:{name:"",allowLinking:!0,allowImageUpload:!1,growToFitContent:!1,showUndoButton:!1,disableUndoButtonWithToolbar:!0,toolbarAlwaysEnabled:!0,useLinkBubble:!1,controller:void 0},cls:"rallyRichTextEditor",border:1,renderTpl:'<div class="richTextToolbar"></div><div class="richTextContent"></div>',renderSelectors:{toolbarContainer:".richTextToolbar",contentContainer:".richTextContent"},EDITOR_MIN_HEIGHT:110,constructor:function(config){this.mergeConfig(config),this.config.plugins=this.config.plugins||[],this.config.plugins.push("rallyrichtexteditortemplates"),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addEvents("change","blur","load","imageuploaded"),this.getToolbarAlwaysEnabled()||(this.on("focus",this._enableToolbar,this),this.on("blur",this._disableToolbar,this)),this.mixins.field.initField.call(this),Rally.dependencies.GoogleClosure.load(this._onAfterLoadDependencies,this)},getUploadedImageOids:function(){return this._uploadedImageOids||[]},_onAfterLoadDependencies:function(){this.rendered?this._drawEditor():(this.on("afterrender",this._drawEditor,this),this.on("tappedescape",this._cancelChanges,this),this.on("change",this._onChange,this))},_onChange:function(){this._lastValue!==this.getValue()&&(this.getGrowToFitContent()&&this._growToFitContent(),this._lastValue=this.getValue())},_disableToolbar:function(){if(this._closureEditorToolbar){var undoButtonEnabled=this._undoButton&&this._undoButton.isEnabled();this._closureEditorToolbar.setEnabled(!1),undoButtonEnabled&&!this.getDisableUndoButtonWithToolbar()&&this.enableToolbarButton(this._undoButton)}},_enableToolbar:function(){this._closureEditorToolbar&&this._closureEditorToolbar.setEnabled(!0)},enableToolbarButton:function(button){var toolbarEnabled=this._closureEditorToolbar.enabled_;this._closureEditorToolbar.enabled_=!0,button.setEnabled(!0),this._closureEditorToolbar.enabled_=toolbarEnabled},_cancelChanges:function(){this.closureEditor.setHtml(!1,this.initialValue)},_drawEditor:function(){var editorLoadPromise=this.createClosureEditor();this._createResizer(),editorLoadPromise.always(function(){if(this.initialLoadFinished=!0,this._lastValue=this.getValue(),this.getGrowToFitContent()){var images=Ext.get(this.closureEditor.field).select("img");images.elements.length>0?Rally.util.Ui.executeCallbackWhenImagesLoaded(images,this._growToFitContent,this):this._growToFitContent()}this._ieClosureFocusWorkaround(),this.fireEvent("load",this)},this)},_ieClosureFocusWorkaround:function(){Ext.isIE&&this.closureEditor.getEditableIframe().contentDocument.addEventListener("click",Ext.bind(function(){this.fireEvent("focus")},this))},_createResizer:function(){this._resizer=Ext.create("Ext.resizer.Resizer",{el:this.getEl(),itemId:"resizer",pinned:!0,handles:"s",dynamic:!1,minHeight:this.EDITOR_MIN_HEIGHT}),this._resizer.on("resize",this._adjustHeight,this)},_growToFitContent:function(){this.resize(this._calculateIframeHeight())},_calculateIframeHeight:function(){var iframeHeight=this._getScrollHeight();iframeHeight<this.EDITOR_MIN_HEIGHT&&(iframeHeight=this.EDITOR_MIN_HEIGHT);var CONSTANTLY_RESIZING_SCROLLHEIGHT_FIX=10;return iframeHeight-CONSTANTLY_RESIZING_SCROLLHEIGHT_FIX},_getScrollHeight:function(){this.closureEditor.field.scrollHeight;return this.closureEditor.field.scrollHeight},createClosureEditor:function(){var deferred=new Deft.Deferred,closureEditor=this.closureEditor=new Rally.lib.closure.richtext.Field(this.contentContainer.dom.id);closureEditor.setHtml(!1,this.value,!0),closureEditor.cssStyles="body { margin: 4px; font: 12px arial, sans-serif; }",this._undoRedoPlugin=new goog.editor.plugins.UndoRedo;var plugins=this._closureEditorPlugins=[new goog.editor.plugins.BasicTextFormatter,new goog.editor.plugins.RemoveFormatting,this._undoRedoPlugin,new goog.editor.plugins.ListTabHandler,new goog.editor.plugins.EnterHandler,new goog.editor.plugins.HeaderFormatter];if(plugins.push(new Rally.lib.closure.richtext.RallyEscapeKeyPressedPlugin(this)),this.getAllowLinking()&&(plugins.push(new Rally.lib.closure.richtext.RallyLinkDialogPlugin),this.getUseLinkBubble())){var linkBubble=new Rally.lib.closure.richtext.RallyLinkBubblePlugin;linkBubble.setBubbleParent(this.getEl()),plugins.push(linkBubble)}if(this.getAllowImageUpload()){var imageDialogPlugin=new Rally.lib.closure.richtext.RallyImageDialogPlugin((void 0),(void 0),Ext.bind(this._onImageUploadSuccess,this),this.record);plugins.push(imageDialogPlugin),this.getController()&&this.getController().on("recordupdate",imageDialogPlugin.updateActionUrl,imageDialogPlugin)}Ext.each(plugins,function(plugin){closureEditor.registerPlugin(plugin)});var toolbar=this._closureEditorToolbar=goog.ui.editor.DefaultToolbar.makeToolbar(this.buildToolbarButtons(this.toolbarContainer.dom),this.toolbarContainer.dom);return this._closureEditorToolbarController=new goog.ui.editor.ToolbarController(closureEditor,toolbar),toolbar.setEnabled(this.getToolbarAlwaysEnabled()),goog.events.listen(closureEditor,goog.editor.Field.EventType.DELAYEDCHANGE,function(){closureEditor.isDisposed()||this.fireEvent("change",this,closureEditor.getCleanContents())},!1,this),goog.events.listen(closureEditor,goog.editor.Field.EventType.BLUR,function(){this.fireEvent("blur",this)},!1,this),goog.events.listen(closureEditor,goog.editor.Field.EventType.FOCUS,function(){this.fireEvent("focus",this)},!1,this),goog.events.listen(closureEditor,goog.editor.Field.EventType.LOAD,function(){this._closureEditorInitialLoadFinished=!0,this.initialValue=this.getValue(),deferred.resolve();
},!1,this),closureEditor.makeEditable(),deferred.promise},_onImageUploadSuccess:function(response){this._uploadedImageOids=this._uploadedImageOids||[],this._uploadedImageOids.push(response.oid),this.fireEvent("imageuploaded",response)},buildToolbarButtons:function(elem){var buttons=[goog.editor.Command.FONT_FACE,goog.editor.Command.FONT_SIZE,goog.editor.Command.BOLD,goog.editor.Command.ITALIC,goog.editor.Command.UNDERLINE,goog.editor.Command.FONT_COLOR,goog.editor.Command.BACKGROUND_COLOR,goog.editor.Command.ORDERED_LIST,goog.editor.Command.UNORDERED_LIST,goog.editor.Command.OUTDENT,goog.editor.Command.INDENT,goog.editor.Command.JUSTIFY_LEFT,goog.editor.Command.JUSTIFY_CENTER,goog.editor.Command.JUSTIFY_RIGHT,goog.editor.Command.REMOVE_FORMAT];return this.getAllowLinking()&&buttons.push(goog.ui.editor.ToolbarFactory.makeButton(goog.editor.Command.LINK,"Click to edit links","","tr-link tr-icon")),this.getAllowImageUpload()&&buttons.push(goog.ui.editor.ToolbarFactory.makeButton(goog.editor.Command.IMAGE,"Click to insert image","","tr-image tr-icon")),this.getShowUndoButton()&&(this._undoButton=goog.ui.editor.DefaultToolbar.undoRedoButtonFactory_(goog.editor.Command.UNDO,goog.ui.editor.DefaultToolbar.MSG_UNDO_TITLE,goog.ui.editor.DefaultToolbar.MSG_UNDO_TITLE,void 0,null,goog.dom.getDomHelper(elem)),this._undoButton.queryable=!0,this._undoButton.setEnabled(!1),buttons.push(this._undoButton)),buttons},resize:function(height){var toolbarHeight=this.toolbarContainer.getHeight(),SCROLLHEIGHT_FIX=25;Ext.suspendLayouts(),this._resizer.resizeTo(void 0,height+toolbarHeight+SCROLLHEIGHT_FIX),Ext.resumeLayouts(!1)},_adjustHeight:function(height){!this.getInitialConfig("width")&&this.getEl().getStyle("width",!0)&&this.getEl().setStyle("width",void 0),this.setHeight(height);var availableHeight=this.getHeight(),toolbarHeight=this.toolbarContainer.getHeight();this.getEl().down(".richTextContent").setHeight(availableHeight-toolbarHeight-15)},focus:function(){this._closureEditorInitialLoadFinished?(this.closureEditor.getEditableIframe().focus(),this.closureEditor.field.focus(),this.getValue()&&goog.editor.range.placeCursorNextTo(goog.editor.node.getRightMostLeaf(this.closureEditor.field),!1)):this.on("load",this.focus,this)},setValue:function(newValue){this.closureEditor&&this._closureEditorInitialLoadFinished&&(this.closureEditor.setHtml(!1,newValue),this.initialValue=this.getValue(),this.mixins.field.setValue.call(this,this.initialValue))},getValue:function(){return this.closureEditor?this.closureEditor.getCleanContents():this.value||""},clean:function(value){return this.closureEditor.clean(value)},getSubmitData:function(){var submitData={};return submitData[this.getName()]=this.getValue(),submitData},clearHistory:function(){this._undoRedoPlugin.clearHistory()},onDestroy:function(){this.callParent(arguments),this.closureEditor&&!this.closureEditor.isDisposed()&&(this.closureEditor.dispose(),delete this.closureEditor)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.discussion.InlineDiscussionReplyEditorViewController",{extend:Rally.ui.ViewController,mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},statics:{PREFERENCE_PLAIN_MODE:"plain",PREFERENCE_RICH_MODE:"rich"},observe:{view:{toggle:"onToggle",post:"onPost",textchange:"onTextChange"}},init:function(){this.callParent(arguments),this.model||Deft.Promise.all([this._loadModel(),this._calculateRichTextMode()]).then({success:function(values){this.model=values[0],this.getView().setModelAndMode(this.model,values[1])},scope:this})},onToggle:function(value){var view=this.getView(),preferenceKey=view.modePreferenceKey;if(this.recordAction({description:"discussion rich text toggled",miscData:{direction:value?"on":"off"}}),value?view.setRichTextMode():view.setPlainTextMode(),preferenceKey){var prefValue=value?this.self.PREFERENCE_RICH_MODE:this.self.PREFERENCE_PLAIN_MODE,settings={};settings[preferenceKey]=prefValue,Rally.data.PreferenceManager.update({requester:view,filterByUser:!0,settings:settings,scope:this,success:function(preferences){}})}},onPost:function(userAction){var view=this.getView(),isRichTextMode=view.isRichTextMode(),value=view.getValue();if(value){var clientMetricsMessage="click"===userAction?"discussion reply button clicked":"discussion plain text enter key";this.recordAction({description:clientMetricsMessage,component:view,miscData:{richText:isRichTextMode}}),this._addDiscussionPost(isRichTextMode?value:Ext.String.htmlEncode(value))}},onTextChange:function(newValue){var shouldEnable,view=this.getView();if(view.isRichTextMode()){var maxLength=this._getMaxLength();shouldEnable=newValue.length>0&&(!maxLength||maxLength<0||newValue.length<=maxLength)}else shouldEnable=!!newValue;view.enablePost(shouldEnable)},_calculateRichTextMode:function(){var view=this.getView(),preferenceDeferred=new Deft.Deferred,richTextDefaultValue=view.richTextMode,preferenceKey=view.modePreferenceKey;return preferenceKey?Rally.data.PreferenceManager.load({requester:view,filterByUser:!0,filterByName:preferenceKey,scope:this,success:function(preferences){var prefValue=preferences[preferenceKey],isRichTextMode=prefValue?prefValue===this.self.PREFERENCE_RICH_MODE:richTextDefaultValue;preferenceDeferred.resolve(isRichTextMode)}}):preferenceDeferred.resolve(richTextDefaultValue),preferenceDeferred.promise},_getMaxLength:function(){var maxLength=this.model.getField("Text").attributeDefinition.MaxLength;if(maxLength&&maxLength!==-1)return maxLength},_loadModel:function(){var deferred=new Deft.Deferred;return Rally.data.ModelFactory.getModel({type:"conversationpost",success:function(model){deferred.resolve(model)}}),deferred.promise},_addDiscussionPost:function(reply){if(reply&&reply.length>0){var view=this.getView(),conversation=Ext.create(this.model,{Text:reply,Artifact:view.artifact.get("_ref")});conversation.save({success:function(newConversation){view.fireEvent("discussioncreated",view,newConversation),this.publish(Rally.Message.objectCreate,newConversation,this)},scope:this,requester:view}),view.clearTextField()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.discussion.InlineDiscussionReplyEditor",{extend:Ext.panel.Panel,alias:"widget.rallydiscussioninlinereplyeditor",controller:"Rally.ui.discussion.InlineDiscussionReplyEditorViewController",cls:"inline-discussion-reply",border:0,mixins:[Rally.Messageable],artifact:void 0,richTextMode:!1,showUndoButton:!1,enableModeToggle:!0,modePreferenceKey:void 0,maxLength:-1,constructor:function(config){this.layout=config.enableModeToggle===!1?"hbox":"fit",this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addEvents(["discussioncreated","ready","toggle","textchange","post"])},setModelAndMode:function(model,richTextMode){this.model=model,this.suspendLayouts(),this.richTextMode=richTextMode,this._addDockedComponents(),this._setMode(richTextMode,!1),this.resumeLayouts(!0),this._publishComponentReady()},focusTextField:function(){var field=this.isRichTextMode()?this.richTextEditor:this.textfield;field.focus()},isRichTextMode:function(){return this.richTextMode},getValue:function(){return this._getTextField().getValue()},setRichTextMode:function(shouldFocus){var text="";this.richTextMode=!0,this.textfield&&(text=this.textfield.getValue(),this.remove(this.textfield),this.textfield=null),this.richTextEditor=this.add({xtype:"rallyrichtexteditor",field:this.artifact.getField("Discussion"),listeners:{change:this._onTextChange,load:function(){shouldFocus&&this.richTextEditor.focus(),this._publishComponentReady()},scope:this},maxHeight:this.editorMaxHeight,record:this.artifact,showUndoButton:this.showUndoButton,value:text})},setPlainTextMode:function(shouldFocus){this.richTextMode=!1,this.remove(this.richTextEditor),this.richTextEditor=null;var textFieldListeners={change:this._onTextChange,keydown:this._onTextFieldKeyDown,scope:this};this.enableModeToggle?(this.button.disable(),this.textfield=this.add({itemId:"plaintext",xtype:"rallytextfield",enableKeyEvents:!0,listeners:textFieldListeners})):(this.textfield=this.add({xtype:"rallytextfield",flex:1,enableKeyEvents:!0,listeners:textFieldListeners}),this.add({itemId:"spacer",xtype:"component",width:6}),this.button=this.add(this._getPostButtonConfig())),shouldFocus&&this.textfield.focus()},clearTextField:function(){var field=this._getTextField();field.setValue(""),field.clearHistory&&field.clearHistory(),field.focus()},enablePost:function(value){this.button.setDisabled(!value)},_addDockedComponents:function(){var items=[];if(this.enableModeToggle&&items.push({itemId:"checkbox",boxLabel:"Enable Rich Text",xtype:"checkbox",checked:this.richTextMode,listeners:{change:function(checkbox,value){this.fireEvent("toggle",value)},scope:this}}),(this.enableModeToggle||this.richTextMode)&&Ext.Array.push(items,"->",this._getPostButtonConfig()),!_.isEmpty(items)){var dock=this.addDocked({itemId:"dock",dock:"bottom",xtype:"toolbar",cls:"inline-discussion-reply-toolbar",items:items})[0];this.checkbox=dock.down("checkbox"),this.button=dock.down("rallybutton")}},_getTextField:function(){return this.textfield||this.richTextEditor},_setMode:function(richTextMode,shouldFocus){richTextMode?this.setRichTextMode(shouldFocus):this.setPlainTextMode(shouldFocus)},_onTextChange:function(textComponent,value){this.fireEvent("textchange",value)},_onTextFieldKeyDown:function(textfield,e){e.getKey()===e.ENTER&&(e.stopEvent(),this.fireEvent("post","enter"))},_getPostButtonConfig:function(){return{xtype:"rallybutton",itemId:"button",text:"Post",cls:"primary rly-small",disabled:!0,suppressClientMetrics:!0,listeners:{click:function(){this.fireEvent("post","click")},scope:this}}},_publishComponentReady:function(){this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.richtext.HasOrphanedLiPredicate",{singleton:!0,evaluate:function(text){var element=Ext.fly(Ext.DomHelper.createDom({html:text})),lis=element.select("li"),result=!1;return lis.each(function(li){if(!li.parent("ol")&&!li.parent("ul"))return result=!0,!1}),result}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.view.UserToolTip",{buildUserTooltips:function(fieldName,targetSelector){"undefined"==typeof targetSelector&&(targetSelector="a.profileLink"),this._monitoredUserToolTips&&(this._monitoredUserToolTips=[]);for(var nodes=this.getNodes(),i=0;i<nodes.length;i++)if(Ext.fly(nodes[i]).down(targetSelector)){var tt=Ext.create("Rally.ui.tooltip.UserToolTip",{target:Ext.fly(nodes[i]).down(targetSelector),userOid:this.getStore().getAt(i).get(fieldName).ObjectID});this._monitoredUserToolTips&&this._monitoredUserToolTips.push(tt)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.view.ShowMore",{maxWsapiCount:200,addShowMoreLink:function(showMoreCount,showMoreCtClass,showMoreText){if(this.showMoreCount=showMoreCount||10,this.showMoreCtClass=showMoreCtClass||"show-more-ct",0!==this.store.getCount()&&this.store.getCount()<this.store.getTotalCount()&&this.store.getCount()<this.maxWsapiCount){var ct=this.getEl().createChild({cls:this.showMoreCtClass}),link=ct.createChild({tag:"a",href:"#",html:showMoreText||"Show more"});link.on("click",this._onShowMoreLinkClicked,this)}},_onShowMoreLinkClicked:function(event){event.preventDefault(),this.store.pageSize=this.store.getCount()+this.showMoreCount,this.on("refresh",this._scrollToNewRecords,this,{single:!0,prevHeight:this.getEl().child(".list").getHeight()}),this.store.load()},_scrollToNewRecords:function(event,options){var newestRecord=this.store.getAt(this.store.pageSize-(this.showMoreCount+1)),recordDom=this.getNode(newestRecord);recordDom?(Ext.fly(recordDom).scrollIntoView(this.getEl()),this.getEl().scroll("down",this.getHeight(),!0)):this.getEl().scroll("down",options.prevHeight,!0)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.discussion.DiscussionRichTextStreamView",{extend:Ext.view.View,alias:"widget.rallydiscussionrichtextstreamview",mixins:{messageable:Rally.Messageable,animator:Ext.util.Animate,userToolTip:Rally.ui.view.UserToolTip,showMore:Rally.ui.view.ShowMore},statics:{maxWsapiCount:200},clientMetrics:[{endEvent:"ready",description:"initial load"},{method:"_onShowMoreLinkClicked",description:"show more clicked"},{method:"_onDeleteCompletion",description:"deleted comment"}],cls:"discussion-richtext-stream-view",emptyText:'<div class="no-data">  <p>There is no data</p></div>',itemSelector:"ul:first > li.list-item",maskClass:"popover-mask",maskTemporaryClass:"temp-popover-mask",maskRemoved:!1,confirmationDialog:null,profileImageSize:50,showMoreCount:10,showArtifactDetail:!0,allowReply:!0,allowDelete:!1,statusTpl:'<a class="profileLink" href="#"><span class="{nameCls}">{User._refObjectName}</span></a> {createdAt}{[this.getProjectContext(values.Artifact)]}',artifact:void 0,maxLines:void 0,includeShowMore:!0,constructor:function(config){config=Ext.apply({tpl:new Ext.XTemplate('<tpl if="values.length &gt; 0"><ul class="list"></tpl><tpl for="."><li class="{itemCls} list-item list-item-{oid}">','<tpl if="showArtifactDetail"><div class="artifact-detail">{detailLink} {Artifact.Name}</div></tpl>','<div class="list-item-info">','     <div class="list-item-user" style="width: {profileImageSize + 10}px; height: {profileImageSize + 10}px;">','         <img class="profile" style="width: {profileImageSize}px; height: {profileImageSize}px;" src="{profileUri}"/>',"     </div>",'     <div class="list-item-details" style="padding-left: {profileImageSize + 10}px;">','         <tpl if="allowDelete && this.isDeletable(User)">','            <a href="#" class="delete-comment" id="{ObjectID}"></a>',"         </tpl>",'         <div class="status">',config.statusTpl||this.statusTpl,"         </div>",'         <div class="detail-text">{Text}</div>','         <tpl if="allowReply">','         <div class="reply">',"             {replyLink}","         </div>","         </tpl>","     </div>","</div></li></tpl>",'<tpl if="values.length &gt; 0"></ul><span class="clear" /></tpl>',{getProjectContext:function(artifact){if(1!==Rally.environment.getContext().getSubscription().MaximumProjects)return" in "+artifact.Project._refObjectName},isDeletable:function(commentUser){var commentUserOid=Rally.util.Ref.getOidFromRef(commentUser._ref),context=Rally.environment.getContext(),user=context.getUser();if(user.ObjectID===commentUserOid)return!0;var permissions=context.getPermissions();return permissions.isWorkspaceOrSubscriptionAdmin()}})},config),this.callParent([config])},initComponent:function(){this.addEvents("ready"),this.store||(this.store=this._createStore()),this.callParent(arguments),this.on("refresh",this._onRefresh,this),this.store.on("load",function(){this.fireEvent("ready",this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},this),this.subscribe(this,Rally.Message.objectDestroy,this._onObjectDeleted,this),this.subscribe(this,Rally.Message.objectCreate,this._onObjectCreated,this),this.on("refresh",this._onAfterRender,this)},_truncateComment:function(){var containingDiv=this.el.down(".detail-text");if(containingDiv){var textMetrics=new Ext.util.TextMetrics(containingDiv),targetWidth=containingDiv.getWidth()*this.maxLines,text=containingDiv.dom.textContent||containingDiv.dom.innerText;if(textMetrics.getWidth(text)>targetWidth){var content="",addEllipsis=!1,ellipsisWidth=textMetrics.getWidth("..."),slop=5;_.each(text.split(""),function(c){var contentWidth=textMetrics.getWidth(content+c);return contentWidth<targetWidth-ellipsisWidth-slop?void(content+=c):(addEllipsis=!0,!1)}),containingDiv.setHTML(addEllipsis?content.trim()+"...":content),containingDiv.setStyle("word-break","break-all")}this.setHeight(this.el.down(".list").getHeight())}},_onAfterRender:function(){deleteEls=this.getEl().select(".delete-comment"),deleteEls&&deleteEls.elements.length>0&&deleteEls.each(function(el){this.mon(el,"click",this._showDeleteCommentDialog,this,{preventDefault:!0})},this),this.maxLines&&this._truncateComment()},prepareData:function(data,recordIndex,record){var itemCls="";0===record.index?itemCls="first":record.index===record.store.getCount()-1&&(itemCls="last");var artifact=record.get("Artifact"),user=record.get("User");return data.profileImageSize=this.profileImageSize,data.profileUri=Rally.util.User.getProfileImageUrl(this.profileImageSize,user._ref),data.detailLink=Rally.nav.DetailLink.getLink({record:artifact,text:artifact.FormattedID}),data.replyLink=Rally.util.DetailLink.getLink({record:artifact,text:"Reply",showHover:!1,subPage:"discussion",onclick:this.showDiscussionPopover(artifact)}),data.createdAt=Ext.String.capitalize(record.get("_CreatedAt")),data.itemCls=itemCls,data.nameCls=user.Disabled?"inactive":"",this.maxLines&&(data.Text=Ext.util.Format.stripTags(data.Text.replace(/<div>/g," ")),data.Text=data.Text.replace(/&nbsp;/g," ").replace(/\s+/g," ").trim()),Rally.ui.richtext.HasOrphanedLiPredicate.evaluate(data.Text)&&(data.Text="<ul>"+data.Text+"</ul>"),data.allowReply=this.allowReply,data.showArtifactDetail=this.showArtifactDetail,data.showQuotes=this.showQuotes,data.allowDelete=this.allowDelete,data.oid=record.get("ObjectID"),data},_createStore:function(){var defaultConfig={model:Ext.identityFn("ConversationPost"),fetch:["Artifact","Project","Name","FormattedID","CreationDate","Text","User","Disabled","ObjectID","_CreatedAt"],limit:this.showMoreCount,pageSize:this.showMoreCount,autoLoad:!0,requester:this,sorters:[{property:"CreationDate",direction:"DESC"}]};return Ext.create("Rally.data.wsapi.Store",Ext.apply(defaultConfig,this.storeConfig))},_onRefresh:function(){if(this.buildUserTooltips("User"),this.includeShowMore&&this.addShowMoreLink(this.showMoreCount),this._shouldHighlight){var el=this.el.down(".first.list-item");el&&Rally.util.Animation.highlight(el,{callback:function(){delete this._shouldHighlight},scope:this})}},_onObjectDeleted:function(record,cmp){if(cmp!==this){var types=["defect","hierarchicalrequirement","defectsuite","testcase","task","conversationpost"];_.contains(types,record.get("_type").toLowerCase())&&this.store.reload()}},_onObjectCreated:function(record){"conversationpost"===record.get("_type").toLowerCase()&&this.store.reload()},showDiscussionPopover:function(recordData){return"var Ext = window.Ext4 || window.Ext,discussionPopover = Rally.ui.popover.PopoverFactory.bake({target: Ext.get(event.target || event.srcElement),field: 'Discussion',oid: "+recordData.ObjectID+",type: '"+recordData._type+"',replyEditorConfig: {listeners: {discussioncreated: function(editor) {richTextView = Ext.getCmp(editor.up('rallydiscussionpopover').target.up('.discussion-richtext-stream-view').id);richTextView._shouldHighlight = true;editor.up('rallydiscussionpopover').destroy();}}}});return false;"},_showDeleteCommentDialog:function(event,target){return targetId=parseInt(target.id,10),record=this.getStore().getById(targetId),this._removeMaskAsNeeded(),this.confirmationDialog=Ext.create("Rally.ui.dialog.ConfirmDialog",{title:this._getDeleteMsgHeader(record),message:this._getDeleteMsgBody(record),confirmLabel:"Delete",modal:!0,record:record,listeners:{confirm:this._onDeleteConfirm,cancel:this._onDeleteCancel,scope:this}}),!1},_getDeleteMsgHeader:function(record){var isCreator=Rally.environment.getContext().getUser().ObjectID===record.data.User.ObjectID;return isCreator?"Are you sure you want to delete your comment?":"Are you sure you want to delete "+record.data.User._refObjectName+"'s comment?"},_getDeleteMsgBody:function(record){var messageBody=Ext.String.ellipsis(Ext.util.Format.stripTags(record.data.Text),150,!0);return messageBody+=""===messageBody?"":"<br /><br />",messageBody+"THERE IS NO UNDO for deleting discussions."},_onDeleteCancel:function(){this._addMaskAsNeeded(),this.confirmationDialog=null,this.fireEvent("deletecanceled")},_onDeleteConfirm:function(confirmDialog){this._addMaskAsNeeded(),confirmDialog.record.destroy({success:this._onDeleteCompletion,scope:this}),this.confirmationDialog=null},_onDeleteCompletion:function(record){this.fireEvent("discussiondestroyed",this,record),Rally.environment.getMessageBus().publish(Rally.Message.objectDestroy,record,this)},_removeMaskAsNeeded:function(){var maskEl=Ext.select("."+this.maskClass).first();maskEl&&(this.maskRemoved=!0,maskEl.removeCls(this.maskClass).addCls(this.maskTemporaryClass))},_addMaskAsNeeded:function(){if(this.maskRemoved){var maskEl=Ext.select("."+this.maskTemporaryClass).first();maskEl&&(this.maskRemoved=!1,maskEl.addCls(this.maskClass).removeCls(this.maskTemporaryClass))}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.PageDiscussionField",{extend:Ext.container.Container,alias:"widget.rallydetailpagediscussionfield",mixins:{messageable:Rally.Messageable},cls:"discussionDetailField",config:{record:void 0},bubbleEvents:["beforefieldedit"],initComponent:function(){this.addEvents("beforefieldedit","refresh","aftercontentrender"),this.callParent(arguments),this.add({xtype:"rallydiscussioninlinereplyeditor",artifact:this.record,richTextMode:!0,showUndoButton:!0,enableModeToggle:!1}),this.add({xtype:"rallydiscussionrichtextstreamview",artifact:this.record,showArtifactDetail:!1,allowReply:!1,allowDelete:!0,autoScroll:!0,profileImageSize:35,emptyText:'<div class="no-data">  <p>There are no posts</p></div>',statusTpl:'<a class="profileLink" href="#"><span class="{nameCls}">{User._refObjectName}</span></a> {createdAt}',storeConfig:{context:{project:null},filters:[{property:"Artifact",operation:"=",value:this.record.get("_ref")}]},listeners:{viewready:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.fireEvent("aftercontentrender",this)},scope:this}}),this.subscribe(this,Rally.Message.objectFocus,this._onObjectFocus,this)},_onObjectFocus:function(record){var streamView=this.down("rallydiscussionrichtextstreamview"),recordIndex=streamView.store.findExact("_ref",record.get("_ref"));if(recordIndex!==-1){var post=streamView.getNode(streamView.store.getAt(recordIndex));post&&this._scrollToAndHighlightPost(post)}},_scrollToAndHighlightPost:function(post){var postEl=Ext.get(post),bodyEl=Ext.getBody();bodyEl.scrollTo("top",postEl.getOffsetsTo(bodyEl)[1]),postEl.highlight()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.SimpleTextDetailField",{extend:Ext.Component,alias:"widget.rallydetailsimpletextdetailfield",cls:"simpleTextDetailField",autoEl:"span",renderTpl:'<input class="simpleTextDetailField" value="{value:htmlEncode}" placeholder="{placeholder}"/>',renderSelectors:{inputField:".simpleTextDetailField"},mixins:{field:Ext.form.field.Field},initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this.renderData={value:this.value,placeholder:this.placeholder},this.on("afterrender",this._afterRender,this)},_afterRender:function(){this.relayEvents(this.inputField,["blur","change"])},getSubmitData:function(){var submitData={};return submitData[this.getName()]=this.getValue(),submitData},getValue:function(){return this.inputField?this.inputField.getValue():null}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.ConflictResolutionManager",{config:{record:void 0,view:void 0,success:Ext.emptyFn,failure:Ext.emptyFn,complete:Ext.emptyFn,scope:void 0,queryParams:{}},mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},constructor:function(config){this.initConfig(config)},resolveConflicts:function(strategy){var record=this.getRecord(),view=this.getView();if(_.isFunction(view.clearMessages)&&view.clearMessages(),record.phantom)return void this._saveRecord({waitForChildCollectionSync:!0});if(!record.dirty)return void this.getSuccess().call(this.getScope(),record);var changes=record.getChanges(),previousValues=record.modified;record.self.load(record.get("ObjectID"),{success:function(serverRecord){var conflicts={},conflictFound=!1;Ext.Object.each(changes,function(key,value){this._areEqual(previousValues[key],serverRecord.get(key))||(conflictFound=!0,conflicts[key]=value)},this),conflictFound?this._handleConflicts(serverRecord,conflicts,strategy):this._updateServerRecordWithLocalChangesAndSave(serverRecord)},failure:this._onFailure,scope:this})},_updateServerRecordWithLocalChangesAndSave:function(serverRecord){Ext.Object.each(this.getRecord().getChanges(),function(key,value){serverRecord.set(key,value)}),this.setRecord(serverRecord),this._saveRecord()},_areEqual:function(value1,value2){return value1 instanceof Date&&value2 instanceof Date?value1.valueOf()===value2.valueOf():Ext.isObject(value1)&&Ext.isObject(value2)?Ext.Object.toQueryString(value1)===Ext.Object.toQueryString(value2):value1===value2},_handleConflicts:function(serverRecord,conflicts,strategy){"yours"===strategy?this._conflictTakeYours(serverRecord,conflicts,strategy):"theirs"===strategy?this._conflictTakeTheirs(serverRecord,conflicts,strategy):this._showConflicts(serverRecord,conflicts)},_showConflicts:function(newRecord,conflicts){this.getView().showMessage('<h2>Looks like someone has updated this item since you started editing it.</h2><h4>Please resolve the conflicts below and save again, or <a href="#" class="detailConflictTakeYours">take yours</a> | <a href="#" class="detailConflictTakeTheirs">take theirs</a></h4>',"detailConflictResolution");var container=this.getView().getMessageContainer(),onTakeYours=Ext.bind(this._conflictTakeYours,this,[newRecord,conflicts]),onTakeTheirs=Ext.bind(this._conflictTakeTheirs,this,[newRecord,conflicts]);container.getEl().down(".detailConflictTakeYours").on("click",onTakeYours,this,{stopEvent:!0}),container.getEl().down(".detailConflictTakeTheirs").on("click",onTakeTheirs,this,{stopEvent:!0})},_conflictTakeYours:function(newRecord,conflicts,strategy){Ext.Object.each(conflicts,function(key,value){newRecord.set(key,this.getRecord().get(key))},this),this.setRecord(newRecord),this.resolveConflicts(strategy)},_conflictTakeTheirs:function(newRecord,conflicts,strategy){Ext.Object.each(this.getRecord().getChanges(),function(key,value){Ext.Array.contains(Ext.Object.getKeys(conflicts),key)||newRecord.set(key,value)}),this.setRecord(newRecord),this.resolveConflicts(strategy)},_saveRecord:function(options){options=options||{};var me=this,oldVersionId=this.getRecord().get("VersionId");this.getRecord().save({requester:this,params:this.getQueryParams(),waitForChildCollectionSync:options.waitForChildCollectionSync,success:function(record){oldVersionId===record.get("VersionId")&&me._logDifferenceEvent(),me.getSuccess().apply(this,arguments),me.getComplete().apply(this,arguments)},failure:function(record,operation){me._onFailure(record,operation),me.getComplete().apply(this,arguments)},scope:this.getScope()})},_logDifferenceEvent:function(){this.recordAction({description:"edpSameVersionReceived",miscData:{user:Rally.environment.getContext().getUser().UserName,artifact:this.getRecord().get("_ref")}})},_onFailure:function(record,operation){this.getFailure().call(this.getScope(),operation.getError().errors)},_getErrorMessage:function(operation){var errorMessage="",error=operation.getError();return error&&error.errors&&error.errors.length>0&&(errorMessage=error.errors[0]),errorMessage}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.EditModeDefaultDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallyeditmodedefaultdialog",clientMetrics:{beginEvent:"beforeshow",endEvent:"show",description:"dialog shown"},config:{editMode:void 0},closable:!0,title:"Default Editing Mode",draggable:!0,width:500,height:200,cls:"default-edit-mode-dialog",initComponent:function(){var modeName=this.getEditMode()?"editing":"viewing";this.items=[{layout:{type:"vbox",align:"center"},border:!1,height:200,items:[{xtype:"component",html:"Would you like to default to "+modeName+" detail pages? <br> You can modify this preference in My Settings.",align:"middle",margin:"15 0 0 0"},{xtype:"container",margin:"30 0 0 0",items:[{itemId:"yesButton",xtype:"rallybutton",text:"Yes, change to "+modeName,cls:"primary button medium",listeners:{click:{fn:function(){this._saveModePreference(this.getEditMode()),this._dismissDialog()},scope:this}}},{itemId:"noButton",xtype:"rallybutton",text:"No, thanks",cls:"secondary button medium",listeners:{click:{fn:function(){this._dismissDialog()},scope:this}}}]},{xtype:"checkboxfield",boxLabel:"Don't show this dialog again",name:"dontShowAgain"}]}],this.on("show",function(){var yesButton=this.down("#yesButton");yesButton&&yesButton.focus()}),this.callParent()},_dismissDialog:function(){this.down("checkboxfield").value?this._setDismissDialogPreference().then({success:function(){this.destroy()},scope:this}):this.destroy()},_setDismissDialogPreference:function(){return Rally.data.PreferenceManager.update({filterByUser:!0,settings:{detailPageEditModeDontShowDialogAgain:!0}})},_saveModePreference:function(editMode){var userProfileId=Rally.environment.getContext().getUser().UserProfile.ObjectID;Rally.data.ModelFactory.getModel({type:"UserProfile",success:function(model){model.load(userProfileId,{success:function(record){record.set("DefaultDetailPageToViewingMode",!editMode),record.save()}})}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.print.PrintRecordMixin",{getDetailTpl:function(){return Ext.create("Ext.XTemplate",'<div class="details">',"{detailSection}","</div>")},getDetailSectionTpl:function(){return Ext.create("Ext.XTemplate",'<div class="detail-section">','<span class="detail-title">{FormattedID}: {Name}</span>',"<table>",'<tpl for="fields">',"<tr>",'<th class="field-name">{Name}:</th>','<td class="field-value">{Value}</td>',"</tr>","</tpl>","</table>","</div>")},convertRecordToPrintData:function(record){var printData={FormattedID:record.get("FormattedID"),Name:record.get("Name"),fields:[]};return _.each(record.getFields(),function(field){if(!field.hidden&&field.printable&&!_.contains(this.getExcludedDetailFields(),field.name)){var value=Rally.ui.renderer.RendererFactory.renderRecordField(record,field.name);printData.fields.push({Name:field.displayName,Value:value})}},this),printData}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.print.RecordPrintPage",{extend:Rally.ui.plugin.print.Print,alias:"plugin.rallyrecordprintpage",mixins:{printRecord:Rally.ui.plugin.print.PrintRecordMixin},config:{excludedDetailFields:["ObjectID","FormattedID","Name","RevisionHistory","Changesets","Discussion"]},constructor:function(config){return this.initConfig(config),this.callParent(arguments)},init:function(component){this.callParent(arguments),this.component=component},openPrintPage:function(printOptions){this.callParent(arguments)},getContent:function(){var printData=this.convertRecordToPrintData(this.printOptions.record),html=this.getDetailSectionTpl().apply(printData);return this.getDetailTpl().apply({detailSection:html})},getHeader:function(){return""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.watches.WatchArtifactButton",{extend:Rally.ui.Button,alias:"widget.rallywatchbutton",cls:"watch-button picto tertiary rly-small",disabledCls:"rly-disabled",iconCls:"icon-visible",config:{record:null,text:"Watch",betaBadge:!0,disabled:!0},listeners:{click:function(){this._toggleWatch()}},constructor:function(){this.api=new Rally.data.notifications.Api,this.callParent(arguments),this.api.checkIfWatching(this.getRecord(),{scope:this,success:function(isWatching){this.setWatching(isWatching),this.enable()},failure:function(response){}})},_toggleWatch:function(){var me=this;this._isWatching?this.api.unwatch(this.getRecord()).then(function(results){me.setWatching(!1)}):this.api.watch(this.getRecord()).then(function(results){me.setWatching(!0)})},setWatching:function(isWatching){this._isWatching=isWatching,this.setText(isWatching?"Unwatch":"Watch"),isWatching?this.addCls("watching"):this.removeCls("watching");
}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CollectionTemplate",{extend:Ext.XTemplate,fieldName:"",config:{wrapWithAnchorTag:!1,maxWidth:270},constructor:function(config){this.mergeConfig(config);var templateConfig=["{[this.renderCollection(values)]}",{renderCollection:function(values){if(values[config.fieldName]._tagsNameArray){if(values[config.fieldName].Count>0){for(var val=_.sortBy(values[config.fieldName]._tagsNameArray,"Name")[0].Name,textMetrics=new Ext.util.TextMetrics,appendEllipsis="",additionalValuesIndicator=this._getAdditionalValuesIndicator(values[config.fieldName]),maxValueWidth=this.getMaxWidth()-textMetrics.getWidth("..."+additionalValuesIndicator)-40;textMetrics.getWidth(val)>maxValueWidth;)val=val.slice(0,-5),appendEllipsis="...";return val+appendEllipsis+additionalValuesIndicator}return""}return void 0!==values[config.fieldName].Count?""+values[config.fieldName].Count:""}},config];return this.getWrapWithAnchorTag()&&(templateConfig[0]='<a class="collection-template-value">'+templateConfig[0]+"</a>"),this.callParent(templateConfig)},_getAdditionalValuesIndicator:function(value){return value.Count>1?" (+"+(value.Count-1)+")":""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.DetailController",{statics:{QUERY_PARAMS_WHITE_LIST:{rankTo:!0,rankScope:!0,rankAbove:!0,rankBelow:!0,taskIndexAbove:!0,taskIndexBelow:!0},getController:function(config){var controllerClass=this.getControllerClass(config.record);return controllerClass?Ext.create(controllerClass,config):Ext.Error.raise("No detail controller defined for "+config.record.self.prettyTypeName)},getControllerClass:function(record){var controller,type=record.self.prettyTypeName;if(0===type.indexOf("portfolioitem"))controller="Rally.ui.detail.controller.PortfolioItemDetailController";else switch(type){case"defect":controller="Rally.ui.detail.controller.DefectDetailController";break;case"userstory":controller="Rally.ui.detail.controller.UserStoryDetailController";break;case"task":controller="Rally.ui.detail.controller.TaskDetailController";break;case"milestone":controller="Rally.ui.detail.controller.MilestoneDetailController";break;case"deliverygroup":controller="Rally.ui.detail.controller.DeliveryGroupDetailController"}return controller}},mixins:{observable:Ext.util.Observable,recordable:Rally.clientmetrics.ClientMetricsRecordable,messageable:Rally.Messageable},plugins:[{ptype:"rallyrecordprintpage"}],config:{defaultOwnerToCurrentUser:void 0,record:void 0,useLegacyPrintDialog:!1,view:void 0,queryParams:{}},savesPending:0,constructor:function(config){this.initConfig(config),this.initPlugins(),this.mixins.observable.constructor.call(this,config),this.addEvents("recordupdate"),this.getRecord().phantom&&this.initializePhantomRecord(this.getRecord()),this._originalRecord=this.getRecord(),this.callParent(arguments),this.changedFields={},Rally.ui.detail.DetailHelper.setController(this),this.wireEventHandlers(this.getView()),this._originalRecord=this.getRecord();var attachmentsField=this.getRecord().getField("Attachments");attachmentsField&&!attachmentsField.custom&&(this._attachmentStore=this.getRecord().getCollection("Attachments"),this._attachmentStore.load())},wireEventHandlers:function(view){view&&(view.on("canceledit",this._onCancelEdit,this),view.on("beforedestroy",this._saveBeforeDestroy,this),view.on("donebuttonclick",this._onDoneButtonClick,this),view.on("fieldchanged",this._handleFieldChange,this),view.on("fieldupdated",this._saveIndividualField,this),view.on("gearaction",this.doAction,this),view.on("save",this._save,this),view.on("tabchange",this._onTabChange,this),view.on("beforeswitchback",this._handleBeforeSwitchback,this),view.on("switchback",this._handleSwitchback,this),view.on("editmodechange",this._setEditMode,this),view.on("filesselected",this._uploadAttachments,this),view.on("filesselectedoldschool",this._uploadAttachmentsOldSchool,this),view.on("recordloaded",this._addAttachment,this))},_sanitizeQueryParams:function(queryParams){return sanitizedQueryParams={},_.forOwn(queryParams,function(value,param){Rally.ui.detail.controller.DetailController.QUERY_PARAMS_WHITE_LIST[param]&&value&&"null"!==value&&(sanitizedQueryParams[param]=value)},this),sanitizedQueryParams},initPlugins:function(){Ext.each(this.plugins,function(pluginConfig){Ext.applyIf(pluginConfig,{cmp:this}),Ext.PluginManager.create(pluginConfig).init(this)},this)},_onDoneButtonClick:function(){this.savesPending<1&&this.goBack(),this.doneButtonClicked=!0},_onCancelEdit:function(){Rally.nav.detail.NavHistory.goBack()},getActions:function(){return Rally.data.util.Record.isReadOnly(this.getRecord())?[{action:"print",label:"Print"}]:this.getUpdatableActions()},getUpdatableActions:function(){return[]},getAssociations:function(){return[]},getMetaFields:function(){return[]},getDefaultMetaFields:function(feedbackSwitchBackSubject){var watchButton,metaFields=[],feedbackAndSwitchback={xtype:"rallydetailfeedbackmetafield",subject:feedbackSwitchBackSubject,showSwitchback:!Rally.ui.detail.DetailHelper.featureEnabled("EDP_NO_SWITCHBACK")};return!this.getRecord().phantom&&Rally.data.notifications.Api.enabled&&Rally.ui.detail.DetailHelper.featureEnabled("ENABLE_NEW_NOTIFICATIONS")&&(watchButton={xtype:"rallywatchbutton",record:this.getRecord()}),Rally.ui.detail.DetailHelper.featureEnabled("EDP_NO_SWITCHBACK")&&watchButton?(feedbackAndSwitchback.feedbackButtonConfig={margin:"0 17 0 0"},metaFields.push({xtype:"container",layout:{type:"hbox",pack:"end"},items:[watchButton,{xtype:"tbfill"},feedbackAndSwitchback]})):(metaFields.push(feedbackAndSwitchback),watchButton&&metaFields.push(watchButton)),this.record.get("Discussion")&&this.record.get("Discussion").Count>0&&metaFields.push({xtype:"rallydetailcommentsmetafield"}),metaFields.push({xtype:"rallydetailownermetafieldedpcomplete"}),metaFields},getExcludedFields:function(){var includedCollectionFields=[];Rally.ui.detail.DetailHelper.isAttributeEnabled(this.getRecord(),"Milestones")&&(includedCollectionFields=["Milestones"]),this._shouldShowAttachmentsBucket()&&includedCollectionFields.push("Attachments");var excludedFields=["DisplayColor","FormattedID","Name","ObjectID","ObjectUUID","RevisionHistory","Subscription","VersionId","Workspace"];return excludedFields.concat(this._getMappedFieldNames(),this._getNonWsapiFieldNames(),this.getCollectionFields(includedCollectionFields))},_getMappedFieldNames:function(){return _.chain(this.getRecord().getFields()).filter(function(field){return field.isMappedFromArtifact}).map("name").value()},_getNonWsapiFieldNames:function(){return _.chain(this.getRecord().getFields()).filter(function(field){return"Rally.data.wsapi.Field"!==Ext.getClassName(field)}).map("name").value()},getCollectionFields:function(excludedFields){return excludedFields=excludedFields||[],_(this.getRecord().self.getCollectionFields()).reject(function(field){return field.custom===!0||_.contains(excludedFields,field.name)}).pluck("name").value()},getFieldBuckets:function(){var buckets=[this.createStandardFieldBucket("Description",["Description"],{growToFillSpace:!0,showFieldLabels:!1}),this.getScheduleBucket()];return this._shouldShowAttachmentsBucket()&&buckets.push(this.createStandardFieldBucket("Attachments",["Attachments"],{showFieldLabels:!1,growToFillSpace:!0})),buckets.push({label:"Custom",filterFn:function(field){return field.custom}}),buckets.push(this.createStandardFieldBucket("Notes",["Notes"],{growToFillSpace:!0,showFieldLabels:!1})),buckets.push({label:"Quality",fields:["LastVerdict","LastRun","LastBuild"]}),buckets.push({label:"Other",filterFn:function(field){return!0}}),buckets},_shouldShowAttachmentsBucket:function(){if(!Rally.ui.detail.DetailHelper.isAttributeEnabled(this.getRecord(),"Attachments"))return!1;var attachmentsField=this.getRecord().getField("Attachments"),fieldIsEditable=Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(attachmentsField,this.getRecord());return!!fieldIsEditable||this.getRecord().get("Attachments").Count>0},getScheduleBucket:function(){return this.createStandardFieldBucket("Schedule",["Plan","Release","PlannedStartDate","PlannedEndDate","ActualStartDate","ActualEndDate","Iteration","Expedite","Milestones","Package"])},createStandardFieldBucket:function(label,fieldNames,config){var bucket=_.merge({label:label,fields:[]},config);return _.forEach(fieldNames,function(fieldName){var recordField=this.getRecord().getField(fieldName);recordField&&!recordField.custom&&bucket.fields.push(fieldName)},this),bucket},getNorthFields:function(){return _.compact([this._getFieldComponent(this.getRecord().getField("DisplayColor"),{displayName:"Color",labelCls:"fieldsetContainerLabel color-label"})])},getBaseUrl:function(){return"/detail/"+this.getRecord().get("_type")},initializePhantomRecord:function(record){this._initializeOwnerField(record),_.each(this.getCollectionFields(),function(field){this._updatePhantomCollectionField(record,field)},this)},_initializeOwnerField:function(record){var ownerField=record.getField("Owner");if(ownerField&&!ownerField.custom){if(void 0===this.getDefaultOwnerToCurrentUser())throw new Error(["Please set defaultOwnerToCurrentUser to true or false","in the controller config for records of type",record.self.prettyTypeName].join(" "));this.getDefaultOwnerToCurrentUser()&&this.defaultFieldToCurrentUser(record,"Owner"),"none"===record.get("Owner")&&record.set("Owner",null)}},defaultFieldToCurrentUser:function(record,fieldName){if(!record.get(fieldName)){var currentUser=Rally.environment.getContext().getUser()._ref;record.set(fieldName,currentUser)}},_updatePhantomCollectionField:function(record,field){if(this._isAttributeEnabled(field)){var value=record.get(field);_.isString(value)&&record.set(field,_(value.split(",")).compact().map(function(ref){return{_ref:ref}}).value())}},reloadRecord:function(options){this.getRecord().self.load(this.getRecord().get("ObjectID"),{success:function(record){this.setRecord(record),this.fireEvent("recordupdate",record),Ext.callback(options.success,options.scope||this,[record])},failure:function(){Ext.Error.raise("No object with oid "+this.getRecord().get("ObjectID")+" found.")},scope:this})},_handleBeforeSwitchback:function(){if(this.record.phantom&&this.hasUnsavedChanges()){var shouldSwitchback=window.confirm("This item has not been created yet, and will be lost if you switchback now. Are you sure you want to switchback before creating this item?");if(!shouldSwitchback)return!1}return!0},_handleSwitchback:function(){Rally.data.detail.DetailPagePreference.toggleDetailPage("userstory",!1,function(){this.switchingBackFromEdp=!0,this.record.phantom?Rally.nav.detail.NavHistory.reloadAfterSwitchback():this._reloadWindow()},this)},_reloadWindow:function(){window.location.reload()},_handleFieldChange:function(fieldContainer){var record=this.getRecord();fieldContainer.editor&&this.updateRecordFromField(record,fieldContainer.editor),record.phantom||(record.isModified(fieldContainer.fieldName)?this.changedFields[fieldContainer.fieldName]=fieldContainer:delete this.changedFields[fieldContainer.fieldName])},_saveIndividualField:function(options){var record=this.getRecord();this.updateRecordFromField(this.getRecord(),options.field),!record.phantom&&record.dirty&&this._saveChanges(record,options)},_save:function(config){if(this.record.phantom){if(this._createNewStoryPending)return;this._createNewStoryPending=!0}this.getView().disableRibbon();var record=this.getRecord();config=config||{};var options={supressRecordUpdate:!0,success:function(){this.redrawView(),config.success&&Ext.callback(config.success,config.scope)},failure:this._saveFailed,scope:this};this.updateRecordFromFields(record),this._saveChanges(record,options)},updateRecordFromFields:function(record){var view=this.getView();_.isFunction(view.getFields)&&_.forEach(view.getFields(),function(field){this.updateRecordFromField(record,field)},this)},hasUnsavedChanges:function(){return this.getRecord().dirty},_saveBeforeDestroy:function(){var record=this.getRecord(),view=this.getView();if(!record.phantom&&!record.deleted){if(this.savesPending>0)return void Rally.ui.notify.Notifier.showUpdate({artifact:record,showAddDetails:!1});this.updateRecordFromFields(record),this.hasUnsavedChanges()&&(Rally.ui.detail.DetailHelper.getCountOfUnsetRequiredFields(record)>0||(this.savesPending+=1,Ext.create("Rally.ui.detail.controller.ConflictResolutionManager",{record:record,view:view,success:function(updatedRecord){Rally.ui.notify.Notifier.showUpdate({artifact:updatedRecord,showAddDetails:!1})},failure:function(errors){var errorMsg=errors&&errors.length>0?"Looks like there was a problem. "+errors[0]:"Unknown Error";Rally.ui.notify.Notifier.showError({message:errorMsg,timeout:1e4})},complete:function(){delete this._createNewStoryPending,this.savesPending-=1},scope:this}).resolveConflicts("theirs")))}},_saveChanges:function(record,options){this.savesPending+=1,this.getView().clearMessages(),this.publish(Rally.Message.objectWillUpdate);var recordSaveMessage=record.phantom?Rally.Message.objectCreate:Rally.Message.objectUpdate,changedFields=this.changedFields;this.changedFields={};var queryParams={};record.phantom&&(queryParams=this._sanitizeQueryParams(this.getQueryParams())),Ext.create("Rally.ui.detail.controller.ConflictResolutionManager",{record:record,queryParams:queryParams,view:this.getView(),success:function(updatedRecord){this._notifyFieldUpdateFinished(options.field),this._handlePostSaveFieldActions(updatedRecord);var originalRecord=this.getRecord();this.setRecord(updatedRecord),options.supressRecordUpdate||this.fireEvent("recordupdate",updatedRecord),this.publish(recordSaveMessage,updatedRecord,this),_.forEach(changedFields,function(field){this._checkForInconsistencies(originalRecord,updatedRecord,field.getField()),field.handleSuccessfulSave(updatedRecord)},this),options.success&&options.success.call(options.scope,updatedRecord)},failure:function(messages){this._notifyFieldUpdateFinished(options.field),this.getView().handleErrors(record,messages),options.failure&&options.failure.call(options.scope,record)},complete:function(){delete this._createNewStoryPending,this.savesPending-=1,this._shouldGoBack()&&this.goBack(),this.subpageNavUrl&&(location.href=this.subpageNavUrl)},scope:this}).resolveConflicts()},_checkForInconsistencies:function(originalRecord,updatedRecord,field){var originalFieldValue=originalRecord.get(field.name),updatedFieldValue=updatedRecord.get(field.name);if("string"==typeof originalFieldValue&&(originalFieldValue=originalFieldValue.trim()),!_.isEqual(originalFieldValue,updatedFieldValue)&&(!updatedFieldValue._ref||updatedFieldValue._ref!==originalFieldValue)&&("TEXT"!==field.attributeDefinition.AttributeType||Ext.isEmpty(originalFieldValue)||Ext.isEmpty(updatedFieldValue))){var subscription=updatedRecord.get("Subscription"),workspace=updatedRecord.get("Workspace"),originalVersionId=originalRecord.get("VersionId"),updatedVersionId=updatedRecord.get("VersionId"),miscData={user:Rally.environment.getContext().getUser().UserName,artifact:updatedRecord.get("_ref"),subscription:subscription._ref,workspace:workspace._ref,originalVersionId:originalVersionId,updatedVersionId:updatedVersionId,versionIdsAreSame:originalVersionId===updatedVersionId,lastUpdateDate:updatedRecord.get("LastUpdateDate"),attrType:field.attributeDefinition.AttributeType,attrConstrained:field.attributeDefinition.Constrained,attrCustom:field.attributeDefinition.Custom,attrRef:field.attributeDefinition._ref,wasEmpty:Ext.isEmpty(originalRecord.modified[field.fieldName]),originalIsEmpty:Ext.isEmpty(originalFieldValue),updatedIsEmpty:Ext.isEmpty(updatedFieldValue)};"76de2093-5f8d-403d-a2db-fcec9c5c7079"===subscription._refObjectUUID&&(miscData.originalFieldValue=originalFieldValue,miscData.updatedFieldValue=updatedFieldValue),this.recordAction({description:"edpServerDidNotReturnSavedValue",miscData:miscData})}},_shouldGoBack:function(){return this.doneButtonClicked&&this.savesPending<1},goBack:function(){Rally.nav.detail.NavHistory.goBack(this.getRecord().get("FormattedID"))},_notifyFieldUpdateFinished:function(field){field&&field.updateFinished&&field.updateFinished()},_saveFailed:function(){this.view.fireEvent("savefailed")},_handlePostSaveFieldActions:function(record){this._redrawViewIfProjectChanged(record)},_redrawViewIfProjectChanged:function(record){Rally.ui.detail.DetailHelper.projectScopeChanged(record)&&Rally.ui.detail.DetailHelper.syncModelProject(record,function(record){this.getView().redrawDetailContentWrapper({record:record})},this)},doAction:function(view,action,params){switch(action){case"new":this._switchToNewMode(params);break;case"copy":this._switchToCopyMode();break;case"print":this._print();break;case"delete":this.deleteItem()}},_switchToNewMode:function(params){params=params||{},Rally.nav.Manager.create(this.getRecord().get("_type"),params)},_switchToCopyMode:function(){Rally.nav.Manager.copy(this.getRecord())},redrawView:function(){this.getView().redraw({record:this.getRecord(),editMode:!0})},_print:function(){this.getUseLegacyPrintDialog()?this._legacyPrint():this.openPrintPage({record:this.getRecord()})},_legacyPrint:function(){var oid=this.getRecord().get("ObjectID"),typeName=Rally.util.TypeInfo.normalizeTypeName(this.getRecord().get("_type")),typeInfo=Rally.util.TypeInfo.getTypeInfoByName(typeName),popupMethod=this._getWindowPopup();popupMethod("/slm/"+typeInfo.prefix+"/print/printSingleDialog.sp?oid="+oid,800,600,"print")},_getWindowPopup:function(){return window.popup},deleteItem:function(){Ext.create("Rally.ui.dialog.ConfirmDialog",{title:"Delete Item",message:this._getDefaultDeleteConfirmationPrompt(),confirmLabel:"Delete",listeners:{confirm:this._onDeleteClicked,scope:this}})},_onDeleteClicked:function(){this.getRecord().destroy({success:this._onDeleteSuccess,failure:this._onDeleteFailure,scope:this})},_onDeleteSuccess:function(){this.getRecord().deleted=!0,this.publish(Rally.nav.Message.postNavigationFlair,Ext.bind(function(record){Rally.ui.notify.Notifier.showDelete(record)},null,[this.getRecord()])),Rally.nav.detail.NavHistory.goBack()},_onDeleteFailure:function(record,operation){this.getView().handleErrors(record,operation.getError().errors)},_getDefaultDeleteConfirmationPrompt:function(){return"Are you sure you want to delete this item?"},_isAttributeEnabled:function(attribName){return Rally.ui.detail.DetailHelper.isAttributeEnabled(this.getRecord(),attribName)},_addTagsMetaField:function(metaFields){this._isAttributeEnabled("Tags")&&metaFields.push({xtype:"rallydetailtagsmetafield",listeners:{tagsUpdated:this._metaFieldUpdated,scope:this}})},_isAssociationEnabledForSubscription:function(featureName){var disabledFeatures={HS_1:["Chart","Defect Suites"],Express_Edition:["Chart","Defect Suites"]},disabledFeaturesForSub=disabledFeatures[Rally.environment.getContext().getSubscription().SubscriptionType]||[];return!Ext.Array.contains(disabledFeaturesForSub,featureName)},_handleImageUpload:function(response){this._addAttachmentToRecord(response.oid)},_addAttachmentToRecord:function(attachmentOid){Rally.data.ModelFactory.getModel({type:"Attachment",success:function(model){model.load(attachmentOid,{success:function(attachment){this._addAttachment(attachment)},scope:this})},scope:this})},_addAttachment:function(attachment){this._attachmentStore.add(attachment),this._attachmentStore.sync({scope:this,success:function(){this.publish(Rally.Message.attachmentAssociated,attachment)}})},_uploadAttachments:function(files){files.length&&(this._initAttachmentUploaderState(files.length),_.each(files,function(file){var uploader=this._createAttachmentUploader(files);uploader.uploadAttachment(file)},this))},_initAttachmentUploaderState:function(fileCount){this._fileUploadCount=fileCount,this._successfullyUploadedAttachments=[],this._failureMessages=[]},_createAttachmentUploader:function(){var uploader=Ext.create("Rally.ui.detail.AttachmentUploader",{record:this.record});return uploader.on("recordloaded",function(attachment){this._attachmentStore.add(attachment),this._successfullyUploadedAttachments.push(attachment),this._finishUpload()},this),uploader.on("failure",function(message){this._failureMessages.push(message),this._finishUpload()},this),uploader},_finishUpload:function(){this._fileUploadCount>this._successfullyUploadedAttachments.length+this._failureMessages.length||(this._successfullyUploadedAttachments.length&&this._attachmentStore.sync({scope:this,success:function(){this.publish(Rally.Message.attachmentAssociated)}}),this._failureMessages.length&&(Rally.ui.notify.Notifier.showError({message:this._failureMessages.join("<br/>"),timeout:5e3}),this.publish(Rally.Message.attachmentUploadFailed)))},_uploadAttachmentsOldSchool:function(formEl){this._initAttachmentUploaderState(1);var uploader=this._createAttachmentUploader();uploader.uploadAttachmentsOldSchool(formEl)},_publishAttachmentAssociated:function(){this.publish(Rally.Message.attachmentAssociated)},_buildItemConfig:function(attachmentOid,filename){var record=this.getRecord();return{ObjectID:attachmentOid,Name:filename,Record:record,get:function(property){return this[property]},destroy:function(callback){record.newAttachments=[],callback.success()}}},_metaFieldUpdated:function(){this.publish(Rally.Message.objectUpdate,this.getRecord(),this)},_getFieldComponent:function(field,config){if(this._isAttributeEnabled(field.name)&&!field.hidden){var fieldsetConfig={record:this.getRecord(),field:field};return Ext.apply(fieldsetConfig,config),Ext.create("Rally.ui.detail.FieldsetContainer",fieldsetConfig)}return null},getRankFieldComponent:function(config){if(Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.DragDropRankingEnabled)return null;var fieldsetConfig={xtype:"rallydetailfieldsetcontaineredpcomplete",record:this.getRecord(),field:this.getRecord().getField("Rank")};return Ext.apply(fieldsetConfig,config),fieldsetConfig},_onTabChange:function(ribbonComponent,urlSuffix){var url=this.getView().getDetailsTabHash(),hash=url+urlSuffix;return ribbonComponent.disabled?void this._logPreventNavigationEvent("edpNavigationDisabled",hash):(ribbonComponent.disable(),this.getRecord().phantom?(this._logPreventNavigationEvent("edpNavigationOnPhantomRecord",hash),void ribbonComponent.enable()):this.savesPending>0?(this._logPreventNavigationEvent("edpNavigationWithUnsavedChanges",hash),void(this.subpageNavUrl=hash)):void(location.hash!==hash?location.hash=hash:ribbonComponent.enable()))},_logPreventNavigationEvent:function(description,hash){this.recordAction({description:description,miscData:{currentLocation:location.href,nextLocation:this.baseUrl+hash}})},_setEditMode:function(component,editMode){Rally.ui.detail.EditModeContext.setTemporaryEditMode(this.getRecord(),editMode),this._getDismissDialogPreference().then({success:function(preference){if(preference.detailPageEditModeDontShowDialogAgain||editMode!==Rally.ui.detail.EditModeContext.getDefaultDetailPageToViewingMode())this._reloadPage();else{var dialog=this._buildDefaultEditModeDialog(editMode);dialog.show()}},scope:this})},_buildDefaultEditModeDialog:function(editMode){return Ext.create("Rally.ui.detail.view.EditModeDefaultDialog",{editMode:editMode,listeners:{scope:this,destroy:this._reloadPage}})},_reloadPage:function(){var almStr="alm",alm=Rally[almStr];alm.navigation.NavigationActionCreators.refreshPage()},_getDismissDialogPreference:function(){return Rally.data.PreferenceManager.load({filterByUser:!0,cache:!1,filterByName:"detailPageEditModeDontShowDialogAgain"})},updateRecordFromField:function(record,field){_.forOwn(field.getSubmitData(),function(value,fieldName){if(this._isChangeValid(record,field,fieldName)){var xtype=field.getXType();"rallyrichtexteditor"===xtype?this._setRichTextFieldIfChanged(record,field,fieldName,value):"rallydatefield"===xtype&&""!==value?this._setDateIfChanged(record,field,fieldName,value):"rallydetailmilestonesfield"===xtype?this._setMilestonesIfChanged(record,field,fieldName,value):"rallyreadyblockedstatus"===xtype||"rallydetailweblinkfield"===xtype?record.set(fieldName,value):this._setFieldIfChanged(record,field,fieldName,value)}},this)},_getOriginalValue:function(fieldName){return this._originalRecord.get(fieldName)},_setOriginalValue:function(fieldName,value){this._originalRecord!==this.getRecord()&&this._originalRecord.set(fieldName,value)},_setRichTextFieldIfChanged:function(record,field,fieldName,value){field.initialValue!==value?record.set(fieldName,value):record.isModified(fieldName)&&record.set(fieldName,record.raw[fieldName])},_setDateIfChanged:function(record,field,fieldName,value){var parsedDate=Ext.Date.parse(value,field.format),originalValue=this._getOriginalValue(fieldName);Rally.environment.useWorkspaceTimeZone&&Ext.isDate(parsedDate)&&(originalValue=Rally.util.DateTime.convertForEditing(originalValue));var datesAreEqualIgnoringTime=Ext.Date.format(originalValue,field.format)===Ext.Date.format(parsedDate,field.format);datesAreEqualIgnoringTime||(Rally.environment.useWorkspaceTimeZone&&Ext.isDate(parsedDate)&&(parsedDate=Rally.util.DateTime.convertFromEditing(parsedDate)),record.set(fieldName,parsedDate),this._setOriginalValue(fieldName,parsedDate))},_setMilestonesIfChanged:function(record,field,fieldName,value){var recordRefs=record.get(fieldName);recordRefs._tagsNameArray&&(recordRefs=_.pluck(recordRefs._tagsNameArray,"_ref"));var formFieldRefs=_.pluck(value,"_ref");recordRefs.length===formFieldRefs.length&&recordRefs.length===_.union(recordRefs,formFieldRefs).length||record.set(fieldName,value)},_setFieldIfChanged:function(record,field,fieldName,value){var recordField=record.getField(fieldName);if(recordField){recordField.convert&&(value=recordField.convert(value,record));var originalValue=this._getOriginalValue(fieldName);originalValue&&originalValue._ref&&originalValue._ref===value||_.isEqual(originalValue,value)||(record.set(fieldName,value),this._setOriginalValue(fieldName,value))}},_isChangeValid:function(record,field,fieldName){if(field.store&&(field.store.isLoading()||0===field.store.getCount()))return!1;var recordField=record.getField(fieldName);return!!Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(recordField,record)&&(!(_.isFunction(field.isValid)&&!field.isValid())&&(!Rally.ui.detail.DetailHelper.isFieldEmpty(field)||!Rally.ui.detail.DetailHelper.isDetailPageFieldRequired(recordField,record)))},getAttachmentsStore:function(){return this._attachmentStore}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.LikertScale",{extend:Ext.container.Container,alias:"widget.rallylikertscale",id:"likertscale",mixins:{observable:Ext.util.Observable},initComponent:function(){this.addEvents("likertfeedback"),this.on("likertfeedback",function(score){Ext.select("#likertscale .circle").removeCls("circle-selected"),Ext.select("#likertscale #circle_"+score+" .circle").addCls("circle-selected")}),this.callParent(arguments)},items:{border:0,cls:"likert-survey",items:[{xtype:"component",html:"Please rate your experience with this new feature.",cls:"message",padding:"10 0 10 0"},{xtype:"container",layout:"hbox",defaults:{xtype:"component",padding:"8 0 0 0",listeners:{click:{element:"el",fn:function(){Ext.getCmp("likertscale").fireEvent("likertfeedback",this.id.match(/circle_(\d+)/)[1])}}}},items:[{padding:"0 8 0 8",html:"Extremely<br/>Dissatisfied",style:"text-align: center;"},{html:'<div class="circle"></div>',id:"circle_0"},{html:'<div><div class="dashed-line"></div><div class="circle" style="display: inline-block;"></div><div class="dashed-line"></div></div><div style="text-align: center;">Very<br/>Dissatisfied</div>',id:"circle_1"},{html:'<div class="circle"></div>',id:"circle_2"},{html:'<div><div class="dashed-line"></div><div class="circle" style="display: inline-block;"></div><div class="dashed-line"></div></div><div style="text-align: center;">Dissatisfied</div>',id:"circle_3"},{html:'<div class="circle"></div>',id:"circle_4"},{html:'<div><div class="dashed-line""></div><div class="circle" style="display: inline-block;"></div><div class="dashed-line"></div></div><div style="text-align: center;">Neutral</div>',id:"circle_5"},{html:'<div class="circle"></div>',id:"circle_6"},{html:'<div><div class="dashed-line"></div><div class="circle" style="display: inline-block;"></div><div class="dashed-line"></div></div><div style="text-align: center;">Satisfied</div>',id:"circle_7"},{html:'<div class="circle"></div>',id:"circle_8"},{html:'<div><div class="dashed-line"></div><div class="circle" style="display: inline-block;"></div><div class="dashed-line"></div></div><div style="text-align: center;">Very<br/>Satisfied</div>',id:"circle_9"},{html:'<div class="circle"></div>',id:"circle_10"},{html:"Extremely<br/>Satisfied",padding:"0 8 0 8",style:"text-align: center"}]}]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.FeedbackDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallyfeedbackdialog",componentCls:"feedback-dialog",closable:!1,title:"Before you switch...",titleIconHtml:'<span aria-hidden="true" class="icon-feedback"></span>&nbsp;',message:"Please tell us why you are switching back so that we can continue to improve this new page.",saveButtonText:"Submit Feedback",cancelButtonText:"Skip",skipButtonText:null,placeholder:"",likertEnabled:!0,subject:"",feedbackId:"",action:"",helpInfo:null,initComponent:function(){this.callParent(arguments);var width=600,buttonPadding="4 12",textAreaPadding="0 20 0 20",messagePadding="15 0 0 0";if(this.addCls("new-ux"),this.likertEnabled){var likertScale=Ext.create("Rally.ui.dialog.LikertScale");this.add(likertScale),likertScale.on("likertfeedback",function(score){var form=this.up("window").down("form");form.down("#likertScore").setValue(score)})}this.add({xtype:"component",html:this.message,cls:"message",padding:messagePadding});var buttons=[{xtype:"container",itemId:"footer-left",cls:"footer-left",flex:1},{xtype:"rallybutton",cls:"feedback-submit-btn primary rly-small",itemId:"submit",text:this.saveButtonText,formBind:!0,disabled:!0,handler:this._onSubmit,scope:this,padding:buttonPadding},{xtype:"rallybutton",cls:"feedback-cancel-btn secondary rly-small",text:this.cancelButtonText,handler:this._onCancel,scope:this,padding:buttonPadding}];this.skipButtonText&&buttons.push({xtype:"rallybutton",cls:"feedback-skip-btn secondary rly-small",text:this.skipButtonText,handler:this._onSkip,scope:this,padding:buttonPadding}),buttons.push({xtype:"container",flex:1,itemId:"footer-right",cls:"footer-right"});var form=this.add({xtype:"form",cls:"form",url:Rally.environment.getServer().contextPath+"/feedback.sp",width:width,layout:"anchor",defaults:{anchor:"100%"},buttonAlign:"center",buttons:buttons});this.likertEnabled&&form.add({xtype:"textfield",hidden:!0,name:"likertScore",itemId:"likertScore",value:"",allowBlank:!1}),this.helpInfo&&form.down("#footer-right").add({xtype:"component",html:Rally.util.Help.getLinkTag(this.helpInfo)}),form.add({xtype:"hiddenfield",name:"subject",value:this._getSubject()}),form.add({xtype:"hiddenfield",name:"feedbackId",value:this._getFeedbackId()}),form.add({xtype:"hiddenfield",name:"action",value:this.action});var browserInfo=this._getBrowserInfo();form.add({xtype:"hiddenfield",name:"browserName",value:browserInfo.name}),form.add({xtype:"hiddenfield",name:"browserVersion",value:browserInfo.version}),this.textArea=form.add({xtype:"textareafield",name:"comment",allowBlank:!0,invalidCls:"",preventMark:!0,height:100,padding:textAreaPadding}),this.on("afterrender",this._onAfterRender,this)},_onAfterRender:function(){this.textArea.getEl().down("textarea").set({placeholder:this.placeholder})},_getSubject:function(){if(Ext.isEmpty(this.subject))throw new Error("FeedbackDialog: No subject provided");return this.subject},_getFeedbackId:function(){return this.feedbackId},_onSubmit:function(){var form=this.down("form").getForm();form.isValid()&&form.submit({success:function(){
this.fireEvent("feedbacksubmitted"),"switchback"!==this.action&&Rally.ui.notify.Notifier.show({message:"Thank you for your feedback."}),this.destroy()},failure:function(){},scope:this})},_onCancel:function(){this.fireEvent("feedbackcancelled"),this.destroy()},_onSkip:function(){this.fireEvent("feedbackskipped"),this.destroy()},_getBrowserInfo:function(){return Ext.isChrome?{name:"Chrome",version:Ext.chromeVersion}:Ext.isIE?{name:"IE",version:Ext.ieVersion}:Ext.isSafari?{name:"Safari",version:Ext.safariVersion}:Ext.isGecko?{name:"FF",version:Ext.firefoxVersion}:{name:"Unknown",version:0}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.feedback.Feedback",{extend:Ext.container.Container,alias:"widget.rallyfeedback",cls:"feedbackcontainer",feedbackButtonConfig:{},feedbackDialogConfig:{},defaultDialogConfig:{message:"Please share your feedback with us.",placeholder:"What do you like? How can we improve?",saveButtonText:"Send",cancelButtonText:"Cancel",title:"",subject:"",feedbackId:"",autoShow:!0},initComponent:function(){this.callParent(arguments),this.addButtons(),this.feedbackDialogConfig=Ext.merge({action:"feedback"},this.defaultDialogConfig,this.feedbackDialogConfig)},destroy:function(){this.feedbackDialog&&this.feedbackDialog.destroy(),this.callParent(arguments)},addButtons:function(){this.add(Ext.apply({xtype:"rallybutton",itemId:"feedback",cls:"feedback highlight rly-small small-icon",text:"Feedback",iconCls:"icon-feedback",handler:this._showFeedbackDialog,scope:this},this.feedbackButtonConfig))},getFeedbackDialog:function(){return this.feedbackDialog},_showFeedbackDialog:function(){this._showDialog(this.feedbackDialogConfig)},_showDialog:function(config){this.feedbackDialog&&this.feedbackDialog.destroy(),this.feedbackDialog=Ext.create("Rally.ui.dialog.FeedbackDialog",config)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.feedback.FeedbackAndSwitchback",{extend:Rally.ui.feedback.Feedback,cls:"feedbackandswitchback",switchbackDialogConfig:void 0,initComponent:function(){this.callParent(arguments),this.addEvents(["beforeswitchback","switchback"]),this.enableBubble(["beforeswitchback","switchback"]),this.switchbackDialogConfig&&(this.switchbackDialogConfig=Ext.merge({action:"switchback"},this.defaultDialogConfig,this.switchbackDialogConfig))},addButtons:function(){this.callParent(arguments),this.switchbackDialogConfig&&this.add({xtype:"rallybutton",itemId:"switchback",cls:"switchback secondary rly-small",text:"Switch Back",handler:this._switchBack,scope:this})},_showSwitchbackDialog:function(){this._showDialog(this.switchbackDialogConfig)},_switchBack:function(){this.fireEvent("beforeswitchback")&&(this._showSwitchbackDialog(),this.mon(this.feedbackDialog,"feedbackskipped",this._onSwitchbackComplete,this),this.mon(this.feedbackDialog,"feedbacksubmitted",this._onSwitchbackComplete,this))},_onSwitchbackComplete:function(){this.fireEvent("switchback")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.FeedbackMetaField",{extend:Rally.ui.feedback.FeedbackAndSwitchback,alias:"widget.rallydetailfeedbackmetafield",layout:{type:"hbox",pack:"end"},config:{subject:void 0,feedbackId:"editabledetailpages",showSwitchback:!0},feedbackDialogConfig:{title:"Feedback on Editable Detail Pages Beta"},constructor:function(config){this.initConfig(config),this.callParent(arguments)},initComponent:function(){var dialogConfig={subject:this.getSubject(),feedbackId:this.getFeedbackId()};this.feedbackDialogConfig=Ext.merge(this.feedbackDialogConfig,dialogConfig),this.getShowSwitchback()&&(this.switchbackDialogConfig=Ext.merge({title:"Why Are You Switching Back?",skipButtonText:"Skip"},dialogConfig)),this.callParent(arguments)},addButtons:function(){this.callParent(arguments),this.add({xtype:"rallybutton",itemId:"edpHelp",cls:"edp-help",iconCls:"icon-help",href:"https://help.rallydev.com/creating-user-story#detail"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.AddNewTag",{extend:Ext.AbstractPlugin,alias:"plugin.rallyaddnewtag",init:function(component){this.callParent(arguments),this.cmp.on("datachanged",this._onDataChanged,this)},_onDataChanged:function(){this._hideAddNew(),this._shouldShowAddNew()&&this._showAddNew()},_shouldShowAddNew:function(){return this.cmp.isValid()&&this.cmp.picker&&""!==this.cmp.getInputTextValue()&&!this.cmp.containsExactMatch()},_showAddNew:function(){this.addNewComponent=this.cmp.picker.insert(1,{xtype:"component",itemId:"addNew",cls:"rui-tag-picker-add-new-component",renderTpl:'<a href="#" onclick="return false;" class="rui-tag-picker-add-new"><span class="rui-multi-object-match">{tagName}</span> (create new)</a>',renderData:{tagName:Ext.String.htmlEncode(this.cmp.getInputTextValue())},renderSelectors:{addNewLink:"a.rui-tag-picker-add-new"},listeners:{afterrender:function(cmp){cmp.mon(cmp.addNewLink,"click",this._onAddNewClick,this)},scope:this}})},_hideAddNew:function(){this.addNewComponent&&this.addNewComponent.destroy(),delete this.addNewComponent},_onAddNewClick:function(e){var tag=new this.cmp.store.model({Name:this.cmp.getInputTextValue(),Workspace:"/workspace/"+Rally.environment.getContext().getWorkspace().ObjectID});tag.save({requester:this.cmp,callback:this._onTagSave,scope:this,params:{fetch:"Name"}})},_onTagSave:function(record){record&&this.cmp.addRecord(record).then(this.cmp.select(record)),this.cmp.refreshView(),this.cmp.focus()}})}(),function(){var Ext=window.Ext4||window.Ext,htmlCharsTest=/^[^\|<>]*$/;Ext.apply(Ext.form.field.VTypes,{htmlChars:function(val,field){return htmlCharsTest.test(val)},htmlCharsText:"Cannot contain |, < or > characters."}),Ext.define("Rally.ui.picker.TagPicker",{extend:Rally.ui.picker.CollectionPicker,alias:"widget.rallytagpicker",mixins:{toolTippable:Rally.ui.tooltip.ToolTippable},clientMetrics:[{beginMethod:"_addNew",endMethod:"_onTagSave",description:"new tag created"},{method:"_onAddNewClick",description:"add new tag clicked"},{beginMethod:"expand",endMethod:"refreshView",description:"tagpicker loaded"}],config:{toolTipConfig:void 0,emptyText:"Search Tags",selectedTextLabel:"Selected Tags",availableTextLabel:"Available Tags",listCfg:{emptyText:'<div class="rui-multi-object-picker-empty-text">Type to add a tag</div>',componentCls:"change-to-browser-test-class"},toolTipPreferenceKey:"tooltip.tagpicker.starttyping",showToolTipWithPreference:!1,storeConfig:{fetch:["Archived","ObjectID","Name"]},maxLength:32,modelType:"Tag",vtype:"htmlChars",enableAddNew:!0},constructor:function(config){this.mergeConfig(config),this.plugins=this.enableAddNew?[{ptype:"rallyaddnewtag"}]:[],this.callParent([this.config])},getBaseFilter:function(){var userSelectedOids=_.invoke(this.getValue(),"get","ObjectID");if(this.remoteFilter){var notArchived={property:"Archived",value:!1},userSelected=_.map(userSelectedOids,function(tagOid){return{property:"ObjectID",value:tagOid}});return Rally.data.wsapi.Filter.or([notArchived].concat(userSelected))}return{filterFn:function(tagRecord){return tagRecord.get("Archived")===!1||_.contains(userSelectedOids,tagRecord.get("ObjectID"))}}},initEvents:function(){this.callParent(arguments),this.on("blur",this._onBlur,this)},mimicBlur:function(e){var picker=this.picker,toolTip=this.toolTip;if((!picker||!e.within(picker.el,!1,!0)&&!this.isEventWithinPickerLoadMask(e))&&toolTip&&toolTip.el){var closeQuery=Ext.query("."+Ext.baseCSSPrefix+"tool-close",toolTip.el.dom);closeQuery.length>0&&e.within(closeQuery[0],!1,!0)&&toolTip.close()}this.callParent(arguments)},getRowTextCls:function(recordData){var cls=this.callParent(arguments);return recordData.Archived&&(cls+=" tag-archived"),cls},onDestroy:function(){this.toolTip&&this.toolTip.destroy(),this.callParent(arguments)},_onFocus:function(){this.callParent(arguments),this.buildToolTip()},_onBlur:function(){this.toolTip&&this.toolTip.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.TagFilter",{alias:"widget.rallytagfilter",extend:Rally.ui.picker.TagPicker,itemId:"tagfilter",cls:"tagfilter",filterLabel:"tags",config:{emptyText:"Select Tags",pickerCfg:{style:{border:"1px solid #DDD","border-top":"none"},cls:"tagfilter-picker"},listCfg:{emptyText:'<div class="rui-multi-object-picker-empty-text">No matching tag</div>',cls:"tagfilter-list"},storeConfig:{limit:10,pageSize:10,sorters:[{property:"Name",direction:"ASC"}]},pickerOffset:[-1,1]},triggerCls:"icon-search",constructor:function(config){config.enableGrouping=!1,config.enableAddNew=config.enableAddNew||!1,config.hideTrigger=!1,this.callParent(arguments)},initComponent:function(){this._setValueFromFilter(),this.on("expand",this._onFirstExpand,this,{single:!0}),this.on("afterrender",this._afterRender,this,{single:!0}),this.on("focus",this._onFocus,this),this.on("blur",this._onBlur,this),this.callParent()},getFilter:function(){var selected=this.getValue();return Ext.isEmpty(selected)?null:Ext.create("Rally.data.wsapi.filter.TagFilter",{value:selected})},onTriggerClick:function(){},_setValueFromFilter:function(){var tagRefs=this._getTagsFromFilter();Ext.isEmpty(tagRefs)||Ext.create("Rally.data.wsapi.RefsToRecords").convert(tagRefs,{requester:this}).then({success:function(records){this.setValue(records)},scope:this})},_getTagsFromFilter:function(){var filter=this.storeFilter||{},tagFilter=filter[this.itemId];return Ext.isEmpty(tagFilter)?[]:Rally.data.wsapi.filter.TagFilter.parseTagRefs(tagFilter)},_onFirstExpand:function(){this.store&&this.store.on("filterbytextinput",this._onFilter,this)},_onFilter:function(){var value=this.getInputTextValue();_.isEmpty(value)&&this.collapse()},_afterRender:function(){this.mon(this.inputEl,"mouseover",this._onMouseOver,this),this.mon(this.inputEl,"mouseout",this._onMouseOut,this),this.focusPlaceholderText(),this.buildToolTip()},_onMouseOver:function(){this.addCls("tagfilter-hover")},_onMouseOut:function(){this.removeCls("tagfilter-hover")},_onFocus:function(){this.addCls("tagfilter-focus")},_onBlur:function(){this.removeCls("tagfilter-focus"),this.collapse()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.TagsMetaField",{extend:Ext.container.Container,alias:"widget.rallydetailtagsmetafield",statics:{enableTagPopover:function(){return!1}},cls:"detailFieldContainer detailTagContainer",items:[{xtype:"container",itemId:"chooserContainer"},{xtype:"component",itemId:"tagList",autoEl:"ul"}],config:{record:void 0},initComponent:function(){Rally.ui.detail.DetailHelper.isDetailPageFieldRequired(this.record.getField("Tags"),this.record)&&(this.cls+=" requiredField"),this.readOnly=!Rally.ui.detail.EditModeContext.isPageEditable(this.record),this.callParent(arguments),this.tagStore=this.record.getCollection("Tags"),this.tagsLink=this.down("#chooserContainer").add({xtype:"component",cls:"loading",itemId:"chooser",renderTpl:this._getTagsRenderTpl(this.readOnly,this.tagStore.getTotalCount()),renderSelectors:{link:"a"},listeners:{click:{element:"link",fn:this.drawTagPicker,stopEvent:!0},scope:this},style:{clear:"both",marginBottom:"5px"}}),this.addEvents({tagsUpdated:!0}),this.loadTagStore()},loadTagStore:function(){this.tagStore.load({callback:function(tags){this.isDestroyed||(this.enableAddLink(),this.drawTagPills(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this))},scope:this})},enableAddLink:function(){this.tagsLink.removeCls("loading")},drawTagPills:function(){var tagList=this.down("#tagList");if(tagList){var sortedTags=_.sortBy(this.tagStore.getRange(),function(tag){return tag.get("Name")}),tagPills=_.map(sortedTags,function(tag){return'<li class="tagField" data-tag-id="'+tag.getId()+'"><span class="tagPill'+(this.readOnly?" readonly":"")+(this.self.enableTagPopover()?" popoverEnabled":"")+'">'+tag.get("Name")+(this.readOnly?"":'<span class="icon-cancel"></span>')+"</span></li>"},this),tagListEl=tagList.getEl();tagListEl.setHTML(tagPills.join("")),this.self.enableTagPopover()&&Ext.get(tagListEl.query(".tagField")).on("click",this._openTagPopover,this),Ext.get(tagListEl.query(".icon-cancel")).on("click",this._removeTag,this)}},_openTagPopover:function(e,el){var tagFieldEl=Ext.fly(el).up(".tagField"),tagId=parseInt(tagFieldEl.getAttribute("data-tag-id"),10),record=this._getTagById(tagId);Ext.create("Rally.ui.popover.TagPopover",{target:el,name:record.get("Name"),ref:record.get("_ref")})},_getTagById:function(id){var index=this.tagStore.indexOfId(id);return this.tagStore.getAt(index)},_removeTag:function(event,el){var tagFieldEl=Ext.fly(el).up(".tagField"),tagId=parseInt(tagFieldEl.getAttribute("data-tag-id"),10);return this.tagStore.remove(this._getTagById(tagId)),this._syncStore(),event.stopEvent(),!1},_syncStore:function(){this.tagStore.sync({success:function(){this.fireEvent("tagsUpdated",this),this.drawTagPills()},scope:this})},drawTagPicker:function(){this.tagStore.isLoading()||(this.tagsLink.hide(),this.tagPicker=this.down("#chooserContainer").add({xtype:"rallytagfilter",itemId:"chooser",emptyText:"Begin typing...",remoteFilter:!0,enableAddNew:!0,listeners:{blur:this._onTagPickerBlur,scope:this},toolTipConfig:{html:'<h3 class="tooltip-heading">Tag Picker Tip</h3><div class="tooltip-text">Start typing in the box to create a tag.</div>',destroyAfterHide:!0,showOnClick:!0,toolTipPreferenceKey:"tooltip.tagpicker.starttyping",showToolTipWithPreference:!1}}),this._fixBlurEvents(),this.tagPicker.setValue(this.tagStore.getRange()),this.tagPicker.focus())},_fixBlurEvents:function(){Ext.getDoc().on("click",this._manuallyBlurPicker,this)},_manuallyBlurPicker:function(e){var eventOutsideOfText=!e.within(this.tagPicker.getEl()),picker=this.tagPicker.picker,eventOutsideOfList=!!_.isUndefined(picker)||picker&&!e.within(picker.getEl());eventOutsideOfText&&eventOutsideOfList&&(this._onTagPickerBlur(this.tagPicker),Ext.getDoc().un("click",this._manuallyBlurPicker,this))},_onTagPickerBlur:function(tagPicker){var newTags=_.sortBy(tagPicker.getValue(),function(tag){return tag.get("Name")}),oldTags=this.tagStore.getRange();if(tagPicker.destroy(),this.tagsLink.show(),!this._tagsAreTheSame(newTags,oldTags)){var existingTagRefs=_.map(oldTags,Rally.util.Ref.getRelativeUri,Rally.util.Ref),newTagRefs=_.map(newTags,Rally.util.Ref.getRelativeUri,Rally.util.Ref),added=_.difference(newTagRefs,existingTagRefs),removed=_.difference(existingTagRefs,newTagRefs);this._addTags(newTags,added),this._removeTags(oldTags,removed),this._syncStore()}},_addTags:function(newTags,added){var newTagsMap=_.reduce(newTags,this._mapRefToObject,{});this.tagStore.add(_.map(added,function(ref){return newTagsMap[ref]},this))},_removeTags:function(oldTags,removed){var oldTagsMap=_.reduce(oldTags,this._mapRefToObject,{});this.tagStore.remove(_.map(removed,function(ref){return oldTagsMap[ref]},this))},_mapRefToObject:function(currentMap,nextValue){return currentMap[nextValue.get("_ref")]=nextValue,currentMap},_tagsAreTheSame:function(newTags,oldTags){var existingTagRefs=_.map(oldTags,Rally.util.Ref.getRelativeUri,Rally.util.Ref),newTagRefs=_.map(newTags,Rally.util.Ref.getRelativeUri,Rally.util.Ref);return existingTagRefs.length===newTagRefs.length&&Ext.Array.intersect(existingTagRefs,newTagRefs).length===existingTagRefs.length},_getTagsRenderTpl:function(readOnly,recordCount){var tagsRenderTpl='<span class="legend">TAGS</span>';return readOnly?recordCount||(tagsRenderTpl+='<span class="readonly">No tags</span>'):tagsRenderTpl+='<a href="#">add</a>',tagsRenderTpl}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.SingleValueMetaField",{extend:Ext.container.Container,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},alias:"widget.rallysinglevaluemetafield",clientMetrics:[{event:"fieldupdated",description:"field updated"}],html:'<span class="legend metaFieldLabel"></span><span class="prefix"></span><span class="renderHtml"></span>',cls:"detailFieldContainer singleValueMetaField",doesNotHavePropertyTpl:'<span class="metaFieldLinks"><a href="#" class="metaFieldChoose">choose one</a></span>',doesNotHavePropertyReadOnlyTpl:"",hasPropertyDescriptionText:"",hasPropertyTpl:'<a href="{hash}">{linkText}</a><span class="metaFieldLinks"><a href="#" class="metaFieldClear">clear</a> | <a href="#" class="metaFieldChoose">change</a></span>',hasPropertyReadOnlyTpl:"",possiblePropertyTypes:[],property:void 0,record:void 0,label:"",config:{doesNotHavePropertyDescriptionText:"",controller:void 0},initComponent:function(){this.formattedIDRenderer=Ext.create("Rally.ui.renderer.template.FormattedIDTemplate",{renderIdAsText:!0}),this.enableBubble(["fieldupdated","fieldchanged"]),this.addEvents("onmodelsloaded"),this.callParent(arguments),this.on("afterrender",this._retrieveRequiredModels,this),this.getController()&&this.getController().on("recordupdate",this._updateRecord,this),this.fieldName=this.property,Rally.ui.detail.DetailHelper.isDetailPageFieldRequired(this.record.getField(this.fieldName),this.record)&&(this.addCls("requiredField"),this.clearable=!1)},_updateRecord:function(record){this.record=record},getClearLink:function(){return this.getEl().down(".metaFieldClear")},getChooseLink:function(){return this.getEl().down(".metaFieldChoose")},_retrieveRequiredModels:function(){Rally.data.ModelFactory.getModels({types:this.possiblePropertyTypes,success:this._onModelsLoaded,scope:this})},_onModelsLoaded:function(models){this.fireEvent("onmodelsloaded",models);var propertyValue=this._getPropertyValue(),readOnly=this.isReadOnly();return propertyValue?void this._getPropertyModel(models,propertyValue).load(Rally.util.Ref.getOidFromRef(propertyValue),{success:function(record){this.propertyRecord=record,this._draw(this.label,this.hasPropertyDescriptionText,readOnly?this._getHasPropertyReadOnlyRenderHTML(this._getRenderData(record)):this._getHasPropertyRenderHTML(this._getRenderData(record)))},scope:this}):(this._draw(this.label,this.doesNotHavePropertyDescriptionText,readOnly?this._getDoesNotHavePropertyReadOnlyRenderHTML():this._getDoesNotHavePropertyRenderHTML()),void(this.isDestroyed||this.addCls("empty")))},isReadOnly:function(){return!Rally.ui.detail.EditModeContext.isPageEditable(this.record)},_getPropertyValue:function(){return this.record.get(this.property)},_getPropertyModel:function(models,propertyValue){var type=Rally.util.Ref.getTypeFromRef(propertyValue),model=models[type];return model},_getRenderData:function(propertyRecord){return{}},_getDoesNotHavePropertyRenderHTML:function(){return this.doesNotHavePropertyTpl},_getHasPropertyRenderHTML:function(renderData){return this.hasPropertyTpl},_getDoesNotHavePropertyReadOnlyRenderHTML:function(){return this.doesNotHavePropertyReadOnlyTpl},_getHasPropertyReadOnlyRenderHTML:function(renderData){return this.hasPropertyReadOnlyTpl},_draw:function(label,prefix,renderHtml){this.isDestroyed||(this.getEl().down(".legend").setHTML(label),this.getEl().down(".prefix").setHTML(prefix),this.getEl().down(".renderHtml").setHTML(renderHtml),this._attachListeners(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this))},_attachListeners:function(){this.getClearLink()&&this.getClearLink().on("click",this._clear,this,{stopEvent:!0}),this.getChooseLink()&&this.getChooseLink().on("click",this._choose,this,{stopEvent:!0})},_clear:function(){this.recordAction({description:this.property+" field cleared"}),this._setPropertyValue(null),this.propertyRecord=null},_choose:function(){this.recordAction({description:this.property+" chooser dialog opened"}),this.choose()},choose:Ext.emptyFn,_getGridColumns:function(){var me=this;return[{text:"ID",dataIndex:"FormattedID",renderer:function(value,metaData,record,rowIndex,colIndex,store,view){return me.formattedIDRenderer.apply(record.data)}},"Name","Project"]},_setPropertyValue:function(value){this.value=value,value?this.removeCls("empty"):this.addCls("empty"),this.fireEvent("fieldchanged",this),this.record.get("updatable")?this.fireEvent("fieldupdated",{field:this,success:function(record){this.record=record,this._retrieveRequiredModels()},scope:this}):(this.record.set(this.property,value),this._retrieveRequiredModels())},getSubmitData:function(){var data={};return data[this.property]=this.value,data},getValue:function(){return this.value},getName:function(){return this.property},assignValue:function(dialog,newValue){if(newValue){var value=newValue.data;this._setPropertyValue(value)}},setDoesNotHavePropertyDescriptionText:function(text){this.doesNotHavePropertyDescriptionText='<span class="metaFieldValue">'+text+"</span>",this.isReadOnly()&&(this.doesNotHavePropertyDescriptionText='<span class="metaFieldValue readonly">'+this.doesNotHavePropertyDescriptionText+"</span>")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.TestCaseMetaField",{extend:Rally.ui.detail.metafield.SingleValueMetaField,alias:"widget.rallydetailtestcasemetafield",plugins:[{xclass:"Rally.ui.detail.plugins.SingleValueMetaFieldLabel"}],property:"TestCase",possiblePropertyTypes:["testcase"],label:"TEST CASE",_getRenderData:function(propertyRecord){return{hash:"#/detail/"+propertyRecord.self.prettyTypeName+"/"+propertyRecord.get("ObjectID"),linkText:propertyRecord.get("FormattedID")+" - "+propertyRecord.get("Name")}},choose:function(){var project=this.record.get("Project");Ext.create("Rally.ui.dialog.ArtifactChooserDialog",{title:"Choose Test Case",artifactTypes:this.possiblePropertyTypes,autoShow:!0,listeners:{artifactChosen:this.assignValue,scope:this},storeConfig:{context:{project:project._ref||project}},columns:this._getGridColumns(),selectedRef:this.record.get(this.property)&&this.record.get(this.property)._ref})},_getHasPropertyRenderHTML:function(renderData){return'<a href="'+renderData.hash+'">'+renderData.linkText+'</a><span class="metaFieldLinks"><a href="#" class="metaFieldClear">clear</a> | <a href="#" class="metaFieldChoose">change</a></span>'},_getHasPropertyReadOnlyRenderHTML:function(renderData){var html='<a href="'+renderData.hash+'">'+renderData.linkText+"</a>";return html}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.OwnerMetaField",{extend:Rally.ui.detail.FieldsetContainer,alias:"widget.rallydetailownermetafieldedpcomplete",name:"Owner",cls:"detailFieldContainer detailOwnerField",config:{record:void 0},displayName:"OWNER",constructor:function(config){this.initConfig(config),this.setField(this.getRecord().getField("Owner")),this.callParent(arguments)},_drawEditMode:function(){var cls="owner-meta-field";this.editor=this._getOwnerEditor(),this.editor.editable||this._hasOwner(this.getRecord().data)?(this.ownerImage=Ext.create("Ext.Component",{cls:"detail-owner-image",html:'<img src="'+this._getProfileImageSrc(this.getRecord().data)+'">'}),cls+=" has-owner-img"):this.editor.emptyText="-- No Owner --",this.add({xtype:"container",layout:"hbox",cls:cls,items:[this.ownerImage,this.editor]})},_getOwnerEditor:function(){var editor=Rally.ui.detail.view.DetailEditorFactory.getEditor(this.getField(),this.getRecord());return editor.width=240,editor.on("setvalue",this._updateOwnerImage,this),editor.on("expand",function(){this.suspendEvent("fieldchanged"),this.el.down("input").dom.value=""},this),editor.on("collapse",function(){this.resumeEvent("fieldchanged")},this),editor.on("focus",function(){editor.expand()},this),editor},_updateOwnerImage:function(){var imgEl=this.getEl().down("img");imgEl&&imgEl.set({src:this._getProfileImageSrc(this.getRecord().data)})},_getProfileImageSrc:function(recordData){var OWNER_IMAGE_SIZE=31;return this._hasOwner(recordData)?Rally.util.User.getProfileImageUrl(OWNER_IMAGE_SIZE,recordData.Owner):Rally.util.User.getNoOwnerImageUrl()},_hasOwner:function(recordData){return _.isEmpty(recordData.Owner)===!1},getSubmitData:function(){return{Owner:this.editor.getValue()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.RichTextDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallyrichtextdialog",closable:!0,stateful:!1,cls:"rallyRichTextDialog",config:{record:void 0,fieldName:void 0,text:"",maxLength:-1,headerItems:[],editorMaxHeight:800},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){window.dialog=this,this.callParent(arguments),this.addEvents(["beforerecordsave","save","load"]),this.drawHeader(),this.drawEditor(),this.drawFooter()},drawHeader:function(){this.add(this.getHeaderItems())},drawEditor:function(){this.record&&(this.text=this.record.get(this.fieldName)),this.add({xtype:"rallyrichtexteditor",maxHeight:this.editorMaxHeight,value:this.text,allowLinking:!1,listeners:{change:this._updateRecord,load:this._onEditorLoad,scope:this}})},drawFooter:function(){this.addDocked({xtype:"toolbar",dock:"bottom",layout:{type:"hbox",pack:"center"},ui:"footer",itemId:"footer",items:[{xtype:"rallybutton",text:"Save",cls:"richTextDialogSave primary rly-small",handler:function(){this._save()},scope:this},{xtype:"rallybutton",text:"Cancel",ui:"link",cls:"richTextDialogCancel secondary rly-small",handler:function(){this.close()},scope:this}]})},_onEditorLoad:function(){this.fireEvent("load")},_updateRecord:function(editor,newValue){var saveButton=this.down("rallybutton[text=Save]");this._getMaxLength()&&newValue.length>this._getMaxLength()?saveButton.disable():(saveButton.isDisabled()&&saveButton.enable(),this.text=newValue)},_getMaxLength:function(){var maxLength=this.maxLength;if(this.record&&(maxLength=this.getRecord().getField(this.getFieldName()).attributeDefinition.MaxLength),maxLength&&maxLength!==-1)return maxLength},_save:function(){if(this.record){var previousText=this.record.get(this.fieldName);this.record.set(this.fieldName,this.text),this.fireEvent("beforerecordsave",this.record)!==!1?this.getRecord().save({success:function(){this.fireEvent("save",this.record),this.close()},scope:this}):this.record.set(this.fieldName,previousText)}else this.fireEvent("save",this.text),this.close()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.CommentsMetaField",{extend:Rally.ui.detail.FieldContainer,alias:"widget.rallydetailcommentsmetafield",cls:"commentsMetaField detailFieldContainer",initComponent:function(){this.callParent(arguments)},constructor:function(config){this.initConfig(config),this.setField(this.getRecord().getField("Discussion")),this.callParent(arguments)},_drawEditMode:function(){var discussion=this.getRecord().get("Discussion"),discussionCount=discussion?discussion.Count:0,url=location.href+"/discussion",readonly='<div class="discussion discussionBubble">{discussionCount}</div>',editable='<a href="{url}">'+readonly+"</a>";this.add({xtype:"component",renderTpl:'<span class="legend">DISCUSSION</span>'+(this.getRecord().phantom?readonly:editable)+'<a href="{url}">view</a>',renderData:{discussionCount:discussionCount,url:url}}),this.add({xtype:"rallydiscussionrichtextstreamview",artifact:this.getRecord(),showArtifactDetail:!1,allowReply:!1,allowDelete:!1,autoScroll:!1,profileImageSize:35,maxLines:2,includeShowMore:!1,emptyText:'<div class="no-data">  <p>There are no posts</p></div>',statusTpl:'<a class="profileLink" href="#"><span class="{nameCls}">{User._refObjectName}</span></a> {createdAt}',storeConfig:{context:{project:null},limit:1,pageSize:1,filters:[{property:"Artifact",operation:"=",value:this.getRecord().get("_ref")}]},listeners:{viewready:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.fireEvent("aftercontentrender",this)},scope:this}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.ProjectMetaField",{extend:Rally.ui.detail.FieldsetContainer,alias:"widget.rallydetailprojectmetafieldedpcomplete",config:{record:void 0},constructor:function(config){this.bubbleEvents.push("projectchanged"),this.initConfig(config);var field=this.getRecord().getField("Project")||this.getRecord().getField("TargetProject");this.setField(field),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.editor.on("select",function(){this.getRecord().phantom&&this.getRecord().set(this.editor.getSubmitData()),this.fireEvent("projectchanged")},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.plugins.ArtifactTypeFilter",{alias:"plugin.rallyartifacttypefilter",extend:Rally.ui.dialog.plugins.ArtifactFilterPlugin,typeFilter:void 0,typeSpecificFilters:{},init:function(){this.callParent(arguments),this.cmpGetGridModels=this.cmp.getGridModels,this.cmp.getGridModels=Ext.bind(this._getGridModels,this)},getSearchBarItem:function(){if(_.isArray(this.cmp.artifactTypes)&&this.cmp.artifactTypes.length>1)return{xtype:"rallycombobox",cls:"chooser-search-type-combo",itemId:"typeChooser",fieldLabel:"Type",labelAlign:"top",queryMode:"local",displayField:"name",valueField:"type",forceSelection:!0,editable:!1,value:this.typeFilter||"All",store:{fields:["type","name"],data:this._buildTypeChooserData()},listeners:{change:this.cmp.buildGrid,scope:this.cmp}}},getStoreFilters:function(){var storeFilters=this.callParent(),filter=this.typeSpecificFilters[this._getTypeChooserValue()];return filter&&storeFilters.push(filter),storeFilters},_buildTypeChooserData:function(){var typeMap={hierarchicalrequirement:{type:"hierarchicalrequirement",name:"User Story"},defect:{type:"defect",name:"Defect"},defectsuite:{type:"defectsuite",name:"Defect Suite"},testcase:{type:"testcase",name:"Test Case"},testset:{type:"testset",name:"Test Set"}};return _.compact([{type:"All",name:"All"}].concat(_.map(this.cmp.artifactTypes,function(typeName){if(typeMap[typeName])return typeMap[typeName];var matches=new RegExp("portfolioitem/(.*)").exec(typeName);return matches?{type:typeName,name:Ext.String.capitalize(matches[1])}:void 0},this)))},_getGridModels:function(){return"All"===this._getTypeChooserValue()?this.cmpGetGridModels.call(this.cmp):[this._getTypeChooserValue()]},_getTypeChooserValue:function(){var typeChooser=this.cmp.down("#typeChooser");return typeChooser?typeChooser.getValue():"All"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.ParentMetaField",{extend:Rally.ui.detail.metafield.SingleValueMetaField,alias:"widget.rallydetailparentmetafield",clearable:!0,property:"Parent",label:"PARENT",config:{storeConfig:{},typeSpecificFilters:{}},initComponent:function(){this.enableBubble(["featurechanged"]),this.setDoesNotHavePropertyDescriptionText("No parent"),this.callParent(arguments)},getParentLink:function(){return this.getEl().down("a.parentLink")},_getRenderData:function(propertyRecord){return{clearable:this.clearable,hash:Rally.nav.Manager.getDetailUrl(propertyRecord),parent:propertyRecord.get("FormattedID")+" - "+propertyRecord.get("Name")}},choose:function(){Ext.create("Rally.ui.dialog.ArtifactChooserDialog",{artifactTypes:this.possiblePropertyTypes,autoShow:!0,columns:this._getGridColumns(),fixed:!0,listeners:{artifactChosen:this.assignValue,scope:this},plugins:[{ptype:"rallyartifacttypefilter",typeFilter:this._getPropertyValue()&&this._getPropertyValue()._type&&this._getPropertyValue()._type.toLowerCase(),typeSpecificFilters:this.getTypeSpecificFilters()},"rallyartifactprojectfilter"],selectedRef:this.record.get(this.property)&&this.record.get(this.property)._ref,storeConfig:{filters:_.union([{property:"ObjectID",operator:"!=",value:this.record.get("ObjectID")}],this.getStoreConfig().filters),sorters:[{property:"FormattedID",direction:"ASC"}]},title:"Choose a Parent"})},_getHasPropertyRenderHTML:function(renderData){var html='<a href="'+renderData.hash+'" class="parentLink">'+renderData.parent+'</a><span class="metaFieldLinks">';return this.clearable&&(html=html.concat('<a href="#" class="metaFieldClear">clear</a> | ')),html=html.concat('<a href="#" class="metaFieldChoose">change</a></span>')},_getHasPropertyReadOnlyRenderHTML:function(renderData){var html='<a href="'+renderData.hash+'" class="parentLink">'+renderData.parent+"</a>";return html}})}(),
function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.UserStoryParentMetaField",{extend:Rally.ui.detail.metafield.ParentMetaField,alias:"widget.rallydetailuserstoryparentmetafield",_getPropertyValue:function(){return this.callParent(arguments)||this.record.get("PortfolioItem")},_setPropertyValue:function(value){var parent,portfolioItem;null===value?(parent=null,portfolioItem=null):Rally.util.String.contains(value._ref,"hierarchicalrequirement")?(parent=value,portfolioItem=null):(parent=null,portfolioItem=value),this.record.set("PortfolioItem",portfolioItem),this.callParent([parent])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.ReadyBlockedStatusField",{extend:Ext.form.FieldSet,alias:"widget.rallyreadyblockedstatus",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],componentCls:"detailFieldContainer hasLabel fieldset northfields ready-blocked-status",config:{record:void 0},width:100,bubbleEvents:["fieldupdated"],clientMetrics:[{method:"_onBlockedToggled",description:"blocked button toggled"},{method:"_onReadyToggled",description:"ready button toggled"}],constructor:function(config){this.initConfig(config),this.callParent(arguments);var showBlocked=this.getRecord().isFieldVisible("Blocked"),showReady=this.getRecord().isFieldVisible("Ready"),readOnly=this._isReadOnly();if(showBlocked){var isBlocked=this.getRecord().get("Blocked");this.blockedButton=Ext.create("Rally.ui.Button",{itemId:"blockedButton",name:"blocked-btn",cls:"button picto tertiary blocked-button",iconCls:"icon-blocked",toolTipText:isBlocked?"Unblock":"Block",enableToggle:!0,pressedCls:"blocked",pressed:isBlocked,toggleHandler:this._onBlockedToggled,scope:this,disabled:readOnly,disabledCls:"readonly",suppressClientMetrics:!0}),this.add(this.blockedButton),this.blockedField=Ext.create("widget.hiddenfield",{name:"Blocked",value:isBlocked})}if(showReady){var isReady=this.getRecord().get("Ready");this.readyButton=Ext.create("Rally.ui.Button",{itemId:"readyButton",name:"ready-btn",cls:"button picto tertiary ready-button",iconCls:"icon-ready",toolTipText:isReady?"Not Ready":"Ready",enableToggle:!0,pressedCls:"ready",pressed:isReady,toggleHandler:this._onReadyToggled,scope:this,disabled:readOnly,disabledCls:"readonly",suppressClientMetrics:!0}),this.add(this.readyButton),this.readyField=Ext.create("widget.hiddenfield",{name:"Ready",value:isReady})}this.getRecord().phantom&&this.subscribe(this,Rally.Message.recordDidChange,this._updateReadyBlockedState,this),this.addListener("beforedestroy",this._onBeforeDestroy,this),(showBlocked||showReady)&&this.setTitle("<legend>STATUS</legend>")},onObjectUpdate:function(updatedRecord){this._updateReadyBlockedState(updatedRecord),this._recordDoneUpdating()},_updateReadyBlockedState:function(record){var showBlocked=record.isFieldVisible("Blocked"),showReady=record.isFieldVisible("Ready");if(showBlocked){var isBlocked=record.get("Blocked");isBlocked!==this.blockedButton.pressed&&this.blockedButton.toggle(isBlocked,!0)}if(showReady){var isReady=record.get("Ready");isReady!==this.readyButton.pressed&&this.readyButton.toggle(isReady,!0)}},initComponent:function(){this.callParent(arguments),this.subscribe(this,Rally.Message.objectWillUpdate,this._recordBeganUpdating,this)},_isReadOnly:function(){var record=this.getRecord();return Rally.data.util.Record.isParent(record)||!Rally.ui.detail.EditModeContext.isPageEditable(record)},_recordBeganUpdating:function(){this._recordIsUpdating=!0},_recordDoneUpdating:function(){this._recordIsUpdating=!1,this.pendingSave&&(this.pendingSave.call(this),delete this.pendingSave)},_whenRecordNotUpdating:function(callback){this._recordIsUpdating?this.pendingSave=callback:callback.call(this)},getSubmitData:function(){return{Blocked:"true"===this._getBlockedValue(),Ready:"true"===this._getReadyValue()}},getValue:function(){return[this.blockedField.getValue(),this.readyField.getValue()]},_getBlockedValue:function(){return this.blockedField?this.blockedField.getValue():null},_getReadyValue:function(){return this.readyField?this.readyField.getValue():null},isEmpty:function(){return!1},updateFinished:function(){this._setButtonsEnabled(!0)},_onBlockedToggled:function(button,isPressed){this._setButtonsEnabled(!1),this.blockedButton.setToolTipText(isPressed?"Unblock":"Block"),isPressed&&this._getReadyValue()&&(this.readyButton.toggle(!1,!0),this.readyField.setValue(!1)),this.getRecord().set("Blocked",isPressed),this.blockedField.setValue(isPressed),this.blockedButton.toolTip.hide(),this._whenRecordNotUpdating(function(){this._fireFieldUpdated(button),this.publish(Rally.Message.recordDidChange,this.getRecord())})},_onReadyToggled:function(button,isPressed){this._setButtonsEnabled(!1),this.readyButton.setToolTipText(isPressed?"Not Ready":"Ready"),isPressed&&this._getBlockedValue()&&(this.blockedButton.toggle(!1,!0),this.blockedField.setValue(!1),this.getRecord().set("Blocked",!1)),this.readyField.setValue(isPressed),this._whenRecordNotUpdating(function(){this._fireFieldUpdated(button),this.publish(Rally.Message.recordDidChange,this.getRecord())},this)},_setButtonsEnabled:function(enabled){this.getRecord().phantom||(this.readyButton&&this.readyButton.setDisabled(!enabled),this.blockedButton&&this.blockedButton.setDisabled(!enabled))},_fireFieldUpdated:function(button){this.fireEvent("fieldupdated",{field:this})},_onBeforeDestroy:function(){this.blockedField&&Ext.destroy(this.blockedField),this.readyField&&Ext.destroy(this.blockedField,this.readyField)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.DefectToUserStoryConverter",{convert:function(defectToConvert){this.record=defectToConvert;var message="Are you sure you want to convert {0} to a User Story?<br/><br/>Any Task, Attachment, or Test Case that has {0} as a Work Product will now be associated with the new User Story and this defect will be closed.";this.confirmationDialog=Ext.create("Rally.ui.dialog.ConfirmDialog",{title:"Confirm User Story Conversion",message:Ext.String.format(message,this.record.get("FormattedID")),confirmLabel:"Convert",modal:!0,listeners:{confirm:this._commitConvertToStory,cancel:Ext.emptyFn,scope:this}})},_commitConvertToStory:function(){Ext.Ajax.request({url:"/slm/df/convertToStory.sp",params:{oid:this.record.get("ObjectID")},method:"POST",success:this._transitionToStory,scope:this})},_transitionToStory:function(response){var obj=Ext.decode(response.responseText),alm="alm";Rally[alm]&&Rally.environment.getMessageBus().subscribe(Rally[alm].Message.contentUpdated,this._showConvertFlare,this,{single:!0}),Rally.nav.Manager.goToRallyPage(Rally.nav.Manager.getDetailHash("/hierarchicalrequirement/"+obj.userStoryOid))},_showConvertFlare:function(){var defectLocation=Rally.nav.Manager.getDetailHash(this.record),message="The conversion is complete. "+this.record.get("FormattedID")+" has been closed and unscheduled.",editLink={text:"Edit Original Defect",scope:this,fn:function(){Rally.nav.Manager.goToRallyPage(defectLocation)}};Rally.ui.notify.Notifier.show({message:message,links:[editLink]})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.DefectDetailController",{extend:Rally.ui.detail.controller.DetailController,config:{defaultOwnerToCurrentUser:!1,useLegacyPrintDialog:!0},initializePhantomRecord:function(record){this.callParent(arguments),this.defaultFieldToCurrentUser(record,"SubmittedBy")},getUpdatableActions:function(){var actions=[],alm="alm";return actions.push({action:"new",label:"New"}),actions.push({action:"copy",label:"Copy"}),actions.push({action:"print",label:"Print"}),Rally[alm]&&actions.push({action:"convert",label:"Convert to User Story"}),actions.push({action:"delete",label:"Delete"}),actions},getAssociations:function(){var subPages=[];return this._isAssociationEnabledForSubscription("Defect Suites")&&subPages.push("defectsuites"),this._isAttributeEnabled("Tasks")&&subPages.push("tasks"),this._isAttributeEnabled("TestCases")&&subPages.push("testcases","testrun"),subPages.push("duplicates"),Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.BuildandChangesetEnabled&&subPages.push("changesets"),subPages.push("revisions"),subPages.push("discussion"),subPages},getMetaFields:function(){var metaFields=this.getDefaultMetaFields("Defect Detail");return 1!==Rally.environment.getContext().getSubscription().MaximumProjects&&metaFields.push({xtype:"rallydetailprojectmetafieldedpcomplete"}),this._isAttributeEnabled("Requirement")&&metaFields.push({xtype:"rallydetailparentmetafield",possiblePropertyTypes:["hierarchicalrequirement"],property:"Requirement",label:"USER STORY"}),metaFields.push({xtype:"rallydetailtestcasemetafield"}),this._addTagsMetaField(metaFields),metaFields},getExcludedFields:function(){return this.callParent(arguments).concat(["AcceptedDate","Blocked","BlockedReason","Blocker","DragAndDropRank","InProgressDate","LatestDiscussionAgeInMinutes","LastUpdateDate","Owner","PassingTestCaseCount","PlanEstimate","Project","Rank","Ready","Recycled","Requirement","ScheduleState","ScheduleStatePrefix","State","TaskActualTotal","TaskEstimateTotal","TaskRemainingTotal","TaskStatus","TestCase","TestCaseCount","TestCaseResult","TestCaseStatus"])},getFieldBuckets:function(){var buckets=this.callParent(arguments),defectBucket=this.createStandardFieldBucket("Defect",["Environment","Priority","Severity","SubmittedBy","CreationDate","OpenedDate","ClosedDate","FoundInBuild","FixedInBuild","TargetBuild","VerifiedInBuild","Resolution","TargetDate","ReleaseNote","AffectsDoc","SalesforceCaseID","SalesforceCaseNumber","LastUpdateDate","Package"]);return buckets.splice(1,0,defectBucket),buckets},getNorthFields:function(){var numberFieldRightMargin="0 10 0 0";return _.compact([this._getFieldComponent(this.getRecord().getField("State"),{displayName:"DEFECT STATE",width:170}),this._getFieldComponent(this.getRecord().getField("ScheduleState"),{width:170}),{xtype:"rallyreadyblockedstatus"},this.getRankFieldComponent({margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("PlanEstimate"),{displayName:"Plan Est",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskEstimateTotal"),{displayName:"Task Est",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskRemainingTotal"),{displayName:"To Do",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskActualTotal"),{displayName:"Actual",margin:numberFieldRightMargin})].concat(this.callParent(arguments)))},doAction:function(view,action,params){"convert"===action?this._convertToUserStory():this.callParent(arguments)},_convertToUserStory:function(){Ext.create("Rally.ui.detail.controller.DefectToUserStoryConverter").convert(this.getRecord())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.DeliveryGroupDetailController",{extend:Rally.ui.detail.controller.DetailController,getActions:function(){var actions=[];return actions.push({action:"new",label:"New"}),actions.push({action:"delete",label:"Delete"}),actions.push({action:"print",label:"Print"}),actions},getAssociations:function(){return["deliveryGroupPortfolioItems","revisions"]},getMetaFields:function(){var metaFields=[{xtype:"rallydetailfeedbackmetafield",showSwitchback:!1,subject:"DeliveryGroup"}];return[metaFields]},getExcludedFields:function(){var toExclude=this.callParent(arguments).concat(["CreationDate"]);return toExclude.indexOf("Projects")>-1&&toExclude.splice(toExclude.indexOf("Projects"),1),toExclude},getFieldBuckets:function(){var buckets=this.callParent(arguments);return buckets.splice(1,0,{label:"Projects",fields:["Projects"],growToFillSpace:!0,showFieldLabels:!1}),buckets},getNorthFields:function(){return[]},deleteItem:function(){Ext.create("Rally.ui.dialog.DeleteConfirmDialog",{listeners:{confirm:this._onDeleteClicked,scope:this},record:this.getRecord()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.MilestoneDetailController",{extend:Rally.ui.detail.controller.DetailController,inheritableStatics:{chartsEnabled:!1},getActions:function(){var actions=[];return Rally.environment.getContext().getPermissions().isProjectEditor(Rally.environment.getContext().getProjectRef())&&actions.push({action:"new",label:"New"}),actions.push({action:"print",label:"Print"}),Rally.ui.MilestoneTargetProjectPermissionsHelper.canEdit(this.getRecord())&&actions.push({action:"delete",label:"Delete"}),actions},getAssociations:function(){return["scheduled","revisions"].concat(this.self.chartsEnabled?["chart"]:[])},getMetaFields:function(){var metaFields=[{xtype:"rallydetailfeedbackmetafield",showSwitchback:!1,subject:"Milestone"}];return 1!==Rally.environment.getContext().getSubscription().MaximumProjects&&metaFields.push({xtype:"rallydetailprojectmetafieldedpcomplete",cls:Rally.ui.MilestoneTargetProjectPermissionsHelper.canEdit(this.getRecord())?"":"readonly"}),metaFields},getExcludedFields:function(){return this.callParent(arguments).concat(["CreationDate","Projects","TargetDate","TargetProject","TotalArtifactCount"])},getNorthFields:function(){return _.compact([this._getFieldComponent(this.getRecord().getField("TargetDate"),{width:170})].concat(this.callParent(arguments)))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.PortfolioItemConverter",{validateThenConvert:function(record){var piOid=record.get("ObjectID");Ext.Ajax.request({url:"/slm/portfolioitem/canConvert.sp",params:{piOid:piOid},success:function(response,opts){var responseText=Ext.decode(response.responseText);responseText.isConvertible?this._displayDialogToConvert(record,piOid):this._showCannotConvertMessage(record,responseText.errors)},scope:this})},_showCannotConvertMessage:function(record,errors){var formattedID=record.get("FormattedID"),html='<p style="margin: 0 auto; width: 280px;">Before '+formattedID+" can be converted, please disassociate:</p>";html+='<ul style="margin: 10px 0 10px 150px; width:175px;">',Ext.each(errors,function(error){html+='<li style="list-style: disc inside; text-align: left;">'+error+"</li>"}),html+="</ul>",html+='<div style="color: #666; font-size:11px; margin: 10px auto 0; width: 85%; text-align:center;">Tip: A quick trick is to create a copy of this portfolio item and then convert the copy.</div>';var warning=Ext.create("Rally.ui.dialog.Dialog",{autoShow:!0,draggable:!0,closable:!0,width:400,title:"Cannot Convert Portfolio Item",items:{xtype:"component",html:html,padding:10},buttons:[{text:"Cancel",ui:"link",handler:function(){Ext.destroy(warning)}}],buttonAlign:"center"})},_displayDialogToConvert:function(record,piOid){var currentTypeName=record.get("PortfolioItemType")._refObjectName,formattedID=record.get("FormattedID"),comboBox=this._buildComboBox(currentTypeName),lightbox=Ext.create("Rally.ui.dialog.Dialog",{autoShow:!0,width:350,title:"Convert...",closable:!0,items:[{xtype:"component",tpl:'<div style="font-weight:bold; margin:10px; text-align:center;">Convert "{formattedID}: {name}"</div><div style="text-align: center; margin:10px;">What type would you like to convert this into?</div>',data:{formattedID:formattedID,name:record.get("Name")}},comboBox],buttons:[{text:"Convert",handler:function(){Ext.Ajax.request({url:"/slm/portfolioitem/convertType.sp",params:{piOid:piOid,typeDefOid:comboBox.getRecord().get("ObjectID")},success:function(response,opts){var alm="alm",responseText=Ext.decode(response.responseText);Ext.destroy(lightbox);var flair=currentTypeName+" "+formattedID+" has been converted to "+responseText.displayString+".";Rally.environment.getMessageBus().publish(Rally.nav.Message.postNavigationFlair,Ext.bind(function(record){Rally.ui.notify.Notifier.show({message:flair,timeout:5e3})})),Rally[alm].navigation.NavigationActionCreators.setToken(Rally.nav.Manager.getDetailHash(responseText._ref),!0)}})}},{text:"Cancel",ui:"link",handler:function(){lightbox.destroy()}}],buttonAlign:"center"})},_buildComboBox:function(currentTypeName){var comboBox=Ext.create("Rally.ui.combobox.PortfolioItemTypeComboBox",{disabled:!0,border:!1,margin:"10 10 10 95",fieldLabel:"",storeConfig:{listeners:{load:{fn:function(){comboBox.enable()}}},additionalFilters:[{property:"Name",operator:"!=",value:currentTypeName}]}});return comboBox}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.plugins.SingleValueMetaFieldLabel",{extend:Ext.AbstractPlugin,init:function(singleValueMetaFieldComponent){this._component=singleValueMetaFieldComponent,this._component.on("onmodelsloaded",this._setLabelAndEmptyDescriptionFromPropertyType,this)},_setLabelAndEmptyDescriptionFromPropertyType:function(models){var modelsArray=_.values(models);if(1===modelsArray.length){var name=modelsArray[0].typeDefName;this._component.label=name.toUpperCase(),this._component.setDoesNotHavePropertyDescriptionText("No "+name)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.PortfolioItemDetailController",{extend:Rally.ui.detail.controller.DetailController,config:{defaultOwnerToCurrentUser:!0,useLegacyPrintDialog:!0},initializePhantomRecord:function(record){this.callParent(arguments);var fieldsToDefaultToOne=["JobSize","RROEValue","TimeCriticality","UserBusinessValue"],fieldsToDefaultToZero=["RefinedEstimate","RiskScore","ValueScore","WSJFScore"];_.each(fieldsToDefaultToOne,function(item){record.get(item)||record.set(item,1)}),_.each(fieldsToDefaultToZero,function(item){record.get(item)||record.set(item,0)})},getUpdatableActions:function(){var actions=[];return actions.push({action:"new",label:"New"}),actions.push({action:"copy",label:"Copy"}),actions.push({action:"print",label:"Print"}),actions.push({action:"convert",label:"Convert"}),actions.push({action:"delete",label:"Delete"}),actions},getAssociations:function(){var subPages=[];return this._isAttributeEnabled("UserStories")?subPages.push("userstories"):this._isAttributeEnabled("Children")&&subPages.push("children"),(this._isAttributeEnabled("Predecessors")||this._isAttributeEnabled("Successors"))&&subPages.push("dependencies"),Rally.ui.detail.DetailHelper.featureEnabled("F7598_EXPERTISE")&&this.getRecord().getField("ExpertiseDemands")&&subPages.push("expertise"),subPages.push("revisions"),subPages.push("discussion"),subPages},getMetaFields:function(){var metaFields=this.getDefaultMetaFields("Portfolio Item Detail");if(1!==Rally.environment.getContext().getSubscription().MaximumProjects&&metaFields.push({xtype:"rallydetailprojectmetafieldedpcomplete"}),this._isAttributeEnabled("Parent")){var parentType=this.getRecord().getField("Parent").attributeDefinition.AllowedValueType._refObjectName.toLowerCase();metaFields.push({xtype:"rallydetailparentmetafield",possiblePropertyTypes:[parentType],plugins:[{xclass:"Rally.ui.detail.plugins.SingleValueMetaFieldLabel"}],controller:this})}return this._addTagsMetaField(metaFields),metaFields},getExcludedFields:function(){return this.callParent(arguments).concat(["AcceptedDate","AcceptedLeafStoryPlanEstimateTotal","AcceptedLeafStoryCount","Archived","CreationDate","ChangeSets","DirectChildrenCount","DragAndDropRank","LastUpdateDate","LateChildCount","LeafStoryCount","LeafStoryPlanEstimateTotal","LatestDiscussionAgeInMinutes","Owner","Parent","PercentDoneByStoryCount","PercentDoneByStoryPlanEstimate","PortfolioItemType","PreliminaryEstimate","PreliminaryEstimateValue","PredecessorsAndSuccessors","Project","Ready","Recycled","State","StateChangedDate","UnEstimatedLeafStoryCount","JobSize","RROEValue","TimeCriticality","UserBusinessValue"])},getFieldBuckets:function(){var buckets=this.callParent(arguments);return buckets.splice(1,0,{label:"Planning",fields:["InvestmentCategory","ValueScore","RiskScore","WSJFScore","RefinedEstimate"]}),buckets},getNorthFields:function(){return _.compact([this._getFieldComponent(this.getRecord().getField("State"),{width:170}),this._getFieldComponent(this.getRecord().getField("PreliminaryEstimate"),{width:170}),this._getFieldComponent(this.getRecord().getField("Ready"),{showSavedIndicator:!1,margin:"0 10 0 0"}),Ext.create("Ext.Component",{margin:"0 20 0 0"}),this._getFieldComponent(this.getRecord().getField("PercentDoneByStoryPlanEstimate"),{displayName:"% Done By<br/>Plan Estimate",width:100,margin:"0 20 0 0",labelCls:"fieldsetContainerLabel percent-done-label"}),this._getFieldComponent(this.getRecord().getField("PercentDoneByStoryCount"),{displayName:"% Done By<br/>Story Count",width:100,margin:"0 20 0 0",labelCls:"fieldsetContainerLabel percent-done-label"})].concat(this.callParent(arguments)))},doAction:function(view,action,params){switch(action){case"convert":Ext.create("Rally.ui.detail.controller.PortfolioItemConverter").validateThenConvert(this.getRecord());break;default:this.callParent(arguments)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.TaskDetailController",{extend:Rally.ui.detail.controller.DetailController,config:{defaultOwnerToCurrentUser:!1,useLegacyPrintDialog:!0},getUpdatableActions:function(){var actions=[];return actions.push({action:"new",label:"New"}),actions.push({action:"copy",label:"Copy"}),actions.push({action:"print",label:"Print"}),actions.push({action:"delete",label:"Delete"}),actions},getAssociations:function(){var subPages=[];return Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.BuildandChangesetEnabled&&subPages.push("changesets"),subPages.push("revisions"),subPages.push("discussion"),subPages},getMetaFields:function(){var metaFields=this.getDefaultMetaFields("Task Detail");1!==Rally.environment.getContext().getSubscription().MaximumProjects&&metaFields.push({xtype:"rallydetailprojectmetafieldedpcomplete"});var parentMetaField=Ext.widget({xtype:"rallydetailparentmetafield",record:this.getRecord(),clearable:!1,possiblePropertyTypes:["hierarchicalrequirement","defect","defectsuite","testset"],property:"WorkProduct",label:"WORK PRODUCT",listeners:{fieldchanged:this._workProductChanged,scope:this}});return Rally.data.wsapi.ModelFactory.getModel({type:"userstory",success:function(model){parentMetaField.setTypeSpecificFilters({All:this._createParentMetaFieldFilter(model.typeDefOid),hierarchicalrequirement:this._createParentMetaFieldFilter(model.typeDefOid)})},scope:this}),metaFields.push(parentMetaField),this._addTagsMetaField(metaFields),metaFields},_createParentMetaFieldFilter:function(typeDefOid){var userStoryFilter=Ext.create("Rally.data.wsapi.Filter",{property:"TypeDefOid",value:typeDefOid}),noChildrenFilter=Ext.create("Rally.data.wsapi.Filter",{property:"DirectChildrenCount",value:0}),notUserStoryFilter=Ext.create("Rally.data.wsapi.Filter",{property:"TypeDefOid",value:typeDefOid,operator:"!="});return userStoryFilter.and(noChildrenFilter).or(notUserStoryFilter)},getExcludedFields:function(){return this.callParent(arguments).concat(["Actuals","Blocked","BlockedReason","CreationDate","DragAndDropRank","Estimate","Iteration","LastUpdateDate","LatestDiscussionAgeInMinutes","Milestones","Owner","Project","Rank","Ready","Recycled","Release","State","TaskIndex","ToDo","WorkProduct","TimeSpent"])},getNorthFields:function(){var record=this.getRecord(),numberFieldMargin="0 10 0 0";return this.stateFieldComponent=this._getFieldComponent(record.getField("State"),{width:170}),this.taskEstFieldComponent=this._getFieldComponent(record.getField("Estimate"),{displayName:"Task Est",margin:numberFieldMargin}),this.toDoFieldComponent=this._getFieldComponent(record.getField("ToDo"),{margin:numberFieldMargin}),this.toDoFieldComponent&&(this.stateFieldComponent&&this.stateFieldComponent.editor.on({change:{fn:this._updateToDoOnStateChange,scope:this}}),this.taskEstFieldComponent&&this.taskEstFieldComponent.editor.on({change:{fn:this._resetToDoToMatchTaskEst,scope:this}}),"Completed"===record.get("State")&&this.toDoFieldComponent.setDisabled(!0)),"number"==typeof record.get("TimeSpent")&&(this.timeSpentFieldComponent=this._getFieldComponent(record.getField("TimeSpent"),{displayName:"Time Spent",margin:numberFieldMargin})),_.compact([this.stateFieldComponent,{xtype:"rallyreadyblockedstatus"},this.getRankFieldComponent({margin:numberFieldMargin}),this.taskEstFieldComponent,this.toDoFieldComponent,this._getFieldComponent(this.getRecord().getField("Actuals"),{displayName:"Actual",margin:numberFieldMargin}),this.timeSpentFieldComponent].concat(this.callParent(arguments)))},_updateToDoOnStateChange:function(field,newValue,oldValue,options){"Completed"===newValue?(this.toDoFieldComponent.setValue(0),this.toDoFieldComponent.setDisabled(!0)):this.toDoFieldComponent.setDisabled(!1)},_resetToDoToMatchTaskEst:function(field,newValue,oldValue,options){this.toDoFieldComponent.isDisabled()||this.toDoFieldComponent.setValue(newValue)},doAction:function(view,action,params){switch(action){case"new":this.callParent([view,action,{WorkProduct:this.record.get("WorkProduct")._ref}]);break;default:this.callParent(arguments)}},_workProductChanged:function(obj){if(this.record.phantom){var workProductProject=Rally.util.Ref.getRefUri(obj.getValue().Project),currentProject=Rally.util.Ref.getRefUri(this.record.get("Project"));currentProject!==workProductProject&&(this.record.set("Project",workProductProject),this._redrawViewIfProjectChanged(this.record))}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.FeatureMetaField",{extend:Rally.ui.detail.metafield.SingleValueMetaField,alias:"widget.rallydetailfeaturemetafield",cls:"detailFieldContainer featureMetaField",hasPropertyTpl:'<span class="metaFieldValue"><a class="featureLink" href={hash}>{formattedID} - {name}</a></span>',doesNotHavePropertyTpl:"",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate",{xclass:"Rally.ui.detail.plugins.SingleValueMetaFieldLabel"}],constructor:function(config){Ext.apply(this,config);var piRef=this.record.getField("PortfolioItem").attributeDefinition.AllowedValueType._refObjectName;this.possiblePropertyTypes=[piRef.toLowerCase()],this.property=this._lowestLevelPiName(piRef),this.callParent(arguments),this.record.phantom||this.on("afterrender",this.onObjectUpdate,this),this._showHideFeatureField()},_lowestLevelPiName:function(piRef){return piRef.substring(piRef.indexOf("/")+1)},_getPropertyValue:function(){var value=this.callParent(arguments);return value||(value=this.record.get("Feature")),value},onObjectUpdate:function(){Rally.data.ModelFactory.getModel({type:"HierarchicalRequirement",success:function(model){model.load(this.record.get("ObjectID"),{success:this._onModelLoadSuccess,scope:this})},scope:this})},_onModelLoadSuccess:function(record){this.record=record,this._retrieveRequiredModels(),this._showHideFeatureField()},_showHideFeatureField:function(){this._shouldHideFeatureField()?this.hide():this.show()},_shouldHideFeatureField:function(){return this.record.phantom||this.record.get("Feature")&&!this.record.get("Parent")},_getRenderData:function(propertyRecord){return{formattedID:propertyRecord.get("FormattedID"),hash:"#/detail/"+propertyRecord.self.prettyTypeName+"/"+propertyRecord.get("ObjectID"),name:propertyRecord.get("Name")}},_getHasPropertyRenderHTML:function(renderData){var html='<span class="metaFieldValue"><a class="featureLink" href='+renderData.hash+">"+renderData.formattedID+" - "+renderData.name+"</a></span>";return html}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.controller.UserStoryDetailController",{extend:Rally.ui.detail.controller.DetailController,config:{defaultOwnerToCurrentUser:!0,useLegacyPrintDialog:!0},getUpdatableActions:function(){var actions=[],alm="alm";if(actions.push({action:"new",label:"New"}),actions.push({action:"copy",label:"Copy"}),Rally[alm]&&actions.push({action:"split",label:"Split"}),actions.push({action:"print",label:"Print"}),Rally[alm]){var context=Rally.environment.getContext(),subscription=context.getSubscription();subscription.isModuleEnabled("Rally Portfolio Manager")&&actions.push({action:"convert",label:"Convert To Portfolio Item"})}return actions.push({action:"delete",label:"Delete"}),actions},getAssociations:function(){var subPages=[];return this._isAttributeEnabled("Children")&&subPages.push("children"),(this._isAttributeEnabled("Predecessors")||this._isAttributeEnabled("Successors"))&&subPages.push("dependencies"),this._isAttributeEnabled("Tasks")&&!this._getChildrenCount()&&subPages.push("tasks"),this._isAttributeEnabled("Defects")&&subPages.push("defects"),this._isAttributeEnabled("TestCases")&&subPages.push("testcases","testrun"),this._isAssociationEnabledForSubscription("Chart")&&subPages.push("chart"),Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.BuildandChangesetEnabled&&subPages.push("changesets"),subPages.push("revisions"),subPages.push("discussion"),subPages},_getChildrenCount:function(){return this._isAttributeEnabled("Children")?this.getRecord().getCollection("Children").getTotalCount():0},getMetaFields:function(){var metaFields=this.getDefaultMetaFields("User Story Detail");if(this._isAttributeEnabled("Parent")){var parentTypes=["hierarchicalrequirement"];if(this._isAttributeEnabled("PortfolioItem")){var lowestLevelPortfolioItemTypePath=this.getRecord().getField("PortfolioItem").attributeDefinition.AllowedValueType._refObjectName.toLowerCase();parentTypes.push(lowestLevelPortfolioItemTypePath.replace(/\s/g,""))}metaFields.push({xtype:"rallydetailuserstoryparentmetafield",possiblePropertyTypes:parentTypes,controller:this})}return this._isAttributeEnabled("PortfolioItem")&&metaFields.push({xtype:"rallydetailfeaturemetafield"}),1!==Rally.environment.getContext().getSubscription().MaximumProjects&&metaFields.push({xtype:"rallydetailprojectmetafieldedpcomplete"}),this._addTagsMetaField(metaFields),metaFields},getExcludedFields:function(){var excludedFields=this.callParent(arguments).concat(["AcceptedDate","Blocked","BlockedReason","Blocker","CreationDate","DefectStatus","DirectChildrenCount","DragAndDropRank","Feature","HasParent","InProgressDate","LastUpdateDate","LatestDiscussionAgeInMinutes","Owner","Parent","PassingTestCaseCount","PlanEstimate","PortfolioItem","PredecessorsAndSuccessors","Project","Rank","Ready","Recycled","ScheduleState","ScheduleStatePrefix","TaskActualTotal","TaskEstimateTotal","TaskRemainingTotal","TaskStatus","TestCaseCount","TestCaseStatus"]);return Rally.ui.detail.DetailHelper.isRecordParent(this.getRecord())&&(excludedFields.push("Iteration"),excludedFields.push("Release")),excludedFields},getNorthFields:function(){var numberFieldRightMargin="0 10 0 0";return _.compact([this._getFieldComponent(this.getRecord().getField("ScheduleState"),{width:170}),{xtype:"rallyreadyblockedstatus"},this.getRankFieldComponent({margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("PlanEstimate"),{displayName:"Plan Est",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskEstimateTotal"),{displayName:"Task Est",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskRemainingTotal"),{displayName:"To Do",margin:numberFieldRightMargin}),this._getFieldComponent(this.getRecord().getField("TaskActualTotal"),{displayName:"Actual",margin:numberFieldRightMargin})].concat(this.callParent(arguments)))},doAction:function(view,action,params){switch(action){case"split":this._splitUserStory();break;case"convert":this._convertToPortfolioItem();break;default:this.callParent(arguments)}},_splitUserStory:function(){var alm="alm";Ext.create("Rally."+alm+".content.pages.storysplitting.StorySplittingDialog",{autoShow:!0,storyOid:this.getRecord().get("ObjectID"),workspaceOid:Rally.util.Ref.getOidFromRef(this.getRecord().get("Workspace")._ref),projectOid:Rally.util.Ref.getOidFromRef(this.getRecord().get("Project")._ref)})},_convertToPortfolioItem:function(){var message="Are you sure you want to convert {0} to a Portfolio Item?<br/><br/>Children and attachments for {0} will be moved to the new Portfolio Item. Other work items (e.g., Defects) will remain associated with {0}.";
this.confirmationDialog=Ext.create("Rally.ui.dialog.ConfirmDialog",{title:"Confirm Portfolio Item Conversion",message:Ext.String.format(message,this.getRecord().get("FormattedID")),confirmLabel:"Convert",modal:!0,listeners:{confirm:this._commitConvertToPortfolioItem,cancel:Ext.emptyFn,scope:this}})},_commitConvertToPortfolioItem:function(){Ext.Ajax.request({url:"/slm/ar/convertToPortfolioItem.sp",params:{oid:this.getRecord().get("ObjectID")},method:"POST",success:this._transitionToPortfolioItem,scope:this})},_transitionToPortfolioItem:function(response){var storyLocation=Rally.nav.Manager.getDetailHash(this.getRecord());Rally.nav.Manager.goToRallyPage(Rally.nav.Manager.getDetailHash(response.responseText));var alm="alm";Rally.environment.getMessageBus().subscribe(Rally[alm].Message.contentUpdated,function(){var message="The conversion is complete. "+this.getRecord().get("FormattedID")+" is unchanged but has no children.",editLink={text:"Edit Original Story",scope:this,fn:function(){Rally.nav.Manager.goToRallyPage(storyLocation)}};Rally.ui.notify.Notifier.show({message:message,links:[editLink]})},this,{single:!0})},getBaseUrl:function(){return"/detail/userstory"},deleteItem:function(){Rally.data.util.DeletionConfirmationHelper.confirmUserStoryDeletionIfThereAreChildren({record:this.record,confirmMessageWhenNoChildren:this._getDefaultDeleteConfirmationPrompt(),success:this._onDeleteClicked,failure:this._onDeleteFailure,scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.metafield.TagPill",{extend:Ext.Component,alias:"widget.rallydetailtagpill",cls:"tagField",autoEl:"li",clientMetrics:[{event:"delete",description:"tag deleted"}],config:{tag:void 0,readOnly:!1},constructor:function(config){config&&config.tag&&config.tag.get("_refObjectName")||Ext.Error.raise("When creating a TagPill, you must provide a config object with a tag that has a _refObjectName property!"),config&&config.readOnly?this.renderTpl='<span class="tagPill readonly">{tagName}</span>':(this.renderSelectors={deleteLink:"span.icon-cancel"},this.renderTpl='<span class="tagPill">{tagName}<span class="icon-cancel"></span></span>'),this.mergeConfig(config),this.callParent([this.config]),this.addEvents(["delete"])},initComponent:function(){this.callParent(arguments),this.renderData={tagName:this.tag&&this.tag.get("_refObjectName")},this.on("afterrender",this._attachListeners,this)},_attachListeners:function(){this.deleteLink&&this.deleteLink.on("click",function(){this.fireEvent("delete",this)},this,{stopEvent:!0})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.plugins.LoadingMonitor",{extend:Ext.AbstractPlugin,_events:["loadingmonitorload","loadingmonitortimeout"],config:{timeout:1e4,retrieveStoreFromComponent:function(){return this._component.store}},init:function(component){this._component=component,this._store=this.retrieveStoreFromComponent(),this.timeout=1e4,this._timeoutTask=new Ext.util.DelayedTask(this._handleTimeout,this),this._initializeEvents(),this._listenForErrors()},_initializeEvents:function(){var hasAddedEventsToComponent=_.all(this._events,function(eventName){this._component.hasListener(eventName)},this);hasAddedEventsToComponent||_.each(this._events,function(eventName){this._component.addEvents(eventName),this._component.enableBubble(eventName)},this)},_listenForErrors:function(){this._store.un("beforeload",this._startTimeout,this),this._store.un("load",this._handleLoad,this),this._store.on("beforeload",this._startTimeout,this),this._store.on("load",this._handleLoad,this)},_handleLoad:function(store,records,successful){this._timeoutTask.cancel(),this._component.fireEvent("loadingmonitorload",this,{eventName:"loadingmonitorload",store:this._store,component:this._component,successful:successful})},_handleTimeout:function(){this._component.fireEvent("loadingmonitortimeout",this,{eventName:"loadingmonitortimeout",store:this._store,component:this._component}),this._startTimeout()},_startTimeout:function(){this._timeoutTask.delay(this.timeout)},destroy:function(){this._store.un("beforeload",this._startTimeout,this),this._store.un("load",this._handleLoad,this),this._timeoutTask.cancel()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.BlockedReasonField",{extend:Rally.ui.detail.FieldsetContainer,alias:"widget.rallydetailblockedreason",cls:"blockedreason",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],config:{record:void 0},initComponent:function(){this.setField(_.find(this.getRecord().getFields(),function(field){return"BlockedReason"===field.name})),this.callParent(arguments),this._showOrHide(),this.getRecord().phantom&&this.subscribe(this,Rally.Message.recordDidChange,this._updateRecordAndShowOrHide,this)},onObjectUpdate:function(updatedRecord){this._updateRecordAndShowOrHide(updatedRecord)},_shouldDisplayBlockedReason:function(){return!Rally.data.util.Record.isParent(this.getRecord())&&this.getRecord().get("Blocked")},_updateFieldOnRecord:function(){Rally.data.util.Record.isParent(this.getRecord())||this.getRecord().get("Blocked")||this.getRecord().set("BlockedReason","")},_showOrHide:function(){this._shouldDisplayBlockedReason()?this.show():this.hide()},_updateRecordAndShowOrHide:function(updatedRecord){this.setRecord(updatedRecord),this._updateFieldOnRecord(),this.editor.setValue(updatedRecord.get(this.getField().name)),this._showOrHide()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.GearMenu",{extend:Ext.Component,alias:"widget.rallydetailgearmenu",mixins:{tooltippable:Rally.ui.tooltip.ToolTippable},config:{record:void 0,actions:[],toolTipText:"Actions"},cls:"menu-gear",html:'<span aria-hidden="true" class="picto icon-gear"></span>',initComponent:function(){this.callParent(arguments),this.on("afterrender",function(){this.getEl().down(".icon-gear").on("click",this._showMenu,this),this.buildToolTip()},this)},_showMenu:function(e){this.addCls("selected"),this._getGearMenu().showBy(e.target,"tr-br",[0,0])},_getGearMenu:function(){return this.menu=Ext.create("Rally.ui.menu.RecordMenu",{bubbleEvents:["doaction"],cls:"detailpagemenu",items:_.map(this.getActions(),function(action){return Ext.create("Rally.ui.menu.item.detail.MenuItem",{text:action.label,action:action.action})}),record:this.getRecord()}),this.relayEvents(this.menu,["doaction"]),this.menu.on("hide",this._removeGearHighlight,this),this.menu},_removeGearHighlight:function(){this.removeCls("selected")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailPageTitleBar",{extend:Ext.container.Container,alias:"widget.rallydetailtitlebaredpcomplete",cls:"detailpagetitlebar",config:{record:void 0,actions:[]},layout:"hbox",height:50,constructor:function(config){this.initConfig(config),this.callParent(arguments)},initComponent:function(){var record=this.getRecord();this.callParent(arguments),record.phantom&&this.addCls("phantom"),record.phantom||this._addFormattedId(),this._addNameField(),this._addRequiredFieldCountTag(),record.phantom?(this.createButton=this.add(this._buildCreateButton()),this.add(this._buildCancelControl())):(this._addEditModeButton(),this._addGearMenu(),this.add(this._buildDoneButton()))},_buildCreateButton:function(){return Ext.create("Rally.ui.Button",{cls:"primary medium create-btn",disabled:!0,text:"Create",scope:this,itemId:"edpCreateButton",handler:function(){this.fireEvent("save",this)}})},_buildCancelControl:function(){return Ext.create("Rally.ui.Button",{itemId:"cancel-btn",cls:"cancel-btn primary medium",iconCls:"icon-cancel",handler:function(){this.fireEvent("cancel",this)},scope:this})},_buildDoneButton:function(){return Ext.create("Rally.ui.Button",{cls:"primary medium done-btn",text:"Done",margin:"5 10 0 8",handler:function(){this.fireEvent("done")},scope:this})},_getVisibleTag:function(){if(!this.requiredFieldCountTag.isHidden())return this.requiredFieldCountTag},_adjustFields:function(){var tag=this._getVisibleTag();tag&&(this.suspendEvents(),this.nameField.getEl().setWidth(this.nameField.getWidth()+tag.getWidth()),this._adjustTagPosition(),this.resumeEvents())},_adjustTagPosition:function(){var nameFieldEl=this.nameField.getEl();if(nameFieldEl){var paddingRight=0,tag=this._getVisibleTag();if(tag&&tag.el){var nameFieldLeft=parseInt(nameFieldEl.getStyle("left"),10),nameFieldWidth=this.nameField.getWidth(),tagWidth=tag.width||tag.getWidth(),leftPosition=nameFieldLeft+nameFieldWidth-tagWidth-5;tag.getEl().setStyle("left",leftPosition+"px"),paddingRight=nameFieldLeft+nameFieldWidth-leftPosition}var nameFieldInput=nameFieldEl.down("input");nameFieldInput&&nameFieldInput.setStyle("padding-right",paddingRight+"px")}},updateRequiredFieldCount:function(){var requiredFieldCount=Rally.ui.detail.DetailHelper.getCountOfEmptyRequiredFieldEditors();this.requiredFieldCountTag.hasCountChanged(requiredFieldCount)&&(this.requiredFieldCountTag.updateCount(requiredFieldCount),this._adjustTagPosition()),this.createButton&&this.createButton.setDisabled(requiredFieldCount>0)},focusNameField:function(){this.nameField.getEl().down("input").dom.focus()},_addFormattedId:function(){this.add({xtype:"component",cls:"formatted-id",renderTpl:Ext.create("Ext.XTemplate","{formattedId}"),renderData:{formattedId:this.getRecord().get("FormattedID")}})},_addNameField:function(){var record=this.getRecord();this.nameField=this.add(Ext.create("Rally.ui.detail.FieldContainer",{itemId:"nameContainer",record:record,field:record.getField("Name"),autoEl:"h1",flex:1,listeners:{move:this._adjustFields,afterrender:this._adjustTagPosition,scope:this}}))},_addRequiredFieldCountTag:function(){this.requiredFieldCountTag=this.add(Ext.create("Rally.ui.detail.view.RequiredFieldCountTag",{initialRequiredFieldCount:Rally.ui.detail.DetailHelper.getCountOfEmptyRequiredFieldEditors()}))},_addGearMenu:function(){this.gearMenu=this.add(Ext.create("Rally.ui.detail.view.GearMenu",{record:this.getRecord(),actions:this.getActions(),margin:"8 0 0 8"})),this.gearMenu.on("doaction",function(action){this.fireEvent("doaction",action)},this)},_addEditModeButton:function(){this.editModeButton=Ext.create("Rally.ui.button.EditMode",{editMode:Rally.ui.detail.EditModeContext.isPageEditable(this.getRecord()),disabled:!this.getRecord().get("updatable")}),this.add(this.editModeButton)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.ScheduleStateTemplate",{extend:Ext.XTemplate,field:void 0,showTrigger:!1,constructor:function(config){var templateConfig=['<div aria-label="Edit Schedule State: {ScheduleState}"',' class="schedule-state-wrapper {[this._addClsIfEditable(values)]}" style="width: 100%">',"{[this.renderStates(values)]}","</div>",{_addClsIfEditable:function(recordData){return recordData.updatable?"field-editable":""}},config];return this.callParent(templateConfig)},renderStates:function(recordData){var states=this.field.getAllowedStringValues(),stateUsed=!0,returnVal=[],currentState=recordData[this.field.name],blockWidth=Math.floor(85/states.length-3);return Ext.each(states,function(state,index){if(0!==index&&returnVal.push('<span class="schedule-state-spacer"></span>'),returnVal.push('<div state-data="'+state+'" class="schedule-state'),returnVal.push(this._getClassFromState(recordData.Blocked,recordData.Ready)),stateUsed&&returnVal.push(" before-state"),state===currentState){var symbolState=this._getSymbolState(recordData,state);returnVal.push(" current-state"),recordData.Blocked?(returnVal.push('" style="width:'+2*blockWidth+'%">'),returnVal.push('<div class="hexagon"></div>'),returnVal.push('<div class="state-name">'),returnVal.push(symbolState+"</div></div>")):returnVal.push('" style="width:'+2*blockWidth+'%">&nbsp;'+symbolState+"&nbsp;</div>")}else returnVal.push(" clickable-state"),returnVal.push('" style="width:'+blockWidth+'%">&nbsp;</div>');state===currentState&&(stateUsed=!1)},this),this.showTrigger&&returnVal.push('<div class="editor-trigger icon-chevron-down"></div>'),returnVal.join("")},_isCreate:function(recordData){return"1"===recordData.VersionId&&recordData.modified&&!recordData.modified.ScheduleState},_getSymbolState:function(recordData,state){var symbolState;return symbolState=recordData.ScheduleStatePrefix?!recordData.isDirty||this._isCreate(recordData)?recordData.ScheduleStatePrefix:"":"In-Progress"===state?"P":state.charAt(0)},_getClassFromState:function(blocked,ready){var className="";return blocked?className+=" blocked-state":ready&&(className+=" ready-state"),className}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailScheduleStateTemplate",{extend:Rally.ui.renderer.template.ScheduleStateTemplate,renderStates:function(recordData){return this.callParent(arguments)+'<span class="icon-chevron-down rally-detail-schedulestate-chevron"></span>'}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.RibbonNavigationItem",{extend:Ext.Component,alias:"widget.rallydetailribbonnavigationitem",cls:"ribbon-item",mixins:{messageable:Rally.Messageable,recordable:Rally.clientmetrics.ClientMetricsRecordable},config:{isActive:void 0,baseUrl:void 0,record:void 0},initComponent:function(){this.isActive&&this.addCls("rly-active"),this.data=this.data||{},this.data.badgeCount=this._getBadgeCount(),this.renderTpl=this.getTemplate(),this.callParent(arguments),this._showHideBadge(),this._enableOrDisable(),this.on("afterrender",this._onAfterRender,this)},_onAfterRender:function(){this.getEl().on("click",function(e){return e.preventDefault(),this.hasCls("rly-disabled")||this.fireEvent("select",this,this.data.urlSuffix),!1},this)},_enableOrDisable:function(){this._isDisabled()?this.addCls("rly-disabled"):this.removeCls("rly-disabled")},getTemplate:function(){var picto='<div class="picto '+this.data.picto+'"></div>',badge='<span class="ribbon-badge">'+this.data.badgeCount+"</span>",label='<div class="rly-label">'+this.data.text+"</div>",enabledReadOnly=picto+badge+label,disabledReadOnly=picto+label;return'<div class="when-enabled"><a href="'+this.baseUrl+this.data.urlSuffix+'">'+enabledReadOnly+'</a></div><div class="when-disabled">'+disabledReadOnly+"</div>"},recordUpdated:function(record){this.setRecord(record),this._checkForUpdatedBadgeCount(),this._enableOrDisable()},_checkForUpdatedBadgeCount:function(){var newBadgeCount=this._getBadgeCount();this.data.badgeCount!==newBadgeCount&&this._updateBadgeCount(newBadgeCount)},_updateBadgeCount:function(count){if(this.getEl()){this.data.badgeCount=count;var badgeSpan=this.getEl().down("[class=ribbon-badge]");badgeSpan.update(this.data.badgeCount),this._showHideBadge()}},_showHideBadge:function(){0===this.data.badgeCount?this.addCls("no-badge"):this.removeCls("no-badge")},_getBadgeCount:function(){if(this._isDisabled()||!this.associationProperty)return 0;var badgeCount=0;return _.each(Ext.Array.from(this.associationProperty),function(property){badgeCount+=this._getPropertyCount(this.getRecord(),property)},this),badgeCount},_isDisabled:function(){return!!this.getRecord().phantom||!(!this.data||"Tasks"!==this.data.text)&&(!Rally.ui.detail.DetailHelper.isAttributeEnabled(this.getRecord(),"Tasks")||Rally.ui.detail.DetailHelper.isRecordParent(this.getRecord()))},_getPropertyCount:function(record,property){var field=record.get(property);return field&&field.Count?field.Count:0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.RibbonNavigationRevisionsItem",{extend:Rally.ui.detail.view.RibbonNavigationItem,initComponent:function(){this.callParent(arguments),this._checkForUpdatedBadgeCount()},_checkForUpdatedBadgeCount:function(){this._getRevisionCount(function(count){this._updateBadgeCount(count)})},_getRevisionCount:function(callback){this.getRecord().get("RevisionHistory")&&this.getRecord().get("RevisionHistory")._ref&&Rally.data.ModelFactory.getModel({type:"RevisionHistory",success:function(model){model.load(Rally.util.Ref.getOidFromRef(this.getRecord().get("RevisionHistory")._ref),{success:function(r){callback.call(this,r.get("Revisions").Count)},scope:this})},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.RibbonNavigation",{extend:Ext.container.Container,alias:"widget.rallydetailribbonnavigationedpcomplete",cls:"ribbon-navigation",layout:"hbox",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],config:{baseUrl:void 0,associations:void 0,record:void 0,menuItemConfigs:[{data:{picto:"icon-edit",text:"Details",urlSuffix:""}},{data:{picto:"icon-calendar",text:"Scheduled",urlSuffix:"/scheduled"},associationProperty:"Artifacts"},{data:{picto:"icon-task",text:"Tasks",urlSuffix:"/tasks"},associationProperty:"Tasks"},{data:{picto:"icon-children",text:"Children",urlSuffix:"/children"},associationProperty:"Children"},{data:{picto:"icon-story",text:"User Stories",urlSuffix:"/userstories"},associationProperty:"UserStories"},{data:{picto:"icon-defect",text:"Defects",urlSuffix:"/defects"},associationProperty:"Defects"},{data:{picto:"icon-defect-suite",text:"Defect Suites",urlSuffix:"/defectsuites"}},{data:{picto:"icon-copy",text:"Duplicates",urlSuffix:"/duplicates"},associationProperty:"Duplicates"},{data:{picto:"icon-user",text:"Expertise",urlSuffix:"/expertise"},associationProperty:"Expertise"},{data:{picto:"icon-comment",text:"Discussion",urlSuffix:"/discussion"},associationProperty:"Discussion"},{data:{picto:"icon-portfolio",text:"Portfolio Items",urlSuffix:"/deliveryGroupPortfolioItems"}},{data:{picto:"icon-history",text:"Revisions",urlSuffix:"/revisions"},xclass:"Rally.ui.detail.view.RibbonNavigationRevisionsItem"},{data:{picto:"icon-predecessor",text:"Dependencies",urlSuffix:"/predecessors"},otherActiveUrlSuffixes:["/successors"],associationProperty:["Successors","Predecessors"]},{data:{picto:"icon-predecessor",text:"Dependencies",urlSuffix:"/dependencies"},associationProperty:["Successors","Predecessors"]},{data:{picto:"icon-bars",text:"Charts",urlSuffix:"/chart"}},{data:{picto:"icon-test-case",text:"Test Cases",urlSuffix:"/testcases"},associationProperty:"TestCases"},{data:{picto:"icon-test-run",text:"Test Run",urlSuffix:"/testrun"},associationProperty:"TestCases"},{data:{picto:"icon-change-set",text:"Change Sets",urlSuffix:"/changesets"},associationProperty:"Changesets"}]},subscribeToRecordEvents:function(){if(!this.record.phantom){var alm="alm";Rally[alm]&&Rally[alm].Message&&this.subscribe(Rally[alm].Message.contentUpdated,this._recordUpdated,this),this.subscribe(Rally.Message.objectCreate,this._recordUpdated,this),this.subscribe(Rally.Message.objectDestroy,this._recordUpdated,this)}},initComponent:function(){this.callParent(arguments),this._removeInvalidAssociationsFromMenu(),this._setupRibbon(),this.on("beforedestroy",this._onDestroy,this)},onObjectUpdate:function(updatedRecord){this._recordUpdated(updatedRecord)},_onDestroy:function(){var alm="alm";Rally[alm]&&Rally[alm].Message&&this.unsubscribe(Rally[alm].Message.contentUpdated,this._recordUpdated,this),this.unsubscribe(Rally.Message.objectCreate,this._recordUpdated,this),this.unsubscribe(Rally.Message.objectDestroy,this._recordUpdated,this)},_recordUpdated:function(){this.getRecord().self.load(this.getRecord().get("ObjectID"),{success:this._updateMenuItems,scope:this})},_updateMenuItems:function(serverRecord){this.isDestroyed||(this.setRecord(serverRecord),_.each(this.menuItemComponents,function(menuItemComponent){menuItemComponent.recordUpdated(serverRecord)},this))},_setupRibbon:function(){this.menuItemComponents=[];var menuItemToMakeActive=this._getMenuItemForUrl(location.href),baseUrl=this.getBaseUrl();_.each(this.menuItemConfigs,function(config){var menuItemComponent=Ext.create(Ext.apply({xclass:"Rally.ui.detail.view.RibbonNavigationItem",isActive:config===menuItemToMakeActive,baseUrl:baseUrl,record:this.getRecord(),flex:1},config));menuItemComponent.on("select",this._onTabSelect,this),this.add(menuItemComponent),this.menuItemComponents.push(menuItemComponent)},this),this.getRecord().phantom&&this.addCls("rly-disabled")},_getMenuItemForUrl:function(href){var hrefNoQueryString=_.first(href.split("?")),urlSuffix=_.last(hrefNoQueryString.split("/"));""!==urlSuffix&&(urlSuffix="/"+urlSuffix);var menuItem=_.find(this.menuItemConfigs,function(config){return config.data.urlSuffix===urlSuffix||config.otherActiveUrlSuffixes&&_.contains(config.otherActiveUrlSuffixes,urlSuffix)});return menuItem||this.menuItemConfigs[0]},_removeInvalidAssociationsFromMenu:function(){var validUrlSuffixes=_.map(this.getAssociations(),function(association){return"/"+association});validUrlSuffixes.push(""),this.menuItemConfigs=_.filter(this.menuItemConfigs,function(config){return _.contains(validUrlSuffixes,config.data.urlSuffix)},this)},unsetActiveTab:function(){_.each(this.getEl().query(".ribbon-item"),function(item){Ext.get(item).removeCls("rly-active")})},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},_onTabSelect:function(tab,section){this.disabled||this.fireEvent("tabchange",this,section)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DetailEditor",{extend:Ext.container.Container,alias:"widget.rallydetaileditor",componentCls:"content detailContentWrapper",config:{record:void 0,controller:void 0,enableDragAndDropAttachments:!0},bubbleEvents:["recorddraw"],layout:{type:"column",beginLayout:function(ownerContext){ownerContext.target.down("#eastMetaFieldContainer").getEl().setStyle("position","absolute"),this.self.prototype.beginLayout.apply(this,arguments)},finalizeLayout:function(ownerContext){ownerContext.target.down("#eastMetaFieldContainer").getEl().setStyle("position","relative")}},items:[{xtype:"container",cls:"detailBody",columnWidth:.995,margin:"12px 15px",itemId:"detailBody"},{xtype:"container",cls:"detailContentRightPanel",itemId:"eastMetaFieldContainer",_isLayoutRoot:!0,width:260,margin:"12px 10px",padding:"12px 10px"}],constructor:function(config){this.plugins=[],this.initConfig(config),this.callParent(arguments)},initComponent:function(){this.addEvents("recorddraw"),this.callParent(arguments),this.on("render",this._onRender,this),this.on("projectchanged",this._projectChanged,this)},getAttachmentOids:function(){var richTextEditors=Ext.ComponentQuery.query("rallyrichtexteditor"),attachmentOids=[];return _.each(richTextEditors,function(richTextEditor){attachmentOids.push(richTextEditor.getUploadedImageOids())}),_.flatten(attachmentOids)},_onRender:function(){this.getRecord()&&this.draw()},_projectChanged:function(){this.getRecord().phantom&&this._reloadFieldsForProject()},_reloadFieldsForProject:function(){var record=this.getRecord();Rally.ui.detail.DetailHelper.syncModelProject(record,function(){this.getController().updateRecordFromFields(record),this._changeToRef("Project"),this._changeToRef("Owner"),this.redrawDetailContentWrapper({record:record})},this)},_changeToRef:function(fieldName){this.getRecord().get(fieldName)&&this.getRecord().set(fieldName,{_ref:this.getRecord().get(fieldName)})},draw:function(){this.redrawDetailContentWrapper()},removeMetaFields:function(){var metaContainer=this.down("#eastMetaFieldContainer");metaContainer&&metaContainer.removeAll()},removeDetailBody:function(){var detailBody=this.down("#detailBody");detailBody&&detailBody.removeAll()},redraw:function(config){config.record&&this.setRecord(config.record),this.redrawDetailContentWrapper(config)},redrawDetailContentWrapper:function(config){Ext.suspendLayouts(),this.removeDetailBody(),this._drawNorthFields(this.getController().getNorthFields()),this._drawBlockedReason(),this._drawFieldBuckets(this.getController().getFieldBuckets()),this.removeMetaFields(),this._drawMetaFields(this.getController().getMetaFields()),Ext.resumeLayouts(!0),this.fireEvent("recorddraw",this.getRecord())},_drawNorthFields:function(northFields){0!==northFields.length&&(this.northFieldContainer=this.down("#detailBody").add({xtype:"container",cls:"northfields",layout:"hbox"}),_.each(northFields,function(field){field.record=this.getRecord(),this.northFieldContainer.add(field)},this))},_drawBlockedReason:function(){Rally.ui.detail.DetailHelper.isAttributeEnabled(this.getRecord(),"BlockedReason")&&this.down("#detailBody").add({xtype:"rallydetailblockedreason",record:this.getRecord()})},_drawFieldBuckets:function(bucketConfigs){var allBuckets=this._buildFieldBuckets(bucketConfigs),detailBody=this.down("#detailBody");Ext.each(allBuckets,function(bucket,index){detailBody.add(bucket),bucket.nextBucket=_.last(allBuckets)!==bucket?allBuckets[index+1]:_.first(allBuckets)})},_buildFieldBuckets:function(bucketConfigs){var excludedFields=this.getController().getExcludedFields(),allBuckets=[],detailEditorMsgBusClass=Ext.extend(Ext.util.Observable,{constructor:function(){this.addEvents("detail-any-bucket-toggle"),this.callParent(arguments)}}),detailEditorMsgBus=new detailEditorMsgBusClass({});return Ext.each(bucketConfigs,function(bucketConfig){Ext.applyIf(bucketConfig,{record:this.getRecord(),excludedFields:excludedFields,collapse:this._shouldCollapseBucket(bucketConfig),detailEditorMsgBus:detailEditorMsgBus});var bucket=Ext.create("Rally.ui.detail.FieldBucket",bucketConfig);if(bucket.shouldDisplay()){var filteredFields=Ext.Array.pluck(bucket.getFilteredFields(),"name");excludedFields=excludedFields.concat(filteredFields),allBuckets.push(bucket)}else Ext.destroy(bucket)},this),allBuckets},_shouldCollapseBucket:function(bucketConfig){var collapsedBucketsOnNew=["Notes","Custom"],shouldCollapse=this.getRecord().phantom&&_.contains(collapsedBucketsOnNew,bucketConfig.label);if(shouldCollapse&&"Custom"===bucketConfig.label){var hasRequiredFields=_.some(this.getRecord().getFields(),function(field){return field.custom&&field.required});shouldCollapse=!hasRequiredFields}return shouldCollapse},_drawMetaFields:function(metaFields){var eastMetaContainer=this.down("#eastMetaFieldContainer");Ext.each(metaFields,function(metaFieldConfig){Ext.applyIf(metaFieldConfig,{record:this.getRecord()}),eastMetaContainer.add(metaFieldConfig)},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Uri",{singleton:!0,startWithSlash:function(uri){return uri?Rally.util.String.startsWith(uri,"/")?uri:"/"+uri:""},endWithSlash:function(uri){return uri?Rally.util.String.endsWith(uri,"/")?uri:uri+"/":""},startAndEndWithSlash:function(uri){return this.startWithSlash(this.endWithSlash(uri))},parseUri:function(str){for(var o=this._parseUriOptions,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri},_parseUriOptions:{strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","hash"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.project.HierarchyAwareMultiObjectProjectPicker",{extend:Rally.ui.picker.MultiObjectPicker,config:{alwaysExpanded:!0,availableTextLabel:"Available Projects",maintainScrollPosition:!0,modelType:"Project",pickerCfg:{height:248,shadow:!1},selectedTextLabel:"Selected Projects",selectionKey:"ObjectID",storeConfig:{limit:1/0,fetch:"Name,Parent",compact:!1,listeners:{load:{fn:function(store,items){this._createHierarchy(store),this._componentReady()},single:!0}}},storeLoadOptions:{params:{order:"Name ASC"}},width:300,listeners:{select:function(self,selectedRecord,value,event){this._doWithMaintainedScrollPosition(function(){this._addChildren(selectedRecord,event)})},deselect:function(self,selectedRecord,value,event){this._doWithMaintainedScrollPosition(function(){this._removeChildren(selectedRecord,event)})},expand:function(field,event){var picker=field.getPicker();picker&&picker.setZIndex(0)}}},componentCls:"rui-hierarchyawareproject-picker",constructor:function(config){this.config.storeConfig.listeners.load.scope=this,this.mergeConfig(config),this.callParent(arguments)},focusPlaceholderText:Ext.emptyFn,_addChildren:function(parentRecord,event){if(event.shiftKey){var children=this._getChildren(parentRecord,[]);children.length&&this.setValue(Ext.Array.merge(this.getValue(),children))}},_removeChildren:function(parentRecord,event){if(event.shiftKey){var children=this._getChildren(parentRecord,[]);children.length&&this.setValue(Ext.Array.difference(this.getValue(),children))}},_getChildren:function(parentRecord,children){return this.hierarchy[parentRecord.data.ObjectID]&&_.each(this.hierarchy[parentRecord.data.ObjectID],function(record){children.push(record),this._getChildren(record,children)},this),children},_createHierarchy:function(store){var parentOid;this.hierarchy={},_.each(store.getRecords(),function(record){parentOid=record.data.Parent&&record.data.Parent._ref&&Rally.util.Ref.getOidFromRef(record.data.Parent._ref),parentOid&&(this.hierarchy[parentOid]||(this.hierarchy[parentOid]=[]),this.hierarchy[parentOid].push(record))},this)},findInStore:function(value){return this.store?this.store.findRecordEvenIfFiltered(this.selectionKey,value):null},_componentReady:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailView",{extend:Ext.container.Container,alias:"widget.rallydetailviewedpcomplete",id:"rallydetailview",componentCls:"detailView",config:{record:void 0,contentClass:void 0,contentClassConfig:void 0,uri:void 0,queryParams:{}},mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},statics:{parseUri:function(uriString){var regex,tokens,uri=Rally.util.Uri.parseUri(uriString),hash=uri.hash;if(hash)if(hash.match(".*/detail/portfolioitem/.*")){var regexp={UUID_OR_OID:/\/(\d+[du]*)/,DETAIL:/\/detail/,TYPE:new RegExp("/(portfolioitem/"+Rally.util.RegularExpression.characterOrDigitRegularExpression.source+"+)"),ID_OR_COLLECTION:/\/([\w-]+)/,SECTION:/\/?(\w+)?/};regex=Rally.util.RegularExpression.combineRegularExpressions(regexp),tokens=regex.exec(hash)||[],uri.scope=tokens[1],uri.typeDef=tokens[2],uri.id=tokens[3],uri.section=tokens[4]}else hash.match(".*/detail/.*")&&(regex=new RegExp("/(\\d+[du]*)/detail/(\\w+)/([\\w-]+)/?(\\w+)?"),tokens=regex.exec(hash)||[],uri.scope=tokens[1],uri.typeDef=tokens[2],uri.id=tokens[3],uri.section=tokens[4]);return uri}},layout:"anchor",defaults:{anchor:"0"},_controller:void 0,constructor:function(config){this.initConfig(config),this.getContentClass()||this.setContentClass(Rally.ui.detail.view.content.DetailEditor),this.callParent(arguments)},getController:function(){return this._controller},setController:function(controller){this._controller=controller},_createController:function(record){this.setController(Rally.ui.detail.controller.DetailController.getController({record:record,view:this,queryParams:this.getQueryParams()}))},initComponent:function(){this.addEvents("aftercontentrender"),this.callParent(arguments);var record=this.getRecord();record&&this._createController(record),this.on("render",this._onRender,this),this.on("failure",this._onFailure,this),this.on("fieldchanged",function(){this.titleBar.updateRequiredFieldCount()},this)},_getTitleBar:function(){return Ext.create("Rally.ui.detail.view.DetailPageTitleBar",{record:this.getRecord(),actions:this.getController().getActions(),listeners:{save:function(){this.fireEvent("save",this)},cancel:function(){this.fireEvent("canceledit",this)},done:function(){Ext.isIE&&this._blurAllFields(),this.fireEvent("donebuttonclick",this)},doaction:this._doAction,fieldchanged:function(){
this.titleBar.updateRequiredFieldCount()},afterrender:this._onAfterRenderOfChildComponents,scope:this}})},_getEditableFieldContainers:function(){return _.filter(Ext.ComponentQuery.query(".rallydetailfieldcontaineredpcomplete"),function(fieldContainer){return fieldContainer.editor&&fieldContainer.editor.getValue})},_blurAllFields:function(){_.each(this._getEditableFieldContainers(),function(fieldContainer){fieldContainer.editor.fireEvent("blur",fieldContainer.editor)})},_doAction:function(action){this.fireEvent("gearaction",this,action)},getAttachmentOids:function(){var richTextEditors=Ext.ComponentQuery.query("rallyrichtexteditor"),attachmentOids=[];return _.each(richTextEditors,function(richTextEditor){attachmentOids.push(richTextEditor.getUploadedImageOids())}),_.flatten(attachmentOids)},_onRender:function(){this.getRecord()&&this.draw()},_onAfterRenderOfChildComponents:function(){this.record.phantom&&this.titleBar.focusNameField(),this.ribbonNavigation.subscribeToRecordEvents(),this.titleBar.updateRequiredFieldCount(),this.fireEvent("aftercontentrender",this),this.ribbonNavigation.enable(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_onFailure:function(record,errors){this.handleErrors(record,errors)},draw:function(){this.drawHeader(),this.redrawDetailContentWrapper()},removeDetailBody:function(){this.content&&this.remove(this.content)},redraw:function(options){options.record&&this.setRecord(options.record);var record=this.getRecord();if(record.phantom)return void Rally.nav.detail.NavHistory.goBack();var alm="alm",almPackage=Rally[alm];if(almPackage){var hash=this.getController().getBaseUrl()+"/"+record.get("ObjectID");almPackage.navigation.NavigationActionCreators.setToken(hash)}else this.content.redraw&&this.content.redraw(options)},drawHeader:function(){this.titleBar=this._getTitleBar(),this.ribbonNavigation=Ext.create("Rally.ui.detail.view.RibbonNavigation",{baseUrl:this.getDetailsTabHash(),associations:this.getController().getAssociations(),record:this.getRecord()}),this.messageContainer=Ext.create("Ext.container.Container",{cls:"detailMessageContainer",itemId:"detailMessageContainer",hidden:!0}),this.add([this.titleBar,this.ribbonNavigation,this.messageContainer]),this.relayEvents(this.ribbonNavigation,["tabchange"])},getDetailsTabHash:function(){var detailsTabHash=["#",this.uri.scope,"detail",this.uri.typeDef,this.uri.id].join("/");return detailsTabHash},redrawDetailContentWrapper:function(config){this._removeSavedIndicators(),Ext.Object.each(config,function(key,value){this["set"+Ext.String.capitalize(key)](value)},this),this.removeDetailBody();var contentClass=this.getContentClass();this.content=Ext.create(contentClass,Ext.merge({record:this.getRecord(),controller:this.getController()},this.contentClassConfig)),this.add(this.content)},_removeSavedIndicators:function(){var indicatorsToRemove=Ext.ComponentQuery.query("rallydetailsavedindicator");_.each(indicatorsToRemove,function(indicator){indicator.destroy()})},_shouldCollapseBucket:function(bucketConfig){var collapsedBucketsOnNew=["Notes","Custom"],shouldCollapse=this.getRecord().phantom&&_.contains(collapsedBucketsOnNew,bucketConfig.label);if(shouldCollapse&&"Custom"===bucketConfig.label){var hasRequiredFields=_.some(this.getRecord().getFields(),function(field){return field.custom&&field.required});shouldCollapse=!hasRequiredFields}return shouldCollapse},getFields:function(){return _.filter(this.query('[isFormField][submitValue=true][name!=""]'),function(field){return!(field.up("rallygrid")||field.up("rallydetailsubpage")||field instanceof Rally.ui.picker.project.HierarchyAwareMultiObjectProjectPicker)},this)},getMessageContainer:function(){return this.messageContainer},getMessageElement:function(){return this.getMessageContainer()?this.getMessageContainer().getEl():null},showMessage:function(message,cls){var container=this.getMessageElement();container.removeCls(this._messageContainerCls),this._messageContainerCls=cls,container.addCls(cls),container.update(message),container.show()},handleErrors:function(record,errors){var errorMsg=errors&&errors.length>0?"Looks like there was a problem. "+errors[0]:"Unknown Error";Rally.ui.notify.Notifier.showError({message:errorMsg,timeout:1e4})},clearMessages:function(){this._isMessageElementPresent()&&(this.getMessageElement().hide(),Rally.ui.notify.Notifier.hide())},showFileUploadMessage:function(message){this.showMessage(message,"detailFileUpload")},_isMessageElementPresent:function(){return!!this.getMessageElement()},switchToDeleteView:function(deletedRecord){Rally.nav.detail.NavHistory.goBack()},disableRibbon:function(){this.ribbonNavigation&&this.ribbonNavigation.disable()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.SubPage",{alias:"widget.rallydetailsubpage",extend:Ext.container.Container,mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable,messageable:Rally.Messageable},componentCls:"detailSubPage",config:{record:void 0},initComponent:function(){this.callParent(arguments),this.addEvents("aftercontentrender"),this.on("aftercontentrender",this.recordComponentReady,this,{single:!0});var almStr="alm",alm=Rally[almStr];alm&&this.subscribe(this,alm.Message.contentUpdated,this._hideLeftNav,this)},_hideLeftNav:function(){var separator=Ext.get("detail_separator_cell");separator&&separator.remove();var menu=Ext.get("detail_tree_cell");menu&&menu.remove()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.AppSubPage",{alias:"widget.rallydetailappsubpage",extend:Rally.ui.detail.view.content.SubPage,appClass:null,appID:null,initComponent:function(){this.callParent(arguments),this.prepareAppData().then({success:this.createApp,scope:this})},prepareAppData:function(){return Deft.Promise.when([])},createApp:function(){var globalContext=Rally.environment.getContext();this.app=this.add(Ext.create(this.appClass,_.merge({context:Ext.create("Rally.app.Context",{initialValues:{appID:this.appID,user:globalContext.getUser(),subscription:globalContext.getSubscription(),featureToggles:globalContext.context.featureToggles,permissions:globalContext.getPermissions(),workspace:globalContext.getWorkspace(),project:this.record.isMilestone()?this._getMilestoneProjectContext(globalContext):this.record.get("Project"),projectScopeUp:globalContext.getProjectScopeUp(),projectScopeDown:globalContext.getProjectScopeDown()}}),isFullPageApp:!0,record:this.record},this.getAppConfig())))},getAppConfig:function(){return{}},_getMilestoneProjectContext:function(globalContext){var targetProject=this.record.get("TargetProject");if(!targetProject){if(globalContext.getPermissions().isProjectEditor(globalContext.getProject()))return globalContext.getProject();var workspaceUri=Rally.util.Ref.getRelativeUri(globalContext.getWorkspace()),firstEditAccessProjectInCurrentWorkspace=_.find(globalContext.getPermissions().userPermissions,function(p){return("Editor"===p.Role||"ProjectAdmin"===p.Role)&&Rally.util.Ref.getRelativeUri(p.Workspace)===workspaceUri});return firstEditAccessProjectInCurrentWorkspace?Rally.util.Ref.getRelativeUri(firstEditAccessProjectInCurrentWorkspace):null}return targetProject}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DefectSuitesAppSubPage",{alias:"widget.rallydetaildefectsuitesappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appID:-200018,appClass:"Rally.app.apps.CollectionGridBoardApp",getAppConfig:function(){return _.merge(this.callParent(arguments),{rootParentRecord:this.record,parentField:"Defects",parentFieldIsManyToMany:!0,modelNames:["defectsuite"],collectionField:"DefectSuites",statePrefix:this.xtype})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DuplicateDefectsAppSubPage",{alias:"widget.rallydetailduplicatedefectsappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appID:-200019,appClass:"Rally.app.apps.CollectionGridBoardApp",getAppConfig:function(){return _.merge(this.callParent(arguments),{parentField:"Duplicates",parentFieldIsManyToMany:!0,modelNames:["defect"],collectionField:"Duplicates",enableAddNew:!1,gridConfig:{enableInlineAdd:!1,enableRanking:!1,rowActionColumnConfig:{menuOptions:{showWatchMenuItem:!0,showAddTasks:!1,showCopyMenuItem:!1,showAddTestCases:!1,showCopyTasksFrom:!1}}},statePrefix:this.xtype})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DependenciesAppSubPage",{alias:"widget.rallydetaildependenciesappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appClass:"Rally.app.apps.DependenciesApp",appID:-200007,getAppConfig:function(){return _.merge(this.callParent(arguments),{defaultColumnNames:0===this.record.get("_type").indexOf("portfolioitem")?["Name","State","Release","PercentDoneByStoryCount","Owner","Project"]:["Name","ScheduleState","Release","Owner","Project"]})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DiscussionView",{extend:Ext.container.Container,alias:"widget.rallydetaildiscussionview",componentCls:"discussionsView",config:{record:void 0},initComponent:function(){this.callParent(arguments);var field=this.add({xtype:"rallydetailpagediscussionfield",record:this.getRecord()});this.relayEvents(field,["aftercontentrender"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DiscussionSubPage",{extend:Rally.ui.detail.view.content.SubPage,alias:"widget.rallydetaildiscussionsubpage",cls:"discussionSubPage",initComponent:function(){this.callParent(arguments),this.add({xtype:"component",cls:"sub-page-header",html:"DISCUSSION"});var view=this.add({xtype:"rallydetaildiscussionview",record:this.record});this.relayEvents(view,["aftercontentrender"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.ChildrenAppSubPage",{alias:"widget.rallydetailchildrenappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appClass:"Rally.app.apps.ChildrenGridBoardApp",getAppConfig:function(){return _.merge(this.callParent(arguments),{rootParentRecord:this.record,collectionField:this.fieldName})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.PortfolioItemChildrenAppSubPage",{alias:"widget.rallydetailportfolioitemchildrenappsubpage",extend:Rally.ui.detail.view.content.ChildrenAppSubPage,appID:-200010,getAppConfig:function(){return _.merge(this.callParent(arguments),{statePrefix:"portfolioitemchildren"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DeliveryGroupPortfolioItemsSubPage",{extend:Rally.ui.detail.view.content.AppSubPage,alias:"widget.rallydetailportfolioitemssubpage",appClass:"Rally.apps.portfolioitemstreegrid.PortfolioItemsTreeGridApp",getAppConfig:function(){return _.merge(this.callParent(arguments),{enableAddNew:!1,enableImport:!1,isWorkspaceScoped:!0,piTypePickerConfig:{renderInGridHeader:!0},gridStoreConfig:{enableRootLevelPostGet:!0},gridConfig:{shouldShowRowActionsColumn:!1,enableEditing:!1,enableBulkEdit:!1,enableInlineAdd:!1,enableRanking:!1,storeConfig:{remoteFilter:!0,filters:this.getPermanentFilters()}}})},getPermanentFilters:function(){var filters=_.map(this.deliveryGroupProjects,function(project){return{property:"Project",value:project.get("_ref")}});return 0===filters.length&&(filters=[{property:"ObjectID",value:-1}]),[Rally.data.wsapi.Filter.or(filters)]},prepareAppData:function(){var deferred=Ext.create("Deft.Deferred"),projectStore=this.record.getCollection("Projects");return projectStore.load({callback:function(records,operation,success){this.deliveryGroupProjects=records,deferred.resolve()},scope:this}),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.RevisionsSubPage",{extend:Rally.ui.detail.view.content.SubPage,alias:"widget.rallydetailrevisionssubpage",initComponent:function(){this.callParent(arguments),this.addCls("revisionsSubPage"),Rally.data.ModelFactory.getModel({type:"RevisionHistory",success:function(model){this.rendered?this._drawGrid(model):this.on("afterrender",function(){this._drawGrid(model)},this,{single:!0})},scope:this})},_drawGrid:function(model){model.load(this.getRecord().get("RevisionHistory"),{success:function(record){this.add({xtype:"rallygrid",showRowActionsColumn:!1,store:record.getCollection("Revisions",{sorters:[{property:"RevisionNumber",direction:"DESC"}]}),viewConfig:{enableTextSelection:!0},columnCfgs:[{text:"Revision #",sortable:!0,dataIndex:"RevisionNumber",flex:1},{text:"Description",sortable:!1,dataIndex:"Description",flex:10},{text:"Creation Date",dataIndex:"CreationDate",flex:2,renderer:function(value){var TIMEZONE_TOGGLES=Rally.environment.useSystemTimezone||Rally.environment.useWorkspaceTimeZone;return TIMEZONE_TOGGLES?Rally.util.DateTime.formatDate(value,!0):Rally.util.DateTime.formatWithDefaultDateTime(value)}},{text:"Author",dataIndex:"User",sortable:!0,renderer:function(value){return value?value._refObjectName:""}}],listeners:{load:this._onReady,scope:this}})},scope:this})},_onReady:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this._doLayoutWhenImagesAreDoneLoading(),this.fireEvent("aftercontentrender",this,!1)},_doLayoutWhenImagesAreDoneLoading:function(){this.getEl()&&Rally.util.Ui.executeCallbackWhenImagesLoaded(this.getEl().select("img"),this.doLayout,this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.ScheduledItemsAppSubPage",{alias:"widget.rallydetailscheduleappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appClass:"Rally.app.apps.ScheduledItemsApp",appID:-200008,getAppConfig:function(){return _.merge(this.callParent(arguments),{rootParentRecord:this.record})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.UserStoryChildrenAppSubPage",{alias:"widget.rallydetailuserstorychildrenappsubpage",extend:Rally.ui.detail.view.content.ChildrenAppSubPage,appID:-200009,getAppConfig:function(){return _.merge(this.callParent(arguments),{statePrefix:"userstorychildren"})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.DefectsAppSubPage",{alias:"widget.rallydetaildefectsappsubpage",extend:Rally.ui.detail.view.content.ChildrenAppSubPage,appID:-200017,getAppConfig:function(){return _.merge(this.callParent(arguments),{statePrefix:this.xtype})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.TasksAppSubPage",{alias:"widget.rallydetailtasksappsubpage",extend:Rally.ui.detail.view.content.ChildrenAppSubPage,appClass:"Rally.app.apps.TasksGridBoardApp",appID:-200020,getAppConfig:function(config){var parentAppConfig=this.callParent(arguments);return _.merge(parentAppConfig,{enableAddRemoveExisting:!1,addNewConfig:_.merge(parentAppConfig.addNewConfig||{},{ignoredRequiredFields:["Name","Project","ScheduleState","State","TaskIndex","WorkProduct"],rankTo:"BOTTOM"}),gridStoreConfig:_.merge(parentAppConfig.gridStoreConfig||{},{useCompositeArtifacts:!1}),gridConfig:_.merge(parentAppConfig.gridConfig||{},{rankColumnDataIndex:"TaskIndex",enableInlineAdd:!1,enableRanking:!0}),actionMenuItems:[{xtype:"rallyrecordmenuitemcopytasksfrom",record:this.record,cls:""}],statePrefix:this.xtype})},initComponent:function(){this.callParent(arguments),this.subscribe(this,Rally.Message.objectUpdate,this._onObjectUpdate,this),this.subscribe(this,Rally.Message.objectDestroy,this._updateRankOnDelete,this)},_onObjectUpdate:function(record,changedFields){this.app.gridboard.isDestroyed||(this.afterBusUpdatelistener&&this.afterBusUpdatelistener.destroy(),this.afterBusUpdatelistener=this.app.gridboard.getGridOrBoard().getStore().on("afterbusupdate",function(){_.indexOf(changedFields,"Tasks")!==-1&&record.get("ObjectID")===this.app.record.get("ObjectID")&&this.app.gridboard.getGridOrBoard().getStore().reload()},this,{destroyable:!0}))},_updateRankOnDelete:function(removedRecord){if(!this.app.gridboard.isDestroyed){var removedTaskIndex=removedRecord.get("TaskIndex");this.app.gridboard.getGridOrBoard().getStore().each(function(record){var taskIndex=record.get("TaskIndex");taskIndex>removedTaskIndex&&record.set("TaskIndex",taskIndex-1)})}},refresh:function(record){Rally.ui.detail.DetailHelper.getController().getView().redrawDetailContentWrapper()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.TestCasesAppSubPage",{alias:"widget.rallydetailtestcasesappsubpage",extend:Rally.ui.detail.view.content.ChildrenAppSubPage,appID:-200021,getAppConfig:function(){var parentAppConfig=this.callParent(arguments);return _.merge(parentAppConfig,{addNewConfig:_.merge(parentAppConfig.addNewConfig||{},{ignoredRequiredFields:["Name","Project","Method","Type"]}),gridStoreConfig:_.merge(parentAppConfig.gridStoreConfig||{},{useCompositeArtifacts:!0}),statePrefix:this.xtype})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.StateFieldPicker",{alias:"widget.rallychartbuildersettingsstatefieldpicker",extend:Ext.form.FieldSet,mixins:{field:Ext.form.field.Field},border:!1,defaultType:"textfield",flex:1,items:[],layout:"vbox",stateFieldName:null,stateFieldValues:null,width:480,initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this._addStateFieldPicker(),this.on("statefieldnameselected",this._onStateFieldNameSelected),this.on("statefieldnameready",this._onStateFieldNameReady),this.on("statefieldvaluesready",this._onStateFieldValuesReady),this.on("statefieldvalueschanged",this._onStateFieldValuesChanged)},_onStateFieldNameSelected:function(fieldDefinition){this._refreshStateValuesPicker(fieldDefinition.name)},_onStateFieldNameReady:function(){this._updateStateFieldComboboxValue(),this._refreshStateValuesPicker(this.stateFieldName)},_onStateFieldValuesReady:function(combo){if(_.isString(this.stateFieldValues)){var values=[];values=this.stateFieldValues.split(","),combo.setValue(values)}this._publishComponentReady()},_onStateFieldValuesChanged:function(combo,records){this._sortDisplayedStatesByStore(combo,records)},_sortDisplayedStatesByStore:function(combo,records){var i,j,values=[];if(records.length>0)for(i=0;i<records[0].store.data.items.length;i++)for(j=0;j<records.length;j++)records[j].data.StringValue===records[0].store.data.items[i].data.StringValue&&values.push(records[j].data.StringValue);combo.setValue(values),this.stateFieldValues=values.join(",")},_publishComponentReady:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_updateStateFieldComboboxValue:function(){if(this.stateFieldName){var combo=this.down("rallyfieldcombobox");combo.setValue(this.stateFieldName)}},_refreshStateValuesPicker:function(fieldName){var old=this.down("rallyfieldvaluecombobox");old&&this.remove(old),this._addStateValuesPicker(fieldName)},_addStateFieldPicker:function(){var self=this;this.add(_.merge({xtype:"rallyfieldcombobox",bubbleEvents:["statefieldnameselected","statefieldnameready"],fieldLabel:"Field",itemId:"stateFieldName",listeners:{select:function(combo){this.fireEvent("statefieldnameselected",combo.getRecord().get("fieldDefinition")),self.stateFieldName=combo.getRecord().get("fieldDefinition").name},ready:function(combo){combo.store.filter({filterFn:function(record){var attr=record.get("fieldDefinition").attributeDefinition;return attr&&!attr.ReadOnly&&attr.Constrained&&"OBJECT"!==attr.AttributeType&&"COLLECTION"!==attr.AttributeType}}),combo.getRecord()?this.fireEvent("statefieldnameready"):self.fireEvent("ready",self)}},margin:"10px 0 0 0",model:Ext.identityFn("UserStory"),name:"stateFieldName",submitValue:!1,value:self.stateFieldName,width:400},this.stateFieldPickerConfig))},_addStateValuesPicker:function(fieldName){this.add(_.merge({xtype:"rallyfieldvaluecombobox",allowBlank:!1,bubbleEvents:["statefieldvaluesready","statefieldvalueschanged"],displayField:"StringValue",field:fieldName,fieldLabel:"Show states",forceSelection:!0,itemId:"stateFieldValues",listeners:{ready:function(combo){this.fireEvent("statefieldvaluesready",this)},select:function(combo,records){this.fireEvent("statefieldvalueschanged",combo,records)}},listConfig:{itemTpl:Ext.create("Ext.XTemplate",'<div class="statefieldvalue-boundlist-item"><img src="'+Ext.BLANK_IMAGE_URL+'" class="stateFieldValue"/> &nbsp;{StringValue}</div>'),listeners:{afterrender:function(){this.selectedItemCls=Ext.baseCSSPrefix+"boundlist-selected statefieldvalue-boundlist-selected"}}},margin:"10px 0 0 0",multiSelect:!0,model:Ext.identityFn("UserStory"),name:"stateFieldValues",readyEvent:"ready",submitValue:!1,valueField:"StringValue",width:400},this.stateValuePickerConfig))},setValue:function(value){try{var json=JSON.parse(value);Ext.isObject(json)&&(this.stateFieldName=json.name||null,this.stateFieldValues=json.values||null)}catch(e){console.error("error:",e)}},getValue:function(){return JSON.stringify({name:this.stateFieldName,values:this.stateFieldValues})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.easel.EaselChart",{alias:"widget.rallyeaselchart",extend:Ext.Container,cls:"easelchart-ct",height:400,items:[{xtype:"container",flex:1,itemId:"easelchart"},{xtype:"container",cls:"easelchart-controls-ct",itemId:"easelcontrols",width:258}],layout:{type:"hbox",align:"stretch"},chartType:void 0,chartVersion:"0.3.9",loadMask:!0,stateField:{},useCacheBusting:!0,render:function(){this.callParent(arguments),this.down("#easelcontrols").add(this._getControlConfigForChartType(this.chartType)),this._constructIFrame()},_getControlConfigForChartType:function(chartType){switch(chartType){case"milestone-burn":return[this._getPointsOrCountComboConfig({canSelectBothPointsAndCount:!0,context:Rally.environment.getContext(),fieldLabel:"Burndown Chart Unit",plugins:[this._preferenceEnabledComboBox("milestone-burndown-unit")]})];case"milestone-cumulative-flow":return[this._getPointsOrCountComboConfig({context:Rally.environment.getContext(),fieldLabel:"Cumulative Flow Chart Unit",plugins:[this._preferenceEnabledComboBox("milestone-cum-flow-unit")]}),{xtype:"rallychartbuildersettingsstatefieldpicker",listeners:{statefieldnameselected:this._stateFieldNameChanged,statefieldvalueschanged:this._stateFieldValuesChanged,scope:this},name:"stateField",stateFieldName:this.stateField.name,stateFieldPickerConfig:{context:Rally.environment.getContext(),fieldLabel:"Cumulative Flow Field",labelAlign:"top",plugins:[this._preferenceEnabledComboBox("milestone-cum-flow-field")],width:238},stateValuePickerConfig:{allowNoEntry:!1,context:Rally.environment.getContext(),fieldLabel:"Cumulative Flow Shown States",labelAlign:"top",plugins:[this._preferenceEnabledComboBox("milestone-cum-flow-shown-states")],width:238}}]}},_getPointsOrCountComboConfig:function(config){return _.merge({xtype:"rallycombobox",displayField:"label",editable:!1,hideLabel:!1,labelAlign:"top",listeners:{change:{fn:this._pointCountValueChanged,scope:this}},name:"pointsOrCount",store:{xtype:"store",data:[{label:"Points",value:"points"},{label:"Count",value:"count"}].concat(config.canSelectBothPointsAndCount?[{label:"Points and Count",value:"both"}]:[]),fields:["label","value"]},valueField:"value",width:238},config)},_stateFieldNameChanged:function(field){this.stateField.name=field.name,this._getChartWrapper().update(""),this._constructIFrame()},_stateFieldValuesChanged:function(target,values){this.stateField.values=_(values).filter(function(value){return!_.contains(value.get("StringValue"),"No Entry")}).map(function(value){return value.get("StringValue")}).value().join(","),this._getChartWrapper().update(""),this._constructIFrame()},_pointCountValueChanged:function(target,value){this._getChartWrapper().update(""),this.pointsOrCount=value,this._constructIFrame()},_preferenceEnabledComboBox:function(prefName){return{ptype:"rallypreferenceenabledcombobox",preferenceName:prefName}},_getUrlSearchString:function(){return location.search||""},_isDebugMode:function(){var parameters=Ext.Object.fromQueryString(this._getUrlSearchString());return"false"===parameters.packtag},_constructIFrame:function(){var chartWrapper=this._getChartWrapper();if(!chartWrapper.rendered)return void chartWrapper.on("afterrender",this._constructIFrame,this,{single:!0});var filename=this._isDebugMode()?"almchart.html":"almchart.min.html",version=this.chartVersion,url=this._getQuesoUrl()+"/"+version+"/"+filename,cwdom=chartWrapper.el.dom;cwdom.innerHTML='<iframe frameborder="0" style="overflow:hidden;" scrolling="no" width="100%" height="100%" src="'+url+'"></iframe>',cwdom.firstChild.almBridge=this},_getQuesoUrl:function(){return window.burroUrl+"/queso"},getContext:function(){return Rally.environment.getContext()},_getChartWrapper:function(){return this.down("#easelchart")},getSetting:function(name){return this[name]},lbapiBaseUrl:function(){return Rally.environment.getServer().getLookbackUrl()},wsapiBaseUrl:function(){return Rally.environment.getServer().getWsapiUrl()},getProjectScopingUp:function(){return this.getContext().getProjectScopeUp()},getProjectScopingDown:function(){return this.getContext().getProjectScopeDown()},getWorkspace:function(){return this.getContext().getWorkspace()},getProject:function(){return this.getContext().getProject()},log:function(a,b){},showSettings:function(){console.error(this.chartType+" is not configured properly, check your configuration")},registerSettingsFields:function(){},setLoading:function(isLoading){isLoading?this.getEl().mask("Loading..."):this.getEl().unmask()},getChartType:function(){return this.chartType}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.ChartSubPage",{extend:Rally.ui.detail.view.content.SubPage,alias:"widget.rallydetailchartsubpage",afterRender:function(){this.callParent(arguments),this.add({xtype:"rallyeaselchart",chartType:"milestone-burn",milestone:this.getRecord().get("ObjectID"),pointsOrCount:"points"}),this.add({xtype:"rallyeaselchart",chartType:"milestone-cumulative-flow",milestone:this.getRecord().get("ObjectID"),pointsOrCount:"points",stateField:{name:"ScheduleState",values:"Idea,Defined,In-Progress,Completed,Accepted,Released"}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.content.ExpertiseDemandAppSubPage",{alias:"widget.rallydetailexpertisedemandappsubpage",extend:Rally.ui.detail.view.content.AppSubPage,appClass:"Rally.app.GridBoardApp",appID:200033,getAppConfig:function(){return _.merge(this.callParent(arguments),{cls:"expertisedemandappsubpage",columnNames:["Expertise","Amount"],enableImport:!1,enableCsvExport:!1,enablePrint:!1,enableRanking:!1,modelNames:["expertisedemand"],statePrefix:"expertisedemand",renderTo:Ext.getBody(),gridConfig:{enableBulkEdit:!1,rowActionColumnConfig:{rowActionsFn:function(record){return[{xtype:"rallyrecordmenuitemdelete",record:record,showConfirmation:!1,afterAction:function(record){var comboStore=Ext.ComponentQuery.query("rallycombobox")[0].getStore();comboStore.removeFilter(record.get("Expertise")._refObjectName)}}]}},columnCfgs:[{text:"Name",dataIndex:"Expertise",flex:1,getSortParam:function(){return"Expertise.Name"}},{text:"Estimate",dataIndex:"Amount",flex:10,align:"left"}],noDataPrimaryText:"No expertise selected for this portfolio item.",noDataSecondaryText:"To add expertise and demand to this portfolio item, use the search box above."},gridStoreConfig:{enableHierarchy:!1,autoLoad:!0,remoteSort:!0,fetch:["Expertise","Amount","Name"],filters:[{property:"PortfolioItem",operator:"=",value:this.record.get("_ref")}],sorters:[{property:"Expertise.Name"}]},getGridBoardPlugins:function(){var piRecord=this.record;return[{ptype:"rallygridboardaddnew",addNewControlConfig:{alwaysExpanded:!0,additionalFields:[{xtype:"rallycombobox",editable:!0,emptyText:"Search Expertise...",forceSelection:!0,preventMark:!0,selectOnFocus:!1,typeAhead:!0,autoExpand:!0,defaultSelectionPosition:null,validator:function(){return this.store.find("_ref",this.getValue())>=0},allowBlank:!1,name:"Expertise",storeConfig:{autoLoad:!0,model:Ext.identityFn("expertise"),remoteFilter:!1,remoteSort:!1,limit:200,listeners:{load:function(){piRecord.getCollection("ExpertiseDemands").load({callback:function(records){_.each(records,function(record){var value=record.get("Expertise")._refObjectName,filter=Ext.create("Rally.data.wsapi.Filter",{id:value,property:"_refObjectName",operator:"!=",value:value});this.addFilter(filter)},this)},scope:this})}},sorters:[{property:"Name"}]}}],ignoredRequiredFields:["Amount","PortfolioItem"],requiredFieldValues:[{fieldName:"Amount",value:0},{fieldName:"PortfolioItem",value:this.record.get("_ref")}],openEditorAfterAddFailure:!1,showAddWithDetails:!1,showFieldLabel:!1,showNameField:!1,showRank:!1,listeners:{create:function(cmp,record){var comboStore=this.down("rallycombobox").getStore(),value=record.get("Expertise")._refObjectName,filter=Ext.create("Rally.data.wsapi.Filter",{id:value,property:"_refObjectName",operator:"!=",value:value});comboStore.addFilter(filter)}}}}]}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailViewFactory",{singleton:!0,getDetailView:function(config,uriString,context){var uri=Rally.ui.detail.view.DetailView.parseUri(uriString);Rally.ui.detail.DetailHelper.setFeatures(context);var contentClassConfig=this.getContentClass(uri,config.record,config.legacySubPage);return contentClassConfig?Ext.create("Rally.ui.detail.view.DetailView",Ext.apply({uri:uri},contentClassConfig,config)):null},getContentClass:function(uri,record,legacySubPage){var section=uri.section;if(!section||Ext.Array.contains(["new","edit","copy"],section))return Rally.ui.detail.view.content.DetailEditor;var subPages={children:"hierarchicalrequirement"===record.get("_type")?Rally.ui.detail.view.content.UserStoryChildrenAppSubPage:Rally.ui.detail.view.content.PortfolioItemChildrenAppSubPage,dependencies:Rally.ui.detail.view.content.DependenciesAppSubPage,defects:Rally.ui.detail.view.content.DefectsAppSubPage,defectsuites:Rally.ui.detail.view.content.DefectSuitesAppSubPage,discussion:Rally.ui.detail.view.content.DiscussionSubPage,duplicates:Rally.ui.detail.view.content.DuplicateDefectsAppSubPage,predecessors:Rally.ui.detail.view.content.DependenciesAppSubPage,deliveryGroupPortfolioItems:Rally.ui.detail.view.content.DeliveryGroupPortfolioItemsSubPage,revisions:Rally.ui.detail.view.content.RevisionsSubPage,scheduled:Rally.ui.detail.view.content.ScheduledItemsAppSubPage,successors:Rally.ui.detail.view.content.DependenciesAppSubPage,tasks:Rally.ui.detail.view.content.TasksAppSubPage,userstories:Rally.ui.detail.view.content.UserStoryChildrenAppSubPage};"milestone"===record.get("_type")&&Rally.ui.detail.DetailHelper.featureEnabled("A2_ENABLE_CHARTING_APPLICATIONS")&&(subPages.chart=Rally.ui.detail.view.content.ChartSubPage),Rally.ui.detail.DetailHelper.featureEnabled("F7598_EXPERTISE")&&(subPages.expertise=Rally.ui.detail.view.content.ExpertiseDemandAppSubPage);var newSubPage=subPages[section];if(newSubPage)return{contentClass:newSubPage,contentClassConfig:{fieldName:section}};var controller=Rally.ui.detail.controller.DetailController.getController({record:record});return Ext.Array.contains(controller.getAssociations(),section)?{contentClass:legacySubPage}:null}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DetailViewInterface",{clearMessages:Ext.emptyFn,handleErrors:Ext.emptyFn,getAttachmentOids:function(){return[]},getFields:function(){return[]},getMessageContainer:function(){return Ext.ComponentQuery.query("#detailMessageContainer")[0]},redraw:Ext.emptyFn,redrawDetailContentWrapper:Ext.emptyFn,showMessage:Ext.emptyFn})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.DisplayColorField",{extend:Ext.Component,alias:"widget.rallydetailcolorpickerfield",mixins:{messageable:Rally.Messageable},cls:"display-color-field",editable:!0,readOnly:!1,
maskOnDisable:!1,config:{record:void 0,field:void 0},initComponent:function(){this.addEvents("blur"),this.tpl=Ext.create("Rally.ui.renderer.template.DisplayColorTemplate"),this.selectedColor=this.record.get("DisplayColor"),this.data=this.getSubmitData(),this.callParent(arguments)},afterRender:function(){this.editable&&(this.getEl().addCls("editable"),this.getEl().on("click",function(){Rally.ui.popover.PopoverFactory.bake({field:"Color",target:this.getEl(),record:this.record,autoShow:!0,saveOnBlur:!1,listeners:{select:function(popover,selectedColor){this.selectedColor=selectedColor,this.update(this.getSubmitData()),this.fireEvent("blur")},scope:this}})},this))},getSubmitData:function(){return{DisplayColor:this.selectedColor}},isEmpty:function(){return!1}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.project.MostRecentlyUsedProjects",{extend:Ext.Container,alias:"widget.rallymostrecentlyusedprojects",componentCls:"mostRecentlyUsedProjects",config:{workspaceObjectID:void 0,getProjectsFn:void 0},constructor:function(config){this.initConfig(config),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addEvents("select","load"),this._loadMostRecentlyUsedProjects({success:this._drawMostRecentlyUsedProjects,scope:this})},_loadMostRecentlyUsedProjects:function(options){Rally.data.PreferenceManager.load({cache:!1,filterByUser:!0,filterByName:this._getPrefName(),success:function(pref){var prefValue=pref[this._getPrefName()];if(!prefValue)return void options.success.call(options.scope,[]);var oids=prefValue.split(",");this._loadProjects(options,oids)},scope:this})},_loadProjects:function(options,oids){var filter=this._buildFilter(oids);Ext.create("Rally.data.wsapi.Store",{model:Ext.identityFn("project"),autoLoad:!0,fetch:["Name"],filters:filter,listeners:{load:function(store,projects){var sortedProjects=this._sortProjects(oids,projects);options.success.call(options.scope,sortedProjects)},scope:this}})},_sortProjects:function(oids,projects){return Ext.Array.sort(projects,function(project1,project2){return Ext.Array.indexOf(oids,project1.get("ObjectID")+"")-Ext.Array.indexOf(oids,project2.get("ObjectID")+"")})},_getPrefName:function(){return"workspace."+this.getWorkspaceObjectID()+".mruprojects"},_buildFilter:function(oids){var filter;return Ext.each(oids,function(oid,index){filter=0===index?Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",value:oid}):filter.or({property:"ObjectID",value:oid})}),filter},_drawMostRecentlyUsedProjects:function(projects){if(0===projects.length)return void this.fireEvent("load",projects);var projectItems=_.map(projects,function(project){return{xtype:"component",autoEl:"li",cls:"most-recently-used-project-item",renderTpl:'<a href="#">{Name}</a>',renderData:project.data,renderSelectors:{link:"a"},listeners:{click:{element:"link",fn:function(){this.fireEvent("select",project)},stopEvent:!0},scope:this},project:project}},this);this.add({xtype:"container",cls:"mostRecentlyUsedProjectsContent",items:[{xtype:"component",autoEl:"label",html:"Recent Projects"},{xtype:"container",autoEl:"ul",items:projectItems}]}),this.fireEvent("load",projects)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.MostRecentlyUsedProjects",{extend:Rally.ui.picker.project.MostRecentlyUsedProjects,alias:"widget.rallydetailmostrecentlyusedprojects",treeStore:void 0,_loadProjects:function(options,oids){this.treeStore.getRootNode()&&this.treeStore.getRootNode().hasChildNodes()?options.success.call(options.scope,this._getProjectsFromTreeByOids(oids)):this.treeStore.on("load",function(){options.success.call(options.scope,this._getProjectsFromTreeByOids(oids))},this)},_getProjectsFromTreeByOids:function(oids){var projects=[],root=this.treeStore.getRootNode();return _.each(oids,function(oid){var project=root.findChildBy(function(node){return node.get("oid").toString()===oid},this,!0);project&&project.get("isEditable")&&projects.push(project)}),projects}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.MultiButtonToggle",{extend:Ext.Toolbar,config:{baseCls:"rally-multi-button-toggle",toggleIndex:0},layout:"auto",alias:"widget.rallymultibuttontoggle",constructor:function(config){Ext.tip.QuickTipManager.init(),this.initConfig(config),this.callParent(arguments)},onRender:function(){Ext.tip.QuickTipManager.init(),this.callParent(arguments),this.items.each(function(item){item.on("click",this._toggle,this)},this),this.items.getAt(this.toggleIndex).disable()},isToggledOn:function(toggleIndex){return this.items.getAt(toggleIndex).isDisabled()},_toggle:function(toggle){toggle.disable(),this.items.getAt(this.toggleIndex).enable(),this.toggleIndex=this.items.indexOf(toggle)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.MultiValueField",{extend:Ext.container.Container,alias:"widget.rallydetailmultivaluefield",mixins:{messageable:Rally.Messageable},cls:"rally-detail-multi-value-field",layout:"hbox",config:{record:void 0,field:void 0,readOnly:!1},maskOnDisable:!1,isEmpty:function(){return!1},_refreshViewer:function(){this.viewer.update(this.record.data)},_viewerClicked:function(){this.popover&&this.popover.isVisible()||(this.popover=Ext.create("Rally.ui.popover.MvcfEditorPopover",{record:this.getRecord(),field:this.getField(),target:this.getEl(),viewer:this,placement:"bottom",offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:0,y:7},{x:0,y:0}],delegate:this,readOnly:this.getReadOnly()}),this.popover._getStore()&&(this.popover._getStore().addListener("write",this._refreshViewer,this),this.popover._getStore().addListener("write",this._fireSavedIndicator,this),this.popover._getStore().addListener("datachanged",this._refreshViewer,this)))},constructor:function(config){this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addCls(Ext.baseCSSPrefix+"form-item-body"),this.addCls(Ext.baseCSSPrefix+"form-trigger-input-cell"),this.viewer=Ext.create("Ext.Component",{cls:"multi-value-field-value",data:this.record.data,width:"100%",tpl:Ext.create("Rally.ui.renderer.template.CollectionTemplate",{fieldName:this.field.name,wrapWithAnchorTag:!0})}),this.add(this.viewer),this.getReadOnly()?this.addCls("readonly"):this.search=this.add({xtype:"component",html:'<div class="icon-search rally-search-button"></div>'}),this.viewer.on("afterrender",function(){this.getReadOnly()&&!this._hasSelectedItems()||this.getEl().on("click",this._viewerClicked,this),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},this)},_hasSelectedItems:function(){return this.getRecord().get(this.field.name)._tagsNameArray.length>0},_fireSavedIndicator:function(){this.fireEvent("collectionsaved",this.getRecord())},getSavedIndicatorTarget:function(){return this}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.NameFieldTag",{extend:Ext.Component,alias:"widget.rallydetailnamefieldtag",mixins:{tooltippable:Rally.ui.tooltip.ToolTippable},toolTipText:"",cls:"namefieldtag",initComponent:function(){this.callParent(arguments),this.on("afterrender",this.buildToolTip,this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.ProjectsField",{extend:Ext.container.Container,alias:"widget.rallydetailprojectsfield",mixins:{messageable:Rally.Messageable},cls:"rally-detail-projects-field",editable:!0,height:350,config:{record:void 0,field:void 0},maskOnDisable:!1,getSavedIndicatorTarget:function(){return this.picker},isEmpty:function(){return!1},initComponent:function(){this.callParent(arguments);var project=this.record.get("Project")||Rally.environment.getContext().getProject(),editable=Rally.ui.detail.DetailHelper.isDetailPageFieldEditable(this.field,this.record),pickerContainer=Ext.create("Ext.container.Container",{height:300});this.add(pickerContainer),this.add(Ext.create("Ext.container.Container",{html:'<div class="rally-detail-projects-field-helptxt">Hold down the <span>Shift</span> key when selecting a project to select or deselect all child projects.</div>'})),editable||this.addCls("readonly");var me=this;pickerContainer.on("afterrender",function(){me.picker=Ext.create("Rally.ui.picker.project.HierarchyAwareMultiObjectProjectPicker",{editable:editable,currentProject:project._ref,renderTo:pickerContainer.getTargetEl()}),Rally.BrowserTest&&me.picker.on("afteralignpicker",function(){Rally.BrowserTest.publishComponentReady(me)}),pickerContainer.add(me.picker),me.picker.on("blur",me._onPickerBlur,me),me.subscribe(me,Rally.Message.objectUpdate,me._onObjectUpdate,me),me.detailEditorMsgBus.on("detail-any-bucket-toggle",me._onBucketToggle,me)}),this.record.getCollection("Projects",{fetch:["Name"]}).load({scope:this,callback:function(records){this.picker.setValue(records)}}),this.on("bucketexpanded",this._expand,this),this.on("bucketcollapsed",this._collapse,this)},_onBucketToggle:function(){this.picker&&this.picker.isExpanded&&this.picker.doAlign()},_collapse:function(){this.picker&&(this.picker.setAlwaysExpanded(!1),this.picker.collapse())},_expand:function(){this.picker&&(this.picker.setAlwaysExpanded(!0),this.picker.expand())},getSubmitData:function(){return{Projects:this.getValue()}},getValue:function(){var selectedProjects=this.picker.getValue();return _.map(selectedProjects,function(projectRecord){return{Name:projectRecord.get("Name"),_ref:projectRecord.get("_ref")}})},_onPickerBlur:function(){this.fireEvent("blur",{field:this.field,scope:this})},_onObjectUpdate:function(updatedRecord){this.picker.resetOriginalValue(),this.picker.isExpanded&&this.picker.blur(),updatedRecord.getCollection("Projects",{fetch:["Name"]}).load({scope:this,callback:function(records,operation,success){this.picker.setValue(records)}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.RequiredFieldCountTag",{extend:Rally.ui.detail.view.NameFieldTag,alias:"widget.rallydetailrequiredfieldcounttag",renderData:{requiredFieldCount:void 0},style:{display:"none"},config:{initialRequiredFieldCount:void 0},cls:"requiredfieldcount namefieldtag",renderTpl:"{requiredFieldCount} req",toolTipText:"Required fields missing",constructor:function(config){this.renderData={requiredFieldCount:config.initialRequiredFieldCount},this.callParent(arguments)},initComponent:function(config){this.callParent(arguments),this._updateVisibility(this.getInitialRequiredFieldCount())},updateCount:function(requiredFieldCount){this._updateCountText(requiredFieldCount),this._updateVisibility(requiredFieldCount)},hasCountChanged:function(requiredFieldCount){return this.renderData.requiredFieldCount!==requiredFieldCount},_updateCountText:function(requiredFieldCount){this.renderData.requiredFieldCount=requiredFieldCount;var renderedTemplate=this.renderTpl.apply(this.renderData);this.getEl()&&this.getEl().update(renderedTemplate)},_updateVisibility:function(requiredFieldCount){this.getEl()&&(0===requiredFieldCount?this.getEl().hide():this.getEl().show())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.detail.view.TargetProjectField",{extend:Ext.container.Container,alias:"widget.rallydetailtargetprojectfield",mixins:{messageable:Rally.Messageable},plugins:["rallydetailonobjectupdate"],cls:"target-project-field",dialogOpen:!1,editable:!0,maskOnDisable:!1,milestoneRecord:null,name:"TargetProject",initComponent:function(){this.callParent(arguments),this.editable?this.picker=this.add({xtype:"rallymilestoneprojectcombobox",value:this.value,milestoneRecord:this.milestoneRecord,name:this.name,bubbleEvents:["blur","change","select"],listeners:{ready:this._onReady,scope:this}}):(this.addCls("readonly"),this.add({xtype:"rallytextfield",cls:"target-project-text-field",readOnly:!0,value:Rally.ui.MilestoneTargetProjectPermissionsHelper.getProjectName(this.milestoneRecord,!0,Rally.environment.getContext())}),this._onReady())},getSavedIndicatorTarget:function(){return this.picker||this.getEl()},getSubmitData:function(){return this.picker?this.picker.getSubmitData():{}},_onReady:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},onObjectUpdate:function(record){record.get("_ref")===this.milestoneRecord.get("_ref")&&(this.milestoneRecord=record)},isEmpty:function(){return!1},onDestroy:function(){this.callParent(arguments)},getRecord:function(){return this.milestoneRecord}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.AbstractChooserDialogController",{requires:[],extend:Rally.ui.ViewController,control:{selectButton:{click:"onSelectButtonClick"},cancelButton:{click:"onCancelButtonClick"}},onSelectButtonClick:Ext.emptyFn,constructor:function(){this.mergeControl(),this.callParent(arguments)},onCancelButtonClick:function(){this.getView().close()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.AbstractChooserDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallyabstractchooserdialog",controller:"Rally.ui.dialog.AbstractChooserDialogController",clientMetrics:[{endEvent:"ready",description:"dialog ready"}],layout:"fit",closable:!0,draggable:!0,config:{title:"Choose Item",selectionButtonText:"Select"},buildChooser:Ext.emptyFn,constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addCls(["chooserDialog","chooser-dialog"]),this._buildButtons(),this._createChooser()},_createChooser:function(){return chooser=this.buildChooser(),chooser?this.mon(chooser,"ready",function(){this.fireEvent("ready",this)},this):this.fireEvent("ready",this),this.add({xtype:"container",items:[{xtype:"component",html:"Apply the following "+this.type+" for the <b>"+this.records.length+"</b> checked items:",cls:"rui-info-label",height:16},chooser]}),chooser},_buildButtons:function(){this.addDocked({xtype:"toolbar",dock:"bottom",padding:"8px 0 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",itemId:"selectButton",text:this.getSelectionButtonText(),cls:"primary rly-small",userAction:"clicked apply in chooser dialog"},{xtype:"rallybutton",itemId:"cancelButton",text:"Cancel",cls:"secondary rly-small",ui:"link"}]})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.ArtifactCollectionChooserDialog",{alias:"widget.rallyartifactcollectionchooserdialog",extend:Rally.ui.dialog.ArtifactChooserDialog,mixins:[Rally.Messageable],collectionStoreToAddTo:null,constructor:function(config){this.callParent([_.merge({artifactTypes:[config.collectionStoreToAddTo.model.typeName],autoShow:!0,multiple:!0},config)])},initComponent:function(){this.callParent(arguments),this.addEvents("addsuccess","addfailure")},onArtifactChosen:function(){var selectedRecords=Ext.Array.from(this.selectionCache),recordsToAdd=_.reject(selectedRecords,function(record){return this.collectionStoreToAddTo.findExactRecord(record.get("_ref"))},this);this.collectionStoreToAddTo.suspendEvents(),this.collectionStoreToAddTo.add(recordsToAdd),this.collectionStoreToAddTo.sync().then({failure:function(batch){this.collectionStoreToAddTo.remove(recordsToAdd),this.fireEvent("addfailure",this,batch)},success:function(){var record=this.collectionStoreToAddTo.record.copy();_.isFunction(record.updateCollectionCount)&&record.updateCollectionCount(this.collectionStoreToAddTo.fieldName,selectedRecords.length+this.collectionStoreToAddTo.getTotalCount()),this.publish(Rally.Message.objectUpdate,record,[this.collectionStoreToAddTo.fieldName],this,[record]),this.fireEvent("addsuccess",this)},scope:this}).always(function(){this.collectionStoreToAddTo.resumeEvents(),this.close()},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.BulkEditDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallybulkeditdialog",statics:{BLACKLISTED_FIELDS_ACROSS_MODELS:["State","ScheduleState"]},autoShow:!0,cls:"bulk-edit-dialog",closable:!0,draggable:!0,title:"Bulk Edit...",width:375,clientMetrics:[{event:"beforeshow",description:"dialog invoked"},{method:"_onFieldSelect",description:"edit field selected"},{event:"edit",description:"edit performed"}],config:{records:null},initComponent:function(){this.callParent(arguments),this.addEvents("edit"),this.add({xtype:"component",cls:"directions rui-info-label",renderTpl:Ext.create("Ext.XTemplate","For the <tpl><b>{[values.recordCount]}</b></tpl> checked ",'<tpl if="recordCount === 1">item<tpl else>items</tpl> apply the following values:'),renderData:{recordCount:this.records.length}},{xtype:"container",itemId:"form-container",cls:"form-container",items:[{xtype:"rallycombobox",autoExpand:!0,itemId:"editField",store:Ext.create("Ext.data.Store",{fields:["name","displayName"],data:this._getValidFields()}),defaultSelectionPosition:null,displayField:"displayName",emptyText:"Choose Field...",valueField:"name",listeners:{select:this._onFieldSelect,scope:this}},{xtype:"component",cls:"text",html:" to "},{xtype:"rallycombobox",disabled:!0,itemId:"editValue",store:Ext.create("Ext.data.Store",{fields:[]}),emptyText:"Choose Value..."}]}),this.addDocked({xtype:"toolbar",dock:"bottom",padding:"0 0 10 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",itemId:"applyButton",text:"Apply",cls:"primary rly-small",disabled:!0,handler:this._onApplyClicked,scope:this},{xtype:"rallybutton",text:"Cancel",cls:"secondary rly-small",handler:function(){this.close()},scope:this}]})},afterRender:function(){this.callParent(arguments),this.down("#editField").focus(!1,150)},_onApplyClicked:function(){var valueField=this.down("#editValue"),args={field:this.records[0].self.getField(this.down("#editField").getValue()),value:valueField.getValue()};if(Ext.isFunction(valueField.getRecord)){var record=valueField.getRecord();args.displayValue=record?record.get(valueField.displayField):null}else Ext.isDate(valueField.getValue())&&(args.displayValue=valueField.getRawValue());this.fireEvent("edit",this,args),this.close()},_fieldIsBulkEditable:function(field){var fieldDefAttr=field.attributeDefinition;return field.editor&&!field.readOnly&&!field.hidden&&!field.isMappedFromArtifact&&("OBJECT"===fieldDefAttr.AttributeType&&fieldDefAttr.Constrained||!_.contains(["TEXT","COLLECTION"],fieldDefAttr.AttributeType))&&this._fieldCanBeEditedForAllRecords(field)},_fieldCanBeEditedForAllRecords:function(field){return"milestone"!==field.modelType||"TargetProject"!==field.name||_.every(this.records,function(record){return Rally.ui.MilestoneTargetProjectPermissionsHelper.canEdit(record)})},_isFieldOnAllModels:function(models,field){return _.every(models,function(model){return model.hasField(field.name)&&model.getField(field.name).attributeDefinition.AttributeType===field.attributeDefinition.AttributeType})},_isFieldBlacklistedForEditingOnAnyModel:function(models,field){return _.any(models,function(model){return Rally.ui.grid.FieldColumnFactory.isFieldBlacklistedForEditingOnGrids(field,model)})},_isFieldBlacklistedForEditingAcrossModels:function(models,field){return models.length>1&&_.contains(this.self.BLACKLISTED_FIELDS_ACROSS_MODELS,field.name)},_getValidFields:function(){var models=_(this.records).pluck("self").unique().value();return _(models[0].getFields()).filter(this._fieldIsBulkEditable,this).filter(_.curry(this._isFieldOnAllModels)(models)).reject(_.curry(this._isFieldBlacklistedForEditingAcrossModels.bind(this))(models)).reject(_.curry(this._isFieldBlacklistedForEditingOnAnyModel)(models)).sortBy("displayName").value()},_isDropdownField:function(fieldDef){return _.contains(fieldDef.editor.xtype,"combobox")||_.contains(fieldDef.editor.xtype,"rallyrecordcontexteditor")},_prepareDropdownEditorConfig:function(editorConfig){var fetch=this._getFetchForConfig(editorConfig),config=Ext.merge(editorConfig,{defaultSelectionPosition:null,editable:!0,emptyText:"Choose Value...",listeners:{select:function(cmp){this.down("#applyButton").setDisabled(!1)},scope:this},value:null});return"Project"===config.name?config.xtype="rallyprojectcombobox":config=Ext.merge(config,{storeConfig:{fetch:fetch,autoLoad:!0,context:this.records[0].self.context,requester:this}}),config},_getFetchForConfig:function(editorConfig){var clazz=Ext.ClassManager.getByAlias("widget."+editorConfig.xtype);return clazz.prototype.config.storeConfig&&clazz.prototype.config.storeConfig.fetch?clazz.prototype.config.storeConfig.fetch:[clazz.prototype.valueField,clazz.prototype.displayField]},_prepareTextEditorConfig:function(editorConfig){return Ext.merge(editorConfig,{emptyText:"Enter Value...",listeners:{validitychange:function(cmp,isValid){this.down("#applyButton").setDisabled(!isValid)},scope:this}})},_prepareEditor:function(fieldDef){var editorConfig=fieldDef.editor;editorConfig.field&&editorConfig.field.xtype&&(editorConfig=editorConfig.field),editorConfig=Ext.apply({itemId:"editValue",width:150,enableKeyEvents:!0,listeners:{keyup:function(cmp,e){this.down("#applyButton").isDisabled()||e.getKey()!==Ext.EventObject.ENTER||this._onApplyClicked()}}},editorConfig),this._isDropdownField(fieldDef)?(this.down("#applyButton").setDisabled(!0),editorConfig=this._prepareDropdownEditorConfig(editorConfig)):(this.down("#applyButton").setDisabled(fieldDef.required),editorConfig=this._prepareTextEditorConfig(editorConfig));var field=this.down("#form-container").add(editorConfig);Ext.isFunction(field.setProject)&&field.setProject(this.records[0].self.context.project||Rally.environment.getContext().getProjectRef())},_onFieldSelect:function(combo,selected){var valueField=this.down("#editValue"),fieldDef=this.records[0].self.getField(selected[0].get(combo.valueField));valueField&&valueField.destroy(),this._prepareEditor(fieldDef)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.BulkierEditDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallybulkiereditdialog",statics:{BLACKLISTED_FIELDS_ACROSS_MODELS:["State","ScheduleState"]},autoShow:!0,cls:"bulkier-edit-dialog",closable:!0,draggable:!0,title:"Bulk Edit...",width:425,clientMetrics:[{event:"beforeshow",description:"dialog invoked"},{method:"_onFieldSelect",description:"edit field selected"},{event:"edit",description:"edit performed"}],config:{records:null},initComponent:function(){this.callParent(arguments),this.addEvents("edit"),this.add({xtype:"component",cls:"directions rui-info-label",renderTpl:Ext.create("Ext.XTemplate","For the <tpl><b>{[values.recordCount]}</b></tpl> checked ",'<tpl if="recordCount === 1">item<tpl else>items</tpl> apply the following values:'),renderData:{recordCount:this.records.length}},{xtype:"container",itemId:"form-container",cls:"form-container"}),this.addDocked({xtype:"toolbar",dock:"bottom",padding:"0 0 10 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",itemId:"applyButton",text:"Apply",cls:"primary rly-small",disabled:!0,handler:this._onApplyClicked,scope:this},{xtype:"rallybutton",text:"Cancel",cls:"secondary rly-small",handler:function(){this.close()},scope:this}]}),this.addRow()},addRow:function(){var lastRow=_.last(this.getRows());lastRow&&lastRow.down("#plusButton").setDisabled(!0),this.down("#form-container").add({xtype:"container",cls:"bulkEditDialogRow",isValid:!1,items:[{xtype:"rallybutton",border:!1,cls:"row-btn minus",frame:!1,iconCls:"icon-minus",itemId:"minusButton",userAction:"Removed Row",listeners:{click:this.removeRow,scope:this}},this.getPlusButton(),{xtype:"rallycombobox",autoExpand:!0,itemId:"editField",store:Ext.create("Ext.data.Store",{fields:["name","displayName"],data:this._getValidFields()}),defaultSelectionPosition:null,displayField:"displayName",emptyText:"Choose Field...",valueField:"name",listeners:{select:this._onFieldSelect,scope:this}},{xtype:"component",cls:"text",html:" to "},this.getValueField()]}),this.down("#applyButton").setDisabled(!0)},getPlusButton:function(){return{xtype:"rallybutton",border:!1,frame:!1,cls:"row-btn plus",disabled:!1,itemId:"plusButton",iconCls:"icon-plus",userAction:"Added Row",listeners:{click:this.addRow,scope:this}}},enableApplyButton:function(){this.allRowsValid()&&this.down("#applyButton").setDisabled(!1)},getValueField:function(){return{xtype:"rallycombobox",disabled:!0,itemId:"editValue",store:Ext.create("Ext.data.Store",{fields:[]}),emptyText:"Choose Value..."}},removeRow:function(btn){btn.up().destroy();var rows=this.getRows();rows.length?_.last(rows).down("#plusButton").setDisabled(!1):this.addRow(),this.enableApplyButton()},getRows:function(){return Ext.ComponentQuery.query('container[cls="bulkEditDialogRow"]')},allRowsValid:function(){return _.every(this.getRows(),function(row){return row.isValid})},afterRender:function(){this.callParent(arguments),this.down("#editField").focus(!1,150)},_onApplyClicked:function(){var args=_.map(this.getRows(),function(row){return{field:this.records[0].self.getField(row.down("#editField").getValue()),value:row.down("#editValue").getValue()}},this);this.fireEvent("edit",this,args),this.close()},_fieldIsBulkEditable:function(field){var fieldDefAttr=field.attributeDefinition;return field.editor&&!field.readOnly&&!field.hidden&&!field.isMappedFromArtifact&&("OBJECT"===fieldDefAttr.AttributeType&&fieldDefAttr.Constrained||!_.contains(["TEXT","COLLECTION"],fieldDefAttr.AttributeType))&&this._fieldCanBeEditedForAllRecords(field)},_fieldCanBeEditedForAllRecords:function(field){return"milestone"!==field.modelType||"TargetProject"!==field.name||_.every(this.records,function(record){return Rally.ui.MilestoneTargetProjectPermissionsHelper.canEdit(record)})},_isFieldOnAllModels:function(models,field){return _.every(models,function(model){return model.hasField(field.name)&&model.getField(field.name).attributeDefinition.AttributeType===field.attributeDefinition.AttributeType})},_isFieldBlacklistedForEditingOnAnyModel:function(models,field){return _.any(models,function(model){return Rally.ui.grid.FieldColumnFactory.isFieldBlacklistedForEditingOnGrids(field,model)})},_getValidFields:function(){var models=_(this.records).pluck("self").unique().value();return _(models[0].getFields()).filter(this._fieldIsBulkEditable,this).filter(_.curry(this._isFieldOnAllModels)(models)).reject(_.curry(this._isFieldBlacklistedForEditingOnAnyModel)(models)).reject(_.curry(this._isFieldBlacklistedForEditingAcrossModels.bind(this))(models)).sortBy("displayName").value()},_isFieldBlacklistedForEditingAcrossModels:function(models,field){return models.length>1&&_.contains(this.self.BLACKLISTED_FIELDS_ACROSS_MODELS,field.name)},_isDropdownField:function(fieldDef){return _.contains(fieldDef.editor.xtype,"combobox")||_.contains(fieldDef.editor.xtype,"rallyrecordcontexteditor")},_prepareDropdownEditorConfig:function(editorConfig){return Ext.merge(editorConfig,{defaultSelectionPosition:null,editable:!0,emptyText:"Choose Value...",listeners:{select:function(btn){btn.up().isValid=!0,this.enableApplyButton()},scope:this},storeConfig:{autoLoad:!0,context:this.records[0].self.context,requester:this},value:null})},_prepareTextEditorConfig:function(editorConfig){return Ext.merge(editorConfig,{emptyText:"Enter Value...",listeners:{validitychange:function(btn,isValid){btn.up().isValid=isValid,this.enableApplyButton()},scope:this}})},_prepareEditor:function(row,fieldDef){var editorConfig=fieldDef.editor;editorConfig.field&&editorConfig.field.xtype&&(editorConfig=editorConfig.field),editorConfig=Ext.apply({itemId:"editValue",width:150,enableKeyEvents:!0,listeners:{keyup:function(cmp,e){this.down("#applyButton").isDisabled()||e.getKey()!==Ext.EventObject.ENTER||this._onApplyClicked()}}},editorConfig),editorConfig=this._isDropdownField(fieldDef)?this._prepareDropdownEditorConfig(editorConfig):this._prepareTextEditorConfig(editorConfig);var valueField=row.insert(4,editorConfig);Ext.isFunction(valueField.setProject)&&valueField.setProject(this.records[0].self.context.project||Rally.environment.getContext().getProjectRef())},_onFieldSelect:function(combo,selected){var row=combo.up(),valueField=row.down("#editValue");valueField&&valueField.destroy(),this._prepareEditor(row,this.records[0].self.getField(selected[0].get(combo.valueField)))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.ChooserDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallychooserdialog",clientMetrics:[{beginEvent:"beforeshow",endEvent:"show",description:"dialog shown"}],width:600,closable:!0,config:{title:"Choose an Artifact",artifactTypes:[],multiple:!1,storeConfig:{},filterableFields:[{displayName:"Formatted ID",attributeName:"FormattedID"},{displayName:"Name",attributeName:"Name"}],columns:[{text:"ID",dataIndex:"FormattedID"},"Name"],selectionButtonText:"Done",gridConfig:{},selectedRef:void 0},items:{xtype:"panel",border:!1,items:[{xtype:"container",itemId:"gridContainer",layout:"fit",height:405}]},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addEvents("artifactChosen"),this.addCls("chooserDialog"),this._buildButtons(),this._buildSearchBar(),Rally.data.ModelFactory.getModels({types:this.artifactTypes,success:function(models){this.artifactTypes.length>1&&this._setupComboBox(models),this._buildGrid(models[this.artifactTypes[0]])},scope:this})},_buildButtons:function(){this.down("panel").addDocked({xtype:"toolbar",dock:"bottom",padding:"0 0 10 0",layout:{type:"hbox",pack:"center"},ui:"footer",items:[{xtype:"rallybutton",text:this.selectionButtonText,cls:"primary rly-small",scope:this,userAction:"clicked done in dialog",handler:function(){var selectedRecords=this._getSelectedRecords();this.multiple||(selectedRecords=selectedRecords[0]),this.fireEvent("artifactChosen",selectedRecords),this.close()}},{xtype:"rallybutton",text:"Cancel",cls:"secondary rly-small",handler:this.close,scope:this,ui:"link"}]})},_buildSearchBar:function(){var filterTypeComboBox=Ext.create("Ext.form.field.ComboBox",{itemId:"filterTypeComboBox",queryMode:"local",store:Ext.create("Ext.data.Store",{fields:["attributeName","displayName"],data:this.filterableFields}),displayField:"displayName",valueField:"attributeName",editable:!1});filterTypeComboBox.select(filterTypeComboBox.getStore().getAt(1)),this.addDocked({xtype:"toolbar",itemId:"searchBar",dock:"top",items:[filterTypeComboBox,{xtype:"textfield",itemId:"searchTerms",emptyText:"enter search terms",flex:1,enableKeyEvents:!0,listeners:{keyup:function(textField,event){event.getKey()===Ext.EventObject.ENTER&&this._search()},scope:this}},{xtype:"button",text:"Search",handler:this._search,scope:this}]})},_setupComboBox:function(models){var searchBar=this.down("#searchBar"),combo=Ext.create("Ext.form.field.ComboBox",{xtype:"combo",name:"filterType",queryMode:"local",store:Ext.create("Ext.data.Store",{fields:["typeName","displayName","wsapiModel"]}),displayField:"displayName",valueField:"typeName",editable:!1});searchBar.insert(0,combo),Ext.Object.each(models,function(key,model){combo.getStore().add({typeName:model.typePath,displayName:model.displayName,wsapiModel:model})},this),combo.select(combo.getStore().getAt(0)),combo.on("select",function(comboBox,options){var option=options[0];this.grid.reconfigureWithModel(option.get("wsapiModel"))},this)},_buildGrid:function(model){var mode=this.multiple?"MULTI":"SINGLE";this.selectionModel=Ext.create("Rally.ui.selection.CheckboxModel",{mode:mode,allowDeselect:!0});var gridConfig=Ext.Object.merge({model:model,selModel:this.selectionModel,autoAddAllModelFieldsAsColumns:!1,enableEditing:!1,enableColumnHide:!1,enableColumnMove:!1,columnCfgs:this.columns,storeConfig:this.storeConfig,showRowActionsColumn:!1,viewConfig:{emptyText:Rally.ui.EmptyTextFactory.get("defaultText"),publishLoadMessages:!1}},this.config.gridConfig);this.grid=Ext.create("Rally.ui.grid.Grid",gridConfig),this.mon(this.grid,"load",this._onGridLoad,this),this.down("#gridContainer").add(this.grid),this._onGridReady()},_onGridReady:function(){return this.grid.rendered?this.grid.getStore().isLoading()?void this.mon(this.grid,"load",this._onGridReady,this,{single:!0}):(this._onGridLoad(),
this.center(),void(Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this))):void this.mon(this.grid,"afterrender",this._onGridReady,this,{single:!0})},_onGridLoad:function(){if(this.getSelectedRef()){var recordIndex=this.grid.getStore().find("_ref",this.getSelectedRef());if(recordIndex!==-1){var record=this.grid.getStore().getAt(recordIndex);this.grid.getSelectionModel().select(record)}}},_getSelectedRecords:function(){return this.selectionModel.getSelection()},_search:function(){var filter,terms=this.down("#searchTerms").getValue(),filterBy=this.down("#filterTypeComboBox").getValue();Ext.isEmpty(terms)||(filter=Ext.create("Rally.data.wsapi.Filter",{property:filterBy,value:terms,operator:"Contains"})),this.grid.filter(filter,!0)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.DeleteConfirmDialog",{extend:Rally.ui.dialog.ConfirmDialog,cls:"delete-confirm-dialog",confirmLabel:"Delete",title:"Permanent Delete Warning",width:500,constructor:function(config){this.callParent([Ext.merge({message:["<div>Are you sure you want to delete</div>",'<div><span class="item-display-string">'+(config.record.hasField("FormattedID")?config.record.get("FormattedID")+": ":"")+this._getItemDisplayString(config)+"</span> ?</div>","<div>&nbsp;</div>",config.record.isUser()?"":'<div class="associations-will-be-removed-message">Any associations will be removed.</div>',"<div>THERE IS NO UNDO for deleting objects of this type.</div>"].join("")},config)])},_getItemDisplayString:function(config){return _.isFunction(config.getItemDisplayString)?config.getItemDisplayString(config.record):config.record.get(_.find(["Name","UserName"],function(nameField){return config.record.hasField(nameField)},this))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.TagChooserDialogController",{extend:Rally.ui.dialog.AbstractChooserDialogController,control:{tagChooser:{},view:{ready:"_onTagChooserReady"}},constructor:function(){this.mergeControl(),this.callParent(arguments)},onSelectButtonClick:function(){var selectedTags=this.getTagChooser().getSelectedTags(),view=this.getView();view.fireEvent("tagselect",view,selectedTags),view.close()},_onTagChooserReady:function(){this.getView().center()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.AddNewController",{extend:Rally.ui.ViewController,control:{view:{select:"createTag"}},config:{showAdd:!0},init:function(){var me=this,view=me.getView(),storeBuilder=Ext.create("Rally.data.DataStoreBuilder");storeBuilder.build({model:"tag",requester:view}).then(function(store){me.store=store,store.add({Name:""}),view.bindStore(store),view.fireEvent("ready",view)})},setValue:function(value){this.store.removeAll(),this.store.add({Name:value}),value&&this.config.showAdd?this.getView().show():this.getView().hide()},createTag:function(){var view=this.getView(),deferred=Ext.create("Deft.promise.Deferred");return view.setLoading(!0),this.store.first().save({requester:this,callback:function(record,operation){if(view.setLoading(!1),operation.success)view.fireEvent("tagcreate",view,record),deferred.resolve(record);else{var message=["Not able to create tag."];operation.error&&operation.error.errors&&operation.error.errors.length&&message.push(operation.error.errors[0]),Rally.ui.notify.Notifier.showError({message:message.join(" ")}),deferred.reject()}},scope:this}),deferred}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.AddNew",{extend:Ext.Container,xtype:"rallytagchooseraddnew",clientMetrics:[{endEvent:"ready",description:"add new tag ready"},{method:"createTag",descriptionProperty:"userAction",description:"create new tag clicked in tag chooser"}],controller:"Rally.ui.tagchooser.AddNewController",cls:"rui-tag-chooser-add-new",hidden:!0,layout:{type:"hbox",align:"middle"},width:296,overCls:"tag-add-new-over",items:[{xtype:"dataview",itemId:"dataView",itemSelector:".tag-add-new-item",overItemCls:"tag-add-new-item-over",flex:1,tpl:['<tpl for=".">','<div class="tag-add-new-item">','<div>"{Name}" (Create New)</div>',"</div>","</tpl>"].join("")}],initComponent:function(){this.callParent(arguments),this.relayEvents(this.down("#dataView"),["highlightitem","itemmouseenter","select","unhighlightitem"]),this.on({highlightitem:this._addOverCls,unhighlightitem:this._removeOverCls}),this.mon(this.down("#dataView"),"click",this.createTag,this)},bindStore:function(store){this.down("#dataView").bindStore(store)},clearHighlight:function(){this.down("#dataView").clearHighlight()},highlight:function(){var view=this.down("#dataView");view.highlightItem(view.getNodes()[0])},setValue:function(value){return this.getController().setValue(value)},createTag:function(){return this.getController().createTag()},_addOverCls:function(){this.addCls(this.overCls)},_removeOverCls:function(){this.removeCls(this.overCls)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.multichooser.AbstractListController",{extend:Rally.ui.ViewController,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},control:{view:{refresh:"onViewRefresh"}},storeType:"Rally.data.wsapi.Store",storeConfig:{},constructor:function(config){this.mergeConfig(config),this.mergeControl(),this.callParent(arguments)},init:function(){this.callParent(arguments),this.buildStore(),this.getView().getSelectionModel().setSelectionMode("SIMPLE")},buildStore:function(){this.getView().fireEvent("beforestoreload",this.getView()),this.recordLoadBegin({description:"list loading store"});var store=Ext.create(this.storeType,Ext.merge({},this._getDefaultStoreConfig(),this.storeConfig));return this.getView().bindStore(store),store},_getDefaultStoreConfig:function(){return{requester:this,model:this.type,remoteFilter:!0,autoLoad:!0,listeners:{load:this.onStoreLoad,scope:this},sorters:{property:"Name",direction:"Asc"}}},onStoreLoad:function(store){this.recordLoadEnd(),this.getView().fireEvent("storeload",this.getView(),store),this._ready||(this.getView().fireEvent("ready",this.getView()),this._ready=!0)},addListItem:function(records){var store=this.getView().getStore();store.insert(0,records),store.sort()},removeListItem:function(selectedRecords){var store=this.getView().getStore(),records=_.map(Ext.Array.from(selectedRecords),function(record){return store.findRecord("ObjectID",record.get("ObjectID"))},this);store.remove(records)},updateListVisibility:function(list){return 0===list.getStore().getCount()?list.hide():list.show()},filter:function(term){var deferred=Ext.create("Deft.promise.Deferred"),view=this.getView(),store=view.getStore(),regex=new RegExp(term.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i"),isRemoteFiltered=store.config.remoteFilter===!0;return isRemoteFiltered&&store.on("load",function(){deferred.resolve(arguments)},this,{single:!0}),view.suspendEvents(),store.clearFilter(!0),view.getStore().filter("Name",regex),view.resumeEvents(),view.refresh(),isRemoteFiltered||deferred.resolve([store.getRange()]),deferred.promise},onViewRefresh:function(list,opts){this.updateListVisibility(list)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.multichooser.AbstractList",{extend:Ext.view.BoundList,controller:"Rally.ui.multichooser.AbstractListController",clientMetrics:[{endEvent:"ready",description:"multi chooser list ready"}],config:{textTpl:[]},listTitle:null,constructor:function(config){this.mergeConfig(config);var tpl=['<div class="rui-list-header">'+this.listTitle+"</div>",'<tpl for=".">','<div class="'+Ext.baseCSSPrefix+'boundlist-item">','<div id="checkbox-{ObjectID}" class="rui-checkbox" tabindex="-1"></div>','<label for="checkbox-{ObjectID}" class="rui-checkbox-label">{Name}','<tpl if="_count"> ({_count})</tpl>',"</label>"];tpl=tpl.concat(this.textTpl),tpl=tpl.concat(["</div>","</tpl>"]),this.tpl=tpl,this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addCls("rui-tag-bound-list"),this.on({beforecontainerclick:function(){return!1},beforeitemmouseleave:function(){return!1},scope:this})},highlightItemByRecord:function(record){this.highlightItem(this.getNode(record))},filter:function(term){return this.getController().filter(term)},addListItem:function(record){return this.getController().addListItem(record)},removeListItem:function(record){return this.getController().removeListItem(record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.multichooser.SelectedListController",{extend:Rally.ui.multichooser.AbstractListController,storeType:"Ext.data.Store",constructor:function(config){config.storeConfig=config.storeConfig||{},_.merge(config.storeConfig,{remoteFilter:!1,proxy:{type:"memory",reader:{type:"json"}}}),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.SelectedTagList",{extend:Rally.ui.multichooser.AbstractList,alias:"widget.rallyselectedtaglist",controller:"Rally.ui.multichooser.SelectedListController",cls:"rui-selected-tags-bound-list",constructor:function(config){this.selModel=Ext.create("Rally.ui.selection.TriStateModel"),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.mon(this.getSelectionModel(),"selectionchange",this._applySelection,this),this.on("ready",this._onReady,this)},getSelectedTags:function(){var store=this.getStore();return store.isFiltered()&&store.clearFilter(),this.getSelectionModel().getSelectionByState()},onBeforeItemClick:function(record){return this.callParent(arguments)!==!1&&!this._getCheckboxForRecord(record).hasCls("rly-disabled")},onItemClick:function(record){this.callParent(arguments),this.getSelectionModel().deselect(record)},setInitialPartialSelection:function(partialSelection){this.getSelectionModel().setInitialPartialSelection(partialSelection)},_onReady:function(){this.on("refresh",this._applySelection,this),this.mon(this.getStore(),"datachanged",this._onStoreDataChanged,this)},_onStoreDataChanged:function(store,opts){this.getSelectionModel().selectAll()},_getCheckboxForRecord:function(record){var itemNode=this.getNode(record);return itemNode&&Ext.get(itemNode.children[0])},_markPartiallySelected:function(record){var checkbox=this._getCheckboxForRecord(record);checkbox&&(checkbox.removeCls("icon-ok"),checkbox.addCls("icon-partial"))},_markFullySelected:function(record){var checkbox=this._getCheckboxForRecord(record);checkbox&&(checkbox.removeCls("icon-partial"),checkbox.addCls("icon-ok"))},_applySelection:function(){_.each(this.getStore().getRange(),function(record){this.getSelectionModel().isPartiallySelected(record)?this._markPartiallySelected(record):this.getSelectionModel().isFullySelected(record)&&this._markFullySelected(record);var checkbox=this._getCheckboxForRecord(record);checkbox&&Ext.isFunction(this.recordEnabled)&&!this.recordEnabled(record)&&checkbox.addCls("rly-disabled")},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.multichooser.AvailableListController",{extend:Rally.ui.multichooser.AbstractListController,storeType:"Rally.data.wsapi.Store",constructor:function(config){this.mergeConfig(config),this.mergeControl(),this.initialFilters=this.storeConfig.filters||[],this.initialFilters=_.isArray(this.initialFilters)?this.initialFilters:[this.initialFilters],this.storeConfig=_.merge({pageSize:10},this.storeConfig),this.callParent(arguments)},filter:function(term){var deferred=Ext.create("Deft.promise.Deferred"),view=this.getView(),store=view.getStore();return view.suspendEvents(),store.clearFilter(!0),store.on("load",function(){deferred.resolve(arguments)},this,{single:!0}),term?store.filter([{property:"Name",operator:"Contains",value:term}].concat(this.initialFilters)):store.load({filters:this.initialFilters}),view.resumeEvents(),view.refresh(),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.multichooser.AvailableList",{extend:Rally.ui.multichooser.AbstractList,alias:"widget.rallyavailablelist",controller:"Rally.ui.multichooser.AvailableListController",cls:"rui-available-tags-bound-list",pageSize:10,createPagingToolbar:function(){return Ext.widget("rallylistpagingtoolbar",{pageSize:this.pageSize,store:this.dataSource,border:!1,ownerCt:this,ownerLayout:this.getComponentLayout(),width:276,layout:{align:"middle"}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.ListContainerController",{extend:Rally.ui.ViewController,mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},control:{availableTagList:{ready:"_onAvailableTagListReady",highlightitem:"_onListHighlightItem",select:"_onAvailableTagListSelect",storeload:"_onAvailableTagListStoreLoad"},selectedTagList:{highlightitem:"_onListHighlightItem",deselect:"_onSelectedTagListDeselect"},noItemsAvailableMessage:{}},init:function(){this.callParent(arguments),this.buildextendedCollectionDataStore(),this.getSelectedRecordsFn=this.config.getSelectedRecordsFn||this._getSelectedRecords},buildextendedCollectionDataStore:function(){var extendedCollectionDataStoreConfig=this.config.extendedCollectionDataStoreConfig;if(extendedCollectionDataStoreConfig){var originalLoad,scope;extendedCollectionDataStoreConfig.listeners&&extendedCollectionDataStoreConfig.listeners.load&&(scope=extendedCollectionDataStoreConfig.listeners.scope,originalLoad=extendedCollectionDataStoreConfig.listeners.load,scope&&(originalLoad=Ext.bind(extendedCollectionDataStoreConfig.listeners.load,scope))),extendedCollectionDataStoreConfig.listeners=_.merge(extendedCollectionDataStoreConfig.listeners||{},{load:Ext.bind(function(store,records,successful,eOpts){originalLoad&&originalLoad(store,records,successful,eOpts),this._onExtendedCollectionDataStoreLoaded()},this)}),this._extendedCollectionDataStoreLoaded=!1,this.extendedCollectionDataStore=Ext.create("Rally.data.wsapi.Store",extendedCollectionDataStoreConfig)}else this._extendedCollectionDataStoreLoaded=!0},getSelectedTags:function(){return this.getSelectedTagList().getSelectedTags()},filter:function(term){this.recordLoadBegin({description:"filtering list container"}),Deft.Promise.all([this.getAvailableTagList().filter(term),this.getSelectedTagList().filter(term)]).then({success:function(){this.clearHighlight(),this.moveHighlight("down"),this._onTagListRefresh(),this.recordLoadEnd()},scope:this})},moveHighlight:function(direction){var record=this.highlightedRecord?this._getNextRecord(direction):this._getFirstRecord(direction);record&&this.getView().highlightItem(this._getListContainingRecord(record),record)},_getFirstRecord:function(direction){var record;return record="up"===direction?this.getAvailableTagList().getStore().last()||this.getSelectedTagList().getStore().last():this.getSelectedTagList().getStore().first()||this.getAvailableTagList().getStore().first(),record||this.getView().fireEvent("beforewrap",this.getView()),record},_getNextRecord:function(direction){var fromList=this._getListContainingRecord(this.highlightedRecord),otherList=this._otherListFrom(fromList),currentIndex=fromList?fromList.indexOf(this.highlightedRecord):0,nextIndex="up"===direction?currentIndex-1:currentIndex+1,record=fromList?fromList.getStore().getAt(nextIndex):null;if(!record){var method="up"===direction?"last":"first";if(record=otherList.getStore()[method]()||fromList.getStore()[method](),toList=this._getListContainingRecord(record),this._isWrapping(direction,toList,fromList)&&!this.getView().fireEvent("beforewrap",this.getView()))return!1}return record},_isWrapping:function(direction,toList,fromList){var decisiveList="down"===direction?this.getSelectedTagList():this.getAvailableTagList();return toList===fromList||toList!==fromList&&toList===decisiveList},selectHighlightedRecord:function(){return!!this.highlightedRecord&&this.selectRecord(this.highlightedRecord)},selectRecord:function(record){return this.getSelectedTagList().getStore().indexOf(record)>-1?(this.getSelectedTagList().deselect(record),record):this.getAvailableTagList().getStore().indexOf(record)>-1&&(this.getAvailableTagList().select(record),record)},hasExactMatch:function(term){return!!term&&(this.getAvailableTagList().getStore().findExact("Name",term)!==-1||this.getSelectedTagList().getStore().findExact("Name",term)!==-1)},addRecord:function(record){this.getSelectedTagList().addListItem(record),this.getSelectedTagList().highlightItemByRecord(record)},clearHighlight:function(){this.getSelectedTagList().clearHighlight(),this.getAvailableTagList().clearHighlight(),delete this.highlightedRecord},hasHighlightedRecord:function(){return!!this.highlightedRecord},getHighlightedRecord:function(){return this.highlightedRecord},deselectTag:function(record){this.getSelectedTagList().removeListItem(record),this.getAvailableTagList().addListItem(record),this.getAvailableTagList().highlightItemByRecord(record),this._onTagListRefresh()},selectTag:function(record){this.getAvailableTagList().removeListItem(record),this.getSelectedTagList().addListItem(record),_.isArray(record)&&(record=record[0]),this.getSelectedTagList().highlightItemByRecord(record),this._onTagListRefresh()},highlightItem:function(list,record){this.highlightedRecord=record,this._otherListFrom(list).clearHighlight(),this.getView().fireEvent("highlightitem",this.getView(),record)},_getSelectedRecords:function(artifactRecords){var selectedRecords,partiallySelectedTags=[],tagModel=this.getAvailableTagList().getStore().model,tagsByCount=_(artifactRecords).invoke("get",this.config.collectionProperty).pluck("_tagsNameArray").compact().flatten().reduce(this._countTags,{});return selectedRecords=_.map(tagsByCount,function(tag){var record=new tagModel(tag);return tag._count<artifactRecords.length&&partiallySelectedTags.push(record),record.set("_count",tag._count),record},this),this.getSelectedTagList().setInitialPartialSelection(partiallySelectedTags),selectedRecords},setSelectionFromArtifactRecords:function(artifactRecords){this.recordLoadBegin({description:"selecting tags from artifactRecords"});var selectedRecords=this.getSelectedRecordsFn(artifactRecords);this.selectTag(_.compact(selectedRecords)),this.getAvailableTagList().refresh(),this._onTagListRefresh(),this.recordLoadEnd()},_countTags:function(accumulator,tag){return accumulator[tag._ref]?accumulator[tag._ref]._count+=1:accumulator[tag._ref]=_.merge(_.cloneDeep(tag),{_count:1}),accumulator},_onSelectedTagListDeselect:function(list,record){this.recordAction({description:"clicking item to deselect it from selected list",component:this.getView()}),this.deselectTag(record)},_onAvailableTagListSelect:function(selectionModel,record,opts){this.recordAction({description:"clicked item to select it from available list",component:this.getView()}),this.selectTag(record)},_onListHighlightItem:function(list,node,opts){this.highlightItem(list,list.getRecord(node))},_onExtendedCollectionDataStoreLoaded:function(){this._extendedCollectionDataStoreLoaded=!0,this._allStoresLoaded()},_onAvailableTagListReady:function(){this._availableListLoaded=!0,this._allStoresLoaded()},_allStoresLoaded:function(){this._extendedCollectionDataStoreLoaded&&this._availableListLoaded&&(this.setSelectionFromArtifactRecords(this.getView().getArtifactRecords()),this.getView().fireEvent("ready",this.getView()))},_onAvailableTagListStoreLoad:function(list,e){list.removeListItem(this.getSelectedTagList().getStore().getRange())},_getListContainingRecord:function(record){return this.getSelectedTagList().getStore().indexOf(record)>-1?this.getSelectedTagList():this.getAvailableTagList().getStore().indexOf(record)>-1?this.getAvailableTagList():null},_otherListFrom:function(list){return list===this.getSelectedTagList()?this.getAvailableTagList():this.getSelectedTagList()},_onTagListRefresh:function(){this.getView().toggleNoItemsAvailableMessage(0===this.getSelectedTagList().getStore().getCount()&&0===this.getAvailableTagList().getStore().getCount())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.ListContainer",{extend:Ext.container.Container,alias:"widget.rallytagchooserlistcontainer",controller:"Rally.ui.tagchooser.ListContainerController",cls:"rui-tag-chooser-list-ct",config:{artifactRecords:null},clientMetrics:[{endEvent:"ready",description:"list container ready"}],constructor:function(config){this.mergeConfig(config),this.items=[_.merge({xtype:"rallyselectedtaglist",itemId:"selectedTagList",hidden:!0},this.selectedConfig),_.merge({xtype:"rallyavailablelist",itemId:"availableTagList"},this.availableConfig),{xtype:"component",itemId:"noItemsAvailableMessage",html:this.noItemsAvailableText,hidden:!0,cls:"rui-tag-chooser-empty-list"}],this.callParent(arguments)},scrollIntoView:function(list,record){var node=list.getNodeByRecord(record);node&&Ext.fly(node).scrollIntoView(this.getEl())},highlightItem:function(list,record){record&&(this.scrollIntoView(list,record),list.highlightItemByRecord(record))},getSelectedTags:function(){return this.getController().getSelectedTags()},moveHighlight:function(direction){return this.getController().moveHighlight(direction)},selectRecord:function(record){return this.getController().selectRecord(record)},addRecord:function(record){return this.getController().addRecord(record)},selectHighlightedRecord:function(){return this.getController().selectHighlightedRecord()},clearHighlight:function(){return this.getController().clearHighlight()},hasHighlightedRecord:function(){return this.getController().hasHighlightedRecord()},getHighlightedRecord:function(){return this.getController().getHighlightedRecord()},filter:function(term){return this.getController().filter(term)},hasExactMatch:function(term){return this.getController().hasExactMatch(term)},toggleNoItemsAvailableMessage:function(show){var msg=this.down("#noItemsAvailableMessage");show?msg.show():msg.hide()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.TagChooserController",{extend:Rally.ui.ViewController,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},control:{tagFilter:{blur:"_onTagFilterBlur",change:"_onTagFilterChange",keyup:"_onTagFilterKeyUp",keydown:"_onTagFilterKeyDown"},tagsListContainer:{beforewrap:"_onTagsListContainerBeforeWrap",highlightitem:"_onTagsListContainerHighlightItem",ready:"_onTagsListContainerReady"},tagAddNew:{itemmouseenter:"_onTagAddNewItemMouseEnter",tagcreate:"_onTagAddNewTagCreate"}},constructor:function(){this.mergeControl(),this.callParent(arguments)},getSelectedTags:function(){return this.getTagsListContainer().getSelectedTags()},filter:function(term){term=Ext.String.htmlEncode(term.trim()),this.getTagsListContainer().hasExactMatch(term)?this.getTagAddNew().setValue():this.getTagAddNew().setValue(term),this.getTagsListContainer().filter(term)},selectHighlightedRecord:function(){var record=this.getTagsListContainer().getHighlightedRecord();record?(this.getTagFilter().setValue(null),this.getTagsListContainer().selectRecord(record)):this._addNewHasHighlight&&this.getTagAddNew().createTag()},highlightAddNew:function(){this.getTagsListContainer().clearHighlight(),this.getTagAddNew().highlight(),this._addNewHasHighlight=!0},handleListContainerWrap:function(){if(this.getTagAddNew().isVisible())return this.highlightAddNew(),!1},_onTagsListContainerHighlightItem:function(){this.getTagFilter().focus(),this.getTagAddNew().clearHighlight(),delete this._addNewHasHighlight},_onTagsListContainerBeforeWrap:function(){return this.handleListContainerWrap()},_onTagsListContainerReady:function(){this.getTagFilter().focus(!1,150),this._ready||(this.getView().fireEvent("ready",this.getView()),this._ready=!0)},_onTagFilterChange:function(textField,event,opts){this.recordAction({description:"filtering tags",component:this.getView()}),this.filter(textField.getValue())},_onTagFilterBlur:function(){this.getTagsListContainer().clearHighlight()},_onTagFilterKeyUp:function(textField,event,opts){event.getKey()===event.ENTER&&this.selectHighlightedRecord()},_onTagFilterKeyDown:function(textField,event,opts){switch(event.getKey()){case event.ENTER:event.stopEvent();break;case event.UP:this.getTagsListContainer().moveHighlight("up");break;case event.DOWN:this.getTagsListContainer().moveHighlight("down")}},_onTagAddNewTagCreate:function(addNewComponent,record){this.getTagFilter().setValue(null),this.getTagsListContainer().addRecord(record)},_onTagAddNewItemMouseEnter:function(){this.highlightAddNew()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tagchooser.TagChooser",{extend:Ext.container.Container,alias:"widget.rallytagchooser",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},controller:"Rally.ui.tagchooser.TagChooserController",cls:"rui-tag-chooser",config:{artifactRecords:null,width:300,showAdd:!0},layout:{type:"vbox",align:"stretch"},constructor:function(config){this.recordLoadBegin({description:"tag chooser shown"}),this.mergeConfig(config),this.items=[{xtype:"rallytextfield",itemId:"tagFilter",cls:"rui-tag-chooser-filter",shadow:!1,border:!1,emptyText:this.emptyText,enableKeyEvents:!0,checkChangeBuffer:250},{xtype:"rallytagchooserlistcontainer",itemId:"tagsListContainer",maxHeight:this.listConfig.maxHeight||400,autoScroll:!0,noItemsAvailableText:this.listConfig.noItemsAvailableText,controllerConfig:this.listConfig.controllerConfig,selectedConfig:this.selectedConfig||{},availableConfig:this.availableConfig||{},listeners:this.listConfig.listeners},{xtype:"rallytagchooseraddnew",itemId:"tagAddNew",controllerConfig:{showAdd:this.showAdd}}],this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.setArtifactRecords(this.getArtifactRecords()),this.on("afterlayout",this._afterLayout,this,{single:!0})},setArtifactRecords:function(artifactRecords){this.down("#tagsListContainer").setArtifactRecords(artifactRecords)},_afterLayout:function(){this.setLoading(!0),this.on("ready",this._onReady,this)},afterRender:function(){this.setLoading(!0),this.on("ready",this._onReady,this),this.callParent(arguments)},getSelectedTags:function(){return this.getController().getSelectedTags()},_onReady:function(){this.recordLoadEnd(),this.setLoading(!1)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.MilestoneChooserDialog",{extend:Rally.ui.dialog.AbstractChooserDialog,alias:"widget.rallymilestonechooserdialog",mixins:[Rally.ui.MilestoneListHeadings],controller:"Rally.ui.dialog.TagChooserDialogController",config:{title:"Choose Milestones",selectionButtonText:"Apply",records:[],type:"milestones"},constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},initComponent:function(){this.addCls("tag-chooser-dialog"),this.callParent(arguments)},_onStoreLoad:function(milestoneStore){_.each(this.getRecords(),function(record){_.each(record.get("Milestones")._tagsNameArray,function(m){var match=_.find(milestoneStore.getRange(),function(milestone){return milestone.get("_ref")===m._ref});if(match){var targetProject=match.get("TargetProject");m.TargetProject=targetProject?{_ref:targetProject._ref}:null,m.TargetDate=match.get("TargetDate")}})})},_buildArtifactFilters:function(){return Rally.data.wsapi.Filter.or(_.map(this.getRecords(),function(record){return{property:"Artifacts",operator:"contains",value:record.get("_ref")}}))},buildChooser:function(){var tpl='<tpl if="TargetDate"><span class="additional-text">{[Rally.util.DateTime.formatWithDefault(values.TargetDate, Rally.environment.getContext())]}</span><span class="milestone-raw-date">{[values.TargetDate]}</span></tpl>',chooser=Ext.create("Rally.ui.tagchooser.TagChooser",{itemId:"tagChooser",artifactRecords:this.getRecords(),emptyText:"Search for a Milestone",showAdd:!1,listConfig:{noItemsAvailableText:"No Milestones are available for the work items you've selected to bulk-edit.",controllerConfig:{collectionProperty:"Milestones",extendedCollectionDataStoreConfig:{model:"milestone",enablePostGet:!0,remoteFilter:!0,autoLoad:!0,listeners:{load:this._onStoreLoad,scope:this},limit:1/0,filters:this._buildArtifactFilters()}}},selectedConfig:{listTitle:"SELECTED MILESTONES",controllerConfig:{type:"Milestone",storeConfig:{remoteSort:!1,sorters:[{sorterFn:Rally.data.util.Sorter.getDefaultSortFn("Milestone")}]}},recordEnabled:Ext.bind(this._milestoneInScope,this),textTpl:tpl},availableConfig:{listTitle:"AVAILABLE MILESTONES",controllerConfig:{type:"Milestone",storeConfig:{remoteFilter:!0,remoteSort:!1,filters:Rally.data.wsapi.Filter.or([{property:"TargetProject",value:null},{property:"Projects",operator:"contains",value:Rally.environment.getContext().context.scope.project._ref}]),sorters:[{sorterFn:Rally.data.util.Sorter.getDefaultSortFn("Milestone")}]}},textTpl:tpl}}),boundList=chooser.items.items[1].items.items[1];return boundList.on({show:this._addListHeaders,refresh:this._addListHeaders,scope:this,groupHeaderSelector:".rui-list-header",headerClasses:"rui-list-header",headerSelectedTextLabel:"SELECTED MILESTONES"}),chooser},_milestoneInScope:function(milestone){var targetProject=milestone.get("TargetProject");return!targetProject||Rally.environment.getContext().context.scope.project._ref.indexOf(targetProject._ref)>=0}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.PrintDialog",{alias:"widget.rallyprintdialog",extend:Rally.ui.dialog.Dialog,autoShow:!0,closable:!0,cls:"print-dialog",disableScroll:!0,draggable:!0,title:"Print",width:475,clientMetrics:[{beginEvent:"beforeshow",endEvent:"show",description:"dialog shown"},{event:"print",descriptionProperty:"userAction",description:"user printed"}],constructor:function(config){this.callParent([Ext.merge({dockedItems:[{xtype:"toolbar",defaults:{xtype:"rallybutton",padding:"4 12",scope:this},dock:"bottom",itemId:"footer",items:[{cls:"print-dialog-print-button primary medium",handler:function(){this.fireEvent("print",this),this.close()},text:"Print"},{cls:"secondary medium",handler:function(){this.close()},text:"Cancel"}],layout:{type:"hbox",pack:"center"},ui:"footer"}]},config)])},initComponent:function(){this.addEvents("print"),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.SourceCodeDialog",{extend:Rally.ui.dialog.Dialog,alias:"widget.rallysourcecodedialog",cls:"source-code-dialog",closable:!0,buttonAlign:"center",buttons:[{xtype:"rallybutton",text:"Select All",cls:"primary rly-small",handler:function(cmp){cmp.up("rallysourcecodedialog").selectText()}},{xtype:"rallybutton",text:"Cancel",ui:"link-small",cls:"secondary rly-small",handler:function(cmp){cmp.up("rallysourcecodedialog").close()}}],constructor:function(){this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this._showSource()},show:function(){this._sizeWindow(),this.callParent(arguments)},selectText:function(){this._clearSelection();var range,element=this.down("#sourceContainer").getEl().dom;document.selection?(range=document.body.createTextRange(),range.moveToElementText(element),range.select()):window.getSelection&&(range=document.createRange(),range.selectNode(element),window.getSelection().addRange(range))},_clearSelection:function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},_showSource:function(){this.text?this._addSource():this.src&&Ext.Ajax.request({url:this.src,success:function(response){this.text=Ext.String.htmlEncode(response.responseText),this._addSource()},scope:this})},_addSource:function(){var html=Ext.String.format('<pre class="source-code"><code>{0}</code></pre>',this.text);this.add({xtype:"component",itemId:"sourceContainer",cls:"source-code",fit:!0,border:!1,style:{padding:"10px"},html:html})},_sizeWindow:function(){var viewportSize=Ext.getBody().getViewSize(),width=Math.round(.75*viewportSize.width),height=Math.round(.75*viewportSize.height);this.setSize(width,height)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.dialog.TagChooserDialog",{extend:Rally.ui.dialog.AbstractChooserDialog,
alias:"widget.rallytagchooserdialog",controller:"Rally.ui.dialog.TagChooserDialogController",config:{title:"Choose Tags",selectionButtonText:"Apply",records:[],type:"tags"},constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},initComponent:function(){this.addCls("tag-chooser-dialog"),this.callParent(arguments)},buildChooser:function(){var chooser=Ext.create("Rally.ui.tagchooser.TagChooser",{itemId:"tagChooser",artifactRecords:this.getRecords(),emptyText:"Search for a Tag",listConfig:{noItemsAvailableText:"No matching item",controllerConfig:{collectionProperty:"Tags"}},selectedConfig:{listTitle:"SELECTED TAGS",controllerConfig:{type:"Tag"}},availableConfig:{listTitle:"AVAILABLE TAGS",controllerConfig:{type:"Tag",storeConfig:{remoteFilter:!0,filters:[{property:"Archived",value:!1}]}}}});return chooser}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.PillPicker",{extend:Ext.Container,alias:"widget.rallypillpicker",comboBoxCfg:null,showPills:!1,showClear:!1,initComponent:function(){this.comboBoxCfg.remoteFilter=!0,this.comboBox=this._addComboBox(),this.mon(this.comboBox,"change",this._onSelectionChange,this),this.mon(this.comboBox,"select",this._onItemSelect,this),this.mon(this.comboBox,"deselect",this._onItemDeselect,this),this.items=this._createItems(),this.on("afterrender",this._onAfterRender,this),this.callParent(arguments)},getValue:function(){var comboBox=this.getComboBox();return comboBox?comboBox.getValue():null},getComboBox:function(){return this.comboBox},_onAfterRender:function(){this.showPills&&this.comboBox.refresh().then({success:function(){this.comboBox.getValue()&&this._onSelectionChange(this.comboBox,this.comboBox.getValue())},scope:this})},_addComboBox:function(){var comboBoxCfg=Ext.merge({width:this.width,value:this.value},this.comboBoxCfg);return Ext.ComponentManager.create(comboBoxCfg)},_addPills:function(records){if(this.showPills){var pills=_.map(records,function(record){return{xtype:"component",itemId:"pill-id-"+record.getId(),renderTpl:'<span class="tagPill">{Name}<span class="icon-cancel"></span></span>',renderData:record.getData(),renderSelectors:{removePillEl:".icon-cancel"},listeners:{click:{element:"removePillEl",fn:function(){this._onRemovePillClick(record)},scope:this}}}},this),newPills=_.filter(pills,function(cmp){return Ext.isEmpty(this.down("#"+cmp.itemId))},this);newPills.length>0&&this.down("#pillContainer").add(newPills)}},_createItems:function(){var items=[];return this.showClear&&items.push({itemId:"clearPillPicker",xtype:"component",html:"Clear",margin:"0 2 2 0",cls:"clearPillButton",listeners:{click:{element:"el",fn:this._clearPillPicker,scope:this}},style:"color: #CCEEF9;cursor:pointer;float:right"}),items.push(this.comboBox,{itemId:"pillContainer",xtype:"container",margin:"0 0 0 "+(this.comboBoxCfg.fieldLabel?this.comboBoxCfg.labelWidth+5:0)}),items},_removePills:function(){_.each(this.down("#pillContainer").items.getRange(),function(cmp){cmp.destroy()})},_removePill:function(record){var pillEl=this.down("#pill-id-"+record.getId());pillEl&&pillEl.destroy()},_onSelectionChange:function(cmp,records){Ext.suspendLayouts(),this._removePills(),this._addPills(records),Ext.resumeLayouts(!0)},_onItemSelect:function(cmp,record){this._addPills(Ext.Array.from(record))},_onItemDeselect:function(cmp,record){this._removePill(record)},_onRemovePillClick:function(record){var comboBox=this.comboBox,values=Ext.Array.from(comboBox.getValue()),newValues=_.remove(values,function(value){return record.getId()!==value.getId()});comboBox.setValue(newValues),this._removePill(record)},_clearPillPicker:function(){Ext.suspendLayouts(),this.showPills&&this._removePills(),this.clearComboBoxValue(),Ext.resumeLayouts(!0)},clearComboBoxValue:function(){this.getComboBox().setValue([])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.filter.view.PillFilter",{alias:"widget.rallypillfilter",extend:Rally.ui.picker.PillPicker,isActiveFilter:!1,initComponent:function(){this._setStoreFilter(),this.callParent(arguments),this.isActiveFilter=this.getComboBox().isActiveFilter},getFilter:function(){return this.getComboBox().getFilter()},_setStoreFilter:function(){this.comboBoxCfg.storeFilter=this.storeFilter}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TagsEditor",{extend:Ext.grid.CellEditor,alias:"widget.rallytagseditor",initComponent:function(){this.callParent(arguments),this.on("beforecomplete",this._onBeforeStart,this)},getValue:function(){return _.map(this.field.getValue(),function(record){return{Name:record.get("Name"),_refObjectName:record.get("_refObjectName"),_ref:record.get("_ref")}})},getName:function(){return this.name},_onBeforeStart:function(cmp,newTags,startValue,opt){var originalTags=startValue._tagsNameArray;if(this._tagListsAreEqual(originalTags,newTags))return this.hideEdit(),!1},_tagIsEqual:function(tag1,tag2){return tag1._ref===tag2._ref&&tag1.Name===tag2.Name},_tagListsAreEqual:function(tags1,tags2){return tags2=_.sortBy(tags2,"_ref"),tags1.length===tags2.length&&_(tags1).sortBy("_ref").all(function(tag1,i){var tag2=tags2[i];return this._tagIsEqual(tag1,tag2)},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeGridExpandTracker",{whenExpanded:function(node,view,refsOfNodesThatAreAllowedToBeExpanded){return this._whenExpandComplete("expand",node,view,refsOfNodesThatAreAllowedToBeExpanded)},whenCollapsed:function(node,view){return this._whenExpandComplete("collapse",node,view)},_whenExpandComplete:function(action,node,view,refsOfNodesThatAreAllowedToBeExpanded){var viewEvent="afteritem"+action,nonvisibleViewEvent="afternonvisibleitem"+action,nodesToToggle=this._getNodesToToggle(action,node,refsOfNodesThatAreAllowedToBeExpanded),toggleContext={action:action,nodeIdsToToggle:{},deferred:Ext.create("Deft.Deferred"),toggledNodes:[]},onAfterItemAction=function(node){this._onAfterItemAction(toggleContext,node)};return nodesToToggle.length?(this._mergeNodeIds(nodesToToggle,toggleContext.nodeIdsToToggle),view.on(viewEvent,onAfterItemAction,this),view.on(nonvisibleViewEvent,onAfterItemAction,this)):toggleContext.deferred.resolve(toggleContext.toggledNodes),toggleContext.deferred.promise.then(function(toggledNodes){return view.un(viewEvent,onAfterItemAction),view.un(nonvisibleViewEvent,onAfterItemAction),toggledNodes})},_getNodesToToggle:function(action,node,refsOfNodesThatAreAllowedToBeExpanded){var nodes=Ext.Array.from(node);return"collapse"===action?this._getNodesToCollapse(nodes):this._getNodesToExpand(nodes,refsOfNodesThatAreAllowedToBeExpanded)},_getNodesToExpand:function(nodes,refsOfNodesThatAreAllowedToBeExpanded){return _.filter(nodes,function(node){return!node.isLeaf()&&node.isExpandable()&&!node.isExpanded()&&_.contains(refsOfNodesThatAreAllowedToBeExpanded,node.get("_ref"))})},_getNodesToCollapse:function(nodes){return _.filter(nodes,function(node){return!node.isLeaf()&&node.isExpanded()})},_mergeNodeIds:function(nodes,nodeIds){_.each(nodes,function(node){nodeIds[node.getId()]=!0})},_onAfterItemAction:function(toggleContext,node){var nodeIdsToToggle=toggleContext.nodeIdsToToggle,toggledNodes=toggleContext.toggledNodes;_.has(nodeIdsToToggle,node.getId())&&(toggledNodes.push(node),delete nodeIdsToToggle[node.getId()],0===_.size(nodeIdsToToggle)&&toggleContext.deferred.resolve(toggledNodes))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeGridPrintDialog",{extend:Rally.ui.dialog.PrintDialog,height:300,layout:{type:"vbox",align:"left"},width:520,constructor:function(config){this.nodesToExpand=[],this.allRecords=[],this.callParent([Ext.merge({items:[{xtype:"container",html:"What would you like to print?",cls:"dialog-title"},{xtype:"radiogroup",itemId:"whattoprint",vertical:!0,columns:1,height:70,width:470,items:this._getPrintOptions(config.grid.getStore().enableHierarchy)},{xtype:"container",cls:config.grid.getStore().totalCount>200?"print-warning":"print-warning rly-hidden",html:'<div class="icon-warning alert"></div> Print is limited to 200 work items.'}]},config)])},initComponent:function(){this.callParent(arguments),this.on("print",this._handlePrintClick,this)},_handlePrintClick:function(){var treeStoreBuilder=Ext.create("Rally.data.wsapi.TreeStoreBuilder");treeStoreBuilder.build(this._buildStoreConfig()).then({success:function(store){store.parentTypes=this.grid.getStore().parentTypes,store.load()},scope:this})},_buildStoreConfig:function(){var includeChildren="includechildren"===this.down("#whattoprint").getChecked()[0].inputValue,gridStore=this.grid.getStore();return{autoLoad:!1,childPageSizeEnabled:!1,context:gridStore.context,enableHierarchy:includeChildren,fetch:gridStore.fetch,filters:gridStore.filters?gridStore.filters.items:[],listeners:{load:this._onStoreLoad,scope:this},models:gridStore.models||gridStore.model,pageSize:200,remoteSort:!0,root:{expanded:includeChildren},sorters:gridStore.getSorters()}},_onStoreLoad:function(treeStore,node,records,success,eOpts){_.isEmpty(this.allRecords)&&(this.allRecords=records),treeStore.enableHierarchy&&(this.nodesToExpand=_.without(this.nodesToExpand,node.getId()),_(records).filter(function(record){return!record.isLeaf()}).forEach(function(record){this.nodesToExpand.push(record.getId()),record.expand(!0)},this)),_.isEmpty(this.nodesToExpand)&&this._onDataReady()},_onDataReady:function(){var treeGridPrinter=Ext.create("Rally.ui.grid.TreeGridPrinter",Ext.apply({grid:this.grid,records:this.allRecords},this.treeGridPrinterConfig)),win=Rally.getWindow();win.printWindow&&win.printWindow.close(),win.printWindow=win.open(Rally.environment.getServer().getContextUrl()+"/print/printContainer.html","printWindow","height=600,width=1000,toolbar=no,menubar=no,scrollbars=yes"),win.printWindow?(treeGridPrinter.print(win.printWindow),win.printWindow.focus(),this.destroy()):alert("It looks like you have a popup blocker installed. Please turn this off to see the print window.")},_getPrintOptions:function(enableHierarchy){var options=[{boxLabel:"Summary list of items",name:"reportType",inputValue:"summary",checked:!0}];return enableHierarchy&&options.push({boxLabel:"Summary list of items with children",name:"reportType",inputValue:"includechildren"}),options}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.TreeGridPrinter",{extend:Ext.Component,_columnTypeMap:{iconColumns:["Blocked","Defects","Discussion","Ready","ScheduleState","Tasks","TestCases","PredecessorsAndSuccessors","DisplayColor"],numericColumns:["PlanEstimate","TaskEstimateTotal","TaskRemainingTotal"],simpleRenderedColumns:{ScheduleState:"ScheduleState",State:function(record){var state=record.get("State");return _.isObject(state)?state.Name:null===state||void 0===state?"":state},Discussion:function(record){return record.get("Summary").Discussion.Count||""}}},grid:void 0,largeHeaderText:"",records:void 0,smallHeaderText:"",constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},print:function(printWindow){var grid=this.generateTreeGridHTML(),whenLoaded=function(callbackFn,counter){printWindow.document.getElementById("large-header")&&!printWindow.document.alreadyProcessed?callbackFn():counter<20&&setTimeout(function(){whenLoaded(callbackFn,counter+1)},100)},me=this,onLoadFn=function(){printWindow.document.alreadyProcessed=!0;var logo=printWindow.document.getElementById("ca-print-logo");logo&&(logo.style.display="inline"),printWindow.document.getElementById("large-header").innerHTML=me.largeHeaderText,printWindow.document.getElementById("small-header").innerHTML=me.smallHeaderText,printWindow.document.getElementById("print").innerHTML=grid.outerHTML};whenLoaded(onLoadFn,0)},generateTreeGridHTML:function(){var tbl=this._createElement("table","table table-bordered table-condensed"),columns=this._buildColumns();this.sums={PlanEstimate:0,TaskEstimateTotal:0,TaskRemainingTotal:0},this._buildRows(this.records,tbl,columns,0),this._insertSumRow(tbl,columns);var thead=tbl.createTHead(),headerRow=this._createTableRow(thead);return this._createElement("th","type-indicator",headerRow),_.each(columns,function(column){var columnClass=this._getColumnClass(column.fieldName),cell=this._createElement("th",columnClass,headerRow);cell.innerHTML=column.text,column.cls&&this._createElement("div",column.cls,cell)},this),tbl},_insertSumRow:function(tbl,columns){var tr=tbl.insertRow(0);this._addClassesToElement(tr,"summary"),this._createTableCell(tr),_.each(columns,function(column){var td=this._createTableCell(tr,"text-right");this.sums.hasOwnProperty(column.fieldName)&&(td.innerHTML=this.sums[column.fieldName].toFixed(2))},this)},_buildRows:function(records,tbl,columns,indentLevel){_.each(records,function(record){var tr=this._createTableRow(tbl),td=this._createTableCell(tr,"type-indicator"),child=this._createElement("div",record.self.typeName),displayColor=record.get("DisplayColor");displayColor&&child.setAttribute("style","background-color: "+displayColor+" !important;"),td.appendChild(child),this._buildCells(columns,tr,record,indentLevel),record.childNodes&&record.childNodes.length&&this._buildRows(record.childNodes,tbl,columns,indentLevel+1)},this)},_buildCells:function(columns,tr,record,indentLevel){_.each(columns,function(column){var tpl,fieldName=column.fieldName,columnClass=this._getColumnClass(fieldName),td=this._createTableCell(tr,columnClass),field=record.getField(fieldName);field&&(this._columnTypeMap.simpleRenderedColumns.hasOwnProperty(fieldName)?td.innerHTML=this._renderSimpleColumn(record,fieldName):field.isMultiValueCustom()?td.innerHTML=this._renderCollectionColumn(record,fieldName):(tpl=Rally.ui.renderer.RendererFactory.renderRecordField(record,fieldName),td.innerHTML=tpl),"FormattedID"===fieldName&&indentLevel&&td.setAttribute("style","padding-left:"+20*indentLevel+"px"),this._sumValue(fieldName,record))},this)},_renderSimpleColumn:function(record,columnName){var val=this._columnTypeMap.simpleRenderedColumns[columnName];return Ext.isFunction(val)?val(record):record.get(columnName)},_renderCollectionColumn:function(record,fieldName){var data=record.get(fieldName);return data?_(data._tagsNameArray).map(function(val){return val.Name}).join(", "):""},_sumValue:function(fieldName,record){this.sums.hasOwnProperty(fieldName)&&record.parentNode.isRoot()&&(this.sums[fieldName]+=parseFloat(record.get(fieldName))||0)},_getColumnClass:function(columnFieldName){return _.contains(this._columnTypeMap.iconColumns,columnFieldName)?"text-center":_.contains(this._columnTypeMap.numericColumns,columnFieldName)?"text-right":void 0},_buildColumns:function(){return _.reduce(this.grid.columns,function(columns,column){return this._shouldDisplayColumn(column)&&columns.push({fieldName:column.dataIndex,text:column.text,cls:column.cls}),columns},[],this)},_shouldDisplayColumn:function(column){return column.text&&"DragAndDropRank"!==column.dataIndex&&column.dataIndex.indexOf("gridcolumn")===-1},_addClassesToElement:function(element,classes){classes&&element.setAttribute("class",classes)},_createElement:function(type,classes,parent){var elem=document.createElement(type);return this._addClassesToElement(elem,classes),parent&&parent.appendChild(elem),elem},_createTableRow:function(table,classes){var row=table.insertRow(-1);return this._addClassesToElement(row,classes),row},_createTableCell:function(tableRow,classes){var cell=tableRow.insertCell(-1);return this._addClassesToElement(cell,classes),cell}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.DragZone",{extend:Ext.view.DragZone,constructor:function(config){config.proxy=Ext.create("Rally.ui.grid.dragdrop.TreeDragDropRowProxy",{id:config.view.el.dom.parentNode.id+"-drag-status-proxy",dragZone:this,animRepair:!1}),this.callParent([config])},autoOffset:function(){var itemEl=Ext.get(this.dragData.item),x=itemEl.down("td").getWidth()/2,y=itemEl.getHeight()/2;this.setDelta(x,y)},onDragOut:function(){}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.dragdrop.DropZone",{extend:Ext.grid.ViewDropZone,destroy:function(){delete this.rowPositions,this.callParent(arguments)},positionIndicator:function(node,data,e){var rowNode=this._getRowNodeByXY(e.xy);if(rowNode){var indicatorY,me=this,view=me.view,pos=me.getPosition(e,rowNode),overRecord=view.getRecord(rowNode);me.valid=!0,me.overRecord===overRecord&&me.currentPosition===pos||(indicatorY=Ext.fly(rowNode).getY()-view.el.getY()-1,"after"===pos&&(indicatorY+=Ext.fly(rowNode).getHeight()),me.getIndicator().setWidth(view.getEl().down("table").getWidth()).showAt(0,indicatorY),me.overRecord=overRecord,me.currentPosition=pos)}},onNodeOver:function(node,dragZone,e,data){var me=this;return me.positionIndicator(node,data,e),me.valid?me.dropAllowed:me.dropNotAllowed},onNodeDrop:function(nodeData,source,e,data){return data.item!==this._getRowNodeByXY(e.getXY())&&void this.callParent(arguments)},onInitDrag:function(){this.rowPositions=null,this.viewEl=Ext.get(this.getEl()),this.yScrollOffset=this.viewEl.getScroll().top},_getRowNodeByXY:function(xy){var result,y=xy[1],yScrollOffset=this.viewEl.getScroll().top-this.yScrollOffset,positions=this._getRowNodePositions();return result=_.find(positions,function(position){var box=position[0];return y>=box.y-yScrollOffset&&y<=box.bottom-yScrollOffset}),result&&result[1]||null},_getRowNodePositions:function(){if(!this.rowPositions){for(var positions=[],rows=Ext.fly(this.getEl()).query("tr"),i=0,len=rows.length;i<len;i++){var node=rows[i],box=Ext.fly(node).getBox();box.bottom=box.y+box.height,positions.push([box,node])}this.rowPositions=positions}return this.rowPositions}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.grid.plugin.PercentDonePopoverPlugin",{extend:Ext.AbstractPlugin,alias:"plugin.rallypercentdonepopoverplugin",constructor:function(config){return this.initConfig(config),this.callParent(arguments)},init:function(grid){this.grid=grid,this.grid.store.mon(grid.store,"load",this._onLoad,this)},_onLoad:function(){this._attachPopovers("PercentDoneByStoryCount"),this._attachPopovers("PercentDoneByStoryPlanEstimate")},_attachPopovers:function(fieldName){var me=this;this.grid.getEl().select(".progress-bar-container.field-"+fieldName).each(function(flyEl){var el=Ext.get(flyEl.dom),record=me._getRecordFor(el),piRef=record._ref?record._ref:record.raw._ref;el.on("click",function(){Ext.create("Rally.ui.popover.PercentDonePopover",{target:el,targetSelector:me._getSelectorFor(record.data.FormattedID,fieldName),percentDoneData:record.data,percentDoneName:fieldName,piRef:piRef})})})},_getRecordFor:function(el){var row=el.up("."+Ext.baseCSSPrefix+"grid-row");return row?this.grid.getStore().getAt(row.dom.rowIndex):null},_getSelectorFor:function(formattedID,fieldName){return"."+formattedID+"-"+fieldName}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.BacklogColumn",{extend:Rally.ui.cardboard.Column,alias:"widget.rallyplanningbacklogcolumn",cls:"column",mixins:{maskable:Rally.ui.mask.Maskable},config:{value:null},initComponent:function(){this.callParent(arguments),this.on({aftercarddroppedsave:this._afterCardDroppedSave,afterrender:{fn:function(){var cls="planning-column backlog";_.invoke(this.getContentCellContainers(),"addCls",cls),this.getStatusCell().addCls(cls),this.getColumnHeaderCell().addCls(cls)},single:!0},scope:this})},_afterCardDroppedSave:function(column,card,type,sourceColumn){sourceColumn&&sourceColumn.columnStatus&&sourceColumn.columnStatus.reloadAndUpdate()},getColumnStatus:function(){return this.columnStatus},getStatusCell:function(){return Ext.get(this.statusCell)},drawHeader:function(){this.callParent(arguments),this.getColumnHeader().add({xtype:"rallysearchfield",listeners:{search:this._searchBacklog,scope:this}})},_searchBacklog:function(cmp,value){this.storeConfig.search!==value&&this.refresh({storeConfig:{search:value?Ext.String.trim(value):""}})},getStoreFilter:function(model){var filters=[];return Ext.Array.push(filters,this.callParent(arguments)),"HierarchicalRequirement"===model.elementName?this.context.getSubscription().StoryHierarchyEnabled&&filters.push({property:"DirectChildrenCount",operator:"=",value:0}):"Defect"===model.elementName&&Ext.Array.push(filters,{property:"Requirement",operator:"=",value:null},{property:"State",operator:"!=",value:"Closed"}),filters},isMatchingRecord:function(record){var isMatching=this.callParent(arguments);return"HierarchicalRequirement"===record.self.elementName?isMatching=isMatching&&(!record.hasField("DirectChildrenCount")||0===record.get("DirectChildrenCount")):"Defect"===record.self.elementName&&(isMatching=isMatching&&(!record.hasField("Requirement")||!record.get("Requirement"))),isMatching}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.TimeboxCardBoard",{extend:Rally.ui.cardboard.CardBoard,alias:"widget.rallytimeboxcardboard",initComponent:function(){this.callParent(arguments),this.on({load:this._normalizeColumnStatusFieldStyles,scroll:this._normalizeColumnStatusFieldStyles,scope:this})},showColumn:function(column){this.callParent(arguments),column.getStatusCell().removeCls(column.self.HIDDEN_CLS)},hideColumn:function(column){this.callParent(arguments),column.getStatusCell().addCls(column.self.HIDDEN_CLS)},destroyColumn:function(column){this.callParent(arguments),Ext.removeNode(column.getStatusCell().dom)},createColumnElements:function(afterOrBefore,column){var insertFnName="after"===afterOrBefore?"insertAfter":"insertBefore",els=this.callParent(arguments),statusCell=Ext.DomHelper.createDom(this._getColumnDomHelperConfig({tag:"th",cls:"card-column-status"}));return Ext.fly(statusCell)[insertFnName](column.getStatusCell()),els.statusCell=statusCell,els},_generateHeaderHtml:function(){return this.callParent(arguments)+this._generateTableRowHtml({tag:"th",cls:"card-column-status"})},_addColumnsToDom:function(){var statusCellQuery=this.getEl().query(".column-headers th.card-column-status"),headerCellQuery=this.getEl().query(".column-headers th.card-column");_.forEach(this.columnDefinitions,function(colDef,idx){this.renderColumn(colDef,{headerCell:headerCellQuery[idx],statusCell:statusCellQuery[idx]})},this)},_normalizeColumnStatusFieldStyles:function(){var atLeastOneColumnHasProgressBar=_.some(this.scrollableColumnRecords,function(timeboxRecord){var plannedVelocity=timeboxRecord.get("PlannedVelocity");return Ext.isNumber(plannedVelocity)&&plannedVelocity>0});atLeastOneColumnHasProgressBar&&this.getEl().select(".card-column-status > div").each(function(el){el.down(".rly-progress-bar")||el.addCls("empty-status")})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.PlannedVelocityPopover",{extend:Rally.ui.popover.Popover,alias:"popover.plannedvelocitypopover",modal:!1,placement:"bottom",shouldHidePopoverOnBodyClick:!0,saveOnClose:!1,cls:"planned-velocity-popover",title:"Planned Velocity",width:400,header:!0,offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:0,y:20},{x:0,y:0}],constructor:function(config){this.callParent(arguments);var onSaveClicked=Ext.bind(config.onSaveClicked,this),label=config.unitName.toLowerCase(),plannedVelocityFieldId="plannedVelocityField";this.add([{layout:{type:"hbox",align:"middle"},items:[{flex:3,xtype:"numberfield",value:config.plannedVelocity,fieldLabel:config.projectName+'<br/><span style="font-family: NotoSansBold">'+config.releaseName+"</span>",hideTrigger:!0,labelAlign:"left",labelPad:50,labelStyle:"color: white; font-size: 13px; padding-left: 10px; line-height: 16px;",labelSeparator:"",labelWidth:165,maxTextLength:9,maxDecimalPrecision:3,id:plannedVelocityFieldId,inputAttrTpl:'style="height: 30px; padding: 5px;  font-size: 13px; text-align: right; width: 65px;',enableKeyEvents:!0,minValue:0,width:275,selectOnFocus:!0,listeners:{keyup:function(form,event){event.getKey()===event.ENTER&&onSaveClicked()}}},{flex:1,xtype:"panel",style:"padding-top: 10px; font-size: 12px; vertical-align: middle; margin-top: 3px; padding-left: 5px; position: relative; bottom: 8px;",html:label}]}]),config.hasChildren&&this.add([{style:"padding-left: 10px; padding-top: 10px;",cls:"children-planned-velocity-rollup",items:[{colspan:2,xtype:"component",html:"Child Project's Release rollup",cls:"popover-label",style:"display: inline-block; width: 50%; font-size: 12px;"},{xtype:"component",html:'(<span class="children-planned-velocity-rollup-value">'+config.childVelocity+"</span>) "+label,cls:"popover-label",style:"display: inline-block; width: 50%; text-align: right; font-size: 12px; padding-right: 15px;"}]}]),this.add([{cls:"capacity-buttons",style:"padding-top: 15px; text-align: center;",items:[{xtype:"rallybutton",itemId:"capacityDone",text:"Save",cls:"primary button small rly-right",style:"float: none;",listeners:{click:config.onSaveClicked,scope:this}},{xtype:"rallybutton",itemId:"capacityCancel",text:"Cancel",cls:"secondary dark button small rly-right",style:"float: none;",listeners:{click:config.onCancelClicked,scope:this}}]}]),Ext.getCmp(plannedVelocityFieldId).focus()}})}.call(this),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.progressbar.TimeboxProgressBarTemplate",{extend:Rally.ui.renderer.template.progressbar.ProgressBarTemplate,config:{calculateColorFn:function(recordData){return recordData.percentDone<.8?Rally.util.Colors.blue_med:recordData.percentDone<=1?Rally.util.Colors.lime:Rally.util.Colors.red_med},generateAmountCompleteText:function(recordData){return Ext.util.Format.round(recordData.amountComplete,2)},generateChildrenTotalVelocityText:function(recordData){return recordData.childVelocity?"("+Ext.util.Format.round(recordData.childVelocity,2)+")":""},generateTotalPlannedVelocityText:function(recordData){return recordData.parentVelocity&&recordData.total?Ext.util.Format.round(recordData.total,2):'<a href="#">Set Planned Velocity</a>'},calculatePercent:function(recordData){var percentDone=recordData[this.percentDoneName],totalPlannedVelocity=recordData.total;return _.isNaN(percentDone)||0===totalPlannedVelocity?"--":Math.round(100*percentDone)},getOffsetDimensions:function(){return"width:"+this.offsetWidth+";display: inline-block; color: white; text-align: center; vertical-align: top; line-height: 18px;"}},template:['<tpl if="this.shouldShowPercentDone(values)">','<div style="{[this.getOffsetDimensions()]}"></div>','<div class="progress-bar-container field-{[this.percentDoneName]} {[this.getClickableClass()]} {[this.getContainerClass(values)]}" style="cursor: pointer; {[this.getDimensionStyle()]}">','<div class="rly-progress-bar" style="background-color: {[this.calculateColorFn(values)]}; width: {[this.calculateWidth(values)]}; "></div>','<tpl if="this.showDangerNotificationFn(values)">','<div class="progress-bar-danger-notification"></div>',"</tpl>",'<div class="progress-bar-label">',"{[this.generateAmountCompleteText(values)]}"," of ","{[this.generateTotalPlannedVelocityText(values)]}"," {[this.generateChildrenTotalVelocityText(values)]} ",'<span class="icon-edit" style="position:relative; top: 1px;"></span>',"</div>","</div>",'<div style="{[this.getOffsetDimensions()]}">','<span class="progressbar-percentage">{[this.calculatePercent(values)]}%</span>',"</div>","</tpl>"],constructor:function(config){return config.template=this.template,this.initConfig(config),this.callParent(arguments)},apply:function(values,parent){var html=this.callParent(arguments);return""===html?html:'<div class="progress-bar-background">'+html+"</div>"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.TimeboxColumnProgressBar",{extend:Ext.Component,alias:"widget.rallytimeboxcolumnprogressbar",pointField:void 0,constructor:function(config){this.callParent(arguments),this.renderTpl=Ext.create("Rally.ui.renderer.template.progressbar.TimeboxProgressBarTemplate",{height:"18px",width:"80%",offsetWidth:"10%",progressBarComponent:this}),this.attribute=config.attribute},initComponent:function(){var columnStore=this._getColumn().getStore();this.store=columnStore.clone(),this.store.fetch=["sum:["+this.pointField+"]"],this.store.filters=columnStore.filters.clone(),this.store.pageSize=1,this.store.sorters=new Ext.util.MixedCollection},reloadAndUpdate:function(){this.store.load({callback:function(records,operation){operation.success?this.update():Rally.ui.notify.Notifier.showError({message:Rally.data.util.Record.getWsapiOperationErrorMessage(operation)})},scope:this})},update:function(){var html=this.renderTpl.apply(this._getRenderData());this.callParent([html]),this._getProgressBarContainer().on("click",this._onPlannedVelocityLinkClick,this),this._getProgressBarContainer().on("mouseenter",this._onProgressBarMouseEnter,this),this._getProgressBarContainer().on("mouseleave",this._onProgressBarMouseLeave,this),this._createTooltip(),this._hideEditIcon()},_onProgressBarMouseEnter:function(){this._showEditIcon()},_onProgressBarMouseLeave:function(){this._hideEditIcon()},_onPlannedVelocityLinkClick:function(event){event.preventDefault(),this._disableTooltip(),this._createPopoverWithData()},_createPopoverWithData:function(){var saveTimeboxRecord=Ext.bind(this._saveTimeboxRecord,this),enableTooltip=Ext.bind(this._enableTooltip,this);Ext.create("Rally.ui.popover.PlannedVelocityPopover",{plannedVelocity:this._getParentPlannedVelocityRollup(),childVelocity:this._getChildrenPlannedVelocityRollup(),hasChildren:this._hasChildren(),projectName:this._getProjectName(),releaseName:this._getReleaseName(),target:this._getProgressBarContainer(),unitName:this._getUnitName(),onSaveClicked:function(){var plannedVelocity=Ext.getCmp("plannedVelocityField").getValue();saveTimeboxRecord(plannedVelocity),this.close()},onCancelClicked:function(){enableTooltip(),this.close()},listeners:{hide:function(){this._enableTooltip()},close:function(){this._enableTooltip()},scope:this}})},_showEditIcon:function(){this.getEl().down(".icon-edit").show()},_hideEditIcon:function(){this.getEl().down(".icon-edit").hide()},_getProject:function(){return Rally.environment.getContext().getProject()},_getWorkspace:function(){return Rally.environment.getContext().getWorkspace()},_getProjectName:function(){return this._getProject().Name},_getUnitName:function(){var key=this.attribute.toLowerCase();return this._getWorkspace().WorkspaceConfiguration[this._getUnitKey(key)]},_getReleaseName:function(){return this._getParentTimebox().get("Name")},_getUnitKey:function(key){var keyMap={iteration:"IterationEstimateUnitName",release:"ReleaseEstimateUnitName"};return keyMap[key]},_saveTimeboxRecord:function(plannedVelocity){var timeboxRecord=this._getParentTimebox();timeboxRecord.set("PlannedVelocity",plannedVelocity),timeboxRecord.save(),this.update()},_disableTooltip:function(){this.tooltip.disable()},_enableTooltip:function(){this.tooltip.enable()},_createTooltip:function(){this.tooltip&&this._destroyTooltip(),this.tooltip=Ext.create("Rally.ui.tooltip.ToolTip",{cls:"set-planned-velocity-tooltip",bodyStyle:"text-align: center;",width:150,anchor:"top",target:this._getProgressBarContainer(),html:"Edit Planned Velocity"})},_destroyTooltip:function(){this.tooltip.destroy(),delete this.tooltip},_getProgressBarContainer:function(){return this.getEl().down(".progress-bar-container")},_getColumn:function(){return this.column},_getRenderData:function(){var totalPointCount=this._getTotalPointCount(),totalPlannedVelocity=this._getTotalPlannedVelocityRollup(),parentPlannedVelocity=this._getParentPlannedVelocityRollup(),childPlannedVelocity=this._getChildrenPlannedVelocityRollup();return{percentDone:totalPlannedVelocity?totalPointCount/totalPlannedVelocity:0,amountComplete:totalPointCount,total:totalPlannedVelocity,parentVelocity:parentPlannedVelocity,childVelocity:childPlannedVelocity}},_getTotalPointCount:function(){var sums=this.store.getSums(),pointFieldSum=sums[this.pointField];return pointFieldSum||0},_getRecordValue:function(record,fieldName){return _.isString(fieldName)&&_.reduce(fieldName.split("."),function(result,fieldName){
if(result)return result.isModel?result.get(fieldName):result[fieldName]},record)},_getParentTimebox:function(){return this._getColumn().getTimeboxRecord()},_getFromTimebox:function(field){var parent=this._getParentTimebox();if(parent){var value=parent.get(field);if(Ext.isNumber(value))return value}return 0},_hasChildren:function(){return Rally.environment.getContext().getProject().Children&&Rally.environment.getContext().getProject().Children.Count},_getChildrenPlannedVelocityRollup:function(){return this._getFromTimebox("ChildrenPlannedVelocity")},_getParentPlannedVelocityRollup:function(){return this._getFromTimebox("PlannedVelocity")},_getTotalPlannedVelocityRollup:function(){return this._getParentPlannedVelocityRollup()+this._getChildrenPlannedVelocityRollup()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.TimeboxColumn",{extend:Rally.ui.cardboard.Column,alias:"widget.rallytimeboxcolumn",config:{startDateField:"StartDate",endDateField:"EndDate",timeboxRecord:null,columnStatusConfig:{xtype:"rallytimeboxcolumnprogressbar",pointField:"PlanEstimate"}},cls:"column",currentTimeboxCls:"current-timebox",constructor:function(config){this.mergeConfig(config),this.config=Ext.merge({columnHeaderConfig:{record:this._getTimeboxRecord(),fieldToDisplay:"Name",editable:!1}},this.config),this.config.value=Rally.util.Ref.getRelativeUri(this._getTimeboxRecord()),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.on({addcard:this._updateColumnStatus,load:this._updateColumnStatus,removecard:this._updateColumnStatus,cardupdated:this._updateColumnStatus,aftercarddroppedsave:this._afterCardDroppedSave,afterrender:{fn:this._addPlanningClasses,single:!0},scope:this})},_afterCardDroppedSave:function(column,card,type,sourceColumn){sourceColumn&&sourceColumn.columnStatus&&sourceColumn.columnStatus.reloadAndUpdate()},_updateColumnStatus:function(){this.columnStatus?this.columnStatus.reloadAndUpdate():(this.drawStatus(),this._updateColumnStatus())},getStoreFilter:function(model){return[{property:this._getTimeboxModelName()+".Name",value:this._getTimeboxRecord().get("Name")},{property:this._getTimeboxModelName()+"."+this.startDateField,value:Rally.util.DateTime.toIsoString(this._getTimeboxRecord().get(this.startDateField))},{property:this._getTimeboxModelName()+"."+this.endDateField,value:Rally.util.DateTime.toIsoString(this._getTimeboxRecord().get(this.endDateField))}]},getColumnStatus:function(){return this.columnStatus},getStatusCell:function(){return Ext.get(this.statusCell)},isMatchingRecord:function(record){var columnTimebox=this._getTimeboxRecord().raw,recordTimebox=record.get(this._getTimeboxModelName());return null===recordTimebox||void 0===recordTimebox?null===columnTimebox||void 0===columnTimebox:recordTimebox.Name===columnTimebox.Name&&recordTimebox[this.startDateField]===columnTimebox[this.startDateField]&&recordTimebox[this.endDateField]===columnTimebox[this.endDateField]},afterRender:function(){this.callParent(arguments),this.drawStatus()},drawHeader:function(){this.callParent(arguments),this._addTimeboxDates()},drawStatus:function(){this.columnStatusConfig&&!this.getColumnStatus()&&(this.columnStatus=Ext.widget(Ext.merge({renderTo:this.getStatusCell(),column:this,attribute:this.config.attribute},this.columnStatusConfig)))},_addTimeboxDates:function(){this.getColumnHeader().add({xtype:"component",html:this.getTimeboxDatesTpl().apply(this.getTimeboxDatesTplData())})},getTimeboxDatesTpl:function(){return this.timeboxDatesTpl=this.timeboxDatesTpl||Ext.create("Ext.XTemplate",'<div class="timeboxDates">{formattedStartDate} - {formattedEndDate}</div>'),this.timeboxDatesTpl},getTimeboxDatesTplData:function(){return{formattedStartDate:this._getFormattedDate(this.startDateField),formattedEndDate:this._getFormattedDate(this.endDateField)}},getProgressBar:function(){return this.getColumnStatus()},_getFormattedDate:function(fieldName){return Rally.util.DateTime.formatDate(this._getTimeboxRecord().get(fieldName),!1)},_getTimeboxRecord:function(){return this.timeboxRecord},_getTimeboxModelName:function(){return this._getTimeboxRecord().self.displayName},_isCurrentTimebox:function(){var now=new Date;return this._getTimeboxRecord().get(this.startDateField)<=now&&this._getTimeboxRecord().get(this.endDateField)>=now},_addPlanningClasses:function(){var cls="planning-column";this._isCurrentTimebox()&&(cls+=" "+this.currentTimeboxCls),_.invoke(this.getContentCellContainers(),"addCls",cls),this.getStatusCell().addCls(cls),this.getColumnHeaderCell().addCls(cls)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.TimeboxScrollable",{alias:"plugin.rallytimeboxscrollablecardboard",extend:Rally.ui.cardboard.plugin.Scrollable,_isBackwardsButtonHidden:function(){return this.cmp.scrollableColumnRecords[0]===this.getFirstVisibleScrollableColumn().timeboxRecord},_isForwardsButtonHidden:function(){return _.last(this.cmp.scrollableColumnRecords)===this.getLastVisibleScrollableColumn().timeboxRecord},_scroll:function(forwards){var insertNextToColumn=this._getInsertNextToColumn(forwards),newlyVisibleRecord=this.cmp.scrollableColumnRecords[Ext.Array.indexOf(this.cmp.scrollableColumnRecords,insertNextToColumn.timeboxRecord)+(forwards?1:-1)],indexOfNewColumn=Ext.Array.indexOf(this.cmp.getColumns(),insertNextToColumn);this.cmp.destroyColumn(this._getColumnToRemove(forwards));var column=this.cmp.addColumn({timeboxRecord:newlyVisibleRecord},indexOfNewColumn),columnEls=this.cmp.createColumnElements(forwards?"after":"before",insertNextToColumn);this.cmp.renderColumn(column,columnEls),this.cmp.fireEvent("scroll",this.cmp),this._afterScroll(forwards)},_sizeButtonToColumnHeader:function(button,column){var columnHeaderHeight=column.getColumnHeaderCell().getHeight(Ext.isGecko||Ext.isIE);button.getEl().setHeight(columnHeaderHeight)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.planning.TimeboxGridBoard",{extend:Rally.ui.gridboard.GridBoard,alias:"widget.rallytimeboxgridboard",mixins:[Rally.Messageable],cls:"rui-gridboard planning-board",endDateField:"EndDate",numColumns:3,startDateField:"StartDate",timeboxType:void 0,toggleState:"board",initComponent:function(){this.on("toggle",function(toggleState,gridOrBoard){"board"!==toggleState||this._hasTimeboxes()||this.mon(gridOrBoard,"aftercolumnrender",this._addBoardBlankSlate,this)},this),this.subscribe(this,Rally.Message.objectCreate,this._onObjectChange,this),this.subscribe(this,Rally.Message.objectUpdate,this._onObjectChange,this),this.subscribe(this,Rally.Message.objectDestroy,this._onObjectChange,this),this.callParent(arguments)},_addGridOrBoard:function(){this.timeboxes?this.callParent(arguments):(Rally.data.ModelFactory.getModel({type:this.timeboxType,context:this.getContext().getDataContext(),requester:this,success:this._findTimeboxes,scope:this}),this.setLoading(!0))},_getBoardConfig:function(){var initiallyVisibleTimeboxes=this._getInitiallyVisibleTimeboxes(),columns=this._getColumnConfigs(initiallyVisibleTimeboxes);return Ext.merge(this.callParent(arguments),{xtype:"rallytimeboxcardboard",attribute:this.timeboxType,cardConfig:{showBlockedReason:!0,showIconMenus:!0},columns:columns,columnConfig:{xtype:"rallytimeboxcolumn",endDateField:this.endDateField,startDateField:this.startDateField,storeConfig:{fetch:["Parent","Requirement",this.startDateField,this.endDateField],pageSize:25}},plugins:[{ptype:"rallytimeboxscrollablecardboard",backwardsButtonConfig:{elTooltip:"Previous "+this.timeboxType},forwardsButtonConfig:{elTooltip:"Next "+this.timeboxType},getFirstVisibleScrollableColumn:function(){return this.getScrollableColumns()[0]},getLastVisibleScrollableColumn:function(){return _.last(this.getScrollableColumns())},getScrollableColumns:function(){return Ext.Array.slice(this.cmp.getColumns(),1,this.cmp.getColumns().length)}}],scrollableColumnRecords:this.timeboxes})},_getInitiallyVisibleTimeboxes:function(){if(this.timeboxes.length<=this.numColumns)return this.timeboxes;var previousTimeboxes=[],futureAndCurrentTimeboxes=[];Ext.Array.each(this.timeboxes,function(timeboxRecord){timeboxRecord.get(this.endDateField)>=new Date?futureAndCurrentTimeboxes.push(timeboxRecord):previousTimeboxes.push(timeboxRecord)},this),futureAndCurrentTimeboxes=Rally.util.Array.firstElementsOf(futureAndCurrentTimeboxes,this.numColumns);var possiblyVisibleTimeboxes=previousTimeboxes.concat(futureAndCurrentTimeboxes);return Rally.util.Array.lastElementsOf(possiblyVisibleTimeboxes,this.numColumns)},_getColumnConfigs:function(timeboxes){var columns=[{xtype:"rallyplanningbacklogcolumn",flex:this._hasTimeboxes()?1:1/3,columnHeaderConfig:{headerTpl:"Backlog"}}];return Ext.Array.each(timeboxes,function(timeboxRecord){columns.push({columnHeaderConfig:{record:timeboxRecord,fieldToDisplay:"Name",editable:!1},timeboxRecord:timeboxRecord})},this),columns},_hasTimeboxes:function(){return this.timeboxes&&this.timeboxes.length>0},_findTimeboxes:function(model){Ext.create("Rally.data.wsapi.Store",{model:model,fetch:["Name",this.startDateField,this.endDateField,"Project","PlannedVelocity","ChildrenPlannedVelocity"],autoLoad:!0,listeners:{load:this._onTimeboxesLoad,scope:this},context:{project:this.getContext().getDataContext().project,projectScopeUp:!1,projectScopeDown:!1},requester:this,limit:1/0})},_addBoardBlankSlate:function(board){this.addCls("no-timebox"),board.getEl().down(".columns tr td").setStyle("width","33%");var blankSlateTd=Ext.DomHelper.append(board.getEl().down(".columns tr"),'<td class="blank-slate-column"></td>',!0),blankSlate=Ext.widget({xtype:"rallytimeboxblankslate",timeboxType:this.timeboxType,context:this.getContext(),renderTo:blankSlateTd});this.on("destroy",function(){blankSlate.destroy()}),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_onTimeboxesLoad:function(store){this.timeboxes=_.sortBy(store.getRange(),function(record){return record.get(this.endDateField)},this),this.setLoading(!1),this._addGridOrBoard("board")},_onObjectChange:function(record){if(Ext.isArray(record))return void Ext.Array.each(record,this._onObjectChange,this);if(record.get("_type").toLowerCase()===this.timeboxType.toLowerCase()){var gridOrBoard=this.getGridOrBoard();gridOrBoard&&gridOrBoard.destroy(),this.timeboxes=null,this._addGridOrBoard()}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.BoardPolicyDisplayable",{extend:Ext.AbstractPlugin,alias:"plugin.rallyboardpolicydisplayable",mixins:[Rally.ui.gridboard.plugin.GridBoardControlShowable,Ext.util.Observable],prefKey:"boardPolicyDisplay",prefValue:void 0,prefRequestPromise:void 0,showInGridMode:!1,checkboxConfig:{},callback:void 0,callbackScope:void 0,init:function(cmp){this.callParent(arguments),this.cmp=cmp,this.mon(cmp,"toggle",this._onGridBoardToggle,this),this.showControl()},getControlCmpConfig:function(){return this.checkboxConfig=Ext.merge({xtype:"checkboxfield",itemId:"policyDisplayCheckbox",cls:"type-checkbox agreements-checkbox",margin:"0 5",boxLabel:"Show Policies",inputValue:this.prefKey,checked:void 0,handler:this._onShowPolicyClicked,scope:this},this.checkboxConfig),this.checkboxConfig},isChecked:function(){return this._getCheckbox().getValue()},_savePreference:function(value){var settings={};settings[this.prefKey]=value,Rally.data.PreferenceManager.update({requester:this.cmp,appID:this._getAppId(),filterByUser:!0,settings:settings,success:function(updatedRecords){this.cmp.fireEvent("preferencesaved",updatedRecords[0])},scope:this})},_loadPreference:function(){return this.prefRequestPromise=Rally.data.PreferenceManager.load({requester:this.cmp,appID:this._getAppId(),filterByUser:!0,filterByName:this.prefKey,scope:this}),this.prefRequestPromise},_onPreferenceRetrieved:function(pref){var prefValue="true"===pref[this.prefKey];this._getCheckbox().lastValue=prefValue,this._setCheckboxRawValue(prefValue),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_getCheckbox:function(){return this.cmp.getHeader().getRight().down("#"+this.checkboxConfig.itemId)},_setCheckboxRawValue:function(value){this._getCheckbox().setRawValue(value)},_onShowPolicyClicked:function(checkbox,checked){this._showOrHidePolicy(),this._savePreference(checked),Ext.callback(this.callback,this.callbackScope,[checked])},_showOrHidePolicy:function(){if(this._setCheckboxRawValue(this._getCheckbox().getValue()),"board"===this.cmp.getToggleState()){var board=this.cmp.getGridOrBoard();_.isEmpty(board.getColumns())?this.mon(board,"aftercolumnrender",this._showOrHidePolicyForColumns,this,{single:!0}):this._showOrHidePolicyForColumns(board)}},_showOrHidePolicyForColumns:function(board){var eventName=this._getCheckbox().getValue()===!0?"showpolicy":"hidepolicy";_.invoke(board.getColumns(),"fireEvent",eventName),board.fireEvent("headersizechanged")},_onGridBoardToggle:function(toggleState,gridOrBoard){this.prefRequestPromise||this._loadPreference().then({success:this._onPreferenceRetrieved,scope:this}),this.prefRequestPromise.then({success:function(){this._showOrHidePolicy()},scope:this})},_getAppId:function(){return this.cmp.getContext()?this.cmp.getContext().get("appID"):null}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tooltip.FilterInfo",{extend:Ext.Component,alias:"widget.rallyfilterinfo",cls:"filterInfo",renderTpl:"<a></a>",renderSelectors:{link:"a"},config:{projectName:void 0,scopeUp:!1,scopeDown:!1,typePath:void 0,query:void 0},afterRender:function(){this.callParent(arguments),this.tooltip=Ext.create("Rally.ui.tooltip.ToolTip",{cls:"filterInfoTooltip",width:250,target:this.link,anchor:"top",anchorOffset:200,getTargetXY:function(){var filterPosition=this.target.getXY();return[filterPosition[0]-210,filterPosition[1]+26]},listeners:{beforeShow:function(tip){tip.update(this.getTooltipContent())},scope:this}})},getTooltipContent:function(){var query=this.query;try{query=Rally.data.wsapi.Filter.fromQueryString(query).toString()}catch(e){}var tplData={project:this.projectName,type:this.typePath,query:query};return this.scopeUp&&this.scopeDown?tplData.scopingCls="scopeUpAndDown":this.scopeUp?tplData.scopingCls="scopeUp":this.scopeDown?tplData.scopingCls="scopeDown":tplData.scopingCls="noScope",Ext.create("Ext.XTemplate",'<tpl if="project">','<div class="filterInfoTooltipLineItem">',"<label>Project:</label>","<span>{project}</span>",'<span class="{scopingCls}"></span>',"</div>","</tpl>",'<tpl if="type">','<div class="filterInfoTooltipLineItem">',"<label>Type:</label> ","<span>{type}</span>","</div>","</tpl>",'<tpl if="query">','<div class="filterInfoTooltipLineItem">','<label class="queryLabel">Query:</label> ','<span class="queryString">{query}</span>',"</div>","</tpl>").apply(tplData)},destroy:function(){this.callParent(arguments),this.tooltip&&this.tooltip.destroy()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardFilterInfo",{alias:"plugin.rallygridboardfilterinfo",extend:Ext.AbstractPlugin,isGloballyScoped:!1,queryString:null,init:function(gridboard){gridboard.on("afterrender",this._onAfterRender,this,{single:!0}),this.callParent(arguments)},_onAfterRender:function(){var context,config,cmp=this.cmp;this.isGloballyScoped?config={projectName:"Following Global Project Setting"}:(context=this.cmp.getContext(),config={projectName:context&&context.getProject()&&context.getProject().Name||"Following Global Project Setting",scopeUp:context&&context.getProjectScopeUp(),scopeDown:context&&context.getProjectScopeDown()}),cmp.getHeader().getRight().add(Ext.merge({xtype:"rallyfilterinfo",query:this.queryString},config))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.gridboard.plugin.GridBoardManageIterations",{alias:"plugin.rallygridboardmanageiterations",extend:Ext.AbstractPlugin,init:function(gridboard){this.gridboard=gridboard,this.gridboard.manageIterationsPlugin=this,this._addManageIterations()},_getProjectRef:function(){var context=this.gridboard.getContext();return context?context.getProject()._ref:Rally.environment.getContext().getProject()._ref},_getManageIterationsContainer:function(){return this.gridboard.getHeader().getRight()},_addManageIterations:function(){var canManageIterations=Rally.environment.getContext().getPermissions().isProjectEditor(this._getProjectRef());canManageIterations&&this._getManageIterationsContainer().add({xtype:"rallybutton",text:"Manage Iterations",cls:"manage-iterations primary rly-small",handler:this._onManageIterationsClicked,scope:this})},_onManageIterationsClicked:function(){Rally.nav.Manager.manageIterations(this.gridboard.getContext())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.list.ListView",{cls:"rallyListView",extend:Ext.Container,alias:"widget.rallylistview",mixins:{messageable:Rally.Messageable},config:{model:void 0,addNewConfig:{recordTypes:[],ignoredRequiredFields:["Name","Project"]},gridConfig:{autoAddAllModelFieldsAsColumns:!0},autoAddGrid:!0},items:[{itemId:"header",xtype:"rallyleftright",margin:"4 0 4 0",minHeight:40}],constructor:function(config){this.config=this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addEvents("modelload","datachanged"),window.detail&&(window.detail.refreshContent=!1),this._loadModel()},getHeader:function(){return this.down("#header")},storePageSize:function(newPageSize){},_addAddNew:function(){Ext.isEmpty(this.addNewConfig.recordTypes)||(this.addNew=this.getHeader().getLeft().add(Ext.apply({},this.addNewConfig,{id:"addNewContainer",xtype:"rallyaddnew",style:"clear:both"})),this.mon(this.addNew,{beforecreate:this.onAddNewBeforeCreate,beforeeditorshow:this.onAddNewBeforeEditorShow,create:this.onAddNewCreate,error:this.onAddNewError,expand:this.onAddNewExpand,collapse:this.onAddNewCollapse,scope:this}))},_addAddExisting:function(){Ext.isEmpty(this.addExistingConfig)||(this.addExisting=this.getHeader().getLeft().add({xtype:"rallybutton",cls:"add-existing primary rly-small",handler:function(){Ext.create("Rally.ui.dialog.ArtifactCollectionChooserDialog",this.addExistingConfig.chooserDialogConfig)},margin:"3 0 2 0",scope:this,style:{clear:"both"},text:"+ Add Existing"}))},onAddNewBeforeCreate:function(component){this.destroyError()},onAddNewBeforeEditorShow:function(){this.destroyError()},onAddNewCreate:function(component,record,operation){this.destroyError(),this.reloadGrid({callback:function(){this.grid.highlightRowForRecord(record),this.fireEvent("datachanged",this)},scope:this})},onAddNewError:function(component,eventArgs){this.showError(eventArgs.message)},onAddNewExpand:function(component){this.destroyError()},onAddNewCollapse:function(component){this.destroyError()},getErrorMessage:function(message){return Rally.data.util.Record.removeValidationCruft(message)},showError:function(message){this.destroyError();var msg=this.getErrorMessage(message),t=Ext.create("Ext.Template",'<div class="error">',"{message}","</div>",{compiled:!0});this.error=t.insertFirst(this.getEl().dom,{message:msg},!0),this.addNew&&this.addNew.addCls("add-new-error")},destroyError:function(){this.error&&(this.error.destroy(),delete this.error,this.addNew&&this.addNew.removeCls("add-new-error"))},onModelLoad:function(model){this.fireEvent("modelload",this,model),this.autoAddGrid===!0&&this.addGridAndAddNew(model)},addGridAndAddNew:function(model){var deferred=Ext.create("Deft.Deferred"),grid=this.grid=Ext.create("Rally.ui.grid.Grid",Ext.applyIf({model:model,itemId:"grid"},this.gridConfig));return grid.on("deleteRequestCompleted",this._onGridDeleteRequestCompleted,this),grid.on("dataLoadException",this._onGridDataLoadException,this),grid.store.on("update",this.destroyError,this),grid.on("viewready",this._onReady,this,{single:!0}),Ext.suspendLayouts(),this.add(grid),null!==this.addNewConfig&&this._addAddNew(),this._addAddExisting(),Ext.resumeLayouts(!0),deferred.resolve(grid),deferred.promise},getGrid:function(){return this.down("#grid")},reloadGrid:function(options){this.grid.refresh(options)},realignGridEditor:function(){this.grid&&this.grid.realignEditor()},onDestroy:function(){window.detail&&(window.detail.refreshContent=!0),this.callParent(arguments)},_onReady:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.mon(this.grid,"write",function(){this.fireEvent("datachanged",this)},this)},_onGridDeleteRequestCompleted:function(grid,records,operation){this._handleOperation(operation)},_onGridDataLoadException:function(grid,operation){this._handleOperation(operation)},_handleOperation:function(operation){operation.error&&"update"!==operation.action?this.showError(operation.error.errors[0]):this.destroyError()},_loadModel:function(){Rally.data.ModelFactory.getModel({type:this.model,success:this.onModelLoad,scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.RestoreMenuItem",{alias:"widget.rallyrecordmenuitemrestore",extend:Rally.ui.menu.item.RecordMenuItem,mixins:[Rally.Messageable,Rally.clientmetrics.ClientMetricsRecordable],config:{handler:function(){this._onRestoreClicked()},predicate:function(record){return record.get("updatable")},text:"Restore"},_onRestoreClicked:function(){this.recordLoadBegin({description:"Restoring record",miscData:{id:this.record.get("ObjectID")}}),Ext.Ajax.request({url:Rally.environment.getServer().getContextUrl()+"/recyclebin/restore.sp",params:{oid:this.record.get("ObjectID")},success:function(result){var restoredItem=this.buildRestoredItemRecord(result,this.record);Rally.ui.notify.Notifier.showRestore({uri:!0,artifact:restoredItem}),this.publish(Rally.Message.objectDestroy,this.record,this),this.recordLoadEnd()},failure:function(){Rally.ui.notify.Notifier.showError({message:"There was an issue restoring your item."})},scope:this})},buildRestoredItemRecord:function(result,record){var type=Rally.util.TypeInfo.getTypeInfoByName(this.record.get("Type").Name).schemaType,restoredItem=Ext.decode(result.responseText)[type]||Ext.decode(result.responseText)[this.record.get("Type").Name]||{};return restoredItem.hasField=function(fieldName){return void 0!==this[fieldName]},restoredItem.get=function(fieldName){return this[fieldName]},restoredItem}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.RecycleBinEntryRecordMenu",{extend:Rally.ui.menu.RecordMenu,alias:"widget.rallyrecyclebinentryrecordmenu",mixins:{messageagble:Rally.Messageable},config:{record:null},initComponent:function(args){this.items=this._getMenuItems(),this.callParent(arguments)},_getMenuItems:function(){var items=[{xtype:"rallyrecordmenuitemdelete",text:"Permanently Delete",margin:0,padding:0,record:this.record},{xtype:"rallyrecordmenuitemrestore",record:this.record,actionScope:this}];return items}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.AddTestCaseResultMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemaddtestcaseresult",config:{text:"Add Result..."},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,Rally.predicate.RecordPredicates.canHaveTestCaseResults]),config.handler=config.handler||this._onAddTestCaseResultClicked,this.initConfig(config),this.callParent(arguments)},_onAddTestCaseResultClicked:function(){var record=this.record,params={testCaseOid:record.getId(),cpoid:this._getCpoid(record)},testSet=this._getTestSet(record);testSet&&(params.testSetOid=testSet.getId()),Rally.nav.Manager.create(this._getResultsType(),params)},_getResultsType:function(){var field=this.record.getField("Results");return field.attributeDefinition.AllowedValueType._refObjectName},_getCpoid:function(record){var project=record.get("Project")||{_ref:record.self.context.project};return Rally.util.Ref.getOidFromRef(project._ref)},_getTestSet:function(record){var testSet;return record.parentNode?"testset"===record.parentNode.self.typePath&&(testSet=record.parentNode):record.store.record&&"testset"===record.store.record.self.typePath&&(testSet=record.store.record),testSet}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.EditLastTestCaseResultMenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallyrecordmenuitemeditlasttestcaseresult",config:{text:"Edit Last Result..."},constructor:function(config){config=config||{},config.predicate=config.predicate||Rally.predicate.RecordPredicates.mustPassAllPredicates([Rally.predicate.RecordPredicates.isUpdatable,function(record){return record.get("LastResult")},Rally.predicate.RecordPredicates.canHaveTestCaseResults]),config.handler=config.handler||this._onEditLastTestCaseResultClicked,this.initConfig(config),this.callParent(arguments)},_onEditLastTestCaseResultClicked:function(){Rally.nav.Manager.edit(this.record.get("LastResult"),{})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.TestCaseRecordMenu",{extend:Rally.ui.menu.RecordMenu,alias:"widget.rallytestcaserecordmenu",mixins:{messageagble:Rally.Messageable},config:{record:null,associatedRecord:null,testCasesStore:null,onBeforeRecordMenuCopy:Ext.emptyFn,onRecordMenuCopy:Ext.emptyFn,onBeforeRecordMenuDelete:Ext.emptyFn,onRecordMenuDelete:Ext.emptyFn,onBeforeRecordMenuRankHighest:Ext.emptyFn,onBeforeRecordMenuRankLowest:Ext.emptyFn,rankRecordHelper:{findRecordToRankAgainst:Ext.emptyFn,getMoveToPositionStore:Ext.emptyFn},showAddTestCaseResult:!0},initComponent:function(){this.items=this._getMenuItems(),this.callParent(arguments)},_getMenuItems:function(){var record=this.getRecord(),items=[];return this.showInlineAdd&&items.push({xtype:"rallyrecordmenuiteminlineaddchild",view:this.view,record:record},{xtype:"rallyrecordmenuiteminlineaddpeer",view:this.view,record:record},{xtype:"menuseparator"}),this.showAddTestCaseResult&&items.push({xtype:"rallyrecordmenuitemaddtestcaseresult",record:record},{xtype:"rallyrecordmenuitemeditlasttestcaseresult",record:record},{xtype:"menuseparator"}),items.push({xtype:"rallyrecordmenuitemedit",record:record}),Ext.isFunction(record.getDepth)&&1===record.getDepth()||items.push({xtype:"rallyrecordmenuitemcopy",record:record,beforeAction:this.getOnBeforeRecordMenuCopy(),afterAction:function(copiedRecord,originalRecord,operation){var deferred=Ext.create("Deft.Deferred");return this.testCasesStore.add(copiedRecord),this.testCasesStore.sync({success:function(){deferred.resolve(copiedRecord),Rally.environment.getMessageBus().publish(Rally.Message.objectUpdate,record,["TestCases"],this),Ext.callback(this.getOnRecordMenuCopy(),this)},scope:this}),deferred.promise},actionScope:this}),this.showRankMenuItems===!1||_.isFunction(this.shouldRecordBeExtremeRankable)&&!this.shouldRecordBeExtremeRankable(record)||(items.push({xtype:"menuseparator"},{xtype:"rallyrecordmenuitemrankextreme",rankRecordHelper:this.getRankRecordHelper(),rankPosition:"highest",record:record,beforeAction:this.getOnBeforeRecordMenuRankHighest(),actionScope:this},{xtype:"rallyrecordmenuitemrankextreme",rankRecordHelper:this.getRankRecordHelper(),rankPosition:"lowest",record:record,beforeAction:this.getOnBeforeRecordMenuRankLowest(),actionScope:this}),_.isFunction(this.shouldRecordBeRankable)&&!this.shouldRecordBeRankable(record)||items.push({xtype:"rallyrecordmenuitemmovetoposition",record:record,rankRecordHelper:this.getRankRecordHelper()})),items.push({xtype:"menuseparator"},{xtype:"rallyrecordmenuitemremove",record:record,collectionStore:this.testCasesStore}),record.parentNode&&record.parentNode.getId()||this.testCasesStore||items.push({xtype:"rallyrecordmenuitemdelete",record:record,actionScope:this}),items}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.MenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,config:{onBeforeAction:Ext.emptyFn,onActionComplete:Ext.emptyFn,prepareRecords:Ext.emptyFn,records:null,context:null,store:null},saveRecords:function(records,args){var me=this,successfulRecords=this.prepareRecords(records,args);successfulRecords.length===records.length?me.onSuccess(successfulRecords,[],args):Ext.create("Rally.data.wsapi.batch.Store",{requester:this,data:_.difference(records,successfulRecords)}).sync({callback:function(batchOptions){var resultSet=batchOptions.operations[0].resultSet;successfulRecords=successfulRecords.concat(_.filter(records,function(record){return _.any(resultSet.records,function(r){return r.get("_ref")===record.get("_ref")})}));var unsuccessfulRecords=_.difference(records,successfulRecords);successfulRecords.length?me.onSuccess(successfulRecords,unsuccessfulRecords,args,resultSet.message):(Rally.ui.notify.Notifier.showError({message:resultSet.message}),Ext.callback(me.onActionComplete,null,[successfulRecords,unsuccessfulRecords]))}})},onSuccess:Ext.emptyFn})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Download",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenuitembulkdownload",config:{text:"Download",handler:function(){this._onDownloadClicked()}},_getWindow:function(){return window},_onDownloadClicked:function(){var window=this._getWindow(),records=this.getRecords();_.each(records,function(record){var oid=record.get("ObjectID"),filename=record.get("Name");window.open("/slm/attachment/"+oid+"/"+filename)})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Edit",{alias:"widget.rallyrecordmenuitembulkedit",extend:Rally.ui.menu.bulk.MenuItem,statics:{bulkierEditEnabled:function(){return!1}},config:{text:"Edit...",handler:function(){this._onBulkEditClicked()},predicate:function(records){return _.every(records,function(record){return record.self.isArtifact()||record.self.isTimebox()})},prepareRecords:function(records,args){var successfulRecords=[];return _.each(records,function(record){record.beginEdit(),this.self.bulkierEditEnabled()&&_.isArray(args)?_.each(args,function(arg){this._setValue(record,arg.field.name,arg.value)},this):this._setValue(record,args.field.name,args.value),0===Ext.Object.getSize(record.getChanges())&&(successfulRecords.push(record),record.cancelEdit())},this),successfulRecords}},_setValue:function(record,field,value){record.set(field,value),record.getChanges().hasOwnProperty(field)||(record.modified[field]=value,record.dirty=!0)},clientMetrics:[{method:"_onBulkEditClicked",description:"bulk edit menu item clicked"}],_onBulkEditClicked:function(){Ext.create(this.self.bulkierEditEnabled()?"Rally.ui.dialog.BulkierEditDialog":"Rally.ui.dialog.BulkEditDialog",{records:this.records,listeners:{edit:this._onEdit,scope:this}})},_onEdit:function(dialog,args){this.onBeforeAction(this.records)!==!1&&this.saveRecords(this.records,args)},onSuccess:function(successfulRecords,unsuccessfulRecords,args,errorMessage){var message=successfulRecords.length+(1===successfulRecords.length?" item has":" items have");this.self.bulkierEditEnabled()&&_.isArray(args)?message+=" been updated":(message+=" had "+args.field.displayName,message+=null===args.value||""===args.value?" removed":' changed to "'+(args.displayValue||args.value)+'"'),successfulRecords.length===this.records.length?Rally.ui.notify.Notifier.show({message:message+"."}):Rally.ui.notify.Notifier.showWarning({message:message+", but "+unsuccessfulRecords.length+" failed: "+errorMessage});var changes={};this.self.bulkierEditEnabled()&&_.isArray(args)?_.each(args,function(arg){changes[arg.field.name]=arg.value}):changes[args.field.name]=args.value,Ext.callback(this.onActionComplete,null,[successfulRecords,unsuccessfulRecords,changes])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Milestone",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenuitembulkmilestone",require:["Rally.ui.dialog.MilestoneChooserDialog","Rally.ui.notify.Notifier","Rally.util.Ref"],clientMetrics:[{beginMethod:"_onMilestoneSelect",endMethod:"onSuccess",description:"bulk action complete"
}],config:{text:"Milestone...",handler:function(){this._onBulkMilestoneClicked()},predicate:function(records){return _.every(records,function(record){return record.self.isArtifact()})},prepareRecords:function(records,selectedTags){var successfulRecords=[];return _.each(records,function(record){record.beginEdit();var partialTagRefs=_.invoke(selectedTags.partial,"get","_ref"),fullTagRefs=_.invoke(selectedTags.full,"get","_ref"),existingTagRefs=_.pluck(record.get("Milestones")._tagsNameArray,"_ref"),newTagRefs=_(existingTagRefs).intersection(partialTagRefs).union(fullTagRefs).value(),newTagArray=_.map(newTagRefs,function(ref){return{_ref:ref}});_.isEqual(existingTagRefs,newTagRefs)?(successfulRecords.push(record),record.cancelEdit()):record.set("Milestones",newTagArray)}),successfulRecords}},constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},_onBulkMilestoneClicked:function(){Ext.create("Rally.ui.dialog.MilestoneChooserDialog",{autoShow:!0,records:this.records,title:"BULK MILESTONE EDIT",listeners:{tagselect:this._onTagSelect,scope:this}})},_onTagSelect:function(dialog,selectedTags){this.onBeforeAction(this.records)!==!1&&this.saveRecords(this.records,selectedTags)},onSuccess:function(successfulRecords,unsuccessfulRecords,selectedTags,errorMessage){var message=["Milestones updated for",successfulRecords.length,1===successfulRecords.length?"item":"items"].join(" ");successfulRecords.length===this.records.length?Rally.ui.notify.Notifier.show({message:message+"."}):Rally.ui.notify.Notifier.showWarning({message:[message,", but ",unsuccessfulRecords.length," failed: ",errorMessage].join(" ")});var allTags=_.compact([].concat(selectedTags.partial,selectedTags.full)),changes=_.map(allTags,function(tag){return Rally.util.Ref.getRelativeUri(tag)});Ext.callback(this.onActionComplete,null,[successfulRecords,unsuccessfulRecords,{Milestones:changes}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Tag",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenuitembulktag",clientMetrics:[{beginMethod:"_onTagSelect",endMethod:"onSuccess",description:"bulk action complete"}],config:{text:"Tag...",handler:function(){this._onBulkTagClicked()},predicate:function(records){return _.every(records,function(record){return record.self.isArtifact()})},prepareRecords:function(records,selectedTags){var successfulRecords=[];return _.each(records,function(record){record.beginEdit();var partialTagRefs=_.invoke(selectedTags.partial,"get","_ref"),fullTagRefs=_.invoke(selectedTags.full,"get","_ref"),existingTagRefs=_.pluck(record.get("Tags")._tagsNameArray,"_ref"),newTagRefs=_(existingTagRefs).intersection(partialTagRefs).union(fullTagRefs).value();newTagArray=_.map(newTagRefs,function(ref){return{_ref:ref}}),_.isEqual(existingTagRefs,newTagRefs)?(successfulRecords.push(record),record.cancelEdit()):record.set("Tags",newTagArray)}),successfulRecords}},constructor:function(config){this.mergeConfig(config),this.callParent(arguments)},_onBulkTagClicked:function(){Ext.create("Rally.ui.dialog.TagChooserDialog",{autoShow:!0,records:this.records,title:"BULK TAG EDIT",listeners:{tagselect:this._onTagSelect,scope:this}})},_onTagSelect:function(dialog,selectedTags){this.onBeforeAction(this.records)!==!1&&this.saveRecords(this.records,selectedTags)},onSuccess:function(successfulRecords,unsuccessfulRecords,selectedTags,errorMessage){var message=["Tags updated for",successfulRecords.length,1===successfulRecords.length?"item":"items"].join(" ");successfulRecords.length===this.records.length?Rally.ui.notify.Notifier.show({message:message+"."}):Rally.ui.notify.Notifier.showWarning({message:[message,", but ",unsuccessfulRecords.length," failed: ",errorMessage].join(" ")});var allTags=_.compact([].concat(selectedTags.partial,selectedTags.full)),changes=_.map(allTags,function(tag){return Rally.util.Ref.getRelativeUri(tag)});Ext.callback(this.onActionComplete,null,[successfulRecords,unsuccessfulRecords,{Tags:changes}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Remove",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenubulkremove",mixins:{messageable:Rally.Messageable},config:{text:"Remove",handler:function(){this._onRemoveClicked()},predicate:function(){return this.store.isCollectionStore}},_onRemoveClicked:function(){this.onBeforeAction(this.records)!==!1&&this._removeRecords()},_removeRecords:function(){this.store.remove(this.getRecords()),this.store.sync().then({success:function(){Ext.callback(this.onActionComplete,null,[this.getRecords(),[],{}]),this.publish(Rally.Message.objectUpdate,this.store.record,[this.store.fieldName])},failure:function(){Ext.callback(this.onActionComplete,null,[[],this.getRecords()])},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.RemoveTestCase",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenubulkremovetestcase",mixins:{messageable:Rally.Messageable},config:{text:"Remove",handler:function(){this._onRemoveClicked()},predicate:function(records){return!!(records[0].parentNode&&records[0].parentNode.isTestSet()&&_.every(records,function(record){return record.parentNode===records[0].parentNode&&record.isTestCase()}))}},_onRemoveClicked:function(){this.onBeforeAction(this.records)!==!1&&this._removeRecords()},_removeRecords:function(){var testSet=this.getRecords()[0].parentNode,store=testSet.getCollection("TestCases",{limit:testSet.childNodes.length});store.load().then({success:function(){store.remove(this.getRecords()),store.sync().then({success:function(){Ext.callback(this.onActionComplete,null,[this.getRecords(),[],{}]),this.publish(Rally.Message.objectUpdate,testSet,["TestCases"])},failure:function(){Ext.callback(this.onActionComplete,null,[[],this.getRecords()])},scope:this})},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Watch",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenuitembulkwatch",cls:"watches-menu-item",config:{text:"Watch",handler:function(){this._onClick()},predicate:function(records){return _.every(records,Rally.predicate.RecordPredicates.isArtifact)}},clientMetrics:[{method:"_onClick",description:"bulk watch menu item clicked"}],constructor:function(config){this.api=config&&config.api||new Rally.data.notifications.Api;var tpl=_.isArray(this.renderTpl)?this.renderTpl.join(""):this.renderTpl.html;this.renderTpl=Ext.create("Ext.XTemplate",tpl+'<span class="rly-badge beta"><span class="badge-m">Beta</span></span>'),this.callParent(arguments)},_onClick:function(){this.api.watch(this.getRecords()).then({success:function(results){Ext.callback(this.afterAction,this.actionScope,[results.successfulRecords,results.unsuccessfulRecords])},failure:function(response){Ext.callback(this.afterAction,this.actionScope,[this.getRecords(),response])},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.Unwatch",{extend:Rally.ui.menu.bulk.MenuItem,alias:"widget.rallyrecordmenuitembulkunwatch",cls:"watches-menu-item",config:{text:"Unwatch",handler:function(){this._onClick()},predicate:function(records){return _.every(records,Rally.predicate.RecordPredicates.isArtifact)}},clientMetrics:[{method:"_onClick",description:"bulk unwatch menu item clicked"}],constructor:function(config){this.api=config&&config.api||new Rally.data.notifications.Api;var tpl=_.isArray(this.renderTpl)?this.renderTpl.join(""):this.renderTpl.html;this.renderTpl=Ext.create("Ext.XTemplate",tpl+'<span class="rly-badge beta"><span class="badge-m">Beta</span></span>'),this.callParent(arguments)},_onClick:function(){this.api.unwatch(this.getRecords()).then({success:function(results){Ext.callback(this.afterAction,this.actionScope,[results.successfulRecords,results.unsuccessfulRecords])},failure:function(record,operation){Rally.data.util.Record.showWsapiErrorNotification(record,operation),Ext.callback(this.afterAction,this.actionScope,[record,operation])},scope:this})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.Abstract",{extend:Rally.ui.menu.bulk.MenuItem,config:{handler:function(){this._showChooser()}},constructor:function(config){this.callParent(arguments),this.text="Choose "+this.parentField+"..."},getChooserConfig:function(){return{autoShow:!0,columns:[{text:"ID",dataIndex:"FormattedID",renderer:_.identity},"Name","Project"],storeConfig:{sorters:[{property:"FormattedID",direction:"DESC"}],context:{workspace:Rally.util.Ref.getRelativeUri(this.getContext().getWorkspace()),project:null}},title:"Choose "+this.parentField,listeners:{artifactchosen:this._onArtifactChosen,scope:this}}},getCollectionStore:Ext.emptyFn,getChanges:Ext.emptyFn,_showChooser:function(){Ext.create("Rally.ui.dialog.ArtifactChooserDialog",this.getChooserConfig())},_onArtifactChosen:function(dialog,selectedRecord){if(this.onBeforeAction(this.records)!==!1){var me=this,collectionStore=this.getCollectionStore(selectedRecord);collectionStore.load().then({success:function(){Ext.apply(collectionStore.proxy.extraParams,{fetch:collectionStore.fetch}),collectionStore.add(me.records),collectionStore.sync({success:function(){Rally.ui.notify.Notifier.show({message:me.records.length+(1===me.records.length?" item has":" items have")+" had "+me.parentField+' changed to "'+selectedRecord.get("FormattedID")+'".'}),Ext.callback(me.onActionComplete,null,[me.records,[],me.getChanges(selectedRecord)])},failure:function(batch){var errors=batch.exceptions[0].getError().errors;Rally.ui.notify.Notifier.showError({message:errors.join(". ")}),Ext.callback(me.onActionComplete,null,[[],me.records,me.getChanges(selectedRecord)])}})}})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.Parent",{extend:Rally.ui.menu.bulk.parent.Abstract,alias:"widget.rallyrecordmenuitembulkparent",parentField:"Parent",config:{predicate:function(records){var typeName=records[0].self.typeName;return _.every(records,function(record){return record.self.typeName===typeName&&record.self.hasField("Parent")})}},getChooserConfig:function(){var record=this.records[0],artifactTypes=[record.getField("Parent").attributeDefinition.AllowedValueType._refObjectName];return record.getField("PortfolioItem")&&artifactTypes.push(record.getField("PortfolioItem").attributeDefinition.AllowedValueType._refObjectName),Ext.merge(this.callParent(arguments),{artifactTypes:artifactTypes,storeConfig:{filters:_.map(this.records,function(record){return{property:record.self.prototype.idProperty,operator:"!=",value:record.getId()}})}})},getCollectionStore:function(selectedRecord){var childrenField=selectedRecord.getField("Children")||selectedRecord.getField("UserStories");return selectedRecord.getCollection(childrenField.name,{fetch:_.keys(selectedRecord.data).filter(function(key){return!key.match(/^_/)}),requester:this})},getChanges:function(selectedRecord){return{PortfolioItem:selectedRecord.self.isPortfolioItem()?Rally.util.Ref.getRelativeUri(selectedRecord):null,Parent:selectedRecord.self.isPortfolioItem()?null:Rally.util.Ref.getRelativeUri(selectedRecord)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.DefectToUserStory",{extend:Rally.ui.menu.bulk.parent.Abstract,alias:"widget.rallyrecordmenuitembulkdefecttouserstory",parentField:"User Story",config:{predicate:function(records){return _.every(records,function(record){return"defect"===record.self.typePath})}},getChooserConfig:function(){return Ext.apply(this.callParent(arguments),{artifactTypes:["userstory"]})},getCollectionStore:function(selectedRecord){var childrenField=selectedRecord.getField("Defects");return selectedRecord.getCollection(childrenField.name,{fetch:["FormattedID","Requirement"],requester:this})},getChanges:function(selectedRecord){return{Requirement:Rally.util.Ref.getRelativeUri(selectedRecord),TestCase:null}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.TaskToWorkProduct",{extend:Rally.ui.menu.bulk.parent.Abstract,alias:"widget.rallyrecordmenuitembulktasktoworkproduct",parentField:"Work Product",config:{predicate:function(records){return _.every(records,function(record){return"task"===record.self.typePath})}},getChooserConfig:function(){return Ext.merge(this.callParent(arguments),{artifactTypes:["defect","defectsuite","testset","userstory"],columns:[{text:"ID",dataIndex:"FormattedID",renderer:_.identity},"Name","Release","Iteration"],storeConfig:{filters:[{property:"Children.ObjectID",operator:"=",value:"null"}]}})},getCollectionStore:function(selectedRecord){var childrenField=selectedRecord.getField("Tasks");return selectedRecord.getCollection(childrenField.name,{fetch:["FormattedID","WorkProduct"],requester:this})},getChanges:function(selectedRecord){return{WorkProduct:Rally.util.Ref.getRelativeUri(selectedRecord)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.TestCaseToWorkProduct",{extend:Rally.ui.menu.bulk.parent.Abstract,alias:"widget.rallyrecordmenuitembulktestcasetoworkproduct",parentField:"Work Product",config:{predicate:function(records){return _.every(records,function(record){return"testcase"===record.self.typePath})}},getChooserConfig:function(){return Ext.apply(this.callParent(arguments),{artifactTypes:["defect","userstory"]})},getCollectionStore:function(selectedRecord){var childrenField=selectedRecord.getField("TestCases");return selectedRecord.getCollection(childrenField.name,{fetch:["FormattedID","WorkProduct"],requester:this})},getChanges:function(selectedRecord){return{WorkProduct:Rally.util.Ref.getRelativeUri(selectedRecord)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.parent.TestCaseToTestFolder",{extend:Rally.ui.menu.bulk.parent.Abstract,alias:"widget.rallyrecordmenuitembulktestcasetotestfolder",parentField:"Test Folder",config:{predicate:function(records){return _.every(records,function(record){return"testcase"===record.self.typePath&&record.get("Project")&&Rally.util.Ref.getRelativeUri(record.get("Project"))===Rally.util.Ref.getRelativeUri(records[0].get("Project"))})}},getChooserConfig:function(){return Ext.merge(this.callParent(arguments),{artifactTypes:["testfolder"],columns:[{text:"ID",dataIndex:"FormattedID",renderer:_.identity},"Name"],storeConfig:{context:{project:Rally.util.Ref.getRelativeUri(this.records[0].get("Project")),projectScopeUp:!1,projectScopeDown:!1}}})},getCollectionStore:function(selectedRecord){var childrenField=selectedRecord.getField("TestCases");return selectedRecord.getCollection(childrenField.name,{fetch:["FormattedID","TestFolder"],requester:this})},getChanges:function(selectedRecord){return{TestFolder:Rally.util.Ref.getRelativeUri(selectedRecord)}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.bulk.RecordMenu",{extend:Rally.ui.menu.RecordMenu,alias:"widget.rallybulkrecordmenu",inheritableStatics:{filterPredicate:function(items){return _.filter(items,function(item){return!item.predicate||item.predicate.call(item,item.records)})}},config:{records:null,store:null,onBeforeAction:Ext.emptyFn,onActionComplete:Ext.emptyFn,context:void 0,showTag:!0,showEdit:!0,showRemove:!0,showParent:!0,showMilestones:!0,showDownload:!1,showWatch:!0},initComponent:function(){this.items=this._getMenuItems(),this.callParent(arguments)},_getMenuItems:function(){var records=this.getRecords(),items=[{text:"Bulk Actions ("+records.length+" items)",canActivate:!1,cls:"menu-item-read-only"}].concat(this.items);return this.showEdit&&items.push({xtype:"rallyrecordmenuitembulkedit"}),this.showRemove&&(items.push({xtype:"rallyrecordmenubulkremove"}),items.push({xtype:"rallyrecordmenubulkremovetestcase"})),this.showMilestones&&items.push({xtype:"rallyrecordmenuitembulkmilestone"}),this.showDownload&&items.push({xtype:"rallyrecordmenuitembulkdownload"}),this.showTag&&items.push({xtype:"rallyrecordmenuitembulktag"}),this.showParent&&Ext.Array.push(items,[{xtype:"rallyrecordmenuitembulkparent"},{xtype:"rallyrecordmenuitembulkdefecttouserstory"},{xtype:"rallyrecordmenuitembulktasktoworkproduct"},{xtype:"rallyrecordmenuitembulktestcasetoworkproduct"},{xtype:"rallyrecordmenuitembulktestcasetotestfolder"}]),this.showWatch&&Rally.data.notifications.Api.enabled&&(items.push({xtype:"menuseparator",margin:"0 0 0 0",padding:"0 0 0 0"}),items.push({xtype:"rallyrecordmenuitembulkwatch"}),items.push({xtype:"rallyrecordmenuitembulkunwatch"})),_.each(items,function(item){Ext.apply(item,{records:records,store:this.store,onBeforeAction:this.onBeforeAction,onActionComplete:this.onActionComplete,context:this.getContext()})},this),items}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.menu.item.detail.MenuItem",{extend:Rally.ui.menu.item.RecordMenuItem,alias:"widget.rallydetailmenuitem",bubbleEvents:["doaction"],config:{text:"",action:"",handler:function(){this._onClick()}},_onClick:function(){this.fireEvent("doaction",this.getAction())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.AbstractMvcfListController",{extend:Rally.ui.ViewController,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},control:{view:{refresh:"onViewRefresh"}},storeType:"Rally.data.wsapi.Store",storeConfig:{},constructor:function(config){this.mergeConfig(config),this.mergeControl(),this.callParent(arguments)},init:function(){this.callParent(arguments),this.buildStore(),this.getView().getSelectionModel().setSelectionMode("SIMPLE")},buildStore:function(){this.getView().fireEvent("beforestoreload",this.getView()),this.recordLoadBegin({description:"list loading store"});var store=null;return this.config.store?(store=this.config.store,store.events.load.clearListeners(),store.addListener("load",this.onStoreLoad,this),store.sort([{property:"StringValue",direction:"Asc"}])):store=Ext.create(this.storeType,Ext.merge({},this._getDefaultStoreConfig(),this.storeConfig)),this.getView().bindStore(store),store},onStoreLoad:function(store){store.remove("null"),store.removed&&1===store.removed.length&&(store.totalCount-=store.removed.length),this.getView().refresh(),this.recordLoadEnd(),this.getView().fireEvent("storeload",this.getView(),store),this._ready||(this.getView().fireEvent("ready",this.getView()),this._ready=!0)},_getDefaultStoreConfig:function(){return{requester:this,model:this.type,remoteFilter:!1,autoLoad:!0,pageSize:50,listeners:{load:this.onStoreLoad,scope:this},sorters:{property:"StringValue",direction:"Asc"}}},addListItem:function(records){var store=this.getView().getStore();store.insert(0,records),store.sort()},removeListItem:function(records){var store=this.getView().getStore(),mvcfRecords=_.compact(_.map(Ext.Array.from(records),function(mvcf){return store.findRecord("_ref",mvcf.get("_ref"))},this));store.remove(mvcfRecords)},updateListVisibility:function(list){return 0===list.getStore().getCount()?list.hide():list.show()},filter:function(term){var deferred=Ext.create("Deft.promise.Deferred"),view=this.getView(),store=view.getStore(),regex=new RegExp(term.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i"),isRemoteFiltered=store.config.remoteFilter===!0;return isRemoteFiltered&&store.on("load",function(){deferred.resolve(arguments)},this,{single:!0}),view.suspendEvents(),store.clearFilter(!0),view.getStore().filter("StringValue",regex),view.resumeEvents(),view.refresh(),isRemoteFiltered||deferred.resolve([store.getRange()]),deferred.promise},onViewRefresh:function(list,opts){this.updateListVisibility(list)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.AbstractMvcfList",{extend:Ext.view.BoundList,controller:"Rally.ui.mvcfchooser.AbstractMvcfListController",clientMetrics:[{endEvent:"ready",description:"mvcf chooser list ready"}],config:{mvcfTextTpl:[]},listTitle:null,constructor:function(config){this.mergeConfig(config);var tpl=['<div class="rui-list-header">'+this.listTitle+"</div>",'<tpl for=".">','<div class="'+Ext.baseCSSPrefix+'boundlist-item">','<div id="checkbox-{ObjectID}" class="rui-checkbox" tabindex="-1"></div>','<label for="checkbox-{ObjectID}" class="rui-checkbox-label">{StringValue}','<tpl if="_count"> ({_count})</tpl>',"</label>"];tpl=tpl.concat(this.mvcfTextTpl),tpl=tpl.concat(["</div>","</tpl>"]),this.tpl=tpl,this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.addCls("rui-mvcf-bound-list"),this.on({beforecontainerclick:function(){return!1},beforeitemmouseleave:function(){return!1},scope:this})},highlightItemByRecord:function(record){this.highlightItem(this.getNode(record))},filter:function(term){return this.getController().filter(term)},addListItem:function(record){return this.getController().addListItem(record)},removeListItem:function(record){return this.getController().removeListItem(record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.AvailableMvcfListController",{extend:Rally.ui.mvcfchooser.AbstractMvcfListController,storeType:"Rally.data.wsapi.Store",constructor:function(config){this.mergeConfig(config),this.mergeControl(),this.initialFilters=this.storeConfig.filters||[],this.initialFilters=_.isArray(this.initialFilters)?this.initialFilters:[this.initialFilters],this.storeConfig=_.merge({pageSize:10},this.storeConfig),this.callParent(arguments)},filter:function(term){var deferred=Ext.create("Deft.promise.Deferred"),view=this.getView(),store=view.getStore();return view.suspendEvents(),store.clearFilter(!0),store.on("load",function(){deferred.resolve(arguments)},this,{single:!0}),term?store.filter([{property:"StringValue",operator:"Contains",value:term}].concat(this.initialFilters)):store.load({filters:this.initialFilters}),view.resumeEvents(),view.refresh(),deferred.promise}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.AvailableMvcfList",{extend:Rally.ui.mvcfchooser.AbstractMvcfList,alias:"widget.rallyavailablemvcflist",controller:"Rally.ui.mvcfchooser.AvailableMvcfListController",cls:"rui-available-mvcf-bound-list",pageSize:10,createPagingToolbar:function(){return Ext.widget("rallylistpagingtoolbar",{pageSize:this.pageSize,store:this.dataSource,border:!1,ownerCt:this,ownerLayout:this.getComponentLayout(),width:276,layout:{align:"middle"}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.SelectedMvcfListController",{extend:Rally.ui.mvcfchooser.AbstractMvcfListController,storeType:"Ext.data.Store",constructor:function(config){config.storeConfig=config.storeConfig||{},_.merge(config.storeConfig,{proxy:{type:"memory",reader:{type:"json"}}}),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.SelectedMvcfList",{extend:Rally.ui.mvcfchooser.AbstractMvcfList,alias:"widget.rallyselectedmvcflist",controller:"Rally.ui.mvcfchooser.SelectedMvcfListController",cls:"rui-selected-mvcf-bound-list",constructor:function(config){this.selModel=Ext.create("Rally.ui.selection.TriStateModel"),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.mon(this.getSelectionModel(),"selectionchange",this._applySelection,this),this.on("ready",this._onReady,this)},getSelectedMvcf:function(){var store=this.getStore();return store.isFiltered()&&store.clearFilter(),this.getSelectionModel().getSelectionByState()},onBeforeItemClick:function(record){return this.callParent(arguments)!==!1&&!this._getCheckboxForRecord(record).hasCls("rly-disabled")},onItemClick:function(record){this.callParent(arguments),this.getSelectionModel().deselect(record)},setInitialPartialSelection:function(partialSelection){this.getSelectionModel().setInitialPartialSelection(partialSelection)},_onReady:function(){this.on("refresh",this._applySelection,this),this.mon(this.getStore(),"datachanged",this._onStoreDataChanged,this)},_onStoreDataChanged:function(store,opts){this.getSelectionModel().selectAll()},_getCheckboxForRecord:function(record){var itemNode=this.getNode(record);return itemNode&&Ext.get(itemNode.children[0])},_markPartiallySelected:function(record){var checkbox=this._getCheckboxForRecord(record);checkbox&&(checkbox.removeCls("icon-ok"),checkbox.addCls("icon-partial"))},_markFullySelected:function(record){var checkbox=this._getCheckboxForRecord(record);checkbox&&(checkbox.removeCls("icon-partial"),checkbox.addCls("icon-ok"))},_applySelection:function(){_.each(this.getStore().getRange(),function(record){this.getSelectionModel().isPartiallySelected(record)?this._markPartiallySelected(record):this.getSelectionModel().isFullySelected(record)&&this._markFullySelected(record);var checkbox=this._getCheckboxForRecord(record);checkbox&&Ext.isFunction(this.recordEnabled)&&!this.recordEnabled(record)&&checkbox.addCls("rly-disabled")},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.ListContainerController",{extend:Rally.ui.ViewController,mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},control:{availableMvcfList:{ready:"_onAvailableMvcfListReady",highlightitem:"_onListHighlightItem",select:"_onAvailableMvcfListSelect",storeload:"_onAvailableMvcfListStoreLoad"},selectedMvcfList:{highlightitem:"_onListHighlightItem",deselect:"_onSelectedMvcfListDeselect",ready:"_onSelectedMvcfListReady"},noItemsAvailableMessage:{}},init:function(){this.callParent(arguments),this.buildextendedCollectionDataStore(),this.getSelectedRecordsFn=this.config.getSelectedRecordsFn||this._getSelectedRecords},buildextendedCollectionDataStore:function(){var extendedCollectionDataStoreConfig=this.config.extendedCollectionDataStoreConfig;if(extendedCollectionDataStoreConfig){var originalLoad,scope;extendedCollectionDataStoreConfig.listeners&&extendedCollectionDataStoreConfig.listeners.load&&(scope=extendedCollectionDataStoreConfig.listeners.scope,originalLoad=extendedCollectionDataStoreConfig.listeners.load,scope&&(originalLoad=Ext.bind(extendedCollectionDataStoreConfig.listeners.load,scope))),extendedCollectionDataStoreConfig.listeners=_.merge(extendedCollectionDataStoreConfig.listeners||{},{load:Ext.bind(function(store,records,successful,eOpts){originalLoad&&originalLoad(store,records,successful,eOpts),this._onExtendedCollectionDataStoreLoaded()},this)}),this._extendedCollectionDataStoreLoaded=!1,this.extendedCollectionDataStore=Ext.create("Rally.data.wsapi.Store",extendedCollectionDataStoreConfig)}else this._extendedCollectionDataStoreLoaded=!0},getSelectedMvcf:function(){return this.getSelectedMvcfList().getSelectedMvcf()},isDirty:function(){return this._isDirty},filter:function(term){this.recordLoadBegin({description:"filtering list container"}),Deft.Promise.all([this.getAvailableMvcfList().filter(term),this.getSelectedMvcfList().filter(term)]).then({success:function(){this.clearHighlight(),this.moveHighlight("down"),this._onMvcfListRefresh(),this.recordLoadEnd()},scope:this})},moveHighlight:function(direction){var record=this.highlightedRecord?this._getNextRecord(direction):this._getFirstRecord(direction);record&&this.getView().highlightItem(this._getListContainingRecord(record),record)},_getFirstRecord:function(direction){var record;return record="up"===direction?this.getAvailableMvcfList().getStore().last()||this.getSelectedMvcfList().getStore().last():this.getSelectedMvcfList().getStore().first()||this.getAvailableMvcfList().getStore().first(),record||this.getView().fireEvent("beforewrap",this.getView()),record},_getNextRecord:function(direction){var fromList=this._getListContainingRecord(this.highlightedRecord),otherList=this._otherListFrom(fromList),currentIndex=fromList?fromList.indexOf(this.highlightedRecord):0,nextIndex="up"===direction?currentIndex-1:currentIndex+1,record=fromList?fromList.getStore().getAt(nextIndex):null;if(!record){var method="up"===direction?"last":"first";if(record=otherList.getStore()[method]()||fromList.getStore()[method](),toList=this._getListContainingRecord(record),this._isWrapping(direction,toList,fromList)&&!this.getView().fireEvent("beforewrap",this.getView()))return!1}return record},_isWrapping:function(direction,toList,fromList){var decisiveList="down"===direction?this.getSelectedMvcfList():this.getAvailableMvcfList();return toList===fromList||toList!==fromList&&toList===decisiveList},selectHighlightedRecord:function(){return!!this.highlightedRecord&&this.selectRecord(this.highlightedRecord)},selectRecord:function(record){return this.getSelectedMvcfList().getStore().indexOf(record)>-1?(this.getSelectedMvcfList().deselect(record),record):this.getAvailableMvcfList().getStore().indexOf(record)>-1&&(this.getAvailableMvcfList().select(record),record)},hasExactMatch:function(term){return!!term&&(this.getAvailableMvcfList().getStore().findExact("StringValue",term)!==-1||this.getSelectedMvcfList().getStore().findExact("StringValue",term)!==-1)},addRecord:function(record){this.getSelectedMvcfList().addListItem(record),this.getSelectedMvcfList().highlightItemByRecord(record)},clearHighlight:function(){this.getSelectedMvcfList().clearHighlight(),this.getAvailableMvcfList().clearHighlight(),delete this.highlightedRecord},hasHighlightedRecord:function(){return!!this.highlightedRecord},getHighlightedRecord:function(){return this.highlightedRecord},deselectMvcf:function(record){this.getSelectedMvcfList().removeListItem(record),this.getAvailableMvcfList().addListItem(record),this.getAvailableMvcfList().highlightItemByRecord(record),this._onMvcfListRefresh()},selectMvcf:function(record){this.getAvailableMvcfList().removeListItem(record),this.getSelectedMvcfList().addListItem(record),_.isArray(record)&&(record=record[0]),this.getSelectedMvcfList().highlightItemByRecord(record),this._onMvcfListRefresh()},highlightItem:function(list,record){this.highlightedRecord=record,this._otherListFrom(list).clearHighlight(),this.getView().fireEvent("highlightitem",this.getView(),record)},_getSelectedRecords:function(artifactRecords){var selectedRecords,partiallySelectedMvcfs=[],mvcfModel=this.getAvailableMvcfList().getStore().model,mvcfsByCount=_(artifactRecords).invoke("get",this.config.collectionProperty).pluck("_tagsNameArray").compact().flatten().reduce(this._countMvcfs,{});return selectedRecords=_.map(mvcfsByCount,function(mvcf){var record=new mvcfModel(mvcf);return mvcf._count<artifactRecords.length&&partiallySelectedMvcfs.push(record),record.set("_count",mvcf._count),record},this),this.getSelectedMvcfList().setInitialPartialSelection(partiallySelectedMvcfs),selectedRecords},setSelectionFromArtifactRecords:function(artifactRecords){this.recordLoadBegin({description:"selecting mvcfs from artifactRecords"});var selectedRecords=this.getSelectedRecordsFn(artifactRecords);this.selectMvcf(_.compact(selectedRecords)),this.getAvailableMvcfList().refresh(),this._onMvcfListRefresh(),this.recordLoadEnd()},_countMvcfs:function(accumulator,mvcf){return accumulator[mvcf._ref]?accumulator[mvcf._ref]._count+=1:accumulator[mvcf._ref]=_.merge(_.cloneDeep(mvcf),{_count:1}),accumulator},_onSelectedMvcfListDeselect:function(list,record){this.recordAction({description:"clicking item to deselect it from selected list",component:this.getView()}),this._isDirty=!0,this.deselectMvcf(record)},_onAvailableMvcfListSelect:function(selectionModel,record,opts){this.recordAction({description:"clicked item to select it from available list",component:this.getView()}),this._isDirty=!0,this.selectMvcf(record)},_onListHighlightItem:function(list,node,opts){this.highlightItem(list,list.getRecord(node))},_onExtendedCollectionDataStoreLoaded:function(){this._extendedCollectionDataStoreLoaded=!0,this._allStoresLoaded()},_onAvailableMvcfListReady:function(){this._availableListLoaded=!0,this._allStoresLoaded()},_onSelectedMvcfListReady:function(){this._selectedListLoaded=!0,this._allStoresLoaded()},_allStoresLoaded:function(){this._extendedCollectionDataStoreLoaded&&this._availableListLoaded&&this._selectedListLoaded&&(this.setSelectionFromArtifactRecords(this.getView().getArtifactRecords()),this.getView().fireEvent("ready",this.getView()));
},_onAvailableMvcfListStoreLoad:function(list,e){list.removeListItem(this.getSelectedMvcfList().getStore().getRange())},_getListContainingRecord:function(record){return this.getSelectedMvcfList().getStore().indexOf(record)>-1?this.getSelectedMvcfList():this.getAvailableMvcfList().getStore().indexOf(record)>-1?this.getAvailableMvcfList():null},_otherListFrom:function(list){return list===this.getSelectedMvcfList()?this.getAvailableMvcfList():this.getSelectedMvcfList()},_onMvcfListRefresh:function(){this.getView().toggleNoItemsAvailableMessage(0===this.getSelectedMvcfList().getStore().getCount()&&0===this.getAvailableMvcfList().getStore().getCount())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.ListContainer",{extend:Ext.container.Container,alias:"widget.rallymvcfchooserlistcontainer",controller:"Rally.ui.mvcfchooser.ListContainerController",cls:"rui-mvcf-chooser-list-ct",config:{artifactRecords:null},clientMetrics:[{endEvent:"ready",description:"list container ready"}],constructor:function(config){this.mergeConfig(config),this.items=[_.merge({xtype:"rallyselectedmvcflist",itemId:"selectedMvcfList",hidden:!0},this.selectedConfig),_.merge({xtype:"rallyavailablemvcflist",itemId:"availableMvcfList"},this.availableConfig),{xtype:"component",itemId:"noItemsAvailableMessage",html:this.noItemsAvailableText,hidden:!0,cls:"rui-mvcf-chooser-empty-list"}],this.callParent(arguments)},scrollIntoView:function(list,record){var node=list.getNodeByRecord(record);node&&Ext.fly(node).scrollIntoView(this.getEl())},highlightItem:function(list,record){record&&(this.scrollIntoView(list,record),list.highlightItemByRecord(record))},getSelectedMvcf:function(){return this.getController().getSelectedMvcf()},isDirty:function(){return this.getController().isDirty()},moveHighlight:function(direction){return this.getController().moveHighlight(direction)},selectRecord:function(record){return this.getController().selectRecord(record)},addRecord:function(record){return this.getController().addRecord(record)},selectHighlightedRecord:function(){return this.getController().selectHighlightedRecord()},clearHighlight:function(){return this.getController().clearHighlight()},hasHighlightedRecord:function(){return this.getController().hasHighlightedRecord()},getHighlightedRecord:function(){return this.getController().getHighlightedRecord()},filter:function(term){return this.getController().filter(term)},hasExactMatch:function(term){return this.getController().hasExactMatch(term)},toggleNoItemsAvailableMessage:function(show){var msg=this.down("#noItemsAvailableMessage");show?msg.show():msg.hide()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.MvcfChooserController",{extend:Rally.ui.ViewController,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},control:{mvcfFilter:{blur:"_onMvcfFilterBlur",change:"_onMvcfFilterChange",keyup:"_onMvcfFilterKeyUp",keydown:"_onMvcfFilterKeyDown"},mvcfListContainer:{beforewrap:"_onMvcfListContainerBeforeWrap",highlightitem:"_onMvcfListContainerHighlightItem",ready:"_onMvcfListContainerReady"}},constructor:function(){this.mergeControl(),this.callParent(arguments)},getSelectedMvcf:function(){return this.getMvcfListContainer().getSelectedMvcf()},isDirty:function(){return this.getMvcfListContainer().isDirty()},filter:function(term){term=Ext.String.htmlEncode(term.trim()),this.getMvcfListContainer().filter(term)},selectHighlightedRecord:function(){var record=this.getMvcfListContainer().getHighlightedRecord();record&&(this.getMvcfFilter().setValue(null),this.getMvcfListContainer().selectRecord(record))},_onMvcfListContainerHighlightItem:function(){this.getMvcfFilter().focus()},_onMvcfListContainerBeforeWrap:function(){return this.handleListContainerWrap()},handleListContainerWrap:function(){},_onMvcfListContainerReady:function(){this.getMvcfFilter().focus(!1,300),this._ready||(this.getView().fireEvent("ready",this.getView()),this._ready=!0)},_onMvcfFilterChange:function(textField,event,opts){this.recordAction({description:"filtering mvcfs",component:this.getView()}),this.filter(textField.getValue())},_onMvcfFilterBlur:function(){this.getMvcfListContainer().clearHighlight()},_onMvcfFilterKeyUp:function(textField,event,opts){event.getKey()===event.ENTER&&this.selectHighlightedRecord()},_onMvcfFilterKeyDown:function(textField,event,opts){switch(event.getKey()){case event.ENTER:event.stopEvent();break;case event.UP:this.getMvcfListContainer().moveHighlight("up");break;case event.DOWN:this.getMvcfListContainer().moveHighlight("down")}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.mvcfchooser.MvcfChooser",{extend:Ext.container.Container,alias:"widget.rallymvcfchooser",mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},controller:"Rally.ui.mvcfchooser.MvcfChooserController",cls:"rui-mvcf-chooser",config:{artifactRecords:null,width:300,showAdd:!1},layout:{type:"vbox",align:"stretch"},constructor:function(config){this.recordLoadBegin({description:"mvcf chooser shown"}),this.mergeConfig(config),this.items=[{xtype:"rallytextfield",itemId:"mvcfFilter",cls:"rui-mvcf-chooser-filter",shadow:!1,border:!1,emptyText:this.emptyText,enableKeyEvents:!0,checkChangeBuffer:250},{xtype:"rallymvcfchooserlistcontainer",itemId:"mvcfListContainer",maxHeight:this.listConfig.maxHeight||400,autoScroll:!0,noItemsAvailableText:this.listConfig.noItemsAvailableText,controllerConfig:this.listConfig.controllerConfig,selectedConfig:this.selectedConfig||{},availableConfig:this.availableConfig||{},listeners:this.listConfig.listeners}],this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.setArtifactRecords(this.getArtifactRecords()),this.on("afterlayout",this._afterLayout,this,{single:!0})},setArtifactRecords:function(artifactRecords){this.down("#mvcfListContainer").setArtifactRecords(artifactRecords)},_afterLayout:function(){this.setLoading(!0),this.on("ready",this._onReady,this)},afterRender:function(){this.setLoading(!0),this.on("ready",this._onReady,this),this.callParent(arguments)},getSelectedMvcf:function(){return this.getController().getSelectedMvcf()},isDirty:function(){return this.getController().isDirty()},_onReady:function(){this.recordLoadEnd(),this.setLoading(!1)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.DatePicker",{extend:Ext.picker.Date,alias:"widget.rallydatepicker",config:{rangeStart:null,rangeEnd:null,disabledDateRanges:null,inRangeCls:"rally-datepicker-in-range",selectedCls:"rally-datepicker-highlighted-value",currentValueCls:"rally-datepicker-current-value",enableMonthPicker:!0},constructor:function(config){this.callParent(arguments),this.selectedValue=this.getValue(),this.config.selectedCls&&(this.selectedCls=this.config.selectedCls)},update:function(date){this.callParent(arguments),this._updateDateClasses()},_updateDateClasses:function(){var selectedDate=Ext.Date.clearTime(this.selectedValue||this.getValue(),!0);_.each(this.cells.elements,function(cell){var date=new Date(cell.firstChild.dateValue),el=Ext.fly(cell);this.rangeStart&&this.rangeStart<=date&&this.rangeEnd&&date<=this.rangeEnd&&el.addCls(this.inRangeCls),this._isDateDisabled(date)&&(el.addCls(this.disabledCellCls),el.dom.title=this.disabledDatesText),Ext.Date.isEqual(date,selectedDate)?el.addCls(this.currentValueCls):el.removeCls(this.currentValueCls)},this)},_isDateDisabled:function(date){var disabledRanges=this.disabledDateRanges||[];return _.some(disabledRanges,function(dateRange){return date>=dateRange.startDate&&date<=dateRange.endDate})},onSelect:function(){this.callParent(arguments),this.selectedValue=this.getValue(),this._updateDateClasses()},showMonthPicker:function(){this.enableMonthPicker&&this.callParent(arguments)}})}.call(this),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.project.MultiProjectPicker",{extend:Rally.ui.picker.CollectionPicker,alias:"widget.rallymultiprojectpicker",requires:[],config:{currentProject:null,selectedTextLabel:"Selected Projects",emptyText:"Search Projects",notFoundText:'<div class="rui-multi-object-picker-empty-text">No matching Projects</div>',maxLength:100,modelType:"Project",storeConfig:{fetch:"Name"},pickerCfg:{minWidth:250}},initComponent:function(){this.callParent(arguments)},createPicker:function(){var picker=this.callParent(arguments);return picker},resetFilters:function(){this.store.setFilter(this.getBaseFilter())},getBaseFilter:function(){},getMatchedTextHtml:function(recordData){return'<div class="project-name">'+recordData[this.matchFieldName]+"</div>"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.picker.project.ProjectScopeUpDownField",{extend:Ext.Container,alias:"widget.rallyprojectscopeupdownfield",mixins:{field:Ext.form.field.Field},componentCls:"projectScopeUpDownField",items:{xtype:"component",autoEl:"label",html:"Also show items from:"},initComponent:function(){this.callParent(arguments),this.mixins.field.initField.call(this),this.addEvents("change"),this.add([{xtype:"checkbox",itemId:"scopeUp",cls:"projectScopingCheckbox scopeUp",checked:!!this.getValue()&&this.getValue().projectScopeUp,boxLabel:'<span class="project-scope-icon"></span> Parent Projects',submitValue:!1,listeners:{change:this._onChange,scope:this}},{xtype:"checkbox",itemId:"scopeDown",cls:"projectScopingCheckbox scopeDown",checked:!!this.getValue()&&this.getValue().projectScopeDown,boxLabel:'<span class="project-scope-icon"></span> Child Projects',submitValue:!1,listeners:{change:this._onChange,scope:this}}])},_onChange:function(){this.setValue({projectScopeUp:this.down("#scopeUp").getValue(),projectScopeDown:this.down("#scopeDown").getValue()})},isEqual:function(value1,value2){return value1===value2},setValue:function(value){if(value){"false"===value.projectScopeUp&&(value.projectScopeUp=!1),"false"===value.projectScopeDown&&(value.projectScopeDown=!1);var scopeUp=this.down("#scopeUp");scopeUp&&scopeUp.setValue(value.projectScopeUp);var scopeDown=this.down("#scopeDown");scopeDown&&scopeDown.setValue(value.projectScopeDown)}this.mixins.field.setValue.call(this,value)},getSubmitData:function(){return this.getValue()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.PrintRendererFactory",{singleton:!0,getPrintRenderTemplate:function(field){return this.fieldRenderers[field.name]?this.fieldRenderers[field.name](field):field.attributeDefinition&&this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()]?this.typeRenderers[field.attributeDefinition.AttributeType.toLowerCase()](field):Rally.ui.renderer.RendererFactory.getRenderTemplate(field)},fieldRenderers:{Hidden:function(){return Ext.create("Rally.ui.renderer.template.BooleanTemplate",{fieldName:"Hidden",showCheckWhenTrue:!1})}},typeRenderers:{boolean:function(field){return Ext.create("Rally.ui.renderer.template.BooleanTemplate",{fieldName:field.name})}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.plugin.print.GridPrintPage",{extend:Rally.ui.plugin.print.Print,alias:"plugin.rallygridprintpage",mixins:{printRecord:Rally.ui.plugin.print.PrintRecordMixin},summaryTpl:Ext.create("Ext.XTemplate",['<table class="summary">',"<thead>",'<tr class="column-header">','<tpl for="headers">',"<th>{.}</th>","</tpl>","</tr>","</thead>","<tbody>",'<tpl for="records">',"<tr>",'<tpl for="fields">',"<td>","{.}","</td>","</tpl>","</tr>","</tpl>","</tbody>","</table>"]),config:{gridSelector:void 0,excludedDetailFields:["ObjectID","FormattedID","Name","RevisionHistory","Changesets","Discussion"]},constructor:function(config){return this.initConfig(config),this.callParent(arguments)},init:function(component){this.callParent(arguments),this.component=component},getPageContent:function(callback,scope){this.grid=this.component.down(this.getGridSelector()),this.store=this.grid.getStore().clone(),this.store.fetch=Ext.clone(this.grid.getStore().fetch),this.store.proxy=Ext.clone(this.grid.getStore().proxy),this.store.loadPages({callback:function(records){this.records=records;var html=this._getGridPageContent();Ext.callback(callback,scope,[html])},scope:this})},_getGridPageContent:function(){this.printableColumns=this._printableColumns();var html;return html="summary"===this.printOptions.format?this._getSummaryPageContent():this._getDetailPageContent()},_getSummaryPageContent:function(){return this.getTopToolbar()+this.getHeader()+this._getSummaryContent()+this.getFooter()},_getSummaryContent:function(){var data=this._buildGridSummaryData();return this.summaryTpl.apply(data)},_getDetailPageContent:function(){var records=this._buildGridDetailDataRecords();return"oneperpage"===this.printOptions.detailType?this._getOnePerPageDetails(records):this._getContinuousDetails(records)},_getOnePerPageDetails:function(records){var html=this.getTopToolbar();return _.each(records,function(record,index){html+=this.getHeader(),html+=this.getDetailSectionTpl().apply(record),html+=this.getFooter(),index!==records.length-1&&(html+=this._insertPageBreak())},this),this.getDetailTpl().apply({detailSection:html})},_insertPageBreak:function(){return'<div class="oneperpage"></div>'},_getContinuousDetails:function(records){var html=this.getTopToolbar()+this.getHeader();return Ext.each(records,function(record){html+=this.getDetailSectionTpl().apply(record)},this),html+=this.getFooter(),this.getDetailTpl().apply({detailSection:html})},_buildGridSummaryData:function(){return{headers:this._buildGridDataHeaders(),records:this._buildGridDataRecords()}},_buildGridDataHeaders:function(){var headers=[];return Ext.each(this.printableColumns,function(column){headers.push(column.text)}),headers},_buildGridDataRecords:function(){var records=[];return Ext.each(this.records,function(record){var recordData={fields:[]};Ext.each(this.printableColumns,function(column){var html="";if(column.modelField){var printTpl=Rally.ui.renderer.PrintRendererFactory.getPrintRenderTemplate(record.getField(column.modelField.name));printTpl&&(html=printTpl.apply(record.data))}recordData.fields.push(html)}),records.push(recordData)},this),records},_buildGridDetailDataRecords:function(){var printDataCollection=[];return Ext.each(this.records,function(record){var printData=this.convertRecordToPrintData(record);printDataCollection.push(printData)},this),printDataCollection},_printableColumns:function(){var printableColumns=[];return Ext.each(this.grid.columns,function(column){column.isVisible()&&column.printable!==!1&&printableColumns.push(column)}),printableColumns}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.ChildItemsListView",{extend:Rally.ui.list.ListView,alias:"widget.rallypopoverchilditemslistview",requires:[],layout:{type:"vbox",align:"stretch"},config:{model:void 0,record:void 0,parentProperty:void 0,childField:void 0},constructor:function(config){var childItemsStore;if(config=config||{},!_.isObject(config.record))throw new Error("record config property must be specified.");config=Ext.merge({gridConfig:{flex:1,pagingToolbarCfg:{margin:"10 0 0 0",height:22,pageSizes:[]},viewConfig:{publishLoadMessages:!1,loadMask:!1,deferEmptyText:!0},enableRanking:!0,defaultSortToRank:!0,disableColumnMenus:!0,listeners:{render:this._onGridRender,scope:this},simpleSelect:!1,multiSelect:!1,storeConfig:{fetch:[config.parentProperty],pageSize:10},autoAddAllModelFieldsAsColumns:!1,overflowY:"auto",scroll:"vertical"}},config),config.gridConfig.store||(config.childField?(childItemsStore=config.record.getCollection(config.childField,_.defaults({requester:this},config.gridConfig.storeConfig)),config.gridConfig.store=childItemsStore,delete config.gridConfig.storeConfig):config.parentProperty&&(config.gridConfig.storeConfig.filters=[{property:Ext.String.capitalize(config.parentProperty),operator:"=",value:config.record.get("_ref")}])),this._shouldConfigureAddNewConfig(config)?config=Ext.merge({addNewConfig:{alwaysExpanded:!0,recordTypes:[config.model],showFieldLabel:!1,collectionStore:childItemsStore,parentRecord:config.record}},config):config.addNewConfig=null,this.callParent(arguments)},onAddNewBeforeCreate:function(addNew,record,params){this.callParent(arguments),this.childField||record.set(Ext.String.capitalize(this.parentProperty),this.record.get("_ref"))},onAddNewBeforeEditorShow:function(addNew,params){this.callParent(arguments),params[this.parentProperty]=this.record.get("_ref")},_shouldConfigureAddNewConfig:function(config){return null!==config.addNewConfig&&config.record.get("updatable")&&!config.addExistingConfig},_onGridRender:function(grid){grid.getEl().on("keydown",function(e){if(e.getKey()===Ext.EventObject.TAB)return e.stopEvent(),!1})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.ListViewPopover",{alias:"widget.rallylistviewpopover",extend:Rally.ui.popover.Popover,clientMetrics:[{event:"show",description:"popover opened"}],mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},id:"grid-popover",cls:"grid-popover",width:750,maxHeight:600,layout:"fit",constructor:function(config){var items=[Ext.merge({xtype:"rallypopoverchilditemslistview",itemId:"listview",record:config.record,gridConfig:{storeConfig:{listeners:{load:{fn:this._onStoreLoad,scope:this,options:{single:!0}}}}}},config.listViewConfig)];config.items=Ext.merge(items,config.items),this.record=config.record,this.callParent(arguments)},initComponent:function(){this.recordLoadBegin({description:"listview popover created",startTime:(new Date).getTime()}),this.callParent(arguments)},getGrid:function(){return this.down("#listview").getGrid()},_onStoreLoad:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.recordLoadEnd({stopTime:(new Date).getTime()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.DefectPopover",{alias:"widget.rallydefectpopover",extend:Rally.ui.popover.ListViewPopover,clientMetrics:[{event:"show",description:"popover opened"}],id:"defect-popover",cls:"defect-popover",title:"Defects",titleIconCls:"icon-defect",constructor:function(config){config.listViewConfig=Ext.merge({addNewConfig:{ignoredRequiredFields:["Name","Project","State","ScheduleState"]},gridConfig:{storeConfig:{context:config.context,fetch:["TestCase","Requirement"]},columnCfgs:[{dataIndex:"FormattedID",width:90},{dataIndex:"Name",flex:1},{dataIndex:"Severity",width:90},{dataIndex:"Priority",width:90},{dataIndex:"Owner",width:90},{dataIndex:"State",width:90}]},model:Ext.identityFn("Defect"),parentProperty:this._getParentProperty(config.record),childField:"testcase"===config.record.self.typePath?null:"Defects"},config.listViewConfig),this.callParent(arguments)},_getParentProperty:function(record){switch(record.self.typePath){case"testcase":return"testCase";case"defectsuite":return"defectSuiteOid";default:return"Requirement"}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.DependenciesPopover",{alias:"widget.rallydependenciespopover",extend:Rally.ui.popover.Popover,id:"dependencies-popover",cls:"dependenciesPopover",width:400,maxHeight:380,titleIconCls:"icon-predecessor",title:"Dependencies",fetchFields:{hierarchicalrequirement:["Name","FormattedID","ScheduleState","Iteration","Blocked"],portfolioitem:["Name","FormattedID","PercentDoneByStoryCount","Release","State"]},rowTpl:Ext.create("Ext.XTemplate",'<div class="dependency-row">','<div class="identifier">','{[this.getFormattedIdTemplate(values.data)]} <span class="object-name dependency-title">{[this.trimText(values.data, 40, "")]}</span>',"</div>",'<div class="status">','<tpl if="this.isUserStory(values)">',"{[this.getScheduleState(values)]}","</div>",'<span class="field-label">Iteration:</span> <span class="object-name iteration">{[this.trimText(values.data.Iteration, 25, "Unscheduled")]}</span>',"<tpl else>",'<div class="percent-done-wrapper">{[this.getPercentDoneByStoryCount(values)]}</div>',"</div>",'<tpl if="this.hasReleaseAttr(values.data)">','<span class="field-label">Release:</span>  <span class="object-name release">{[this.trimText(values.data.Release, 25, "Unscheduled")]}</span>',"<tpl else>","<span>&nbsp;</span>","</tpl>","</tpl>","</div>",{isUserStory:function(record){return"hierarchicalrequirement"===record.tplType},getFormattedIdTemplate:function(data){return Ext.create("Rally.ui.renderer.template.FormattedIDTemplate",{showIcon:!0,showHover:!1}).apply(data)},getScheduleState:function(record){return Ext.create("Rally.ui.renderer.template.ScheduleStateTemplate",{field:record.getField("ScheduleState")}).apply(record.data)},getPercentDoneByStoryCount:function(record){return Ext.create("Rally.ui.renderer.template.progressbar.PercentDoneByStoryCountTemplate",{field:record.getField("PercentDoneByStoryCount"),record:record}).apply(record.data)},trimText:function(data,max,defaultValue){return data&&data.Name?Ext.String.ellipsis(data.Name,max):defaultValue},hasReleaseAttr:function(data){return data.hasOwnProperty("Release")}}),countTpl:Ext.create("Ext.XTemplate",'<div class="dependency-row">',"Showing {displayed} of {total} {fieldName} of {id}. {[this.getLinkContent(values.record, values.isEdpEnabled)]}","</div>",{getLinkContent:function(record,isEdpEnabled){return isEdpEnabled?Rally.nav.DetailLink.getLink({record:record,subPage:"dependencies",text:"Go to Dependencies."}):""}}),constructor:function(config){var numPredecessors=config.record.get("PredecessorsAndSuccessors").Predecessors,numSuccessors=config.record.get("PredecessorsAndSuccessors").Successors;config.items=[{xtype:"tabpanel",activeTab:0===numPredecessors&&numSuccessors>0?1:0,items:[{title:"Predecessors",html:"Loading...",tabConfig:{width:160}},{title:"Successors",html:"Loading...",tabConfig:{width:160}}],listeners:{afterRender:this._onAfterRender,tabChange:this._onAfterRender,scope:this}}],this.loaded={},this.callParent(arguments)},destroy:function(){this._destroyTooltip(),this.callParent(arguments)},_onAfterRender:function(){var tabTitle=this._getTabPanel().getActiveTab().title;this.loaded[tabTitle]?Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this):(this.loaded[tabTitle]=!0,this._loadData(tabTitle))},_loadData:function(tabTitle){this.record.getCollection(tabTitle,{fetch:this.fetchFields[this._getType(this.record)],requester:this}).load({callback:this._onDataRetrieved,scope:this})},_onDataRetrieved:function(items){Rally.data.detail.DetailPagePreference.isDetailPageEnabled("userstory",function(isEnabled){this.isEdpEnabled=isEnabled,this._getTabPanel().getActiveTab().update(this._buildContent(items)),this._addTooltip(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},this)},_buildContent:function(items){var html=[],fieldName=this._getTabPanel().getActiveTab().title;return _.each(items,function(item){item.tplType=this._getType(items[0]),html.push(this.rowTpl.apply(item))},this),html.push(this.countTpl.apply({total:this.record.get("PredecessorsAndSuccessors")[fieldName],displayed:items.length,fieldName:fieldName.toLowerCase(),id:this.record.get("FormattedID"),isEdpEnabled:this.isEdpEnabled,record:this.record})),'<div class="outer-container">'+html.join("\n")+"</div>"},_addTooltip:function(){this._destroyTooltip(),this.tooltip=Ext.create("Rally.ui.tooltip.ToolTip",{target:this.getEl(),html:"% Done by Story Count",delegate:".percent-done-wrapper",anchor:"top",showDelay:500})},_destroyTooltip:function(){this.tooltip&&this.tooltip.destroy()},_getTabPanel:function(){return this.items.items[0]},_getType:function(record){return record.get("_ref").replace(/^\//,"").split("/")[0]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.HoverablePopover",{extend:Rally.ui.popover.Popover,id:null,cls:null,width:300,modal:!1,minHeight:20,offsetFromTarget:[{x:0,y:-10},{x:12,y:0},{x:0,y:10},{x:-12,y:0}],header:!1,constructor:function(config){this.target=config.target,this.target.on("mouseover",this._addHoverCls,this,[this.target]),this.target.on("mouseout",this._hidePopover,this,[this.target]),this.callParent(arguments)},afterShow:function(){this.callParent(arguments),this._makePopoverHoverable()},onDestroy:function(){this.target.un("mouseover",this._addHoverCls,this,[this.target]),this.target.un("mouseout",this._hidePopover,this,[this.target]),this.callParent()},_makePopoverHoverable:function(){var hoverableElements=[this.getEl()];this.chevron&&this.chevron.getEl()&&hoverableElements.push(this.chevron.getEl()),Ext.Array.each(hoverableElements,function(element){_.isUndefined(element)||element.hover(function(){_.isUndefined(element)||element.addCls("hover")},this._hidePopover,this,[element])},this)},_addHoverCls:function(){this.target.addCls("hover")},_hidePopover:function(e,target,options){_.isArray(options)&&options.length>0&&!_.isUndefined(options[0])&&options[0].removeCls("hover"),Ext.defer(function(){this&&this.rendered&&!(this.target&&this.target.hasCls("hover")||this.hasCls("hover")||this.chevron&&this.chevron.hasCls("hover"))&&this.destroy()},100,this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.DescriptionPopover",{alias:"widget.rallydescriptionpopover",extend:Rally.ui.popover.HoverablePopover,id:"description-popover",cls:"description-popover",constructor:function(config){var recordProject=config.record.get("Project");config.items=[{xtype:"rallydescriptionrichtextview",context:config.context,listeners:{scope:this,viewready:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)}},storeConfig:{context:_.merge(config.context?config.context.getDataContext():{},recordProject&&recordProject._ref?{project:recordProject._ref}:{}),filters:[{property:"ObjectID",operation:"=",value:config.record.get("ObjectID")}],model:config.record.self}}],this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.DiscussionPopover",{alias:"widget.rallydiscussionpopover",extend:Rally.ui.popover.Popover,clientMetrics:[{event:"show",description:"popover opened"}],id:"discussion-popover",cls:"discussion-popover",width:520,replyEditorConfig:{},richTextStreamViewConfig:{},title:"Discussions",titleIconCls:"icon-comment",constructor:function(config){var promises=[];config.items=[],config.record.get("updatable")&&(this.discussionEditorDeferred=new Deft.Deferred,promises.push(this.discussionEditorDeferred.promise),Ext.Array.push(config.items,Ext.merge({xtype:"rallydiscussioninlinereplyeditor",itemId:"discussionIRE",artifact:config.record,enableModeToggle:!1,listeners:{ready:this.onEditorReady,scope:this}},config.replyEditorConfig)));var streamDeferred=new Deft.Deferred;promises.push(streamDeferred.promise),Ext.Array.push(config.items,Ext.merge({xtype:"rallydiscussionrichtextstreamview",itemId:"discussionRTSV",showArtifactDetail:!1,allowReply:!1,allowDelete:!0,autoScroll:!0,maxHeight:250,profileImageSize:35,statusTpl:'<a class="profileLink" href="#"><span class="{nameCls}">{User._refObjectName}</span></a> {createdAt}',artifact:config.record,storeConfig:{context:config.context,filters:[{property:"Artifact",operation:"=",value:config.record.get("_ref")}]},listeners:{refresh:function(){this.rendered&&this.alignToTarget()},ready:function(streamView){"pending"===streamDeferred.getState()&&streamDeferred.resolve(streamView)},discussiondestroyed:function(){this.child("#discussionIRE").focusTextField()},deletecanceled:function(){this.child("#discussionIRE").focusTextField()},scope:this}},config.richTextStreamViewConfig)),Deft.Promise.all(promises).then({success:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},scope:this}),this.callParent(arguments)},onEditorReady:function(discussionEditor){discussionEditor.focusTextField(),this.discussionEditorDeferred.resolve(discussionEditor)},destroy:function(){var discEl=this.down("#discussionRTSV");null!==discEl&&null!==discEl.confirmationDialog||this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.MvcfEditorPopover",{alias:"widget.rallymvcfeditorpopover",extend:Rally.ui.popover.Popover,require:["Rally.Message","Rally.ui.notify.Notifier"],mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},cls:"rui-mvcfeditorpopover",record:void 0,clientMetrics:{},title:"Not Tags!",pageSize:50,config:{readOnly:!1},initComponent:function(){this.title=this.field.displayName,this.recordLoadBegin({description:"MvcfEditorPopover rendered"});var upperPlural=this.title.toUpperCase()+(Rally.util.String.endsWith(this.title.toUpperCase(),"S")?"":"S"),plural=this.title+(Rally.util.String.endsWith(this.title.toUpperCase(),"S")?"":"s");if(this.callParent(arguments),this.getReadOnly())this.mvcfChooser=this._addReadOnly(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this);else{var fieldDef=this.record.getField(this.field.name);if(!fieldDef)return;this.allowedValuesStore=fieldDef.getAllowedValueStore({pageSize:this.pageSize}),this.allowedValuesStore.clearListeners(),this.mvcfChooser=Ext.create("Rally.ui.mvcfchooser.MvcfChooser",{itemId:"mvcfChooser",emptyText:"Type to filter...",listConfig:{maxHeight:300,noItemsAvailableText:"No matching "+plural,controllerConfig:{collectionProperty:this.field.name,getSelectedRecordsFn:this.getSelectedRecordsFn},listeners:{ready:this._onReady,scope:this}},selectedConfig:{listTitle:"SELECTED "+upperPlural,controllerConfig:{type:"AllowedAttributeValue"}},availableConfig:{listTitle:"AVAILABLE "+upperPlural,controllerConfig:{type:"AllowedAttributeValue",store:this.allowedValuesStore,storeConfig:{remoteFilter:!0,filters:[]}}}}),this.mvcfStore=this.record.getCollection(this.field.name),this.loadMvcfStore(),this.mvcfChooser.setArtifactRecords(this.record.get(this.field.name)._tagsNameArray),this.add(this.mvcfChooser)}},_addReadOnly:function(){var selectedValues=this.record.get(this.field.name)._tagsNameArray,sortedValues=_.pluck(selectedValues,"Name").sort();return this.add({xtype:"component",style:{width:"300px",display:"block",margin:0,backgroundColor:"#FFF",color:"#000",padding:"5px 10px",maxHeight:"300px",overflowY:"auto"},cls:"mvcf-selected-items",tpl:['<ul style="margin: 0px">','<tpl for="items">','<li style="line-height: 20px;"><tpl>{.}</tpl></li>',"</tpl>","</ul>"],data:{items:sortedValues}})},loadMvcfStore:function(){this.mvcfStore.load({callback:function(mvcfs){this.isDestroyed||Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},scope:this})},beforeDestroy:function(){if(!this._isReady||!this.mvcfChooser.isDirty())return void this.callParent(arguments);var newMvcfs=this.mvcfChooser.getSelectedMvcf().full;if(this.callParent(arguments),!this._mvcfCollectionAreEqual(this.record.get(this.field.name),newMvcfs)){"undefined"==typeof newMvcfs&&(newMvcfs=[]),this.record.set(this.field.name,{Count:newMvcfs.length,_ref:this.record.get(this.field.name)._ref,_tagsNameArray:this._transformMvcfRecords(newMvcfs)});var oldMvcfs=this.mvcfStore.getRange(),existingMvcfRefs=_.map(oldMvcfs,Rally.util.Ref.getRelativeUri,Rally.util.Ref),newMvcfRefs=_.map(newMvcfs,Rally.util.Ref.getRelativeUri,Rally.util.Ref),added=_.difference(newMvcfRefs,existingMvcfRefs),removed=_.difference(existingMvcfRefs,newMvcfRefs);this._addMvcfs(newMvcfs,added),this._removeMvcfs(oldMvcfs,removed),this._syncStore(),this.allowedValuesStore.clearListeners(),this.allowedValuesStore.clearFilter()}},_syncStore:function(){this.mvcfStore.sync({callback:function(batch){this.publish(Rally.Message.objectUpdate,this.record,[this.field.name],this),this.publish(Rally.Message.recordUpdateSuccess,this.record),this._onOperationCompleted(this.record,batch.operations)},scope:this})},_getStore:function(){return this.mvcfStore},_onOperationCompleted:function(record,operations){_.each(operations,function(operation){if(operation.success)this.record.commit(!0);else{var operationErrorMsg=operation.error&&_.isArray(operation.error.errors)&&1===operation.error.errors.length?": "+operation.error.errors[0]:"",errorMsg="There was a problem saving "+this.field.name+" for "+this.record.get("FormattedID")+operationErrorMsg;
this.publish(Rally.Message.recordUpdateFailure),Rally.ui.notify.Notifier.showError({message:errorMsg})}},this)},_addMvcfs:function(newMvcfs,added){var newMvcfsMap=_.reduce(newMvcfs,this._mapRefToObject,{});this.mvcfStore.add(_.map(added,function(ref){return newMvcfsMap[ref]},this))},_removeMvcfs:function(oldMvcfs,removed){var oldMvcfsMap=_.reduce(oldMvcfs,this._mapRefToObject,{});this.mvcfStore.remove(_.map(removed,function(ref){return oldMvcfsMap[ref]},this))},_mapRefToObject:function(currentMap,nextValue){return currentMap[nextValue.get("_ref")]=nextValue,currentMap},getSelectedRecordsFn:function(mvcfObjectArray){var Model=this.getAvailableMvcfList().getStore().model;if(Model)return _.map(mvcfObjectArray,function(mvcfObject){return new Model({ObjectID:Rally.util.Ref.getOidFromRef(mvcfObject._ref),StringValue:mvcfObject.Name,_ref:mvcfObject._ref,_refObjectName:mvcfObject.Name})},this)},_onReady:function(){this._isReady=!0,this.recordLoadEnd()},_mvcfCollectionAreEqual:function(originalMvcfsCollection,newMvcfsCollection){return"undefined"==typeof originalMvcfsCollection._tagsNameArray?"undefined"==typeof newMvcfsCollection||0===newMvcfsCollection.length:(newMvcfsCollection=_.sortBy(newMvcfsCollection,"_ref"),originalMvcfsCollection.length===newMvcfsCollection.length&&_(originalMvcfsCollection).sortBy("_ref").all(function(val1,i){return this._valueIsEqual(val1,newMvcfsCollection[i])},this))},_valueIsEqual:function(val1,val2){return val1._ref===val2._ref&&val1.Name===val2.Name},_transformMvcfRecords:function(mvcfRecords){return _.map(mvcfRecords,function(mvcfRecord){return{Name:mvcfRecord.get("StringValue"),_ref:mvcfRecord.get("_ref"),_refObjectName:mvcfRecord.get("StringValue")}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.NewPopover",{extend:Rally.ui.popover.Popover,cls:"rly-popover new",modal:!1,chevronPrefixCls:"new",fireDismissEventWhenClickingIconClose:!1,width:200,contentText:"",helpLinkId:void 0,helpLinkText:"",dismissedPrefName:"",title:"",initComponent:function(){this.callParent(arguments),this.addEvents(["dismiss"])},constructor:function(){if(this.callParent(arguments),this.add({xtype:"component",html:this._buildContent()}),this.fireDismissEventWhenClickingIconClose){var cancelEl=this.getEl().down(".icon-cancel");cancelEl&&cancelEl.on("click",this.dismiss,this)}Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},dismiss:function(){this.fireEvent("dismiss")},_buildContent:function(){return["<p>"+this.contentText+"</p>","<p>"+Rally.util.Help.getLinkTag({id:this.helpLinkId,text:this.helpLinkText})+"</p>"].join("\n")},_onChevronClick:Ext.emptyFn})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.NewPopoverViewController",{extend:Rally.ui.ViewController,mixins:{messageable:Rally.Messageable},observe:{view:{close:"dismiss"}},dismiss:function(){this.savePreference()},savePreference:function(){var pref={};return pref[this.getView().dismissedPrefName]=!0,Rally.data.PreferenceManager.update({filterByUser:!0,settings:pref})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.OwnerPopover",{alias:"widget.rallyownerpopover",extend:Rally.ui.popover.Popover,id:"owner-popover",cls:"owner-popover",offsetFromTarget:[{x:0,y:-10},{x:15,y:0},{x:0,y:10},{x:-15,y:0}],iconCls:"card-owner-img",initComponent:function(){var me=this,record=this.record,owner=record.get("Owner"),ownerName=owner&&owner._refObjectName||"No Owner",ownerImage=owner?Rally.util.User.getProfileImageUrl(40,owner):Rally.util.User.getNoOwnerImageUrl();this.title=ownerName,this.icon=ownerImage,this.callParent(arguments),this.add({xtype:"rallyusersearchcombobox",project:this.record.get("Project")._ref||Rally.environment.getContext().getProject()._ref,alwaysExpanded:!0,componentCls:"rui-card-owner-combobox",collapse:Ext.emptyFn,enableKeyEvents:!0,margin:"10px 0 0 0",listConfig:{floating:!1,maxHeight:250,renderTo:"owner-popover-innerCt",listeners:{scope:this,select:function(list,record){this.record.set("Owner",record.get("_ref")),this.record.save({success:function(){Rally.environment.getMessageBus().publish(Rally.Message.objectUpdate,this.record,["Owner"],this),this.destroy()},scope:this,requester:this})}},clientMetrics:[{event:"select",description:"changed owner"}],clientMetricsParent:this},listeners:{boxready:function(combobox){combobox.setLoading(!0)},beforerender:{fn:function(cmp){cmp.addCls(Rally.util.Test.toBrowserTestCssClass("rally-user-combobox-"+this.record.get("ObjectID")))},single:!0},pickerrefreshed:this.resizeComboBoxAndPopover,expand:{fn:function(combobox){this.resizeComboBoxAndPopover(combobox),combobox.getPicker().addCls(Rally.util.Test.toBrowserTestCssClass("rally-user-combobox-boundlist-"+this.record.get("ObjectID"))),combobox.setLoading(!1),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},single:!0},scope:this},onKeyDown:function(e){e.getKey()===Ext.EventObject.ESC&&me.destroy()}})},resizeComboBoxAndPopover:function(combobox){function setComboBoxWidth(width){combobox.setWidth(width),(Ext.isSafari||Ext.firefoxVersion>0)&&combobox.getEl().setWidth(width)}function setWidths(width){setComboBoxWidth(width),boundlist.setWidth(width),me.setWidth(width+POPOVER_PADDING)}var me=this,POPOVER_MAX_WIDTH=300,POPOVER_PADDING=20,boundlist=this.getEl().down(".rally-user-combobox-boundlist");boundlist&&(this.getEl().setStyle({width:"auto"}),this.getEl().getById("owner-popover-body").setStyle({width:"auto"}),setComboBoxWidth(boundlist.getWidth()),boundlist.getWidth()>POPOVER_MAX_WIDTH&&setWidths(POPOVER_MAX_WIDTH))}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TagEditorPopover",{alias:"widget.rallytageditorpopover",extend:Rally.ui.popover.Popover,require:["Rally.Message","Rally.ui.notify.Notifier"],mixins:{messageable:Rally.Messageable,clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},cls:"rui-tageditorpopover",record:void 0,clientMetrics:{},title:"Tags",titleIconCls:"icon-tag",initComponent:function(){this.recordLoadBegin({description:"TagEditorPopover rendered"}),this.callParent(arguments),this.tagChooser=Ext.create("Rally.ui.tagchooser.TagChooser",{itemId:"tagChooser",emptyText:"Type to create or filter...",listConfig:{maxHeight:300,noItemsAvailableText:"No matching tag",controllerConfig:{collectionProperty:"Tags",getSelectedRecordsFn:this.getSelectedRecordsFn},listeners:{ready:this._onReady,scope:this}},selectedConfig:{listTitle:"SELECTED TAGS",controllerConfig:{type:"Tag"}},availableConfig:{listTitle:"AVAILABLE TAGS",controllerConfig:{type:"Tag",storeConfig:{remoteFilter:!0,pageSize:50,filters:[{property:"Archived",value:!1}]}}}}),this.tagChooser.setArtifactRecords(this.record.get("Tags")._tagsNameArray),this.add(this.tagChooser)},beforeDestroy:function(){if(this._isReady){var newTags=this.tagChooser.getSelectedTags().full;newTags=this._transformTagRecords(newTags),this._tagsCollectionAreEqual(this.record.get("Tags")._tagsNameArray,newTags)||(this.record.set("Tags",newTags),this.record.save({callback:function(savedRecord,operation){if(this.recordAction({description:"tags saved from TagEditorPopover"}),operation.success)this.publish(Rally.Message.objectUpdate,savedRecord,["Tags"],this),this.publish(Rally.Message.recordUpdateSuccess,savedRecord);else{var operationErrorMsg=operation.error&&_.isArray(operation.error.errors)&&1===operation.error.errors.length?": "+operation.error.errors[0]:"",errorMsg="There was a problem saving Tags for "+this.record.get("FormattedID")+operationErrorMsg;this.publish(Rally.Message.recordUpdateFailure),Rally.ui.notify.Notifier.showError({message:errorMsg})}},scope:this}))}},getSelectedRecordsFn:function(tagObjectArray){var Model=this.getAvailableTagList().getStore().model;if(Model)return _.map(tagObjectArray,function(tagObject){return new Model({ObjectID:Rally.util.Ref.getOidFromRef(tagObject._ref),Name:tagObject.Name,_ref:tagObject._ref,_refObjectName:tagObject.Name})},this)},_onReady:function(){this._isReady=!0,this.recordLoadEnd(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},_tagsCollectionAreEqual:function(originalTagsCollection,newTagsCollection){return!_.isUndefined(originalTagsCollection)&&!_.isUndefined(newTagsCollection)&&(newTagsCollection=_.sortBy(newTagsCollection,"_ref"),originalTagsCollection.length===newTagsCollection.length&&_(originalTagsCollection).sortBy("_ref").all(function(val1,i){return this._valueIsEqual(val1,newTagsCollection[i])},this))},_valueIsEqual:function(val1,val2){return val1._ref===val2._ref&&val1.Name===val2.Name},_transformTagRecords:function(tagRecords){return _.map(tagRecords,function(tagRecord){return{Name:tagRecord.get("Name"),_ref:tagRecord.get("_ref"),_refObjectName:tagRecord.get("Name")}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TreeGridPopover",{alias:"widget.rallytreegridpopover",extend:Rally.ui.popover.Popover,clientMetrics:[{event:"show",description:"popover opened"}],mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},id:"treegrid-popover",cls:"treegrid-popover",width:750,maxHeight:600,layout:"fit",config:{modelNames:["User Story","Defect","Defect Suite","Test Set"],gridConfig:{}},initComponent:function(){this.recordLoadBegin({description:"grid popover created",startTime:(new Date).getTime()}),this.callParent(arguments),this._buildGridStore().then({success:function(store){this.add(this._getGridConfig(store))},scope:this})},_buildGridStore:function(){var dataContext=this.getContext(),storeConfig=Ext.apply({pageSize:10,context:dataContext,autoLoad:!0,models:this.modelNames,remoteSort:!0,enableHierarchy:!1,listeners:{load:{fn:this._onStoreLoad,scope:this,options:{single:!0}}}},this.gridConfig.storeConfig);return delete this.gridConfig.storeConfig,Ext.create("Rally.data.wsapi.TreeStoreBuilder").build(storeConfig)},_getGridConfig:function(store){return Ext.apply({xtype:"rallytreegrid",itemId:"treegrid",pagingToolbarCfg:{margin:"10 0 0 0",height:22,pageSizes:[]},store:store},this.gridConfig)},_onStoreLoad:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.recordLoadEnd({stopTime:(new Date).getTime()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TagPopover",{alias:"widget.rallytagpopover",extend:Rally.ui.popover.TreeGridPopover,config:{offsetFromTarget:[{x:-3,y:-10},{x:10,y:0},{x:3,y:10},{x:-10,y:0}]},constructor:function(config){config=Ext.apply({title:"Stuff tagged '"+config.name+"'",gridConfig:{storeConfig:{pageSize:20,filters:[{property:"Tags",operator:"CONTAINS",value:config.ref}],sorters:[{property:"LastUpdateDate",direction:"desc"}]},columnCfgs:[{header:"ID",dataIndex:"FormattedID",minWidth:null},"Name","Iteration","Project",{header:"Owner",dataIndex:"Owner",flex:2,minWidth:null},"LastUpdateDate"],rowActionColumnConfig:{menuOptions:{showAddTasks:!1,showAddDefects:!1,showAddTestCases:!1,showCopyTasksFrom:!1,showSplitMenuItem:!1,showRankMenuItems:!1,showAddChildMenuItem:!1}}},targetSelector:".tagName[data-tag-id="+Rally.util.Ref.getOidFromRef(config.ref)+"]",context:{workspace:Rally.util.Ref.getRelativeUri(Rally.environment.getContext().getWorkspace()._ref),project:null}},config),this.callParent([config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TaskPopover",{alias:"widget.rallytaskpopover",extend:Rally.ui.popover.ListViewPopover,clientMetrics:[{event:"show",description:"popover opened"}],id:"task-popover",cls:"task-popover",title:"Tasks",titleIconCls:"icon-task",width:825,constructor:function(config){config.listViewConfig=Ext.merge({addNewConfig:{ignoredRequiredFields:["Name","State","TaskIndex","WorkProduct","Project","ScheduleState"],width:670,additionalFields:[{xtype:"rallynumberfield",plugins:[{ptype:"rallyfieldvalidationui"}],emptyText:"Task Est",minValue:0,maxValue:999.99,width:70,name:"Estimate",autoStripChars:!0},{xtype:"rallyusersearchcombobox",emptyText:"Owner",allowNoEntry:!0,context:Rally.environment.getContext(),noEntryValue:Rally.util.User.noOwnerValue,width:160,selectOnTab:!0,listeners:{expand:function(field){field.focus()}},name:"Owner",value:Rally.environment.getContext().getUser().getRef()}]},gridConfig:{columnCfgs:[{dataIndex:"FormattedID",width:90},{dataIndex:"Name",flex:1},{dataIndex:"Owner",width:90},{dataIndex:"State",width:80},{dataIndex:"Estimate",align:"right",width:70},{dataIndex:"ToDo",align:"right",width:70},{dataIndex:"Actuals",width:60},{dataIndex:"Blocked",width:55}],listeners:{edit:function(editor,e){"State"===e.field&&e.record.set({Ready:!1,Blocked:!1})}},storeConfig:{context:config.context}},model:Ext.identityFn("Task"),parentProperty:"WorkProduct",childField:"Tasks"},config.listViewConfig),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TestCaseDefectPopover",{alias:"widget.rallytestcasedefectpopover",extend:Rally.ui.popover.TreeGridPopover,clientMetrics:[{event:"show",description:"popover opened"}],id:"test-case-defect-popover",cls:"test-case-defect-popover",width:760,constructor:function(config){var mapper=Ext.create("Rally.data.wsapi.ParentChildMapper");mapper.parentChildTypeMap={defect:[{typePath:"testcase",collectionName:"TestCases",parentField:"WorkProduct"}],testcase:[{typePath:"defect",collectionName:"Defects",parentField:"TestCase"}]},config=Ext.apply({title:"Defects",modelNames:["Test Case"],gridConfig:{enableRanking:!1,enableInlineAdd:!1,expandAllInColumnHeaderEnabled:!1,columnCfgs:[{dataIndex:"Name",flex:1},{dataIndex:"Severity",width:90},{dataIndex:"Priority",width:90},{dataIndex:"Owner",width:90},{dataIndex:"State",width:90}],rowActionColumnConfig:{menuOptions:{showCopyTasksFrom:!1,showAddTasks:!1,showAddTestCases:!1,showAddTestCaseResult:!1}},storeConfig:{mapper:mapper,context:{workspace:config.record.get("Workspace"),project:null},enableHierarchy:!0,fetch:["Defects"],pageSize:5,filters:[{property:"TestSets",operator:"contains",value:Rally.util.Ref.getRelativeUri(config.record)},{property:"Defects.ObjectID",operator:"!=",value:null}],listeners:{load:{fn:this._onStoreLoad,scope:this,options:{single:!0}}}}}},config),this.callParent(arguments)},_onStoreLoad:function(store){Ext.suspendLayouts(),_.invoke(store.getRootNode().childNodes,"expand"),Ext.resumeLayouts(!1),this.doLayout(),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this.recordLoadEnd({stopTime:(new Date).getTime()})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.TestCasePopover",{alias:"widget.rallytestcasepopover",extend:Rally.ui.popover.ListViewPopover,id:"testcase-popover",cls:"testcase-popover",title:"Test Cases",titleIconCls:"icon-test-case",pageSize:10,width:825,constructor:function(config){var record=config.record,columnCfgs=[{dataIndex:"FormattedID",width:90},{dataIndex:"Name",flex:1},{dataIndex:"Owner",width:80},{dataIndex:"Type",width:80},{dataIndex:"LastVerdict",width:90},{dataIndex:"LastBuild",width:80},{dataIndex:"LastRun",width:80}],testCasesStore=record.getCollection("TestCases",{limit:this.pageSize,pageSize:this.pageSize,context:{project:null},listeners:{load:{fn:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},single:!0},scope:this},fetch:["LastResult"],autoLoad:!0}),gridConfig={store:testCasesStore,showRowActionsColumn:!1,enableRanking:!0,columnCfgs:columnCfgs},modelTypeListViewConfig={gridConfig:gridConfig,model:Ext.identityFn("TestCase")};record.isUpdatable()&&columnCfgs.unshift({xtype:"rallyrowactioncolumn",menuOptions:{associatedRecord:record,testCasesStore:testCasesStore},scope:this}),"testset"===record.self.typePath?(gridConfig.store=Ext.create("Rally.data.wsapi.artifact.Store",{url:Rally.environment.getServer().getWsapiUrl()+Rally.util.Ref.getRelativeUri(config.record)+"/ScheduledTestCases",models:[Ext.identityFn("TestCase")],fetch:["FormattedID","Name","Type","LastResult","Owner","Build","LastBuild","Verdict","LastVerdict","Date","LastRun","TestCase","DragAndDropRank"],context:config.context,record:record,sorters:[],filters:[],autoLoad:!0,pageSize:10,alwaysSortedByRankAsc:!0}),Ext.merge(gridConfig,{bulkEditConfig:{store:testCasesStore,showTag:!1,showParent:!1,showEdit:!1,showRemove:!0},enableBulkEdit:!0,sortableColumns:!1}),modelTypeListViewConfig.addExistingConfig={chooserDialogConfig:{collectionStoreToAddTo:testCasesStore,plugins:["rallyartifacttestfolderfilter",{ptype:"rallyartifactprojectfilter",fieldLabel:"&nbsp;"}],storeConfig:{context:config.context,filters:[{property:"TestSets",operator:"!contains",value:Rally.util.Ref.getRelativeUri(testCasesStore.record)}]},title:"Choose Test Cases"}}):_.assign(modelTypeListViewConfig,{addNewConfig:{ignoredRequiredFields:["ObjectID","FormattedID","Name","DefectStatus","Method","Type","CreationDate","LastUpdateDate","Project"]},parentProperty:"WorkProduct"}),config.listViewConfig=Ext.merge(modelTypeListViewConfig,config.listViewConfig),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.UserStoryPopover",{alias:"widget.rallyuserstorypopover",extend:Rally.ui.popover.ListViewPopover,clientMetrics:[{event:"show",description:"userstory popover opened"}],id:"userstory-popover",cls:"userstory-popover",title:"User Stories",titleIconCls:"icon-story",constructor:function(config){config.listViewConfig=Ext.merge({model:Ext.identityFn("HierarchicalRequirement"),parentProperty:"Parent",childField:config.record.hasField("UserStories")?"UserStories":"Children",addNewConfig:null,gridConfig:{storeConfig:{context:config.context,fetch:["Parent","PortfolioItem"],listeners:{load:this._onStoreLoad,scope:this}},columnCfgs:[{dataIndex:"FormattedID",width:90},{dataIndex:"Name",flex:1},{dataIndex:"Release",width:180},{dataIndex:"Iteration",width:180}]}},config.listViewConfig),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Timebox",{singleton:!0,getToday:function(tzOffset){var tzoffset=tzOffset||0,today=new Date,gmtHours=today.getTimezoneOffset()/60;return today=Rally.util.DateTime.add(today,"hour",gmtHours),today=Rally.util.DateTime.add(today,"hour",tzoffset)},getCounts:function(startDate,endDate,workdays,tzOffset){if(!startDate||!endDate)return{workdays:0,remaining:0};for(var tmpDate,tzoffset=tzOffset||0,today=this.getToday(tzoffset),trackedWorkDays=workdays.toLowerCase().split(","),timeboxLength=Rally.util.DateTime.getDifference(endDate,startDate,"day")+1,daysInTimebox=timeboxLength,daysRemaining=0,i=0;i<daysInTimebox;i++)tmpDate=Rally.util.DateTime.add(startDate,"day",i),tmpDate=Rally.util.DateTime.add(tmpDate,"hour",23),tmpDate=Rally.util.DateTime.add(tmpDate,"minute",59),tmpDate=Rally.util.DateTime.add(tmpDate,"second",59),tmpDate=Rally.util.DateTime.add(tmpDate,"millisecond",999),Ext.Array.contains(trackedWorkDays,Rally.util.DateTime.format(tmpDate,"l").toLowerCase())?tmpDate>=today&&startDate<today&&daysRemaining++:timeboxLength--;return{workdays:timeboxLength,remaining:daysRemaining}},getOrientation:function(startDate,endDate,tzOffset){var timeOrientation,tzoffset=tzOffset||0,today=this.getToday(tzoffset);return startDate<=today&&endDate>=today?timeOrientation="current":endDate<today?timeOrientation="past":startDate>today&&(timeOrientation="future"),timeOrientation}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.WorkProductPopover",{alias:"widget.rallyworkproductpopover",extend:Rally.ui.popover.HoverablePopover,id:"work-product-popover",cls:"work-product-popover",constructor:function(config){config.items=[{xtype:"component",renderData:config.record.data,renderTpl:["<tpl>","{[this.getFormattedIdTemplate(values)]} : {_refObjectName}",'<div class="work-product-popover-details">',"<h3>% Done</h3>","{[this.getTaskPercentDone(values)]}{[this.getTasksDone(values)]} of {TaskEstimateTotal} {[this.getTaskUnit()]}","<h3>Owner</h3>",'{[this.getOwnerImage(values)]}<div class="owner-text">{[this.getOwnerText(values)]}</div>',"<h3>Schedule State</h3>",'<div class="schedule-state-ct">{[this.getScheduleState(values)]}</div>',"</div>","</tpl>",{getFormattedIdTemplate:function(data){return Ext.create("Rally.ui.renderer.template.FormattedIDTemplate",{showIcon:!0,showHover:!1}).apply(data)},getTasksDone:function(data){return Ext.Number.toFixed(data.TaskEstimateTotal-data.TaskRemainingTotal,2)},getTaskPercentDone:function(data){return Ext.create("Rally.ui.renderer.template.progressbar.ProgressBarTemplate",{percentDoneName:"PercentDone",height:"15px",width:"50px",isClickable:!1,calculateColorFn:function(recordData){if(config.record.get("InProgressDate"))return 1===recordData.PercentDone?Rally.util.Colors.lime:Rally.util.Colors.cyan}}).apply({PercentDone:this.getTasksDone(data)/data.TaskEstimateTotal||0})},getTaskUnit:function(){return config.context.getWorkspace().WorkspaceConfiguration.TaskUnitName},getOwnerImage:function(data){return Ext.create("Rally.ui.renderer.template.CardOwnerImageTemplate",{}).apply(data)},getOwnerText:function(data){return data.Owner&&data.Owner._refObjectName||"No Owner"},getScheduleState:function(data){return Ext.create("Rally.ui.renderer.template.ScheduleStateTemplate",{field:config.record.getField("ScheduleState")}).apply(data)}}],listeners:{afterrender:function(){Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this)},scope:this}}],this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.popover.new.ProjectAdminAlertPopover",{extend:Rally.ui.popover.NewPopover,alias:"widget.rallyprojectadminalertpopover",controller:"Rally.ui.popover.NewPopoverViewController",contentText:"Administrate your projects and users within Setup.",title:"You now have Project Admin access!",helpLinkId:170,helpLinkText:"Learn more",width:320,placement:"bottom",offsetFromTarget:[{x:0,y:0},{x:0,y:0},{x:-85,y:19},{x:0,y:0}],chevronOffset:[{x:0,y:-14},{x:14,y:0},{x:90,y:10},{x:-8,y:0}]})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.AttributeTypeTemplate",{extend:Ext.XTemplate,constructor:function(config){var templateConfig=["{[this.getAttributeType(values)]}",{getAttributeType:function(values){return values.Constrained&&values.Custom&&(values.Multivalue||"COLLECTION"===values.AttributeType)?"Drop Down List (Multi Value)":values.Constrained?"Drop Down List":"OBJECT"===values.AttributeType?"Chooser":"QUANTITY"===values.AttributeType?"Decimal":"WEB_LINK"===values.AttributeType?"Web Link":Ext.String.capitalize(values.AttributeType.toLowerCase())}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.BlockedTemplate",{extend:Ext.XTemplate,constructor:function(config){var templateConfig=['<div alt="{[this.getAlt(values)]}">',"{[this._buildIcon(values, this.getCls(values))]}","</div>",{getAlt:function(value){return value.Blocked?"Blocked":"Blockable"},getCls:function(value){var updateCls=value.updatable||value.Blocked?" clickable":"",blockedCls=value.Blocked?"blocked":"blockable";return blockedCls+updateCls},_buildIcon:function(value,cls){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"BLOCKED_READY_STATUS",icon:value.Blocked?"BLOCKED":"NOT_BLOCKED",cls:cls}).apply({})}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.BooleanTemplate",{extend:Ext.XTemplate,fieldName:"",alt:"Checked",cls:"checked",showCheckWhenTrue:!0,constructor:function(config){var templateConfig=['<tpl if="this.shouldShowCheck(values)"><div class="picto icon-ok {[this.cls]}" alt="{[this.alt]}"></div></tpl>',{shouldShowCheck:function(values){var value=values[this.fieldName];return Ext.isString(value)&&(value="true"===value),this.showCheckWhenTrue?value:!value}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.BooleanYesNoTemplate",{extend:Ext.XTemplate,config:{fieldName:""},constructor:function(config){this.initConfig(config);var templateConfig=['{[this.formatBoolean(values["'+this.fieldName+'"])]}',{formatBoolean:function(value){return value?"Yes":"No"}}];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardChildrenSummaryTemplate",{extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="this.hasChildren(values)">',"<div>{[this.getChildrenCnt(values)]}</div>","</tpl>",{hasChildren:function(values){return values.Summary.Children&&this.getChildrenCnt(values)>0},getChildrenCnt:function(values){return values.Summary.Children.Count}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.IconBuilderTemplate",{extend:Ext.XTemplate,inheritableStatics:{BLOCKED_READY_STATUS:{BLOCKED:["icon-blocked"],NOT_BLOCKED:["icon-blocked"],READY:["icon-ready"],NOT_READY:["icon-ready"]},DEFECT_STATUS:{NONE:["icon-empty"],NONE_CLOSED:["icon-defect"],SOME_CLOSED:["icon-defect-status","icon-task-in-progress"],ALL_CLOSED:["icon-defect-status","icon-task-completed"]},DISCUSSION_STATUS:{NONE:["icon-empty"],STALE:["icon-comment"],RECENT:["icon-comment"],LESS_RECENT:["icon-comment"],LEAST_RECENT:["icon-comment"]},TASK_STATUS:{NONE:["icon-empty"],DEFINED:["icon-task"],IN_PROGRESS:["icon-task-status","icon-task-in-progress"],IN_PROGRESS_BLOCKED:["icon-task-status","icon-task-in-progress"],COMPLETED:["icon-task-status","icon-task-completed"],COMPLETED_BLOCKED:["icon-task-status","icon-task-completed"]},TEST_CASE_STATUS:{NONE:["icon-empty"],NONE_RUN:["icon-test-case"],SOME_RUN_SOME_NOT_PASSING:["icon-test-status","icon-task-in-progress"],SOME_RUN_ALL_PASSING:["icon-test-status","icon-task-in-progress"],ALL_RUN_NONE_PASSING:["icon-test-status","icon-task-completed"],ALL_RUN_ALL_PASSING:["icon-test-status","icon-task-completed"]}},category:"",icon:"",cls:"",constructor:function(config){config.category=config.category.toUpperCase().replace("-","_"),config.icon=config.icon.toUpperCase().replace("-","_");var templateConfig=['<tpl if="this.getIconType()">','<div class="icon-builder-template {[this.getIconClasses()]}" role="img" aria-label="View {[this.category]}">','<tpl for="this.getIconType()">','<span class="{[this.cls]} icon-builder-span {.}"></span>',"</tpl>","</div>","</tpl>",{getIconClasses:function(){return this.category+" "+this.icon},getIconType:function(){return this.self[this.category]&&this.self[this.category][this.icon]}},config];this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardDefectSummaryTemplate",{extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="this.hasDefects(values)">','<div class="status-value defects" title="Manage Defects">',"{[this.buildIcon(values)]}",'<tpl if="this.hasActiveDefects(values)"><span class="count">{[this.getActiveDefectCount(values)]}</span> active<tpl else>&nbsp;</tpl>',"</div>","</tpl>",{hasDefects:function(recordData){return recordData&&"NONE"!==recordData.DefectStatus},hasActiveDefects:function(recordData){return this.getActiveDefectCount(recordData)>0},buildIcon:function(recordData){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"DEFECT_STATUS",icon:recordData.DefectStatus}).apply({})},getActiveDefectCount:function(recordData){var activeDefectCount=0;return recordData.Summary&&recordData.Summary.Defects&&recordData.Summary.Defects.State&&Ext.Object.each(recordData.Summary.Defects.State,function(key,val){"Closed"!==key&&(activeDefectCount+=val)}),activeDefectCount}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardDependenciesTemplate",{extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="this.getDependenciesCount(values) &gt; 0">','<span class="dependencies-template clickable">','<span class="icon-predecessor"></span>',"<span>{[this.getDependenciesCount(values)]}</span>","</span>","</tpl>",{getDependenciesCount:function(recordData){return recordData.PredecessorsAndSuccessors.Count}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardDiscussionSummaryTemplate",{extend:Ext.XTemplate,requires:[],constructor:function(){this.callParent(['<tpl if="this.hasDiscussion(values)">','<div aria-label="View {[this.getDiscussionCount(values)]} discussion posts">',"{[this.buildIcon(values)]}",'<span class="discussion-count">{[this.getDiscussionCount(values)]}</span>',"</div>","</tpl>",{hasDiscussion:function(recordData){return this.getDiscussionCount(recordData)>0},getDiscussionCount:function(recordData){var discussionCount=0;return recordData.Summary&&recordData.Summary.Discussion&&(discussionCount=recordData.Summary.Discussion.Count),discussionCount},buildIcon:function(recordData){var discussionStatus=this.getDiscussionAgeClass(recordData);return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"DISCUSSION_STATUS",icon:discussionStatus}).apply({})},getDiscussionAgeClass:function(recordData){var age=recordData.LatestDiscussionAgeInMinutes;return"undefined"==typeof age||null===age?"stale":age<240?"recent":age<2880?"less_recent":age<10080?"least_recent":"stale"}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardTaskSummaryTemplate",{extend:Ext.XTemplate,nullAttr:"-- No Entry --",constructor:function(){this.callParent(['<tpl if="this.hasTasks(values)">','<div class="status-value tasks" title="Manage Tasks">','<tpl exec="this.percentage = this.getCompletedTaskPercentage(values)"></tpl>',"{[this._buildIcon(values)]}",'<tpl if="this.percentage !== 100">','<div class="percentage">{[this.percentage]}%</div>',"</tpl>",'<tpl exec="this.toDo = this.getToDo(values)"></tpl>','<tpl if="this.toDo &gt; 0">','<tpl exec="this.toDoUnit = this.getToDoUnit()"></tpl>','<div class="separator">&nbsp;</div>','<div class="icon-to-do"></div>','<div class="to-do-value">{[this.toDo]}{[this.toDoUnit]}</div>',"</tpl>","</div>","</tpl>",{hasTasks:function(recordData){return recordData.Summary&&recordData.Summary.Tasks&&recordData.Summary.Tasks.Count>0},getCompletedTaskPercentage:function(recordData){var completedTaskCount=recordData.Summary.Tasks.State.Completed||0;return Ext.util.Format.round(completedTaskCount/recordData.Summary.Tasks.Count*100,0)},hasTaskEstimate:function(recordData){var hasEstimate=!1;return Ext.Object.each(recordData.Summary.Tasks.Estimate,function(key){if(key!==this.nullAttr)return hasEstimate=!0,!1},this),hasEstimate},getTaskStatus:function(recordData){return recordData.TaskStatus?recordData.TaskStatus:this._calculateTaskStatus(recordData)},_buildIcon:function(recordData){var taskStatus=this.getTaskStatus(recordData);return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"TASK_STATUS",icon:taskStatus}).apply({})},_calculateTaskStatus:function(recordData){var taskSummary=recordData.Summary.Tasks,hasBlocked=!1,allCompleted=!0,allDefined=!0;return Ext.isDefined(taskSummary.Blocked)&&taskSummary.Blocked.true>0&&(hasBlocked=!0),(!Ext.isDefined(taskSummary.State.Completed)||taskSummary.State.Completed<taskSummary.Count)&&(allCompleted=!1),(!Ext.isDefined(taskSummary.State.Defined)||taskSummary.State.Defined<taskSummary.Count)&&(allDefined=!1),allCompleted&&hasBlocked?"COMPLETED_BLOCKED":allCompleted?"COMPLETED":hasBlocked?"IN_PROGRESS_BLOCKED":allDefined?"DEFINED":"IN_PROGRESS"},getToDo:function(recordData){var toDo=0;return Ext.Object.each(recordData.Summary.Tasks.ToDo,function(key,val){key!==this.nullAttr&&(toDo+=Rally.data.util.Quantity.getFloatValue(key)*val)},this),parseFloat(Ext.Number.toFixed(toDo,2))},getToDoUnit:function(){return Ext.String.escape(Rally.environment.getContext().getWorkspace().WorkspaceConfiguration.TaskUnitName.charAt(0)).toLowerCase()}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardTestCaseSummaryTemplate",{
extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="this.hasTestCases(values)">','<div class="status-value testcases" title="Manage Test Cases">',"{[this._buildIcon(values)]}",'<tpl if="this.hasTestCases(values) && values.TestCaseCount !== values.PassingTestCaseCount">','<span class="count">{[values.PassingTestCaseCount]} of {[values.TestCaseCount]}</span> passing',"</tpl>","</div>","</tpl>",{hasTestCases:function(recordData){return recordData.TestCaseCount>0},_buildIcon:function(recordData){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"TEST_CASE_STATUS",icon:recordData.TestCaseStatus}).apply({})}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.CardUserStoriesTemplate",{extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="this.hasUserStories(values)">','<span class="userstories-template clickable">','<span class="icon-story"></span>',"<span>",'<tpl if="this.includesLeafStoryPlanEstimateTotal(values)">','<span class="user-story-points">{LeafStoryPlanEstimateTotal} {[this.getStoryPlanEstimateUnits(values)]} </span>','<span class="user-story-count">({[this.getUserStoryCount(values)]})</span>',"<tpl else>",'<span class="user-story-count">{[this.getUserStoryCount(values)]}</span>',"</tpl>","</span>","</span>","</tpl>",{hasUserStories:function(recordData){return this.getUserStoryCount(recordData)>0},getUserStoryCount:function(recordData){return recordData.DirectChildrenCount||recordData.LeafStoryCount||recordData.UserStories&&recordData.UserStories.Count||0},includesLeafStoryPlanEstimateTotal:function(recordData){return Ext.isDefined(recordData.LeafStoryPlanEstimateTotal)},getStoryPlanEstimateUnits:function(recordData){return recordData.context.getWorkspace().WorkspaceConfiguration.ReleaseEstimateUnitName}}])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.ChildObjectFormattedIDTemplate",{extend:Ext.XTemplate,childObjectProperty:void 0,showHover:void 0,showName:void 0,constructor:function(config){return this.callParent(["{[this.createDetailLink(values)]}",config])},createDetailLink:function(values){var childObject=values[this.childObjectProperty];if(childObject){var link=Rally.nav.DetailLink.getLink({record:childObject,text:childObject.FormattedID,showHover:!!this.showHover});return this.showName?link+": "+childObject._refObjectName:link}return"--"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.DateTemplate",{extend:Ext.XTemplate,fieldName:"",constructor:function(config){var templateConfig=["{[this.getDate(values)]}",{getDate:function(values){var TIMEZONE_TOGGLES=Rally.environment.useSystemTimezone||Rally.environment.useWorkspaceTimeZone,inputDate=values[this.fieldName],showTime=TIMEZONE_TOGGLES&&values.isDirty===!1;return TIMEZONE_TOGGLES&&values.isDirty&&"1"===values.VersionId&&(showTime=!0),Rally.util.DateTime.formatDate(inputDate,showTime)}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.DaysInThisColumnTemplate",{extend:Ext.XTemplate,constructor:function(config){var templateConfig=['<tpl if="this.shouldShowStateChangedDate(values)">','<div class="timeInState">{[this.getTimeInStateStr(values)]} in this column</div>',"</tpl>",{shouldShowStateChangedDate:function(recordData){return this.getTimeInState(recordData)>0},getTimeInStateStr:function(recordData){var timeInStateStr,timeInState=this.getTimeInState(recordData);return timeInStateStr=1===timeInState?timeInState+" day":timeInState<21?timeInState+" days":Math.floor(timeInState/7)+" weeks"},getTimeInState:function(recordData){return Rally.util.DateTime.getDifference(new Date,recordData.StateChangedDate,"day")}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.DecimalTemplate",{extend:Ext.XTemplate,fieldName:"",maxFractionalDigits:void 0,constructor:function(config){var maxFractionalDigits=config.maxFractionalDigits,templateConfig=["{[this.formatDecimal(values)]}",{formatDecimal:function(values){var value=values[this.fieldName];return Ext.isNumber(value)?maxFractionalDigits?value.toFixed(maxFractionalDigits):value:""}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.DefectSuiteStateTemplate",{extend:Ext.XTemplate,constructor:function(){var templateConfig=["{[this.getValue(values)]}",{getValue:function(recordData){var totalDefectCount=recordData.TotalDefectCount,closedDefectCount=recordData.ClosedDefectCount;return totalDefectCount>0&&_.isNumber(closedDefectCount)?closedDefectCount+"/"+totalDefectCount+" Closed":""}}];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.DisplayColorTemplate",{extend:Ext.XTemplate,constructor:function(){this.callParent(['<tpl if="DisplayColor">','<div class="display-color-content" style="background-color: {[Ext.String.htmlEncode(values.DisplayColor)]};"></div>',"<tpl else>",'<div class="display-color-content" style="border: 1px dotted #888;"></div>',"</tpl>"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.ParentTemplate",{extend:Ext.XTemplate,constructor:function(config){var templateConfig=['<tpl if="this.getParent(values)">{[this.createDetailUrl(values)]}</tpl>',{getParent:function(recordData){return recordData&&_.reduce(this.fieldNames,function(result,field){return result||recordData[field]},null)},createDetailUrl:function(recordData){var parent=this.getParent(recordData);return Rally.util.DetailLink.getLink({record:parent,showHover:!!this.showHover,text:parent.FormattedID})+": "+parent._refObjectName}},_.merge({fieldNames:["Parent","PortfolioItem"]},config)];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.FeatureTemplate",{extend:Rally.ui.renderer.template.ParentTemplate,constructor:function(config){config=config||{},config.fieldNames=[config.attributeName||"Feature"],this.callParent([config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.LastBuildTemplate",{extend:Ext.XTemplate,constructor:function(config){return this.callParent(["{[this.createLink(values)]}",config])},createLink:function(data){return data.LastBuild?this.createDetailLink(data):""},createDetailLink:function(data){var options={record:data,subPage:"testcaseresults",text:data.LastBuild,showHover:!1,showTooltip:!1};return Rally.nav.DetailLink.getLink(options)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.LastVerdictTemplate",{extend:Ext.XTemplate,constructor:function(config){return this.callParent(["{[this.getValue(values)]}",config])},getValue:function(recordData){var passing=recordData.PassingTestCaseCount,total=recordData.TestCaseCount;return _.isNumber(total)?total?"Pass: "+passing+"/"+total:"":recordData[this.field.name]}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.ObjectTemplate",{extend:Ext.XTemplate,fieldName:"",constructor:function(config){var templateConfig=['<tpl if="'+config.fieldName+" && "+config.fieldName+'._refObjectName">{'+config.fieldName+"._refObjectName}</tpl>",config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.PillTemplate",{extend:Ext.XTemplate,constructor:function(config){config=config||{};var templateConfig=['<tpl for=".">',"{[this.getPillHtml(values)]}","</tpl>",{getPillHtml:this.getPillHtml},config];return this.callParent(templateConfig)},getPillHtml:function(tagData){var colorAttr=tagData.DisplayColor?' style="color: '+tagData.DisplayColor+';"':"",iconHTML=this.iconCls?'<span class="'+this.iconCls+'"'+colorAttr+"></span>":"";return'<span class="'+(this.cls?this.cls:"")+'">'+iconHTML+tagData.Name+"</span>"},apply:function(recordData,parent){var values=this._transformValues(recordData);return this.callParent([values,parent])},_transformValues:function(recordData){var items=recordData[this.collectionName];return items=items._tagsNameArray?items._tagsNameArray?items._tagsNameArray:items:_.isArray(items)?_.map(items,function(obj){return{_ref:obj._ref||obj.get("_ref"),Name:obj.Name||obj.get("Name")}}):[],items=Rally.util.Array.sortByAttribute(items,"Name")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.TagPillTemplate",{extend:Rally.ui.renderer.template.PillTemplate,statics:{onClick:function(el,name,ref){return Ext.create("Rally.ui.popover.TagPopover",{name:name,ref:ref,placement:["bottom","right","left","top"],target:el}),!1},enableTagPopover:function(){return!1}},cls:"rui-tag-list-item",collectionName:"Tags",getPillHtml:function(tagData){var colorAttr=tagData.DisplayColor?' style="color: '+tagData.DisplayColor+';"':"",iconHTML=this.iconCls?'<span class="'+this.iconCls+'"'+colorAttr+"></span>":"",clickHandler=this.self.enableTagPopover()&&this.isBoard?this._getOnClick(tagData)+' class="clickable"':"";return'<span class="'+(this.cls?this.cls:"")+'">'+iconHTML+"<span"+clickHandler+" >"+tagData.Name+"</span></span>"},_getOnClick:function(data){return" onClick=\"Rally.ui.renderer.template.TagPillTemplate.onClick(this,'"+data.Name+"', '"+data._ref+"')\""}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.TypeDefNameTemplate",{extend:Ext.XTemplate,fieldName:"",constructor:function(config){var templateConfig=["{[this.formatString(values)]}",{formatString:function(values){var value=values[this.fieldName];return"Hierarchical Requirement"===value._refObjectName?values[this.fieldName].DisplayName:value._refObjectName}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.VisibilityOnSubprojectsTemplate",{extend:Ext.XTemplate,constructor:function(){var templateConfig=['<tpl if="this.isVisible(values)"><div class="picto icon-ok checked" alt="Checked"></div></tpl><tpl if="this.isMixed(values)">mixed</tpl>',{isVisible:function(recordData){var value=recordData.VisibilityOnChildProjects;return Ext.isString(value)&&(value=value.indexOf("visible")!==-1&&"visible"),value},isMixed:function(recordData){var value=recordData.VisibilityOnChildProjects;return Ext.isString(value)&&(value=value.indexOf("mixed")!==-1&&"mixed"),value}}];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.WebLinkTemplate",{extend:Ext.XTemplate,fieldName:"",urlWithTokens:"",shouldOpenInNewWindow:!1,constructor:function(config){var templateConfig=['<tpl if="this.getLinkText(values)"><a href="{[this.getHref(values)]}"{[this.getTarget()]}>{[this.getLinkText(values)]}</a></tpl>',{getLinkText:function(values){return values[this.fieldName].DisplayString||values[this.fieldName].LinkID},getHref:function(values){return this.urlWithTokens.replace("${id}",values[this.fieldName].LinkID)},getTarget:function(){return this.shouldOpenInNewWindow?' target="_blank"':""}},config];return this.callParent(templateConfig)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.StatusTemplate",{extend:Ext.XTemplate,inheritableStatics:{onClick:function(event,ref,popoverConfig){var oid=Rally.util.Ref.getOidFromRef(ref),target=Ext.get(event.target||event.srcElement);return Rally.ui.popover.PopoverFactory.bake(Ext.apply({target:target.up("."+Ext.baseCSSPrefix+"grid-row")||target,oid:oid,type:Rally.util.Ref.getTypeFromRef(ref),placement:["bottom","top"],offsetFromTarget:[{x:0,y:-5},{x:5,y:0},{x:0,y:5},{x:-5,y:0}]},popoverConfig)),!1}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.DefectStatusTemplate",{extend:Rally.ui.renderer.template.status.StatusTemplate,inheritableStatics:{onClick:function(event,ref){Rally.ui.renderer.template.status.StatusTemplate.onClick(event,ref,{targetSelector:".defects.cell-"+Rally.util.Ref.getOidFromRef(ref)+" a",field:"Defect"})}},constructor:function(){this.callParent(['<div class="status-value defects cell-{ObjectID}" {[this._getTitle(values)]}>','<tpl if="DefectStatus && this._shouldShowPopoverOnClick(values)">','<a href="{[this._defectDetailUrl(values)]}" onclick="{[this._getOnClick(values)]}">',"{[this._buildIcon(values)]}","</a>","<tpl else>","--","</tpl>","</div>"])},_getTitle:function(values){return values.DefectStatus&&this._shouldShowPopoverOnClick(values)?'title="View Defects"':""},_shouldShowPopoverOnClick:function(values){return"testset"!==values._type||"testset"===values._type&&"NONE"!==values.DefectStatus},_defectDetailUrl:function(values){return Rally.nav.Manager.getDetailUrl(values,{subPage:"defects"})},_buildIcon:function(values){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"DEFECT_STATUS",icon:values.DefectStatus}).apply({})},_getOnClick:function(values){return"Rally.ui.renderer.template.status.DefectStatusTemplate.onClick(event, '"+values._ref+"');return false;"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.DiscussionStatusTemplate",{extend:Rally.ui.renderer.template.status.StatusTemplate,inheritableStatics:{onClick:function(event,ref){Rally.ui.renderer.template.status.StatusTemplate.onClick(event,ref,{targetSelector:".discussion.cell-"+Rally.util.Ref.getOidFromRef(ref),field:"Discussion"})}},constructor:function(){this.callParent(["<tpl>",'<div aria-label="View {[this._getDiscussionCount(values)]} discussion posts" title="View Discussion">','<a href="{[this._getDiscussionDetailUrl(values)]}" onclick="{[this._getOnClick(values)]}">',"{[this._buildIcon(values)]}",'<span class="discussion-cnt">{[this._getDiscussionCountLabel(values)]}</span>',"</div>","</a>","</tpl>"])},_getDiscussionCollection:function(recordData){var discussionCollection=recordData.Discussion;return!discussionCollection&&recordData.Summary&&(discussionCollection=recordData.Summary.Discussion),discussionCollection},_getDiscussionCount:function(recordData){var discussionCollection=this._getDiscussionCollection(recordData),discussionCount=0;return discussionCollection&&(discussionCount=discussionCollection.Count),parseInt(discussionCount,10)},_getDiscussionCountLabel:function(recordData){var count=this._getDiscussionCount(recordData);return count||"&nbsp;"},_getGridClass:function(recordData){var count=this._getDiscussionCount(recordData),age=recordData.LatestDiscussionAgeInMinutes;return 0===count?"none":"undefined"==typeof age||null===age?"stale":age<240?"recent":age<2880?"less-recent":age<10080?"least-recent":"stale"},_buildIcon:function(recordData){var discussionStatus=this._getGridClass(recordData);return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"DISCUSSION_STATUS",icon:discussionStatus}).apply({})},_getDiscussionDetailUrl:function(recordData){return Rally.nav.Manager.getDetailUrl(recordData,{subPage:"discussion"})},_getOnClick:function(values){return"Rally.ui.renderer.template.status.DiscussionStatusTemplate.onClick(event, '"+values._ref+"');return false;"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.PredecessorsAndSuccessorsStatusTemplate",{extend:Rally.ui.renderer.template.status.StatusTemplate,inheritableStatics:{onClick:function(event,ref){Rally.ui.renderer.template.status.StatusTemplate.onClick(event,ref,{field:"PredecessorsAndSuccessors"})}},constructor:function(){this.callParent(['<tpl if="this._getDependenciesCount(values) &gt; 0">','<a onclick="{[this._getOnClick(values)]}">','<span class="predecessorsandsuccessors-cnt">{[this._getDependenciesCount(values)]}</span>',"</a>","</tpl>"])},_getDependenciesCount:function(recordData){return recordData.PredecessorsAndSuccessors.Count},_getOnClick:function(recordData){return"Rally.ui.renderer.template.status.PredecessorsAndSuccessorsStatusTemplate.onClick(event, '"+recordData._ref+"'); return false;"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.TaskStatusTemplate",{extend:Rally.ui.renderer.template.status.StatusTemplate,inheritableStatics:{onClick:function(event,ref){Rally.ui.renderer.template.status.StatusTemplate.onClick(event,ref,{targetSelector:".tasks.cell-"+Rally.util.Ref.getOidFromRef(ref)+" a",field:"Task"})}},constructor:function(){this.callParent(['<div class="status-value tasks cell-{ObjectID}" {[this._getTitle(values)]}>','<tpl if="TaskStatus">','<tpl if="this._shouldShowTaskLink(values)">','<a href="{[this._taskDetailUrl(values)]}" onclick="{[this._getOnClick(values)]}">',"</tpl>","{[this._buildIcon(values)]}",'<tpl if="this._shouldShowTaskLink(values)">',"</a>","</tpl>","<tpl else>","--","</tpl>","</div>"])},_getTitle:function(values){return values.TaskStatus?'title="View Tasks"':""},_shouldShowTaskLink:function(values){return"hierarchicalrequirement"!==values._type||0===values.DirectChildrenCount},_taskDetailUrl:function(values){return Rally.nav.Manager.getDetailUrl(values,{subPage:"tasks"})},_buildIcon:function(values){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"TASK_STATUS",icon:values.TaskStatus}).apply({})},_getOnClick:function(values){return"Rally.ui.renderer.template.status.TaskStatusTemplate.onClick(event, '"+values._ref+"');return false;"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.renderer.template.status.TestCaseStatusTemplate",{extend:Rally.ui.renderer.template.status.StatusTemplate,inheritableStatics:{onClick:function(event,ref){var config={targetSelector:".testcases.cell-"+Rally.util.Ref.getOidFromRef(ref)+" a",field:"TestCase"};Rally.ui.renderer.template.status.StatusTemplate.onClick(event,ref,config)}},constructor:function(){this.callParent(['<div class="status-value testcases cell-{ObjectID}" {[this._getTitle(values)]}>','<tpl if="TestCaseStatus">','<a href="{[this._testCaseDetailUrl(values)]}" onclick="{[this._getOnClick(values)]}">',"{[this._buildIcon(values)]}","</a>","<tpl else>","--","</tpl>","</div>"])},_getTitle:function(values){return values.TestCaseStatus?'title="View Test Cases"':""},_testCaseDetailUrl:function(values){return Rally.nav.Manager.getDetailUrl(values,{subPage:"testcases"})},_buildIcon:function(values){return Ext.create("Rally.ui.renderer.template.IconBuilderTemplate",{category:"TEST_CASE_STATUS",icon:values.TestCaseStatus}).apply({})},_getOnClick:function(values){return"Rally.ui.renderer.template.status.TestCaseStatusTemplate.onClick(event, '"+values._ref+"');return false;"}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.Runner",{constructor:function(config){this.config=config},createReportConfig:function(){var config={};Ext.Object.each(this.config.reportConfig,function(key,value){"report"!==key&&(config[key.toUpperCase()]=value)}),this.config.project&&Ext.apply(config,{project:this.config.project,projectScopeUp:this.config.projectScopeUp,projectScopeDown:this.config.projectScopeDown});var result={};return Ext.Object.each(config,function(key,value){if(Rally.util.Ref.isRefUri(value))result[key]=Rally.util.Ref.getOidFromRef(value);else if(Ext.isArray(value)){var refs=_.map(value,function(item){return Rally.util.Ref.isRefUri(item)?Rally.util.Ref.getOidFromRef(item):item});result[key]=refs.join(",")}else result[key]=value}),result},run:function(){this.config.showReportCallback(this.config.reportConfig.report.id,this.createReportConfig())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.TimeboxRunner",{extend:Rally.ui.report.Runner,constructor:function(config){config.hasOwnProperty(config.timeboxType)||(config[config.timeboxType]="current"),this.callParent([config])},run:function(){var timebox=this.config[this.config.timeboxType];if(Ext.isObject(timebox))Rally.util.DateTime.fromIsoString(this.config[this.config.timeboxType][this.config.startDateField])<new Date?this.config.projectScopeDown||this.config.projectScopeUp?Rally.data.ModelFactory.getModel({type:this.config.timeboxType,success:this._queryForSimilarTimeboxes,scope:this}):(this.config.reportConfig[this.config.timeboxQueryStringParam]=this.config[this.config.timeboxType].ObjectID,this.config.showReportCallback(this.config.reportConfig.report.id,this.createReportConfig())):this.config.showMessageCallback(this.config.futureTimeboxMessage);else if("current"===timebox){var reportConfig=this.createReportConfig();reportConfig.project=Rally.util.Ref.getOidFromRef(this.config.project),reportConfig.projectScopeUp=this.config.projectScopeUp,reportConfig.projectScopeDown=this.config.projectScopeDown,reportConfig[this.config.timeboxQueryRequireCurrentParam]=!0,this.config.showReportCallback(this.config.reportConfig.report.id,reportConfig)}else null===timebox?this.config.showMessageCallback(this.config.unscheduledBlankSlate):this.config.showMessageCallback(this.config.noTimeboxesMessage)},_queryForSimilarTimeboxes:function(model){var storeConfig={requester:this,fetch:["Project"],useShallowFetch:!0,model:model,filters:Ext.create("Rally.data.wsapi.Filter",{property:"Name",operator:"=",value:this.config[this.config.timeboxType].Name}).and(Ext.create("Rally.data.wsapi.Filter",{property:this.config.startDateField,operator:"=",value:this.config[this.config.timeboxType][this.config.startDateField]})).and(Ext.create("Rally.data.wsapi.Filter",{property:this.config.endDateField,operator:"=",value:this.config[this.config.timeboxType][this.config.endDateField]})),pageSize:200,context:{projectScopeDown:this.config.projectScopeDown,projectScopeUp:this.config.projectScopeUp,project:this.config.project}},wsapiStore=Ext.create("Rally.data.wsapi.Store",storeConfig);wsapiStore.on("load",this._onSimilarTimeboxesRetrieved,this),wsapiStore.load()},_onSimilarTimeboxesRetrieved:function(store){var timeboxes=[],projects=[];store.each(function(timebox){var timeboxRef=timebox.get("_ref"),project=timebox.get("Project");timeboxes.push(Rally.util.Ref.getOidFromRef(timeboxRef)),projects.push(Rally.util.Ref.getOidFromRef(project._ref))}),this.config.reportConfig[this.config.timeboxQueryStringParam]=timeboxes.join(","),this.config.reportConfig.projects=projects.join(","),this.config.showReportCallback(this.config.reportConfig.report.id,this.createReportConfig())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.IterationRunner",{extend:Rally.ui.report.TimeboxRunner,requires:[],constructor:function(reportConfig){var config={timeboxType:"iteration",timeboxQueryStringParam:"iterations",startDateField:"StartDate",endDateField:"EndDate",futureTimeboxMessage:"The selected iteration has not yet started.",noTimeboxesMessage:'There are no iterations defined in this project. <a href="#" class="addTimeboxLink">Add New Iteration</a>.',timeboxQueryRequireCurrentParam:"requireProjectHasCurrentIteration",unscheduledBlankSlate:"No iteration selected."};this.callParent([Ext.apply(config,reportConfig)])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.ReleaseRunner",{extend:Rally.ui.report.TimeboxRunner,requires:[],constructor:function(reportConfig){var config={timeboxType:"release",timeboxQueryStringParam:"releases",startDateField:"ReleaseStartDate",endDateField:"ReleaseDate",futureTimeboxMessage:"The selected release has not yet started.",noTimeboxesMessage:'There are no releases defined in this project. <a href="#" class="addTimeboxLink">Add New Release</a>.',timeboxQueryRequireCurrentParam:"requireProjectHasCurrentRelease",unscheduledBlankSlate:"No release selected."};this.callParent([Ext.apply(config,reportConfig)])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.StandardReportValidator",{singleton:!0,validateConfig:function(config){return _.union(this._validateSize(config,"height"),this._validateSize(config,"width"),this._validateBool(config,"projectScopeUp"),this._validateBool(config,"projectScopeDown"),this._validateRequiredFieldsProvided(config))},_validateRequiredFieldsProvided:function(config){var errors=[];if(config.reportConfig)if(config.reportConfig.report){var reportObject=Rally.ui.report.StandardReport.getReport(config.reportConfig.report);if(reportObject){var requiredFields=reportObject.required;Ext.each(requiredFields,function(requiredField){Ext.isDefined(config.reportConfig[requiredField])||errors.push(requiredField+" is a required field for report "+reportObject.name)},this)}else errors.push("Unable to find report "+config.reportConfig.report)}else errors.push("Missing required reportConfig field: report");else errors.push("Missing required field: reportConfig");return errors},_validateSize:function(config,fieldName){var errors=[],size=config[fieldName];return size?("number"!=typeof size&&errors.push(fieldName+" must be a number."),size<0&&errors.push(fieldName+" must be greater than 0"),errors):errors},_validateBool:function(config,fieldName,required){var errors=[],bool=config[fieldName];return required||"undefined"!=typeof bool?"boolean"==typeof bool||"false"===bool||"true"===bool?errors:(errors.push(fieldName+" must be a valid boolean."),errors):errors}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.report.StandardReport",{extend:Ext.Component,clientMetricsComponentTypeProperty:"_getCMComponentType",clientMetrics:[{beginMethod:"_loadReport",endEvent:"load",description:"report loaded"},{event:"click",description:"report clicked on"}],autoEl:"div",cls:"rally-report",alias:"widget.rallystandardreport",alternateClassName:"Rally.ui.StandardReport",statics:{Reports:{BuildHealth:{id:130,name:"BuildHealth",required:[]},BuildHealthByIteration:{id:160,name:"BuildHealthByIteration",required:[]},CycleLeadTime:{id:170,name:"CycleLeadTime",required:[]},DefectsByPriority:{id:28,name:"DefectsByPriority",required:[]},DefectsByState:{id:31,name:"DefectsByState",required:[]},DefectTrend:{id:122,name:"DefectTrend",required:[]},IterationBurndown:{id:4,name:"IterationBurndown",required:[],runner:"Rally.ui.report.IterationRunner"},IterationBurnup:{id:1,name:"IterationBurnup",required:[],runner:"Rally.ui.report.IterationRunner"},IterationCumulativeFlowDiagram:{id:10,name:"IterationCumulativeFlowDiagram",required:[],runner:"Rally.ui.report.IterationRunner"},IterationDefectsByPriority:{id:13,name:"IterationDefectsByPriority",required:[],runner:"Rally.ui.report.IterationRunner"},IterationDefectsByState:{id:15,name:"IterationDefectsByState",required:[],runner:"Rally.ui.report.IterationRunner"},ReleaseBurnup:{id:19,name:"ReleaseBurnup",required:[],runner:"Rally.ui.report.ReleaseRunner"},ReleaseCumulativeFlowDiagram:{id:16,name:"ReleaseCumulativeFlowDiagram",required:[],runner:"Rally.ui.report.ReleaseRunner"},ReleaseDefectTrend:{id:22,name:"ReleaseDefectTrend",required:[],runner:"Rally.ui.report.ReleaseRunner"},StoryBurndown:{id:34,name:"StoryBurndown",required:["story"]},StoryBurnup:{id:3e3,name:"StoryBurnup",required:["story"]},StoryCumulativeFlowDiagram:{id:37,name:"StoryCumulativeFlowDiagram",required:["story"]},TaggedStoryBurndown:{id:43,name:"TaggedStoryBurndown",required:["tag"]},Throughput:{id:180,name:"Throughput",required:[]},TopFilesByChanges:{id:140,name:"TopFilesByChanges",required:[]},TopFilesByDefects:{id:150,name:"TopFilesByDefects",required:[]},VelocityChart:{id:7,name:"VelocityChart",required:[]}},getReport:function(report){var reportReturnValue=null;return Ext.Object.each(Rally.ui.report.StandardReport.Reports,function(reportName,reportConfig){(report===reportConfig||Ext.isObject(report)&&report.id===reportConfig.id||Ext.isNumber(report)&&report===reportConfig.id||Ext.isString(report)&&(report.toLowerCase()===reportName.toLowerCase()||parseInt(report,10)===reportConfig.id))&&(reportReturnValue=reportConfig)}),reportReturnValue}},initComponent:function(){this.callParent(arguments),this.addEvents("load"),this.initialConfig.clickable&&this.addEvents("click")},_loadReport:function(reportId,reportOptions){var reportUrl=this._buildReportUrl(reportId,reportOptions);this.reportFrame=this.getEl().createChild({tag:"iframe",cls:"frame",frameBorder:0}),this._isExternal()?Rally.environment.getIoProvider().httpGet({url:reportUrl,success:function(response){var iframeDoc=this.reportFrame.dom.contentWindow.document,server=Rally.environment.getServer(),reportSrc=response.responseText.replace(new RegExp(server.getContextPath(),"gi"),server.getContextUrl());iframeDoc.open(),iframeDoc.write(reportSrc),iframeDoc.close(),Ext.defer(this._onLoad,10,this)},scope:this}):(this.reportFrame.on("load",this._onLoad,this,{delay:10}),this.reportFrame.set({src:reportUrl}))},_buildReportUrl:function(reportId,reportOptions){var serverInfo=Rally.environment.getServer();return serverInfo.getContextUrl()+"/analytics/reports/"+reportId+"/run?"+Ext.Object.toQueryString(reportOptions)},_showMessage:function(message){var el=this.getEl();el&&(el.unmask(),this.messages=el.createChild({tag:"div",cls:"no-data message",html:"<p>"+message+"</p>"}),this.messages.select("a.addTimeboxLink").on("click",this.onAddTimeboxLinkClicked,this),this.fireEvent("load",this,{}))},onAddTimeboxLinkClicked:function(e){e&&e.preventDefault&&e.preventDefault();var timeboxType=this.hasOwnProperty("iteration")?"iteration":"release";Rally.nav.Manager.create(timeboxType,{})},_prepareReport:function(suppressMask){var validationErrors=Rally.ui.report.StandardReportValidator.validateConfig(this.initialConfig);if(!validationErrors.length){this.setSize(this.initialConfig.width,this.initialConfig.height),suppressMask||this.getEl().mask("Loading...");var report=Rally.ui.report.StandardReport.getReport(this.initialConfig.reportConfig.report);this.initialConfig.reportConfig.report=report;var reportRunnerType=report.runner||"Rally.ui.report.Runner",reportRunnerConfig=Ext.apply({showReportCallback:Ext.bind(this._loadReport,this),showMessageCallback:Ext.bind(this._showMessage,this)},this.initialConfig);this.rendered?(reportRunnerConfig.reportConfig.height=this.height-15,reportRunnerConfig.reportConfig.width=this.width-32):(this.config.height&&(reportRunnerConfig.reportConfig.height=this.config.height),this.config.width&&(reportRunnerConfig.reportConfig.width=this.config.width)),"hide"!==reportRunnerConfig.reportConfig.legend&&(reportRunnerConfig.reportConfig.height-=150),reportRunnerConfig.reportConfig.height=Math.min(599,reportRunnerConfig.reportConfig.height),reportRunnerConfig.reportConfig.width=Math.min(999,reportRunnerConfig.reportConfig.width);var reportRunner=Ext.create(reportRunnerType,reportRunnerConfig);reportRunner.run()}},onRender:function(){this.callParent(arguments),this._prepareReport()},refresh:function(config,suppressMask){var reportConfig=Ext.apply({},config.reportConfig,this.initialConfig.reportConfig);Ext.apply(this.initialConfig,config),this.initialConfig.reportConfig=reportConfig,this.reportFrame&&(this.reportFrame.remove(),delete this.reportFrame),this.messages&&(this.messages.remove(),delete this.messages),this._prepareReport(suppressMask)},_onLoad:function(){if(this.getEl()&&this.getEl().unmask(),!this._isExternal()&&this.reportFrame&&this.reportFrame.dom&&this.reportFrame.dom.contentWindow){var reportContent=this.reportFrame.dom.contentWindow,docEl=Ext.fly(reportContent.document);if(docEl&&(docEl.relayEvent(Ext.EventManager.getKeyEvent(),this),this.initialConfig.clickable)){docEl.on("click",this._onClick,this);var bodyEl=Ext.fly(reportContent.document.body);bodyEl&&bodyEl.setStyle({cursor:"pointer"})}}this.fireEvent("load",this,{})},_onClick:function(){this.fireEvent("click",this,{})},_getCMComponentType:function(){var type=null!==this.reportConfig&&null!==this.reportConfig.report?this.reportConfig.report.name:null;return type||"StandardReport"},_isExternal:function(){return Rally.getSdkInfo().apiKey&&Rally.environment.isExternal()}})}(),function(){
var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.richtext.RichTextEditorReadOnly",{extend:Ext.Component,mixins:{field:Ext.form.field.Field},alias:"widget.rallyrichtexteditorreadonly",maskOnDisable:!1,cls:"rich-text-readonly",constructor:function(config){config.html="<table><tbody><tr><td>"+config.html+"</td></tr></tbody></table>",this.mergeConfig(config),this.value=config.html,this.callParent([this.config])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.richtext.templates.RichTextEditorTemplatesDialog",{alias:"widget.rallyrichtexteditortemplatesdialog",extend:Rally.ui.dialog.Dialog,autoShow:!0,closable:!0,cls:"rich-text-editor-templates-dialog",defaultFocus:"newTemplateNameTextField",height:500,overflowY:"auto",title:"Templates",constructor:function(config){var dialog=this;this.callParent([Ext.merge({},config,{items:[{xtype:"container",items:[{xtype:"rallytextfield",cls:"new-template-name-text-field",emptyText:"Name",fieldLabel:"New from current",height:30,itemId:"newTemplateNameTextField",labelPad:10,listeners:{change:this._onNewTemplateNameChange,scope:this,specialkey:this._onNewTemplateNameSpecialKey},width:717},{xtype:"rallybutton",cls:"primary rly-small new-template-create-button",disabled:!0,handler:this._onCreateButtonClick,itemId:"newTemplateCreateButton",margin:"4 0 0 10",scope:this,text:"Create",userAction:"added new rich text template"}],layout:"hbox"},{xtype:"rallygrid",columnCfgs:[{xtype:"rallyrowactioncolumn",rowActionsFn:function(record){return[{text:"Delete",handler:function(){dialog.fireEvent("deletetemplaterequest",dialog,record.get("templateId")),record.store.remove(record)}}]}},{dataIndex:"name",text:"Name",width:150},{dataIndex:"value",text:"Text",width:500},{renderer:function(){return'<div class="set-default-button-ct"></div>'},text:"Set as Default",width:50},{renderer:function(){return'<div class="apply-template-button-ct"></div>'},width:74}],editable:!1,enableColumnHide:!1,enableColumnMove:!1,enableEditing:!1,listenForObjectUpdates:!1,listeners:{scope:this,viewready:this._onGridViewReady},sortableColumns:!1,showPagingToolbar:!1,showRowActionsColumn:!1,store:Ext.create("Rally.data.custom.Store",{data:_.map(config.templates,function(template){return _.merge({deletable:!0},template)})}),width:800}]})])},initComponent:function(){this.callParent(arguments),this.addEvents("applytemplaterequest","createtemplaterequest","defaulttemplaterequest","deletedefaulttemplaterequest","deletetemplaterequest")},_onCreateButtonClick:function(){this.fireEvent("createtemplaterequest",this,this.down("#newTemplateNameTextField").getValue()),this.close()},_onGridViewReady:function(grid){var setDefaultButtonCts=grid.getEl().query(".set-default-button-ct"),applyTemplateButtonCts=grid.getEl().query(".apply-template-button-ct"),setDefaultCheckboxes=[];_.each(grid.getStore().getRange(),function(record,index){setDefaultCheckboxes.push(Ext.create("Ext.form.field.Checkbox",{cls:"set-default-template-checkbox",disabled:!this.canSetDefaults,handler:function(checkbox,isChecked){var otherCheckedCheckbox=_.find(setDefaultCheckboxes,function(otherCheckbox){return otherCheckbox!==checkbox&&otherCheckbox.getValue()});isChecked?(this.fireEvent("defaulttemplaterequest",this,record.get("templateId")),otherCheckedCheckbox&&otherCheckedCheckbox.setValue(!1)):otherCheckedCheckbox||this.fireEvent("deletedefaulttemplaterequest",this)},name:"defaultRichTextTemplate",renderTo:setDefaultButtonCts[index],scope:this,value:record.get("isDefault")})),Ext.create("Rally.ui.Button",{cls:"secondary rly-small",handler:function(){this.fireEvent("applytemplaterequest",this,record.get("value")),this.close()},renderTo:applyTemplateButtonCts[index],scope:this,text:"Apply"})},this),this.doLayout()},_onNewTemplateNameChange:function(textField,newValue){this.down("#newTemplateCreateButton").setDisabled(!newValue.trim())},_onNewTemplateNameSpecialKey:function(textField,e){e.getKey()!==e.ENTER||this.down("#newTemplateCreateButton").isDisabled()||this._onCreateButtonClick()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.selection.TriStateModel",{extend:Ext.selection.Model,alias:"widget.rallytristatemodel",config:{mode:"SIMPLE",initialPartialSelection:[]},partialSelection:[],fullSelection:[],isPartiallySelected:function(record){return this.isSelected(record)&&_.contains(this.partialSelection,record)},isFullySelected:function(record){return this.isSelected(record)&&!this.isPartiallySelected(record)},getSelectionByState:function(){return _.groupBy(this.getSelection(),function(record){return _.contains(this.partialSelection,record)?"partial":"full"},this)},onSelectChange:function(record,selecting,suppressEvent,commitFn){selecting?this._handleSelect(record,suppressEvent,commitFn):this._handleDeselect(record,suppressEvent,commitFn)},_handleSelect:function(record,suppressEvent,commitFn){(suppressEvent||this.fireEvent("beforeselect",this,record)!==!1)&&(_.contains(this.initialPartialSelection,record)&&!_.contains(this.fullSelection,record)&&this._partiallySelect(record),Ext.callback(commitFn,this),suppressEvent||this.fireEvent("select",this,record))},_handleDeselect:function(record,suppressEvent,commitFn){return this.isPartiallySelected(record)?(this._fullySelect(record),void(suppressEvent||this.fireEvent("selectionchange",this,this.getSelection()))):void((suppressEvent||this.fireEvent("beforedeselect",this,record)!==!1)&&(_.pull(this.fullSelection,record),Ext.callback(commitFn,this),suppressEvent||this.fireEvent("deselect",this,record)))},_fullySelect:function(record){_.pull(this.partialSelection,record),_.contains(this.fullSelection,record)||this.fullSelection.push(record)},_partiallySelect:function(record){_.pull(this.fullSelection,record),_.contains(this.partialSelection,record)||this.partialSelection.push(record)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.SelectedProjectList",{extend:Rally.ui.multichooser.AbstractList,alias:"widget.rallyselectedprojectlist",controller:"Rally.ui.multichooser.SelectedListController",cls:"rui-selected-tags-bound-list",constructor:function(config){this.selModel=Ext.create("Rally.ui.selection.TriStateModel"),this.callParent(arguments)},initComponent:function(){this.callParent(arguments),this.mon(this.getSelectionModel(),"selectionchange",this._applySelection,this),this.on("ready",this._onReady,this)},getSelectedProjects:function(){var store=this.getStore();return store.isFiltered()?store.snapshot.getRange():store.getRange()},deselectAll:function(){this.getSelectionModel().deselectAll()},onBeforeItemClick:function(record){return this.callParent(arguments)!==!1&&!this._getCheckboxForRecord(record).hasCls("rly-disabled")},onItemClick:function(record){this.callParent(arguments),this.getSelectionModel().deselect(record)},setInitialPartialSelection:function(partialSelection){this.getSelectionModel().setInitialPartialSelection(partialSelection)},_onReady:function(){this.on("refresh",this._applySelection,this),this.mon(this.getStore(),"datachanged",this._onStoreDataChanged,this)},_onStoreDataChanged:function(store,opts){this.getSelectionModel().selectAll()},_getCheckboxForRecord:function(record){var itemNode=this.getNode(record);return itemNode&&Ext.get(itemNode.children[0])},_markSelected:function(record){var checkbox=this._getCheckboxForRecord(record);checkbox&&(checkbox.removeCls("icon-partial"),checkbox.addCls("icon-ok"))},_applySelection:function(){_.each(this.getStore().getRange(),function(record){this._markSelected(record);var checkbox=this._getCheckboxForRecord(record);checkbox&&Ext.isFunction(this.recordEnabled)&&!this.recordEnabled(record)&&checkbox.addCls("rly-disabled")},this)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.ListContainerController",{extend:Rally.ui.ViewController,mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},control:{availableProjectList:{ready:"_onAvailableProjectListReady",highlightitem:"_onListHighlightItem",select:"_onAvailableProjectListSelect",storeload:"_onAvailableProjectListStoreLoad"},selectedProjectList:{highlightitem:"_onListHighlightItem",deselect:"_onSelectedProjectListDeselect"},noItemsAvailableMessage:{}},init:function(){this.callParent(arguments)},getSelectedProjects:function(){return this.getSelectedProjectList().getSelectedProjects()},filter:function(term){this.recordLoadBegin({description:"filtering list container"}),Deft.Promise.all([this.getAvailableProjectList().filter(term),this.getSelectedProjectList().filter(term)]).then({success:function(){this.clearHighlight(),this.moveHighlight("down"),this._onProjectListRefresh(),this.recordLoadEnd()},scope:this})},moveHighlight:function(direction){var record=this.highlightedRecord?this._getNextRecord(direction):this._getFirstRecord(direction);record&&this.getView().highlightItem(this._getListContainingRecord(record),record)},_getFirstRecord:function(direction){var record;return record="up"===direction?this.getAvailableProjectList().getStore().last()||this.getSelectedProjectList().getStore().last():this.getSelectedProjectList().getStore().first()||this.getAvailableProjectList().getStore().first(),record||this.getView().fireEvent("beforewrap",this.getView()),record},_getNextRecord:function(direction){var fromList=this._getListContainingRecord(this.highlightedRecord),otherList=this._otherListFrom(fromList),currentIndex=fromList?fromList.indexOf(this.highlightedRecord):0,nextIndex="up"===direction?currentIndex-1:currentIndex+1,record=fromList?fromList.getStore().getAt(nextIndex):null;if(!record){var method="up"===direction?"last":"first";if(record=otherList.getStore()[method]()||fromList.getStore()[method](),toList=this._getListContainingRecord(record),this._isWrapping(direction,toList,fromList)&&!this.getView().fireEvent("beforewrap",this.getView()))return!1}return record},_isWrapping:function(direction,toList,fromList){var decisiveList="down"===direction?this.getSelectedProjectList():this.getAvailableProjectList();return toList===fromList||toList!==fromList&&toList===decisiveList},selectHighlightedRecord:function(){return!!this.highlightedRecord&&this.selectRecord(this.highlightedRecord)},selectRecord:function(record){return this.getSelectedProjectList().getStore().indexOf(record)>-1?(this.getSelectedProjectList().deselect(record),record):this.getAvailableProjectList().getStore().indexOf(record)>-1&&(this.getAvailableProjectList().select(record),record)},hasExactMatch:function(term){return!!term&&(this.getAvailableProjectList().getStore().findExact("Name",term)!==-1||this.getSelectedProjectList().getStore().findExact("Name",term)!==-1)},addRecord:function(record){this.getSelectedProjectList().addListItem(record),this.getSelectedProjectList().highlightItemByRecord(record)},clearHighlight:function(){this.getSelectedProjectList().clearHighlight(),this.getAvailableProjectList().clearHighlight(),delete this.highlightedRecord},hasHighlightedRecord:function(){return!!this.highlightedRecord},getHighlightedRecord:function(){return this.highlightedRecord},deselectProject:function(record){this.getSelectedProjectList().removeListItem(record),this.getAvailableProjectList().addListItem(record),this.getAvailableProjectList().highlightItemByRecord(record),this._onProjectListRefresh()},selectProject:function(record,suppressHighlight){this.getAvailableProjectList().removeListItem(record),this.getSelectedProjectList().addListItem(record),_.isArray(record)&&(record=record[0]),suppressHighlight||this.getSelectedProjectList().highlightItemByRecord(record),this._onProjectListRefresh()},highlightItem:function(list,record){this.highlightedRecord=record,this._otherListFrom(list).clearHighlight(),this.getView().fireEvent("highlightitem",this.getView(),record)},_buildProjectRecord:function(project){var model=this.getAvailableProjectList().getStore().model;return new model(project)},setSelectionFromArtifactRecords:function(sharedProjects){this.recordLoadBegin({description:"selecting projects from artifactRecords"}),_.each(sharedProjects,function(project){this.selectProject(this._buildProjectRecord(project),!0)},this),this.getAvailableProjectList().refresh(),this._onProjectListRefresh(),this.recordLoadEnd()},_onSelectedProjectListDeselect:function(list,record){this.recordAction({description:"clicking item to deselect it from selected list",component:this.getView()}),this.deselectProject(record),this.getView().fireEvent("valuechanged",this.getSelectedProjects())},_onAvailableProjectListSelect:function(selectionModel,record,opts){this.recordAction({description:"clicked item to select it from available list",component:this.getView()}),this.selectProject(record),this.getView().fireEvent("valuechanged",this.getSelectedProjects())},_onListHighlightItem:function(list,node,opts){this.highlightItem(list,list.getRecord(node))},_onAvailableProjectListReady:function(){this._availableListLoaded=!0,this._allStoresLoaded()},_allStoresLoaded:function(){this._availableListLoaded&&(this.setSelectionFromArtifactRecords(this.getView().getSharedProjects()),this.getView().fireEvent("ready",this.getView()))},_onAvailableProjectListStoreLoad:function(list,e){list.removeListItem(this.getSelectedProjectList().getStore().getRange())},_getListContainingRecord:function(record){return this.getSelectedProjectList().getStore().indexOf(record)>-1?this.getSelectedProjectList():this.getAvailableProjectList().getStore().indexOf(record)>-1?this.getAvailableProjectList():null},_otherListFrom:function(list){return list===this.getSelectedProjectList()?this.getAvailableProjectList():this.getSelectedProjectList()},_onProjectListRefresh:function(){this.getView().toggleNoItemsAvailableMessage(0===this.getSelectedProjectList().getStore().getCount()&&0===this.getAvailableProjectList().getStore().getCount())}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.plugin.ScopedProjectSelect",{extend:Ext.AbstractPlugin,alias:"plugin.rallyscopedprojectselect",mixins:{recordable:Rally.clientmetrics.ClientMetricsRecordable},config:{context:{path:""}},init:function(cmp){this.callParent(arguments),this.cmp=cmp,this.cmp.mon(this.cmp.getSelectedProjectList(),"beforeitemclick",this._beforeSelectedItemClick,this),this.cmp.mon(this.cmp.getAvailableProjectList(),"beforeitemclick",this._beforeAvailableItemClick,this)},_beforeAvailableItemClick:function(boundlist,record,item,index,e,eOpts){return!e.shiftKey||(e.stopEvent(),this.recordAction({description:"selecting scoped projects",component:this.cmp}),this._getAllScopedProjects(record,this._selectScopedProjects),!1)},_beforeSelectedItemClick:function(boundlist,record,item,index,e,eOpts){return!e.shiftKey||(e.stopEvent(),this.recordAction({description:"deselecting scoped projects",component:this.cmp}),this._getAllScopedProjects(record,this._deselectScopedProjects),!1)},_getAllScopedProjects:function(parentRecord,callback){Ext.Ajax.request({url:this.context.path+"/pjt/scopedProjects.sp",params:{rootProjectOid:parentRecord.getId()},success:callback,scope:this})},_deselectProjects:function(projectRecords){_.each(projectRecords,function(project){this.cmp.deselectProject(project)},this)},_selectScopedProjects:function(response){var projectRecordArray=this._filterUnselectedProjects(response);this.cmp.setSelectionFromArtifactRecords(projectRecordArray),this.cmp.fireEvent("valuechanged",this.cmp.getSelectedProjects())},_deselectScopedProjects:function(response){var projectsToRemove=this._getProjectsToRemove(response);this._deselectProjects(projectsToRemove),this.cmp.fireEvent("valuechanged",this.cmp.getSelectedProjects())},_filterUnselectedProjects:function(response){var projectOidToNameMap=JSON.parse(response.responseText),currentSelectedOids=_.invoke(this.cmp.getSelectedProjects(),"get","ObjectID");return _.reduce(projectOidToNameMap,function(results,name,oid){return _.contains(currentSelectedOids,Number(oid))||results.push({ObjectID:oid,Name:name}),results},[])},_getProjectsToRemove:function(response){var currentSelectedProjects=this.cmp.getSelectedProjects(),projectOidsToRemove=_.map(JSON.parse(response.responseText),function(name,oid){return Number(oid)});return _.reduce(currentSelectedProjects,function(results,project){return _.contains(projectOidsToRemove,project.get("ObjectID"))&&results.push(project),results},[])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.ListContainer",{extend:Ext.container.Container,alias:"widget.rallysharedprojectchooserlistcontainer",controller:"Rally.ui.sharedprojectchooser.ListContainerController",cls:"rui-shared-project-chooser-list-ct",config:{sharedProjects:null,context:null},clientMetrics:[{endEvent:"ready",description:"list container ready"}],constructor:function(config){this.mergeConfig(config),this.items=[_.merge({xtype:"rallyselectedprojectlist",itemId:"selectedProjectList",hidden:!0},this.selectedConfig),_.merge({xtype:"rallyavailablelist",itemId:"availableProjectList"},this.availableConfig),{xtype:"component",itemId:"noItemsAvailableMessage",html:this.noItemsAvailableText,hidden:!0,cls:"rui-tag-chooser-empty-list"}],this.plugins=[{ptype:"rallyscopedprojectselect",context:this.context}],this.callParent(arguments)},getSelectedProjectList:function(){return this.down("#selectedProjectList")},getAvailableProjectList:function(){return this.down("#availableProjectList")},scrollIntoView:function(list,record){var node=list.getNodeByRecord(record);node&&Ext.fly(node).scrollIntoView(this.getEl())},highlightItem:function(list,record){record&&(this.scrollIntoView(list,record),list.highlightItemByRecord(record))},getSelectedProjects:function(){return this.getController().getSelectedProjects()},moveHighlight:function(direction){return this.getController().moveHighlight(direction)},selectRecord:function(record){return this.getController().selectRecord(record)},deselectProject:function(project){return this.getController().deselectProject(project)},addRecord:function(record){return this.getController().addRecord(record)},selectHighlightedRecord:function(){return this.getController().selectHighlightedRecord()},clearHighlight:function(){return this.getController().clearHighlight()},hasHighlightedRecord:function(){return this.getController().hasHighlightedRecord()},getHighlightedRecord:function(){return this.getController().getHighlightedRecord()},filter:function(term){return this.getController().filter(term)},hasExactMatch:function(term){return this.getController().hasExactMatch(term)},setSelectionFromArtifactRecords:function(artifactRecords){return this.getController().setSelectionFromArtifactRecords(artifactRecords)},toggleNoItemsAvailableMessage:function(show){var msg=this.down("#noItemsAvailableMessage");show?msg.show():msg.hide()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.SharedProjectChooserController",{extend:Rally.ui.ViewController,mixins:{clientMetrics:Rally.clientmetrics.ClientMetricsRecordable},control:{projectFilter:{blur:"_onProjectFilterBlur",change:"_onProjectFilterChange",keyup:"_onProjectFilterKeyUp",keydown:"_onProjectFilterKeyDown"},projectListContainer:{highlightitem:"_onProjectListContainerHighlightItem",ready:"_onProjectListContainerReady"}},constructor:function(){this.mergeControl(),this.callParent(arguments)},getSelectedProjects:function(){return this.getProjectListContainer().getSelectedProjects()},filter:function(term){this.getProjectListContainer().filter(term.trim())},selectHighlightedRecord:function(){var record=this.getProjectListContainer().getHighlightedRecord();record&&(this.getProjectFilter().setValue(null),this.getProjectListContainer().selectRecord(record))},_onProjectListContainerHighlightItem:function(){this.getProjectFilter().focus()},_onProjectListContainerReady:function(){this._ready||(this.getView().fireEvent("ready",this.getView()),this._ready=!0)},_onProjectFilterChange:function(textField,event,opts){this.recordAction({description:"filtering projects",component:this.getView()}),this.filter(textField.getValue())},_onProjectFilterBlur:function(){this.getProjectListContainer().clearHighlight()},_onProjectFilterKeyUp:function(textField,event,opts){event.getKey()===event.ENTER&&(this.recordAction({description:"highlight record using enter key",component:this.getView()}),this.selectHighlightedRecord())},_onProjectFilterKeyDown:function(textField,event,opts){switch(event.getKey()){case event.ENTER:event.stopEvent();break;case event.UP:this.recordAction({description:"highlighting record above",component:this.getView()}),this.getProjectListContainer().moveHighlight("up");break;case event.DOWN:this.recordAction({description:"highlighting record below",component:this.getView()}),this.getProjectListContainer().moveHighlight("down")}}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.sharedprojectchooser.SharedProjectChooser",{extend:Ext.container.Container,alias:"widget.rallysharedprojectchooser",clientMetrics:[{endEvent:"ready",description:"shared projects chooser shown"}],controller:"Rally.ui.sharedprojectchooser.SharedProjectChooserController",cls:"rui-shared-project-chooser",config:{width:500,sharedProjects:null,administratableProjectsOnly:!1,context:null},layout:{type:"vbox",align:"stretch"},constructor:function(config){this.listConfig=this.listConfig||{},this.mergeConfig(config),this.items=[{xtype:"rallytextfield",itemId:"projectFilter",cls:"rui-shared-project-chooser-filter",shadow:!1,border:!1,emptyText:this.emptyText,enableKeyEvents:!0,checkChangeBuffer:250},{xtype:"rallysharedprojectchooserlistcontainer",itemId:"projectListContainer",margin:"-5 0 0 0",maxHeight:250,autoScroll:!0,noItemsAvailableText:this.listConfig.noItemsAvailableText,controllerConfig:this.listConfig.controllerConfig,selectedConfig:{listTitle:"SELECTED",controllerConfig:{type:this._getEndpoint()}},availableConfig:{listTitle:"AVAILABLE",controllerConfig:{type:this._getEndpoint(),storeConfig:{fetch:"Name, ObjectID"}}},sharedProjects:this.sharedProjects,context:this.context,listeners:this.listConfig.listeners}],this.callParent(arguments)},_getEndpoint:function(){return this.getAdministratableProjectsOnly()?"AdministratableProject":"Project"},initComponent:function(){this.addEvents("valuechanged"),this.callParent(arguments),this.on("afterlayout",this._afterLayout,this,{single:!0}),this.relayEvents(this.down("#projectListContainer"),["valuechanged"])},deselectAll:function(){this.down("rallyselectedprojectlist").deselectAll()},_afterLayout:function(){this.setLoading(!0),this.on("ready",this._onReady,this)},afterRender:function(){this.setLoading(!0),this.on("ready",this._onReady,this),this.callParent(arguments)},getSelectedProjects:function(){return this.getController().getSelectedProjects()},_onReady:function(){this.setLoading(!1),this.metricsComponent&&this.metricsComponent.recordEditorLoadEnd&&this.metricsComponent.recordEditorLoadEnd()}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tooltip.UserToolTip",{extend:Rally.ui.tooltip.ToolTip,minWidth:250,config:{showOnClick:!0},cls:"user-tooltip",constructor:function(config){config=Ext.apply({loader:{autoLoad:!1,url:Rally.environment.getServer().contextPath+"/user/imtooltip/read.sp",params:{oid:config.userOid},success:this._onLoaderLoad,scope:this}},config),this.callParent([config])},initComponent:function(){this.callParent(arguments),this.on("show",this._onShow,this)},_onShow:function(){this.loader.load()},_onLoaderLoad:function(){var me=this;me.getEl().select("a").each(function(el){el.on("click",function(){me.hide()})})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.TreeItem",{extend:Ext.Container,alias:"widget.rallytreeitem",mixins:{messageable:Rally.Messageable},cls:"treeItem",clientMetrics:[{event:"expand",description:"expanded"},{event:"collapse",description:"collapsed"},{method:"_showActionMenu",description:"clicked gear menu"}],config:{record:void 0,parentTreeItem:void 0,canExpandFn:Ext.emptyFn,scope:void 0,canDrag:!1,canDropOnMe:!1,expanded:!1,selectable:!1,actionsForRecordFn:null,displayedFields:["Name"]},constructor:function(config){this.mergeConfig(config),this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addCls(Rally.util.Test.toBrowserTestCssClass(this.getRecord().getId())),this.addEvents("expand","collapse","draw","select"),this.on("afterrender",function(){this.draw(),this.getExpanded()&&this.fireEvent("expand",this)},this)},onDestroy:function(){this.callParent(arguments);var store=this.getRecord().store;store&&store.remove(this.getRecord()),this.menu&&(this.menu.destroy(),delete this.menu)},draw:function(){this.content&&this.content.destroy();var cls="treeItemContent";this.getSelectable()&&(cls+=" selectable"),this.expander?this.toggleExpander():this.expander=this.drawExpander(),this.content=this.insert(1,{xtype:"component",itemId:"treeItemContent",cls:cls,renderTpl:this.getContentTpl(),renderData:this.getRenderData(),listeners:{afterrender:function(){this.setupListeners(),this.fireEvent("draw")},scope:this}})},drawExpander:function(){return this.add({xtype:"component",autoEl:"span",renderTpl:this.getExpanderTpl(),renderSelectors:{link:"a"},listeners:{click:{element:"link",fn:this.expandOrCollapse,stopEvent:!0},scope:this}})},toggleExpander:function(){if(this.expander.rendered){var expander=this.expander.getEl().down("a");this.canExpand()?expander.show():expander.hide(),this.getExpanded()?(expander.addCls("collapseTriangle"),expander.removeCls("expandTriangle")):(expander.addCls("expandTriangle"),expander.removeCls("collapseTriangle"))}},getExpanderTpl:function(){var me=this;return Ext.create("Ext.XTemplate",'<a href="#" <tpl if="!this.canExpand()">style="display: none" </tpl>class="expander {[this.expandOrCollapse()]}"></a>',{canExpand:function(){return me.canExpand()},expandOrCollapse:function(){return me.getExpanded()?"collapseTriangle":"expandTriangle"}})},getContentTpl:function(){var me=this;return Ext.create("Ext.XTemplate",'<tpl if="this.canDrag()"><div class="icon drag"></div></tpl>',"{[this.getActionsGear()]}",'<div class="textContent ellipses">{[this.getFormattedId()]} {[this.getSeparator()]}{Name}</div>','<div class="rightSide">',"</div>",{canDrag:function(){return me.getCanDrag()},getActionsGear:function(){return me._buildActionsGearHtml()},getFormattedId:function(){var record=me.getRecord();return record.getField("FormattedID")?Rally.ui.renderer.RendererFactory.renderRecordField(record,"FormattedID"):""},getSeparator:function(){return this.getFormattedId()?"- ":""}})},_buildActionsGearHtml:function(){var hasPermissions=this.getRecord().get("creatable")||this.getRecord().get("updatable")||this.getRecord().get("deletable");return hasPermissions?'<div class="row-action icon"></div>':""},getRenderData:function(){return this.getRecord().data},setupListeners:function(){var content=this.down("#treeItemContent"),rowAction=content.getEl().down(".row-action");rowAction&&rowAction.on("click",this._showActionMenu,this,{stopEvent:!0}),this.getSelectable()&&content.getEl().on("click",this._selectTreeItem,this)},_selectTreeItem:function(event){var target=Ext.get(event.getTarget());target.is("a")||this.fireEvent("select",this)},_showActionMenu:function(event,el){var defaultOptions={owningEl:el,record:this.getRecord(),rankRecordHelper:{findRecordToRankAgainst:Rally.data.Ranker.getFindRankedRecordFn(this.getRecord().store),getMoveToPositionStore:function(){return Deft.Promise.when(this.getRecord().store)},scope:this}};this.getActionsForRecordFn()?this.menu=Ext.create("Rally.ui.menu.RecordMenu",Ext.apply({items:this.getActionsForRecordFn().call(this.getScope(),this.getRecord())},defaultOptions)):this.menu=Ext.create("Rally.ui.menu.DefaultRecordMenu",defaultOptions),this.menu.showBy(this.getEl().down(".row-action"))},expandOrCollapse:function(){this.fireEvent(this.getExpanded()?"collapse":"expand",this),this.setExpanded(!this.getExpanded()),this.toggleExpander()},getChildrenContainer:function(){var childrenContainer=this.down("#childItemContainer");return childrenContainer||(childrenContainer=this.add({xtype:"container",itemId:"childItemContainer",cls:"childItemContainer"})),childrenContainer},addChildItem:function(treeItem,insertIndex){var childrenContainer=this.getChildrenContainer();treeItem.on("remove",this.toggleExpander,this),childrenContainer.insert(insertIndex,treeItem),this.store.add(treeItem.getRecord())},insertChildItemByRank:function(treeItem,callback,scope){if(!this.getExpanded())return!1;if(this.isRankable()){var childrenContainer=this.getChildrenContainer(),childrenItems=childrenContainer.items.getRange(),insertIndex=_.sortedIndex(_.sortBy(childrenItems,this.getRank),treeItem,this.getRank);this.addChildItem(treeItem,insertIndex)}else this.addChildItem(treeItem);return this.reloadAndDraw(callback,scope),!0},removeChildItems:function(){var childrenContainer=this.down("#childItemContainer");childrenContainer&&childrenContainer.destroy()},removeChildItem:function(treeItem){var childrenContainer=this.down("#childItemContainer");childrenContainer&&childrenContainer.remove(treeItem,!1)},canExpand:function(){return this.getCanExpandFn().call(this.getScope(),this.getRecord())},reloadAndDraw:function(callback,scope){this.getRecord().self.load(this.getRecord().getId(),{context:{project:this.getRecord().get("Project")._ref},success:function(record){this.handleReloadAndDraw(record),Ext.callback(callback,scope)},scope:this})},handleReloadAndDraw:function(record){var store=this.getRecord().store;store&&(store.remove(this.getRecord()),store.add(record)),this.setRecord(record),this.draw()},isRankable:function(){return Rally.data.Ranker.isDnDRankable(this.store)},getRank:function(item){var record=item.getRecord(),rankField=Rally.data.Ranker.getRankField(record.self);return record.get(rankField)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.PlainTreeItem",{extend:Rally.ui.tree.TreeItem,alias:"widget.rallyplaintreeitem",getContentTpl:function(){return Ext.create("Ext.XTemplate",'<div class="plainTextContent ellipses">{Name}</div>')}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.PortfolioItemTreeItem",{extend:Rally.ui.tree.TreeItem,alias:"widget.rallyportfolioitemtreeitem",require:["Rally.ui.renderer.RendererFactory"],config:{displayedFields:["Name","Plan"]},getContentTpl:function(){var me=this;return Ext.create("Ext.XTemplate",'<tpl if="this.canDrag()"><div class="icon drag"></div></tpl>',"{[this.getActionsGear()]}",'<tpl if="this._renderPlanOnLowestLevelPortfolioItem()">','<div class="textContent ellipses" style="width: 60%;">{[this.getFormattedId()]} - {Name}</div><div class="textContent ellipses">{[this.getPlanData()]}</div>',"<tpl else>",'<div class="textContent ellipses">{[this.getFormattedId()]} - {Name}</div>',"</tpl>",'<div class="rightSide">',"{[this.getPercentDone(values)]}","</div>",{canDrag:function(){return me.getCanDrag()},getActionsGear:function(){return me._buildActionsGearHtml()},getPercentDone:function(){return Rally.ui.renderer.RendererFactory.renderRecordField(me.getRecord(),"PercentDoneByStoryCount")},getFormattedId:function(){return Rally.ui.renderer.RendererFactory.renderRecordField(me.getRecord(),"FormattedID")},getPlanData:function(){var plan=me.getRecord().get("Plan"),planName=plan&&plan.name?plan.name:"";return planName},_renderPlanOnLowestLevelPortfolioItem:function(){return me.getRecord().self.isLowestLevelPortfolioItem()}})},handleReloadAndDraw:function(record){record.self.isLowestLevelPortfolioItem()&&(record.data.Plan=this.getRecord().get("Plan")),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.TreeItemDropTarget",{extend:Ext.dd.DropTarget,overClass:"tree-item-drop-allowed",dropAllowed:"rallytree-proxy",config:{tree:void 0,treeItem:void 0},constructor:function(target,config){this.mergeConfig(config),this.callParent([target,this.config])},notifyDrop:function(source){
var target=this,tree=this.getTree();if(target.el.removeCls("tree-item-drop-allowed"),this._droppedOnParent(source,target))return!1;if(this._droppedOnSelf(source,target))return!1;if(this._droppedOnDescendant(source,target))return!1;var parentAttribute=this._getParentAttribute(source.treeItem.getRecord(),target.treeItem.getRecord());return tree.fireEvent("beforerecordsaved",source.treeItem.getRecord(),target.treeItem.getRecord()),source.treeItem.getRecord().set(parentAttribute,target.treeItem.record.get("_ref")),source.treeItem.getRecord().save({context:{project:source.treeItem.getRecord().get("Project")._ref},success:function(record){tree.suspendEvents(!1),tree.resumeEvents(!0),tree.fireEvent("recordsaved",record),tree.publish(Rally.Message.objectUpdate,record)},scope:this}),!0},_droppedOnDescendant:function(source,target){for(var isDescendant=!1,parentTreeItem=target.treeItem.parentTreeItem,sourceRef=source.treeItem.getRecord().get("_ref");parentTreeItem;){if(parentTreeItem.getRecord().get("_ref")===sourceRef){isDescendant=!0;break}parentTreeItem=parentTreeItem.parentTreeItem}return isDescendant},_droppedOnParent:function(source,target){var parentAttribute=this._getParentAttribute(source.treeItem.getRecord(),target.treeItem.getRecord()),sourceParent=source.treeItem.getRecord().get(parentAttribute);return sourceParent&&sourceParent._ref===target.treeItem.getRecord().get("_ref")},_droppedOnSelf:function(source,target){return source.treeItem.getRecord().get("_ref")===target.treeItem.getRecord().get("_ref")},_getParentAttribute:function(childRecord,parentRecord){var tree=this.getTree();return tree.getGivenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParentFn().call(tree.getScope(),childRecord,parentRecord)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.Tree",{extend:Ext.Container,alias:"widget.rallytree",mixins:{messageable:Rally.Messageable},clientMetrics:[{beginMethod:"_beforeInitialLoad",endMethod:"_initialLoad",description:"initial load"},{beginMethod:"drawChildItems",endMethod:"drawItems",description:"loaded child records"},{event:"drag",description:"tree item picked up"},{event:"drop",description:"tree item dropped"}],cls:"rallytree",config:{topLevelModel:"User Story",topLevelParentAttribute:"Parent",childModelTypeForRecordFn:function(record){return"User Story"},givenAChildRecordWhatIsTheAttributeConnectingItToTheParentFn:function(childRecord){return"Parent"},givenAParentRecordWhatIsTheAttributeConnectingAChildToThisParentFn:function(parentRecord){return"Parent"},givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParentFn:function(childRecord,parentRecord){return"Parent"},canExpandFn:function(record){return record.get("DirectChildrenCount")>0},enableDragAndDrop:!1,dragDropGroupFn:function(record){return Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref)+"-"+record.get("_type")},dragThisGroupOnMeFn:function(record){return Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref)+"-"+record.get("_type")},scope:void 0,topLevelStoreConfig:{},childItemsStoreConfigForParentRecordFn:function(){return{}},treeItemConfigForRecordFn:function(record){return{xtype:"rallytreeitem"}},autoLoadTopLevel:!0,emptyText:"<p>No Items Found.</p>",stateful:!1,stateId:void 0,actionsForRecordFn:null},constructor:function(config){this.mergeConfig(config),this.config.stateful&&(this.config.stateId?this._treeState=Rally.state.SessionStorage.getInstance().get(this.getStateId())||[]:Ext.Error.raise("A stateId is required if stateful is true.")),this._drawingChildrenCount=1,this.callParent([this.config])},initComponent:function(){this.callParent(arguments),this.addEvents("beforerecordsaved","recordsaved","itemselected","toplevelload","initialload","drag","drop","refresh");var storeConfig=Ext.applyIf(Ext.clone(this.getTopLevelStoreConfig()),{model:this.getTopLevelModel(),filters:[{property:this.getTopLevelParentAttribute(),value:"null",operator:"="}],sorters:[{property:"Rank",direction:"ASC"}],fetch:this._getDefaultTopLevelFetchFields()}),store=this.topLevelStore=Ext.create(storeConfig.xtype||"store.rallywsapidatastore",storeConfig);store.on("beforeload",this._beforeInitialLoad,this),store.on("load",this.handleParentItemStoreLoad,this),this.getAutoLoadTopLevel()&&store.load(),this.subscribe(this,Rally.Message.objectDestroy,this._onObjectDestroy,this),this.subscribe(this,Rally.Message.objectCreate,this._onObjectCreate,this),this.subscribe(this,Rally.Message.objectUpdate,this._onObjectUpdate,this),this.on("initialload",this._initialLoad,this)},handleParentItemStoreLoad:function(store,records){this.renderParentRecords(records)},renderParentRecords:function(records){records.length>0?this.drawItems(records):(this.fireEvent("initialload"),this.drawEmptyMsg()),this.fireEvent("toplevelload")},_beforeInitialLoad:Ext.emptyFn,_initialLoad:function(){this.getStateful()&&this._saveTreeStateToSessionStorage(),this.publish(Rally.Message.treeLoaded),Rally.BrowserTest&&Rally.BrowserTest.publishComponentReady(this),this._treeLoaded=!0},findTreeItemForRecord:function(record){var xtype,treeItemConfig=this.getTreeItemConfigForRecordFn().call(this,record);if(treeItemConfig&&(xtype=treeItemConfig.xtype),xtype)return Ext.Array.filter(this.query(xtype),function(treeItem){return treeItem.getRecord().get("_ref")===record.get("_ref")})[0]},findTreeItemForChildRecord:function(childRecord){var parentAttribute=this.getGivenAChildRecordWhatIsTheAttributeConnectingItToTheParentFn().call(this,childRecord),parentRef=childRecord.get(parentAttribute)&&childRecord.get(parentAttribute)._ref;if(parentRef)return Ext.Array.filter(this.query("rallytreeitem"),function(treeItem){return treeItem.getRecord().get("_ref")===parentRef},this)[0]},_onObjectDestroy:function(record){var treeItem=this.findTreeItemForRecord(record);treeItem&&this._removeTreeItem(treeItem)},_onObjectCreate:function(record){this._insertRecord(record,!1)},_refresh:function(callback){callback&&this.on("toplevelload",callback,this,{single:!0}),this.removeAll(),this.topLevelStore.load()},refresh:function(callback){this._refresh(callback)},_insertRecord:function(record,forceParent){var parentTreeItem=this.findTreeItemForChildRecord(record);if(!forceParent||parentTreeItem){var treeItem=this._createTreeItem(record);this.insertItem(treeItem,parentTreeItem)}},_onObjectUpdate:function(record){var parentTreeItem=this.findTreeItemForChildRecord(record);parentTreeItem&&this._addTreeItemToSessionStorage(parentTreeItem);var _afterOnObjectUpdate=Ext.bind(this._afterOnObjectUpdate,this);this.refresh(function(){_afterOnObjectUpdate(record)})},_afterOnObjectUpdate:function(){this._fireRefreshEvent()},_displayFlair:function(message){Rally.ui.notify.Notifier.show({message:message})},loadTopLevel:function(){return this.topLevelStore.load()},drawEmptyMsg:function(){var emptyTextMessage=this.getEmptyText();this.add({xtype:"component",html:Rally.ui.EmptyTextFactory.getEmptyTextFor(emptyTextMessage)})},insertItem:function(treeItem,parentTreeItem){var removedFromParent=!1,insertIndex=-1;treeItem.parentTreeItem?parentTreeItem&&parentTreeItem.getRecord().get("_ref")===treeItem.parentTreeItem.getRecord().get("_ref")||(removedFromParent=!0,treeItem.parentTreeItem.removeChildItem(treeItem),treeItem.parentTreeItem.reloadAndDraw()):(this.remove(treeItem,!1),removedFromParent=!0),parentTreeItem?parentTreeItem.getExpanded()?(treeItem.setParentTreeItem(parentTreeItem),parentTreeItem.insertChildItemByRank(treeItem,this._fireRefreshEvent,this)):(parentTreeItem.reloadAndDraw(parentTreeItem.expandOrCollapse,parentTreeItem),removedFromParent&&treeItem.destroy()):this.topLevelStore.model&&this.topLevelStore.model.typePath===treeItem.getRecord().self.typePath.toLowerCase()&&(this.topLevelStore.add(treeItem.getRecord()),Rally.data.Ranker.isDnDRankable(this.topLevelStore)&&(insertIndex=_.sortedIndex(this.items.getRange(),treeItem,treeItem.getRank)),this.insert(insertIndex,treeItem),this._fireRefreshEvent())},drawItems:function(records,parentTreeItem){Ext.suspendLayouts();for(var i=0;i<records.length;i++){var record=records[i];this._drawTreeItem(record,parentTreeItem)}this._drawingChildrenCount--,Ext.resumeLayouts(!0),Ext.defer(function(){0===this._drawingChildrenCount&&(this._treeLoaded?this._fireRefreshEvent():this.fireEvent("initialload")),this.publish(Rally.Message.treeItemExpanded)},1,this)},_getShouldExpand:function(record){return this.getStateful()&&this._sessionStorageContainsTreeItem(record)},_createTreeItem:function(record){var treeItemConfig=this.getTreeItemConfigForRecordFn().call(this.getScope(),record);treeItemConfig=treeItemConfig||{},treeItemConfig=Ext.applyIf(treeItemConfig,{xtype:"rallytreeitem",record:record,canExpandFn:this.getCanExpandFn(),scope:this.getScope(),canDrag:this.getEnableDragAndDrop(),canDropOnMe:this.getEnableDragAndDrop(),actionsForRecordFn:Ext.isFunction(this.getActionsForRecordFn())?Ext.bind(this.getActionsForRecordFn(),this):null,expanded:this._getShouldExpand(record),listeners:{expand:this.expandItem,collapse:this.collapseItem,select:this.selectTreeItem,scope:this}});var treeItem=Ext.ComponentManager.create(treeItemConfig);return this.getEnableDragAndDrop()&&treeItem.on("draw",function(){this.makeTreeItemDraggable(treeItem)},this),treeItem},_drawTreeItem:function(record,parentTreeItem){var treeItem=this._createTreeItem(record);parentTreeItem?(treeItem.setParentTreeItem(parentTreeItem),parentTreeItem.addChildItem(treeItem)):this.add(treeItem)},drawChildItems:function(parentTreeItem){this._drawingChildrenCount++;var childModelType=this.getChildModelTypeForRecordFn().call(this.getScope(),parentTreeItem.getRecord()),parentAttribute=this.getGivenAParentRecordWhatIsTheAttributeConnectingAChildToThisParentFn().call(this.getScope(),parentTreeItem.getRecord()),storeConfig=this.getChildItemsStoreConfigForParentRecordFn().call(this.getScope(),parentTreeItem.getRecord());storeConfig=storeConfig||{},storeConfig=Ext.applyIf(storeConfig,{model:childModelType,filters:[{property:parentAttribute,value:parentTreeItem.getRecord().get("_ref"),operator:"="}],sorters:[{property:"Rank",direction:"ASC"}],context:{project:void 0},fetch:this._getChildTypeFetchFields(parentAttribute)});var childStore=Ext.create(storeConfig.xtype||"store.rallywsapidatastore",storeConfig);childStore.on("load",function(store,records){this.handleChildItemStoreLoad(store,Ext.clone(records),parentTreeItem)},this),parentTreeItem.store=childStore,childStore.load()},handleChildItemStoreLoad:function(store,records,parentTreeItem){this.renderChildRecords(records,parentTreeItem)},renderChildRecords:function(records,parentTreeItem){this.drawItems(records,parentTreeItem)},makeTreeItemDraggable:function(treeItem){var tree=this;if(treeItem.getCanDrag()){var me=this,dragSource=Ext.create("Ext.dd.DragSource",treeItem.getEl(),{treeItem:treeItem,ddGroup:this.getDragDropGroupFn().call(this.getScope(),treeItem.getRecord()),isTarget:!1,proxy:Ext.create("Ext.dd.StatusProxy",{animRepair:!0,shadow:!1,dropNotAllowed:"rallytree-proxy"}),beforeDragDrop:function(){return me.fireEvent("drag",treeItem),!0},afterDragDrop:function(){me.fireEvent("drop",treeItem)}});dragSource.setHandleElId(treeItem.getEl().down(".drag").id)}if(treeItem.getCanDropOnMe()){var dropTarget=Ext.create("Rally.ui.tree.TreeItemDropTarget",treeItem.down("#treeItemContent").getEl(),{tree:tree,treeItem:treeItem});treeItem.dropTarget&&treeItem.dropTarget.unreg(),treeItem.dropTarget=dropTarget;var dropTargetGroups=this.getDragThisGroupOnMeFn().call(this.getScope(),treeItem.getRecord());Ext.isArray(dropTargetGroups)||(dropTargetGroups=[dropTargetGroups]),Ext.each(dropTargetGroups,function(dropTargetGroup){dropTarget.addToGroup(dropTargetGroup)})}},_removeTreeItem:function(treeItem){treeItem.destroy(),treeItem.getParentTreeItem()&&treeItem.getParentTreeItem().reloadAndDraw(function(){this._fireRefreshEvent()},this),0===this.query("rallytreeitem").length&&this.drawEmptyMsg(),this._fireRefreshEvent()},expandItem:function(treeItem){treeItem.removeChildItems(),this.drawChildItems(treeItem),this.getStateful()&&this._addTreeItemToSessionStorage(treeItem)},collapseItem:function(treeItem){if(this.getStateful()){var treeItems=treeItem.query("rallytreeitem");Ext.Array.forEach(treeItems,function(item){this._removeTreeItemFromSessionStorage(item)},this),this._removeTreeItemFromSessionStorage(treeItem)}treeItem.removeChildItems(),this._fireRefreshEvent(),this.publish(Rally.Message.treeItemCollapsed)},selectTreeItem:function(treeItem){Ext.Array.forEach(this.getEl().query(".treeItemSelected"),function(treeItemEl){Ext.get(treeItemEl).removeCls("treeItemSelected")}),treeItem.getEl().down(".treeItemContent").addCls("treeItemSelected"),this.fireEvent("itemselected",treeItem),this.publish(Rally.Message.objectFocus,treeItem.getRecord(),this)},destroy:function(){this.callParent(arguments)},_fireRefreshEvent:function(){this.fireEvent("refresh")},_saveTreeStateToSessionStorage:function(){this._treeState=Ext.Array.map(this.query("rallytreeitem[expanded=true]"),function(treeItem){return treeItem.getRecord().get("ObjectID")}),this.saveState()},_addTreeItemToSessionStorage:function(treeItem){var oids=this.getState();Ext.Array.contains(oids,treeItem.getRecord().get("ObjectID"))||(oids.push(treeItem.getRecord().get("ObjectID")),this.saveState())},_removeTreeItemFromSessionStorage:function(treeItem){Ext.Array.remove(this.getState(),treeItem.getRecord().get("ObjectID")),this.saveState()},_sessionStorageContainsTreeItem:function(record){return Ext.Array.contains(this.getState(),record.get("ObjectID"))},_getDefaultTopLevelFetchFields:function(){return["FormattedID","Name","ObjectID","DirectChildrenCount","TaskStatus","ScheduleState","Workspace","Rank"]},_getChildTypeFetchFields:function(parentFieldName){return this._getDefaultTopLevelFetchFields().concat([parentFieldName,"WorkProduct","Project"])},getState:function(){return this._treeState},saveState:function(){Rally.state.SessionStorage.getInstance().set(this.getStateId(),this.getState())},initState:function(){}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.UserStoryTreeItem",{extend:Rally.ui.tree.TreeItem,alias:"widget.rallyuserstorytreeitem",config:{displayedFields:["Name","ScheduleState"]},getContentTpl:function(){var me=this;return Ext.create("Ext.XTemplate",'<tpl if="this.canDrag()"><div class="icon drag"></div></tpl>',"{[this.getActionsGear()]}",'<div class="textContent ellipses">{[this.getFormattedId()]} - {Name}</div>','<div class="rightSide">',"{[this.getScheduleState(values)]}","</div>",{canDrag:function(){return me.getCanDrag()},getActionsGear:function(){return me._buildActionsGearHtml()},getScheduleState:function(){return Rally.ui.renderer.RendererFactory.renderRecordField(me.getRecord(),"ScheduleState")},getFormattedId:function(){return Rally.ui.renderer.RendererFactory.renderRecordField(me.getRecord(),"FormattedID")}})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.PortfolioTree",{extend:Rally.ui.tree.Tree,alias:"widget.rallyportfoliotree",constructor:function(config){var topLevelStoreConfig=Ext.apply({filters:[],fetch:this._getDefaultTopLevelFetchFields()},config.topLevelStoreConfig||{});config.topLevelStoreConfig=topLevelStoreConfig,config=Ext.apply({childModelTypeForRecordFn:this.childModelTypeForRecordFn,givenAParentRecordWhatIsTheAttributeConnectingAChildToThisParentFn:Rally.data.util.ArtifactParentAttributeHelper.parentAttributeForChildRecordOf,givenAChildRecordWhatIsTheAttributeConnectingItToTheParentFn:this.givenAChildRecordWhatIsTheAttributeConnectingItToTheParent,givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParentFn:this.givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParent,canExpandFn:this.canExpandItem,enableDragAndDrop:!0,dragDropGroupFn:this.dragDropGroup,dragThisGroupOnMeFn:this.dragThisGroupOnMe,scope:this,childItemsStoreConfigForParentRecordFn:this.childItemsStoreConfigForParentRecordFn,treeItemConfigForRecordFn:this.treeItemConfigForRecordFn,listeners:{beforerecordsaved:this.beforeRecordSaved}},config),this.callParent([config]),this.subscribe(Rally.Message.treeItemExpanded,this._onTreeItemExpanded,this)},treeItemConfigForRecordFn:function(record){return _({xtype:"rallytreeitem",selectable:!0}).merge(this._isPortfolioItem(record)?{xtype:"rallyportfolioitemtreeitem"}:{}).merge(this._isUserStory(record)?{xtype:"rallyuserstorytreeitem"}:{}).value()},beforeRecordSaved:function(record,newParentRecord){this._isUserStory(record)&&record.set(this._isUserStory(newParentRecord)?"PortfolioItem":"Parent","")},_isRecordBottomPortfolioLevel:function(record){return record.self.isLowestLevelPortfolioItem()},_isUserStory:function(record){return"hierarchicalrequirement"===record.get("_type")},_isTask:function(record){return"task"===record.get("_type")},_isPortfolioItem:function(record){return record.self.isPortfolioItem()},childModelTypeForRecordFn:function(record){return this._isUserStory(record)?record.get("TaskStatus")&&"NONE"!==record.get("TaskStatus")?"Task":"UserStory":this._isRecordBottomPortfolioLevel(record)?"UserStory":record.getField("Children").attributeDefinition.AllowedValueType._refObjectName},givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParent:function(childRecord,parentRecord){return this._isTask(childRecord)?"WorkProduct":this._isUserStory(childRecord)&&this._isPortfolioItem(parentRecord)?"PortfolioItem":"Parent"},givenAChildRecordWhatIsTheAttributeConnectingItToTheParent:function(childRecord){return this._isTask(childRecord)?"WorkProduct":childRecord.get("Parent")?"Parent":"PortfolioItem"},canExpandItem:function(record){return record.get("DirectChildrenCount")>0||record.get("TaskStatus")&&"NONE"!==record.get("TaskStatus")},dragDropGroup:function(record){return Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref)+"-"+record.get("_type").toLowerCase()},dragThisGroupOnMe:function(record){var workspace=Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref);if(this._isTask(record))return[];if(this._isUserStory(record))return record.get("TaskStatus")&&"NONE"!==record.get("TaskStatus")?workspace+"-task":record.get("DirectChildrenCount")>0?workspace+"-hierarchicalrequirement":[workspace+"-task",workspace+"-hierarchicalrequirement"];if(this._isRecordBottomPortfolioLevel(record))return workspace+"-hierarchicalrequirement";var childPortfolioItemType=this._getPortfolioItemChildType(record);return Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref)+"-"+childPortfolioItemType},childItemsStoreConfigForParentRecordFn:function(){return{fetch:this._getChildLevelFetchFields()}},_getPortfolioItemChildType:function(record){return record.getField("Children").attributeDefinition.AllowedValueType._refObjectName.toLowerCase().replace(/\s/g,"")},_onTreeItemExpanded:function(){this.rendered&&this._attachPercentDoneToolTip()},_attachPercentDoneToolTip:function(){var me=this;this.getEl().select(".progress-bar-container").each(function(flyEl){var el=Ext.get(flyEl.dom);el.removeAllListeners(),el.on("click",function(){var record=this._getRecordFor(el);Ext.create("Rally.ui.popover.PercentDonePopover",{target:el,percentDoneData:record.data,percentDoneName:"PercentDoneByStoryCount",piRef:record.data._ref})},me)})},_getRecordFor:function(el){var treeItemEl=el.up(".treeItem"),treeItem=Ext.getCmp(treeItemEl.id);return treeItem.getRecord()},_onObjectCreate:function(record){var parentTreeItem=this.findTreeItemForChildRecord(record);parentTreeItem&&parentTreeItem.getExpanded()&&this._userStoryHasTasks(parentTreeItem.getRecord())&&parentTreeItem.expandOrCollapse(),this.callParent(arguments)},_userStoryHasTasks:function(record){return record.get("TaskStatus")&&"NONE"!==record.get("TaskStatus")},_getDefaultTopLevelFetchFields:function(){return["FormattedID","Name","ObjectID","Workspace","ScheduleState","DirectChildrenCount","Rank","Project"].concat(Rally.data.util.PortfolioItemHelper.getPercentDoneFetchFields())},_getChildLevelFetchFields:function(){return this._getDefaultTopLevelFetchFields().concat(["Parent","PortfolioItem","WorkProduct","TaskStatus"])}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.ProjectTree",{extend:Rally.ui.tree.Tree,alias:"widget.rallyprojecttree",config:{topLevelModel:Ext.identityFn("Workspace"),topLevelStoreConfig:{fetch:["Name","State"],filters:[{property:"State",value:"Open"},{property:"Projects.State",value:"Open"}],sorters:[{property:"Name",direction:"ASC"}],context:{workspace:"null",project:void 0}},workspace:void 0,treeItemConfigForRecordFn:function(record){return"workspace"===record.get("_type")?{xtype:"rallyplaintreeitem"}:{xtype:"rallyplaintreeitem",selectable:!0}},childModelTypeForRecordFn:function(){return"Project"},givenAParentRecordWhatIsTheAttributeConnectingAChildToThisParentFn:function(record){return"Parent"},childItemsStoreConfigForParentRecordFn:function(record){var storeConfig={fetch:["Name","Children:summary[State]","State","Workspace"],sorters:[{property:"Name",direction:"ASC"}]};return"workspace"===record.get("_type")?Ext.apply(storeConfig,{filters:[{property:"Parent",value:"null"}],context:{workspace:record.get("_ref"),project:null}}):Ext.apply(storeConfig,{filters:[{property:"Parent",value:record.get("_ref")}],context:{workspace:record.get("Workspace")._ref,project:null}})},canExpandFn:function(record){return"workspace"===record.get("_type")||record.get("Summary").Children.State.Open}},constructor:function(config){config.workspace&&(config.topLevelModel="Project",config.topLevelStoreConfig={fetch:["Name","State","Children:summary[State]"],filters:[{property:"State",value:"Open"},{property:"Parent",value:"null"}],sorters:[{property:"Name",direction:"ASC"}],context:{workspace:config.workspace,project:void 0}}),this.callParent(arguments)}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.ui.tree.UserStoryTree",{extend:Rally.ui.tree.Tree,alias:"widget.rallyuserstorytree",constructor:function(config){config=Ext.apply({childModelTypeForRecordFn:this.childModelTypeForRecordFn,givenAParentRecordWhatIsTheAttributeConnectingAChildToThisParentFn:Rally.data.util.ArtifactParentAttributeHelper.parentAttributeForChildRecordOf,givenAChildRecordWhatIsTheAttributeConnectingItToTheParentFn:this.givenAChildRecordWhatIsTheAttributeConnectingItToTheParent,givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParentFn:this.givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParent,canExpandFn:this.canExpandItem,enableDragAndDrop:!0,dragDropGroupFn:this.dragDropGroup,dragThisGroupOnMeFn:this.dragThisGroupOnMe,scope:this,treeItemConfigForRecordFn:this.treeItemConfigForRecordFn,listeners:{beforerecordsaved:this.beforeRecordSaved}},config),this.callParent([config])},treeItemConfigForRecordFn:function(record){var config={selectable:!0};return this._isUserStory(record)?config.xtype="rallyuserstorytreeitem":config.xtype="rallytreeitem",config},beforeRecordSaved:function(record,newParentRecord){this._isUserStory(record)&&(this._isUserStory(newParentRecord)?record.set("PortfolioItem",""):record.set("Parent",""))},_isUserStory:function(record){return"hierarchicalrequirement"===record.get("_type")},_isTask:function(record){return"task"===record.get("_type")},childModelTypeForRecordFn:function(record){if(this._isUserStory(record))return this._userStoryHasTasks(record)?"Task":"UserStory"},givenAChildAndParentRecordWhatAttributeShouldConnectTheChildToTheParent:function(childRecord,parentRecord){return this._isTask(childRecord)?"WorkProduct":"Parent"},givenAChildRecordWhatIsTheAttributeConnectingItToTheParent:function(childRecord){return this._isTask(childRecord)?"WorkProduct":"Parent"},canExpandItem:function(record){return record.get("DirectChildrenCount")>0||this._userStoryHasTasks(record)},dragDropGroup:function(record){return Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref)+"-"+record.get("_type").toLowerCase()},dragThisGroupOnMe:function(record){var workspace=Rally.util.Ref.getOidFromRef(record.get("Workspace")._ref);return this._isTask(record)?[]:this._isUserStory(record)?this._userStoryHasTasks(record)?workspace+"-task":record.get("DirectChildrenCount")>0?workspace+"-hierarchicalrequirement":[workspace+"-task",workspace+"-hierarchicalrequirement"]:void 0},_onObjectCreate:function(record){var parentTreeItem=this.findTreeItemForChildRecord(record);parentTreeItem&&parentTreeItem.getExpanded()&&this._userStoryHasTasks(parentTreeItem.getRecord())&&parentTreeItem.expandOrCollapse(),this.callParent(arguments)},_userStoryHasTasks:function(record){return record.get("TaskStatus")&&"NONE"!==record.get("TaskStatus")}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.Compare",{singleton:!0,defaultSort:function(item1,item2){return item1===item2?0:item1<item2?-1:1},sortByProperty:function(array,property,compare){compare=compare||this.defaultSort;var arrayClone=Ext.Array.clone(array);return Ext.Array.sort(arrayClone,function(item1,item2){return compare(item1[property],item2[property])})}})}(),function(){var Ext=window.Ext4||window.Ext;Ext.define("Rally.util.ComponentUpdatable",{requires:[],markUpdated:function(componentName,callback,scope,args){this._updating&&(delete this._updating[componentName],this._componentsStillUpdating()||(delete this._updating,Ext.callback(callback,scope,args),Ext.isFunction(this.recordLoadEnd)&&this.recordLoadEnd({component:this.requester||this})))},markUpdating:function(componentName){Ext.isDefined(this._updating)||(this._updating={},Ext.isFunction(this.recordLoadBegin)&&this.recordLoadBegin({description:this.componentUpdatableUserAction,component:this.requester||this,miscData:this.componentUpdatableMetricsData})),this._updating[componentName]=!0},isComponentUpdating:function(){return this._componentsStillUpdating()},_componentsStillUpdating:function(){if(this._updating)for(var i in this._updating)if(this._updating.hasOwnProperty(i))return!0;return!1}})}(),function(){var Ext=window.Ext4||window.Ext,fastSetInnerHTML=function(el,html){if(Ext.isIE||Ext.isGecko)el.innerHTML=html;else{var display=el.style.display||"block",parent=el.parentNode,nextSibling=el.nextSibling;el.style.display="none",parent.removeChild(el),el.innerHTML=html,nextSibling?parent.insertBefore(el,nextSibling):parent.appendChild(el),el.style.display=display}},_setInnerHTML=function(el,html){el=Ext.getDom(el);try{el&&fastSetInnerHTML(el,html)}catch(e){for(var badTags=["attach","component","defaults","event","method","property"],i=0,len=badTags.length;i<len;i++)html=html.replace(new RegExp("<"+badTags[i]+"[^(>|/)]*>","ig"),"&lt;"+badTags[i]+"&gt;"),html=html.replace(new RegExp("</"+badTags[i]+"[^>]*>","ig"),"&lt;/"+badTags[i]+"&gt;"),html=html.replace(new RegExp("<"+badTags[i]+"[^>]*/>","ig"),"&lt;"+badTags[i]+"/&gt;");fastSetInnerHTML(el,html)}};Ext.define("Rally.util.Element",{requires:[],singleton:!0,isScrollableX:function(el){return el.dom.scrollWidth>el.dom.clientWidth},isScrollableY:function(el){return el.dom.scrollHeight>el.dom.clientHeight},setInnerHTML:function(el,html,loadScripts,callback){Ext.isIE6||Ext.isIE7||Ext.isIE8?el.update(html,loadScripts,callback):(_setInnerHTML(el,html),loadScripts&&this.evalScripts(el),Ext.callback(callback))},evalScripts:function(el){el=Ext.getDom(el);var div,script,isValidScript,i,len,divs=el.getElementsByTagName("div"),scripts=el.getElementsByTagName("script"),invalidScripts=[];for(i=0,len=divs.length;i<len;i++)div=divs[i],"noscript"===div.className&&(invalidScripts=invalidScripts.concat(div.getElementsByTagName("script")));for(i=0,len=scripts.length;i<len;i++)script=scripts[i],isValidScript=invalidScripts.indexOf(script)===-1,isValidScript&&script.innerHTML&&script.innerHTML.length>0&&(Ext.isFunction(window.execScript)?window.execScript(script.innerHTML):eval.apply(window,[script.innerHTML]))}})}();